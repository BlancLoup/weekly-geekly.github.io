<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Caching in Windows Azure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The problem of caching is faced by any high-loaded application. In Windows Azure, where the main algorithm for increasing productivity is adding insta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Caching in Windows Azure</h1><div class="post__text post__text-html js-mediator-article">  The problem of caching is faced by any high-loaded application.  In Windows Azure, where the main algorithm for increasing productivity is adding instances of an application, the role of the cache becomes even more important, because  with it, you can provide "shared memory" for all instances. <br><a name="habracut"></a><br><h4>  Memorycache </h4><br>  In general, this class is not related to Azure, but it is simply impossible not to mention it in the article about caching. <br><br>  Starting with .Net 4, the new namespace System.Runtime.Caching has appeared.  Engaged in MemoryCache, as the name implies, the creation of a repository of objects in memory.  For me it is important because it works much faster than Cache from the System.Web.Caching space.  Another nice feature is that you can create multiple caches with different settings. <br><br>  For simplicity, you can immediately describe the cache parameters in the configuration and then access it through MemoryCache.Default.  Other caches need to be initialized forcibly and keep references to them.  Parameters can be set both in runtime and in configuration: <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.runtime.caching</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">memoryCache</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">namedCaches</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cacheMemoryLimitMegabytes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">physicalMemoryPercentage</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pollingInterval</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"00:02:00"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">namedCaches</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">memoryCache</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.runtime.caching</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  In-role cache </h4><br>  As a rule, each application in the cloud has several instances: on the one hand, this provides fault tolerance (SLA Azure in principle requires at least two instances) and scalability with increasing and decreasing loads. <br><br>  Regularly there is a desire to provide a single "memory" for all instances.  The simplest example would be a session.  To do this, Azure has an In-Role Cache mechanism that allows you to allocate part or all of the instance‚Äôs memory to the cache, and it will be available from all instances of the application. <br><br>  To use it, you need to add the <a href="https://www.nuget.org/packages/Microsoft.WindowsAzure.Caching/">Windows Azure Caching</a> package to the solution and configure the roles for working with it. <br><br>  First we need to enable the cache on the instances or add the instances selected for the cache to the solution. <br><blockquote>  <b>Warning</b> : cache is not supported on ultra small (extra small) instances. </blockquote><br><div class="spoiler">  <b class="spoiler_title">Pictures about turning on the cache</b> <div class="spoiler_text">  Enable cache on existing role <br><img src="https://habrastorage.org/getpro/habr/post_images/5bc/7eb/3d5/5bc7eb3d57a1171d7ab51dc57099f6dd.png"><br><br>  Creating a cache-allocated role <br><img src="https://habrastorage.org/getpro/habr/post_images/d81/af8/bb8/d81af8bb8d178f6e7ed33903b65c0cf7.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/648/a9d/e0c/648a9de0cc63b1895a8bd8a3d4681bf2.png"><br></div></div><br>  There will always be a cache named ‚Äúdefault‚Äù.  We can add caches with their own names and various settings. <br><br><h5>  Cache settings </h5><br>  <b>High Availability.</b> <br>  Requires that the solution contains at least two instances on which the cache is located.  The data entering the cache will be stored on at least two copies and the failure of one copy will not lead to data loss.  Use this option carefully, because  the cache begins to absorb much more resources. <br><br>  <b>Notifications</b> <br>  Enable / disable the alert mechanism for the cache.  They literally just appeared and there are no real scenarios for them, I have not yet invented. <br><br>  <b>Eviction policy</b> <br>  How the cache will be cleared in case of overflow.  For inclusion, only one option is currently available - LRU (Least recent use).  Those.  which object was least accessed - it will be deleted. <br><br>  <b>Obsolescence (Expiration Type) and Time to Live (TTL, Time To Live)</b> <br>  Two interrelated parameters indicate how and for how long (in minutes) they will become obsolete in the cache and disappear from it.  Those.  if the cleanup option is more abnormal (cache overflow does not usually lead to anything good), then obsolescence allows us to describe how objects should disappear from the cache during normal operation. <br>  <b>None.</b>  Objects will be stored in the cache forever (until the reboot).  Requires the lifetime to be set to zero. <br>  <b>Absolute.</b>  The object is stored in the cache for some time after it got there. <br>  <b>Sliding window.</b>  My favorite option.  The object will disappear from the cache after a specified time after the last access.  Those.  objects accessed will constantly live in the cache. <br><br><h4>  Setting client cache </h4><br>  In general, everything is quite simple: in the configuration file we describe what caches we have and where we are located.  Paste the following lines into the configuration file in the configuration section (their template should have already created NuGet when installing the caching package). <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dataCacheClients</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dataCacheClient</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">autoDiscover</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">isEnabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">identifier</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CacheWorkerRole"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">localCache</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">isEnabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sync</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TimeoutBased"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">objectCount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ttlValue</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"300"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dataCacheClient</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dataCacheClient</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MyNamedCache"</span></span></span><span class="hljs-tag">&gt;</span></span> ‚Ä¶ <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dataCacheClients</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  As an identifier you need to specify the name of the role containing the cache in the project.  In our case, CacheWorkerRole.  And not the name of the access point in Azure, such as mycoolapp.cloudapp.net. <br><br>  The explanations are probably required only by the localCache tag, which indicates that the instance can store objects locally and the principle of storage.  objectCount determines how many objects we will store locally, upon reaching the specified number, the cache will remove from the local copy 20% of the objects that have not been accessed for the longest. <br><br>  Time synchronization (TimeBased) indicates that the objects will be stored in the local cache the number of seconds specified in ttlValue.  NotificationBased requires that the alert mechanism be enabled in the cache.  In this case, the ttlValue parameter indicates the frequency with which the local cache will check for changes in the cache. <br><br>  Basic settings completed.  Now, for example, let's connect the sessions of our web role to the cache.  In IIS, this is done very simply by replacing the standard InProc session provider with a provider that uses the cache. <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sessionState</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Custom"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">customProvider</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AFCacheSessionStateProvider"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">providers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AFCacheSessionStateProvider"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.Web.DistributedCache.DistributedCacheSessionStateStoreProvider, Microsoft.Web.DistributedCache"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cacheName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dataCacheClientName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">applicationName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AFCacheSessionState"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">providers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sessionState</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The session is a great example of where the cache can be used.  But you should not be limited only to her.  For example, you can cache pages, then other instances will not have to spend time building them.  And by itself, in the cache can and should add our own data. <br><br>  Before proceeding to the examples of working with the cache from the code, we will focus on a completely new kind of cache. <br><br><h4>  Cache service </h4><br>  While the cache as a service is available in preview mode (preview).  It may be in demand in scenarios where different solutions must have access to the same data.  In-Role cache is available only within the solution to which it is attached.  The cash service is deprived of this. <br><br>  Configuring the cache service one-on-one is the same as setting the In-Role cache, but you need to do it not in the studio, but in the Azure management portal.  A cache access key will be added to the role configuration. <br><img src="https://habrastorage.org/getpro/habr/post_images/c9b/c27/cd3/c9bc27cd30d1724b23eb960b717b1307.jpg"><br><br>  Another advantages of the cache service include: <br>  - a slightly lower price; <br>  - no headache during deployment updates (they will not affect the cache); <br>  - protocol support memcached, which allows you to connect to it not only PaaS solutions, but also any type of virtualok. <br><br><h4>  A few more words on the setting </h4><br>  Creating a cache is to know how many objects, how much will be stored in it and with what frequency they will be read and written.  When these values ‚Äã‚Äãare known, the data must be driven into one of the exel plates (for <a href="http://go.microsoft.com/fwlink/%3FLinkId%3D321182">service</a> or <a href="http://go.microsoft.com/fwlink/%3FLinkId%3D254507">roles</a> ) and get recommendations on how much and what you need in terms of chargeable units. <br><br>  Objects are stored in the cache in a serialized form, therefore, to determine the volume of an object, you need to get the size after serializing the object itself and its key. <br><br>  The size of the object in the cache after serialization is limited to 8 megabytes.  If you go beyond the limit, you can enable compression for the cache, then objects will be compressed before entering the cache.  In general, compression can have a positive effect on the work of the cache, if the cost of packing-unpacking is less than the cost of a network transfer.  Unfortunately, this can only be found out experimentally. <br><br>  To increase the bandwidth of the cache, you can increase the number of connections to it with the maxConnectionsToServer parameter.  By default, only one cache connection is created. <br><br><h4>  Work with cache from code </h4><br>  Everything you need to work with the cache lives in Microsoft.ApplicationServer.Caching. <br><br>  To begin, create a cache object and use the Add, Put, Get, and Remove commands to start working with data. <br><pre> <code class="cs hljs">DataCache dc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataCache(<span class="hljs-string"><span class="hljs-string">"default"</span></span>); dc.Add(<span class="hljs-string"><span class="hljs-string">"test"</span></span>, DateTime.Now); <span class="hljs-comment"><span class="hljs-comment">//    dc.Put("test", DateTime.Now); //   DateTime dt=(DateTime)dc.Get("test"); // dc.Remove("test"); //</span></span></code> </pre><br><br><h5>  Race </h5><br>  To prevent a race, use GetAndLock, PutAndUnlock, and Unlock.  The operator GetAndLock does not block the normal Get and does not interfere with "dirty" reading. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataCacheLockHandle lockHndl; <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = dc.GetAndLock(<span class="hljs-string"><span class="hljs-string">"test"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TimeSpan(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> lockHndl); <span class="hljs-comment"><span class="hljs-comment">//  dc.PutAndUnlock("test", value, lockHndl); // dc.Unlock("test", lockHndl)     } catch (DataCacheException de) { if (de.ErrorCode == DataCacheErrorCode.KeyDoesNotExist) { //  } }</span></span></code> </pre><br><h5>  Reading updates </h5><br>  It is easy to imagine a scenario in which you need to take some action when changing an object in the cache.  You can get an object and compare it with the current value, but you can reduce the cache load using the GetIfNewer method. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span> val = DateTime.Now; DataCacheItemVersion version = dc.Put(<span class="hljs-string"><span class="hljs-string">"test"</span></span>, val); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { val = dc.GetIfNewer(<span class="hljs-string"><span class="hljs-string">"test"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> version); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (val != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  } Thread.Sleep(1000); }</span></span></code> </pre><br>  If the object appears in the cache, somewhere else, you can get its version from the DataCacheItem object. <br><br><pre> <code class="cs hljs">DataCacheItem dci = dc.GetCacheItem(<span class="hljs-string"><span class="hljs-string">"test"</span></span>); DataCacheItemVersion version = dci.Version; <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> val = dci.Value;</code> </pre><br><h5>  Regions </h5><br>  To group objects, you can use regions.  In each of the methods listed above, the second argument can be passed the name of the region (after creating it) in which to create an object.  And after that, it is easy to iterate over objects in the cache. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dc.CreateRegion(<span class="hljs-string"><span class="hljs-string">"region"</span></span>)) { <span class="hljs-comment"><span class="hljs-comment">//  ,   } dc.Put("test", DateTime.Now, "region"); foreach (KeyValuePair&lt;string, object&gt; kvp in dc.GetObjectsInRegion("region")) { //  }</span></span></code> </pre><br>  The regions have a couple of features that should be considered when working with them. <br><br>  It is not necessary to sort objects in the region directly as in the code above.  If another thread adds or removes an object in it, we will run into an exception: ‚Äúthe collection has changed.‚Äù <br><br>  The second feature: the region lives within the limits of one copy.  Those.  if the distribution of objects across regions is uneven, then a situation may arise when one of the instances idle, and the other is boiling under load. <br><br><h4>  What is worth remembering when working with cache </h4><br>  - The size of the object in the cache is limited to 8 megabytes. <br>  - If regions are used, they should be filled evenly <br>  - Cache objects locally whenever possible. <br>  - Include high availability only where it is needed. <br>  - Use locks (GetAndLock) only where necessary <br>  - Do not read objects if they are not updated (use GetIfNewer) <br><br>  I hope this article will help others go through fewer rakes than I collected.  Successes in development, let your applications be fast. <br><br>  <a href="https://plus.google.com/107862204079203068843%3Frel%3Dauthor">Google Plus</a> </div><p>Source: <a href="https://habr.com/ru/post/200744/">https://habr.com/ru/post/200744/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../200728/index.html">How I made friends with the Quickbooks and PHP site using the Web Connector</a></li>
<li><a href="../200730/index.html">SDL 2.0 Lesson Cycle: Lesson 2</a></li>
<li><a href="../200734/index.html">Growth Hacking: how to "crack" the problem of growth?</a></li>
<li><a href="../200736/index.html">Compaq LTE Lite</a></li>
<li><a href="../200740/index.html">What is "project efficiency" for IT person</a></li>
<li><a href="../200746/index.html">Designer, Architect and Developer</a></li>
<li><a href="../200748/index.html">10 key strategic technologies of 2014 according to Gartner</a></li>
<li><a href="../200750/index.html">Hadoop clusters on demand from the cloud: internal device, first steps, tasks, Hive</a></li>
<li><a href="../200754/index.html">Detailed AngularJS Mobile Application Development Guide</a></li>
<li><a href="../200756/index.html">"Visualization Kung Fu" at 404</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>