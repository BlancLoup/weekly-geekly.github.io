<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create a stylish waterfall from RiME right in Unity or UE4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are games with such a memorable visual that it is terrible to consider the time spent on its development, take at least the latest God of War or...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create a stylish waterfall from RiME right in Unity or UE4</h1><div class="post__text post__text-html js-mediator-article">  There are games with such a memorable visual that it is terrible to consider the time spent on its development, take at least the latest God of War or RDR2.  And there are projects that bribe their atmospheric, even if they are far from AAA.  As an example, RiME has been praised for its style, sound and history.  And recently, the level designer of the game <a href="https://twitter.com/statuses/1074764789509959682">went</a> to the CD Projekt Red team to work on Cyberpunk 2077. RiME also inspired 3D artist Math Roodhuizen to create his own art. <br><br>  And amid all this, I stumbled upon ArtStation on a realistic water creation guide.  If <a href="https://habr.com/company/pixonic/blog/430144/">last time</a> it was about the river, then this time about the stylized waterfall.  In the first part we will explain how to create a "ripple effect", and even directly in the game engine.  For convenience, all steps are accompanied by gifs and / or pictures. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8l/uk/aj/8lukajs1s-31mo7gfvimmginvuq.gif"></div><a name="habracut"></a><br>  First, thanks to Simon Trumpler, an artist from Tequila Games who worked on <a href="https://store.steampowered.com/app/493200/RiME/">RiME</a> .  I was still new to shaders and VFX when I found his <a href="https://simonschreibt.de/gat/stylized-vfx-in-rime/">stuff</a> and thought, ‚ÄúWow, can I be able to do the same?‚Äù.  I recommend reading the report to learn more about how to create stylized effects (such as fire, for example). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now let's talk about the creation of a waterfall.  This will be especially useful for people who are not familiar with the Shader Graph system.  Our goal: to learn new ways of working and better understand the shaders. <br><br>  I will use the example of Unity, but most of the methods are applicable in UE4 - if you are used to working there, just follow me.  For convenience, each step is visualized by a gif or picture. <br><br>  So, you will need: <br><br><ul><li>  Unity 2018. </li><li>  <a href="https://assetstore.unity.com/packages/tools/visual-scripting/amplify-shader-editor-68570">Amplify Shader Editor</a> (Unity plugin).  But if you do not want to spend money on it, install Unity 2017 and download the free <a href="http://acegikmo.com/shaderforge/">Shaderforge</a> from the <a href="http://acegikmo.com/shaderforge/">asset</a> store (the new version of the engine does not support this plugin, but it still works in Unity 2017).  Both tools are almost the same, except that some moments are called differently. </li><li>  Autodesk Maya. </li><li>  Something to create or edit textures.  I use Photoshop, and sometimes even Substance Designer (but you definitely won't need it for this waterfall). </li></ul><br>  First, about the "ripple effect" that occurs when a waterfall falls on the surface.  It can also be used for other purposes, for example, to create pulsations around objects in water. <br><br><img src="https://habrastorage.org/webt/ub/jk/o5/ubjko5iypg5csetxipvglwfpjy8.gif"><br><br>  Open Unity and make sure you have the shader plugin installed.  At the time of this writing, Unity has its own Shader Graph, which is still being developed.  And while it‚Äôs not ready, I still recommend using the Amplify Shader Editor for Unity 2018 or Shaderforge in Unity 2017. <br><br>  Create a new material and give it a name (I have it MAT_WaterWrinkles).  Then right-click on the material in the Project Tab and go to Create&gt; Amplify Shader&gt; Surface Shader.  In this case, the new shader will automatically apply. <br><br>  You can select a shader at any time in the Materials tab&gt; drop-down list of shaders (for Shaderforge there will be something like a PBL shader).  Remember that the shader must be named both in the folder list and in the shader itself after it is opened. <br><br><img src="https://habrastorage.org/webt/8g/05/ve/8g05ve_dflwmkgqywfjpq30crdu.jpeg"><br><br>  As soon as you open a new shader, you will see something like this: <br><br><img src="https://habrastorage.org/webt/7i/ee/pk/7ieepkf2levm_2zi1pjphvgeuue.jpeg"><br><br>  I will not write a detailed guide on the use of Shader Graph, and if you are completely new, first read the introductory guides. <br><br>  In any case, to get the desired effect, we first need the usual Panner.  Here it is with a test texture on the plane: <br><br><img src="https://habrastorage.org/webt/83/hd/9f/83hd9fk8wgk-hcuhmoxac7rcz_u.gif"><br><br>  Panner moves the UV coordinates.  Make sure the Wrap Mode texture is set to Repeat.  In Shaderforge, you may have to connect a temporary node to the Panner input, with Amplify some of these basic values ‚Äã‚Äãare already included in the node itself. <br><br>  So, we have a moving texture.  But we want to achieve this effect: <br><br><img src="https://habrastorage.org/webt/ub/jk/o5/ubjko5iypg5csetxipvglwfpjy8.gif"><br><br>  And for this you need to scroll like this: <br><br><img src="https://habrastorage.org/webt/lw/ww/em/lwwwemj-vv8amtlxpfkynjek1gq.gif"><br><br>  As you can see, the structure of the node is the same - Panner simply moves the UV coordinates in the U and V directions (or X and Y).  To get the right panning direction, we need to create a custom grid with UV.  GIF for clarity: <br><br>  By applying the same material to a different grid, we can control the direction of the texture in 3D space when it moves in the UV space. <br><br><img src="https://habrastorage.org/webt/j9/1o/dr/j91odru3w4elitmc02elpxlm00s.gif"><br><br>  To enhance the effect, add a few more polygons and distort UV so that the texture in the center moves faster than at the edges.  And place the UV so that the seam is not visible. <br><br><img src="https://habrastorage.org/webt/vs/fv/qy/vsfvqynzumjlprdxippxpz_odqg.jpeg"><br><br>  An important conclusion follows from this: good effects rarely consist of one system and often represent a combination of several. <br><br>  We got the texture moving in the right direction at the right speed.  The UV sweep is placed in such a way that moving from right to left in the UV space with Panner turns into a movement in and out in the 3D space.  To avoid seams in the texture on the 3D model, UV sweep must be added (hotkey X for snap to the grid) to the vertices of the texture space vertically.  As a result, we have achieved the desired effect. <br><br>  Now the transparency.  Let's start with the basic things.  Many simple calculations that you do in a shader will have values ‚Äã‚Äãfrom 0 (black) to 1 (white).  That is, 0.5 is a shade of gray, and 0.2 is a shade of dark gray.  When you apply these values ‚Äã‚Äã(in this case to the Opacity channel of the main output node), you will control the level of transparency of the material.  Keep in mind that you first need to enable this feature.  In Amplify, you can change the rendering type (in blend mode) from opaque to, for example, transparent.  In this case, we will use the rendering type Transparent Cutout - the pixel displayed by this material is either completely transparent or completely opaque.  This can be seen on the gif above - there are no "translucent" pixels displayed by this shader. <br><br><img src="https://habrastorage.org/webt/0z/v2/zw/0zv2zwyehiurwcxxdvdq9c6jmrg.jpeg"><br><br>  Take the gradient texture in increments and place it on the shader.  Here it connects to the output of the albedo (color) main node. <br><br><img src="https://habrastorage.org/webt/ft/vm/x1/ftvmx1e9ujfhpcfcizmjwof5jmy.jpeg"><br><br>  And here it connects to the output of the Opacity Mask (this parameter is enabled when rendering type is Transparent Cutout). <br><br><img src="https://habrastorage.org/webt/zv/l7/oh/zvl7oholli9y2wtctoafl_gcoda.jpeg"><br><br>  You can see that the gradient texture uses black and white pixel values ‚Äã‚Äãto determine transparency or opacity.  Everything from 1 (white) to 0.5 (gray) becomes opaque, and everything from 0.5 (gray) to 1 (black) is completely transparent (or not displayed at all).  Opacity Mask creates a hard line and rounds the values ‚Äã‚Äãto 0 or 1, depending on which number is closer. <br><br>  Another grayscale texture: <br><br><img src="https://habrastorage.org/webt/ol/_v/ka/ol_vkageq7enmygek80rhan1-hk.jpeg"><br><br>  Connected to the Opacity Mask: <br><br><img src="https://habrastorage.org/webt/cd/9w/jt/cd9wjtycl78kqj0wx_f8mimpnti.jpeg"><br><br>  You get the idea.  And guess how you can use it: <br><br><img src="https://habrastorage.org/webt/2u/rq/dc/2urqdccavjdibo7blc0frlq-xpk.gif"><br><br>  You see a mostly blue image scrolling in the Shader Graph.  And the fact that I use only R (red) output of this node.  For the sake of optimization, I packed two grayscale textures (grayscale textures) into one file, but this is not necessary.  Similar images can be packaged using Photoshop or Substance Designer. <br><br><img src="https://habrastorage.org/webt/px/7k/6u/px7k6ulmvnbqonfar8_sqjkfzga.jpeg"><br><br>  The ripple effect is a good start, but you can do better.  Why not put two grayscale textures on top of each other to make the ripple effect more random? <br><br><img src="https://habrastorage.org/webt/zg/tn/78/zgtn78eo71em4hd8zyosznmyfjy.gif"><br><br>  I use the same texture, but I add different channels.  I scroll through them at different speeds and slightly in different directions.  The texture has a good gradient of gray values, which gives the feeling of a random ripple effect. <br><br>  There is one more thing on the next gif that we haven‚Äôt discussed yet - so your option may look a little different: <br><br><img src="https://habrastorage.org/webt/7u/ow/bn/7uowbnsld8tvgzcl6amkm2wajps.gif"><br><br>  You can see, for example, a pixel with a value of 0.2 (which is not rendered) passes over a pixel with a value of 0.4 (which is also not rendered) and suddenly becomes a pixel with a value of 0.6 - because we use an additional node (0.2 is added to 0.4 and it turns out to be 0.6).  Adding these two wave grayscale textures on top of each other at different speeds and gives close to the desired effect. <br><br><img src="https://habrastorage.org/webt/2u/rq/dc/2urqdccavjdibo7blc0frlq-xpk.gif"><br><br>  Here, to demonstrate the result, I added grayscale-textures on each other in Photoshop. <br><br><img src="https://habrastorage.org/webt/va/at/uy/vaatuyfg9hr2clslyh3xoskstra.gif"><br><br>  However, the seam at the end of the mesh is still distinct.  And we need to get this: <br><br><img src="https://habrastorage.org/webt/e-/qs/5f/e-qs5fmcvn2fjqd3jdjxnoty-nw.gif"><br><br>  Instead of this: <br><br><img src="https://habrastorage.org/webt/49/64/w_/4964w_tiq28mxap8bnczbd0tqm8.gif"><br><br>  In the first of the two gifs, the pulsations slowly subside and become smaller as they approach the edge of the grid.  The easiest way to do this is to use vertex color (vertex colors). <br><br>  Each model vertex contains its own data (for example, X, Y, and Z coordinates), as well as a color that has a value from 0 to 1. You can also set the color of the vertices in the 3D editor. <br>  Most of the outer vertices are black (that is, they have a value of 0).  They become white (closer to 1) when approaching the center.  Note that you will need additional Subdivisions to get vertices that can be colored. <br><br><img src="https://habrastorage.org/webt/bu/uo/pp/buuoppsouwnxep4s4ujpbbazixk.jpeg"><br><br>  For example, in Maya for coloring, you can go to the Mesh Display&gt; Paint Vertex Color menu and click on the More Options field. <br><br>  Now we can connect Vertex Color in our shader using Multiply. <br><br><img src="https://habrastorage.org/webt/66/sm/-w/66sm-wwyze85kybg_srrerrqabo.gif"><br><br>  I applied a gradient over the textures used and set the layer mode to Multiply. <br><br><img src="https://habrastorage.org/webt/xi/wi/d1/xiwid1mg_pfo461adllkdm2t6-k.gif"><br><br>  The gradient enhances the gray value to 0 (black), so it will be more difficult to render the pixels (they are not displayed below the value of 0.5).  This leads to the fact that the ripple lines shrink closer to the edge (the colors of the peaks mainly act as a gradient). <br><br><img src="https://habrastorage.org/webt/e-/qs/5f/e-qs5fmcvn2fjqd3jdjxnoty-nw.gif"><br><br>  I added a few more nodes to control the thickness of the ripple lines.  Here is the complete graph: <br><br><img src="https://habrastorage.org/webt/vu/b-/so/vub-soqrrulpflvlb3xhnzacme8.jpeg"><br><br>  Just experiment with the speed / direction of scrolling, adjust the texture and try to change the tiling to squeeze the maximum out of the effect. <br><br>  This will help us in creating a more complex shader - a waterfall.  We'll talk about it in the next part. </div><p>Source: <a href="https://habr.com/ru/post/434620/">https://habr.com/ru/post/434620/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../434598/index.html">Looking to the future or what changes are coming in the mining industry until 2050</a></li>
<li><a href="../434602/index.html">How Google tried to conquer China - and lost</a></li>
<li><a href="../434604/index.html">How not to write templates for bootstrap</a></li>
<li><a href="../434616/index.html">Soviet HI-FI and its creators: digital sound recording in the USSR - one step away from victory</a></li>
<li><a href="../434618/index.html">MVP and Dagger 2 - Skeleton Android Application - Part 2</a></li>
<li><a href="../434622/index.html">What worlds can survive the death of the sun?</a></li>
<li><a href="../434624/index.html">How I found a bug in GNU Tar</a></li>
<li><a href="../434626/index.html">New Buhtrap Loader</a></li>
<li><a href="../434628/index.html">bitContainer (for food) - self-made Yandex. Station</a></li>
<li><a href="../434634/index.html">Universal Radio Hacker - an easy way to explore digital radio protocols</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>