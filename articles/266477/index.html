<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Install JBoss BPM Suite</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 The instructions describe how to install and configure BPM Suite. Initially, we define what we get at the end of the entire installation pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Install JBoss BPM Suite</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/476/34a/840/47634a8406374e3d223617ba5edd90f6.jpg" alt="image"><br><br><h2>  <font color="#cc0000">Foreword</font> </h2><br>  The instructions describe how to install and configure BPM Suite.  Initially, we define what we get at the end of the entire installation process.  In this case, this is the JBoss BPM Suite server that works offline (not in domain mode, without clustering) on ‚Äã‚Äãthe RHEL OS (everything is absolutely identical on CentOS).  In order to be able to install the JBoss BPM Suite, it is required that there is already a deployed JBoss EAP.  There are certain dependencies between the BPM and EAP versions, which can be easily found in the RedHat documentation.  This article describes only the procedure for installing BPM 6.1.2, for other versions it may differ. <br><a name="habracut"></a><br><h2>  <font color="#cc0000">Prerequisites</font> </h2><br>  <b>1. JAVA 7</b> <br>  Install JDK version 7.  Configuring environment variables: EAP_HOME, JAVA_HOME, JDK_HOME.  Accordingly, EAP_HOME = path to our JBOSS EAP server, Java variables - to the corresponding folders (java_home - to jdk). <br><br>  <b>2. Install JBOSS EAP</b> <br>  We use BPM (Jboss Business Process Management) Suite version 6.1.2.  As mentioned above, you first need to install the Jboss EAP (Enterprise Application Platform).  For our version (6.1.2) there is a choice of JBoss EAP 6.4 or higher.  Download the distribution from the RedHat site (zip view).  Unpack it on the server. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>3. Configure JBoss EAP</b> <br>  Customize JBoss EAP.  In our case, this is standalone mode (there are 2 operation modes: standalone and domain. The first is for cases when there is no need to configure centralized management, as implemented in domain mode. Usually used when we have 1 or 2 servers. You can combine into Cluster. In domain mode, one server is the manager (master), the others are subordinate (slave). One configuration file. It is convenient when we have a whole group of servers, so you need to edit the standalone.xml file (EAP_HOME / standalone / configuration / standalone. xml) - correct all addresses 127.0.0.1 to the IP address of our server.  This applies to all lines except: <br><br><pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wsdl-host</span></span></span><span class="hljs-tag">&gt;</span></span>${jboss.bind.address:127.0.0.1}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wsdl-host</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  There are only 3 such lines that specify access to the server (127.0.0.1 - it means that access is only from the machine on which the server is installed), they are located in the interfaces block. <br><br>  If you use a different profile, for example standalone-full, then you need to edit the corresponding xml file.  Here we will not touch this. <br><br>  <b>4. User Configuration</b> <br>  Next we add users (EAP_HOME / bin / add-user.sh), one administrator, Management, another Application level (setting the admin role to the second, this is the BPM role. If not added, you can then edit the roles in the / opt / jboss-eap- 6.4 / standalone / configuration / application-roles.properties (example: BPMadmin = admin). <br><br>  Gradually: <br>  <b>A.</b> Run <pre> <code class="hljs pgsql">sh EAP_HOME/bin/<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>.sh</code> </pre> <br>  <b>B.</b> Select the option "a", press Enter <br>  <b>C.</b> Enter user name <br>  <b>D.</b> 2 times enter the password <br>  <b>E.</b> To the question: ‚ÄúWhat groups ...‚Äù just press Enter <br>  <b>F.</b> Is this correct yes / no?  Enter: "yes", press Enter <br>  <b>G.</b> Enter the following question: ‚Äúno‚Äù, press Enter <br><br>  User to manage created. <br><br>  Further: <br>  <b>A.</b> Run <pre> <code class="hljs pgsql">sh EAP_HOME/bin/<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>.sh</code> </pre> <br>  <b>B.</b> Select the option "b", press Enter <br>  <b>C.</b> Enter user name <br>  <b>D.</b> 2 times enter the password <br>  <b>E.</b> To the question: ‚ÄúWhat groups ...‚Äù we enter: ‚Äúadmin‚Äù and press Enter (here the role F. for the user is assigned in the applications) <br>  <b>F.</b> Is this correct yes / no?  Enter: "yes", press Enter <br>  <b>G.</b> Enter the following question: ‚Äúno‚Äù, press Enter <br><br>  <b>5. Configure JBOSS EAP as a service</b> <br>  In order for us to perform actions in the CLI (JBoss EAP terminal management console), as well as to set up a convenient server control (start / restart / stop) and auto-start, we need to configure JBoss EAP as a service.  Thanks to RedHat, this process is quite elementary, the EAP installed includes the files prepared for this process - jboss-as.conf + jboss-as-standalone.sh/jboss-as-domain.sh. <br><br>  What should be done: <br>  <b>A.</b> Copy to / etc / jboss-as / the jboss-as.conf file (located in the EAP_HOME / bin / init.d / path) <br>  <b>B.</b> Edit this file.  We set JBOSS_USER and JBOSS_HOME. <br>  JBOSS_USER = root (user from which the service will run) <br>  JBOSS_HOME = the path in which EAP is set must be equal to EAP_HOME (for example, JBOSS_HOME = / opt / jboss-eap-6.4) <br>  <b>C.</b> jboss-as-standalone.sh is copied to the path /etc/init.d <br>  <b>D.</b> Modify the jboss-as-standalone.sh file through the editor.  Change the config used.  If we have a standalone profile, then there is no need to change, if full or ha, then we change standalone.xml to standalone-full.xml <br>  <b>E.</b> Configure chkconfig.  While in the /etc/init.d folder, we write the command: <pre> <code class="hljs cs">chkconfig --<span class="hljs-keyword"><span class="hljs-keyword">add</span></span> jboss-<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>-standalone.sh</code> </pre> <br>  <b>F.</b> Start the service: <pre> <code class="hljs pgsql">service jboss-<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>-standalone.sh <span class="hljs-keyword"><span class="hljs-keyword">start</span></span></code> </pre> <br>  <b>G.</b> Configure auto start service: <pre> <code class="hljs cs">chkconfig jboss-<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>-standalone.sh <span class="hljs-keyword"><span class="hljs-keyword">on</span></span></code> </pre> <br><br><h2>  <font color="#cc0000">JBOSS BPM Suite</font> </h2><br>  <b>1. Installing BPM Suite</b> <br>  Downloading from the RedHat portal version 6.1.0 for EAP (Deployments for EAP).  Make a backup copy of EAP.  Then we copy certain files into EAP_HOME /.  More about copying files (They cannot be immediately thrown into the folder with EAP, replacing all the files): <br>  <b>A.</b> unpack the downloaded zip archive.  However, do not overwrite all files at once.  You must manually merge the following files in the EAP_HOME directory: <br>  - / domain / configuration / * - (Note that BPM Suite requires JMS, so JMS is added by default to all profile files in the domain.xml provided by jBPM Suite) <br>  - / standalone / configuration / * - (Note that BPM Suite requires JMS, so JMS is added by default to all profile files provided by BPM Suite, such as standalone.xml or standalone-ha.xml) <br>  - jboss-eap-6.4 / modules / layers.conf <br>  - jboss-eap-6.4 / bin / product.conf <br>  <b>B.</b> Make sure that JBOSS EAP does not include applications with matching names.  Copy the / standalone / deployments folder to the EAP_HOME directory. <br>  <b>C.</b> Ensure that there is no similar layer in the modules folder.  Copy the / modules / system / layers / bpms folder to EAP_HOME. <br>  Since we installed pure JBOSS EAP, then at point B and C you can just copy everything safely. <br><br>  <b>2. Update BPM Suite</b> <br>  BPM is installed, now you need to update it to 6.1.2, download for this Update 2. We transfer the folder to the server, clean blacklist.txt, which is located in the root folder (it lists the documents that will not be changed during the update, respectively, leave only that edited).  Being in the downloaded update folder we execute: <br><br><pre> <code class="hljs ruby">$ ./apply-updates.sh ~<span class="hljs-regexp"><span class="hljs-regexp">/EAP_HOME/jboss</span></span>-eap-<span class="hljs-number"><span class="hljs-number">6.4</span></span> eap6.x</code> </pre><br>  The update completes successfully (or not). <br><br>  <b>3. Startup and Version Verification</b> <br>  We check the launch of EAP (sh EAP_HOME / bin / standalone.sh, or: service jboss-as-standalone.sh start).  We look, whether comes into the EAP management console (http: // IP: 9990) and in BPM: <br><ul><li>  <a href="http://ip:8080/business-central">http: // IP: 8080 / business-central</a> <br></li><li>  <a href="http://ip:8080/dashbuilder">http: // IP: 8080 / dashbuilder</a> <br></li></ul><br>  Check the version of the application in about (should be 6.1.2).  Look in the EAP management console for the back-end applications (there are 3, kie-server, dashbuilder, business-central). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7da/088/157/7da0881570aaf32adbd1fd9323bbdb56.jpg" alt="image"><br><br>  If everything is in place, then go to the next item. <br><br><h2>  <font color="#cc0000">MS SQL and BPM Persistence Configuration</font> </h2><br>  <b>1. Creating a database and setting rights</b> <br>  Go to the MS SQL interface.  We create a database there (in our case BPMSuiteDB).  Create a user and assign him ‚Äúdb_owner‚Äù rights to our database. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cc9/dbf/37c/cc9dbf37c385f00034b957b6ba819847.jpg" alt="image"><br><br>  Accordingly, such details as setting the database name to the user, entering the password on the screen are omitted. <br><br>  <b>2. JDBC driver</b> <br>  First you need to configure EAP to work with the created database.  First you need to install jdbc driver.  Download it from the msdn site in tar.gz format.  We unpack and drop the contents of the archive into the EAP_HOME / modules / com / sqlserver / main folder. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/73b/9e6/dee/73b9e6dee1e99a98735108c12471a0db.jpg" alt="image"><br><br>  Since  we have JDK version 7, then sqljdbc4.jar will be used.  We create the module.xml file (since it is not there by default, you can see it on the screen). <br>  Its contents (we copy, we do not correct anything. Name = com.sqlserver - roughly speaking, this is the address in the modules folder where our driver is located, or rather the main folder with its contents): <br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:jboss:module:1.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.sqlserver"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource-root</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sqljdbc4.jar"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javax.api"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javax.transaction.api"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Save, close. <br><br>  Next, the cast driver must be installed in the EAP itself: <br>  <b>A.</b> Run the server as a service: <br><br><pre> <code class="hljs pgsql">service jboss-<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>-standalone.sh <span class="hljs-keyword"><span class="hljs-keyword">start</span></span></code> </pre> <br>  <b>B.</b> Run CLI console: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sh</span></span> EAP_HOME/bin/jboss-cli.sh</code> </pre> <br>  <b>C.</b> Perform: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> IP</code> </pre> <br>  IP, respectively, drive the one that the network adapter of your server. <br>  <b>D.</b> Execute the command: <br><br><pre> <code class="hljs pgsql">/subsystem=datasources/jdbc-driver=DRIVER_NAME:<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(drivername=DRIVER_NAME,driver-module-<span class="hljs-type"><span class="hljs-type">name</span></span>=MODULE_NAME,driver-xadatasource-<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span>=XA_DATASOURCE_CLASS_NAME)</code> </pre><br><br>  We substitute values ‚Äã‚Äãon ours.  Example: <br><pre> <code class="hljs pgsql">/subsystem=datasources/jdbc-driver=sqlserver:<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(drivername=sqlserver,driver-module-<span class="hljs-type"><span class="hljs-type">name</span></span>=com.sqlserver,driver-xa-datasource-<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span>=com.microsoft.sqlserver.jdbc.SQLServerXADataSource)</code> </pre><br><br>  JDBC driver installed. <br><br>  <b>3. Creating an EAP Connection</b> <br>  Now you need to create a connection to the database using our jdbc driver.  The easiest way to do this is through the management console.  Go to the address: IP: 9990, log in under the Managemenet account we created.  Go to the section: Configuration&gt; Connector&gt; Datasources.  Click ‚ÄúAdd‚Äù. <br><br>  We drive in parameters: <br>  Name: MSSQLDS <br>  JNDI: java: / MSSQLDS <br>  Next &gt;&gt; <br>  Choose our driver <br>  Next &gt;&gt; <br>  Connection URL: jdbc: sqlserver: // IP: 1433; DatabaseName = DATABASE_NAME <br>  In our case it is: jdbc: sqlserver: //192.168.101.201: 1433; DatabaseName = BPMsuiteDB <br>  Username and Password - from the user we created for our database in MSSQL. <br>  SecurityDomain left blank.  Click Test connection.  Must earn.  If not, then check the settings of standalone.xml (or ‚Äìfull.xml etc). <br><br>  Connection settings: <br><br><pre> <code class="hljs ruby">&lt;datasource jta=<span class="hljs-string"><span class="hljs-string">"true"</span></span> jndi-name=<span class="hljs-string"><span class="hljs-string">"java:/MSSQLDS"</span></span> pool-name=<span class="hljs-string"><span class="hljs-string">"MSSQLDS"</span></span> enabled=<span class="hljs-string"><span class="hljs-string">"true"</span></span> use-ccm=<span class="hljs-string"><span class="hljs-string">"true"</span></span> statistics-enabled=<span class="hljs-string"><span class="hljs-string">"true"</span></span>&gt; &lt;connection-url&gt;<span class="hljs-symbol"><span class="hljs-symbol">jdbc:</span></span><span class="hljs-symbol"><span class="hljs-symbol">sqlserver:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.101.201:1433;DatabaseName=BPMsuiteDB&lt;/connection</span></span>-url&gt; &lt;driver-<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">microsoft</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sqlserver</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">jdbc</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SQLServerDriver</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">driver</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">&gt; &lt;driver&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sqlserver</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">driver</span></span></span><span class="hljs-class">&gt; &lt;security&gt; &lt;user-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">username</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">&gt; &lt;password&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">password</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">password</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">security</span></span></span><span class="hljs-class">&gt; &lt;validation&gt; &lt;validate-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">on</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">match</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">validate</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">on</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">match</span></span></span><span class="hljs-class">&gt; &lt;background-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">validation</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">background</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">validation</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">validation</span></span></span><span class="hljs-class">&gt; &lt;timeout&gt; &lt;set-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tx</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">query</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">set</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tx</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">query</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">&gt; &lt;blocking-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">millis</span></span></span><span class="hljs-class">&gt;0&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">blocking</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">millis</span></span></span><span class="hljs-class">&gt; &lt;idle-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">minutes</span></span></span><span class="hljs-class">&gt;0&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">idle</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">minutes</span></span></span><span class="hljs-class">&gt; &lt;query-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">&gt;0&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">query</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">&gt; &lt;use-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lock</span></span></span><span class="hljs-class">&gt;0&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">use</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lock</span></span></span><span class="hljs-class">&gt; &lt;allocation-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">retry</span></span></span><span class="hljs-class">&gt;0&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">allocation</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">retry</span></span></span><span class="hljs-class">&gt; &lt;allocation-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">retry</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wait</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">millis</span></span></span><span class="hljs-class">&gt;0&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">allocation</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">retry</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wait</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">millis</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">&gt; &lt;statement&gt; &lt;share-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">prepared</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">statements</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">share</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">prepared</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">statements</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">statement</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">datasource</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre><br><br>  Must be similar to this. <br>  Driver Settings: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">driver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sqlserver"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">module</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.sqlserver"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xa-datasource-class</span></span></span><span class="hljs-tag">&gt;</span></span>com.microsoft.sqlserver.jdbc.SQLServerXADataSource<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xa-datasource-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">driver</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Must be similar to this.  If not, we rule, restart the server and check the connection. <br><br>  <b>4. Configure BPM</b> <br>  Next, you need to configure BPM to work with the database.  At the first connection, BPM will automatically create tables in our database. <br>  First, open the file: EAP_HOME / standalone / deployments / dashbuilder.war / WEB-INF / jboss-web.xml.  We edit it: <br><br><pre> <code class="hljs pgsql">&lt;jboss-web&gt; &lt;context-root&gt;/dashbuilder&lt;/context-root&gt; &lt;resource-<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span>&gt; &lt;res-<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span>&gt;jdbc/dashbuilder&lt;/res-<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span>&gt; &lt;res-<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>&gt;javax.<span class="hljs-keyword"><span class="hljs-keyword">sql</span></span>.DataSource&lt;/res-<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>&gt; &lt;jndi-<span class="hljs-type"><span class="hljs-type">name</span></span>&gt;java:/MSSQLDS&lt;/jndi-<span class="hljs-type"><span class="hljs-type">name</span></span>&gt; &lt;/resource-<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span>&gt;</code> </pre> <br>  Next, go to the file located in the same path: jboss-deployment-structure.xml.  We edit it: <br><br>  In the section we add the line: <br><br><pre> <code class="hljs pgsql">&lt;module <span class="hljs-type"><span class="hljs-type">name</span></span>="com.sqlserver" /&gt;</code> </pre><br>  The next step is to set up business-central.war.  Open the configuration file: EAP_HOME / standalone / deployments / business-central.war / WEB-INF / classes / META-INF / persistence.xml.  We edit the following blocks: <br>  <b>BUT.</b> <pre> <code class="hljs haskell">&lt;jta-<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">-source&gt;java:/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MSSQLDS</span></span></span><span class="hljs-class">&lt;/jta-</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">-source&gt;</span></span></code> </pre> <br>  <b>B.</b> <pre> <code class="hljs pgsql">&lt;property <span class="hljs-type"><span class="hljs-type">name</span></span>="hibernate.dialect" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="org.hibernate.dialect.SQLServerDialect" /&gt;</code> </pre> <br>  We try to run, if errors about the fact that the dialect class is not found, then add: <br><br><pre> <code class="hljs pgsql">&lt;property <span class="hljs-type"><span class="hljs-type">name</span></span>="hibernate.connection.driver_class" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="com.microsoft.sqlserver.jdbc.SQLServerDriver"/&gt; &lt;property <span class="hljs-type"><span class="hljs-type">name</span></span>="hibernate.connection.password" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="password"/&gt; &lt;property <span class="hljs-type"><span class="hljs-type">name</span></span>="hibernate.connection.url" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="jdbc:sqlserver://IP:1433/;DatabaseName=BPMsuiteDB"/&gt; &lt;property <span class="hljs-type"><span class="hljs-type">name</span></span>="hibernate.connection.username" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="username"/&gt;</code> </pre><br>  <b>5. BPM Persistence</b> <br>  It remains to adjust the persistence.  To do this, add lines to persistence.xml in the appropriate sections. <br>  <b>A.</b> Task service block: <br><br><pre> <code class="hljs ruby">&lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">org</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">drools</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">persistence</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SessionInfo</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">&gt; &lt;class&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">org</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">jbpm</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">persistence</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">processinstance</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProcessInstanceInfo</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">&gt; &lt;class&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">org</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">drools</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">persistence</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WorkItemInfo</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre><br>  <b>B.</b> Block properties: <br><br><pre> <code class="hljs pgsql">&lt;property <span class="hljs-type"><span class="hljs-type">name</span></span>="hibernate.transaction.manager_lookup_class" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="org.hibernate.transaction.BTMTransactionManagerLookup"/&gt;</code> </pre><br>  <b>C.</b> Also change: <br><br><pre> <code class="hljs pgsql">&lt;property <span class="hljs-type"><span class="hljs-type">name</span></span>="hibernate.show_sql" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="false" /&gt;</code> </pre><br>  On: <br><br><pre> <code class="hljs pgsql">&lt;property <span class="hljs-type"><span class="hljs-type">name</span></span>="hibernate.show_sql" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="true" /&gt;</code> </pre><br>  You can add various parameters, they are all described in the RedHat documentation (Persistence section).  Save, close.  Restart the server.  All, BPM version 6.1.2 is installed on Jboss EAP 6.4.0 and works with MSSQL DBMS with customized persistence. <br><br>  You can only install JBOSS EAP 6.4 and BPM Suite 6.1.2, in which case the built-in JBOSS EAP database will be used. <br><br>  <b>Documentation used:</b> <br><ul><li>  Configuring JBOSS EAP: <a href="https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6.4/pdf/Administration_and_Configuration_Guide/JBoss_Enterprise_Application_Platform-6.4-Administration_and_Configuration_Guide-en-US.pdf">access.redhat.com/documentation/en-US/JBoss_Enterprise_Application_Platform/6.4/pdf/Administration_and_Configuration_Guide/JBoss_Enterprise_Application_Platform-6.4-Administration_and_Configuration_Guide-en-US.latf</a> <br></li><li>  Install JBOSS BPM Suite: <a href="https://access.redhat.com/documentation/en-US/Red_Hat_JBoss_BPM_Suite/6.1/pdf/Installation_Guide/Red_Hat_JBoss_BPM_Suite-6.1-Installation_Guide-en-US.pdf">access.redhat.com/documentation/en-US/Red_Hat_JBoss_BPM_Suite/6.1/pdf/Installation_Guide/Red_Hat_JBoss_BPM_Suite-6.1-Installation_Guide-en-US.pdf</a> <br></li><li>  Setting up JBOSS BPM Suite: <a href="https://access.redhat.com/documentation/en-US/Red_Hat_JBoss_BPM_Suite/6.1/pdf/Administration_And_Configuration_Guide/Red_Hat_JBoss_BPM_Suite-6.1-Administration_And_Configuration_Guide-en-US.pdf">access.redhat.com/documentation/en-US/Red_Hat_JBoss_BPM_Suite/6.1/pdf/Administration_And_Configuration_Guide/Red_Hat_JBoss_BPM_Suite-6.1-Administration_And_Configuration_Guide-</a> <br></li></ul></div><p>Source: <a href="https://habr.com/ru/post/266477/">https://habr.com/ru/post/266477/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266465/index.html">The history of one facs Yandex. Navigator. In six acts with prologue and remorse</a></li>
<li><a href="../266469/index.html">Intellectual lighting - we get used to this term. Plus a remark from Redwood: lighting should be comfortable, economical and safe</a></li>
<li><a href="../266471/index.html">As I wrote a guitar tuner under iOs on Swift. And also a little about DSP, standing waves and how to achieve an accuracy of ¬± 0.1 Hz</a></li>
<li><a href="../266473/index.html">Thoughts on deploying web applications on a test server</a></li>
<li><a href="../266475/index.html">Flour choice or "Big Three" vs Supermicro</a></li>
<li><a href="../266479/index.html">Happy tickets up to 300 digits</a></li>
<li><a href="../266481/index.html">Work with Ansible - tasks with several unknowns</a></li>
<li><a href="../266483/index.html">How to attract users, select the icon of your application and earn the first million? Read in the news of the week for a mobile developer</a></li>
<li><a href="../266485/index.html">CVSS 3.0 Vulnerability Assessment</a></li>
<li><a href="../266487/index.html">How to organize database testing in dUnit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>