<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Library for authorization through Habrahabr</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good morning to all who are already reading Habrahabr! 

 Working on the ‚ÄúClub of anonymous Santa Clauses‚Äù for Habr, we had to solve the problem with ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Library for authorization through Habrahabr</h1><div class="post__text post__text-html js-mediator-article">  Good morning to all who are already reading Habrahabr! <br><br>  Working on the <a href="http://habra-adm.ru/">‚ÄúClub of anonymous Santa Clauses‚Äù</a> for Habr, we had to solve the problem with authorization of the user through Habr.  On Dirty, the user was offered to place in his profile a special link, the presence of which was checked by their server.  We decided to go the other way and simplify authorization as much as possible for the person who decided to take part in the action. <br><br>  Although in the end, the <a href="https://github.com/kafeman/HabraAuth/">HabraAuth</a> library, which will be discussed in the topic, was not used, but it uses the same authorization principle as on <a href="http://habra-adm.ru/">habra-adm.ru</a> - the user enters his nickname on Habr√©, and from the account of the mail robot or from the developer account he receives a special link on Habropochta, clicking on which he confirms the ownership of his account. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For the end user, when using HabraAuth, the authorization looks even simpler: he enters his nickname, presses ‚ÄúLogin‚Äù and the server drops it to Habromail, where he can only click the ‚ÄúLogin‚Äù link again. <br><br><img src="https://habrastorage.org/storage2/3f0/e16/0db/3f0e160db02d5db2cb1f22fc8bbbd107.png"><br><a name="habracut"></a><br>  Consider an example of connecting HabraAuth for your site.  To get started, download the latest version of the library ‚Äî it's best to do this by cloning the repository on GitHub: <br><br><pre><code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/kafeman/HabraAuth.git</code> </pre> <br>  The library itself is in the file <code>HabraAuth.class.php</code> , it needs to be connected first of all: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(<span class="hljs-string"><span class="hljs-string">'HabraAuth.class.php'</span></span>); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  Now we will create a simple form for authorization.  For example, such: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>    :<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"login"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" !"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  And we will write a handler for it: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,    //        $config = array( //  callback- //        'callback' =&gt; 'http://localhost/sample/callback.php', //  //  - ,     ;-) 'salt' =&gt; 'qwerty', //   ,      //   -  ,        //       'cookies' =&gt; array( 'PHPSESSID' =&gt; '8ba44cc67a851d1c43d740c356665061', 'hsec_id' =&gt; 'c086a2c37f395cbb9aa7b064c8c712db', ), ); //    HabraAuth //       $habraAuth = new HabraAuth($config); //  Auth        $habraAuth-&gt;Auth($_POST['login']); //    ,      header('Location: http://habrahabr.ru/users/none/mail/');</span></span></code> </pre><br><img src="https://habrastorage.org/storage2/7a0/804/dba/7a0804dbafcb628907adb9142fac15a8.png"><br><br>  Now we will create a callback page to which the user will go from Habropochta: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//       ,      if (empty($_GET['user']) || empty($_GET['hash'])) { header('Location: /sample/login.php'); exit(); } //   include __DIR__ . '/../HabraAuth.class.php'; // ,      $config = array('salt' =&gt; 'qwerty'); //    HabraAuth $habraAuth = new HabraAuth($config); //   if (!$habraAuth-&gt;CheckAuth($_GET['user'], $_GET['hash'])) { header('Location: /sample/login.php'); exit(); } // TODO -         echo ', ' . $_GET['user'] . ',   ?'; </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br><br><img src="https://habrastorage.org/storage2/ddb/95a/448/ddb95a4481d46dfa7e2172a14e995000.png"><br><br>  The result was almost OAuth :-) <br><br>  The only problem that you may encounter is that ReadOnly users will start to type in the form of the names of the innocent Habroofs who will start coming to the Spam in a personal form.  To solve this problem, you can put a captcha or enter users into your database in order not to send them a message again. <img src="http://st.habrate.ru/pixel.gif"><br><br>  <b>UPDATE</b> : If you write <a href="http://habrahabr.ru/feedback/%3Ftype%3D8">here</a> , then you can get access to OAuth Habrahabr. </div><p>Source: <a href="https://habr.com/ru/post/157255/">https://habr.com/ru/post/157255/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../157243/index.html">$ 8 for registration in Windows Phone Dev Center</a></li>
<li><a href="../157245/index.html">Linus Torvalds uses KDE again</a></li>
<li><a href="../157249/index.html">Unusual way to learn a foreign language</a></li>
<li><a href="../157251/index.html">On the basis of the Raspberry Pi made a full-fledged netbook (+ the idea of ‚Äã‚Äãthe competition)</a></li>
<li><a href="../157253/index.html">The network posted a dump Android 4.2 c Nexus 4</a></li>
<li><a href="../157257/index.html">Microsoft is testing its own smartphone</a></li>
<li><a href="../157259/index.html">Test suite to help a freelancer survive on Elance.com</a></li>
<li><a href="../157263/index.html">Ocean robot Mercury withstood the onslaught of Hurricane Sandy</a></li>
<li><a href="../157265/index.html">Control flow abstraction</a></li>
<li><a href="../157267/index.html">Entity Framework 6 - ALPHA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>