<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The play "Developing a multiplayer online game." Part 1: Architecture</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 2: Protocol 
 Part 3: Client-server communication 
 Part 4: Moving to 3D 

 In general, as promised, I publish a series of articles on the develo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The play "Developing a multiplayer online game." Part 1: Architecture</h1><div class="post__text post__text-html js-mediator-article"><img src="http://solverit.ru/img/Habr2_2.JPG" alt="image"><br><br>  <a href="http://habrahabr.ru/blogs/gdev/123748/">Part 2: Protocol</a> <br>  <a href="http://habrahabr.ru/blogs/gdev/124311/">Part 3: Client-server communication</a> <br>  <a href="http://habrahabr.ru/blogs/gdev/136467/">Part 4: Moving to 3D</a> <br><br>  In general, as promised, I publish a series of articles on the development of multiplayer network game.  Initially, I just wanted to roll an article on the development of the server part in the interesting Scala language.  But I realized that one little article for the deployment of the topic will not work.  And to write the next topic about everything and never wanted to, initially.  Therefore, meet the play in three acts.  During which we will develop the project architecture, we will implement the server and client parts ... <br>  Everyone remembers cool tanchiki on dandy? <br>  Well, using the example of these tanchiki we will develop a server and a client. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  <i>For fans of freebies and hard copy-paste I will say right away that there will be no complete source codes.</i>  <i>I will upload only some interesting (complicated?) Moments of both server and client.</i> <br><br>  So let's start dear viewers. <br>  In the course of our narration, you will plunge into the world of network gaming ... you will know the sweet fruit of the forbidden scala code and get the opportunity to taste the coding under flash ... and as a final action we will try to arrange a habraeffect for the finished project that I will run on a separate server to test the resulting architecture on real hardware . <br><br><h4>  Part one.  Action one: General description of the project. </h4><br>  Let us write in order what we will do. <br><br>  Since we are not faced with the task of making our BigWorld (this engine is for those who do not know it) and we are creating a prototype, we simplify our task wherever possible.  For our main task is to show how network games are developed in general.  On a concrete, working example.  And do not make a finished commercial product. <br><br>  <b>Task</b> : Network game like ‚Äútanchiki on dandy‚Äù.  Client part on Flash, server on Scala.  Sockets connection.  In order to remove many troubles, we will make an asynchronous server according to the principle ‚ÄúWhoever got up earlier - that and sneakers‚Äù. <br><br>  What is generally meant by the client server-side interaction in the game? <br>  1. User login <br>  2. Exchange with the server (Sending a command from the client to the server, Receiving a response to a command from the server, Receiving a command from the server) <br>  3. Adimin part of server management <br><br>  User login is the primary authentication in the game.  We do everything in a simple way and the check will go only at the login stage.  In general, the authorization should be periodically checked in the game for every fireman from cheaters.  When you first log in with a new login, the game puts it into the database and that‚Äôs all registration. <br><br>  Admin part is also primitive.  We will display a list of users online.  It is useful for load testing. <br><br>  Exchange with the server - this is the game protocol.  We'll write it down when we do the server implementation. <br><br>  <b>Server</b> <br><br>  In the server implementation, we will not bother with any synchronous client synchronization options (history playback, prediction, etc., etc.).  (I bent it - synchronous synchronization ... - author's note) <br>  Those.  The principle is very simple.  We measure ping to the client and thus know the delay of each client.  This allows us to remove the influence of customers with poor connectivity for the whole game and the implementation is simpler than the synchronous options.  Yes, with this option it is possible that when the ping is very long, get a slide show.  But at the same time everything will be processed correctly.  And only clients with a big ping will have a slide show.  In the load will get the need to store the current value of the ping for each client. <br><br>  With a general description of the project, everything seems to be clear. <br><br><h4>  Part one.  Step Two: Server architecture. </h4><br><br>  I just want to warn you that the article is to some extent research.  Those.  in the process of implementation and load testing of the server, its architecture can (and will) change under the influence of various circumstances ... <br><br>  The general scheme is as follows: <br><br><img src="https://habrastorage.org/storage1/c68f345e/cb99c836/3b18f5ce/5f65cc60.png"><br><br>  In general, we do the classical scheme with a pool of threads.  Our game is simple, there is no physics in it, and indeed there are few calculations on the server. <br><br>  <b>The general logic of the server is as follows.</b> <br>  1. We receive from the client an authorization request. <br>  2. Randomly give the coordinates of the appearance of the tank on the map. <br>  3. The client sends its coordinates to the server with a periodicity (During the movement more often). <br>  4. When fired, the coordinates of the point from where it originated are sent to the server. <br>  5. The server calculates the flight of the projectile and decides whether there is a hit or not. <br>  6. Also while driving, the server detects obstacles.  And it does not allow the tank to move in this direction. <br>  7. At the request of the client, the server transmits the number of clients online. <br><br>  Here, in general, and all that is intended. <br><br>  In the future, if the habrovans are interested, this scheme can be expanded to a normal architecture with the separation of server parts on different machines. <br><br>  In a couple of days there will be the next part in which we will develop an exchange protocol, we will implement a TCP server and make the first connection between the server and the client. <br><br>  PS In fact, the topic is very extensive.  Therefore, if there are any wishes on what to focus or there is something that I lost sight of when describing - well in the kament. <br>  Your wishes and criticism will make the next part of the story more useful and constructive. <br><br>  <b>upd.</b>  At the request of habravchan opened <a href="https://github.com/solverit/mserver">Github</a> for the project </div><p>Source: <a href="https://habr.com/ru/post/123220/">https://habr.com/ru/post/123220/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123214/index.html">Inviter: how to remove topics with 1500+ comments about invites</a></li>
<li><a href="../123215/index.html">Automation through integration. Promotional version. UPD</a></li>
<li><a href="../123216/index.html">More about Python descriptors</a></li>
<li><a href="../123217/index.html">Competition from iLab: prize - Playbook!</a></li>
<li><a href="../123219/index.html">One-two-three-four-five, I am going to present</a></li>
<li><a href="../123221/index.html">Solaris Container (zone). Creation and administration. Part 1</a></li>
<li><a href="../123222/index.html">My experience with AOP and PostSharp</a></li>
<li><a href="../123223/index.html">My subjective experience with SSD</a></li>
<li><a href="../123225/index.html">Search office fermer.mobi</a></li>
<li><a href="../123226/index.html">Answers to Habra from Skolkovo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>