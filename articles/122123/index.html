<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Solving the Einstein's Puzzle by Haskell</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prelude 
 Not so long ago I read an article on Habr√© that reminded me of an interesting puzzle, which is called the ‚Äú Einstein 's Mystery ‚Äù or the ‚ÄúZe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Solving the Einstein's Puzzle by Haskell</h1><div class="post__text post__text-html js-mediator-article"><h4>  Prelude </h4><img align="right" src="https://habrastorage.org/getpro/habr/post_images/fe5/e41/f32/fe5e41f32015247a8f88c340181ebab7.jpg" alt="Albert_einstein"><br>  Not so long ago I read <a href="http://habrahabr.ru/blogs/crazydev/121061/">an article</a> on Habr√© that reminded me of an interesting puzzle, which is called the ‚Äú <a href="http://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25B3%25D0%25B0%25D0%25B4%25D0%25BA%25D0%25B0_%25D0%25AD%25D0%25B9%25D0%25BD%25D1%2588%25D1%2582%25D0%25B5%25D0%25B9%25D0%25BD%25D0%25B0">Einstein</a> 's <a href="http://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25B3%25D0%25B0%25D0%25B4%25D0%25BA%25D0%25B0_%25D0%25AD%25D0%25B9%25D0%25BD%25D1%2588%25D1%2582%25D0%25B5%25D0%25B9%25D0%25BD%25D0%25B0">Mystery</a> ‚Äù or the ‚ÄúZebra puzzle‚Äù.  Probably many of you solved this problem on a piece of paper and were proud to be part of a few percent of the world's population who are capable of it. <br><br>  After reading the article, I thought about the software solution of this problem.  The approach given in the article was interesting and fully justified the name of the blog, but it seemed to me not quite clear.  At the moment I'm interested in the Haskell programming language, which is perfect for warming up brains by itself, but solving the puzzle on it seemed like a great challenge. <br><a name="habracut"></a><br><br><h5>  Algorithm </h5><br>  In general, the task looks like this: <br><ul><li>  there is an ordered set of objects (in the condition there are five of them and these are houses on one street) </li><li>  Each object has a set of attributes, which in turn can take a fixed set of values ‚Äã‚Äã(there are also five such attributes: the nationality of the owner, the color of the house, a pet, a favorite drink, and the brand of the owner‚Äôs cigarettes); </li><li>  attribute values ‚Äã‚Äãcannot be the same for different objects and the number of values ‚Äã‚Äãfor each attribute is equal to the number of objects. </li><li>  In addition, a number of restrictions (15) are given, which describe combinations of attribute values ‚Äã‚Äã(the full text of the condition can be found at one of the links at the beginning of the article). </li></ul> It is necessary to restore the values ‚Äã‚Äãof the attributes of all objects (or some of them, which are otherwise the same), which would not contradict the restrictions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first thought was a complete enumeration of options with checking the fulfillment of the conditions of the task, but simple calculations show that the number of combinations is equal <br> <code>5! <sup>5</sup> = 24.883.200.000</code>  <code>5! <sup>5</sup> = 24.883.200.000</code> , which is quite a lot. <br><br>  In the course of some reflections, the following approach was born: there is an admissible solution space, constraints describe subsets of solutions, correct solutions lie at the intersection of such subsets (that is, in the area where all conditions are fulfilled). <br><br>  The next step was the decision to describe the subsets of solutions in the form of a set of patterns: decisions in which some attributes of some objects are fixed, and the rest can take any valid values.  And having such a description you only need to learn how to intersect the sets described in this way. <br><br><h5>  Decision </h5><br>  When compiling and rewriting a solution in the Haskell language, I was guided not only by the desire to find a solution to the problem, but also by the desire to write an understandable program that would easily demonstrate both the algorithm and the excellent Haskell language. <br><br>  Therefore, I tried to minimally use approaches that prevent unprepared people from reading the program.  The solution does not claim complete universality, however, some tools for solving this class of problems have been described. <br><br>  However, read for yourself - I left a lot of comments for you. <br>  But your comments, I will be glad. <br><blockquote><ol><li></li><li>  <font color="#06c"><b>import</b></font> data <font color="#339933"><b>.</b></font>  List ( <b>lookup</b> <font color="#339933"><b>,</b></font> nub) </li><li>  <font color="#06c"><b>import</b></font> data <font color="#339933"><b>.</b></font>  <font color="#cccc00"><b>Maybe</b></font> (fromMaybe <font color="#339933"><b>,</b></font> catMaybes) </li><li></li><li>  <font color="#5d478b"><i>-----------------------------------------------</i></font> </li><li>  <font color="#5d478b"><i>- The Mystery of Einstein -</i></font> </li><li>  <font color="#5d478b"><i>- by Atamur -</i></font> </li><li>  <font color="#5d478b"><i>-----------------------------------------------</i></font> </li><li></li><li>  <font color="#5d478b"><i>---------------------------</i></font> </li><li>  <font color="#5d478b"><i>- General description of the task -</i></font> </li><li>  <font color="#5d478b"><i>---------------------------</i></font> </li><li></li><li>  <font color="#5d478b"><i>- The solution is a sequence of objects</i></font> </li><li>  <font color="#06c"><b>type</b></font> Solution <font color="#339933"><b>=</b></font> [Object] </li><li>  <font color="#5d478b"><i>- Each object is described by a set of attribute pairs and their values.</i></font> </li><li>  <font color="#06c"><b>type</b></font> Object <font color="#339933"><b>=</b></font> [( <font color="#cccc00"><b>String</b></font> <font color="#339933"><b>,</b></font> <font color="#cccc00"><b>String</b></font> )] </li><li></li><li>  <font color="#5d478b"><i>- indicating the attribute-value pair with the = sign:</i></font> </li><li>  attr <font color="#339933"><b>=</b></font> : value <font color="#339933"><b>=</b></font> (attr <font color="#339933"><b>,</b></font> value) </li><li></li><li>  attributes <font color="#339933"><b>=</b></font> [ <font color="#3cb371">"nationality"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"house"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"pet"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"drink"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"smoke"</font> ] </li><li>  size <font color="#339933"><b>=</b></font> 5 </li><li></li><li>  <font color="#5d478b"><i>- We will solve the problem of finding a solution that satisfies some</i></font> </li><li>  <font color="#5d478b"><i>- restrictions</i></font> </li><li>  <font color="#5d478b"><i>- We will do this starting from the set of all solutions and gradually refining</i></font> </li><li>  <font color="#5d478b"><i>- this is a set until it decreases to one solution, which will be</i></font> </li><li>  <font color="#5d478b"><i>- true.</i></font> </li><li></li><li>  <font color="#5d478b"><i>- Therefore, an object can immediately describe a set of real objects</i></font> </li><li>  <font color="#5d478b"><i>- which have some attributes set, and the rest (not set)</i></font> </li><li>  <font color="#5d478b"><i>- can be any.</i></font>  <font color="#5d478b"><i>Therefore, an empty object is a template of all possible</i></font> </li><li>  <font color="#5d478b"><i>- objects:</i></font> </li><li>  anyObject <font color="#339933"><b>=</b></font> [] <font color="#339933"><b>::</b></font> Object </li><li>  <font color="#5d478b"><i>- A set of empty objects - the set of all solutions for a given</i></font> </li><li>  <font color="#5d478b"><i>- dimensions:</i></font> </li><li>  anySolution <font color="#339933"><b>=</b></font> [anyObject <font color="#339933"><b>|</b></font>  n <font color="#339933"><b>‚Üê</b></font> [1 <font color="#339933"><b>..</b></font> size]] </li><li></li><li>  <font color="#5d478b"><i>- Each solution describes a compatible set of solutions, for example, a solution</i></font> </li><li>  <font color="#5d478b"><i>- [["nationality" =: "Englishman"], anyObject, anyObject]</i></font> </li><li>  <font color="#5d478b"><i>- describes all three objects, the first of which has an attribute</i></font> </li><li>  <font color="#5d478b"><i>- "nationality is English"</i></font> </li><li>  <font color="#5d478b"><i>‚ÄúBut when refining solutions, we will need to have sets of incompatible</i></font> </li><li>  <font color="#5d478b"><i>- decisions (for example, ‚ÄúEnglishman or first or second but not at the same time‚Äù):</i></font> </li><li>  <font color="#06c"><b>type</b></font> Solutions <font color="#339933"><b>=</b></font> [Solution] </li><li></li><li>  empty <font color="#339933"><b>=</b></font> [] <font color="#339933"><b>::</b></font> Solutions </li><li></li><li>  <font color="#5d478b"><i>- To solve the problem, we need to impose restrictions on the solution</i></font> </li><li>  <font color="#5d478b"><i>- Each constraint will transform a variety of solutions.</i></font> </li><li>  <font color="#5d478b"><i>- As a result, there may be several unrelated sets or</i></font> </li><li>  <font color="#5d478b"><i>- empty solution set</i></font> </li><li>  <font color="#06c"><b>type</b></font> Restriction <font color="#339933"><b>=</b></font> Solution <font color="#339933"><b>‚Üí</b></font> Solutions </li><li></li><li>  <font color="#5d478b"><i>- applying a constraint to a set of solutions</i></font> </li><li>  <font color="#5d478b"><i>- when transforming a set of solutions, we will check for</i></font> </li><li>  <font color="#5d478b"><i>- uniqueness of attribute values:</i></font> </li><li>  apply <font color="#339933"><b>::</b></font> Restriction <font color="#339933"><b>‚Üí</b></font> Solutions <font color="#339933"><b>‚Üí</b></font> Solutions </li><li>  apply restrict sols <font color="#339933"><b>=</b></font> </li><li>  <b>concat</b> [ <b>filter</b> ( <b>not</b> <font color="#339933"><b>.</b></font> duplicates) (restrict solution) <font color="#339933"><b>|</b></font>  solution <font color="#339933"><b>‚Üê</b></font> sols] </li><li>  <font color="#06c"><b>where</b></font> </li><li>  duplicates sols <font color="#339933"><b>=</b></font> <b>any</b> duplicateValues ‚Äã‚Äã( <b>map</b> (values ‚Äã‚Äãsols) attributes) </li><li>  values ‚Äã‚Äãsols attr <font color="#339933"><b>=</b></font> <b>map</b> ( <b>lookup</b> attr) sols </li><li>  duplicateValues ‚Äã‚Äãvals' <font color="#339933"><b>=</b></font> </li><li>  <font color="#06c"><b>let</b></font> vals <font color="#339933"><b>=</b></font> catMaybes vals' </li><li>  <font color="#06c"><b>in</b></font> (vals <font color="#339933"><b>‚â†</b></font> nub vals) </li><li></li><li>  <font color="#5d478b"><i>- the intersection of two patterns describing objects</i></font> </li><li>  <font color="#5d478b"><i>- can be a template containing attributes from both source templates,</i></font> </li><li>  <font color="#5d478b"><i>- or it may be incompatible if the source templates contain different</i></font> </li><li>  <font color="#5d478b"><i>- values ‚Äã‚Äãof the same attributes</i></font> </li><li>  both <font color="#339933"><b>::</b></font> Object <font color="#339933"><b>‚Üí</b></font> Object <font color="#339933"><b>‚Üí</b></font> <font color="#cccc00"><b>Maybe</b></font> Object </li><li>  both obj obj ' <font color="#339933"><b>=</b></font> <b>foldl</b> join (Just []) attributes <font color="#5d478b"><i>- combine by attributes</i></font> </li><li>  <font color="#06c"><b>where</b></font> </li><li>  <font color="#5d478b"><i>- if we already have an empty set then the result is also empty</i></font> </li><li>  join Nothing <font color="#339933"><b>_</b></font> <font color="#339933"><b>=</b></font> Nothing </li><li>  <font color="#5d478b"><i>- otherwise compare values ‚Äã‚Äãof attributes by attributes.</i></font> </li><li>  join (Just rest) attr <font color="#339933"><b>=</b></font> </li><li>  <font color="#06c"><b>case</b></font> ( <b>lookup</b> attr obj <font color="#339933"><b>,</b></font> <b>lookup</b> attr obj ') <font color="#06c"><b>of</b></font> </li><li>  (Nothing <font color="#339933"><b>,</b></font> Nothing) <font color="#339933"><b>‚Üí</b></font> Just rest </li><li>  (Just value <font color="#339933"><b>,</b></font> Nothing) <font color="#339933"><b>‚Üí</b></font> Just ((attr <font color="#339933"><b>=</b></font> : value): rest) </li><li>  (Nothing <font color="#339933"><b>,</b></font> Just value) <font color="#339933"><b>‚Üí</b></font> Just ((attr <font color="#339933"><b>=</b></font> : value): rest) </li><li>  (Just value <font color="#339933"><b>,</b></font> Just value ') <font color="#339933"><b>‚Üí</b></font> </li><li>  <font color="#06c"><b>if</b></font> value <font color="#339933"><b>==</b></font> value ' </li><li>  <font color="#06c"><b>then</b></font> Just ((attr <font color="#339933"><b>=</b></font> : value): rest) </li><li>  <font color="#06c"><b>else</b></font> Nothing </li><li></li><li>  <font color="#5d478b"><i>- basic restriction - the object in some position must coincide with</i></font> </li><li>  <font color="#5d478b"><i>- set by template</i></font> </li><li>  objectAt <font color="#339933"><b>::</b></font> <font color="#cccc00"><b>Int</b></font> <font color="#339933"><b>‚Üí</b></font> Object <font color="#339933"><b>‚Üí</b></font> Restriction </li><li>  objectAt n obj solution <font color="#339933"><b>=</b></font> </li><li>  <font color="#06c"><b>case</b></font> both obj (solution <font color="#339933"><b>!!</b></font> (n <font color="#339933"><b>-</b></font> 1)) <font color="#06c"><b>of</b></font> </li><li>  Nothing <font color="#339933"><b>‚Üí</b></font> empty <font color="#5d478b"><i>- if the template is not compatible with the one already there</i></font> </li><li>  Just res <font color="#339933"><b>‚Üí</b></font> [replace n res solution] </li><li>  <font color="#06c"><b>where</b></font> </li><li>  replace nx xs <font color="#339933"><b>=</b></font> <b>take</b> (n <font color="#339933"><b>-</b></font> 1) xs <font color="#339933"><b>++</b></font> [x] <font color="#339933"><b>++</b></font> <b>drop</b> n xs </li><li></li><li>  <font color="#5d478b"><i>- Operations on constraints ---------------------------------------------</i></font> </li><li></li><li>  <font color="#5d478b"><i>- intersection - both restrictions are true</i></font> </li><li>  ( <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> ) rs rs 'solution <font color="#339933"><b>=</b></font> apply rs (rs' solution) </li><li>  r <font color="#339933"><b>_</b></font> all <font color="#339933"><b>=</b></font> <b>foldl1</b> ( <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> ) <font color="#5d478b"><i>- all restrictions from the set</i></font> </li><li></li><li>  <font color="#5d478b"><i>- association - one or the other is true</i></font> </li><li>  ( <font color="#339933"><b>&lt;|&gt;</b></font> ) rs rs 'solution <font color="#339933"><b>=</b></font> rs solution <font color="#339933"><b>++</b></font> rs' solution </li><li>  r <font color="#339933"><b>_</b></font> any <font color="#339933"><b>=</b></font> <b>foldl1</b> ( <font color="#339933"><b>&lt;|&gt;</b></font> ) <font color="#5d478b"><i>- one of the limitations</i></font> </li><li></li><li>  <font color="#5d478b"><i>- Derived constraints ---------------------------------------------- -</i></font> </li><li></li><li>  <font color="#5d478b"><i>- there is some object (either in the first position, or in the second, etc.)</i></font> </li><li>  exists obj <font color="#339933"><b>=</b></font> r <font color="#339933"><b>_</b></font> any [objectAt n obj <font color="#339933"><b>|</b></font>  n <font color="#339933"><b>‚Üê</b></font> [1 <font color="#339933"><b>..</b></font> 5]] </li><li></li><li>  <font color="#5d478b"><i>- one object always follows another</i></font> </li><li>  before obj obj ' <font color="#339933"><b>=</b></font> r <font color="#339933"><b>_</b></font> any [ </li><li>  objectAt n obj <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> objectAt (n <font color="#339933"><b>+</b></font> 1) obj ' <font color="#339933"><b>|</b></font>  n <font color="#339933"><b>‚Üê</b></font> [1 <font color="#339933"><b>..</b></font> size <font color="#339933"><b>-</b></font> 1]] </li><li></li><li>  <font color="#5d478b"><i>- near (or one before the second, or second before the first)</i></font> </li><li>  near obj obj ' <font color="#339933"><b>=</b></font> (obj `before` obj') <font color="#339933"><b>&lt;|&gt;</b></font> (obj 'before` obj) </li><li></li><li>  <font color="#5d478b"><i>------------------------------------------------</i></font> </li><li>  <font color="#5d478b"><i>- Description of the specific problem</i></font> </li><li>  <font color="#5d478b"><i>------------------------------------------------</i></font> </li><li></li><li>  restrictions <font color="#339933"><b>=</b></font> </li><li>  objectAt 1 [ <font color="#3cb371">"nationality"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Norwegian"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"nationality"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Englishman"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"house"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Red"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  ([ <font color="#3cb371">"house"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Green"</font> ] `before` [ <font color="#3cb371">" house "</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">" White "</font> ]) <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"nationality"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Dane"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"drink"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Tea"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  ([ <font color="#3cb371">"smoke"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Malboro"</font> ] `near` [ <font color="#3cb371">" pet "</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">" Cat "</font> ]) <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"smoke"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Dunhill"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"house"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Yellow"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"nationality"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"German"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"smoke"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Rothmans"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  objectAt 3 [ <font color="#3cb371">"drink"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Milk"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  ([ <font color="#3cb371">"smoke"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Malboro"</font> ] `near` [ <font color="#3cb371">" drink "</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">" Water "</font> ]) <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"smoke"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Pallmall"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"pet"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Bird"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"nationality"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Swede"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"pet"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Dog"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  ([ <font color="#3cb371">"nationality"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Norwegian"</font> ] `near` [ <font color="#3cb371">" house "</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">" Blue "</font> ]) <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"pet"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Horse"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"house"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Blue"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"smoke"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Winfield"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"drink"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Beer"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"house"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Green"</font> <font color="#339933"><b>,</b></font> <font color="#3cb371">"drink"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Coffee"</font> ] <font color="#339933"><b>&lt;</b></font> &amp; <font color="#339933"><b>&gt;</b></font> </li><li>  exists [ <font color="#3cb371">"pet"</font> <font color="#339933"><b>=</b></font> : <font color="#3cb371">"Fish"</font> ] </li><li>  <font color="#5d478b"><i>- the fish does not appear anywhere, you need to ask what it is</i></font> </li><li></li><li>  main <font color="#339933"><b>=</b></font> <font color="#06c"><b>let</b></font> solutions <font color="#339933"><b>=</b></font> apply restrictions [anySolution] </li><li>  <font color="#06c"><b>in</b></font> <font color="#06c"><b>if</b></font> <b>length</b> solutions <font color="#339933"><b>&gt;</b></font> 1 </li><li>  <font color="#06c"><b>then</b></font> <b>putStrLn</b> ( <font color="#3cb371">"Total solution sets:"</font> <font color="#339933"><b>++</b></font> <b>show</b> ( <b>length</b> solutions)) </li><li>  <font color="#06c"><b>else</b></font> <b>putStrLn</b> <font color="#339933"><b>$</b></font> descrSolution <font color="#339933"><b>$</b></font> <b>head</b> solutions </li><li></li><li>  <font color="#5d478b"><i>-----------------------------</i></font> </li><li>  <font color="#5d478b"><i>- String views -</i></font> </li><li>  <font color="#5d478b"><i>-----------------------------</i></font> </li><li></li><li>  <font color="#5d478b"><i>- a string representation of a person:</i></font> </li><li>  descrMan man <font color="#339933"><b>=</b></font> descr <font color="#3cb371">"nationality"</font> <font color="#339933"><b>++</b></font> <font color="#3cb371">"lives in"</font> <font color="#339933"><b>++</b></font> </li><li>  descr <font color="#3cb371">"house"</font> <font color="#339933"><b>++</b></font> <font color="#3cb371">"house, owns"</font> <font color="#339933"><b>++</b></font> </li><li>  descr <font color="#3cb371">"pet"</font> <font color="#339933"><b>++</b></font> <font color="#3cb371">", drinks"</font> <font color="#339933"><b>++</b></font> </li><li>  descr <font color="#3cb371">"drink"</font> <font color="#339933"><b>++</b></font> <font color="#3cb371">"and smokes"</font> <font color="#339933"><b>++</b></font> </li><li>  descr <font color="#3cb371">"smoke"</font> </li><li>  <font color="#06c"><b>where</b></font> descr attr <font color="#339933"><b>=</b></font> fromMaybe <font color="#3cb371">"?"</font>  ( <b>lookup</b> attr man) </li><li></li><li>  <font color="#5d478b"><i>- string representation of the solution:</i></font> </li><li>  descrSolution sol <font color="#339933"><b>=</b></font> <b>concat</b> [descrMan man <font color="#339933"><b>++</b></font> <font color="#3cb371">" <font>\ n</font> "</font> <font color="#339933"><b>|</b></font>  man <font color="#339933"><b>‚Üê</b></font> sol] </li><li></li></ol></blockquote></div><p>Source: <a href="https://habr.com/ru/post/122123/">https://habr.com/ru/post/122123/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122113/index.html">Survivor bias</a></li>
<li><a href="../122115/index.html">Navigation: bad advice</a></li>
<li><a href="../122117/index.html">Chrome beta now has support for ‚Äúinstant pages‚Äù and print preview.</a></li>
<li><a href="../122119/index.html">Hacked server service SEGA Pass</a></li>
<li><a href="../122121/index.html">Mysterious number 6174</a></li>
<li><a href="../122124/index.html">How to add friends to Facebook by their email address</a></li>
<li><a href="../122126/index.html">Microsoft calls the graphics technology used in Firefox and Chrome dangerous</a></li>
<li><a href="../122127/index.html">Groovy in 15 Minutes Overview</a></li>
<li><a href="../122129/index.html">Character distribution in passwords</a></li>
<li><a href="../122130/index.html">Firefox 5 is released</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>