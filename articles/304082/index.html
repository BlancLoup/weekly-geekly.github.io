<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Developing a script to compare people's tastes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings,% username%. Today, we will develop a script for compiling a ranking of similarity of interests between people. 

 Interested? I ask under t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Developing a script to compare people's tastes</h1><div class="post__text post__text-html js-mediator-article">  Greetings,% username%.  Today, we will develop a script for compiling a ranking of similarity of interests between people. <br><br>  Interested?  I ask under the cat <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>Instead of intro</b> </h4><br><br>  I would like to note that this method works effectively only for the greatest relationship between the number of characteristics of a set and the number of sets.  Otherwise I recommend using this <a href="https://habrahabr.ru/company/ivi/blog/232843/">method.</a> <br><br><h4>  <b>Theory</b> </h4><br><br>  So let's start from afar.  Imagine two some data sets.  We call them <b>p</b> and <b>q</b> .  Let each of these sets characterize two numbers.  Then we represent these sets as points in the space L with the dimension dimL = n, where n is the number of characteristics.  In this case, 2 <br><br>  <b>p (p1; p2)</b> and <b>q (q1; q2)</b> <br><br>  We define some metric d (p, q) = k, where k is a coefficient.  the differences of the two sets.  We define the metric as the Euclidean distance between these two points, that is, from the angeme course we know: <br><br><img src="https://habrastorage.org/files/6e6/f5f/c9e/6e6f5fc9e8d24539ac7656e3ac755f07.JPG"><br><br>  By our definition, it follows that the difference between two sets is the distance between the points with which we compare our sets.  Then the difference between the two data sets is found by the Pythagorean theorem, oh how! <br><br>  Then for two identical sets the distance will be zero. <br><br><h5>  <b>And what does it all mean?</b> </h5><br><br>  Consider an example.  Take two subjects, let's call them Vasya (B) and Kohl (K).  Ask them questions: <br><br>  1) - Rate on a 10-point scale how much you like peaches <br>  2) - Rate on a 10-point scale how much do you like strawberries <br><br>  Suppose that Vasya and Kolya answered the same way.  Then, obviously, the distance between the points will be zero, that is, in these sets of their interests / tastes they are identical.  Consider now the case of different answers. <br><br>  B: on (1) gave 5, on (2) gave 8 <br>  K: on (3) gave 10, on (2) gave 0 <br><br>  Then we can imagine in a two-dimensional space points for Kolya and Vasya: <br><br>  In (5; 8) and K (10; 0), the distance between them, as it is easy to calculate 9.4.  This is the coefficient.  the differences.  But ... wait, how to interpret it? <br><br>  Let's get a look.  The minimum difference is zero with complete coincidence of the sets, this is understandable.  But what about the maximum?  Consider some delta neighborhood on our plane.  since the maximum number of points is 10, then the delta will be equal to 10, that is, according to the Pythagorean theorem, sqrt (100 + 100) = 14.14 - this is the maximum difference at which data sets can be considered opposite.  Thus, Kolya and Vasya in this case have more differences than similarities. <br><br><h4>  <b>And why is this all?</b> </h4><br><br>  Applications can be found anywhere.  Dating sites, freelance sites, job sites, etc.  Creating questionnaires, you can create a certain map of interests and tastes by which you can find couples for relationships.  Love, friendship, labor, any. <br><br>  We implement the example of mapping the interests of people.  And at once we will test, on the example of my friends. <br><br>  We will use python, since this PL is most suitable for implementing such algorithms.  First of all, due to the convenience of working with dictionaries (hashes / associative arrays), as well as thanks to the smart built-in module pickle, which will allow us to save dictionaries with questions and answers directly to disk and then use it.  By tradition, all the code can be viewed at the end of the article. <br><br>  To calculate the metric we will use the following code: <br><br><div class="spoiler">  <b class="spoiler_title">Metric calculation</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(nPoint)</span></span></span><span class="hljs-function">:</span></span> result = <span class="hljs-number"><span class="hljs-number">0.0</span></span> print(<span class="hljs-string"><span class="hljs-string">"sqrt("</span></span>, end=<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Dictionary: print(<span class="hljs-string"><span class="hljs-string">"("</span></span>, Points[nPoint[<span class="hljs-number"><span class="hljs-number">0</span></span>]][key], <span class="hljs-string"><span class="hljs-string">" - "</span></span>, Points[nPoint[<span class="hljs-number"><span class="hljs-number">1</span></span>]][key], <span class="hljs-string"><span class="hljs-string">")^2 + "</span></span>, sep=<span class="hljs-string"><span class="hljs-string">""</span></span>, end=<span class="hljs-string"><span class="hljs-string">""</span></span>) result = result + math.pow((Points[nPoint[<span class="hljs-number"><span class="hljs-number">0</span></span>]][key] - Points[nPoint[<span class="hljs-number"><span class="hljs-number">1</span></span>]][key]),<span class="hljs-number"><span class="hljs-number">2</span></span>) print(<span class="hljs-string"><span class="hljs-string">")"</span></span>) result = math.sqrt(result) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result</code> </pre> <br></div></div><br><br>  The function takes a tuple of two numbers that tell which data sets to analyze (data sets are stored in the dictionary of the dictionary, where the keys are the number of the set) that are in the Points dictionary. <br><br>  The function returns the coefficient.  the differences of the two sets. <br><br>  In order to "map" the interests we need to analyze each set, not just two.  For this there is a function: <br><br><div class="spoiler">  <b class="spoiler_title">Generation coefficients</b>  <b class="spoiler_title">for each set</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">"~~~~"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, PSize): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(i + <span class="hljs-number"><span class="hljs-number">1</span></span>, PSize + <span class="hljs-number"><span class="hljs-number">1</span></span>): print(i, <span class="hljs-string"><span class="hljs-string">" and "</span></span>, j, <span class="hljs-string"><span class="hljs-string">" = "</span></span>, calc( (i, j) ), sep=<span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre><br><br></div></div><br>  The function generates a set relationship map and outputs to stdout. <br><br><h4>  <b>Script testing in humans</b> </h4><br>  Ohoho how it sounds.  Now let's play.  We make this list of questions: <br><br><div class="spoiler">  <b class="spoiler_title">A list of questions</b> <div class="spoiler_text"> <code>1)       ? (0- , 10- ) <br> 2)     (0- , 10  ) <br> 3)      ?(0-  , 10- ) <br> 4)      ?(0-  , 10- ) <br> 5)     ? (0- , 10  ) <br> 6)    ? (0- , 10  ) <br> 7)     ? (0- , 10  ) <br> 8)    ? (0- , 10  ) <br> 9)    ? (0, 10) <br> 10)    ? ( 0, 10) <br> 11)   (0, 10) <br> 12)   (0, 10) <br> 13)    (0, 10) <br></code> <br></div></div><br><br>  And let us answer each user by creating a data set.  At once I will tell, in the program the data set is numbered as they are loaded through pickle.  Therefore, the output is, respectively, the numbers in the format (number - number = coefficient of difference). <br><br>  For readability, I manually reprinted them in the last names, replacing them with random ones for the article (consent to sample data was not received from everyone). <br><br>  Starting mapping we get the following: <br><br><div class="spoiler">  <b class="spoiler_title">Exhaust</b> <div class="spoiler_text"> <code> - = 11.83 <br>  - = 12.72 <br>  -  = 12.92 <br>  -  = 12.88 <br>  -  = 16.49 <br> <br> - = 9.59 <br> -  = 8.77 <br> -  = 10 <br> -  = 14.28 <br> <br> -  = 10.34 <br> -  = 13.85 <br> -  = 12.4 <br> <br>  -  = 12.68 <br>  -  = 14.93 <br> <br>  -  = 17.66 <br></code> <br></div></div><br><br>  How to interpret this?  Let's see, we had 13 questions in total. The maximum number of points is 10 <br><br>  Then, by the Pythagorean theorem, we find the largest possible distance in the vicinity of a 13-dimensional space: <br><br>  sqrt (100 * 13) = 36,056 <br>  Average value = maximum / 2 = 16.03 <br><br>  Thus, we see that basically we have more in common with friends (this is logical). <br><br>  And only the rating of the difference between Azarova and Petrova shows that these two friends of mine (girlfriend) are the most different in their interests, since their coefficients are.  equal to 17.66, which is more than the average. <br><br><h4>  <b>Instead of conclusion</b> </h4><br><br>  Thus, this method can be used to rank users according to their interests on dating sites.  We see that the more questions, the more accurate the comparison of personalities.  By creating, for example, when registering a questionnaire of 100 questions and making a map for a small social network (as the amount of memory for this method grows linearly with the increase in users), we can recommend people to communicate / learn. <br><br><div class="spoiler">  <b class="spoiler_title">Full code</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python import sys import pickle import math Dictionary = [] Points = {} PSize = 0 def DictGen(): print("~~~~") DictList = [] print("For exit enter a \"0\"") while True: s = str(input("&gt; ")) if (s == "0"): break; else: DictList.append(s) print("Enter a name for new list of keys: ") fname = str(input("&gt; ")) with open(fname, 'wb') as f: pickle.dump(DictList, f) print("Saved with name ", fname, sep = "") def DictLoad(): print("~~~~") fname = str(input("Enter a name of list to load\n&gt; ")) with open(fname, 'rb') as f: Dictionary.clear() Dictionary.extend(pickle.load(f)) def NewPoint(): print("~~~~") if (not Dictionary): print("List of keys not loaded (command 2)") else: LocalPoint = {} for key in Dictionary: print(key, ": ", sep="", end="") mark = float(input()) LocalPoint[key] = mark print("Enter a name for new point: ") fname = str(input("&gt; ")) with open(fname, 'wb') as f: pickle.dump(LocalPoint, f) print("New point saved with name ", fname, sep="") def LoadPoint(): print("~~~~") fname = str(input("Enter a name of point to load\n&gt; ")) with open(fname, 'rb') as f: LocalPoint = pickle.load(f) Points[PSize] = LocalPoint def calc(nPoint): result = 0.0 print("sqrt(", end="") for key in Dictionary: print("(", Points[nPoint[0]][key], " - ", Points[nPoint[1]][key], ")^2 + ", sep="", end="") result = result + math.pow((Points[nPoint[0]][key] - Points[nPoint[1]][key]),2) print(")") result = math.sqrt(result) return result def GenerateMap(): print("~~~~") for i in range(1, PSize): for j in range(i + 1, PSize + 1): print(i, " and ", j, " = ", calc( (i, j) ), sep="") while True: print("0 - exit") print("1 - generate a list of keys") print("2 - load a map of marks") print("3 - add a new point in dimension") print("4 - load a new point in dimension") print("5 - calculate distance from two points of dimension") print("6 - print information") print("7 - create a map with distance for every point") i = int(input("#-&gt; ")) if (i == 0): sys.exit() elif (i == 1): DictGen() elif (i == 2): DictLoad() elif (i == 3): NewPoint() elif (i == 4): PSize = PSize + 1 LoadPoint() elif (i == 5): print("Enter a two numbers of which points you want to calculate a distance") nPoint = tuple(int(x.strip()) for x in input().split(' ')) print("Difference: ", calc(nPoint), sep="") input() sys.exit() elif (i == 6): print("Dictionary", Dictionary, sep = ": ") print("Points: ", Points, sep = ": ") print("Total points: ", PSize, sep = "") elif (i == 7): GenerateMap() else: print("Unknown command") sys.exit()</span></span></code> </pre><br><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/304082/">https://habr.com/ru/post/304082/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304070/index.html">Secrets of the most effective people (part 2)</a></li>
<li><a href="../304072/index.html">dlang-requests - type python-requests, only for D</a></li>
<li><a href="../304074/index.html">Implementing reference counting or life without GC (almost)</a></li>
<li><a href="../304078/index.html">Making a cool Single Page Application on basis.js - part 1, introductory theoretical</a></li>
<li><a href="../304080/index.html">Knocking out to government agencies or what to do if in the open data someone is wrong?</a></li>
<li><a href="../304090/index.html">Russian Post delivers - you are now laughing, but it‚Äôs the most reliable</a></li>
<li><a href="../304092/index.html">Passed the hackathon on the Yii Framework in TACC</a></li>
<li><a href="../304096/index.html">Gobetween Exec discovery + Elasticsearch. L4 balancing with Data Node Discovery</a></li>
<li><a href="../304098/index.html">Geographer Package - First Working Version</a></li>
<li><a href="../304100/index.html">Installing Emercoin blockchain with a web wallet on RedHat / CentOS 7 and Ubuntu 16.04</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>