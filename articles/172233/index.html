<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RestKit - description of one of the possibilities</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habr! 

 Prehistory 

 It has long been noted that there is not a single article on Habr√© about such a wonderful library as RestKit , written in Ob...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>RestKit - description of one of the possibilities</h1><div class="post__text post__text-html js-mediator-article">  Hi Habr! <br><br><h4>  Prehistory </h4><br><br>  It has long been noted that there is not a single article on <a href="http://restkit.org/">Habr√©</a> about such a wonderful library as <a href="http://restkit.org/">RestKit</a> , written in Objective-C and providing excellent opportunities for working with <a href="http://ru.wikipedia.org/wiki/REST">RESTful</a> services.  Therefore, the idea came to publish a brief description of some of the features of the library, especially since a completely new version of it has already been released using the library for working with HTTP as the basis for <a href="https://github.com/AFNetworking/AFNetworking">AFNetworking</a> .  The article describes one of the most important functionalities for me - object mapping. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The process of installing the library is described in detail on <a href="https://github.com/RestKit/RestKit/wiki/Installing-RestKit-v0.20.x-as-a-Git-Submodule">the</a> project <a href="https://github.com/RestKit/RestKit/wiki/Installing-RestKit-v0.20.x-as-a-Git-Submodule">page</a> on GitHub.  The same library is available in Pods: <br><pre><code class="bash hljs">$ cat Podfile platform :ios, <span class="hljs-string"><span class="hljs-string">'5.0'</span></span> pod <span class="hljs-string"><span class="hljs-string">'RestKit'</span></span>, <span class="hljs-string"><span class="hljs-string">'~&gt; 0.20.0pre'</span></span></code> </pre> <br><h4>  Let's get down to business </h4><br>  We can do without a theory, because the article is for those who understand, at least, what REST is and why it is needed. <br><br><h4>  Initialization </h4><br>  At the start of the application, it is necessary to set the initial parameters for singletons working with HTTP and mapping objects: <br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSURL</span></span> *baseURL = [<span class="hljs-built_in"><span class="hljs-built_in">NSURL</span></span> URLWithString:kServerHost]; AFHTTPClient* client = [[AFHTTPClient alloc] initWithBaseURL:baseURL]; RKObjectManager *objectManager = [[RKObjectManager alloc] initWithHTTPClient:client]; [RKObjectManager setSharedManager:objectManager];</code> </pre><br><br><h5>  Mapping objects </h5><br>  First we need to describe the class in which the data will be stored (where they will be mapped): <br><pre> <code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TaskListSuccess</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSObject</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">copy</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSString</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">created_at</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">copy</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSString</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">updated_at</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">copy</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSString</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user_id</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">copy</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSString</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ID</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">copy</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSString</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">copy</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSString</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">time</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  Next, you need to add a rule for the answers for which queries this class will be used and by what rule the objects are mapped: <br><pre> <code class="objectivec hljs">RKObjectMapping* successAuthResult = [RKObjectMapping mappingForClass:[TaskListSuccess <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>]]; [successAuthResult addAttributeMappingsFromDictionary:@{ <span class="hljs-comment"><span class="hljs-comment">//    JSON(XML)    @"created_at": @"created_at", @"updated_at": @"updated_at", @"user_id": @"user_id", @"id": @"ID", @"title": @"title", @"time": @"time", }]; //  -,      . NSIndexSet *successStatusCodes = RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful); RKResponseDescriptor *responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:successAuthResult pathPattern:@"tasks" keyPath:nil statusCodes:successStatusCodes]; [[RKObjectManager sharedManager] addResponseDescriptor:responseDescriptor];</span></span></code> </pre><br>  The pathPattern parameter of the RKResponseDescriptor class describes the pattern of the path for which our class will be used for mapping. <br>  Next you need to send the request itself: <br><pre> <code class="objectivec hljs">RKObjectManager *objectManager = [RKObjectManager sharedManager]; [objectManager getObject:<span class="hljs-literal"><span class="hljs-literal">nil</span></span> path:<span class="hljs-string"><span class="hljs-string">@"tasks"</span></span> parameters:<span class="hljs-literal"><span class="hljs-literal">nil</span></span> success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) { <span class="hljs-comment"><span class="hljs-comment">//    ... } failure:^(RKObjectRequestOperation *operation, NSError *error) { //    ... }];</span></span></code> </pre><br>  This is the simplest query, sometimes we need more flexibility in customizing the query, then we can do this, for example, as follows: <br><pre> <code class="objectivec hljs">RKObjectManager *objectManager = [RKObjectManager sharedManager]; <span class="hljs-built_in"><span class="hljs-built_in">NSMutableURLRequest</span></span> *urlRequest = [objectManager requestWithObject:<span class="hljs-literal"><span class="hljs-literal">nil</span></span> method:RKRequestMethodPOST path:<span class="hljs-string"><span class="hljs-string">@"tasks"</span></span> parameters:<span class="hljs-literal"><span class="hljs-literal">nil</span></span>]; [urlRequest setValue:<span class="hljs-string"><span class="hljs-string">@"application/x-www-form-urlencoded"</span></span> forHTTPHeaderField:<span class="hljs-string"><span class="hljs-string">@"Content-Type"</span></span>]; RKObjectRequestOperation *operation = [objectManager objectRequestOperationWithRequest:urlRequest success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) { <span class="hljs-comment"><span class="hljs-comment">//    ... } failure:^(RKObjectRequestOperation *operation, NSError *error) { //    ... }]; [objectManager enqueueObjectRequestOperation:operation];</span></span></code> </pre><br>  An object of class RKObjectRequestOperation contains all possible parameters that we can set as we please. <br><br><h4>  Outro </h4><br>  The article is introductory and aims to understand whether it is important to describe this library further, especially since there is very good documentation in English.  In general, if this topic is of interest, then it will be possible to go back to it and describe other possibilities of the library, as well as tell about the personal cones stuffed during its use. <br><br>  Should I describe the library further? <br><br>  Opportunities: <ul><li>  work with CoreData </li><li>  work with multi-query queries (pagination) </li><li>  more complex mapping using multiple entities in a single query </li><li>  and etc. </li></ul><br><br>  All the best!  World! </div><p>Source: <a href="https://habr.com/ru/post/172233/">https://habr.com/ru/post/172233/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../172223/index.html">A bit about Steam Web Api</a></li>
<li><a href="../172225/index.html">Kinect + 3D Display + HTML5</a></li>
<li><a href="../172227/index.html">Automatic Customer Calling System</a></li>
<li><a href="../172229/index.html">Experience in managing business processes in a new way, or how ACM replaces BPM, CRM, ECM, SCRUM, ITSM - in one fell swoop</a></li>
<li><a href="../172231/index.html">Sparse image processing</a></li>
<li><a href="../172235/index.html">Mozilla does not plan to return to iOS</a></li>
<li><a href="../172239/index.html">PowerMock (+ Mockito): a new look at unit testing</a></li>
<li><a href="../172243/index.html">Bar of Desires by March 8 in Python and Pyramid</a></li>
<li><a href="../172245/index.html">Windows Azure Summit: how it was (+ a lot of photos)</a></li>
<li><a href="../172247/index.html">Xbox Hacking Guide: In Memory of Aaron Schwarz</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>