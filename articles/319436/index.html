<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>tiny-dnn - library announcement</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While TensorFlow is actively conquering the world, fighting for an audience with such major players of the machine learning market and deep neural net...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>tiny-dnn - library announcement</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ca/00b/c74/2ca00bc7465b70af56243d41799930f1.png" alt="image"></div><br>  While TensorFlow is actively conquering the world, fighting for an audience with such major players of the machine learning market and deep neural networks like Keras, Theano and Caffe, other less ambitious projects, meanwhile, are partisans trying to occupy at least some niche.  I just wanted to tell about one of these projects today due to the complete lack of information about him at Habrahabr.  So, <b>tiny-dnn</b> is a completely autonomous C ++ 11 implementation of in-depth training, created for use in conditions of limited computing resources, embedded systems or IoT.  Details under the cut. <br><a name="habracut"></a><br><h3>  What do the developers offer us </h3><br><ol><li>  <b>The speed is even without a GPU</b> .  This is achieved through TBB and SSE / AVX vectorization.  98.8 percent accuracy on MNIST in 13 minutes of training </li><li>  <b>Portability</b>  About this further </li><li>  <b>Ability to import Caffe models</b> .  But you will need protobuf </li><li>  <b>Predictable performance</b> .  A simple multi-threaded model + no GC (was it worth it to write it, because the library for C ++ programmers) </li></ol><br>  In general, there is nothing revolutionary, but there is nothing particularly to blame.  It is proposed to do everything in C ++ and quite straightforwardly.  It is possible to save and load the model in the file and from the file (again, without dependencies).  For a complete list, see the GitHub link. <br><br><h3>  Installation and assembly </h3><br>  The library is distributed by source codes.  There can be no other way for this library, since all the code is contained in h-files, that is, there is absolutely nothing to collect into the library.  A dubious decision, but in pursuit of wild portability and simplicity - why not? <br><br>  To run the examples or tests you will need <b>cmake</b> .  A dozen options are available, including USE_OPENCL - at the moment an experimental feature that in the future can give a significant benefit.  I suggest to look at the complete list as well on the project page. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Experience using in MS Visual Studio </h4><br>  After calling ‚Äúcmake.‚Äù A * .sln file will be generated for MS Visual Studio 2015 (Community Edition is quite appropriate).  In this solution there are two projects, the library itself and the tests.  Here you can simply add your project, and to start using the library, register: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"tiny_dnn/tiny_dnn.h"</span></span></span></span></code> </pre> <br>  but you should remember to add the directory with tiny-dnn to the ‚ÄúInclude directories‚Äù.  Also in my case there was a build problem, namely: <br><br><pre> <code class="hljs sql">error C4996: 'std::copy::_Unchecked_iterators::_Deprecate': <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-string"><span class="hljs-string">'std::copy'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">parameters</span></span> that may be <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span> - this <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> relies <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the caller <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> that the passed <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">are</span></span> correct. <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span> this <span class="hljs-keyword"><span class="hljs-keyword">warning</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> -D_SCL_SECURE_NO_WARNINGS. See documentation <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> how <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> Visual C++ <span class="hljs-string"><span class="hljs-string">'Checked Iterators'</span></span></code> </pre> <br>  for the solution it was required to add define _SCL_SECURE_NO_WARNINGS in the project parameters (C / C ++ -&gt; Preprocessor). <br><br><h3>  Usage example </h3><br>  You can find examples on the page, but they are about MNIST jammed to holes, it needs data, parsing functions (which are actually built into the library), etc.  Personally, I wanted a banal "Hello, world" in the world of neural networks - the implementation of xor.  Googling did not give quick results, which resulted in the desire to do it yourself and share in the article.  Here's what happened: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"tiny_dnn/tiny_dnn.h"</span></span></span><span class="hljs-meta"> using namespace tiny_dnn; using namespace tiny_dnn::activation; network</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;sequential&gt; construct_mlp() { //auto mynet = make_mlp&lt;tan_h&gt;({ 2, 8, 2 }); auto mynet = make_mlp&lt;relu&gt;({ 2, 8, 2 }); assert(mynet.in_data_size() == 2); assert(mynet.out_data_size() == 2); return mynet; } int main(int argc, char** argv) { auto net = construct_mlp(); std::vector&lt;label_t&gt; train_labels {0, 1, 1, 0}; std::vector&lt;vec_t&gt; train_numbers{ {0, 0}, {0, 1}, {1, 0}, {1, 1} }; adagrad optimizer; // use gradient_descent? net.train&lt;mse&gt;(optimizer, train_numbers, train_labels, 4, 1000); // batch size 4, 1000 epochs for (auto&amp; tn : train_numbers) { auto res_label = net.predict_label(tn); auto res = net.predict(tn); std::cout &lt;&lt; "In: (" &lt;&lt; tn[0] &lt;&lt; "," &lt;&lt; tn[1] &lt;&lt; ") Prediction: " &lt;&lt; res_label &lt;&lt; std::endl; } std::cin.get(); return 0; }</span></span></span></span></code> </pre> <br><h3>  First impressions </h3><br>  They are controversial.  On the one hand, everything is very simple and guaranteed to start everywhere, on the other hand, on a banal XOR, the network somehow converges for a long time, for example, for 100 epochs, the output is correct, but extremely uncertain results like 0.15, for 1000 epochs something like 0.8 .  It seems that a similar model converges faster at tensorflow, but this is not accurate :) <br><br>  Further, the demo project itself is going longer than we would like.  It seems that this is due to the approach with headers.  Perhaps in a larger project it will not even be noticeable, in a small project with one C ++ file it is very even.  By the way, perhaps the solution from MS with so-called  precompiled headers ... <br><br>  The way the library suggests using C ++ 11 syntax and features, oddly enough, I was pleased - I do not program as much on C ++ ‚Äúbare‚Äù (more often Qt), but the test example was given on the first attempt.  By the way comments are welcome. <br><br>  ‚Üí <a href="https://github.com/tiny-dnn/tiny-dnn">Link to GitHub</a> <br>  ‚Üí <a href="http://www.slideshare.net/ssuser756ec5/deep-learning-with-c-an-introduction-to-tinydnn">Link to a useful presentation</a> </div><p>Source: <a href="https://habr.com/ru/post/319436/">https://habr.com/ru/post/319436/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319418/index.html">How to create your file system based on blob fields in the database. Why is it convenient? Efficiency issues</a></li>
<li><a href="../319422/index.html">Cooking ORM, without departing from the plate. We generate SQL - query based on binary expression trees</a></li>
<li><a href="../319424/index.html">Graal and Truffle (Graal & Truffle)</a></li>
<li><a href="../319426/index.html">Who posted the 10 millionth comment? Secrets of numerology</a></li>
<li><a href="../319430/index.html">HPE Synergy Pro - Part V. Control</a></li>
<li><a href="../319438/index.html">Where to place containers: on a dedicated server or a virtual machine?</a></li>
<li><a href="../319440/index.html">About Haskell for the smallest on the example of the problem with codefights</a></li>
<li><a href="../319442/index.html">Strict definition of concepts: object, state, event, business transaction and business function</a></li>
<li><a href="../319444/index.html">UI / UX events of 2017 that will not tire you for sure</a></li>
<li><a href="../319446/index.html">Monitoring of engineering infrastructure in the data center. Part 1. Highlights</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>