<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A few tips on the architecture of a mobile application actively using the network. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, hrobrozhiteli! 
 Now all mobile applications (with very rare exceptions) use the network: for authorization, receiving / sending data,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A few tips on the architecture of a mobile application actively using the network. Part 1</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, hrobrozhiteli! <br>  Now all mobile applications (with very rare exceptions) use the network: for authorization, receiving / sending data, etc. <br>  I decided to collect my experience on this topic in the article. <br>  Working with a network in a standard application comes down to solving several tasks: <br><ul><li>  authorization </li><li>  request and send data </li><li>  data storage </li><li>  work with pictures </li></ul><br><a name="habracut"></a><h5>  Authorization </h5><br>  All social services have OAuth authentication with facebook and a number of other social networks. <br>  By logging in through them, you get a token, which is sent along with the user id to your server and the application receives the session id from it.  It should be borne in mind that both keys may become obsolete at any time.  If the session is lost, automatic re-authentication should go to the server.  If the token is lost, then the user should be shown an authorization window, after receiving a new token, you need to organize a request to the server to receive the new session id. <br>  If any of the application requests returned with an error ‚Äúsession is outdated‚Äù (or a similar one), the authorization method should automatically work out, and then execute the method on which the error fell. <br><br><h5>  Navigating the application screens </h5><br>  With a large number of different tabs in the application (messages, friends, profiles, check-ins, user activity, news, likes), each new controller requires loading data.  There are also background requests to the server that request data on the timer all the time the application is running (these can be requests for the number of new messages, invite to friends, changes in the currency balance within the application, etc.).  Also, controllers need to be notified of updates synchronously or asynchronously, depending on the type of request. <br><br><h5>  Getting pictures from the server </h5><br><img src="https://habrastorage.org/storage2/468/259/006/468259006f6c5c2dedefdcb7fc5152be.jpg"><img src="https://habrastorage.org/storage2/cd9/c92/2c8/cd9c922c8fe1706c527061399c2da21d.jpg"><img src="https://habrastorage.org/storage2/e9f/166/e66/e9f166e66acb1613d8a1dfb4198cf7e2.jpg"><img src="https://habrastorage.org/storage2/f2d/2dd/b3b/f2d2ddb3b66c78bfcfa2bc4c587e03b2.jpg"><br>  As you can see the picture can be used the same.  If the server sends the url only to a large-resolution image, then it is necessary, after loading, to cache, compress, round or round the corners.  All that is required for the design of the application. <br>  We save the original locally and when requesting images, we search among cached files.  If the original is, but the resolution is needed less or of another form: reduce the image and save the result with the name of the form filename_resolution If there is, show, no, we will load. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Data storage </h5><br>  Online store catalog, chat history, news feed.  All this is obsolete and changing data volumes of a fairly large amount.  Optimal for each such action is to do the server method.  Opened the list of messages - requested the first 50 positions (records, messages, products), asynchronously loaded avatars or product photos.  Moved to chat-requested the last 50 messages of the history with this user, while scrolling, they asked for another 50. <br>  This will reduce the amount of transmitted data and the application will run quickly on the edge. <br><br><h5>  Basic architecture solution </h5><br>  The main solution is to organize a class that manages requests.  Singleton class (or set of classes) responsible for working with the network. <br>  His tasks: <br><ul><li>  Create a queue of calls, automatically arrange it depending on the correct / incorrect server responses </li><li>  Send notifications about receiving data to controllers subscribed to certain methods (in ios via nsnotification) </li><li>  Send jobs to the image download manager </li><li>  Manage the background download stream of user activities (notification of new messages, likes, etc.) </li></ul><br>  In iOS, the class was implemented based on the standard NSConnection. <br>  Requests are added to the queue.  Whether this will be a dynamic priority array or NSOperationQue (as in iOS) is up to you.  Each request in the queue takes precedence and if an error is returned with a lost authorization on the last request, the generated priority request is given to the reconnect.  This will avoid the situation when the user clicks on the button, the session is lost and nothing happens when the connection error returns. <br><br>  That's all for now.  In the second part I plan to give examples of the code of the connection class, the organization of interaction with the certification and the image manager. <br>  Thank. </div><p>Source: <a href="https://habr.com/ru/post/150559/">https://habr.com/ru/post/150559/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150552/index.html">LG 29 inch monitor</a></li>
<li><a href="../150553/index.html">How I enrolled in undergraduate education in Canada</a></li>
<li><a href="../150555/index.html">Formula E: announced a series of races involving electric vehicles</a></li>
<li><a href="../150556/index.html">Med Sensation Diagnostic Gloves</a></li>
<li><a href="../150558/index.html">Release MongoDB 2.2.0</a></li>
<li><a href="../150560/index.html">P2P Broadcasting (organizing your own live broadcasts using Torrent Stream)</a></li>
<li><a href="../150563/index.html">Logging: Tracing Recommendations</a></li>
<li><a href="../150565/index.html">Atari, in partnership with Microsoft, launched its old online games.</a></li>
<li><a href="../150569/index.html">The program Drone + again was not allowed on the App Store</a></li>
<li><a href="../150570/index.html">Launched Steam Greenlight!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>