<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Entering text in Linux (ibus)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If your keyboard is marked as Latin or Cyrillic, and you have to type texts in another language, especially using complex, non-alphabetic scripts, the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Entering text in Linux (ibus)</h1><div class="post__text post__text-html js-mediator-article"><p>  If your keyboard is marked as Latin or Cyrillic, and you have to type texts in another language, especially using complex, non-alphabetic scripts, then this note about Linux input systems (simply ‚Äúkeyboard layouts‚Äù) may interest you. </p><br><p>  I apologize in advance for fuzzy terminology and do not pretend to have an exhaustive technical description.  The main goal of the article is to describe the possibilities, not the implementation. </p><a name="habracut"></a><br><h2 id="metody-vvoda">  Input methods </h2><br><p>  The main method of inputting characters (input method, IM) in Linux is XKB, it is installed by default and is activated immediately after installing the operating system.  XKB is designed to work with alphabetic scripts, and cannot serve complex scripts such as Chinese characters or syllabaries of India and Africa.  The system can be configured to work with no more than 4 layouts.  The last limitation can be bypassed by hanging up on the hotkeys a command call with the desired combination of parameters for each language. </p><br><p>  If more flexibility is needed, then go to the frameworks (input method framework).  The main representatives of similar systems in Linux: IBus, SCIM, Fcitx.  The framework itself is not able to enter text, and various scripts must be connected in the form of plug-ins (engines).  From the experience of using IBus and Fcitx I can say that both systems support approximately equal number of plugins.  Often, it can be almost the same plugins.  For example, the Pinyin input method for Chinese is implemented as a stand-alone libpinyin library and provides identical capabilities when connected via IBus or Fcitx. </p><br><p>  We can assume that over the last 6-7 years the difference between the frameworks leveled off, although some features may appear.  Next, I will list the main IBus plugins as a more familiar system to me. </p><br><p> First, IBus is able to transparently use <strong>xkb</strong> and all its features.  The only problem is that IBus cannot dynamically generate XKB configurations.  The most popular of them are pre-registered in the file <code>/usr/share/ibus/component/simple.xml</code> , which can be modified and supplemented as necessary.  (When updating IBus, the file will be replaced with the standard one.) </p><br><p>  For example, the Russian layout is described as follows: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">engine</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>xkb:ru::rus<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span>ru<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">license</span></span></span><span class="hljs-tag">&gt;</span></span>GPL<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">license</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span>Peng Huang &amp;lt;shawn.p.huang@gmail.com&amp;gt;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span>ru<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">longname</span></span></span><span class="hljs-tag">&gt;</span></span>Russian<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">longname</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Russian<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">icon</span></span></span><span class="hljs-tag">&gt;</span></span>ibus-keyboard<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">icon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rank</span></span></span><span class="hljs-tag">&gt;</span></span>99<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rank</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">engine</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  In addition to <code>layout</code> you can specify <code>layout_variant</code> , the rest of the <code>setxkbmap</code> parameters <code>setxkbmap</code> not available, including the well-known typographic layout by Ilya Birman, which is specified in xkb using the argument <code>misc:typo</code> .  To get around this limitation or simply create a layout for your tasks, you need to fully describe it.  To do this, in the <code>/usr/share/X11/xkb/symbols</code> folder you need to create a <code>custom</code> file (if you add existing files, they will be erased when updating the system) and set up the layout configuration.  For example, Russian with additions by Ilya Birman: </p><br><pre> <code class="hljs pgsql">partial alphanumeric_keys xkb_symbols "ru-typo" { <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "ru(winkeys)" <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "typo(base)" <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "level3(ralt_switch)" // <span class="hljs-number"><span class="hljs-number">1</span></span>th keyboard <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> key &lt;TLDE&gt; { [ NoSymbol, NoSymbol, U0301, NoSymbol ] }; // "~" };</code> </pre> <br><p>  Where <code>include</code> lines collect configuration from ready-made templates.  Accordingly, from the file "ru" is taken the version of the Russian layout "winkeys".  Then it is supplemented with the "base" layout from the "typo" file and the switch of the third AltGr layer is set (see the "level3" file), which is similar to the command: </p><br><pre> <code class="bash hljs">setxkbmap -layout ru -variant winkeys -option lv3:ralt_switch,misc:typo</code> </pre> <br><p>  If you wish, you can make your own changes.  In the example above, the accent mark "U + 0301" (Combining Acute Accent) is placed on the AltGr + ~ combination.  Positions in which <code>NoSymbol</code> is indicated use the definitions from the previous patterns: "" and "" from "winkeys", "‚âà" from "typo": </p><br><pre> <code class="hljs xml">key <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TLDE</span></span></span><span class="hljs-tag">&gt;</span></span> { [ Cyrillic_io, Cyrillic_IO, NoSymbol, NoSymbol ] }; // winkeys key <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TLDE</span></span></span><span class="hljs-tag">&gt;</span></span> { [ NoSymbol, NoSymbol, NoSymbol, approxeq ] }; // typo key <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TLDE</span></span></span><span class="hljs-tag">&gt;</span></span> { [ NoSymbol, NoSymbol, U0301, NoSymbol ] }; // custom</code> </pre> <br><p>  Next, the created layout should be <code>/usr/share/ibus/component/simple.xml</code> to the <code>/usr/share/ibus/component/simple.xml</code> file as follows: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">engine</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>xkb:ru:typo:rus<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span>ru<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span>custom,us<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout_variant</span></span></span><span class="hljs-tag">&gt;</span></span>ru-typo,<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout_variant</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">longname</span></span></span><span class="hljs-tag">&gt;</span></span>Russian (with Typo)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">longname</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Russian (with Typo)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">icon</span></span></span><span class="hljs-tag">&gt;</span></span>ibus-keyboard<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">icon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rank</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rank</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">engine</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Where <code>custom</code> is the file name from the <code>/usr/share/X11/xkb/symbols</code> folder, and <code>ru-typo</code> points to the layout it contains.  The additional <code>us</code> layout is specified so that the hotkeys work correctly (Ctrl + C, Ctrl + V, etc.).  After restarting IBus (ibus <code>ibus restart</code> ), a new "Russian (with Typo)" layout will appear in the settings. </p><br><p>  The second input method is <strong>m17n</strong> .  This is a fairly rich library of keyboard layouts for a variety of scripts.  IBus has its own similar ibus <strong>-table</strong> input method, which is described as ‚Äúslightly less powerful‚Äù.  I had to use the latter to create a layout with a one-to-one correspondence between Latin letters and letters of the required alphabet without using complex logic, so I cannot judge which of the two systems is more functional and expressive - description of the layout in m17n or ibus-table format.  The ibus-table method includes a curious "LaTeX" layout for entering characters in the corresponding notation: " <code>\Delta</code> " for "Œî", " <code>\ge</code> " for "‚â•", etc. </p><br><p>  The next universal input method is <strong>KMFL</strong> .  This is the <a href="http://kmfl.sourceforge.net/">linux version</a> of <a href="https://keyman.com/">keyman</a> input <a href="https://keyman.com/">method</a> for windows.  Not very common IM, which supports the rarest script.  Unlike the original Keyman, with the stated ability to print in more than 1000 scripts, KMFL is not so advanced, but it can also be useful.  The format for describing layouts is text, there is a program for creating them under Ms Windows.  I use the EuroLatin layout, in which the text " <code>2//3</code> " is converted into a fraction "‚Öî", and the sequence " <code>-a</code> " is converted into the macro "ƒÅ".  It resembles the Compose key in xkb, but does not require a separate modifier - KMFL itself recognizes the sequence during dialing. </p><br><p>  <a href="https://wiki.archlinux.org/index.php/IBus">The remaining input methods</a> specialize in separate scripts: "ibus-libpinyin" for Chinese, "ibus-unikey" for Vietnamese, etc.  The settings for these plugins are also in <code>/usr/share/ibus/component/</code> .  In the corresponding files, you may need to specify a basic keyboard layout, otherwise, when switching from a non-Latin layout, they will be inoperative.  For example, in <code>libpinyin.xml</code> you need to find the parameter "layout" and enter "us" for the QWERTY keyboard or "fr" for AZERTY, etc. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span>us<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h2 id="pereklyuchenie-raskladok">  Switch Layouts </h2><br><p>  Most of the time I work with language pairs: Russian-English, Chinese-Spanish, etc.  Therefore, I prefer to have one hot key to switch between the two latest layouts (CapsLock), and the layouts themselves are switched by separate hot keys (Win + 1 ... 9 on the digital block).  Thus, at first I set the working layouts, Win + 1 (en) and Win + 2 (ru), and then switch between them using CapsLock (en &lt;-&gt; ru). </p><br><p>  Two shortcut keys can be set in IBus: one for cyclic switching through the list of layouts, the second for the last two layouts.  You can also select the desired layout through the console and, accordingly, assign the script to the hot key. </p><br><p>  I note that reassigning CapsLock using <code>xmodmap</code> does not work, since IBus resets these settings.  Therefore, I prefer through <code>udev</code> globally redefine CapsLock as F14 (file <code>/etc/udev/hwdb.d/90-custom-keyboard.hwdb</code> ): </p><br><pre> <code class="hljs pgsql">evdev:<span class="hljs-keyword"><span class="hljs-keyword">input</span></span>:b0003v1A2Cp0E24* # my keyboard id KEYBOARD_KEY_70039=f14 # bind capslock <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> f14</code> </pre> <br><p>  And use F14 as the hot key in IBus.  In my experience, this provides the most stable configuration. </p><br><p>  For more information on configuring udev, see the end of the article. </p><br><h2 id="virtualnaya-klaviatura">  Virtual keyboard </h2><br><p>  Industrially produced keyboards, marked up for a specific writing, only for languages ‚Äã‚Äãwith a large number of users - for example, for Russian (YTSUKEN).  Neither in Armenia, nor in Georgia you can not buy a keyboard with keys, signed with letters of national alphabets.  Similarly, in Kazakhstan and Uzbekistan they use Russian-English keyboards and are forced to learn where the letters are located that are not included in the standard Latin or Cyrillic alphabet. </p><br><p>  If you master the new layout, I advise you to use the virtual keyboard.  I like <a href="https://launchpad.net/onboard">Onboard</a> because it adapts itself to the active layout and is updated when you switch to another.  But this only works with xkb (also when using xkb via iBus). </p><br><p>  Onboard is very convenient for testing xkb layouts and allows you to see the assigned characters on all layers (AltGr, etc.). </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Not all programs correctly support language frameworks.  In particular, Sublime Text 3 works only with SCIM, and using IBus, regardless of the layout chosen, it will print only Latin letters. </p><br><p>  I have been using IBus for a long time, and I know other systems very superficially.  According to reviews on the Internet, Fctix is ‚Äã‚Äãdescribed as more functional and better adapted for entering Chinese text.  In any case, when working with Chinese texts, IBus completely suits me and the differences should be unprincipled.  The last time I had to use Fctix (2 years ago), this framework did not allow switching layouts if the cursor is not in the text field.  I hope, by the present moment this defect has been corrected. </p><br><p>  Another tool for working with a variety of scripts - silicone lining on the keyboard.  Chinese online stores offer overlays (‰øùÊä§ ËÜú or ÈîÆÁõò ËÜú) for the Apple Magic Keyboard for a wide variety of scripts.  An example of a <a href="https://keyshorts.com/collections/bilingual">non-Chinese distributor</a> .  But keep in mind that three generations of Apple Magic were released (and each in versions for the USA, Europe and Japan), and Chinese replicas are distinguished by linear dimensions and key layout.  Sometimes, I regret that there is no single standard for computer keyboards. </p><br><div class="spoiler">  <b class="spoiler_title">Key Signal Transformation Summary</b> <div class="spoiler_text"><p>  The numeric code of the pressed key changes its value several times. </p><br><ol><li>  <strong>scancode:</strong> When you press a key, the keyboard (or driver?) sends to the Linux kernel <em>scancode</em> . </li><li>  <strong>keycode:</strong> Next, the <em>scancode</em> core <em>is</em> converted to a <em>keycode</em> (Linux input API subsystem).  You can control the conversion using the programs <a href="https://wiki.archlinux.org/index.php/udev">udev</a> , <a href="http://0pointer.de/lennart/projects/keyfuzz/">keyfuzz</a> , <a href="">setkeycodes</a> . </li><li>  <strong>keysym: The</strong> X Window System receives the <strong>keycode</strong> from the kernel and translates it into a <em>keysym</em> - this is already the final character that the client program will receive as input.  Conversion setting is done via XKB or xmodmap (deprecated). </li></ol><br><p>  It can be seen from the above sequence that reassigning keys at the stage of <em>scancode</em> &gt; <em>keycode is</em> preferable, since this does not cause intersections with KXB. </p></div></div><br><div class="spoiler">  <b class="spoiler_title">Udev setup instructions</b> <div class="spoiler_text"><p>  <em>Scancode is</em> translated <em>into keycode</em> for each input device independently, so you first need to know the unique identifier of the keyboard (in fact, evdev also works with a large class of peripheral devices that have buttons - from mice to printers and webcams).  Arch Linux users can use the following script (for other distributions, you may need to adjust paths): </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh for DEVICE in /dev/input/by-id/*; do echo $(basename $DEVICE) DEVID=$(basename $(readlink $DEVICE)) printf "evdev:input:b%sv%sp%se%s*\n\n" \ `cat /sys/class/input/$DEVID/device/id/bustype` \ `cat /sys/class/input/$DEVID/device/id/vendor` \ `cat /sys/class/input/$DEVID/device/id/product` \ `cat /sys/class/input/$DEVID/device/id/version` done</span></span></code> </pre> <br><p>  The same device can be represented in the system in several instances under different names, but the identifier will be the same.  For example, my keyboard is defined as two devices: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">usb-SEM_USB_Keyboard-event-if01</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">evdev</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:input</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:b0003v1a2cp0e24e0110</span></span>* <span class="hljs-selector-tag"><span class="hljs-selector-tag">usb-SEM_USB_Keyboard-event-kbd</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">evdev</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:input</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:b0003v1a2cp0e24e0110</span></span>*</code> </pre> <br><p>  Note: the identifier can be abbreviated (for example, to <code>b0003v1a2cp0e24*</code> ), which is useful when creating uniform rules for a series of similar models.  The asterisk ‚Äú*‚Äù here plays the role of a wildcard. </p><br><p>  Now you need to create a <code>90-custom-keyboard.hwdb</code> file in <code>/etc/udev/hwdb.d/</code> with the following content (see the samples <code>/usr/lib/udev/hwdb.d/60-keyboard.hwdb</code> ): </p><br><pre> <code class="hljs objectivec">evdev:input:b0003v5c0ap0003e0110* <span class="hljs-meta"><span class="hljs-meta">#   KEYBOARD_KEY_70039=f14 #  </span></span></code> </pre> <br><p>  The KEYBOARD_KEY string starts with a space, this is important.  Update configuration: </p><br><pre> <code class="hljs pgsql">sudo udevadm hwdb <span class="hljs-comment"><span class="hljs-comment">--update &amp;&amp; udevadm trigger</span></span></code> </pre> <br><p>  Subsequently, when the device is rebooted or reconnected, the configuration will be updated automatically. </p><br><p>  Key mapping is set in pairs <code>KEYBOARD_KEY_&lt;scancode&gt;=&lt;keycode&gt;</code> .  The <em>keycode</em> values ‚Äã‚Äã(required in lower case) are in <code>/usr/include/linux/input-event-codes.h</code> (for Ubuntu 14.04 in <code>/usr/include/linux/input.h</code> ). </p><br><p>  You can get <em>scancode</em> using the evtest program.  First, you need to decide on the eventXX number, to do this, run the command and find your keyboard: </p><br><pre> <code class="hljs cs">&gt; ls -l /dev/input/<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>-id/ ‚Ä¶ usb-SEM_USB_Keyboard-<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>-if01 -&gt; ../event11 usb-SEM_USB_Keyboard-<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>-kbd -&gt; ../event10 ‚Ä¶</code> </pre> <br><p>  Select "Keyboard-event-kbd" and find out the desired number (in this example - 10).  Now you can turn to evtest: </p><br><pre> <code class="hljs haskell">&gt; sudo evtest /dev/input/event10 ‚Ä¶ <span class="hljs-type"><span class="hljs-type">Event</span></span>: time <span class="hljs-number"><span class="hljs-number">1531562530.720076</span></span>, <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> 4 (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EV_MSC</span></span></span><span class="hljs-class">), code 4 (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MSC_SCAN</span></span></span><span class="hljs-class">), value 70039 ‚Ä¶</span></span></code> </pre> <br><p>  When you press the "CapsLock" key, you get the code "70039" - this is the desired <em>scancode</em> . </p></div></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/358440/">https://habr.com/ru/post/358440/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358428/index.html">What awaits the IaaS market: trends in brief</a></li>
<li><a href="../358432/index.html">How to make Vue.js and Electron work together</a></li>
<li><a href="../358434/index.html">Just add water: H2O.ai development</a></li>
<li><a href="../358436/index.html">Ubuntu DSVM Review: Alchemy</a></li>
<li><a href="../358438/index.html">How not to miss a single message</a></li>
<li><a href="../358442/index.html">Tester Tools</a></li>
<li><a href="../358444/index.html">Remove trash from Xcode</a></li>
<li><a href="../358448/index.html">Automatically build Unity projects for Android and iOS using Gitlab CI</a></li>
<li><a href="../358450/index.html">How to identify and develop talents in IT: the results of the first Team Leader meetup</a></li>
<li><a href="../358452/index.html">Ramda Thinking: Pointless Notation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>