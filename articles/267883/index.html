<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Optimization of communication channels for mining in the north of Russia</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When we went to the installation, next to get a tractor from the ravine 

 There are such harsh Russian men who extract various minerals, which are me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Optimization of communication channels for mining in the north of Russia</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/3d4/0be/c79/3d40bec799d640788012561ef4633f1b.jpg"><br>  <i>When we went to the installation, next to get a tractor from the ravine</i> <br><br>  There are such harsh Russian men who extract various minerals, which are meanly grouped in hard to reach places.  Often, just getting and pulling them out of the ground can be very, very expensive.  Therefore, a developed infrastructure at the mining site is a rare phenomenon.  So, in the Far East, in many places, fiber is still a science fiction section, and the wire is found in the wild only if you bring it in your hands. <br><br>  Communication there is made via satellite.  <b>Accordingly, the requirements for the channel are growing, but expanding is very painful and expensive</b> - the satellite resource is not the most scalable, and it will not be possible to drive gigabytes through it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>We solved the channel optimization problem by</b> compressing traffic and prioritizing applications in the channels so that the most important thing always goes first.  It turned out a whole network detective. <a name="habracut"></a><br><br><h4>  Introductory </h4><br>  There is a channel on the satellite, and to expand it is expensive.  There are Riverbed solutions that allow you to compress traffic, optimize the exchange at the protocol level (so that no redundant data is transmitted), plus cache the compression dictionary itself.  All this as a whole can give from 20% to 80% of the gain per lane, depending on what the data is and how it flies. <br><br>  The task began with the fact that we were asked to calculate the possibility of prioritizing critical traffic so that it stands out from the entire exchange on the points.  After that, it became clear that optimization was also very profitable, because one had to pay constantly for a raised satellite channel, and for iron only once. <br><br><h4>  Survey </h4><br>  The architecture of the exchange - a few "wheels with knitting" with hubs in large cities.  For example, in Irkutsk, Magadan and Moscow.  Optics or copper are suitable for hubs.  At remote points at mining companies, a satellite communications station is used in 90% of cases, there are literally a pair of radio relay lines and at several points those who in one way or another dragged it past for the sake of the main line are sharing optics. <br><br>  Put the diagnostic system that collects data. <br><br>  There are many applications, but there are few users, the main exchange is technical.  Here is an example of what can work at one of the enterprises somewhere far, far beyond the snow: <br><table><tbody><tr><td><br>  Recognized application <br></td><td><br>  Interpretation of observed traffic <br></td></tr><tr><td><br>  Microsoft-DS Active Directory <br></td><td><br>  File exchange by the operating system <br>  Windows (SMB Direct). <br></td></tr><tr><td><br>  Microsoft Terminal Server (RDP) <br></td><td><br>  Remote Desktop <br></td></tr><tr><td><br>  Https <br></td><td><br>  Outlook Web Access <br></td></tr><tr><td><br>  SMTP <br></td><td><br>  Mail forwarding between Exchange servers <br></td></tr><tr><td><br>  MS SQL <br></td><td><br>  Access to MS SQL server <br></td></tr><tr><td><br>  netview-aix-2 <br></td><td><br>  Client connection 1C <br></td></tr><tr><td><br>  domain <br></td><td><br>  Domain Name Service (DNS) <br></td></tr><tr><td><br>  webcache <br></td><td><br>  Internet access through a proxy server <br></td></tr></tbody></table>  All of this, in general, is well compressed, with the exception of DNS and Internet access.  There is also Lync, VoIP and video conferencing, which, due to its specific features, is not compressed, but it does require priority No. 1 - especially when the head of the facility is called for a CCS meeting. <br><br>  For the most part, everyday traffic is file transfer, real time traffic, there is also production control, accounting and raw sensor data.  Many applications that send information are "talkative", that is, they send many packages where it would be possible to do with one.  Accordingly, such things are solved Riverbed quite simply. <br><br>  Here, compare how applications work before and after optimization: <br><br><img src="https://habrastorage.org/files/7a3/0d2/fd2/7a30d2fd20ef4ba08f49777c7de1e2e1.png"><br><br>  For example, the well-known "chatty" protocol CIFS, which is used to access files.  A file of 20-40 MB in size on the local network will be downloaded in seconds.  If the file is downloaded from a remote office via a WAN communication channel, as shown in the diagram above, the download time can be increased to 5 minutes or more. <br><br><img src="https://habrastorage.org/files/4bb/a1a/e3b/4bba1ae3bccc4254a66f1aaab19d53a6.png"><br><br>  To reduce download time to a remote office, you need to minimize the number of passes in both directions. <br><br>  To prioritize the traffic, it was necessary to disassemble the packets ‚Äî we had to raise the DPI analog and look at the 7th level, since it was obviously not enough to scatter the ports used ‚Äî the same type of traffic could be either an important sensor or talkative exchange of something noncritical.  Or, it was necessary to allocate Exchange sessions and give them a band at the stage of establishing a connection. <br><br>  Before that, of course, we tried it just on routers, but there it‚Äôs a very difficult control, plus it‚Äôs all difficult to maintain the config.  So that there is a complete understanding - in our case, there is no support team in the central office in Moscow.  The principal was sitting at an equidistant distance from the mining points and the head organization.  The place is so chosen because of time zones - there are chances to find a working day both there and there.  There is also an intermediate team for operational tasks, but none of these people absolutely needed to create so many problems for manual settings.  And without a guarantee of proper operation in the future. <br><br><h4>  Iron </h4><br>  Here we must interrupt and say that this whole story sounds smooth only on paper.  Difficulties, of course, were - starting from such a banal thing as connecting traffic mirroring devices.  Just imagine a mining company somewhere very, very far, where there is no road.  Getting there by land can only be a few months a year.  Accordingly, the iron after sending still somewhere at least 1 month gets to the point.  How to get it - you need to connect it, and it will be connected by someone local from the customer support service. <br><br>  All this was connected, fortunately, to a gap at the exit from the server through the bypass, so the work was quite simple.  The only time was to give all the instructions BEFORE the engineer at the point pulled the cable, because the same telephony was tied to him. <br><br><img src="https://habrastorage.org/files/c19/6a0/423/c196a04232df4f778b6457a62e774437.jpeg"><br>  <i>Optimizer is the bottom</i> <br><br>  As a result, the following scheme was worked out: <br><ul><li>  We received iron at our warehouse in Moscow </li><li>  They did diagnostics and pre-tuning, so that you can control the device right after the connection. </li><li>  Sent by branch </li><li>  Then they played ‚ÄúAvatar‚Äù, helping the specialists on the spot to make movements with the cable that were incomprehensible to them.  Sometimes all this was observed through a video stream with a large lag.  Nobody was funny. </li><li>  Later, a year later, the second part of the quest came - from some points the measuring equipment had to be removed and put on others. </li></ul><br>  Again, the romance of the North - one data center reached the place on a sled, well, at least not dogs.  Datacenter on the sled, yes, yes. <br><br><h4>  Continuation </h4><br>  So, we saw what traffic goes and in what amounts.  With what delays, what is business critical, what is not.  What is important for the company is that it can be ‚Äúslaughtered‚Äù - ‚Äúslaughtered‚Äù if there was important traffic in the lane.  They identified 4 classes of service for different types of information, coordinated them with telecom operators.  Actually, we ‚Äúpainted‚Äù this traffic - and the telecom operator made shaping on the spot.  There was another peculiarity in the fact that each facility had its own telecom operator: somewhere it was necessary to pay additionally for the service, somewhere it simply did not have the technical ability to shape correctly, had to fit in fewer service classes and come up with different hacks. <br><br>  Rule network problems.  Our mirror sensors have become an ideal debugging tool.  Sensors were placed in all regions, had a copy of the traffic - it was possible to take a copy of the traffic from several points from the branch and from the center and compare.  It turned out that we had the opportunity to fix each package here and there.  As a result, we could assess what is happening with the operator of communication with each of them really.  Here is an example: <br><br><img src="https://habrastorage.org/files/d57/17e/832/d5717e832e334cf8937b02ba4b460bf7.png"><br><br>  An example of diagnostics at the customer: <br><br><img src="https://habrastorage.org/files/340/0a1/ac8/3400a1ac8a9b49c9ad02bd9ac27eaa4a.png"><br>  <i>We see on which hop package was lost on the way from the server to the client</i> <br><br>  There was a case - the big boss came to the branch and said, they say, something you have here is one specific terminal falls off.  "I come in the morning on the included car - and he fell off."  The engineer on-site simply connected to the sensor and collected the last session packets to see why the connection ended.  For half an hour in the packages it was found that the client itself breaks the connection on timeout.  The reason is written in the package - and he scored her code on Google - and immediately saw the setting so as not to break. <br><br><h4>  What is iron? </h4><br><img src="https://habrastorage.org/files/119/1aa/54a/1191aa54a2b64905af0688a0141dacee.jpeg"><br><br>  Different optimizer models were installed ranging from the younger ones to the older ones, depending on the width of the communication channel and the number of users and information resources on the site.  I wrote more about Riverbed solutions <a href="http://habrahabr.ru/company/croc/blog/215585/">here</a> and <a href="http://habrahabr.ru/company/croc/blog/214693/">here in theory</a> . <br><br><h4>  What is the total traffic savings? </h4><br>  Here is an example from one of the points: <br><br><img src="https://habrastorage.org/files/8d7/1dc/a3f/8d71dca3fb7d4ea3b1b4b5c59b19d0be.png"><br><br>  Total optimization here is 57.05 per week for optimized traffic on one of the large nodes. <br><br>  Actually, this is the story.  If you are interested in the details specifically on your project - I can roughly calculate by mail AVrublevsky@croc.ru.  Well, ready to answer any questions here or in the mail. </div><p>Source: <a href="https://habr.com/ru/post/267883/">https://habr.com/ru/post/267883/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267873/index.html">Attempt to implement universal parser online stores using SlimerJS</a></li>
<li><a href="../267875/index.html">19 principles of development on BEM, or what every library developer should know</a></li>
<li><a href="../267877/index.html">Partner Seminar "1C" - for the first time not only for partners</a></li>
<li><a href="../267879/index.html">Financial Computing Challenge</a></li>
<li><a href="../267881/index.html">12 typical database backup errors</a></li>
<li><a href="../267887/index.html">.sorting in Perl 6</a></li>
<li><a href="../267889/index.html">GitFlow and Semantic Versioning for every day</a></li>
<li><a href="../267893/index.html">Checking Appleseed source code</a></li>
<li><a href="../267895/index.html">Creating a JavaScript Synthesizer</a></li>
<li><a href="../267899/index.html">Online Trading: How to become a developer of systems for trading on the exchange</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>