<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We work with KOMPAS 3D from DELPHI continued (and the end)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings,% username%. 

 And so probably I will finish this post what I started in the previous one. For, although time has passed a little, but the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We work with KOMPAS 3D from DELPHI continued (and the end)</h1><div class="post__text post__text-html js-mediator-article"><img src="http://s54.radikal.ru/i145/1004/94/b816c75c0d84.jpg" alt="image"><img src="http://i069.radikal.ru/1004/60/5a723cfc11f3.jpg" alt="image">  Greetings,% username%. <br><br>  And so probably I will finish this post what I started in the previous one.  For, although time has passed a little, but the information began to slowly appear on the open spaces of the gossamer ... <br>  In order not to take away the ‚Äúpiece of bread‚Äù from future authors, I will just finish what I <a href="http://a1f0x.habrahabr.ru/blog/91390/">started</a> . <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  4.4.  We work with the specification. </h6><br>  We will continue to work with the model.  Next in line is clearance. <br>  Immediately begin with the most (for me) confusing - the specification. <br><br><blockquote><code><a href="http://s-c.me/7057/s"></a> <a href="http://s-c.me/7057/h"></a> <font color="black">Copy Source | Copy HTML&lt;br/&gt;procedure TForm2.SetSpc (Nk:Integer; SSpec: <font color="#2b91af">String</font> );&lt;br/&gt; <font color="#0000ff">var</font> &lt;br/&gt;  spc: ksSpecification;&lt;br/&gt;  iter: ksIterator;&lt;br/&gt;  obj, columnType, ispoln, blok: LongInt;&lt;br/&gt;  count: Integer;&lt;br/&gt;  spcColPar: ksSpcColumnParam;&lt;br/&gt;  buf: <font color="#0000ff">string</font> ;&lt;br/&gt;begin&lt;br/&gt; &lt;br/&gt;    spc := ksSpecification(doc3d.GetSpecification); <font color="#008000">//  .</font> &lt;br/&gt; <font color="#0000ff">if</font> spc = nil then exit;&lt;br/&gt; &lt;br/&gt;    iter := ksIterator( kompas.GetIterator() ); <font color="#008000">// </font> &lt;br/&gt;    iter.ksCreateSpcIterator( <font color="#A31515">''</font> , <font color="#A31515">0</font> , <font color="#A31515">0</font> ); <font color="#008000">//   </font> &lt;br/&gt; <font color="#0000ff">if</font> iter.Reference &lt;&gt; <font color="#A31515">0</font> then begin <font color="#008000">//    </font> &lt;br/&gt;        obj := iter.ksMoveIterator( <font color="#A31515">'F'</font> ); <font color="#008000">// </font> &lt;br/&gt; <font color="#008000">//      </font> &lt;br/&gt;        count := spc.ksGetSpcTableColumn( <font color="#A31515">''</font> , <font color="#A31515">0</font> , <font color="#A31515">0</font> );&lt;br/&gt; <font color="#008000">//kompas.ksMessage( Format( '-  = %d', [ count ] ) ); // </font> &lt;br/&gt; &lt;br/&gt;        spcColPar := ksSpcColumnParam( kompas.GetParamStruct(ko_SpcColumnParam) );&lt;br/&gt; <font color="#0000ff">if</font> spcColPar&lt;&gt;nil then&lt;br/&gt; <font color="#0000ff">if</font> spc.ksGetSpcColumnType( obj, <font color="#008000">// </font> &lt;br/&gt; <font color="#A31515">4</font> , <font color="#008000">//  ,   1,  </font> &lt;br/&gt;                                spcColPar ) &lt;&gt; <font color="#A31515">0</font> then begin &lt;br/&gt; <font color="#008000">//  , ""   </font> &lt;br/&gt;           columnType := spcColPar.columnType; &lt;br/&gt;           ispoln := spcColPar.ispoln;&lt;br/&gt;           blok := spcColPar.block;&lt;br/&gt; <font color="#008000">//      (  ,   )</font> &lt;br/&gt;           buf := spc.ksGetSpcObjectColumnText( obj, columnType , ispoln, blok );&lt;br/&gt; &lt;br/&gt; <font color="#008000">//kompas.ksMessage( buf );          //,   ( )</font> &lt;br/&gt;           spc.ksSpcObjectEdit(obj); <font color="#008000">//  .</font> &lt;br/&gt; <font color="#0000ff">if</font> spc.ksSetSpcObjectColumnText(columnType,ispoln, blok , SSpec)&lt;&gt; <font color="#A31515">1</font> then&lt;br/&gt;              ShowMessage( <font color="#A31515">'    '</font> ); <font color="#008000">//   </font> &lt;br/&gt;           spc.ksSpcObjectEnd(); <font color="#008000">// </font> &lt;br/&gt; <font color="#008000">//buf := spc.ksGetSpcObjectColumnText( obj, columnType    , ispoln, blok );</font> &lt;br/&gt; <font color="#008000">//kompas.ksMessage( buf ); // ( )</font> &lt;br/&gt;        end;&lt;br/&gt; &lt;br/&gt; <font color="#008000">//obj := iter.ksMoveIterator( 'N' );  // </font> &lt;br/&gt; <font color="#008000">//   </font> &lt;br/&gt;    end;&lt;br/&gt;end;&lt;br/&gt; &lt;br/&gt;</font></code> </blockquote> <br><br><h6>  4.5.  We work with the name of the part. </h6><br>  It's all much easier. <br>  We have the variable part: ksPart; <br>  part.marking: = 'Part Name';  // Call the part. <br><br><h6>  4.6.  We work with a drawing. </h6><br>  This item is quite extensive. <br>  But in the process of writing this part of the article, I absolutely accidentally <a href="http://ams.tsu.tula.ru/ASCON/day2.htm">googled the link</a> .  <i>"Accidents are not accidental" (c)</i> <br>  There is a good ‚Äúanalysis‚Äù of work with the drawings and their elements.  ( <a href="http://ams.tsu.tula.ru/ASCON/lib.htm">main page of the topic</a> ) <br>  In this regard, the number of my "outflows" has decreased dramatically.  Because  the template drawing is parameterized here, then when the part is resized, the projection automatically changes and changes accordingly to the correct dimensions. <br>  To open the template, we also will not be difficult: <br><br><blockquote> <code><a href="http://s-c.me/7058/s"></a> <a href="http://s-c.me/7058/h"></a> <font color="black">Copy Source | Copy HTML&lt;br/&gt; <font color="#0000ff">if</font> Kompas = nil then begin&lt;br/&gt;   {$IFDEF __LIGHT_VERSION__}&lt;br/&gt;   Kompas:= KompasObject( CreateOleObject( <font color="#A31515">'KompasLT.Application.5'</font> ) );&lt;br/&gt;   {$ELSE}&lt;br/&gt;   Kompas:= KompasObject( CreateOleObject( <font color="#A31515">'Kompas.Application.5'</font> ) );&lt;br/&gt;   {$ENDIF}&lt;br/&gt; <font color="#0000ff">if</font> Kompas &lt;&gt; nil then Kompas.Visible := <font color="#0000ff">true</font> ;&lt;br/&gt;end;&lt;br/&gt; &lt;br/&gt;doc2d:= ksDocument2D( kompas.Document2D );&lt;br/&gt; <font color="#0000ff">if</font> FileIsThere(Path+ <font color="#A31515">'\'+FileName) then</font> &lt;br/&gt; <font color="#A31515">doc2d.ksOpenDocument(Path+'</font> \ <font color="#A31515">'+FileName,false)  // </font> &lt;br/&gt; <font color="#A31515">else Kompas.ksMessage('</font>    - '+FileName); &lt;br/&gt;</font></code> </blockquote> <br><br><h5>  5. Small "workarounds".  Or not always bad advice. </h5><br><br><h6>  5.1.  Drawing template - instead of a model template. </h6><br>  In my, not completely sophisticated look, with a large number of parts of the same type, each of which requires a separate working drawing, it is convenient to use the filling in of a template created directly from the drawing. <br>  Thus, we reduce the amount of ‚Äúredundant‚Äù data on the hard disk, increase the processing speed (with more than 100 drawings, this is quite critical). <br>  <i>(In fact, this is not an absolutely correct method, it is easier to create one drawing with a table of sizes. But in 90% of cases we are obliged to satisfy the customer‚Äôs desire, if this does not contradict our moral and ethical principles, and it is not possible to convince him in a ‚Äúpeaceful‚Äù way)</i> <br>  Make a template is quite simple.  To do this, you need to split the views (in order to decouple from the model) and replace the size values ‚Äã‚Äãwith a template name.  Example: ,,,,,. <br>  Then we simply change the dimensions directly in the drawing. <br>  Well, of course, that "just" is a relative concept. <br>  And we again take on the "favorite" iteration, which takes not too much time and additional computer resources. <br><br><blockquote> <code><a href="http://s-c.me/7059/s"></a> <a href="http://s-c.me/7059/h"></a> <font color="black">Copy Source | Copy HTML&lt;br/&gt;function TForm2.DrawWD: <font color="#2b91af">Boolean</font> ;&lt;br/&gt; <font color="#0000ff">var</font> Iter: ksIterator;&lt;br/&gt;      param:ksDimTextParam;&lt;br/&gt;      iDimParams : ksLDimParam; <font color="#008000">//   </font> &lt;br/&gt;      arr:ksDynamicArray;&lt;br/&gt;      textLine : ksTextLineParam;&lt;br/&gt;      textItem : ksTextItemParam;&lt;br/&gt;      i, <font color="#0000ff">ref</font> :Integer;&lt;br/&gt;      kStr:ksChar255; <font color="#008000">//       ))</font> &lt;br/&gt;begin&lt;br/&gt;     Result:=False;&lt;br/&gt;     Iter:=ksIterator(Kompas.GetIterator); <font color="#008000">//  </font> &lt;br/&gt;     If Iter.ksCreateIterator(LDIMENSION_OBJ, <font color="#A31515">0</font> )=False then exit;&lt;br/&gt; <font color="#008000">//    </font> &lt;br/&gt; &lt;br/&gt; <font color="#0000ff">ref</font> :=Iter.ksMoveIterator( <font color="#A31515">'F'</font> );&lt;br/&gt; <font color="#0000ff">if</font> Doc2.ksExistObj( <font color="#0000ff">ref</font> )= <font color="#A31515">1</font> then&lt;br/&gt;       repeat <font color="#008000">//  </font> &lt;br/&gt; &lt;br/&gt;          iDimParams := ksLDimParam(Kompas.GetParamStruct(ko_LDimParam));&lt;br/&gt;          textLine := ksTextLineParam( kompas.GetParamStruct( ko_TextLineParam) );&lt;br/&gt;          textItem := ksTextItemParam( kompas.GetParamStruct(ko_TextItemParam) );&lt;br/&gt; <font color="#0000ff">if</font> ( (iDimParams = nil) Or (textLine = nil) Or (textItem = nil) ) then Exit;&lt;br/&gt;          Doc2.ksGetObjParam( <font color="#0000ff">ref</font> , iDimParams, ALLPARAM); <font color="#008000">//     </font> &lt;br/&gt;          param := ksDimTextParam( iDimParams.GetTPar ); <font color="#008000">//    </font> &lt;br/&gt; <font color="#0000ff">if</font> param = nil then Exit;&lt;br/&gt;          arr := ksDynamicArray( param.GetTextArr ); <font color="#008000">//      </font> &lt;br/&gt; <font color="#0000ff">if</font> arr = nil then Exit;&lt;br/&gt; &lt;br/&gt;          kStr:=ksChar255(kompas.GetParamStruct(ko_Char255));&lt;br/&gt; <font color="#0000ff">for</font> I := <font color="#A31515">0</font> to arr.ksGetArrayCount - <font color="#A31515">1</font> <font color="#0000ff">do</font> begin <font color="#008000">//     </font> &lt;br/&gt;            arr.ksGetArrayItem(i,kStr);&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">if</font> <font color="#A31515">'&lt;L1&gt;'</font> =kStr.str then kStr.str:=Format( <font color="#A31515">'%1.1f'</font> ,[L1]);&lt;br/&gt; <font color="#0000ff">if</font> <font color="#A31515">'&lt;L2&gt;'</font> =kStr.str then kStr.str:=Format( <font color="#A31515">'%1.1f'</font> ,[L2]);&lt;br/&gt; <font color="#0000ff">if</font> <font color="#A31515">'&lt;L3&gt;'</font> =kStr.str then kStr.str:=Format( <font color="#A31515">'%1.0f'</font> ,[L3]);&lt;br/&gt; &lt;br/&gt; <font color="#0000ff">if</font> <font color="#A31515">'&lt;D1&gt;'</font> =kStr.str then kStr.str:=Format( <font color="#A31515">'%1.0f'</font> ,[D1]);&lt;br/&gt; <font color="#0000ff">if</font> <font color="#A31515">'&lt;D2&gt;'</font> =kStr.str then kStr.str:=Format( <font color="#A31515">'%1.0f'</font> ,[D2]);&lt;br/&gt; <font color="#0000ff">if</font> <font color="#A31515">'&lt;D3&gt;'</font> =kStr.str then kStr.str:=Format( <font color="#A31515">'%1.1f'</font> ,[D3]);&lt;br/&gt; <font color="#008000">//      (/)       Format()</font> &lt;br/&gt; &lt;br/&gt;            arr.ksSetArrayItem(i,kStr); <font color="#008000">//    </font> &lt;br/&gt;          end;&lt;br/&gt; &lt;br/&gt;          param.SetTextArr(arr); <font color="#008000">//    </font> &lt;br/&gt;          iDimParams.SetTPar(param); <font color="#008000">//     </font> &lt;br/&gt; &lt;br/&gt;          doc2.ksSetObjParam( <font color="#0000ff">ref</font> ,iDimParams,ALLPARAM); <font color="#008000">//     .</font> &lt;br/&gt; &lt;br/&gt; <font color="#0000ff">ref</font> :=Iter.ksMoveIterator( <font color="#A31515">'N'</font> );&lt;br/&gt;       until Doc2.ksExistObj( <font color="#0000ff">ref</font> )= <font color="#A31515">0</font> ;&lt;br/&gt;     Iter.ksDeleteIterator;&lt;br/&gt; &lt;br/&gt;     doc2.ksRebuildDocument;&lt;br/&gt;     Result:=True;&lt;br/&gt;end;&lt;br/&gt; &lt;br/&gt;</font></code> </blockquote> <br>  The example is purely nominal, but crammed with two hours of ‚Äúdebriefing‚Äù descriptions ... <br><br><h6>  5.2.  Get rid of the "extra gestures". </h6><br>  In the drawing, it is often necessary to change not only the size, but also some text (for example: Number_of_plan, Customer, Number of products). <br>  In order not to ‚Äúrun through‚Äù the elements of the drawing again, but with reference to the text objects of the drawing, instead of text, you can create these inscriptions as dimension values: <br>  Create a linear dimension in the free space of the drawing.  Replace the size value with a generic name.  In the size properties, remove the extra lines and arrows. <br>  Now, when ‚Äújogging‚Äù in size, we can also replace the text in the drawing. <br>  By the way, we can use this technique to bring some other types of dimensions to linear dimensions. <br><br><h6>  5.3.  And a bit more. </h6><br>  When designing full-fledged products and customer requirements "to ensure all design documentation," it is enough just to create a template (s) for a complete set of documentation.  Before processing, copy them to a separate working folder, and after finishing work, copy them to the folder with the corresponding project (product) name. <br>  The procedure for copying is terribly simple.  I use the following: <br><br><blockquote> <code><a href="http://s-c.me/7060/s"></a> <a href="http://s-c.me/7060/h"></a> <font color="black">Copy Source | Copy HTML&lt;br/&gt;uses ShellApi;&lt;br/&gt; &lt;br/&gt;function CopyDir( <font color="#0000ff">const</font> fromDir, toDir: <font color="#0000ff">string</font> ): <font color="#2b91af">Boolean</font> ;&lt;br/&gt; <font color="#0000ff">var</font> &lt;br/&gt;  fos: TSHFileOpStruct;&lt;br/&gt;begin&lt;br/&gt;  ZeroMemory(@fos, SizeOf(fos));&lt;br/&gt; <font color="#0000ff">with</font> fos <font color="#0000ff">do</font> &lt;br/&gt;  begin&lt;br/&gt;    wFunc := FO_COPY;&lt;br/&gt;    fFlags := FOF_FILESONLY;&lt;br/&gt;    pFrom := PChar(fromDir + # <font color="#A31515">0</font> );&lt;br/&gt;    pTo := PChar(toDir)&lt;br/&gt;  end;&lt;br/&gt;  Result := ( <font color="#A31515">0</font> = ShFileOperation(fos));&lt;br/&gt;end; &lt;br/&gt;</font></code> </blockquote> <br><br>  In fact, the ‚Äúpitfalls‚Äù both in KOMPAS 3D itself and in programming for it, much more, so far I remember only those.  If I remember, it will be UPDATE. </div><p>Source: <a href="https://habr.com/ru/post/92361/">https://habr.com/ru/post/92361/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../92349/index.html">IT management system. SharePoint</a></li>
<li><a href="../92350/index.html">Cisco Config Cleaner. Beta testing</a></li>
<li><a href="../92357/index.html">StarCraft II Beta Client for Mac released</a></li>
<li><a href="../92358/index.html">FineReader Technologies for Linux</a></li>
<li><a href="../92359/index.html">DEVCONF :: GetFreeLogin (x00) - already more than 600 participants. Next level: Now every x00 member participates for free</a></li>
<li><a href="../92362/index.html">Download and Share Visual Studio Color Schemes</a></li>
<li><a href="../92363/index.html">Hosting.ua - continue to burn</a></li>
<li><a href="../92364/index.html">The first ProLiant seventh generation</a></li>
<li><a href="../92365/index.html">Instructions for choosing a font</a></li>
<li><a href="../92367/index.html">New legal reference system "Prav.ru"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>