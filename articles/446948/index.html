<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How Android Trojan Gustuff removes cream (fiat and crypt) from your accounts</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Just the other day, Group-IB reported on the activity of the mobile Android Trojan Gustuff. He works exclusively in international markets, attacking c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How Android Trojan Gustuff removes cream (fiat and crypt) from your accounts</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/b9/hn/wr/b9hnwrlclblkmurq29bkezeanui.png"><br><br>  Just the other day, Group-IB <a href="https://www.group-ib.ru/media/gustuff/">reported</a> on the activity of the mobile Android Trojan Gustuff.  He works exclusively in international markets, attacking customers of the 100 largest foreign banks, users of mobile 32 crypto wallet, as well as major e-commerce resources.  But the developer Gustuff - Russian-speaking cybercriminal under the nickname Bestoffer.  More recently, he praised his Trojan as "a serious product for people with knowledge and experience." <br><br>  Group-IB Malicious Code Analysis Specialist <b>Ivan Pisarev</b> in his research describes in detail how Gustuff works and what is its danger. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Who hunts Gustuff </h2><br>  Gustuff is a new generation of malware with fully automated features.  According to the developer, the Trojan has become a new improved version of the AndyBot malware, which since November 2017 has been attacking Android phones and stealing money through phishing web forms disguised as mobile applications by well-known international banks and payment systems.  Bestoffer reported that the rental price of Gustuff Bot was $ 800 per month. <br><br>  An analysis of the Gustuff sample showed that the Trojan potentially targets customers using mobile applications of major banks, such as Bank of America, Bank of Scotland, JPMorgan, Wells Fargo, Capital One, TD Bank, PNC Bank, and Bitcoin Wallet , Cryptopay, Coinbase and others. <br><br>  Originally created as a classic banking trojan, in the current version of Gustuff has significantly expanded the list of potential objects to attack.  In addition to Android applications of banks, fintech companies and cryptoservices, Gustuff is aimed at users of marketplace applications, online stores, payment systems and instant messengers.  In particular, PayPal, Western Union, eBay, Walmart, Skype, WhatsApp, Gett Taxi, Revolut and others. <br><br><h2>  Entry point: based on mass infection </h2><br>  Gustuff is characterized by a ‚Äúclassic‚Äù vector of penetration of Android-based smartphones via SMS distribution with links to APK.  When an Android device is infected with a trojan by a server command, Gustuff can further spread to the contact database of the infected phone or to the server database.  The functionality of Gustuff is designed for mass infection and maximum capitalization of the business of its operators - it has a unique ‚Äúauto-fill‚Äù function in legitimate mobile banking applications and cryptographic cards, which allows you to speed up and scale the theft of money. <br><br>  The study of the Trojan showed that the avtozaliva function was implemented in it using the Accessibility Service, a service for people with disabilities.  Gustuff is not the first trojan that successfully bypasses protection from interacting with window elements of other applications using this Android service.  However, the use of the Accessibility Service in combination with the auto-fill is still quite a rare phenomenon. <br><br>  After downloading to the phone, the victim Gustuff, using the Accessibility Service, gets the opportunity to interact with the elements of windows of other applications (banking, cryptocurrency, as well as applications for online shopping, messaging, etc.), performing the necessary actions for attackers.  For example, at the command of a server, a Trojan can click on buttons and change the values ‚Äã‚Äãof text fields in banking applications.  Using the Accessibility Service allows the trojan to bypass the security mechanisms used by banks to counter past-generation mobile Trojans, as well as changes in security policies implemented by Google in new versions of the Android OS.  So, Gustuff "can" disable the protection of Google Protect: according to the author, this function works in 70% of cases. <br><br><img src="https://habrastorage.org/webt/ih/x4/1k/ihx41k2p4hqubcaaisklwvdyoy8.png"><br><br>  Gustuff can also show fake push notifications with icons of legitimate mobile apps.  The user clicks on the PUSH notification and sees a phishing window downloaded from the server, where he himself enters the requested data of the bank card or cryptograph.  In another Gustuff scenario, an application is opened, on whose behalf a PUSH notification was displayed.  In this case, a malicious program at the server‚Äôs command through the Accessibility Service may fill out the form fields of a banking application for a fraudulent transaction. <br><br>  The functionality of Gustuff also includes sending information about an infected device to the server, the ability to read / send SMS messages, send USSD requests, launch SOCKS5 Proxy, follow the link, send files (including photo scans of documents, screenshots, photos) to the server Reset device to factory settings. <br><br><h2>  Malware Analysis </h2><br>  Before installing a malicious Android OS application, a user is shown a window containing a list of the rights requested by Gustuff: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ku/th/ac/kuthacuzh0webqtrwhgktysougi.png" alt="image alt"></div><br>  Installation of the application will occur only after obtaining the consent of the user.  After launching the application, the trojan will show the user a window: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hj/uq/xa/hjuqxaw2ezubek_xmd3clywhpsw.png" alt="image alt"></div><br>  After that, delete its icon. <br><br>  According to the author, Gustuff is packaged by FTT.  After starting, the application periodically accesses the CnC server in order to receive commands.  In several files examined by us, the IP address <b>88.99.171 [.] 105 was</b> used as the control server (hereinafter we will denote as <b>&lt;% CnC%&gt;</b> ). <br><br>  After starting the program starts sending messages to the server <b>http: // &lt;% CnC%&gt; /api/v1/get.php</b> . <br><br>  The response is expected JSON in the following format: <br><br><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"results"</span></span> : <span class="hljs-string"><span class="hljs-string">"OK"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;%id%&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"&lt;%command%&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>:<span class="hljs-string"><span class="hljs-string">"&lt;%Server Timestamp%&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>:{ &lt;%Command parameters as JSON%&gt; }, }, }</code> </pre> <br>  Each time you access the app, it sends information about the infected device.  The message format is shown below.  It should be noted that the fields <b>full</b> , <b>extra</b> , <b>apps</b> and <b>permission</b> are optional and will be sent only in the case of a request command from CnC. <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"info"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"info"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"cell"</span></span>:&lt;%Sim operator name%&gt;, <span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:&lt;%Country ISO%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imei"</span></span>:&lt;%IMEI%&gt;, <span class="hljs-attr"><span class="hljs-attr">"number"</span></span>:&lt;%Phone number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"line1Number"</span></span>:&lt;%Phone number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"advertisementId"</span></span>:&lt;%ID%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"state"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"admin"</span></span>:&lt;%Has admin rights%&gt;, <span class="hljs-attr"><span class="hljs-attr">"source"</span></span>:&lt;%String%&gt;, <span class="hljs-attr"><span class="hljs-attr">"needPermissions"</span></span>:&lt;%Application needs permissions%&gt;, <span class="hljs-attr"><span class="hljs-attr">"accesByName"</span></span>:&lt;%Boolean%&gt;, <span class="hljs-attr"><span class="hljs-attr">"accesByService"</span></span>:&lt;%Boolean%&gt;, <span class="hljs-attr"><span class="hljs-attr">"safetyNet"</span></span>:&lt;%String%&gt;, <span class="hljs-attr"><span class="hljs-attr">"defaultSmsApp"</span></span>:&lt;%Default Sms Application%&gt;, <span class="hljs-attr"><span class="hljs-attr">"isDefaultSmsApp"</span></span>:&lt;%Current application is Default Sms Application%&gt;, <span class="hljs-attr"><span class="hljs-attr">"dateTime"</span></span>:&lt;%Current date time%&gt;, <span class="hljs-attr"><span class="hljs-attr">"batteryLevel"</span></span>:&lt;%Battery level%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"socks"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%Proxy module ID%&gt;, <span class="hljs-attr"><span class="hljs-attr">"enabled"</span></span>:&lt;%Is enabled%&gt;, <span class="hljs-attr"><span class="hljs-attr">"active"</span></span>:&lt;%Is active%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"versionName"</span></span>:&lt;%Package Version Name%&gt;, <span class="hljs-attr"><span class="hljs-attr">"versionCode"</span></span>:&lt;%Package Version Code%&gt;, <span class="hljs-attr"><span class="hljs-attr">"lastUpdateTime"</span></span>:&lt;%Package Last Update Time%&gt;, <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>:&lt;%Tag, default value: <span class="hljs-string"><span class="hljs-string">"TAG"</span></span>%&gt;, <span class="hljs-attr"><span class="hljs-attr">"targetSdkVersion"</span></span>:&lt;%Target Sdk Version%&gt;, <span class="hljs-attr"><span class="hljs-attr">"buildConfigTimestamp"</span></span>:<span class="hljs-number"><span class="hljs-number">1541309066721</span></span> }, }, <span class="hljs-attr"><span class="hljs-attr">"full"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:&lt;%Device Model%&gt;, <span class="hljs-attr"><span class="hljs-attr">"localeCountry"</span></span>:&lt;%Country%&gt;, <span class="hljs-attr"><span class="hljs-attr">"localeLang"</span></span>:&lt;%Locale language%&gt;, <span class="hljs-attr"><span class="hljs-attr">"accounts"</span></span>:&lt;%JSON array, contains from <span class="hljs-attr"><span class="hljs-attr">"name"</span></span> and <span class="hljs-attr"><span class="hljs-attr">"type"</span></span> of accounts%&gt;, <span class="hljs-attr"><span class="hljs-attr">"lockType"</span></span>:&lt;%Type of lockscreen password%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"extra"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"serial"</span></span>:&lt;%Build serial number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"board"</span></span>:&lt;%Build Board%&gt;, <span class="hljs-attr"><span class="hljs-attr">"brand"</span></span>:&lt;%Build Brand%&gt;, <span class="hljs-attr"><span class="hljs-attr">"user"</span></span>:&lt;%Build User%&gt;, <span class="hljs-attr"><span class="hljs-attr">"device"</span></span>:&lt;%Build Device%&gt;, <span class="hljs-attr"><span class="hljs-attr">"display"</span></span>:&lt;%Build Display%&gt;, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%Build ID%&gt;, <span class="hljs-attr"><span class="hljs-attr">"manufacturer"</span></span>:&lt;%Build manufacturer%&gt;, <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:&lt;%Build model%&gt;, <span class="hljs-attr"><span class="hljs-attr">"product"</span></span>:&lt;%Build product%&gt;, <span class="hljs-attr"><span class="hljs-attr">"tags"</span></span>:&lt;%Build tags%&gt;, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:&lt;%Build type%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imei"</span></span>:&lt;%imei%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imsi"</span></span>:&lt;%imsi%&gt;, <span class="hljs-attr"><span class="hljs-attr">"line1number"</span></span>:&lt;%phonenumber%&gt;, <span class="hljs-attr"><span class="hljs-attr">"iccid"</span></span>:&lt;%Sim serial number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"mcc"</span></span>:&lt;%Mobile country code of operator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"mnc"</span></span>:&lt;%Mobile network codeof operator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"cellid"</span></span>:&lt;%GSM-data%&gt;, <span class="hljs-attr"><span class="hljs-attr">"lac"</span></span>:&lt;%GSM-data%&gt;, <span class="hljs-attr"><span class="hljs-attr">"androidid"</span></span>:&lt;%Android Id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"ssid"</span></span>:&lt;%Wi-Fi SSID%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"apps"</span></span>:{&lt;%List of installed applications%&gt;}, <span class="hljs-attr"><span class="hljs-attr">"permission"</span></span>:&lt;%List of granted permissions%&gt; }</code> </pre> <br><h3>  Configuration Storage </h3><br>  Gustuff stores important information for work in a preference file.  The file name, as well as the names of the parameters in it, is the result of the calculation of the MD5 sum from line <b>15413090667214.6.1 &lt;% name%&gt;</b> , where <b>&lt;% name%&gt;</b> is the original name-value.  Python interpretation of the name generation function: <br><br><pre> <code class="json hljs"> nameGenerator(input): output = md<span class="hljs-number"><span class="hljs-number">5</span></span>(<span class="hljs-string"><span class="hljs-string">"15413090667214.6.1"</span></span> + input)</code> </pre> <br>  In the following we will denote as <b>nameGenerator (input)</b> . <br><br>  Thus, the name of the first file: <b>nameGenerator ("API_SERVER_LIST")</b> , it contains values ‚Äã‚Äãwith the following names: <br><br><table><tbody><tr><th width="400">  <b>Variable name</b> </th><th>  <b>Value</b> </th></tr><tr><td>  <b>nameGenerator ("API_SERVER_LIST")</b> </td><td>  Contains a list of CnC addresses as an array. </td></tr><tr><td>  <b>nameGenerator ("API_SERVER_URL")</b> </td><td>  Contains the cnc address. </td></tr><tr><td>  <b>nameGenerator ("SMS_UPLOAD")</b> </td><td>  The default flag is set.  If the flag is set, sends SMS messages to CnC. </td></tr><tr><td>  <b>nameGenerator ("SMS_ROOT_NUMBER")</b> </td><td>  The phone number to which SMS messages received by the infected device will be sent.  The default is null. </td></tr><tr><td>  <b>nameGenerator ("SMS_ROOT_NUMBER_RESEND")</b> </td><td>  The default flag is cleared.  If set - when an infected device receives an SMS, it will be sent to the root number. </td></tr><tr><td>  <b>nameGenerator ("DEFAULT_APP_SMS")</b> </td><td>  The default flag is cleared.  If this flag is set, the application will process incoming SMS messages. </td></tr><tr><td>  <b>nameGenerator ("DEFAULT_ADMIN")</b> </td><td>  The default flag is cleared.  If the flag is set, the application has administrator rights. </td></tr><tr><td>  <b>nameGenerator ("DEFAULT_ACCESSIBILITY")</b> </td><td>  The default flag is cleared.  If the flag is set, a service is running that uses the Accessibility Service. </td></tr><tr><td>  <b>nameGenerator ("APPS_CONFIG")</b> </td><td>  The JSON object contains a list of actions that must be performed when an Accessibility event is triggered associated with a specific application. </td></tr><tr><td>  <b>nameGenerator ("APPS_INSTALLED")</b> </td><td>  Stores the list of applications installed on the device. </td></tr><tr><td>  <b>nameGenerator ("IS_FIST_RUN")</b> </td><td>  The flag at the first start is cleared. </td></tr><tr><td>  <b>nameGenerator ("UNIQUE_ID")</b> </td><td>  Contains a unique identifier.  Generated when the bot is first launched. </td></tr></tbody></table><br><h3>  Command processing module from the server </h3><br>  The application stores the addresses of CnC servers as an array of Base85-encoded strings.  The list of CnC servers can be changed when a corresponding command is received, in which case the addresses will be stored in a preference file. <br><br>  In response to the request, the server sends the command to the application.  It is worth noting that the commands and parameters are presented in JSON-format.  The application can handle the following commands: <br><table><tbody><tr><th width="150">  <b>Team</b> </th><th>  <b>Description</b> </th></tr><tr><td>  <b>forwardstart</b> </td><td>  Start sending SMS messages received by the infected device to the CnC server. </td></tr><tr><td>  <b>forwardStop</b> </td><td>  Stop sending SMS messages received by the infected device to the CnC server. </td></tr><tr><td>  <b>ussdRun</b> </td><td>  Run USSD request.  The number to which the USSD request is to be made is in the ‚Äúnumber‚Äù JSON field. </td></tr><tr><td>  <b>sendSms</b> </td><td>  Send one SMS-message (if necessary, the message is ‚Äúsplit‚Äù into parts).  As a parameter, the command takes a JSON object that contains the ‚Äúto‚Äù fields ‚Äî the destination number and ‚Äúbody‚Äù ‚Äîthe message body. </td></tr><tr><td>  <b>sendSmsAb</b> </td><td>  Send SMS messages (if necessary, the message is ‚Äúsplit up‚Äù into parts) to everyone from the contact list of the infected device.  The interval between sending messages is 10 seconds.  The body of the message is in the JSON-field "body" </td></tr><tr><td>  <b>sendSmsMass</b> </td><td>  Send SMS messages (if necessary, the message is ‚Äúsplit up‚Äù into parts) to the contacts specified in the command parameters.  The interval between sending messages is 10 seconds.  As a parameter, the command accepts a JSON array (the ‚Äúsms‚Äù field), the elements of which contain the ‚Äúto‚Äù fields ‚Äî the destination number and the ‚Äúbody‚Äù - message body. </td></tr><tr><td>  <b>changeServer</b> </td><td>  This command can take a value with the key ‚Äúurl‚Äù as a parameter - then the bot will change the nameGenerator (‚ÄúSERVER_URL‚Äù) value, or ‚Äúarray‚Äù - then the bot will write the array into the nameGenerator (‚ÄúAPI_SERVER_LIST‚Äù). Thus, the application changes the address of the CnC servers. </td></tr><tr><td>  <b>adminNumber</b> </td><td>  The command is designed to work with root number.  The command accepts a JSON object with the following parameters: ‚Äúnumber‚Äù - change nameGenerator (‚ÄúROOT_NUMBER‚Äù) to the received value, ‚Äúresend‚Äù - change nameGenerator (‚ÄúSMS_ROOT_NUMBER_RESEND‚Äù), ‚ÄúsendId‚Äù - send to nameGenerator (‚ÄúROOT_NUMBER‚Äù) uniqueID. </td></tr><tr><td>  <b>updateInfo</b> </td><td>  Send information about the infected device to the server. </td></tr><tr><td>  <b>wipeData</b> </td><td>  The command is intended to delete user data.  Depending on which name the application was launched, there is either a complete erasure of data with a device reboot (primary user), or the removal of only user data (secondary user). </td></tr><tr><td>  <b>socksStart</b> </td><td>  Run the proxy module.  The operation of the module is described in a separate section. </td></tr><tr><td>  <b>socksStop</b> </td><td>  Stop the proxy module. </td></tr><tr><td>  <b>openLink</b> </td><td>  Follow the link.  The link is in the JSON parameter by the key "url".  To open the link, use "android.intent.action.VIEW". </td></tr><tr><td>  <b>uploadAllSms</b> </td><td>  Send all received SMS messages to the server. </td></tr><tr><td>  <b>uploadAllPhotos</b> </td><td>  Send images to the URL from an infected device.  URL comes as a parameter. </td></tr><tr><td>  <b>uploadFile</b> </td><td>  Send a file from an infected device to a URL.  URL comes as a parameter. </td></tr><tr><td>  <b>uploadPhoneNumbers</b> </td><td>  Send phone numbers from the contact list to the server.  If the JSON-object value with the key ‚Äúab‚Äù comes as a parameter, the application receives a list of contacts from the phone book.  If the JSON object with the ‚Äúsms‚Äù key comes as a parameter, the application reads the list of contacts from senders of SMS messages. </td></tr><tr><td>  <b>changeArchive</b> </td><td>  The application loads the file from the address that comes in as a parameter using the key ‚Äúurl‚Äù.  The downloaded file is saved with the name "archive.zip".  After this, the application unzips the file, using the password for the archive ‚Äúb5jXh37gxgHBrZhQ4j3D‚Äù, if necessary.  Unzipped files are saved to the [external storage] / hgps directory.  In this directory, the application stores web-fakes (described below). </td></tr><tr><td>  <b>actions</b> </td><td>  The command is designed to work with the Action Service, which is described in a separate section. </td></tr><tr><td>  <b>test</b> </td><td>  Doing nothing. </td></tr><tr><td>  <b>download</b> </td><td>  The command is intended for downloading a file from a remote server and saving it in the ‚ÄúDownloads‚Äù directory.  The URL and the file name come as a parameter, the fields in the JSON object parameter, respectively: ‚Äúurl‚Äù and ‚ÄúfileName‚Äù. </td></tr><tr><td>  <b>remove</b> </td><td>  Removes a file from the ‚ÄúDownloads‚Äù directory.  The file name comes in a JSON parameter with the key "fileName".  The default file name is ‚Äútmp.apk‚Äù. </td></tr><tr><td>  <b>notification</b> </td><td>  Show notification with description and header text, defined by the managing server. </td></tr></tbody></table><br>  Command format <b>notification</b> : <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"results"</span></span> : <span class="hljs-string"><span class="hljs-string">"OK"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: &lt;%id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"notification"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>:&lt;%Server Timestamp%&gt;, <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"openApp"</span></span>:&lt;%Open original app or not%&gt;, <span class="hljs-attr"><span class="hljs-attr">"array"</span></span>:[ {<span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:&lt;%Title text%&gt;, <span class="hljs-attr"><span class="hljs-attr">"desc"</span></span>:&lt;%Description text%&gt;, <span class="hljs-attr"><span class="hljs-attr">"app"</span></span>:&lt;%Application name%&gt;} ] }, }, }</code> </pre> <br>  The notification created by the examined file looks identical to the notifications created by the application specified in the <b>app</b> field.  If the <b>openApp</b> field <b>value</b> is True, when the notification is opened, the application specified in the <b>app</b> field is launched.  If the <b>openApp</b> field <b>value</b> is False, then: <br><br><ul><li>  opens a phishing window, the contents of which is loaded from the directory <b>&lt;% external storage%&gt; / hgps / &lt;% filename%&gt;</b> </li><li>  opens a phishing window, the contents of which is downloaded from the server <b>&lt;% url%&gt;? id = &lt;% Bot id%&gt; &amp; app = &lt;% Application name%&gt;</b> </li><li>  opens a phishing window disguised as a Google Play Card, with the ability to enter data cards. </li></ul><br>  The result of the execution of any command is sent by the application to <b>&lt;% CnC%&gt; \ set_state.php</b> as a JSON object of the following format: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:&lt;%command%&gt;, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%command_id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"state"</span></span>:&lt;%command_state%&gt; } <span class="hljs-string"><span class="hljs-string">"id"</span></span>:&lt;%bot_id%&gt; }</code> </pre> <br>  <b>ActionsService</b> <br><br>  The list of commands that the application handles is <b>action</b> .  When a command is received, the command processing module accesses this service in order to execute the extended command.  As a parameter, the service accepts a JSON object.  The service can execute the following commands: <br><br>  <b>1.</b> <b>PARAMS_ACTION</b> - when receiving such a command, the service first of all receives the value from the JSON parameter by the Type key, it can be the following: <br><br><ul><li>  <b>serviceInfo</b> - the subcommand gets the value from the JSON parameter by the <b>includeNotImportant</b> key.  If the flag is True, the application sets the <b>FLAG_ISOLATED_PROCESS</b> flag to the service using the Accessibility Service.  Thus, the service will be launched in a separate process. </li><li>  <b>root</b> ‚Äî get and send to the server information about the window that is now in focus.  An application obtains information using the AccessibilityNodeInfo class. </li><li>  <b>admin</b> - request administrator rights. </li><li>  <b>delay</b> - suspend the ActionsService for the number of milliseconds specified in the parameter by the ‚Äúdata‚Äù key. </li><li>  <b>windows</b> - send a list of windows visible to the user. </li><li>  <b>install</b> - install the application on the infected device.  The name of the package archive is in the key "fileName".  The archive itself is located in the Downloads directory. </li><li>  <b>global</b> - the subcommand is designed to make the transition from the current window: <br><ul><li>  on the Quick Settings menu </li><li>  backwards </li><li>  home </li><li>  to notifications </li><li>  to the window of recently opened applications </li></ul><br></li><li>  <b>launch</b> - launch an application.  The name of the application comes as a parameter by the <b>data</b> key. </li><li>  <b>sounds</b> - change sound mode to silence. </li><li>  <b>unlock</b> - turns on the backlight of the screen and keyboard at full brightness.  The application performs this action using WakeLock, specifies the string [Application lable]: INFO </li><li>  <b>permissionOverlay</b> - the function is not implemented (the response to the execution of the command is {‚Äúmessage‚Äù: ‚ÄúNot support‚Äù} or {‚Äúmessage‚Äù: ‚Äúlow sdk‚Äù}) </li><li>  <b>gesture</b> - the function is not implemented (response to the execution of the command - {‚Äúmessage‚Äù: ‚ÄúNot support‚Äù} or {‚Äúmessage‚Äù: ‚ÄúLow API‚Äù}) </li><li>  <b>permissions</b> - this command is required to request rights for the application.  However, the query function is not implemented, so the command does not make sense.  The list of requested rights comes as a JSON array with the key "permissions".  Standard list: <br><br><ul><li>  android.permission.READ_PHONE_STATE </li><li>  android.permission.READ_CONTACTS </li><li>  android.permission.CALL_PHONE </li><li>  android.permission.RECEIVE_SMS </li><li>  android.permission.SEND_SMS </li><li>  android.permission.READ_SMS </li><li>  android.permission.READ_EXTERNAL_STORAGE </li><li>  android.permission.WRITE_EXTERNAL_STORAGE </li></ul><br></li><li>  <b>open</b> - display a phishing window.  Depending on the parameter coming from the server, the application may display the following phishing windows: <br><br><ul><li>  Show a phishing window whose contents are registered in a file in the <b>&lt;% external directory%&gt; / hgps / &lt;% param_filename%&gt; directory</b> .  The result of the user's interaction with the window will be sent to <b>&lt;% CnC%&gt; / records.php</b> </li><li>  Show a phishing window, the contents of which are preloaded from the address <b>&lt;% url_param%&gt;? Id = &lt;% bot_id%&gt; &amp; app = &lt;% packagename%&gt;</b> .  The result of the user's interaction with the window will be sent to <b>&lt;% CnC%&gt; / records.php</b> </li><li>  Show a phishing window disguised as a Google Play Card. </li></ul></li><li>  <b>interactive</b> - the command is designed to interact with elements of windows of other applications using the AcessibilityService.  For interaction in the program a special service is implemented.  The application under study can interact with the windows: <br><ul><li>  Active at the moment.  In this case, the parameter contains the id or text (name) of the object with which you want to interact. </li><li>  Visible to the user at the time of execution of the command.  The application selects windows by id. </li></ul><br>  Having obtained <b>AccessibilityNodeInfo</b> objects for window elements of interest, depending on the parameters, the application can perform the following actions: <br><ul><li>  focus - set the focus on the object. </li><li>  click - click on the object. </li><li>  actionId - perform an action by ID. </li><li>  setText - change the text of the object.  The text can be <b>changed in</b> two ways: perform <b>ACTION_SET_TEXT</b> action (if the Android version of the infected device is younger or is equal to <b>LOLLIPOP</b> ), or by placing a string in the clipboard and pasting it into an object (for older versions).  This command can be used to change the data in the banking application. </li></ul></li></ul><br>  <b>2.</b> <b>PARAMS_ACTIONS</b> - the same as <b>PARAMS_ACTION</b> , only comes JSON-array of commands. <br><br>  It seems that many will be interested in what the function of interaction with elements of the window of another application looks like.  This is how this functionality is implemented in Gustuff: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">interactiveAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List aiList, JSONObject action, JsonObject res)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = action.optInt(<span class="hljs-string"><span class="hljs-string">"repeat"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); Iterator aiListIterator = ((Iterable)aiList).iterator(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(aiListIterator.hasNext()) { Object ani = aiListIterator.next(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;= count) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(index = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; ++index) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"focus"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(((AccessibilityNodeInfo)ani).performAction(<span class="hljs-number"><span class="hljs-number">1</span></span>)) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"click"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(((AccessibilityNodeInfo)ani).performAction(<span class="hljs-number"><span class="hljs-number">16</span></span>)) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"actionId"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(((AccessibilityNodeInfo)ani).performAction(action.optInt(<span class="hljs-string"><span class="hljs-string">"actionId"</span></span>))) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"setText"</span></span>)) { customHeader ch = CustomAccessibilityService.a; Context context = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getApplicationContext(); String text = action.optString(<span class="hljs-string"><span class="hljs-string">"setText"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(performSetTextAction(ch, context, ((AccessibilityNodeInfo)ani), text)) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(index == count) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } ((AccessibilityNodeInfo)ani).recycle(); } res.addPropertyNumber(<span class="hljs-string"><span class="hljs-string">"res"</span></span>, Integer.valueOf(count)); }</code> </pre> <br>  Text replacement function: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">performSetTextAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, AccessibilityNodeInfo ani, String text)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Build$VERSION.SDK_INT &gt;= <span class="hljs-number"><span class="hljs-number">21</span></span>) { Bundle b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bundle(); b.putCharSequence(<span class="hljs-string"><span class="hljs-string">"ACTION_ARGUMENT_SET_TEXT_CHARSEQUENCE"</span></span>, ((CharSequence)text)); result = ani.performAction(<span class="hljs-number"><span class="hljs-number">0x200000</span></span>, b); <span class="hljs-comment"><span class="hljs-comment">// ACTION_SET_TEXT } else { Object clipboard = context.getSystemService("clipboard"); if(clipboard != null) { ((ClipboardManager)clipboard).setPrimaryClip(ClipData.newPlainText("autofill_pm", ((CharSequence)text))); result = ani.performAction(0x8000); // ACTION_PASTE } else { result = false; } } return result; }</span></span></code> </pre> <br>  Thus, if the managing server is properly configured, Gustuff is able to fill in the text fields in the banking application and click on the buttons necessary for the transaction.  The trojan does not even need to be authorized in the application - it is enough to send a command to demonstrate the PUSH notifications and then open the previously installed banking application.  The user himself will be authorized, after which Gustuff will be able to make avtozaliv. <br><br><h3>  SMS Processing Module </h3><br>  The application sets an event handler to receive an SMS message from an infected device.  The investigated application can receive commands from the operator that come in the body of an SMS message.  Commands come in the format: <br><br>  <b>7! 5 = &lt;% Base64 encoded command%&gt;</b> <br><br>  The application searches for all incoming SMS messages line <b>7! 5 =</b> , when a line is detected - decodes a line from Base64 at offset 4 and executes the command.  Commands are similar to commands with CnC.  The result of the performance is sent to the same number from which the command was received.  Answer format: <br><br>  <b>7 * 5 = &lt;% Base64 encode of "result_code command"%&gt;</b> <br><br>  Optionally, the application can send all received messages to the Root number.  To do this, the Root number must be specified in the preference file and the message redirect flag must be set.  The SMS message is sent to the number of the attacker in the format: <br><br>  <b>&lt;% From number%&gt; - &lt;% Time format: dd / MM / yyyy HH: mm: ss%&gt; &lt;% SMS body%&gt;</b> <br><br>  Also, the application can optionally send messages to CnC.  The SMS message is sent to the server in JSON format: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%BotID%&gt;, <span class="hljs-attr"><span class="hljs-attr">"sms"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>:&lt;%SMS body%&gt;, <span class="hljs-attr"><span class="hljs-attr">"number"</span></span>:&lt;%From number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"date"</span></span>:&lt;%Timestamp%&gt; } }</code> </pre> <br>  If the <b>nameGenerator</b> flag is <b>set (‚ÄúDEFAULT_APP_SMS‚Äù)</b> , the application stops processing the SMS message and clears the list of incoming messages. <br><br><h3>  Proxy module </h3><br>  In the application under study, there is a Backconnect Proxy module (hereinafter referred to as Proxy module), which has a separate class that includes static fields with configuration.  Configuration data is stored in the open sample: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g-/4f/mi/g-4fmidam6alfsjuhw1ltmcodhy.png" alt="image alt"></div><br><br>  All actions performed by the proxy module are logged into files.  To do this, the application in External Storage creates a directory called ‚Äúlogs‚Äù (the ProxyConfigClass.logsDir field in the configuration class) in which the log files are stored.  Logging occurs in files with the names: <br><br><ol><li>  <b>main.txt</b> - the operation of the class called CommandServer is logged to this file.  Further, the str logging into this file will be denoted as mainLog (str). </li><li>  <b>session - &lt;% id%&gt;. txt</b> - the log data associated with a particular proxy session is saved to this file.  In the future, logging the str string to this file will be referred to as sessionLog (str). </li><li>  <b>server.txt</b> - all data written to the above files is logged to this file. </li></ol><br>  Log data format: <br><br>  &lt;% Date%&gt; [Thread [&lt;% thread id%&gt;], id []]: log-string <br><br>  Exceptions that occur during the operation of the Proxy module are also logged to a file.  For this, the application generates a JSON format object: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"uncaughtException"</span></span>:&lt;%short description of throwable%&gt; <span class="hljs-string"><span class="hljs-string">"thread"</span></span>:&lt;%thread%&gt; <span class="hljs-string"><span class="hljs-string">"message"</span></span>:&lt;%detail message of throwable%&gt; <span class="hljs-string"><span class="hljs-string">"trace"</span></span>: //Stack trace info [ { <span class="hljs-attr"><span class="hljs-attr">"ClassName"</span></span>: <span class="hljs-string"><span class="hljs-string">"FileName"</span></span>: <span class="hljs-string"><span class="hljs-string">"LineNumber"</span></span>: <span class="hljs-string"><span class="hljs-string">"MethodName"</span></span>: }, { <span class="hljs-attr"><span class="hljs-attr">"ClassName"</span></span>: <span class="hljs-string"><span class="hljs-string">"FileName"</span></span>: <span class="hljs-string"><span class="hljs-string">"LineNumber"</span></span>: <span class="hljs-string"><span class="hljs-string">"MethodName"</span></span>: } ] }</code> </pre> <br>  Then it converts it into a string representation and logs it. <br><br>  The launch of the Proxy-module is carried out after the arrival of the appropriate command.  When a command is received to start the proxy module, the application starts a service called <b>MainService</b> , which is responsible for managing the operation of the proxy module ‚Äî starting and stopping it. <br><br>  Stages of service start: <br><br>  <b>1.</b> Starts the timer, which is triggered once a minute and checks the activity of the proxy module.  If the module is not active, it starts it. <br>  Also, when the <b>android.net..nn.CONNECTIVITY_CHANGE</b> event is triggered, a Proxy module is launched. <br><br>  <b>2. The</b> application creates a wake-lock with the <b>PARTIAL_WAKE_LOCK</b> parameter and captures it.  Thus, it does not allow the device's CPU to go to sleep. <br><br>  <b>3.</b> Runs the processing class of commands of the Proxy module, pre-logging the mainLog line <b>("start server")</b> and <br><br>  <b>Server :: start () host [&lt;% proxy_cnc%&gt;], commandPort [&lt;% command_port%&gt;], proxyPort [&lt;% proxy_port%&gt;]</b> <br><br>  where <b>proxy_cnc, command_port and proxy_port</b> are the parameters obtained from the proxy server configuration. <br><br>  The command processing class is called <b>CommandConnection</b> .  Immediately after starting it performs the following actions: <br><br>  <b>4.</b> Connects to <b>ProxyConfigClass.host</b> : <b>ProxyConfigClass.commandPort</b> and sends there data about the infected device in JSON format: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imei"</span></span>:&lt;%imei%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imsi"</span></span>:&lt;%imsi%&gt;, <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:&lt;%model%&gt;, <span class="hljs-attr"><span class="hljs-attr">"manufacturer"</span></span>:&lt;%manufacturer%&gt;, <span class="hljs-attr"><span class="hljs-attr">"androidVersion"</span></span>:&lt;%androidVersion%&gt;, <span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:&lt;%country%&gt;, <span class="hljs-attr"><span class="hljs-attr">"partnerId"</span></span>:&lt;%partnerId%&gt;, <span class="hljs-attr"><span class="hljs-attr">"packageName"</span></span>:&lt;%packageName%&gt;, <span class="hljs-attr"><span class="hljs-attr">"networkType"</span></span>:&lt;%networkType%&gt;, <span class="hljs-attr"><span class="hljs-attr">"hasGsmSupport"</span></span>:&lt;%hasGsmSupport%&gt;, <span class="hljs-attr"><span class="hljs-attr">"simReady"</span></span>:&lt;%simReady%&gt;, <span class="hljs-attr"><span class="hljs-attr">"simCountry"</span></span>:&lt;%simCountry%&gt;, <span class="hljs-attr"><span class="hljs-attr">"networkOperator"</span></span>:&lt;%networkOperator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"simOperator"</span></span>:&lt;%simOperator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>:&lt;%version%&gt; }</code> </pre> <br>  Where: <br><br><ul><li>  id - identifier, trying to get a value from the Shared Preference file with the name "x" with the "id" field.  If this value could not be obtained, it generates a new one.  , Proxy-  ÃÜ , ÃÜ   Bot ID. </li><li> imei ‚Äî IMEI ÃÜ.        ‚Äî         . </li><li> imsi ‚Äî International Mobile Subscriber Identity ÃÜ.        ‚Äî         . </li><li> model ‚Äî The end-user-visible name for the end product. </li><li> manufacturer ‚Äî The manufacturer of the product/hardware (Build.MANUFACTURER). </li><li> androidVersion ‚Äî    "&lt;%release_version%&gt; (&lt;%os_version%&gt;),&lt;%sdk_version%&gt;" </li><li> country ‚Äî   ÃÜ. </li><li> partnerId ‚Äì  . </li><li> packageName ‚Äì package name. </li><li> networkType ‚Äî     (: ¬´WIFI¬ª, ¬´MOBILE¬ª).     null. </li><li> hasGsmSupport ‚Äì true ‚Äì    GSM,  false. </li><li> simReady ‚Äì  SIM-. </li><li> simCountry ‚Äî ISO-  (  ÃÜ -). </li><li> networkOperator ‚Äî  .        ‚Äî         . </li><li> simOperator ‚Äî The Service Provider Name (SPN).        ‚Äî         . </li><li> version ‚Äî     -,   ÃÜ     ¬´1.6¬ª. </li></ul><br> <b>5.</b>       .      : <br><br><ul><li> 0 offset ‚Äì command </li><li> 1 offset ‚Äì sessionId </li><li> 2 offset ‚Äì length </li><li> 4 offset ‚Äî data </li></ul><br>     : <br><br> <b>mainLog(¬´Header { sessionId&lt;%id%&gt;], type[&lt;%command%&gt;], length[&lt;%length%&gt;] }¬ª)</b> <br><br>     : <br><br><table><tbody><tr><th>  Name </th><th> Command </th><th>  Data </th><th>  Description </th></tr><tr><td> <b>connectionId</b> </td><td>  0 </td><td> Connection ID </td><td>    </td></tr><tr><td> <b>SLEEP</b> </td><td>  3 </td><td>  Time </td><td>   Proxy- </td></tr><tr><td> <b>PING_PONG</b> </td><td>  four </td><td>  - </td><td>  PONG- </td></tr></tbody></table><br> PONG-   4     : <b>0x04000000</b> . <br><br>    connectionId (   ) <b>CommandConnection</b>    <b>ProxyConnection</b> . <br><br><ul><li>      : <b>ProxyConnection</b>  <b>end</b> .    <b>ProxyConnection</b>     <b>ProxyConfigClass.host</b> : <b>ProxyConfigClass.proxyPort</b>   JSON-: </li></ul><br><pre> <code class="json hljs"> { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%connectionId%&gt; }</code> </pre> <br>     SOCKS5-,     ,     . ÃÜ       <b>end</b> .       : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hz/ed/y7/hzedy7sapdijp20ayiacbiwarc8.png" alt="image alt"></div><br><h2>  ÃÜ </h2><br>       ÃÜ  CnC-        SSL.             JSON-.       : <br><br><ul><li> <b>http://&lt;%CnC%&gt;/api/v1/set_state.php</b> ‚Äî   . </li><li> <b>http://&lt;%CnC%&gt;/api/v1/get.php</b> ‚Äî  . </li><li> <b>http://&lt;%CnC%&gt;/api/v1/load_sms.php</b> ‚Äî  SMS-ÃÜ   ÃÜ. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/load_ab.php</b> ‚Äî      ÃÜ. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/aevents.php</b> ‚Äì     ,   preference-ÃÜ. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/set_card.php</b> ‚Äî  ,    -,   Google Play Market. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/logs.php</b> ‚Äì  -. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/records.php</b> ‚Äì  ,     . </li><li> <b>http://&lt;%CnC%&gt;/api/v1/set_error.php</b> ‚Äì   ÃÜ . </li></ul><br><h2>  Recommendations </h2><br>              ,          ,     . <br><br>              ,    .               ,   ,             . <br><br>    ‚Äì   - ,      ,      -,    , ,     ,       ,     . <br><br><h3>    : </h3><br><ul><li>         Android  - ,  Google Play; </li><li>     <b> </b>    ; </li><li>     Android; </li><li>      ; </li><li>    ; </li><li>    ,   SMS-. </li></ul><br>   <b> </b> ,          Group-IB. </div><p>Source: <a href="https://habr.com/ru/post/446948/">https://habr.com/ru/post/446948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446926/index.html">‚ÄúSo I realized that I am now a data engineer, and in a different way I can position myself on the market‚Äù</a></li>
<li><a href="../446932/index.html">TDMS Fairway and BIM</a></li>
<li><a href="../446938/index.html">Particle system in Core Animation. Christmas story</a></li>
<li><a href="../446940/index.html">QA for sale. Why is it cool</a></li>
<li><a href="../446944/index.html">Why invest in loss-making companies?</a></li>
<li><a href="../446950/index.html">76% of manufacturers do not have experience in adding additive - why it‚Äôs good</a></li>
<li><a href="../446952/index.html">Create animated histograms with R</a></li>
<li><a href="../446958/index.html">Cunning Perl Quine</a></li>
<li><a href="../446960/index.html">The house that Jack built</a></li>
<li><a href="../446962/index.html">Phishing and no chemistry</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>