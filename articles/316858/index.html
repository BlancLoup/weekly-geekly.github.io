<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Testing UWP applications using Appium</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the moment, UWP applications are used as a solution for testing through the Coded UI interface. But if you have an application for several platform...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Testing UWP applications using Appium</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/6d1/22f/138/6d122f13899244c8aca443f6c31ade25.jpg"></div><br>  At the moment, UWP applications are used as a solution for testing through the Coded UI interface.  But if you have an application for several platforms, in this case you will have to write tests for each platform separately. <br><br>  In 2016, the possibility of testing UWP applications using <a href="http://appium.io/">Appium</a> was announced.  To do this, a driver was created called Windows Application Driver (WinAppDriver). <br><a name="habracut"></a><br>  <a href="http://www.seleniumhq.org/">Selenium</a> , which uses the <a href="http://www.seleniumhq.org/docs/03_webdriver.jsp">WebDriver API</a> , was created to automatically test web applications.  Appium is actually Selenium for Apps. <br><br>  You can test using Appium and WinAppDriver not only with UWP, but also with Win32 applications (for some reason, they don‚Äôt mention .NET, but you can also test them).  To me, as usual, UWP applications are most interesting. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Installing WinAppDriver </h4><br>  Download the latest release <a href="https://github.com/Microsoft/WinAppDriver/releases">from the</a> release <a href="https://github.com/Microsoft/WinAppDriver/releases">page on GitHub</a> <br><br>  After installation, the WinAppDriver.exe executable file will be located in the <b>C: \ Program Files (x86) \ Windows Application Driver</b> directory, by running which you can start the service <br><br><img src="https://habrastorage.org/files/fd2/4cd/d9a/fd24cdd9ae8c424884653be93c2a5d7a.PNG"><br><br>  You can also install Appium, which will interact with WinAppDriver, but you need to install WinAppDriver anyway.  WinAppDriver should be installed along with Appium, but at the time of this writing there are still some overlays, so you have to install it separately.  Just in case, let's leave under the spoiler how to install Appium on a Windows machine. <br><br><div class="spoiler">  <b class="spoiler_title">How to install Appium on Windows 10 using the npm package manager</b> <div class="spoiler_text"> To work with Appium, Node.js version 6.0 or higher and npm version 3.5 and higher are required. <br>  You can check the version of Node.js using the console command <br> <code>node ‚Äìv</code> <br>  Npm version <br> <code>npm ‚Äìv</code> <br>  You can download the Node.js installer from the <a href="https://nodejs.org/en/">official site.</a> <br>  When installed, npm is installed <br><br><img src="https://habrastorage.org/files/b21/1ac/dd6/b211acdd6c3b45f6acf1c08407994904.PNG"><br><br>  If the installed versions are higher than the minimum required, then the following command can be used to start the installation (the command line should be run as administrator): <br> <code>npm install ‚Äìg appium</code> <br>  Now you can run appium on the command line and get the following message: <br><br><img src="https://habrastorage.org/files/ce6/a21/632/ce6a216320d04355b0f8d181056714b0.PNG"><br></div></div><br><h4>  Creating an application project for testing </h4><br>  Let's create a simple UWP application that we will immediately test.  Let the application perform some simple operation, for example, squaring a number.  The source code of the demo application is nowhere easier. <br><br>  In MainPage.xaml add: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{ThemeResource ApplicationPageBackgroundThemeBrush}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0,25,0,0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">TextAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Center"</span></span></span><span class="hljs-tag">&gt;</span></span> :<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AutomationProperties.Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"txtNumber"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"txtNumber"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0,5,0,0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">FontSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"150"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0,25,0,0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">TextAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Center"</span></span></span><span class="hljs-tag">&gt;</span></span>:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AutomationProperties.Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"txtResult"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"txtResult"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">TextAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Center"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">FontSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"18"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"150"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AutomationProperties.Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btnGetSquare"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btnGetSquare"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0,20,0,0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">HorizontalAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Center"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btnGetSquare_Click"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  And MainPage.xaml.cs is only one event: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">btnGetSquare_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> n = Convert.ToDouble(txtNumber.Text); txtResult.Text = (n * n).ToString(); }</code> </pre> <br>  From the manifest we need to save the Package family name.  It is necessary to write a test. <br><br><img src="https://habrastorage.org/files/e21/a79/a6d/e21a79a6de024ab1b3cb1c7d0599a46d.PNG"><br><br>  The same value can be taken from the file vs.appxrecipe, which is located in the Debug / AppX folder.  The value is contained within the RegisteredUserModeAppID. <br><br>  Before testing the application, you need to deploy it.  Here is the application turned out: <br><br><img src="https://habrastorage.org/files/c14/a9b/e8d/c14a9be8da7b40acac5fd0a175ab27d7.PNG"><br><br>  Using the <b>inspect.exe</b> utility, which is located in the <b>C: \ Program Files (x86) \ Windows Kits \ 10 \ bin \ x86 directory,</b> you can define the names of the elements to be used in the test. <br><br>  Having launched the application that needs to be tested, you can either select any control you are interested in in the tree or even just click on the control in the application window itself.  We obtain approximately the following information: <br><br><img src="https://habrastorage.org/files/b08/8f7/464/b088f746463f4bb3a87b6a8866685bcf.png"><br><br>  The following values ‚Äã‚Äãare commonly used to search for an item: ClassName and Name.  With the IOs driver, you can use the search element by its AutomationId. <br><br><h4>  Creating an automated testing project </h4><br>  In Visual Studio, create a project like Unit Test <br><br><img src="https://habrastorage.org/files/12e/ce2/2ec/12ece22ec77d49489179e46a3fadb81b.PNG"><br><br>  In the NuGet package manager, we find and install Appium.WebDriver along with the dependent packages necessary for its operation. <br><br><img src="https://habrastorage.org/files/190/62b/d7c/19062bd7cdd64919b8165b4efea7c1bf.PNG"><br><br>  RemoteWebDriver can be used to work with the UWP application, and IOSDriver can be used.  Most likely, after the final release, some third driver will appear specifically for the Windows platform.  Windows Namespace must be included in the Appium .NET Driver NuGet package. <br>  We write the test code.  In this case, it may be: <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">TestClass</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">UnitTest1</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> AppDriverUrl = <span class="hljs-string"><span class="hljs-string">"http://127.0.0.1:4723"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RemoteWebDriver AppSession; [ClassInitialize] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Setup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TestContext context</span></span></span><span class="hljs-function">)</span></span> { DesiredCapabilities cap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DesiredCapabilities(); cap.SetCapability(<span class="hljs-string"><span class="hljs-string">"app"</span></span>, <span class="hljs-string"><span class="hljs-string">"6b86c2c7-c428-4039-9281-8da10ee45769_dyre41xy79knw!App"</span></span>); AppSession = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RemoteWebDriver(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Uri(AppDriverUrl), cap); Assert.IsNotNull(AppSession); } [ClassCleanup] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestsCleanup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { AppSession.Dispose(); AppSession = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } [TestMethod] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MakeOperation</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { AppSession.FindElementByName(<span class="hljs-string"><span class="hljs-string">"txtNumber"</span></span>).Clear(); AppSession.FindElementByName(<span class="hljs-string"><span class="hljs-string">"txtNumber"</span></span>).SendKeys(<span class="hljs-string"><span class="hljs-string">"5"</span></span>); AppSession.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(<span class="hljs-number"><span class="hljs-number">1</span></span>)); AppSession.FindElementByName(<span class="hljs-string"><span class="hljs-string">"btnGetSquare"</span></span>).Click(); AppSession.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(<span class="hljs-number"><span class="hljs-number">1</span></span>)); RemoteWebElement txtResultTextElement; txtResultTextElement = AppSession.FindElementByName(<span class="hljs-string"><span class="hljs-string">"txtResult"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> RemoteWebElement; Assert.IsNotNull(txtResultTextElement); Assert.AreEqual(<span class="hljs-string"><span class="hljs-string">"25"</span></span>, txtResultTextElement.Text); AppSession.Quit(); } }</code> </pre> <br>  If IOSDriver is used, the initialization code is changed to the following: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> AppDriverUrl = <span class="hljs-string"><span class="hljs-string">"http://127.0.0.1:4723"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IOSDriver&lt;IOSElement&gt; AppSession; [ClassInitialize] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Setup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TestContext context</span></span></span><span class="hljs-function">)</span></span> { DesiredCapabilities cap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DesiredCapabilities(); cap.SetCapability(<span class="hljs-string"><span class="hljs-string">"app"</span></span>, <span class="hljs-string"><span class="hljs-string">"6b86c2c7-c428-4039-9281-8da10ee45769_dyre41xy79knw!App"</span></span>); AppSession = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IOSDriver&lt;IOSElement&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Uri(AppDriverUrl), cap); Assert.IsNotNull(AppSession); }</code> </pre> <br>  As you can see, the changes are minimal.  MakeOperation test code remains the same. <br><br>  Additionally, you can (and if you start Appium, you even need to) specify the platform and device: <br><br><pre> <code class="cs hljs"> cap.SetCapability(<span class="hljs-string"><span class="hljs-string">"platformName"</span></span>, <span class="hljs-string"><span class="hljs-string">"Windows"</span></span>); cap.SetCapability(<span class="hljs-string"><span class="hljs-string">"deviceName"</span></span>, <span class="hljs-string"><span class="hljs-string">"WindowsPC"</span></span>);</code> </pre> <br>  If you run WinAppDriver, then the URL string: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> AppDriverUrl = <span class="hljs-string"><span class="hljs-string">"http://127.0.0.1:4723"</span></span>;</code> </pre> <br>  Well, if you launched Appium, then: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> AppDriverUrl = <span class="hljs-string"><span class="hljs-string">"http://127.0.0.1:4723/wd/hub"</span></span>;</code> </pre> <br>  Run the run test.  You can do this: <br><br><img src="https://habrastorage.org/files/02c/816/04c/02c81604c35c4845a798d2b57bb5304b.PNG"><br><br>  And if everything is correct, we get: <br><br><img src="https://habrastorage.org/files/bdc/677/4e7/bdc6774e739649228c8dbbcfa02227f6.PNG"><br><br>  Small animation of the automated process: <br><br><img src="https://habrastorage.org/files/346/4c4/eb5/3464c4eb599f425bbe5438af136ceccc.gif"><br><br>  Finally, I will give a standard example of working with a Win32 application: <br><br><pre> <code class="cs hljs"> DesiredCapabilities cap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DesiredCapabilities(); cap.SetCapability(<span class="hljs-string"><span class="hljs-string">"app"</span></span>, <span class="hljs-string"><span class="hljs-string">@"C:\Windows\System32\notepad.exe"</span></span>); AppSession = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RemoteWebDriver(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Uri(<span class="hljs-string"><span class="hljs-string">"http://127.0.0.1:4723"</span></span>), cap); AppSession.FindElementByClassName(<span class="hljs-string"><span class="hljs-string">"Edit"</span></span>).SendKeys(<span class="hljs-string"><span class="hljs-string">" Appium!"</span></span>);</code> </pre> <br>  This example opens the notepad and enters the text.  To test a .NET application, it is also sufficient to set the path to the executable file. <br><br>  A couple of links: <br><br>  <a href="https://github.com/Microsoft/WinAppDriver">Page on GitHub</a> <br>  Official documentation page: <a href="">Windows Application UI Testing</a> </div><p>Source: <a href="https://habr.com/ru/post/316858/">https://habr.com/ru/post/316858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316846/index.html">CTFzone write-ups - MISC it all up</a></li>
<li><a href="../316848/index.html">10 unique Internet entrepreneurs of Russia</a></li>
<li><a href="../316850/index.html">Veeam Availability Suite 9.5 - about updates to Veeam ONE, as well as free NFR keys</a></li>
<li><a href="../316854/index.html">"Performance is a feature." Interview with Marco Cecconi, Stack Overflow</a></li>
<li><a href="../316856/index.html">FIAS addresses in the PostgreSQL environment. Part 4. EPILOGUE</a></li>
<li><a href="../316862/index.html">Custom Video Recorder for iOS applications</a></li>
<li><a href="../316864/index.html">Dive into the blockchain technology: Decentralized password-free security system</a></li>
<li><a href="../316866/index.html">Discuss? Gartner: Virtualization Market Reaches Saturation</a></li>
<li><a href="../316868/index.html">Telegram-bot: my story. Part one</a></li>
<li><a href="../316872/index.html">Testing 15+ virtual hosting for Wordpress or how not to disappear from the Yandex index</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>