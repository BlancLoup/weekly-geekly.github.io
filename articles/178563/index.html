<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DB. Directories. Live examples on globala 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 1 
 Part 2 

 The word ‚ÄúLiving,‚Äù in the title of the article, means that the mechanisms, code, and data from these articles are used in the worki...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DB. Directories. Live examples on globala 3</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/105/852/616/105852616928bc675597e11777b8aef8.jpg" align="right"><br>  <a href="http://habrahabr.ru/company/intersystems/blog/175773/">Part 1</a> <br>  <a href="http://habrahabr.ru/company/intersystems/blog/177319/">Part 2</a> <br><br>  The word <b>‚ÄúLiving,‚Äù</b> in the title of the article, means that the mechanisms, code, and data from these articles are used in the working draft. <br><br>  It may be interesting for you to look at some variants of database development solutions (structures, mechanisms). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The picture shows a piece of code that describes the <a href="http://habrahabr.ru/company/intersystems/blog/175773/">global</a> rules of the directory. <br><br>  C <a href="http://habrahabr.ru/company/intersystems/blog/175773/">R</a> UD methods, in the course of their work, constantly refer to these rules to find out exactly what actions need to be performed. <br><br>  Earlier, we stopped at the fact that we have the following globals: <br><ul><li>  <a href="http://habrahabr.ru/company/intersystems/blog/175773/"><b>^ Dictionary</b></a> - <a href="http://habrahabr.ru/company/intersystems/blog/175773/">dictionary</a> elements and their properties; </li><li>  <a href="http://habrahabr.ru/company/intersystems/blog/175773/"><b>^ NameDictionaryElement</b></a> - names of elements of reference books in various languages; </li><li>  <a href="http://habrahabr.ru/company/intersystems/blog/177319/"><b>^ IndexDictionary</b></a> - the main <a href="http://habrahabr.ru/company/intersystems/blog/177319/">index of</a> directories; </li><li>  <a href="http://habrahabr.ru/company/intersystems/blog/177319/"><b>^ RefsDictionary</b></a> - global backlinks to the index (its purpose will be described later). </li></ul><br><div class="spoiler">  <b class="spoiler_title">View globals</b> <div class="spoiler_text"><pre><code class="bash hljs">^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"akp"</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"meh"</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"akp"</span></span>,1)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"meh"</span></span>,2)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,1)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,2)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,1)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,2)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"akp"</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,1)"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"meh"</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,2)"</span></span>)=1</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Create global Ctrl + C / V</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"akp"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"meh"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"akp"</span></span>,1)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"meh"</span></span>,2)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,1)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,2)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,1)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,2)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"akp"</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,1)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"meh"</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,2)"</span></span>)=1</code> </pre><br></div></div><br><a name="habracut"></a><br><a name="ruleDic"></a><br><h4>  Global Directory Rules </h4><br>  Descriptions of all ontologies and types of reference books are stored in this global.  Specific properties, characteristics, various types of indices are indicated.  Calls for data verification functions are prescribed.  A hierarchy of nested structures and so on.  I will talk gradually and explain with examples.  Over time, global rules will grow.  The same thing happens in the process of project life: new types of reference books appear;  new properties are added;  service data processing functions change;  programmed new functionality.  The main purpose of this global is <i>to keep in itself all the specifics of processing reference data</i> . <br><br>  Consider how the global rule <b>^ RuleDictionary works</b> - let its indices mean the following: <br><ol><li>  ontology </li><li>  directory type </li><li>  name of one of the CRUD methods </li><li>  indication of the type of action taken </li><li>  sequence of actions performed </li></ol><br>  I draw your attention to the fact that the indexes of the global rules, starting from the third, in other cases, may mean something else (when we come across this with an example - I will describe it in detail). <br><br>  Print all the rules for ontology. <b>SimpleOntology</b> will execute the command: <br>  <b>zwrite ^ RuleDictionary ("SimpleOntology")</b> <br>  I remind you that <b>‚ÄúMONTOLOGY‚Äù</b> is the name of the namespace. <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;zwrite ^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>) ^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,<span class="hljs-string"><span class="hljs-string">"create"</span></span>,<span class="hljs-string"><span class="hljs-string">"check"</span></span>,10)=<span class="hljs-string"><span class="hljs-string">"do clearPunctuationAndControlCharAllLang()"</span></span> ^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,<span class="hljs-string"><span class="hljs-string">"create"</span></span>,<span class="hljs-string"><span class="hljs-string">"check"</span></span>,20)=<span class="hljs-string"><span class="hljs-string">"do checkUniqueNameElementAllLang()"</span></span> ^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,<span class="hljs-string"><span class="hljs-string">"update"</span></span>,<span class="hljs-string"><span class="hljs-string">"check"</span></span>,10)=<span class="hljs-string"><span class="hljs-string">"do clearPunctuationAndControlCharAllLang()"</span></span> ^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,<span class="hljs-string"><span class="hljs-string">"update"</span></span>,<span class="hljs-string"><span class="hljs-string">"check"</span></span>,20)=<span class="hljs-string"><span class="hljs-string">"do checkUniqueNameElementAllLang()"</span></span> MONTOLOGY&gt;</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Create global Ctrl + C / V</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,<span class="hljs-string"><span class="hljs-string">"create"</span></span>,<span class="hljs-string"><span class="hljs-string">"check"</span></span>,10)=<span class="hljs-string"><span class="hljs-string">"do clearPunctuationAndControlCharAllLang()"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,<span class="hljs-string"><span class="hljs-string">"create"</span></span>,<span class="hljs-string"><span class="hljs-string">"check"</span></span>,20)=<span class="hljs-string"><span class="hljs-string">"do checkUniqueNameElementAllLang()"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,<span class="hljs-string"><span class="hljs-string">"update"</span></span>,<span class="hljs-string"><span class="hljs-string">"check"</span></span>,10)=<span class="hljs-string"><span class="hljs-string">"do clearPunctuationAndControlCharAllLang()"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,<span class="hljs-string"><span class="hljs-string">"update"</span></span>,<span class="hljs-string"><span class="hljs-string">"check"</span></span>,20)=<span class="hljs-string"><span class="hljs-string">"do checkUniqueNameElementAllLang()"</span></span></code> </pre><br></div></div><br>  Let's take a closer look at what we brought out.  As can be seen, there is one type of <b>SimpleType</b> in the ontology of <b>SimpleOntology</b> .  There are no additional parameters in this directory (except default properties).  The <b>create</b> method has two preprocessing and data validation functions.  The same functions are defined for the <b>update</b> method.  They are stored in global values.  The sequence of actions (10, 20) may not necessarily be an integer.  The sequence of execution goes from smaller to larger.  The rules for <b>SimpleOntology</b> and <b>SimpleType</b> will be used for all simple default directories, in which there are only standard properties: names, update date and user <b>uid</b> . <br><a name="create"></a><br><h4>  Create </h4><br>  To understand how this works, consider the <b>create</b> method.  For simplicity, we omit locks, transaction processing and various types of errors.  Then we'll come back to this. <br><a name="create"></a><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#; -------------------------------------------------------------------------------------------------- #;   . #;         . #; -------------------------------------------------------------------------------------------------- create() #;     kill map("out") #;     t #;         create new t #;      set t("err")=$$check("create") #; ,    if t("err")&lt;0 { quit t("err") } #;   "UpdateTime" do setProperty(t("ontology"),t("type"),"UpdateTime",$horolog,t("id"),"false") #;   "uid" do setProperty(t("ontology"),t("type"),"uid",t("uid"),t("id"),"true") set t("lang")="" for { #;    (     ) set t("lang")=$order(t("nameList",t("lang"))) #;   ,     quit:t("lang")="" #;      set t("name")=$get(t("nameList",t("lang"))) #;      do setName(t("ontology"),t("type"),t("lang"),t("name"),t("id")) } #;          do saveOntoAndTypeID #;         do saveElementPath #;         set map("out","id")=t("id") #;     kill map("in") #;     quit t("id") #; --------------------------------------------------------------------------------------------------</span></span></code> </pre><br>  We see that no parameters are explicitly passed to the <b>create ()</b> method.  It is assumed that they are written to the local variable <b>map</b> , which must be defined before calling the method.  In the variable <b>map</b> , we will use two main branches: <b>map ("in")</b> and <b>map ("out")</b> .  A local variable differs from a global variable only in that it is not stored on disk and has a maximum size limit.  In the rest - it is the same indexed as the global.  It can be passed as a parameter to functions: <b><a href="">$ order ()</a></b> , <b><a href="">$ qsubscript ()</a></b> , <b><a href="">$ qlength ()</a></b> , <b><a href="">$ name ()</a></b> and others.  In order not to produce many variables, and not to keep track of the scopes: it is enough to declare one variable <b><a href="">new</a> t</b> .  The variable <b>t</b> will be available anywhere in the <b>create</b> method, as well as in all other programs and subroutines that are called from it.  The same can be said about the variable <b>map</b> .  If inside some function called during the execution of <b>create</b> , <b>new t</b> is encountered - then this function will not have access to the variable <b>t</b> declared inside the <b>create</b> method.  It will work with its variable <b>t</b> , which is inside its scope (elsewhere in the stack of variables).  <i>Perhaps the principles of the scope of variables in Cach√© I explained is not clear enough - ask questions in the comments.</i> <br><br><h5>  check </h5><br>  Next, in <b>t (‚Äúerr‚Äù)</b> we write the result of the <b>$$ check (‚Äúcreate‚Äù)</b> function.  If all checks were successful, the function will return <b>0</b> , otherwise the result will be negative.  Let's see how the <b>$$ check ()</b> function and the methods called from it are arranged.  I note that in these articles: <i>method, function, subroutine - the words are synonyms.</i>  The <b>private</b> word <b>private</b> means that the method can be called only inside the <b>Dictionary</b> program. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#; -------------------------------------------------------------------------------------------------- #;  . #;    ^RuleDictionary    . #; -------------------------------------------------------------------------------------------------- check(action)private #;     check new check #;        action set check=$case(action,"create":$$checkCreate(),"update":$$checkUpdate(),"delete":$$checkDelete(),:-1) #;   quit:check&lt;0 check #;  "uid"      set t("uid")=$get(map("in","uid"),888) #; ,      "check",        if $data(^RuleDictionary(t("ontology"),t("type"),action,"check")) { #;  t("map")        set t("map")=$name(^RuleDictionary(t("ontology"),t("type"),action,"check")) } else { #;  t("map")              set t("map")=$name(^RuleDictionary("SimpleOntology","SimpleType",action,"check")) } set check("i")="" for { #;     set check("i")=$order(@t("map")@(check("i"))) #;   ,     quit:check("i")="" #;     xecute $get(@t("map")@(check("i"))) #;   ,     quit:check&lt;0 } #;    quit check #; -------------------------------------------------------------------------------------------------- #;      . #;  id, ontology, type,   . #; -------------------------------------------------------------------------------------------------- checkCreate()private #;       st("ontology")=$get(map("in","ontology"),"") #;       quit:t("ontology")="" -1 #;        set t("type")=$get(map("in","type"),"") #;  ,      quit:t("type")="" -1 #;     set t("check")=$$checkNames() #;  ,     quit:t("check")&lt;0 t("check") #;       set t("id")=$increment(^Dictionary("MaxID")) #;      ^Dictionary set t("path")=$name(^Dictionary(t("ontology"),t("type"),t("id"))) #;     quit 0 #; -------------------------------------------------------------------------------------------------- checkUpdate() quit 0 #; -------------------------------------------------------------------------------------------------- checkDelete() quit 0 #; -------------------------------------------------------------------------------------------------- #;     . #; -------------------------------------------------------------------------------------------------- checkNames()private #;          merge t("nameList")=map("in","nameList") #;   t("check")  #;         set t("check")=-1 set t("lang")="" for { #;    set t("lang")=$order(t("nameList",t("lang"))) #;   ,     quit:t("lang")="" #;      set t("name")=$get(t("nameList",t("lang")),"") #;    if t("name")="" { #;   t("check")  set t("check")=-1 #;    quit } else { #;  t("check")   ,     set t("check")=0 } } #;     quit t("check") #; --------------------------------------------------------------------------------------------------</span></span></code> </pre><br>  At the very beginning of the <b>check ()</b> method, we perform the mandatory check function for the current action.  In our case, this is the <b>checkCreate ()</b> function.  Please note that the <b>checkUpdate ()</b> and <b>checkDelete ()</b> functions <b>stubs</b> are also present in the code ‚Äî this is necessary for those who copy the <b>Dictionary</b> program themselves and compile it. <br><br>  The <b>checkCreate ()</b> subroutine checks for the ontology and directory type parameters in the input map.  Inside <b>checkNames ()</b> - the presence of names for each specified language is checked, with the obligatory condition of the presence of at least one language (it is impossible to create an element of the directory without a name in our system).  In the same method, the identifier of the created directory element is generated by the safe function <b><a href="">$ increment ()</a></b> .  The current maximal element identifier of the directory (for any ontology and type) is stored in <b>^ Dictionary ("MaxID")</b> . <blockquote>  <a href="http://habrahabr.ru/company/intersystems/blog/175773/">all identifiers are unique, even within different reference books and ontologies</a> </blockquote>  At the end of the <b>checkCreate ()</b> method, we write the canonical name of the Global dictionary branch to the variable <b>t (‚Äúpath‚Äù)</b> , in which the created directory element will be stored. <br><br>  Pay attention to the term <b>merge t ("nameList") = map ("in", "nameList") of</b> the <b>checkNames ()</b> method. <br><blockquote>  The <b>merge</b> command copies whole subtrees of indexed variables into each other, no matter whether they are defined as local or global. <a name="book"></a><blockquote>  The definition is taken from the book: <i>Wolfgang Kirsten.</i>  <i>Michael Iringer.</i>  <i>Matthias K√ºhn</i>  <i>Bernhard R√∂rig.</i>  <i><b>Postrelational Cach√© DBMS 5. Object-oriented application development.</b></i>  <i>Second edition.</i>  <i>Moscow.</i>  <i>Publisher <b>BINOM</b> .</i>  <i>2005. Translation by A. Maslov, K. Aristova.</i>  <i>Page 116.</i> </blockquote></blockquote><br>  So, after running the <b>checkCreate ()</b> method, the local variable <b>t</b> will contain the following important data: <br><a name="t"></a><ul><li>  <b>t ("ontology")</b> - the ontology of the reference element </li><li>  <b>t ("type")</b> - reference type </li><li>  <b>t ("nameList")</b> - names in all specified languages </li><li>  <b>t ("id")</b> - id </li><li>  <b>t ("path")</b> is the canonical name of the global global dictionary <b>^ Dictionary</b> , where information about the element will be stored </li></ul><br>  Continue with the <b>check ()</b> function.  After <b>checkCreate () is</b> executed, we get the user's <b>uid</b> ( <b>888</b> is the default).  Next, in the variable <b>t (‚Äúmap‚Äù)</b> , we write the canonical name of the global rule thread containing the necessary verification functions for our ontology of the directory type and action.  Since now, in the global <b>^ RuleDictionary</b> , rules are defined only for ontology and the default type, the <b>t ("map")</b> will <b>contain the</b> canonical view of the <b>^ RuleDictionary ("SimpleOntology", "SimpleType", "create", "check" )</b> . <br><br>  Let us examine in detail the line: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> check(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)=<span class="hljs-variable"><span class="hljs-variable">$order</span></span>(@t(<span class="hljs-string"><span class="hljs-string">"map"</span></span>)@(check(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)))</code> </pre><br>  I remind you that <b><a href="">@</a></b> is an indirection operator.  The initial value of the <b>check ("i")</b> = <b>""</b> .  So at the beginning of the loop, the string is equivalent to the following: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> check(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)=<span class="hljs-variable"><span class="hljs-variable">$order</span></span>(^RuleDictionary(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,<span class="hljs-string"><span class="hljs-string">"create"</span></span>,<span class="hljs-string"><span class="hljs-string">"check"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>))</code> </pre><br>  That is, <b>check (‚Äúi‚Äù)</b> will be 10. <i>If the syntax of the indirection operator causes questions, ask in the comments.</i> <br><br>  Now let's look at: <br><pre> <code class="bash hljs">xecute <span class="hljs-variable"><span class="hljs-variable">$get</span></span>(@t(<span class="hljs-string"><span class="hljs-string">"map"</span></span>)@(check(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)))</code> </pre><br><blockquote>  The <b>xecute</b> command <b>executes</b> a string of characters as a single-line subroutine. <blockquote>  <i>Page 115, <a href="http://habrahabr.ru/post/178563/">the same</a> book.</i> </blockquote></blockquote><br>  That is, at the beginning of the cycle we will execute what is written in <b>^ RuleDictionary (‚ÄúSimpleOntology‚Äù, ‚ÄúSimpleType‚Äù, ‚Äúcreate‚Äù, ‚Äúcheck‚Äù, 10)</b> .  And this: <br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">do</span></span> clearPunctuationAndControlCharAllLang()</code> </pre><br>  After executing this subroutine, punctuation and service characters will be thrown from the names in all specified languages. <br><br>  At the next loop iteration, we will execute the value <b>^ RuleDictionary (‚ÄúSimpleOntology‚Äù, ‚ÄúSimpleType‚Äù, ‚Äúcreate‚Äù, ‚Äúcheck‚Äù, 20)</b> .  And this: <br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">do</span></span> checkUniqueNameElementAllLang()</code> </pre><br>  This routine checks the uniqueness of the name for all specified languages.  If at least one name is not unique, an error is written to the <b>check</b> variable defined in the <b>check ()</b> method. <br><br><div class="spoiler">  <b class="spoiler_title">Subroutine code:</b> <div class="spoiler_text"><pre> <code class="hljs swift">#; -------------------------------------------------------------------------------------------------- clearPunctuationAndControlCharAllLang() <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #;     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=$order(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>))) quit:t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #;           <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>))=$$clearPunctuationAndControlChar($<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)),<span class="hljs-string"><span class="hljs-string">""</span></span>)) } quit #; -------------------------------------------------------------------------------------------------- checkUniqueNameElementAllLang() <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #;     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=$order(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>))) quit:t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #;    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"name"</span></span>)=$<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)),<span class="hljs-string"><span class="hljs-string">""</span></span>) #;   check     (<span class="hljs-number"><span class="hljs-number">0</span></span> -  ) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> check=$$checkUniqueNameElement() #;     -    quit:check&lt;<span class="hljs-number"><span class="hljs-number">0</span></span> } quit #; -------------------------------------------------------------------------------------------------- #;         . #; -------------------------------------------------------------------------------------------------- clearPunctuationAndControlChar(str) new t #;  t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>)     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #;      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)=<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>:$length(str) { #;    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"ch"</span></span>)=$extract(str,t(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> '((t(<span class="hljs-string"><span class="hljs-string">"ch"</span></span>)?1P)||(t(<span class="hljs-string"><span class="hljs-string">"ch"</span></span>)?1C)) { #;       <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>)=t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>)_t(<span class="hljs-string"><span class="hljs-string">"ch"</span></span>) } } #;    quit t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>) #; -------------------------------------------------------------------------------------------------- #; -------------------------------------------------------------------------------------------------- #;      ,   ,   . #;  ,   . #; -------------------------------------------------------------------------------------------------- checkUniqueNameElement() #;    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"q"</span></span>)=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #; ,         #;   , ,   (  ) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>)=$order(^<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>),<span class="hljs-string"><span class="hljs-string">"name"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>),$zconvert(t(<span class="hljs-string"><span class="hljs-string">"name"</span></span>),<span class="hljs-string"><span class="hljs-string">"l"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>))) #;     quit:t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #; ,      #;     update <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>)'=t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>)) { #;  ,       <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"q"</span></span>)=-<span class="hljs-number"><span class="hljs-number">1</span></span> quit } } #;   quit t(<span class="hljs-string"><span class="hljs-string">"q"</span></span>) #; --------------------------------------------------------------------------------------------------</code> </pre><br></div></div><br>  Subroutines use new, for us, functions: <b><a href="">$ zconvert ()</a></b> , <b><a href="">$ length ()</a></b> , <b><a href="">$ extract ()</a></b> ;  as well as the pattern checking operator - the symbol <b>"?"</b>  .  Checking the presence of punctuation in the string and service characters can be done in another way, using built-in Kashev functions, but my project uses a character-by-character analysis method. <br><br>  So, our method <b><a href="http://habrahabr.ru/post/178563/">create ()</a></b> , successfully executed the line: <b>set t ("err") = $$ check ("create")</b> , and in the variable <b><a href="http://habrahabr.ru/post/178563/">t</a></b> - important service information is stored. <br><br><h5>  setProperty </h5><br>  Next, we set the <b>‚ÄúUpdateTime‚Äù</b> and <b>‚Äúuid‚Äù</b> properties using the <b>setProperty ()</b> function. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#; -------------------------------------------------------------------------------------------------- #;  ,     . #;         . #; -------------------------------------------------------------------------------------------------- setProperty(ontology,type,property,value,id,index="true")private #;      ()    set ^Dictionary(ontology,type,id,0,property)=value #;    if index="true" { #;   set ^IndexDictionary(ontology,type,property,value,id)=1 #;      set ^RefsDictionary(id,$name(^|"MONTOLOGY"|IndexDictionary(ontology,type,property,value,id)))=1 } quit 0 #; --------------------------------------------------------------------------------------------------</span></span></code> </pre><br>  <i><b><a href="">$ horolog</a></b> is the current date and time in Cach√© format.</i>  Please note that the <b>‚ÄúUpdateTime‚Äù</b> property - we do not index (extreme parameter <i>index = ‚Äúfalse‚Äù</i> ).  In the same method for the first time appears global <b>^ RefsDictionary</b> .  The structure of its indices is simple: <br><ol><li>  item id </li><li>  canonical name of the global index thread </li></ol><br>  That is, if necessary (for example, when deleting an element) - we will quickly get all the different sets of indices that contain the reference to this element. <br><br><h5>  setName </h5><br>  Next, we set the values ‚Äã‚Äãof the names using the <b>setName ()</b> function. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#; -------------------------------------------------------------------------------------------------- #;   ,     . #;  (  )   . #; -------------------------------------------------------------------------------------------------- setName(ontology,type,lang,value,id)private #;         set ^NameDictionaryElement(id,lang,0)=value #;   / set ^NameDictionaryElement(id,lang,0,"UpdateTime")=$horolog #;     set ^IndexDictionary(ontology,type,"name",lang,$zconvert(value,"l"),id)=1 #;    set ^RefsDictionary(id,$name(^|"MONTOLOGY"|IndexDictionary(ontology,type,"name",lang,$zconvert(value,"l"),id)))=1 quit 0 #; --------------------------------------------------------------------------------------------------</span></span></code> </pre><br>  After that, we call the <b>saveOntoAndTypeID</b> function, which will write the ontology and the element type to the Global <b>^ IndexDictionary (‚ÄúID‚Äù, t (‚Äúid‚Äù))</b> branch.  This is necessary in case, in the future, we need to find out by the reference element what type and ontology it belongs to.  Next, the function <b>saveElementPath</b> in the same branch, write the path to the directory element. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#; -------------------------------------------------------------------------------------------------- saveOntoAndTypeID set ^IndexDictionary("ID",t("id"),"ontology")=t("ontology") set ^RefsDictionary(t("id"),$name(^|"MONTOLOGY"|IndexDictionary("ID",t("id"),"ontology")))=1 set ^IndexDictionary("ID",t("id"),"type")=t("type") set ^RefsDictionary(t("id"),$name(^|"MONTOLOGY"|IndexDictionary("ID",t("id"),"type")))=1 quit #; -------------------------------------------------------------------------------------------------- saveElementPath set ^IndexDictionary("ID",t("id"),"path")=t("path") set ^RefsDictionary(t("id"),$name(^|"MONTOLOGY"|IndexDictionary("ID",t("id"),"path")))=1 quit #; --------------------------------------------------------------------------------------------------</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Please note that all entries in the global </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RefsDictionary</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contain the explicit name of the namespace </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| "MONTOLOGY" |</font></font></b>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If in the future, we will work with this global from another namespace, then we will always have the correct full path. </font><font style="vertical-align: inherit;">Of course, even inside the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dictionary</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> program itself </font><font style="vertical-align: inherit;">, it is necessary to prescribe full paths (in case of calling methods from other namespaces). </font><font style="vertical-align: inherit;">In my project, this is implemented by means of macros, however, for simplicity, for now I am providing simplified code.</font></font><br><a name="allDictionary"></a><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All the code of the program Dictionary:</font></font></b> <div class="spoiler_text"><pre> <code class="hljs swift">#; -------------------------------------------------------------------------------------------------- #;   #; -------------------------------------------------------------------------------------------------- <span class="hljs-type"><span class="hljs-type">Dictionary</span></span> #; -------------------------------------------------------------------------------------------------- #;   . #; -------------------------------------------------------------------------------------------------- retrieve(id,lang=<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,version=<span class="hljs-number"><span class="hljs-number">0</span></span>) quit $<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(^<span class="hljs-type"><span class="hljs-type">NameDictionaryElement</span></span>(id,lang,version),<span class="hljs-string"><span class="hljs-string">""</span></span>) #; -------------------------------------------------------------------------------------------------- #;      . #; -------------------------------------------------------------------------------------------------- retrieveListByIndex(ontology,type,index,value,str=<span class="hljs-string"><span class="hljs-string">""</span></span>,lang=<span class="hljs-string"><span class="hljs-string">"ru"</span></span>) #;     ,       <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> str=$zconvert(str,<span class="hljs-string"><span class="hljs-string">"L"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> id=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #;  ()    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> id=$order(^<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(ontology,type,index,value,id)) #;  ,        quit:id=<span class="hljs-string"><span class="hljs-string">""</span></span> #;   <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> name=$$retrieve(id,lang) #;      str <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $extract($zconvert(name,<span class="hljs-string"><span class="hljs-string">"L"</span></span>),<span class="hljs-number"><span class="hljs-number">1</span></span>,$length(str))=str { #;  (  ) write id_<span class="hljs-string"><span class="hljs-string">" "</span></span>_name,! } } quit #; -------------------------------------------------------------------------------------------------- #;   . #;         . #; -------------------------------------------------------------------------------------------------- create() #;     kill <span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-string"><span class="hljs-string">"out"</span></span>) #;     t #;         create new t #;      <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"err"</span></span>)=$$check(<span class="hljs-string"><span class="hljs-string">"create"</span></span>) #; ,    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> t(<span class="hljs-string"><span class="hljs-string">"err"</span></span>)&lt;<span class="hljs-number"><span class="hljs-number">0</span></span> { quit t(<span class="hljs-string"><span class="hljs-string">"err"</span></span>) } #;   <span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> setProperty(t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>),<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>,$horolog,t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),<span class="hljs-string"><span class="hljs-string">"false"</span></span>) #;   <span class="hljs-string"><span class="hljs-string">"uid"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> setProperty(t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>),<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"uid"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),<span class="hljs-string"><span class="hljs-string">"true"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #;    (     ) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=$order(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>))) #;   ,     quit:t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #;      <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"name"</span></span>)=$<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>))) #;      <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> setName(t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"name"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>)) } #;          <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> saveOntoAndTypeID #;         <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> saveElementPath #;         <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-string"><span class="hljs-string">"out"</span></span>,<span class="hljs-string"><span class="hljs-string">"id"</span></span>)=t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>) #;     kill <span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-string"><span class="hljs-string">"in"</span></span>) #;     quit t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>) #; -------------------------------------------------------------------------------------------------- #;  . #;    ^<span class="hljs-type"><span class="hljs-type">RuleDictionary</span></span>    . #; -------------------------------------------------------------------------------------------------- check(action)<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> #;     check new check #;        action <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> check=$<span class="hljs-keyword"><span class="hljs-keyword">case</span></span>(action,<span class="hljs-string"><span class="hljs-string">"create"</span></span>:$$checkCreate(),<span class="hljs-string"><span class="hljs-string">"update"</span></span>:$$checkUpdate(),<span class="hljs-string"><span class="hljs-string">"delete"</span></span>:$$checkDelete(),:-<span class="hljs-number"><span class="hljs-number">1</span></span>) #;   quit:check&lt;<span class="hljs-number"><span class="hljs-number">0</span></span> check #;  <span class="hljs-string"><span class="hljs-string">"uid"</span></span>      <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=$<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>),<span class="hljs-number"><span class="hljs-number">888</span></span>) #; ,      <span class="hljs-string"><span class="hljs-string">"check"</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $data(^<span class="hljs-type"><span class="hljs-type">RuleDictionary</span></span>(t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>),action,<span class="hljs-string"><span class="hljs-string">"check"</span></span>)) { #;  t(<span class="hljs-string"><span class="hljs-string">"map"</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"map"</span></span>)=$name(^<span class="hljs-type"><span class="hljs-type">RuleDictionary</span></span>(t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>),action,<span class="hljs-string"><span class="hljs-string">"check"</span></span>)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { #;  t(<span class="hljs-string"><span class="hljs-string">"map"</span></span>)              <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"map"</span></span>)=$name(^<span class="hljs-type"><span class="hljs-type">RuleDictionary</span></span>(<span class="hljs-string"><span class="hljs-string">"SimpleOntology"</span></span>,<span class="hljs-string"><span class="hljs-string">"SimpleType"</span></span>,action,<span class="hljs-string"><span class="hljs-string">"check"</span></span>)) } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> check(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #;     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> check(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)=$order(@t(<span class="hljs-string"><span class="hljs-string">"map"</span></span>)@(check(<span class="hljs-string"><span class="hljs-string">"i"</span></span>))) #;   ,     quit:check(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #;     xecute $<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(@t(<span class="hljs-string"><span class="hljs-string">"map"</span></span>)@(check(<span class="hljs-string"><span class="hljs-string">"i"</span></span>))) #;   ,     quit:check&lt;<span class="hljs-number"><span class="hljs-number">0</span></span> } #;    quit check #; -------------------------------------------------------------------------------------------------- #;      . #;  id, ontology, type,   . #; -------------------------------------------------------------------------------------------------- checkCreate()<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> #;       st(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>)=$<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>),<span class="hljs-string"><span class="hljs-string">""</span></span>) #;       quit:t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> -<span class="hljs-number"><span class="hljs-number">1</span></span> #;        <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>)=$<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"type"</span></span>),<span class="hljs-string"><span class="hljs-string">""</span></span>) #;  ,      quit:t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> -<span class="hljs-number"><span class="hljs-number">1</span></span> #;     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>)=$$checkNames() #;  ,     quit:t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>)&lt;<span class="hljs-number"><span class="hljs-number">0</span></span> t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>) #;       <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>)=$increment(^<span class="hljs-type"><span class="hljs-type">Dictionary</span></span>(<span class="hljs-string"><span class="hljs-string">"MaxID"</span></span>)) #;      ^<span class="hljs-type"><span class="hljs-type">Dictionary</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"path"</span></span>)=$name(^<span class="hljs-type"><span class="hljs-type">Dictionary</span></span>(t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>))) #;     quit <span class="hljs-number"><span class="hljs-number">0</span></span> #; -------------------------------------------------------------------------------------------------- checkUpdate() quit <span class="hljs-number"><span class="hljs-number">0</span></span> #; -------------------------------------------------------------------------------------------------- checkDelete() quit <span class="hljs-number"><span class="hljs-number">0</span></span> #; -------------------------------------------------------------------------------------------------- #;     . #; -------------------------------------------------------------------------------------------------- checkNames()<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> #;          merge t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>)=<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>) #;   t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>)  #;         <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>)=-<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #;    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=$order(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>))) #;   ,     quit:t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #;      <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"name"</span></span>)=$<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)),<span class="hljs-string"><span class="hljs-string">""</span></span>) #;    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> t(<span class="hljs-string"><span class="hljs-string">"name"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> { #;   t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>)  <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>)=-<span class="hljs-number"><span class="hljs-number">1</span></span> #;    quit } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { #;  t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>)   ,     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>)=<span class="hljs-number"><span class="hljs-number">0</span></span> } } #;     quit t(<span class="hljs-string"><span class="hljs-string">"check"</span></span>) #; -------------------------------------------------------------------------------------------------- clearPunctuationAndControlCharAllLang() <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #;     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=$order(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>))) quit:t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #;           <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>))=$$clearPunctuationAndControlChar($<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)),<span class="hljs-string"><span class="hljs-string">""</span></span>)) } quit #; -------------------------------------------------------------------------------------------------- checkUniqueNameElementAllLang() <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #;     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=$order(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>))) quit:t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #;    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"name"</span></span>)=$<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(t(<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>)),<span class="hljs-string"><span class="hljs-string">""</span></span>) #;   check     (<span class="hljs-number"><span class="hljs-number">0</span></span> -  ) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> check=$$checkUniqueNameElement() #;     -    quit:check&lt;<span class="hljs-number"><span class="hljs-number">0</span></span> } quit #; -------------------------------------------------------------------------------------------------- #;         . #; -------------------------------------------------------------------------------------------------- clearPunctuationAndControlChar(str) new t #;  t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>)     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #;      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)=<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>:$length(str) { #;    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"ch"</span></span>)=$extract(str,t(<span class="hljs-string"><span class="hljs-string">"i"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> '((t(<span class="hljs-string"><span class="hljs-string">"ch"</span></span>)?1P)||(t(<span class="hljs-string"><span class="hljs-string">"ch"</span></span>)?1C)) { #;       <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>)=t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>)_t(<span class="hljs-string"><span class="hljs-string">"ch"</span></span>) } } #;    quit t(<span class="hljs-string"><span class="hljs-string">"str"</span></span>) #; -------------------------------------------------------------------------------------------------- #; -------------------------------------------------------------------------------------------------- #;      ,   ,   . #;  ,   . #; -------------------------------------------------------------------------------------------------- checkUniqueNameElement() #;    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"q"</span></span>)=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { #; ,         #;   , ,   (  ) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>)=$order(^<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>),<span class="hljs-string"><span class="hljs-string">"name"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>),$zconvert(t(<span class="hljs-string"><span class="hljs-string">"name"</span></span>),<span class="hljs-string"><span class="hljs-string">"l"</span></span>),t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>))) #;     quit:t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span> #; ,      #;     update <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t(<span class="hljs-string"><span class="hljs-string">"uniqueId"</span></span>)'=t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>)) { #;  ,       <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t(<span class="hljs-string"><span class="hljs-string">"q"</span></span>)=-<span class="hljs-number"><span class="hljs-number">1</span></span> quit } } #;   quit t(<span class="hljs-string"><span class="hljs-string">"q"</span></span>) #; -------------------------------------------------------------------------------------------------- #;  ,     . #;         . #; -------------------------------------------------------------------------------------------------- setProperty(ontology,type,property,value,id,index=<span class="hljs-string"><span class="hljs-string">"true"</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> #;      ()    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">Dictionary</span></span>(ontology,type,id,<span class="hljs-number"><span class="hljs-number">0</span></span>,property)=value #;    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> index=<span class="hljs-string"><span class="hljs-string">"true"</span></span> { #;   <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(ontology,type,property,value,id)=<span class="hljs-number"><span class="hljs-number">1</span></span> #;      <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">RefsDictionary</span></span>(id,$name(^|<span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span>|<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(ontology,type,property,value,id)))=<span class="hljs-number"><span class="hljs-number">1</span></span> } quit <span class="hljs-number"><span class="hljs-number">0</span></span> #; -------------------------------------------------------------------------------------------------- #;   ,     . #;  (  )   . #; -------------------------------------------------------------------------------------------------- setName(ontology,type,lang,value,id)<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> #;         <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">NameDictionaryElement</span></span>(id,lang,<span class="hljs-number"><span class="hljs-number">0</span></span>)=value #;   / <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">NameDictionaryElement</span></span>(id,lang,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=$horolog #;     <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(ontology,type,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,lang,$zconvert(value,<span class="hljs-string"><span class="hljs-string">"l"</span></span>),id)=<span class="hljs-number"><span class="hljs-number">1</span></span> #;    <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">RefsDictionary</span></span>(id,$name(^|<span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span>|<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(ontology,type,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,lang,$zconvert(value,<span class="hljs-string"><span class="hljs-string">"l"</span></span>),id)))=<span class="hljs-number"><span class="hljs-number">1</span></span> quit <span class="hljs-number"><span class="hljs-number">0</span></span> #; -------------------------------------------------------------------------------------------------- saveOntoAndTypeID <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>)=t(<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">RefsDictionary</span></span>(t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),$name(^|<span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span>|<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>)))=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),<span class="hljs-string"><span class="hljs-string">"type"</span></span>)=t(<span class="hljs-string"><span class="hljs-string">"type"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">RefsDictionary</span></span>(t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),$name(^|<span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span>|<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),<span class="hljs-string"><span class="hljs-string">"type"</span></span>)))=<span class="hljs-number"><span class="hljs-number">1</span></span> quit #; -------------------------------------------------------------------------------------------------- saveElementPath <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),<span class="hljs-string"><span class="hljs-string">"path"</span></span>)=t(<span class="hljs-string"><span class="hljs-string">"path"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ^<span class="hljs-type"><span class="hljs-type">RefsDictionary</span></span>(t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),$name(^|<span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span>|<span class="hljs-type"><span class="hljs-type">IndexDictionary</span></span>(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,t(<span class="hljs-string"><span class="hljs-string">"id"</span></span>),<span class="hljs-string"><span class="hljs-string">"path"</span></span>)))=<span class="hljs-number"><span class="hljs-number">1</span></span> quit #; --------------------------------------------------------------------------------------------------</code> </pre><br></div></div><br><a name="testCreate"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we will delete all our globals, except the global rules </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">^ RuleDictionary</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><pre> <code class="bash hljs">MONTOLOGY&gt;<span class="hljs-built_in"><span class="hljs-built_in">kill</span></span> ^Dictionary,^IndexDictionary,^NameDictionaryElement,^RefsDictionary MONTOLOGY&gt;</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And create the first two elements of the directory: </font></font><br><pre> <code class="bash hljs">MONTOLOGY&gt;<span class="hljs-built_in"><span class="hljs-built_in">kill</span></span> map MONTOLOGY&gt;<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> map(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>)=<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,map(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"type"</span></span>)=<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span> MONTOLOGY&gt;<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> map(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>)=<span class="hljs-string"><span class="hljs-string">" ,"</span></span>,map(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>)=<span class="hljs-string"><span class="hljs-string">"akp"</span></span> MONTOLOGY&gt;write $<span class="hljs-variable"><span class="hljs-variable">$create</span></span>^Dictionary() 1 MONTOLOGY&gt;<span class="hljs-built_in"><span class="hljs-built_in">kill</span></span> map MONTOLOGY&gt;<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> map(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>)=<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,map(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"type"</span></span>)=<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span> MONTOLOGY&gt;<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> map(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>)=<span class="hljs-string"><span class="hljs-string">""</span></span>,map(<span class="hljs-string"><span class="hljs-string">"in"</span></span>,<span class="hljs-string"><span class="hljs-string">"nameList"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>)=<span class="hljs-string"><span class="hljs-string">"meh"</span></span> MONTOLOGY&gt;write $<span class="hljs-variable"><span class="hljs-variable">$create</span></span>^Dictionary() 2 MONTOLOGY&gt;</code> </pre><br><a name="result"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Print all our globals: </font></font><br><pre> <code class="bash hljs">MONTOLOGY&gt;zwrite ^Dictionary,^IndexDictionary,^NameDictionaryElement,^RefsDictionary ^Dictionary(<span class="hljs-string"><span class="hljs-string">"MaxID"</span></span>)=2 ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62948,47015"</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62948,47022"</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,1,<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>)=<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,1,<span class="hljs-string"><span class="hljs-string">"path"</span></span>)=<span class="hljs-string"><span class="hljs-string">"^Dictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,1,<span class="hljs-string"><span class="hljs-string">"type"</span></span>)=<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,2,<span class="hljs-string"><span class="hljs-string">"ontology"</span></span>)=<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,2,<span class="hljs-string"><span class="hljs-string">"path"</span></span>)=<span class="hljs-string"><span class="hljs-string">"^Dictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"ID"</span></span>,2,<span class="hljs-string"><span class="hljs-string">"type"</span></span>)=<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"akp"</span></span>,1)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"meh"</span></span>,2)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,1)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,2)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,1)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,2)=1 ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"akp"</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62948,47015"</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62948,47015"</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"meh"</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62948,47022"</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62948,47022"</span></span> ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"ID"</span></span><span class="hljs-string"><span class="hljs-string">",1,"</span></span><span class="hljs-string"><span class="hljs-string">"ontology"</span></span><span class="hljs-string"><span class="hljs-string">")"</span></span>)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"ID"</span></span><span class="hljs-string"><span class="hljs-string">",1,"</span></span><span class="hljs-string"><span class="hljs-string">"path"</span></span><span class="hljs-string"><span class="hljs-string">")"</span></span>)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"ID"</span></span><span class="hljs-string"><span class="hljs-string">",1,"</span></span><span class="hljs-string"><span class="hljs-string">"type"</span></span><span class="hljs-string"><span class="hljs-string">")"</span></span>)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"akp"</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,1)"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"ID"</span></span><span class="hljs-string"><span class="hljs-string">",2,"</span></span><span class="hljs-string"><span class="hljs-string">"ontology"</span></span><span class="hljs-string"><span class="hljs-string">")"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"ID"</span></span><span class="hljs-string"><span class="hljs-string">",2,"</span></span><span class="hljs-string"><span class="hljs-string">"path"</span></span><span class="hljs-string"><span class="hljs-string">")"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"ID"</span></span><span class="hljs-string"><span class="hljs-string">",2,"</span></span><span class="hljs-string"><span class="hljs-string">"type"</span></span><span class="hljs-string"><span class="hljs-string">")"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"meh"</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,2)"</span></span>)=1</code> </pre><br>  ,     ,     ,   <b>¬´UpdateTime¬ª</b> ‚Äî      ‚Äî    .     <b>^IndexDictionary(¬´ID¬ª)</b>        <b>^RefsDictionary</b> .  <b>^Dictionary(¬´MaxID¬ª)</b>        . <br><br> <i>  <b>Dictionary</b>     ,     ,         .  -   ‚Äî  -   ‚Äî   .</i> <br><br>        .     . <br><br>  Thanks for attention. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I will be glad to questions, comments and suggestions. </font></font></div><p>Source: <a href="https://habr.com/ru/post/178563/">https://habr.com/ru/post/178563/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../178553/index.html">Tenfold legibility</a></li>
<li><a href="../178555/index.html">How to charge the smartphone</a></li>
<li><a href="../178557/index.html">N + 1 useful book for business: part 3</a></li>
<li><a href="../178559/index.html">LG Smart World: The Enemy Will Not Pass</a></li>
<li><a href="../178561/index.html">Easy website or how to put a browser on a diet</a></li>
<li><a href="../178567/index.html">Backup and Restore in PostgreSQL</a></li>
<li><a href="../178573/index.html">10 grants of ‚Ç¨ 25,000 to create Massive Open Online Courses. Everybody votes!</a></li>
<li><a href="../178575/index.html">Anonymous site</a></li>
<li><a href="../178577/index.html">Runetology (196): Yegor Rudi, co-founder of the Eruditor Group</a></li>
<li><a href="../178579/index.html">Open source phone "Gongkai" for $ 12</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>