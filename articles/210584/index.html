<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write, collect and run HelloWorld for Android in Notepad</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When I started learning Android, I wanted to completely write and compile an Android application manually - without using an IDE. However, this task p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">ğŸ”</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">ğŸ“œ</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">â¬†ï¸</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">â¬‡ï¸</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write, collect and run HelloWorld for Android in Notepad</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/25e/533/060/25e5330609c9b59d9803aaaa2aae8d79.png"><br><br>  When I started learning Android, I wanted to completely write and compile an Android application manually - without using an IDE.  However, this task proved to be difficult and took me quite a lot of time.  But as it turned out - this approach has brought <b>great benefits</b> and clarified many subtleties that hide the IDE. <br><br>  In fact, this article is a translation and revision of the article <a href="http://geosoft.no/development/android.html">Building Android programs on the command line</a> under the currently current <i>JDK (7)</i> and <i>Android SDK (API level 19)</i> .  In addition, I simplified a lot and added something from myself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Using only a notebook, we will write a very small educational Android application.  And then compile it, build and run on the device - and all through the command line.  Interested?  Then I ask. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  I was amazed at how complex and confusing the sample application in android studio is.  It is simply piled up with resources.  And to a lesser extent - code and scripts.  Although all it has to do is display HelloWorld!  In addition, the books and manuals that I have reviewed explain how to create an IDEA or eclipse HelloWorld using dialog boxes - and further narrative is already coming from it.  And what happens "under the hood" - it remains only to guess. <br><br>  Long searches were almost unsuccessful - I did not find any articles on this topic in Russian, but in English there was outdated information and some things had to be <a href="http://stackoverflow.com/">edited by</a> file, walking along <a href="http://stackoverflow.com/">stackflowflow</a> and <a href="http://developer.android.com/guide/index.html">documentation</a> .  When I figured it out, I decided to fill the gap - what if someone came in handy?  Actually, this is how the article appeared. <br><br>  We will create our own template project, which is ideal for training.  There will be nothing superfluous, only all the most necessary.  And then we will analyze in detail how to assemble and run it on your Android device.  At the end of the article there will be a link to download the archive with the final project - if you have any questions, you can check it out. <br><br>  Thus, you will be 100% aware and understand the composition of your project and the process of its assembly.  Although this test project is designed for training, with a little refinement it can be used as a <b>solid foundation</b> for your real projects. <br><br><h4>  Training </h4><br>  First you need to have <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK 7</a> and <a href="http://developer.android.com/sdk/index.html">android SDK</a> installed.  The last way you need to configure a little after installation. <br><br>  <b>The main requirement before reading this article</b> is that in addition to the installed software, you should already be able to run the Helloworld that comes with Eclipse or Android Studio on your device.  Those.  you must have a usb driver configured, usb debugging enabled on your device, etc ... Or, an emulator is created and configured.  These are very basic things, and their consideration is beyond the scope of this article - there is enough information on the net.  By the way, reading a couple of chapters from books will also not be superfluous - at least to understand how the manifest works, resources, and indeed the basics of the Java language.  And in this article I will describe what the books are silent about. <br><br><h4>  Writing a project </h4><br>  To get started, create some folder where your project will be.  Let's call it mytestapp.  In it, create 4 more folders - <i>bin</i> , <i>obj</i> , <i>res</i> and <i>src</i> . <br><br>  Create an empty text file and change its name to <i>AndroidManifest.xml</i> .  If you are a novice user of Windows, you need <a href="http://www.google.ru/search%3Fq%3Dwindows%2B%25D0%25B2%25D0%25BA%25D0%25BB%25D1%258E%25D1%2587%25D0%25B8%25D1%2582%25D1%258C%2B%25D1%2580%25D0%25B0%25D1%2581%25D1%2588%25D0%25B8%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F%2B%25D1%2584%25D0%25B0%25D0%25B9%25D0%25BB%25D0%25BE%25D0%25B2">to enable the display of extensions</a> , otherwise the file will still be text. <br><br>  Add the following to it: <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.example.testapp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-sdk</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:targetSdkVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"19"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestApp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  It's simple.  We intend to make an application named TestApp, which at startup starts the MainActivity class.  It remains only to write this small class - and the application is ready.  If necessary, edit the android: targetSdkVersion property in the uses-sdk tag â€” install the version that you have. <br><br>  Next - create a simple resource - the string <i>Hello test app</i> .  In fact, we could do without a resource by inserting this line directly into Java code.  But some assembly steps work with resources, and in order to see interesting moments we will work with them. <br><br>  Let's create in the <i>res</i> folder the <i>values</i> folder.  All resources should be divided into folders.  Next, create an empty <i>strings.xml</i> file in it.  and we will write in it <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hello"</span></span></span><span class="hljs-tag">&gt;</span></span>Hello test app!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  That's all the resources we need.  Simple, isn't it?  Next, we will create a <i>com</i> folder inside <i>src</i> , an <i>example</i> folder in it, then a <i>testapp</i> folder even lower down in the hierarchy - and then our class is <i>MainActivity.java</i> .  Add there code <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example.testapp; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); TextView textView = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); textView.setText(getString(R.string.hello)); setContentView(textView); } }</code> </pre> <br>  The directory structure should get this <br><pre> <code class="hljs pgsql">â”‚ AndroidManifest.xml â”œâ”€â”€â”€bin â”œâ”€â”€â”€obj â”œâ”€â”€â”€res â”‚ â””â”€â”€â”€<span class="hljs-keyword"><span class="hljs-keyword">values</span></span> â”‚ strings.xml â”‚ â””â”€â”€â”€src â””â”€â”€â”€com â””â”€â”€â”€example â””â”€â”€â”€testapp MainActivity.java</code> </pre><br>  And this is actually all that we needed for the simplest project.  For comparison - <br><div class="spoiler">  <b class="spoiler_title">HelloWorld from android studio</b> <div class="spoiler_text"><pre> <code class="hljs css">â”‚ <span class="hljs-selector-class"><span class="hljs-selector-class">.gitignore</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">AndroidStudioHWProject</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.iml</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">build</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.gradle</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradlew</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradlew</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bat</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">local</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.properties</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">settings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.gradle</span></span> â”‚ â”œâ”€â”€â”€<span class="hljs-selector-class"><span class="hljs-selector-class">.gradle</span></span> â”‚ â””â”€â”€â”€1<span class="hljs-selector-class"><span class="hljs-selector-class">.8</span></span> â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">taskArtifacts</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.properties</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.properties</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.lock</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">fileHashes</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">fileSnapshots</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">outputFileStates</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">taskArtifacts</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> â”‚ â”œâ”€â”€â”€<span class="hljs-selector-class"><span class="hljs-selector-class">.idea</span></span> â”‚ â”‚ <span class="hljs-selector-class"><span class="hljs-selector-class">.name</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">compiler</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">encodings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradle</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">misc</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">modules</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">vcs</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">workspace</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">copyright</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">profiles_settings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">libraries</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ComAndroidSupportAppcompatV71901_aar</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">support_v4_19_0_1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">scopes</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">scope_settings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">AndroidStudioHW</span></span> â”‚ â”‚ <span class="hljs-selector-class"><span class="hljs-selector-class">.gitignore</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">AndroidStudioHW</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.iml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">build</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.gradle</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">build</span></span> â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">src</span></span> â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">main</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">AndroidManifest</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">java</span></span> â”‚ â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">com</span></span> â”‚ â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">example</span></span> â”‚ â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">androidstudiohw</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">MainActivity</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.java</span></span> â”‚ â”‚ â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">res</span></span> â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">drawable-hdpi</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ic_launcher</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">drawable-mdpi</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ic_launcher</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">drawable-xhdpi</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ic_launcher</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">drawable-xxhdpi</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ic_launcher</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">layout</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">activity_main</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">fragment_main</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">menu</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">main</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ â”‚ â”œâ”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">values</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">dimens</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">strings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">styles</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â”‚ â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">values-w820dp</span></span> â”‚ <span class="hljs-selector-tag"><span class="hljs-selector-tag">dimens</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> â”‚ â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">gradle</span></span> â””â”€â”€â”€<span class="hljs-selector-tag"><span class="hljs-selector-tag">wrapper</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradle-wrapper</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.jar</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradle-wrapper</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.properties</span></span></code> </pre><br>  Actually, automation through gradle, work with git and IDE are very important things, but at the stage of learning Android <b>I would really like to abstract from them</b> . <br></div></div><br><h4>  Assembly </h4><br>  Now we come to the most important and difficult stage.  We will work a lot with the command line, so I recommend that you write all the commands given here into one file and name it <i>comp.bat</i> .  At the end of the file after the commands, you can add <i>pause</i> so that the result and errors can be seen - if any. <br><br><h5>  Preparation of ways </h5><br>  The first thing we will do for convenience and brevity is to create special variables in which we will store paths.  First of all, let's define our main directories.  You need to replace the paths to the JDK and Android SDK with the ones you have. <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> JAVA_HOME=C:\prog\sdk\jdk\<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ANDROID_HOME=C:\prog\sdk\android-studio\sdk <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> DEV_HOME=<span class="hljs-variable"><span class="hljs-variable">%CD%</span></span></code> </pre><br>  Next - the path directly to the programs.  I recommend that you browse the catalogs of your SDK and make sure that everything is in place.  Also correct the versions that are present in the paths. <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> AAPT_PATH=<span class="hljs-variable"><span class="hljs-variable">%ANDROID_HOME%</span></span>/build-tools/<span class="hljs-number"><span class="hljs-number">19</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>/aapt.exe <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> DX_PATH=<span class="hljs-variable"><span class="hljs-variable">%ANDROID_HOME%</span></span>/build-tools/<span class="hljs-number"><span class="hljs-number">19</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>/dx.bat <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ANDROID_JAR=<span class="hljs-variable"><span class="hljs-variable">%ANDROID_HOME%</span></span>/platforms/android-<span class="hljs-number"><span class="hljs-number">19</span></span>/android.jar <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ADB=<span class="hljs-variable"><span class="hljs-variable">%ANDROID_HOME%</span></span>/platform-tools/adb.exe</code> </pre><br>  By the way, in older versions, the aapt utility was in platform-tools - and I do not rule out that it and / or others can slip away somewhere else.  So be careful.  If you check everything right now, then the rest of the article should go smoothly. <br><br>  And yet - in a couple of variables let's score our packages and classes.  If you go to change them - you do not have to run on the code - all the settings at the beginning. <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PACKAGE_PATH=com/example/testapp <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PACKAGE=com.example.testapp <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> MAIN_CLASS=MainActivity</code> </pre><br><h5>  Preparing to compile </h5><br>  And now the fun part.  Remember how classic Java programs compile and run in 2 lines?  Here we use the same <i>javac</i> , but besides it we still have to use many more utilities. <br><br>  To begin, I will ask - have you ever wondered how the mysterious class R works?  Actually he confused me at first because of his supernatural capabilities.  How can one at a compilation stage access the XML files in other directories through the class fields?  I assumed that the precompiler was operating there - it turned out that way. <br><br>  Actually, there is a special utility AAPT - it goes through the directories of your resources and creates the very R.java.  It turns out that everything is very simple - it's just a class, which includes other static nested classes with integer constants.  And that's it!  It looks like this <br><div class="spoiler">  <b class="spoiler_title">R.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* AUTO-GENERATED FILE. DO NOT MODIFY. * * This class was automatically generated by the * aapt tool from the resource data it found. It * should not be modified by hand. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example.testapp; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">R</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> </span></span>{ } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> hello=<span class="hljs-number"><span class="hljs-number">0x7f020000</span></span>; } }</code> </pre><br></div></div><br>  Now let's create it with you.  To do this, use the following commands: <br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%AAPT_PATH%</span></span> package -f -m -S <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/res -J <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/src -M <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/AndroidManifest.xml -I <span class="hljs-variable"><span class="hljs-variable">%ANDROID_JAR%</span></span></code> </pre> <br>  Let's figure out what's what.  AAPT - Android Asset Packaging Tool - literally "packer android property".  Its options are: <br><ul><li>  <i>package</i> - says that we just need to pack resources (and not add or remove) </li><li>  <i>-f</i> - rewriting existing <i>R.java</i> , if any </li><li>  <i>-m</i> - place <i>R.java</i> in the proper packages, and not in the root specified in the <i>-J</i> path </li><li>  <i>-S</i> - after this option, we specify the directory with resources </li><li>  <i>-J</i> - after this option, we specify where to save the resulting <i>R.java</i> </li><li>  <i>-I</i> - after this option, we specify the path to the plug-in library - enable <i>android.jar</i> </li></ul><br>  After its execution, the same R.java file should appear in the src directory.  Check it out. <br><br>  Now there is no magic in our project and it is completely syntactically correct for a regular Java compiler.  Let's compile it. <br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%JAVA_HOME%</span></span>/bin/javac -d <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/obj -cp <span class="hljs-variable"><span class="hljs-variable">%ANDROID_JAR%</span></span> -sourcepath <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/src <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/src/<span class="hljs-variable"><span class="hljs-variable">%PACKAGE_PATH%</span></span>/*.java</code> </pre> <br>  If you have previously worked with java, then understand this line is not difficult for you.  However, I still explain what's what: <br><ul><li>  <i>-d</i> - where to put the final packages and * .class-files </li><li>  <i>-cp</i> - classpatch - specify the path to the library <i>android.jar</i> </li><li>  <i>-sourcepath</i> - paths where our * .java files are located (or can be located) </li></ul><br>  After execution, the obj folder should contain packages with our classes in bytecode (* .class).  But after all, bad luck - the android virtual machine is not compatible with it!  But it was conceived and there are reasons for it.  And we use a converter that makes a dex file from class files that is understandable for our green R2D2. <br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%DX_PATH%</span></span> --dex --output=<span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin/classes.dex <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/obj</code> </pre> <br>  The option <i>--dex</i> indicates that we need to convert from * .class to * .dex.  Then, after the <i>--output</i> option, we set the path to the resulting <i>classes.dex</i> file.  And the last argument in this command is the path directly to packages containing * .class files. <br><br>  Make sure our classes.dex is in the bin folder.  Now you just have to pack it together with the resources in the APK file.  Let's do it: <br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%AAPT_PATH%</span></span> package -f -M <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/AndroidManifest.xml -S <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/res -I <span class="hljs-variable"><span class="hljs-variable">%ANDROID_JAR%</span></span> -F <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin/AndroidTest.unsigned.apk <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin</code> </pre> <br>  Here the options are similar to those we used when creating <i>R.java</i> : <br><ul><li>  <i>package</i> - says that we just need to pack resources (and not add or remove) </li><li>  <i>-f</i> - overwrite existing <i>AndroidTest.unsigned.apk</i> , if any </li><li>  <i>-M</i> - after this option, we specify the path to the manifest file </li><li>  <i>-S</i> - after this option, we specify the directory with resources </li><li>  <i>-I</i> - after this option, we specify the path to the plug-in library - enable <i>android.jar</i> </li><li>  <i>-F</i> - after this option, we specify where to save the resulting <i>AndroidTest.unsigned.apk</i> </li><li>  the last argument is the path to the folder with dex files </li></ul><br>  <i>AndroidTest.unsigned.apk</i> should now appear in the bin folder.  And we called it for a reason!  He does not have a digital signature.  Android prohibits install and run applications without a signature.  But creating it is not as difficult as it may seem at first glance. <br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%JAVA_HOME%</span></span>/bin/keytool -genkey -validity <span class="hljs-number"><span class="hljs-number">10000</span></span> -dname "CN=AndroidDebug, O=Android, C=US" -keystore <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/AndroidTest.keystore -storepass android -keypass android -alias androiddebugkey -keyalg RSA -v -keysize <span class="hljs-number"><span class="hljs-number">2048</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%JAVA_HOME%</span></span>/bin/jarsigner -sigalg SHA1withRSA -digestalg SHA1 -keystore <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/AndroidTest.keystore -storepass android -keypass android -signedjar <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin/AndroidTest.signed.apk <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin/AndroidTest.unsigned.apk androiddebugkey</code> </pre> <br>  Actually, these lines launch 2 Java utilities that have nothing to do with the Android SDK - but they are necessary.  The first one creates the AndroidTest.keystore file (check its availability), and the second one - this file connects to <i>AndroidTest.unsigned.apk</i> .  It turns out the file <i>AndroidTest.signed.apk</i> .  Here is such a wild craft files.  But once you create a bat-script, run it - and it will do it all automatically. <br><br>  I think it is not worth spending time on a detailed analysis of the options of these utilities within this article.  You just need to grasp the point - they take <i>AndroidTest.unsigned.apk</i> , sign it with the <i>AndroidTest.keystore</i> file and save to <i>AndroidTest.signed.apk</i> .  If you wish, you can read <a href="http://developer.android.com/tools/publishing/app-signing.html">in the documentation</a> . <br><br>  You will most likely have the warning " <i>Warning: No -tsa or -tsacert is provided and this jar ...</i> ", but do not pay attention. <br><br><h5>  Launch </h5><br>  Now that we have finally compiled our apk-file, we can run it.  Connect usb to your device, or run the emulator.  And then do <br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%ADB%</span></span> uninstall <span class="hljs-variable"><span class="hljs-variable">%PACKAGE%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%ADB%</span></span> install <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin/AndroidTest.signed.apk <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%ADB%</span></span> shell am <span class="hljs-built_in"><span class="hljs-built_in">start</span></span> <span class="hljs-variable"><span class="hljs-variable">%PACKAGE%</span></span>/<span class="hljs-variable"><span class="hljs-variable">%PACKAGE%</span></span>.<span class="hljs-variable"><span class="hljs-variable">%MAIN_CLASS%</span></span></code> </pre> <br>  Actually, the first line removes the program, if it is already there.  For re-launches useful.  The second - installs the APK on your device or emulator.  The third one runs.  Let's take a closer look at her arguments: <br><ul><li>  <i>shell</i> - we want to execute some commands on our device </li><li>  <i>am</i> - use for execution of commands the activity manager </li><li>  <i>start</i> - we want to start some activity </li><li>  the package name and the full class name (including the package) that we start </li></ul><br>  If everything went well, you will see something like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/e87/2a7/c4d/e872a7c4d4c36a71b09eb0e757fbb70c.png"><br><br><h4>  Conclusion </h4><br>  After all the files are assembled, the directory tree should look something like this. <br><pre> <code class="hljs pgsql">â”‚ AndroidManifest.xml â”‚ AndroidTest.keystore â”‚ comp.bat â”‚ â”œâ”€â”€â”€bin â”‚ AndroidTest.signed.apk â”‚ AndroidTest.unsigned.apk â”‚ classes.dex â”‚ â”œâ”€â”€â”€obj â”‚ â””â”€â”€â”€com â”‚ â””â”€â”€â”€example â”‚ â””â”€â”€â”€testapp â”‚ MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> â”‚ R$attr.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> â”‚ R$string.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> â”‚ R.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> â”‚ â”œâ”€â”€â”€res â”‚ â””â”€â”€â”€<span class="hljs-keyword"><span class="hljs-keyword">values</span></span> â”‚ strings.xml â”‚ â””â”€â”€â”€src â””â”€â”€â”€com â””â”€â”€â”€example â””â”€â”€â”€testapp MainActivity.java R.java</code> </pre><br>  Now you can visually see and understand how the assembly of the android application occurs at a lower level.  When you use IDE - if the assembly suddenly goes wrong (and this often happens) - you can get the situation right.  Also note that the final apk-file <b>takes only about 4 kilobytes</b> . <br><br>  <a href="https://drive.google.com/file/d/0BwTdIuGuk1gxWnFYX3Q5VXdnWDg">I post the project archive</a> (Click File-Download).  Please note that I added another small script there - clear.bat.  It deletes all files created during the assembly.  And put his launch on top of comp.bat.  Also added comments after Rem - in steps. <br><br>  Thus, the script produces a <b>complete cleanup and reassembly of the project</b> , including the signature, as well as its removal on the device, installation and launch. </div><p>Source: <a href="https://habr.com/ru/post/210584/">https://habr.com/ru/post/210584/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210574/index.html">Gaming community in terms of independent game developer</a></li>
<li><a href="../210576/index.html">UX-strategy in practice. Part 1 - Framework</a></li>
<li><a href="../210578/index.html">Photo report of the construction process of the data center "DataPro Tver". Part I</a></li>
<li><a href="../210580/index.html">The first video of the Windows interface (1983)</a></li>
<li><a href="../210582/index.html">Fortigate - a worthy replacement for the outgoing Microsoft Forefront TMG</a></li>
<li><a href="../210586/index.html">New Horizons spacecraft is preparing to meet with Pluto</a></li>
<li><a href="../210588/index.html">New Opera 19 for developers</a></li>
<li><a href="../210590/index.html">New MakerBot 3D Printers</a></li>
<li><a href="../210592/index.html">Java ME Embedded on Raspberry Pi</a></li>
<li><a href="../210594/index.html">Google bought Deepmind for $ 500 million</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>