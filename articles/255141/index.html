<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>R-prong electrocardiogram as a parameter of the tree of Pythagoras</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While studying the electrocardiogram event detection algorithms for the research part of the thesis, I found that the RR interval of the cardiogram, c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>R-prong electrocardiogram as a parameter of the tree of Pythagoras</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/188/5d6/a4c/1885d6a4c9d02d970601f753f1550b82.png" alt="image"><br><br>  While studying the electrocardiogram event detection algorithms for the research part of the thesis, I found that the RR interval of the cardiogram, calculated even with the accuracy of the second decimal place, fairly accurately characterizes the cardiovascular system of a particular person.  Since I have been fond of fractal geometry for quite some time, an idea was instantly born in my head how to give ‚Äúpersonal‚Äù qualities to some elementary fractal object. <br><br>  This is how the Pythagorean Electrocardiographic Tree appeared. <br><a name="habracut"></a><br><h4></h4><h4>  The theoretical part - 1. About electrocardiogram </h4><br>  A graphic record of the potential difference created between different parts of the heart muscle during its excitation is called an electrocardiogram (ECG).  The orientation and magnitude of these potentials of the heart on an electrocardiogram are expressed in the amplitude of the teeth and their directivity (polarity) with respect to the isoelectric line.  And cover a range of 0.15 ... 300 Hz at a signal level of 0.3 ... 3 mV. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A normal ECG consists of the teeth and line segments (segments) horizontally between them (Figure 1). <br><br>  <b>Figure 1 - Schematic representation of a normal electrocardiogram.</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/712/ca0/7d0/712ca07d0dc96d7930242c1f08cc58fd.png" alt="image"><br><br>  In clinical practice, leads are used from different parts of the body surface.  These leads are called superficial.  At registration of an electrocardiogram 12 generally accepted assignments, six from extremities and six chest are usually used.  The first three standard leads were suggested by Ainthoven.  The heart rate (HR) is determined by the duration of one cardiac cycle, i.e.  for the duration of the interval R - R. <br><br>  The standard and most convenient for determining heart rate is the II-Einthoven lead, because  in it the R wave has the greatest amplitude. <br><br><h4>  The practical part - 1 </h4><br>  For the calculations, we will use the real ECG of a healthy person in the II lead by Einthoven, obtained from the database of physiological signals [1]. <br><br>  <b>ECG parameters:</b> <br>  ‚Ä¢ ADC resolution of 12 bits; <br>  ‚Ä¢ Sampling frequency 100 Hz; <br>  ‚Ä¢ Duration 10 seconds; <br><br>  <b>Figure 2 - Image of a normal ECG from a DB.</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/e39/993/9d8/e399939d84d49b4a3b7df4ecc40ceb2e.png" alt="image"><br><br>  Next, we define a QRS complex, to then select a R-wave from it. To do this, we use an algorithm based on the operator of the first derivative weighted and squared and on the moving average filter [2]. <br><br>  It sounds harder than it looks: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d8f/a39/80d/d8fa3980dcce72432d0df1c3e099326e.png" alt="image"><br>  where <i>x (n)</i> is the ECG signal, <i>N is the</i> width of the window, within which the first-order difference is calculated, squared and weighted using the coefficient <i>(N-i + 1)</i> . <br><br>  The weighting coefficient decreases linearly, starting from the current difference, to the difference calculated earlier by <i>N</i> samples in time, which provides a smoothing effect. <br><br>  Further smoothing is performed using the moving average filter at <i>M</i> points: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d05/b2c/64f/d05b2c64f6be9d7052b319f6ef33b257.png" alt="image"><br><br>  With a sampling frequency of 100Hz, the width of the filter window is set to <i>M = N = 8</i> .  This algorithm gives a single peak for each QRS complex and suppresses P and T teeth. As a result of processing, we obtain the following ECG view (Figure 3). <br><br>  <b>Figure 3 - ECG image after filtration.</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/900/dd1/60c/900dd160ca7a64e11f1275a4f0d294fd.png" alt="image"><br><br>  The search for the R wave in the processed signal can be performed using a simple peak search algorithm: <br>  1. Scanning a fragment of the signal <i>g (n)</i> , on which a peak is expected, and determining the maximum value of <i>gmax</i> . <br>  2. Determination of the threshold, as a fraction of the maximum, <i>Th = 0.8gmax</i> . <br>  3. For all g (n)&gt; Th, those samples are selected for which the corresponding values ‚Äã‚Äãof <i>g (n) are</i> greater than a certain specified number <i>M of</i> previous or subsequent samples <i>g (n)</i> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b55/d58/e1e/b55d58e1ede9ac9294d94709443409c3.png" alt="image"><br><br>  The set <i>{p}</i> thus defined contains the indices of all peaks found in the signal <i>g (n)</i> . <br>  Peaks caused by artifacts can be rejected by additional conditions, for example, the minimum interval between two adjacent peaks. <br><br>  <b>Figure 4 - ECG image with marked R-teeth.</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/efe/14a/8c6/efe14a8c6de17b26aad69fb34d7a566d.png" alt="image"><br><br>  Next is the simple task itself ‚Äî determining the average RR interval of a given ECG.  And in this case, it is equal to 733ms.  "According to the fan" we calculate the heart rate: <i>60 / 0.733 = 81.85</i> beats / min.  Now we have a value that characterizes the work of the heart of a particular person. <br><br>  <b>A little explanation:</b> <br>  The heart is not a metronome, it cannot tap a beat with equal time intervals between beats.  RR interval for a healthy person varies in small limits.  If the interval fluctuations are significant - this indicates the presence of arrhythmias and other disorders.  The vibration mechanism is a very complex set of processes related to the electrical conductivity of a particular heart. <br><br>  Using the value of the average RR interval as a parameter when building the tree of Pythagoras, you can give it "unique" ("personal") features. <br><br><h4>  The theoretical part - 2. About fractals </h4><br>  Geometric objects are called fractals: lines, surfaces, spatial bodies that have a highly rugged shape and possess the property of self-similarity.  The founder of the theory of fractals, the Franco-American mathematician Benoit Mandelbrot formed the term fractal from the Latin participle fractus.  The corresponding verb frangere is translated as breaking, breaking, i.e.  create fragments of irregular shape.  Self-similarity predetermines the scale invariance (scaling) of the main geometric features of a fractal object, their invariance with a change in scale.  The recurrence of the ruggedness of the lines of fractal objects can be complete (in this case they speak of regular fractals), or some element of randomness can be observed (such fractals are called random).  The structure of random fractals on a small scale is not exactly identical to the entire object, but their statistical characteristics coincide. <br><br>  The Pythagorean tree is a form of a geometric regular fractal, based on a figure known as ‚ÄúPythagorean pants‚Äù [3]. <br><br>  The principle of constructing a geometric fractal is recursion. <br><br><h4>  The practical part - 2 </h4><br>  <b>Pythagorean tree construction algorithm:</b> <br>  1) Build a vertical segment; <br>  2) From the upper end of this segment we recursively construct another 2 segments of lesser length at an angle of 90 ¬∞ to each other; <br>  3) Call the function of constructing two subsequent segments for each branch of the tree; <br><br>  <b>The function of building the tree of Pythagoras in C.</b> <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> L, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(L &gt; max) { L*=<span class="hljs-number"><span class="hljs-number">0.7</span></span>; moveto(x,y); lineto((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(x+L*<span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(a)),(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(yL*<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(a))); x=x+L*<span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(a); y=yL*<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(a); Draw(x,y,L,a+Pi/n); Draw(x,y,L,a-Pi/m); } }</code> </pre> <br>  <b>Figure 5 - Pythagorean tree for ECG with RR: 733ms.</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/05b/293/454/05b29345465d0c30b4eabd437da9087d.png" alt="image"><br><br>  The only thing left to change is to use the calculated length of the average RR ECG interval as a variable L in the program. <br><br>  Thus, you can get the "personal" tree of Pythagoras, which will "breathe", depending on the physical load, and the length of the branches and their twist - "as accurately as possible to describe" your personality. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5af/134/559/5af134559b55c15eeec626b5dd7e6715.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d09/4a2/e3c/d094a2e3c8ec96f8607b9d7cb8089a92.png" alt="image"><br><br><h4>  Bibliography </h4><br>  1. Research resource of complex physiological signals: <a href="http://physionet.org/">physionet.org</a> ; <br>  2. Rangayan R.M.  Analysis of biomedical signals.  Practical approach / Trans.  from English  Ed.  A.P.  Nemirko.  - M .: Fizmatlit, 2010. - 220 p.  - ISBN 978-5-9221-0730-3; <br>  3. <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE_%25D0%259F%25D0%25B8%25D1%2584%25D0%25B0%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B0">en.wikipedia.org/wiki/%D0%94%D0%B5%D1%80%D0%B5%D0%B2%D0%BE_%D0%9F%D0%B8%D1%84 %D0%B0 % D0% B3% D0% BE% D1% 80% D0% B0</a> </div><p>Source: <a href="https://habr.com/ru/post/255141/">https://habr.com/ru/post/255141/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255131/index.html">‚ÄúNot a single break!‚Äù Or why should a customer fight with technical support</a></li>
<li><a href="../255133/index.html">How I fumbled with one button different data in the Android application</a></li>
<li><a href="../255135/index.html">Reverse Engineering ESP8266 - Part 1</a></li>
<li><a href="../255137/index.html">Exploring JavaScript Symbols. Symbol - new data type in javascript</a></li>
<li><a href="../255139/index.html">Collect the best of two worlds - frameworks and CMS (part 2)</a></li>
<li><a href="../255143/index.html">Bag of words and sentiment analysis on R</a></li>
<li><a href="../255145/index.html">PHP Recipes programming. 3rd ed</a></li>
<li><a href="../255151/index.html">Meet ReSharper C ++</a></li>
<li><a href="../255153/index.html">Reverse Engineering ESP8266 - part 2</a></li>
<li><a href="../255155/index.html">12 balls</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>