<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Making a cool Single Page Application on basis.js - part 1, introductory theoretical</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all! 
 This article begins a cycle of publications devoted to basis.js - a framework for creating full-fledged Single Page Application. 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Making a cool Single Page Application on basis.js - part 1, introductory theoretical</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/dbc/f72/e87/dbcf72e87382a87dbbb7afa53d4e291f.png" align="left">  Good day to all! <br>  This article begins a cycle of publications devoted to basis.js - a framework for creating full-fledged Single Page Application. <br><a name="habracut"></a><br><br><h4>  About frameworks </h4><br>  The core of modern frontend frameworks is practically not focused on working with data since it does not have structures and algorithms for processing collections. <br>  Instead, the developer is given the opportunity to work independently with the data and to iterate the collections directly in the template, or to operate with DOM elements directly from the controller / component code, again, independently linking the data with their visual presentation. <br>  The disadvantages of such approaches should be obvious. <br>  When manipulating DOM elements from the controller / component: <br>  - it is necessary to independently implement data structures and data set processing algorithms <br>  - increases the complexity and maintainability of the code, as you have to manually work with DOM ‚Äì elements and establish links between data and DOM ‚Äì elements <br>  - most often it is impossible to use template engines <br><br>  When using a template engine in working with a dataset: <br>  - the readability of the template is deteriorating, since the logic is partially transferred to the template <br>  - Does the template engine effectively implement the mechanism for updating parts of views and is it implemented? <br>  - there are still no data set processing mechanisms 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Previously, all this did not really matter, as the backend was responsible for data processing and their visual presentation. <br>  All that had to be done was to load the page at the right address and the presentation was already formed. <br>  The disadvantage of this approach is the lack of interactivity and dynamism in terms of updating data. <br>  Modern SPA should be autonomous in terms of functionality and contact the server only when it is necessary to synchronize data (save or receive new ones). <br>  Accordingly, all the work on the processing and visualization of this data should be undertaken by the front end. <br>  With the advent of AJAX and WebSocket, it has become much easier to follow data updates and ensure the interactivity of the application. <br>  But AJAX and WebSocket are about working with the network and they do not solve the basic problem - working with data. <br><br>  Let's say you make a one-page application - a client for VKontakte. <br>  Here are some of the requirements for the application: download, update, search, group, sort friends from the social network. <br>  Then the ‚Äúmusic‚Äù section is added.  Here you need to work with playlists (both your own and friends).  Same search. <br>  A ‚Äúmessages‚Äù section is added.  There is work with "rooms" and messages. <br>  I think the meaning is clear ... <br>  So: music, friends, messages and so on - this is all the data that needs to be sorted, grouped, searched and, finally, visualized.  In this case, the visual presentation should be updated in a timely manner in real time. <br><br>  Thus, in the developer‚Äôs arsenal there should be powerful and convenient tools for working, theoretically, with any amount of data. <br><br><h4>  About template engines </h4><br>  In order not to breed a regular holivar, I will not give as an example concrete specific frameworks.  Instead, imagine that there is some abstract framework with a flexible and convenient template engine. <br>  How would we solve the problems of the above SPA? <br>  It's very simple - we download data from the social network server and feed it to the framework template. <br>  Well, the problem of output, we would see, solved. <br>  But here we understand that new elements have been added to the already drawn collection. <br>  What to do? <br>  Again, everything is very simple - we ask the template engine to redraw the view, but with new data. <br>  And everything seems to be good, as long as there is not much data. <br>  Now imagine that we have a collection of 100 objects that we received from the server. <br>  We gave this data to the template engine, it obediently rendered it, but after some time, the server informs us that another item was added to the collection. <br>  What are we doing?  Once again, we give the data to the template engine, and he, the attention, redraws all the previously drawn data. <br>  Not very effective, is it?  Especially if there are more items in the collection. <br>  I‚Äôll note that here I‚Äôm talking about string templating engines that receive a template and data as input, and output a line with HTML ‚Äì code, which you need to insert into the DOM. <br>  But they are string strings and that they have no idea about HTML and DOM.  They do not care what data to insert into which template and what the developer will then do with this data. <br><br><h4>  Pro smart template engines </h4><br>  In contrast to the usual, string, template engines are smarter. <br>  Their advantage is that they are already ‚Äúin the know,‚Äù that they work with HTML and do not output the string with the HTML code, but the DOM ‚Äì tree with the data inserted into it.  At the same time, each data element that entered the input of such a template engine becomes associated with its corresponding DOM-node.  Thus, when changing any element of the collection, only the node with which this element is associated is updated.  We return to the example with a list of 100 elements.  In the case of a smart template engine, it will determine itself - the contents of which elements of the collection have been modified and will update only the corresponding nodes, without redrawing the entire view. <br>  This approach is undoubtedly more efficient, especially with large data sets. <br>  But, again, even he does not solve the main problem - working with data. <br>  Yes, the ability to use pipe ‚Äì filters, which allow modifying data before outputting, is built into such template engines, but, firstly: such an approach impairs the readability of the template;  secondly: it is the ability of the template engine, and not the framework, which uses the template engine and in more complex situations will not save from code clutter, both from the template and from the controller / component. <br>  As a result, a fundamental problem arises, which has already been mentioned here more than once - data processing. <br><br><h4>  About basis.js </h4><br>  <b>Basis.js</b> is a framework whose core was built with the expectation of working with data. <br>  A distinctive feature of the framework is the application building model itself. <br>  The finished application on basis.js is a hierarchy of components between which a stream of data circulates. <br>  At the same time, the image of the data flow best reflects the essence of what is happening, because the creation of an application on basis.js is the establishment of links between parts of the application. <br>  Properly built application eliminates the need for even a banal enumeration of DOM ‚Äì elements. <br>  The framework itself and its flexible tools are responsible for everything. <br>  At the same time, the framework itself is built on abstractions, which allows you to fully use the advantages of polymorphism and, in most cases, abstract away from a specific implementation. <br><br>  The basics of working with basis.js can be found in <a href="https://habrahabr.ru/post/216577/">this article</a> written by the author of the framework. <br>  I had the opportunity to continue the cycle of articles. <br><br><h4>  From theory to practice </h4><br>  One of the main components of any SPA is the application's response to user actions, in other words, timely data update. <br>  If we are talking about data, then in basis.js there is a set of abstractions for describing data. <br>  The simplest of these is the <b>Token</b> class. <br>  Token allows you to describe a scalar value that you can subscribe to change: <br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> token = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> basis.Token(); <span class="hljs-comment"><span class="hljs-comment">//  Token let fn = (value) =&gt; console.log('  :', value); // ‚Äì token.attach(fn); //     token.set(''); //    // console&gt;   :  token.set('habrahabr'); // console&gt;   : habrahabr token.set('habrahabr'); //     , ..       token.detach(fn); //     token.set('basis.js'); //    ,      </span></span></code> </pre> <br>  <b>Token # attach</b> method - adds a subscriber to change the value of the token. <br>  <b>Token</b> method <b># detach</b> - removes a previously added subscriber. <br><br>  Moreover, one token may depend on another: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> token = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> basis.Token(); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sqr = token.as(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) =&gt;</span></span> value * value); <span class="hljs-comment"><span class="hljs-comment">//    ,   token let fn = (value) =&gt; console.log('  :', value); token.attach(fn); token.set(4); // console&gt;   : 4 console.log(token.get()); // console&gt; 4 console.log(sqr.get()); // console&gt; 16 token.set(8); // console&gt;   : 8 console.log(token.get()); // console&gt; 8 console.log(sqr.get()); // console&gt; 64 token.detach(fn); token.set(10); console.log(token.get()); // console&gt; 10 console.log(sqr.get()); // console&gt; 100</span></span></code> </pre><br>  <b>Token # as</b> - creates a new token and automatically signs it to changes in the value of the original token. <br>  Changing the value of the original token, it is transferred to the function specified in <b>as</b> and its result is written to the generated token. <br>  Thus, you can create a chain of tokens, the value of each of which will depend on the value of the previous token: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> token = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> basis.Token(); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sqr = token.as(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) =&gt;</span></span> value * value); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> twoSqr = sqr.as(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) =&gt;</span></span> value * <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fn = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'  :'</span></span>, value); token.attach(fn); token.set(<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-comment"><span class="hljs-comment">// console&gt;   : 4 console.log(token.get()); // console&gt; 4 console.log(sqr.get()); // console&gt; 16 console.log(twoSqr.get()); // console&gt; 32 token.detach(fn); token.set(10); console.log(token.get()); // console&gt; 10 console.log(sqr.get()); // console&gt; 100 console.log(twoSqr.get()); // console&gt; 200</span></span></code> </pre><br>  A token can be destroyed by calling the <b>Token # destroy</b> method. <br>  A destroyed token becomes absolutely useless, because it stops notifying subscribers about updating its value, and new subscribers can no longer be added to it. <br><br>  Here is such a simple and convenient mechanism for updating data laid in basis.js. <br><br>  Let's see how tokens are used in the basis.js components: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Node = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.ui'</span></span>).Node; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> nameToken = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> basis.Token(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Node({ <span class="hljs-attr"><span class="hljs-attr">container</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body, <span class="hljs-comment"><span class="hljs-comment">//    template: resource('./template.tmpl'), //  binding: { name: nameToken }, action: { //   input: (e) =&gt; nameToken.set(e.sender.value) } });</span></span></code> </pre><br>  And here is the template: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">event-input</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {name}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Now, when entering data in a text field, the current value will be substituted for <b>{name}</b> . <br>  In other words: the <b>Node</b> property <b># binding</b> is an object whose properties can be tokens. <br>  The Node subscribes to changes in the value of such tokens and updates the view in a timely manner, with only those parts that have really changed. <br><br>  Of course, I can't ignore the example with <b>Token # as</b> : <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Node = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.ui'</span></span>).Node; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> nameToken = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> basis.Token(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Node({ <span class="hljs-attr"><span class="hljs-attr">container</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body, <span class="hljs-attr"><span class="hljs-attr">template</span></span>: resource(<span class="hljs-string"><span class="hljs-string">'./template.tmpl'</span></span>), <span class="hljs-attr"><span class="hljs-attr">binding</span></span>: { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: nameToken.as(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function"> =&gt;</span></span> value.toUpperCase()) }, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: { <span class="hljs-attr"><span class="hljs-attr">input</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) =&gt;</span></span> nameToken.set(e.sender.value) } });</code> </pre><br>  Already guessed what will be displayed? <br><br>  Of course you can argue, they say: <br><blockquote>  pppffff ... in the anguly the same thing is done without a single line of code </blockquote><br>  Yes, but later you will see how elegantly basis.js copes with much more complex tasks. <br><br>  Despite the fact that in this part of our cycle there was more theory than practice, we considered one of the most important aspects of basis.js, which will help us in understanding further topics. <br><br>  If you, like me, love ES6 and want to use it together with basis.js, then you will need <a href="https://github.com/basisjs/basisjs-tools-babel-plugin">this plugin</a> . <br><br>  Thanks for attention! <br><br>  Many thanks to <a href="https://habrahabr.ru/users/lahmatiy/" class="user_link">lahmatiy</a> for invaluable advice;) <br><br>  Some useful links: <br><ul><li>  <a href="https://github.com/basisjs/articles">Documentation basis.js</a> </li><li>  <a href="https://github.com/basisjs/basisjs">Source code basis.js</a> </li></ul><br><br>  <b>UPD:</b> <br>  <a href="https://habrahabr.ru/post/304608/">The second part of</a> <br>  We launched <a href="https://gitter.im/basisjs/basisjs">gitter chat</a> on basis.js.  Add, ask questions. </div><p>Source: <a href="https://habr.com/ru/post/304078/">https://habr.com/ru/post/304078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304062/index.html">Comparison of eCPM ad networks on personal experience</a></li>
<li><a href="../304068/index.html">"Cloud Technologies in Russia" - the first joint forum of Huawei and RUVDS was held in Moscow</a></li>
<li><a href="../304070/index.html">Secrets of the most effective people (part 2)</a></li>
<li><a href="../304072/index.html">dlang-requests - type python-requests, only for D</a></li>
<li><a href="../304074/index.html">Implementing reference counting or life without GC (almost)</a></li>
<li><a href="../304080/index.html">Knocking out to government agencies or what to do if in the open data someone is wrong?</a></li>
<li><a href="../304082/index.html">Developing a script to compare people's tastes</a></li>
<li><a href="../304090/index.html">Russian Post delivers - you are now laughing, but it‚Äôs the most reliable</a></li>
<li><a href="../304092/index.html">Passed the hackathon on the Yii Framework in TACC</a></li>
<li><a href="../304096/index.html">Gobetween Exec discovery + Elasticsearch. L4 balancing with Data Node Discovery</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>