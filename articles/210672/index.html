<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>10 obscure Objective-C features</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I welcome dear habrazhiteli! 

 Objective-C is a language with a rich runtime, but this article will not <objc/runtime.h> on the contents of the heade...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>10 obscure Objective-C features</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/b0f/e3a/0b0/b0fe3a0b014decd42bc7f0297eedeee7.png" align="right">  I welcome dear habrazhiteli! <br><br>  Objective-C is a language with a rich runtime, but this article will not <code>&lt;objc/runtime.h&gt;</code> on the contents of the header <code>&lt;objc/runtime.h&gt;</code> , but on some of the features of the language itself, which many developers don‚Äôt guess.  Yes, you stumble upon them, reading the documentation, you note to yourself ‚Äúhmm, I wonder, you have to dig a little‚Äù, but they usually quickly fly out of my head.  And novice developers often even read the documentation diagonally. <br><br>  In this article, I have gathered 10 amazing in my opinion properties of the Objective-C language.  Some properties are self-evident, some are far from such.  For the use of some in the combat code, you have to beat your hands, while others are able to help in optimizing critical code points and in debugging.  At the end of the article there is a link to the source code, which shows all these features with an example. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, let me begin with the most "tasty" in my opinion: anonymous methods. <br><br><h2>  1. Unnamed methods </h2><br><a name="habracut"></a><br>  The method name is optional if it has arguments.  Often there are methods of the type <code>- (void)setSize:(CGFloat)x :(CGFloat)y</code> , but this can be brought to the absolute: <br><br><pre> <code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestObject</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSObject</span></span></span><span class="hljs-class"> + (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">):(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">; - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">):(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">; - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">):(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> :(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">b</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> // ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestObject</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">obj</span></span></span><span class="hljs-class"> = [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestObject</span></span></span><span class="hljs-class"> :2]; [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">obj</span></span></span><span class="hljs-class"> :4]; [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">obj</span></span></span><span class="hljs-class"> :5 :7];</span></span></code> </pre><br><br>  Fun and iron selectors for such methods: <code>@selector(:)</code> and <code>@selector(::)</code> . <br><br>  <b>Recommendations for use:</b> for research purposes only. <br><br><h2>  2. The new syntax applies to any objects. </h2><br>  Square brackets to access elements of an array or dictionary can be used with your own objects.  To do this, declare the following methods. <br><br>  To access by index: <br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)objectAtIndexedSubscript:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)index; - (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)setObject:(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)obj atIndexedSubscript:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)index;</code> </pre><br><br>  For key access: <br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)objectForKeyedSubscript:(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)key; - (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)setObject:(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)obj forKeyedSubscript:(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)key;</code> </pre><br><br>  We use: <br><pre> <code class="objectivec hljs"><span class="hljs-keyword"><span class="hljs-keyword">id</span></span> a = obj[<span class="hljs-number"><span class="hljs-number">1</span></span>]; obj[<span class="hljs-string"><span class="hljs-string">@"key"</span></span>] = a;</code> </pre><br><br>  <b>Recommendations for use:</b> sometimes possible, but only if your class is not a collection.  If it is, it is better to inherit from the available ones. <br><br><h2>  3. Implicit <code>@property</code> </h2><br>  The <code>@property</code> ad in the header actually announces only the getter and mutator for some field.  If you declare them directly, nothing will change: <br><br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)value; - (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)setValue:(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)newValue; obj.value = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = obj.value;</code> </pre><br><br>  Also implicit properties are any functions that take no arguments but return a value: <br><br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSArray</span></span> *a = @[@<span class="hljs-number"><span class="hljs-number">1</span></span>, @<span class="hljs-number"><span class="hljs-number">2</span></span>, @<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSInteger</span></span> c = a.count;</code> </pre><br><br>  And also - functions that begin with the name ‚Äúset‚Äù, which return nothing but take one argument: <br><br><pre> <code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestObject</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSObject</span></span></span><span class="hljs-class"> - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">setTitle</span></span></span><span class="hljs-class">:(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSString</span></span></span><span class="hljs-class"> *)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">; //... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestObject</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">obj</span></span></span><span class="hljs-class"> = [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestObject</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">obj</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class"> = @"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">simple</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">object</span></span></span><span class="hljs-class">";</span></span></code> </pre><br><br>  <b>Recommendations for use: the</b> <code>@property</code> ad looks much better, and for this it was introduced.  Properties are best accessed through " <code>.</code> ", But conventional methods are best called via " <code>[]</code> ".  Otherwise, the readability of the code starts to suffer. <br><br><h2>  4. Manual allocation of memory for an object without <code>alloc</code> </h2><br>  Objects can be created using the good old <code>calloc</code> function, then specifying <code>isa</code> manually.  In principle, this is just a replacement for <code>alloc</code> , and <code>init</code> can be sent later. <br><br><pre> <code class="objectivec hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,   void *newObject = calloc(1, class_getInstanceSize([TestObject class])); //  isa     Class *c = (Class *)newObject; c[0] = [TestObject class]; //  __bridge_transfer-      ARC -   obj = (__bridge_transfer TestObject *)newObject; //  init -  ! obj = [obj init];</span></span></code> </pre><br><br>  <b>Recommendations for use:</b> it is recommended with extreme caution.  One use is to allocate memory at once for a large array of objects (as <a href="https://habrahabr.ru/users/alexchernyy/" class="user_link">AlexChernyy</a> once <a href="https://habrahabr.ru/users/alexchernyy/" class="user_link">told</a> on <a href="http://www.cocoaheads.ru/public/files/alexander-chernyy-quick-allocation.pdf">CocoaHeads</a> ). <br><br>  <b>UPD:</b> Thanks to the <a href="https://habrahabr.ru/users/trahman/" class="user_link">Trahman</a> user, <a href="https://habrahabr.ru/users/trahman/" class="user_link">it</a> was <a href="http://habrahabr.ru/company/mailru/blog/210672/">found</a> that this approach does not work on iOS x64.  With his help, a portable solution was found: <br><br><pre> <code class="objectivec hljs">object_setClass((__bridge <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)newObject, [TestObject <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>]);</code> </pre><br><br><h2>  5. Print the current author pool </h2><br>  ObjC has ‚Äúhidden‚Äù functions that can be accessed using <code>extern</code> : <br><br><pre> <code class="objectivec hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> _objc_autoreleasePoolPrint(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>);</code> </pre><br><br>  After calling this function, the contents of the current authorization pool will be displayed in the console, approximately like this: <br><br><pre> <code class="bash hljs">objc[26573]: <span class="hljs-comment"><span class="hljs-comment">############## objc[26573]: AUTORELEASE POOLS for thread 0x7fff72fb0310 objc[26573]: 9 releases pending. objc[26573]: [0x100804000] ................ PAGE (hot) (cold) objc[26573]: [0x100804038] ################ POOL 0x100804038 objc[26573]: [0x100804040] 0x100204500 TestObject objc[26573]: [0x100804048] 0x100102fc0 __NSDictionaryM objc[26573]: [0x100804050] 0x1007000b0 __NSArrayI objc[26573]: [0x100804058] 0x1006000a0 __NSCFString objc[26573]: [0x100804060] 0x100600250 NSMethodSignature objc[26573]: [0x100804068] 0x100600290 NSInvocation objc[26573]: [0x100804070] 0x100600530 __NSCFString objc[26573]: [0x100804078] 0x100600650 __NSArrayI objc[26573]: ##############</span></span></code> </pre><br><br>  This is very useful for debugging.  You can search for other useful things here: <a href="http://www.opensource.apple.com/source/objc4/objc4-551.1/">www.opensource.apple.com/source/objc4/objc4-551.1</a> <br><br>  <b>Recommendations for use:</b> in debug - please. <br><br><h2>  6. Direct access to the synthesized <code>@property</code> values </h2><br>  As mentioned above, <code>@property</code> only generates getter and mutator signatures.  But if the property is synthesized (via <code>@synthesize</code> or by default), then ivar is also generated: <br><br><pre> <code class="objectivec hljs"><span class="hljs-keyword"><span class="hljs-keyword">@property</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> *dict; - (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)resetDict { _dict = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>; }</code> </pre><br><br>  <b>Recommendations for use:</b> access to the synthesized ivar directly can sometimes be justified, but it does not cause the getter and the mutator, which can lead to undesirable effects. <br><br><h2>  7. Access to public Ivars as in structures </h2><br>  Despite the obviousness of this feature, many developers for some reason do not know about it.  Knowledge of this may be useful for resolving name conflicts. <br><br><pre> <code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestObject</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSObject</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">@public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> field; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@implementation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestObject</span></span></span><span class="hljs-class"> - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">updateWithField</span></span></span><span class="hljs-class">:(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">field</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>-&gt;field = field; } <span class="hljs-keyword"><span class="hljs-keyword">@end</span></span> <span class="hljs-comment"><span class="hljs-comment">// ... TestObject *obj = [TestObject new]; obj-&gt;field = 200;</span></span></code> </pre><br><br>  <b>Recommendations for use:</b> in ObjC it is better to use @property for such purposes. <br><br><h2>  8. <code>instancetype</code> </h2><br>  ObjC has a great <code>id</code> type, which is essentially <code>NSObject *</code> , that is, the most basic type for objects that any other object can lead to.  Convenient, but in some cases problems may arise.  For example: <br><br><pre> <code class="objectivec hljs">[[MyClass sharedInstance] count];</code> </pre><br><br>  If <code>sharedInstance</code> returns an <code>id</code> , the code will be collected without warning even if there is no <code>count</code> method in <code>MyClass</code> .  If <code>sharedInstance</code> returns an <code>instancetype</code> , then the Vorning will still appear, because the compiler clearly understands that an object is returned from the class of which <code>sharedInstance</code> is called. <br><br>  <b>Recommendations for use:</b> relevant in methods of type <code>init/new/copy</code> , etc. <br><br><h2>  9. Proxying: <code>forwardingTargetForSelector:</code> and <code>forwardInvocation:</code> </h2><br>  OOP is peculiar to the introduction of additional levels of abstraction for some problems.  For example, sometimes you need to make a proxy for another object from an object.  The following methods will always help us in this. <br><br>  If in our object implementation for some selector is not found, the following message will be sent to it: <br><br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)forwardingTargetForSelector:(SEL)aSelector { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([_dict respondsToSelector:aSelector]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _dict; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">super</span></span> forwardingTargetForSelector:aSelector]; }</code> </pre><br><br>  If the object we are proxying responds to the selector, then let it react to it.  Otherwise, all the same will have to throw Exception. <br><br>  If we want not only to transfer the selector to another object, but also to change the selector itself, we can use the following pair of functions. <br><br>  First, we must return the signature of the existing method of the proxied object on the request for the signature of an unknown method: <br><br><pre> <code class="objectivec hljs">- (<span class="hljs-built_in"><span class="hljs-built_in">NSMethodSignature</span></span> *)methodSignatureForSelector:(SEL)aSelector { <span class="hljs-built_in"><span class="hljs-built_in">NSMethodSignature</span></span> *sig = [<span class="hljs-keyword"><span class="hljs-keyword">super</span></span> methodSignatureForSelector:aSelector]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([<span class="hljs-built_in"><span class="hljs-built_in">NSStringFromSelector</span></span>(aSelector) isEqualToString:<span class="hljs-string"><span class="hljs-string">@"allDamnKeys"</span></span>]) { sig = [_dict methodSignatureForSelector:<span class="hljs-keyword"><span class="hljs-keyword">@selector</span></span>(allKeys)]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sig; }</code> </pre><br><br>  Then we redirect the call and change the name of the selector: <br><br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)forwardInvocation:(<span class="hljs-built_in"><span class="hljs-built_in">NSInvocation</span></span> *)anInvocation { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([<span class="hljs-built_in"><span class="hljs-built_in">NSStringFromSelector</span></span>(anInvocation.selector) isEqualToString:<span class="hljs-string"><span class="hljs-string">@"allDamnKeys"</span></span>]) { anInvocation.selector = <span class="hljs-keyword"><span class="hljs-keyword">@selector</span></span>(allKeys); [anInvocation invokeWithTarget:_dict]; } }</code> </pre><br><br>  <b>Recommendations for use: a</b> very convenient mechanism for implementing proxy objects.  Perhaps someone will find other uses.  The main thing is not to overdo it: the code should be readable and easy to understand. <br><br><h2>  10. <code>NSFastEnumeration</code> </h2><br>  Well, in conclusion, another interesting feature of ObjC: <code>for..in</code> cycles.  They are supported by all default collections, but we can support as well.  To do this, you need to support the <code>NSFastEnumeration</code> protocol, or rather, define the <code>countByEnumeratingWithState:objects:count:</code> method <code>countByEnumeratingWithState:objects:count:</code> but not everything is so simple!  Here is the signature of this method: <br><br><pre> <code class="objectivec hljs">- (<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)countByEnumeratingWithState:(<span class="hljs-built_in"><span class="hljs-built_in">NSFastEnumerationState</span></span> *)state objects:(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span> __<span class="hljs-keyword"><span class="hljs-keyword">unsafe_unretained</span></span> [])buffer count:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)len</code> </pre><br><br>  This method will be called every time when runtime wants to receive from us a new portion of objects.  We have to write them either into the provided buffer (its <code>len</code> size) or select our own.  A pointer to this buffer should be placed in the <code>state-&gt;itemsPtr</code> , and the number of objects in it should be returned from the function.  Just do not forget that (in the documentation there is no) the field <code>state-&gt;mutationsPtr</code> should not be empty.  If this is not done, then we get an unexpected <code>SEGFAULT</code> .  But in the <code>state-&gt;state</code> field, you can write anything, but the best thing is to record the number of elements already sent.  If there is nothing to give, you need to return zero. <br><br>  Here is my example of implementing this function: <br><br><pre> <code class="objectivec hljs">- (<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)countByEnumeratingWithState:(<span class="hljs-built_in"><span class="hljs-built_in">NSFastEnumerationState</span></span> *)state objects:(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span> __<span class="hljs-keyword"><span class="hljs-keyword">unsafe_unretained</span></span> [])buffer count:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)len { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state-&gt;state &gt;= _value) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span> itemsToGive = MIN(len, _value - state-&gt;state); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; itemsToGive; ++i) { buffer[i] = @(_values[i + state-&gt;state]); } state-&gt;itemsPtr = buffer; state-&gt;mutationsPtr = &amp;state-&gt;extra[<span class="hljs-number"><span class="hljs-number">0</span></span>]; state-&gt;state += itemsToGive; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> itemsToGive; }</code> </pre><br><br>  Now you can use: <br><br><pre> <code class="objectivec hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">NSNumber</span></span> *n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> obj) { <span class="hljs-built_in"><span class="hljs-built_in">NSLog</span></span>(<span class="hljs-string"><span class="hljs-string">@"n = %@"</span></span>, n); }</code> </pre><br><br>  <b>Recommendations for use: it</b> can be useful to simplify working with custom data structures, for example, with trees and related lists. <br><br><h2>  Conclusion </h2><br>  The complete project source code is available on <a href="https://github.com/silvansky/ObjCTips">github</a> .  If you, dear reader, have something to add - do not hesitate and write in the comments. <br><br>  Good luck to everyone in the development and may the Clang Analyzer be with you! </div><p>Source: <a href="https://habr.com/ru/post/210672/">https://habr.com/ru/post/210672/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210656/index.html">Horizontal scaling PHP applications. Part 1</a></li>
<li><a href="../210660/index.html">What to do if the client is a friend / good friend?</a></li>
<li><a href="../210664/index.html">My comfortable home</a></li>
<li><a href="../210666/index.html">Access to the file system from the Portable Class Library (PCL)</a></li>
<li><a href="../210668/index.html">Two or more jobs on the same computer - free solution</a></li>
<li><a href="../210676/index.html">Smartphone / clock video review iconBIT Callisto 100</a></li>
<li><a href="../210680/index.html">Do you use web components?</a></li>
<li><a href="../210682/index.html">Escene ES620 IP Phone Review with Escene ESM 32 Expansion Module</a></li>
<li><a href="../210684/index.html">Cryptanalysis hash functions GOST R 34.11-2012</a></li>
<li><a href="../210690/index.html">The biggest battle in the history of EVE Online: destroyed ships at $ 200,000</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>