<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Stop writing classes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A sign that an object should not be a class - if it has only 2 methods, and one of them is initialization, __init__. Every time you see this, think: "...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Stop writing classes</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/85f/4dc/9bf/85f4dc9bfee58619fa74e65b3b42723f.jpg" alt="Photo of Jack Didriha from G + profile" align="right">  A sign that an object should not be a class - if it has only 2 methods, and one of them is initialization, __init__.  Every time you see this, think: "I guess I just need one function." <br><br>  Every time when you create only one copy from a written class, use it only once and then throw it away, you should think: ‚Äúoh, we should refactor it!  You can make it easier, much easier! ‚Äù <br><br>  <i>Translation of the report of <a href="https://plus.google.com/112735175063326258809">Jack Didriha</a> , one of the key developers of the Python language.</i>  <i><a href="http://pyvideo.org/video/880/stop-writing-classes">The report was</a> made on March 9, 2012 at the PyCon US conference.</i> <br><a name="habracut"></a><br>  All of you have read the <a href="http://ru.wikipedia.org/wiki/Python">Zen Python</a> , probably many times.  Here are a few items from it: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Simple is better than difficult </li><li>  Flat is better than nested </li><li>  Readability is important </li><li>  If the program is difficult to explain, it is bad. </li><li>  If the program is easy to explain, it may be good. </li></ul><br><br>  Wrote this text by Tim Peters.  He is smarter than you and me.  How many people do you know after whom the sorting algorithm was named?  This is the man who wrote the Zen Python.  And all the points say: ‚ÄúDo not make it difficult.  Do it easy. ‚ÄùThat‚Äôs what the talk is about. <br><br>  So, first of all, do not make it difficult, where you can make it easier.  Classes are very complex or can be very complex.  But we still make it difficult, even trying to make it easier.  Therefore, in this report we will read a little code and find out how to notice that we are going the wrong way and how to get back. <br><br>  At my work, I tell colleagues: ‚ÄúI hate the code, and I want it to be as small as possible in our product.‚Äù We sell the functionality, not the code.  Customers are not because of the code, but because of the wide functionality.  Every time the code is removed, this is good.  There are four of us, and in the last year we stopped counting the number of lines in the product, but we continue to introduce new functionality. <br><br><h4>  Classes </h4><br><br>  From this report you first need to remember this code.  This is the largest class abuse in nature. <br><br><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Greeting</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, word=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'Hello'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.word = word <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">greet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'%s, %s!'</span></span> % (self.word, name) &gt;&gt;&gt; greeting = Greeting(<span class="hljs-string"><span class="hljs-string">'Hola'</span></span>) &gt;&gt;&gt; greeting.greet(<span class="hljs-string"><span class="hljs-string">'Jorge'</span></span>) Hola, Jorge!</code> </pre> <br><br>  This is not a class, although it looks like a class.  Name - noun, "greeting."  It takes arguments and saves them to __init__.  Yes, it looks like a class.  It has a method that reads the state of an object and does something else, like in classes.  Below it is written how this class is used: create a copy of the Greetings and then use this Greeting to do something else. <br><br>  But this is not a class, or it should not be a class.  A sign of this - there are only 2 methods in it, and one of them is initialization, __init__.  Every time you see this, think: "I guess I just need one function." <br><br>  Every time when you create only one copy from a written class, use it only once and then throw it away, you should think: ‚Äúoh, we should refactor it!  You can make it easier, much easier! ‚Äù <br><br><pre> <code class="hljs python"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">greet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name)</span></span></span><span class="hljs-function">:</span></span> ob = Greeting(<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> ob.greet(name) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span></code> </pre> <br><br>  This function consists of 4 lines of code.  But how can you do the same thing in just 2 lines: <br><br><pre> <code class="hljs python"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">greet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(greeting, name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'%s, %s!'</span></span> % (greeting, name) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> functools greet = functools.partial(greet, <span class="hljs-string"><span class="hljs-string">''</span></span>) greet(<span class="hljs-string"><span class="hljs-string">''</span></span>)</code> </pre> <br><br>  If you always call a function with the same first argument, the standard library has a tool!  functools.partial.  Look at the code above: add an argument, and the result can be called multiple times. <br><br>  I do not know how many of you have a diploma in IT, I have it.  I taught concepts like <br><br>  - separation of powers <br>  - reduction of code connectivity <br>  - encapsulation <br>  - implementation isolation <br><br>  Since I graduated from high school, I have not used these terms for 15 years.  Hearing these words, you know, they fool you.  These terms are not required by themselves.  If they are used, people mean completely different things that only interfere with the conversation. <br><br><h4>  Example: pants turn into ... </h4><br><br>  Many of you use third-party libraries in your daily work.  Every time you need to use someone else's code, the first thing to do is read it.  It is not known what is there, what quality, whether they have tests and so on.  You need to check the code before turning it on.  Sometimes it is hard to read the code. <br><br>  The third-party API library, let's call it ShaurMail, included 1 package, 22 modules, 20 classes and 660 lines of code.  I had to read all this before turning it into a product.  But it was their official API, so we used <i>it</i> .  Every time an API update came, I had to look at the diffs, because it was unknown what they changed.  Did you send patches - did they appear in the update? <br><br>  660 lines of code, 20 classes - it's a bit too much if the program only needs to give a list of email addresses, the text of the letter and find out which letters have not been delivered, and who have unsubscribed. <br><br>  What is class abuse?  Often people think that they will need something in the future. ... It will not be necessary.  Write everything when needed.  In the ShaurMail library there is a ShaurHash module, in which there are 2 lines of code: <br><br><pre> <code class="hljs python"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ShaurHash</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(dict)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre> <br><br>  Someone decided that later a dictionary add-on would be needed.  It was not needed, but everywhere in the code there are lines like the first: <br><br><pre> <code class="hljs cs">my_hash = ShaurMail.ShaurHash.ShaurHash(id=<span class="hljs-string"><span class="hljs-string">'cat'</span></span>) d = dict(id=<span class="hljs-string"><span class="hljs-string">'cat'</span></span>) d = {<span class="hljs-string"><span class="hljs-string">'id'</span></span>: <span class="hljs-string"><span class="hljs-string">'cat'</span></span>}</code> </pre> <br><br>  The second and third lines of code - no one needs to explain them.  But this mantra ‚ÄúShaurMail-ShaurHash-ShaurHash‚Äù was repeated everywhere.  The threefold repetition of the word "Shawr" is another sign of excess.  From repetitions to all only harm.  You annoy the user, forcing him to write "Shawr" three times.  (This is not a real company name, but a fictional one.) <br><br>  Then they fired this guy and hired someone who knew what he was doing.  Here is the second version of the API: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> API: def __init__(self, key): self.<span class="hljs-keyword"><span class="hljs-keyword">header</span></span> = dict(apikey=key) def <span class="hljs-keyword"><span class="hljs-keyword">call</span></span>(self, <span class="hljs-keyword"><span class="hljs-keyword">method</span></span>, params): request = urllib2.Request( self.url + <span class="hljs-keyword"><span class="hljs-keyword">method</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-string"><span class="hljs-string">'/'</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">method</span></span>[<span class="hljs-number"><span class="hljs-number">1</span></span>], urllib.urlencode(params), self.<span class="hljs-keyword"><span class="hljs-keyword">header</span></span> ) try: response = <span class="hljs-type"><span class="hljs-type">json</span></span>.loads(urllib2.urlopen(request).<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> urllib2.HTTPError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> error: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dict(Error=str(error))</code> </pre> <br><br>  In that there were 660 lines, in this one - 15. Everything that this code does - uses the methods of the standard library.  It is read entirely, easily, in seconds, and you can immediately understand what it does.  By the way, there was also a test suite of 20 lines.  Here's how to write.  When they updated the API, I could read the changes in just a couple of seconds. <br><br>  But here you can notice the problem.  There are two methods in the class, and one of them is __init__.  The authors did not hide this.  The second method is call, call.  Here's how to use this API: <br><br><pre> <code class="hljs pgsql">ShaurMail.API(key=<span class="hljs-string"><span class="hljs-string">' '</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">call</span></span>((<span class="hljs-string"><span class="hljs-string">'mailing'</span></span>, <span class="hljs-string"><span class="hljs-string">'statistics'</span></span>), {<span class="hljs-string"><span class="hljs-string">'id'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>})</code> </pre> <br><br>  The string is long, so we do an alias and call it multiple times: <br><br><pre> <code class="hljs pgsql">ShaurMail.request = ShaurMail.API(key=<span class="hljs-string"><span class="hljs-string">' '</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ShaurMail.request((<span class="hljs-string"><span class="hljs-string">'mailing'</span></span>, <span class="hljs-string"><span class="hljs-string">'statistics'</span></span>), {<span class="hljs-string"><span class="hljs-string">'id'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>})</code> </pre> <br><br>  Notice, we use this class as a function.  She he should be.  If you see something like that, you know, the class is not needed here.  Therefore, I sent them the third version of the API: <br><br><pre> <code class="hljs cs">ShaurMail_API = url = <span class="hljs-string"><span class="hljs-string">'https://api.shaurmail.com/%s/%s'</span></span> ShaurMail_API_KEY = <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-function"><span class="hljs-function">def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">request</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">noun, verb, **</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span></span><span class="hljs-function">): headers</span></span> = {<span class="hljs-string"><span class="hljs-string">'apikey'</span></span>: ShaurMail_API_KEY} request = urllib2.Request(ShaurMail_API % (noun, verb), urllib.urlencode(<span class="hljs-keyword"><span class="hljs-keyword">params</span></span>), headers) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.loads(urllib2.urlopen(request).read())</code> </pre> <br><br>  It does not create files in our project at all, because I inserted it into the module where it is used.  It does everything that the 15-string API did, and everything that the 660-string API did. <br><br>  This is where we started and what we came up with: <br><br><ul><li>  1 package + 20 modules =&gt; 1 module </li><li>  20 classes =&gt; 1 class =&gt; 0 classes </li><li>  130 methods =&gt; 2 methods =&gt; 1 function </li><li>  660 lines of code =&gt; 15 lines =&gt; 5 lines </li></ul><br><br>  It is easier to use, easier to write, no one needs to figure out what is happening. <br><br><h4>  Standard library </h4><br><br>  Who came from the Java language, perhaps, believes that namespaces are needed for taxonomy.  This is not true.  They are needed to prevent name matches.  If you have deep hierarchies of spaces, it doesn‚Äôt give anyone anything.  ShaurMail.ShaurHash.ShaurHash - just extra words that people need to remember and write. <br><br>  In the standard library of Python, the namespace is very shallow, because you either remember the name of the module, or you need to look in the documentation.  No good if you need to figure out the chain, in which package to search, in which package in it, in which package further, and what is the name of the module in it.  You just need to know the name of the module. <br><br>  To our shame, here is an example from our own code, and the same sins can be seen here: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">services</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.crawler</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.crawlerexceptions</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ArticleNotFoundException</span></span></code> </pre> <br><br>  A package in which a 2-line module, an exception class, and a ‚Äúpass‚Äù.  To use this exception, it is necessary to write twice ‚Äúcrawler‚Äù, twice the word ‚Äúexception‚Äù.  The name ArticleNotFoundException repeats itself.  This is not necessary.  If you call exceptions, let it be EmptyBeer, BeerError, BeerNotFound, but BeerNotFoundError is already a lot. <br><br>  You can simply use exceptions from the standard library.  They are understandable to all.  Unless you need to catch a specific state, a LookupError is fine.  If you received an e-mail in the mail, you still have to read it, so it does not matter what the exception is called. <br><br>  In addition, exceptions in the code usually go after raise and except, and everyone immediately understands that these are exceptions.  Therefore, do not add ‚ÄúException‚Äù to the title. <br><br>  There are rusty details in the standard Python library, but it is a very good example of code organization: <br><br><ul><li>  200,000 lines of code </li><li>  200 top level modules </li><li>  an average of 10 files per package </li><li>  165 exceptions </li></ul><br><br>  The 10 files in the package are many, but only because of some third-party projects added to the library, where there were packages from just 2 files.  If you want to create a new exception, think better, because the standard library cost 1 exception for 1200 lines of code. <br><br>  I am not against classes in principle.  Classes are needed - when a lot of changing data and related functions.  However, in everyday work this happens infrequently.  Regularly you have to work with the standard library, and there are already suitable classes there.  For you they have already written. <br><br>  The only exception to the Python library is the heapq module.  Heap queue, "heap queue" is an array that is always sorted.  There are a dozen methods in the heapq module, and they all work with the same heap.  The first argument always remains the same, which means the class really comes to mind here. <br><br><pre> <code class="hljs lisp">heapify(<span class="hljs-name"><span class="hljs-name">data</span></span>) pushleft(<span class="hljs-name"><span class="hljs-name">data</span></span>, item) popleft(<span class="hljs-name"><span class="hljs-name">data</span></span>) pushright(<span class="hljs-name"><span class="hljs-name">data</span></span>, item) popright(<span class="hljs-name"><span class="hljs-name">data</span></span>)</code> </pre> <br>  etc. <br><br>  Every time I need to use heapq, I take the implementation of this class from my toolkit. <br><br><pre> <code class="hljs python"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Heap</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, data=None, key=lambda x: None)</span></span></span><span class="hljs-function">:</span></span> self.heap = data <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> [] heapq.heapify(self.heap) self.key = key <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pushleft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, item)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.key: item = (self.key(item), item) heapq.pushleft(self.heap, item) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">popleft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> heapq.popleft(self.heap)[<span class="hljs-number"><span class="hljs-number">1</span></span>]</code> </pre> <br><br><h4>  Classes grow like weeds </h4><br><br>  The state of OAuth in Python is unimportant.  Again, there are third-party libraries, and before using them in your project, they need to be read. <br><br>  I tried to use the URL shortener from Google: I needed to take the URLs and just cut them.  Google has a project with 10,000 lines of code.  115 modules and 207 classes.  I wrote a <a href="https://plus.google.com/112735175063326258809/posts/iPiqWHjwcf3">rebuke about this in Google +</a> , but few saw it, and Guido commented: ‚ÄúI disclaim responsibility for the Google API code.‚Äù 10,000 lines of code - there will definitely be some Something like Shaur Meyl.  Here, for example, the class Flow ("flow"), from which others inherit. <br><br><pre> <code class="hljs python"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Flow</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Storage</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">put</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, data)</span></span></span><span class="hljs-function">:</span></span> _abstract() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> _abstract() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_abstract</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> NotImplementedError</code> </pre> <br><br>  He is empty.  But he has his own module, and each time reading the class that inherits it, you need to go, check that file and again make sure that that class is empty.  Someone was looking into the future and decided: ‚ÄúI‚Äôll write 3 lines of code now so that I don‚Äôt have to change these 3 lines in the future.‚Äù And he took the time from everyone who reads his library.  There is another class Storage, (Storage) which does almost nothing.  It correctly handles errors using standard exceptions, but it does aliases, and again you need to go read their code to find out how it works. <br><br>  I needed a week to implement OAuth2.  It took a couple of days to read ten thousand lines of code, after which I began to look for other libraries.  Found python-oauth2.  This is the second version of python-oauth, but it doesn‚Äôt really work with OAuth2, which was not immediately clear.  However, this library is slightly better than Google: only 540 lines and 15 classes. <br><br>  I rewrote it even easier and called <a href="https//github.com/jackdied/python-foauth2">python-foauth2</a> .  135 lines of code and 3 classes, and it‚Äôs still a lot, I haven‚Äôt sufficiently refactored it.  Here is one of these three classes: <br><br><pre> <code class="hljs python"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Error</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Exception)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre> <br><br>  Shameless! <br><br><h4>  A life </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3c6/f96/b44/3c6f96b44783847558012c0774baca1c.gif" alt="Gosper's Glider Gun" align="right">  Last example.  You all have seen the <a href="http://ru.wikipedia.org/wiki/%25D0%2596%25D0%25B8%25D0%25B7%25D0%25BD%25D1%258C_(%25D0%25B8%25D0%25B3%25D1%2580%25D0%25B0)">game ‚ÄúLife‚Äù of Conway</a> , even if you do not know her name.  There is a checkered field, each turn you consider adjacent for each cell, and depending on them, it will be either alive or dead.  And such beautiful stable patterns as a glider are obtained: the cells come to life in front, and die from behind, and the glider flies across the field. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cfb/af9/e56/cfbaf9e56754668c7b8de0d7b541f151.gif" alt="Pulsar" align="left">  The game "life" is very simple: a field and a couple of rules.  We set this task at the interview, because if you do not know how this - we have nothing to talk about.  Many immediately say ‚ÄúThe cell is a noun.  The class is necessary. ‚ÄùWhat are the properties in this class?  Place, live or not, the state in the next turn, everything?  There are still neighbors.  Then they begin to describe the field.  A field is a multitude of cells, therefore, it is a grid, it has a ‚Äúcalculate‚Äù method that counts the cells inside. <br><br><pre> <code class="hljs python"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cell</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, alive=True)</span></span></span><span class="hljs-function">:</span></span> self.x = x self.y = y self.alive = alive self.next = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">neigbors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> itertools.product(range(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), repeat=<span class="hljs-number"><span class="hljs-number">2</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i, j) != (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> (self.x + i, self.y + j) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Board</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.cells = {} <span class="hljs-comment"><span class="hljs-comment"># { (x, y): Cell() } def advance(self): for (x, y), cell in self.cells.items(): alive_neighbors = len(cell.neighbors) cell.next = (alive_neighbors == 3 or (alive_neighbors == 2 and cell.alive))</span></span></code> </pre> <br><br>  At this point, I must say "stop": we have a class Field, in which there are 2 methods: __init__ and "make a move."  There is one property in it - a dictionary, which means with a dictionary and it is necessary to work.  Note that it is not necessary to store the neighbors of the point, they are already in the dictionary.  A live point or not is just a boolean value, so we will only store the coordinates of live cells.  And since only True is stored in the dictionary, it is not a dictionary that is needed, but simply a set of coordinates.  Finally, a new state is not needed, you can simply re-create a list of living cells. <br><br><pre> <code class="hljs pgsql">def neigbors(<span class="hljs-type"><span class="hljs-type">point</span></span>): x, y = <span class="hljs-type"><span class="hljs-type">point</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> itertools.product(range(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), repeat=<span class="hljs-number"><span class="hljs-number">2</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>((i, j)): yield (x + i, y + j) def advance(board): newstate = <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>() recalc = board | <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(itertools.chain(*map(neighbors, board))) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">point</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> recalc: count = sum((neigh <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> board) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> neigh <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> neighbors(<span class="hljs-type"><span class="hljs-type">point</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> count == <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> (count == <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-type"><span class="hljs-type">point</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> board): newstate.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(<span class="hljs-type"><span class="hljs-type">point</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> newstate glider = <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>([(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1000</span></span>): glider = advance(glider) print glider</code> </pre> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca3/b0e/b0b/ca3b0eb0b83bb2776b305839958cee1d.gif" alt="Glider moves" align="right">  It turns out very simple, concise implementation of the game.  Two classes are not necessary here.  Below - the coordinates of the airframe, they are inserted into the field, and the glider flies.  Everything.  This is the <i>full</i> realization of the game "life." <br><br><h4>  Summary </h4><br><br>  1. If you see a class with two methods, including __init__, this is not a class. <br>  2. Do not create new exceptions if they are not needed (and they are not needed). <br>  3. Simplify harder. <br><br>  <i>From the translator: in the comments I see that many perceived the report as a complete denial of the PLO.</i>  <i>This is mistake.</i>  <i>Point 1 of the results clearly says that such is not a class.</i>  <i>Classes are needed, but the essence of the report is that it is not necessary to abuse them.</i> </div><p>Source: <a href="https://habr.com/ru/post/140581/">https://habr.com/ru/post/140581/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140575/index.html">Report from InterSystems Global Summit 2012</a></li>
<li><a href="../140576/index.html">See the hidden or how good to do even better</a></li>
<li><a href="../140578/index.html">Do you understand move semantics?</a></li>
<li><a href="../140579/index.html">Canobuvosti, 136th edition</a></li>
<li><a href="../140580/index.html">GlobalsDB Challenge. 4th run</a></li>
<li><a href="../140582/index.html">IPad 3 disassembly</a></li>
<li><a href="../140583/index.html">New version of GlobalsDB 2012</a></li>
<li><a href="../140585/index.html">.Net, UTF-16 and regular expressions</a></li>
<li><a href="../140586/index.html">Mini-desktop review: Dell Alienware X51</a></li>
<li><a href="../140587/index.html">PTR record vs. Mail.ru</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>