<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LINQ for PHP. Part 2. If the mountain does not go to Mohammed, Mohammed goes to the mountain</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you can see from my previous article comparing LINQ libraries for PHP , there are many libraries and few qualities: lazy calculations are not imple...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LINQ for PHP. Part 2. If the mountain does not go to Mohammed, Mohammed goes to the mountain</h1><div class="post__text post__text-html js-mediator-article">  As you can see from my previous article <a href="http://habrahabr.ru/post/147612/">comparing LINQ libraries for PHP</a> , there are many libraries and few qualities: lazy calculations are not implemented in any library, tests are in half the cases, callback types are limited, and sometimes it is not known what stands out for LINQ .  So I wrote my library.  Meet: <br><br><h1>  <font color="blue">YaLinqo - Yet Another LINQ to Objects for PHP</font> </h1>  Opportunities: <br><br><ul><li>  The most complete .NET LINQ port in PHP, with many additional methods.  Some methods are missing, but work is underway.  In total, more than 70 methods have been implemented. </li><li>  Lazy calculations, text exceptions and more, as in the original LINQ. </li><li>  Detailed PHPDoc documentation for each method.  The text of articles is adapted from MSDN. </li><li>  100% coverage with unit tests. </li><li>  Callbacks can be specified by closures, ‚Äúfunction pointers‚Äù in the form of strings and arrays, and string ‚Äúlambdas‚Äù with support for multiple syntaxes. </li><li>  Keys are given as much attention as they are to values: transformations can be applied to both;  most callbacks accept both as input;  keys, if possible, are not lost during conversions. </li><li>  Minimal invention of bicycles: Iterator, IteratorAggregate, etc. are used for iteration (and they can be used along with Enumerable);  exceptions are used whenever possible by native pokapeshnye, etc. </li></ul><br>  Code example: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//     ,    , //   .      ,   . from($categories) -&gt;orderBy('$v["name"]') -&gt;groupJoin( from($products) -&gt;where('$v["quantity"] &gt; 0') -&gt;orderByDescending('$v["quantity"]') -&gt;thenBy('$v["name"]'), '$v["id"]', '$v["catId"]', 'array("name" =&gt; $v["name"], "products" =&gt; $e)' );</span></span></code> </pre> <br><a name="habracut"></a><h1>  <font color="green">Implemented methods</font> </h1><ul><li>  Generation: cycle, emptyEnum (empty), from, generate, toInfinity, toNegativeInfinity, matches, returnEnum (return), range, rangeDown, rangeTo, repeat, split; </li><li>  Projection, filtering: ofType, select, selectMany, where; </li><li>  Grouping, connection: groupJoin, join, groupBy; </li><li>  Aggregation: aggregate, aggregateOrDefault, average, count, max, maxBy, min, minBy, sum; </li><li>  Sets: all, any, contains; </li><li>  Pajination: elementAt, elementAtOrDefault, first, firstOrDefault, firstOrFallback, last, lastOrDefault, lastOrFallback, single, singleOrDefault, singleOrFallback, indexOf, lastIndexOf, findIndex, findLastIndex, skip, skiphour, yourIndexOf, findIndex, findLastIndex, skip, skip, welcome, skiphour, yourIndexOf, findIndex </li><li>  Convert: toArray, toArrayDeep, toList, toListDeep, toDictionary, toJSON, toLookup, toKeys, toValues, toObject, toString; </li><li>  Actions: call (do), each (forEach), write, writeLine. </li></ul><br><h1>  <font color="green">Example</font> </h1>  Now consider the above example in more detail.  In fact, there are several options for recording this query: using closures and using string lambda.  Lambda also has two syntaxes: you can use the default variable names (v and k for the value and the key, respectively), you can set meaningful ones. <br><br>  Initial data (either from the database, or from some JSON service, or ‚Äúiron‚Äù constants, or some other source): <br><br><pre> <code class="php hljs">$products = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Keyboard'</span></span>, <span class="hljs-string"><span class="hljs-string">'catId'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'hw'</span></span>, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Mouse'</span></span>, <span class="hljs-string"><span class="hljs-string">'catId'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'hw'</span></span>, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Monitor'</span></span>, <span class="hljs-string"><span class="hljs-string">'catId'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'hw'</span></span>, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Joystick'</span></span>, <span class="hljs-string"><span class="hljs-string">'catId'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'hw'</span></span>, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'CPU'</span></span>, <span class="hljs-string"><span class="hljs-string">'catId'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'hw'</span></span>, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Motherboard'</span></span>, <span class="hljs-string"><span class="hljs-string">'catId'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'hw'</span></span>, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Windows'</span></span>, <span class="hljs-string"><span class="hljs-string">'catId'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'os'</span></span>, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">666</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">7</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Linux'</span></span>, <span class="hljs-string"><span class="hljs-string">'catId'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'os'</span></span>, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">666</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Mac'</span></span>, <span class="hljs-string"><span class="hljs-string">'catId'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'os'</span></span>, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">666</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>), ); $categories = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Hardware'</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'hw'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Operating systems'</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'os'</span></span>), );</code> </pre><br>  Actually, the task: to filter products with a non-zero amount, put in the appropriate categories.  Sort products first by decrease in quantity, then by name.  Categories sort by name.  You should get the following (reformatted for short): <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [hw] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; Hardware [products] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [<span class="hljs-number"><span class="hljs-number">0</span></span>] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; Mouse [catId] =&gt; hw [quantity] =&gt; <span class="hljs-number"><span class="hljs-number">20</span></span> [id] =&gt; <span class="hljs-number"><span class="hljs-number">2</span></span> ) [<span class="hljs-number"><span class="hljs-number">1</span></span>] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; CPU [catId] =&gt; hw [quantity] =&gt; <span class="hljs-number"><span class="hljs-number">15</span></span> [id] =&gt; <span class="hljs-number"><span class="hljs-number">5</span></span> ) [<span class="hljs-number"><span class="hljs-number">2</span></span>] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; Joystick [catId] =&gt; hw [quantity] =&gt; <span class="hljs-number"><span class="hljs-number">15</span></span> [id] =&gt; <span class="hljs-number"><span class="hljs-number">4</span></span> ) [<span class="hljs-number"><span class="hljs-number">3</span></span>] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; Motherboard [catId] =&gt; hw [quantity] =&gt; <span class="hljs-number"><span class="hljs-number">11</span></span> [id] =&gt; <span class="hljs-number"><span class="hljs-number">6</span></span> ) [<span class="hljs-number"><span class="hljs-number">4</span></span>] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; Keyboard [catId] =&gt; hw [quantity] =&gt; <span class="hljs-number"><span class="hljs-number">10</span></span> [id] =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span> ) ) ) [os] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; Operating systems [products] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [<span class="hljs-number"><span class="hljs-number">0</span></span>] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; Linux [catId] =&gt; os [quantity] =&gt; <span class="hljs-number"><span class="hljs-number">666</span></span> [id] =&gt; <span class="hljs-number"><span class="hljs-number">8</span></span> ) [<span class="hljs-number"><span class="hljs-number">1</span></span>] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; Mac [catId] =&gt; os [quantity] =&gt; <span class="hljs-number"><span class="hljs-number">666</span></span> [id] =&gt; <span class="hljs-number"><span class="hljs-number">9</span></span> ) [<span class="hljs-number"><span class="hljs-number">2</span></span>] =&gt; <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [name] =&gt; Windows [catId] =&gt; os [quantity] =&gt; <span class="hljs-number"><span class="hljs-number">666</span></span> [id] =&gt; <span class="hljs-number"><span class="hljs-number">7</span></span> ) ) ) )</code> </pre><br>  Below is an example using closures from PHP 5.3.  The longest entry, but the best support in a variety of IDEs. <br><br><pre> <code class="php hljs">from($categories) -&gt;orderBy(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($cat)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $cat[<span class="hljs-string"><span class="hljs-string">'name'</span></span>]; }) -&gt;groupJoin( from($products) -&gt;where(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($prod)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $prod[<span class="hljs-string"><span class="hljs-string">"quantity"</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; }) -&gt;orderByDescending(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($prod)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $prod[<span class="hljs-string"><span class="hljs-string">"quantity"</span></span>]; }) -&gt;thenBy(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($prod)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $prod[<span class="hljs-string"><span class="hljs-string">"name"</span></span>]; }), <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($cat)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $cat[<span class="hljs-string"><span class="hljs-string">"id"</span></span>]; }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($prod)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $prod[<span class="hljs-string"><span class="hljs-string">"catId"</span></span>]; }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($cat, $prods)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"name"</span></span> =&gt; $cat[<span class="hljs-string"><span class="hljs-string">"name"</span></span>], <span class="hljs-string"><span class="hljs-string">"products"</span></span> =&gt; $prods); } );</code> </pre><br>  Record using string lambda.  To the left of the operator "==&gt;" the names of the arguments, to the right - the return value. <br><br><pre> <code class="php hljs">from($categories) -&gt;orderBy(<span class="hljs-string"><span class="hljs-string">'$cat ==&gt; $cat["name"]'</span></span>) -&gt;groupJoin( from($products) -&gt;where(<span class="hljs-string"><span class="hljs-string">'$prod ==&gt; $prod["quantity"] &gt; 0'</span></span>) -&gt;orderByDescending(<span class="hljs-string"><span class="hljs-string">'$prod ==&gt; $prod["quantity"]'</span></span>) -&gt;thenBy(<span class="hljs-string"><span class="hljs-string">'$prod ==&gt; $prod["name"]'</span></span>), <span class="hljs-string"><span class="hljs-string">'$cat ==&gt; $cat["id"]'</span></span>, <span class="hljs-string"><span class="hljs-string">'$prod ==&gt; $prod["catId"]'</span></span>, <span class="hljs-string"><span class="hljs-string">'($cat, $prods) ==&gt; array("name" =&gt; $cat["name"], "products" =&gt; $prods)'</span></span> );</code> </pre><br>  Finally, the briefest record.  If there is no operator "==&gt;", then the default variable names are used: v for value, k for key, a and b for compared values, etc. <br><br><pre> <code class="php hljs">from($categories) -&gt;orderBy(<span class="hljs-string"><span class="hljs-string">'$v["name"]'</span></span>) -&gt;groupJoin( from($products) -&gt;where(<span class="hljs-string"><span class="hljs-string">'$v["quantity"] &gt; 0'</span></span>) -&gt;orderByDescending(<span class="hljs-string"><span class="hljs-string">'$v["quantity"]'</span></span>) -&gt;thenBy(<span class="hljs-string"><span class="hljs-string">'$v["name"]'</span></span>), <span class="hljs-string"><span class="hljs-string">'$v["id"]'</span></span>, <span class="hljs-string"><span class="hljs-string">'$v["catId"]'</span></span>, <span class="hljs-string"><span class="hljs-string">'array("name" =&gt; $v["name"], "products" =&gt; $e)'</span></span> );</code> </pre><br><h1>  <font color="green">(Doubtful) architectural solutions</font> </h1>  Just because one-to-one original LINQ can not be copied: different languages, different features, different features.  Therefore, often had to make a choice.  How good or bad is to judge you.  Discussion is welcome. <br><br><h4>  <font color="green">Keys</font> </h4>  Let's start with the most dubious: the keys are declared an important part of the data.  The reason: they are clearly present in native pohapeshnyh iterators, they are important in arrays, they are important when converting to JSON.  In general, keys are commonly used in PHP, so I would not like to ignore them, as in some other libraries. <br><br>  However, in the original LINQ there are no keys for the sequences, so you have to increase the number of arguments both for callbacks (now they can all work with the key, if possible), and for the LINQ methods themselves: resultSelector turns into resultSelectorValue + resultSelectorKey.  However, in most cases, the developer does not need to think about it: callbacks can be passed with a smaller number of arguments, and all LINQ methods have default values ‚Äã‚Äãfor the arguments of type resultSelectorKey. <br><br>  Another problem with keys arises from the need to keep them everywhere.  This means that by default, the elements will retain the same keys when sorting.  PHP usually lists arrays in the order of adding elements, so conversion to an array should not be a problem, but it is not enough. <br><br>  If you do not need information about the keys, then there are two simple ways to get rid of them: <br><ul><li>  In the final operation, instead of toArray / toArrayDeep, call toList / toListDeep. </li><li>  Calling the toValues ‚Äã‚Äãmethod is equivalent to array_values, but is lazy, like select. </li></ul><br><h4>  <font color="green">Order of arguments</font> </h4>  The decision on the order of arguments in functions and callbacks is second in doubt.  They always go in order from (theoretically) most used to least used.  In callbacks, therefore, the first place is usually the value, and then the key, because value is almost always important, but the key is not.  However, the order of the arguments may now be harder to remember.  For example, in select, first there is a selection of a value, and in toDictionary, a selection of a key. <br><br>  However, we, pohapeshnikam, no stranger to this disgrace - the whole language is speckled with a completely random order of arguments (the same needle and haystack). <br><br><h4>  <font color="green">Item Indexes</font> </h4>  A non-obvious solution for those who used the original LINQ: methods such as indexOf, elementAt work with keys, rather than the numerical position of the element in the map.  If you need a position, first call toValues ‚Äã‚Äã- the keys will become consecutive: 0, 1, 2, 3, etc.  Also, there are no overloads for select type methods with callbacks that take the position of an element.  Similarly, use toValues. <br><br><h4>  <font color="green">Arguments lambda</font> </h4>  In the linq.js library, which I inspired when writing, all callback arguments are called $, $$, $$$, $$$$.  In PHP, this does not happen.  You can make a string conversion, but I would like to leave the code valid, even if it is inside a line.  There is no need to call the arguments empty $ a, $ b, $ c.  Therefore, it was decided to use names corresponding to the content: <br><br><ul><li>  Normally v for value, k for key </li><li>  If there are several values, then v1 and v2 </li><li>  If the value is a sequence, then e </li><li>  For battery during aggregation - a </li><li>  For comparison methods - a and b </li><li>  (Maybe something else forgot) </li></ul><br>  Disadvantage: you need to know the names.  However, with detailed documentation this should not be a problem. <br><br><h4>  <font color="green">‚ÄúQuestionable‚Äù collections</font> </h4>  There is no List class, the toList method returns the same as toArray, only with consecutive keys (0, 1, 2, etc.) <br><br>  Dictionary class is.  Originally conceived solely as a base for Lookup, but now it has become a separate full-fledged collection.  Unlike ordinary arrays, the keys can be objects (possibly in the original LINQ).  But in fact, in LINQ itself, key objects are far from being supported everywhere, because PHP does not allow using key objects in foreach.  You can rewrite all the cycles, but how much the game is worth the candle is a question. <br><br>  Class Lookup is.  Returns a list of values ‚Äã‚Äãby key (or an empty array if there is no key). <br><br>  Both collections support the toArray method, which returns an internal array. <br><br><h4>  <font color="green">MSDN Documentation</font> </h4>  All methods copied help from MSDN, then adapted to the realities of the port.  Somewhere descriptions are stolen from other projects.  Somewhere - written independently.  If you find errors - report. <br><br>  In general, the certificate turned out very solid.  Some methods are not sickly such articles. <br><br><h4>  <font color="green">Method Names</font> </h4>  Some words in PHP are brazenly swallowed by the language itself, and in all registers.  Even empty cannot be used as a method name.  Therefore, where there are conflicts, the methods are renamed (in the list of methods at the beginning of the article, the original method names are given in brackets).  In particular, run / forEach became call / each. <br><br><h4>  <font color="green">Exception Names</font> </h4>  PHP has no built-in exceptions that exist in .NET.  However, I tried to avoid creating unnecessary classes.  So, instead of InvalidOperationException, UnexpectedValueException is used.  In the end, the operation becomes invalid with unexpected values. <br><br><h4>  <font color="green">Stable sorting</font> </h4>  Sort unstable.  That is, when sorting the array <code>[[0,1], [1,0], [0,2]]</code> by the first element of the nested arrays, no one guarantees that <code>[0,1]</code> and <code>[0,2]</code> will follow each other in that order.  The result may be both <code>[[0,1], [0,2], [1,0]]</code> , and <code>[[0,2], [0,1], [1,0]]</code> . <br><br>  Why?  Because in PHP there are no functions for stable sorting, and usort is used inside the library.  Theoretically, the sorting can be made stable as in the original LINQ, but is it necessary?  For stability, everyone will have to pay runtime and consumable memory.  I decided that since we follow the ‚ÄúPHP paths‚Äù, then the instability should be the same as in PHP itself. <br><br><h1>  <font color="green">Other</font> </h1>  Coverage unit tests - almost 100%. <br><br>  License - BSD simplified (two-point). <br><br>  Requirements - PHP 5.3. <br><br>  Using: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span> <span class="hljs-keyword"><span class="hljs-keyword">__DIR__</span></span> . <span class="hljs-string"><span class="hljs-string">'/lib/Linq.php'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     use \YaLinqo\Enumerable; //     use \YaLinqo\Enumerable as E; //   //      from,     Enumerable ‚Äî   Enumerable::from(array(1, 2, 3)); from(array(1, 2, 3));</span></span></code> </pre><br><h1>  <font color="green">Comparison with other libraries</font> </h1>  For clarity, added to the table and more libraries for JavaScript.  Their comparison will be in a separate article. <br><br> <a href=""><img src="https://habrastorage.org/storage2/b3c/95c/3f4/b3c95c3f427b11617bfe086504bc893b.png"></a> <br><br>  Legend as in Wikipedia, but with an additional value: <br><br><ul><li>  red - in any gate </li><li>  yellow - the third grade is not a marriage </li><li>  green is the most </li><li>  blue - drop dead </li></ul><br>  I apologize for the English in the table.  In Russian, too long worked. <br><br><h1>  <font color="green">thanks to me</font> </h1>  He worked for free, no one will give money.  If you feel an attack of generosity, you can simply vote for these features in PHP and PHPStorm.  Perhaps they will notice and use the library will be more pleasant. <br><br><h4>  <font color="green">Php</font> </h4><ol><li>  Iterator :: key () is allowed to return only numbers and strings. <ol><li>  <a href="https://bugs.php.net/bug.php%3Fid%3D45684">45684</a> A request for key-type agnostic </li></ol></li><li>  There was a feature with shortening the syntax of closures, with patches attached, analysis, etc. - the developer who issued the feature tried its best.  But the feature was closed with the result "nafig necessary."  :-( </li></ol><br><h4>  <font color="green">PHPStorm IDE</font> </h4><ol><li>  PHP code inside lines <ul><li>  <a href="http://youtrack.jetbrains.com/issue/WI-3477">WI-3477</a> Inject PHP language inside assert ('literal'), eval and similar </li><li>  <a href="http://youtrack.jetbrains.com/issue/WI-2377">WI-2377</a> No autocompletion for php variables inside string with injected language </li></ul></li><li>  PHP code analysis <ul><li>  <a href="http://youtrack.jetbrains.com/issue/WI-11110">WI-11110</a> Undefined method: Undefined method wrongly reported when using closures </li></ul></li><li>  PHPDoc Comments <ul><li>  <a href="http://youtrack.jetbrains.com/issue/WI-8270">WI-8270</a> Error in PhpDoc quick documentation if used in a line </li></ul></li></ol><br><h1>  <font color="green">Link</font> </h1>  <a href="https://github.com/Athari/YaLinqo">Download Yet Another LINQ to Objects for PHP from GitHub</a> <br><br>  PS Tell me, please, where can I post a similar article in English. </div><p>Source: <a href="https://habr.com/ru/post/147848/">https://habr.com/ru/post/147848/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../147843/index.html">How to recognize krakozyabry?</a></li>
<li><a href="../147844/index.html">Simple task server with queue in MySQL (no problems with locks)</a></li>
<li><a href="../147845/index.html">It's not so bad with Digg.com</a></li>
<li><a href="../147846/index.html">Manned flights to Mars found it inappropriate</a></li>
<li><a href="../147847/index.html">Photojournalism as hard work</a></li>
<li><a href="../147851/index.html">Google added five US National Parks to Street View</a></li>
<li><a href="../147852/index.html">Maximum accurate code measurement</a></li>
<li><a href="../147853/index.html">Overview of Twitter clients for Windows Phone 7</a></li>
<li><a href="../147854/index.html">Delta 3D Printer</a></li>
<li><a href="../147855/index.html">Thermoelectric batteries for low-power gadgets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>