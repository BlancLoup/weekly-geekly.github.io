<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>This capricious eigrp on DMVPN tunnels</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I will share the problem and its sudden solution, which we faced last week, and which caused us a lot of trouble. 
 So, the situation is quite standar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>This capricious eigrp on DMVPN tunnels</h1><div class="post__text post__text-html js-mediator-article">  I will share the problem and its sudden solution, which we faced last week, and which caused us a lot of trouble. <br>  So, the situation is quite standard, the central office of the company is connected to communication channels with remote divisions.  Communication (Internet and VPN) is provided by two operators.  In order to minimize the downtime of remote subdivisions when a single channel falls on the office, 2 DMVPN tunnels are built for each subdivision.  Routing within the network is dynamic, eigrp.  Accordingly, in the central office 2 Cisco routers are used. <br>  The number of remote units - about 70, respectively, each router builds the same number of tunnels.  The average channel load is 40-60% of the bandwidth guaranteed by the operators. <br>  The DMVPN setting was fairly standard, described in the primer: <br><br><a name="habracut"></a><br><br>  hub: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      interface Tunnel201 <br>  description - = DMVPN_201 = - <br>  ip address 10.10.201.1 255.255.255.0 <br>  no ip redirects <br>  ip mtu 1416 <br>  ip hold-time eigrp 1 25 <br>  no ip next-hop-self eigrp 1 <br>  ip nhrp authentication 11111 <br>  ip nhrp map multicast dynamic <br>  ip nhrp network-id 201 <br>  no ip split-horizon eigrp 1 <br>  delay 1000 <br>  cdp enable <br>  tunnel source GigabitEthernet0 / 0.2 <br>  tunnel mode gre multipoint <br>  tunnel key 11111 <br>  ! <br>  end <br><br>  router eigrp 1 <br>  network 10.10.201.0 0.0.0.255 <br>  network 192.168.0.0 0.0.1.255 <br><br>  In general, a classic scheme that works perfectly for several months in a row. <br><br>  <a href="http://www.cisco.com/en/US/tech/tk583/tk372/technologies_configuration_example09186a008014bcd7.shtml">www.cisco.com/en/US/tech/tk583/tk372/technologies_configuration_example09186a008014bcd7.shtml</a> is a similar example from Cisco. <br><br>  Until one day we encountered the problem that all internal routes through eigrp did not start to fall off every 30-90 seconds.  At the same time, the tunnel stood perfectly and the tunnel interface perfectly responded.  In the logs there were errors like: <br><br>  * Apr 23 2013 15: 19: 47.759 GMT + 11:% DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 10.10.202.9 (Tunnel202) is down: holding time expired <br>  * Apr 23 2013 15: 19: 52.707 GMT + 11:% DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 10.10.202.9 (Tunnel202) is up: new adjacency <br>  * Apr 23 2013 15: 23: 56.298 GMT + 11:% DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 10.10.202.57 (Tunnel202) is up: new adjacency <br>  * Apr 23 2013 15: 24: 43.070 GMT + 11:% DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 10.10.202.9 (Tunnel202) is down: holding time expired <br><br>  And the problem arose suddenly and immediately on both routers.  Started dancing with a tambourine, smoking cisco.com, etc. <br>  Overloading each of the routers separately did not solve the problem. <br>  The overload of both routers, undertaken as an extreme measure, left the branches without communication for a rather large (up to 15-20 minutes) period, but it helped to cope with the problem.  It was possible to breathe out and quietly start looking for the cause, hoping that for a few more months everything would work fine, as it had worked before. <br>  However, we were delighted early, 3 days later the problem was repeated in exactly the same way.  All recommendations from cisco.com to change mtu on the tunnel and the physical interface, as well as other shaman kamlaniya results did not bring.  After a rather long period of time, in one of the very tiny forums we found a topic with a similar problem, and in the last message something like this was written: <br>  ‚ÄúThank you all, the problem is fixed.  I don‚Äôt know how or why, but the inclusion of ip bandwidth-percent eigrp helped. ‚Äù <br><br>  Since there was still nothing to do, without special faith in success, we prescribe the indicated command in the properties of the tunnel, specifying the number 100 as a parameter of using the channel (there is nothing to lose anyway), and - MIRACLE, everything worked like a clock. <br>  But, interrupting a bunch of forums, we repeatedly stumbled upon this problem that arose among other colleagues, and the solution was never described. <br>  Naturally, in the future we reduced the percentage figure. <br>  Maybe we invented another bike, but did not find this information anywhere else.  Maybe someone else will need it.  Please use. </div><p>Source: <a href="https://habr.com/ru/post/178301/">https://habr.com/ru/post/178301/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../178285/index.html">Search on Drupal 7 using Apache Solr Part 3 - learn to add your own fields and options to the index</a></li>
<li><a href="../178287/index.html">Google is preparing a netbook on Android for $ 200</a></li>
<li><a href="../178289/index.html">The results of an independent study of the market of information security systems</a></li>
<li><a href="../178297/index.html">The next winners of the Microsoft BizSpark startups story contest</a></li>
<li><a href="../178299/index.html">Customization of scrollbars in the browser: a compromise between html, css, js technologies and usability</a></li>
<li><a href="../178303/index.html">Context-sensitive form in yii</a></li>
<li><a href="../178305/index.html">JQuery Popup Fixed Navigation</a></li>
<li><a href="../178307/index.html">Options in css 3 and a little about the possibilities for rubber sites</a></li>
<li><a href="../178309/index.html">Population algorithm based on fish school behavior</a></li>
<li><a href="../178311/index.html">The implementation of the stack due to ... call stack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>