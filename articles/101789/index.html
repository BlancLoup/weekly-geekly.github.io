<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vehicle control via neural network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="annotation 
 Using a neural network, we want the vehicle to drive itself, avoiding obstacles. We achieve this by choosing the appropriate I / O and ca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vehicle control via neural network</h1><div class="post__text post__text-html js-mediator-article"><h3>  annotation </h3><br>  Using a neural network, we want the vehicle to drive itself, avoiding obstacles.  We achieve this by choosing the appropriate I / O and careful training of the neural network.  We feed the network distance to the nearest obstacles around the car, mimicking the vision of a human driver.  At the output we get the acceleration and turn of the steering wheel of the vehicle.  We also need to train the network on a variety of I / O strategies.  The result is impressive even with just a few neurons!  The car travels around obstacles, but it is possible to make some modifications so that this software can cope with more specific tasks. <br><br><h3>  Introduction </h3><br>  The idea is to have a vehicle that drives itself and avoids obstacles in the virtual world.  Every moment it decides for itself how to change its speed and direction depending on the environment.  In order to make it more real, the AI ‚Äã‚Äãshould only see what the person would see if he were driving, so the AI ‚Äã‚Äãwill only make decisions based on the obstacles that are in front of the vehicle.  With realistic input, the AI ‚Äã‚Äãcould be used in a real car and worked just as well. <br>  When I hear the phrase: "Driving a vehicle using AI", I immediately think about computer games.  Many of the racing games can use this technique to control vehicles, but there are a number of other applications that are looking for a means of managing vehicles in the virtual or real world. <br>  So how are we going to do this?  There are many ways to implement AI, but after all, if we need a ‚Äúbrain‚Äù to control a vehicle, then neural networks will fit perfectly.  Neural networks work the same way as our brains.  They will probably be the right choice.  We must determine what will be the input and what will be the output of our neural network. <br><a name="habracut"></a><br><br><h3>  Neural networks </h3><br>  Neural networks appeared when studying the structure of the brain.  Our brain consists of 10 <sup>11</sup> neuron cells that send electrical signals to each other.  Each neuron consists of one or two axons, which "produce a result", and a large number of dendrites, which receive input electrical signals.  A neuron needs a certain input signal strength, which is added from all dendrites in order to be activated.  After activation, the neuron sends an electrical signal down its axon to other neurons.  Connections (axons and dendrites) are strengthened if they are often used. <br>  This principle is applied in neural networks of smaller scales.  Modern computers do not have the computing power that creates twenty billion neurons, but even with several neurons, the neural network can give a reasonable answer. <br>  Neurons are organized into layers, as shown in <em>Figure 1</em> .  The input layer will have inputs, and depending on the strength of the connection with each neuron in the next layer, the input signal is fed to the next level.  The strength of the joint is called weight.  The value of each neuron in each layer will depend on the weight of the connection and the value of the neurons of the previous layer. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/cb6/bda/c9d/cb6bdac9d2d07f7b9e0b710511d3b4a3.png" width="436" height="419"><br>  Picture 1 <br>  The driver can be compared with the "function".  There are many inputs: what the driver sees.  This data is processed by the brain as a function, and the reaction of the driver is the way out of the function. <br>  The function <strong>f (x) = y</strong> converts the value x (one dimension) to y (one dimension). <br>  We use the neural network of reverse propagation for the driver's ‚Äúbrain‚Äù, since such neural networks are able to approximate any function with areas of definition and values ‚Äã‚Äãthat can have several dimensions: <strong>F (x1, x2, ..., xn) = y1, y2, ... yn</strong> . <br>  This is exactly what we need, since we have to work with multiple inputs and outputs. <br>  When a neural network consists of only a few neurons, we can calculate the weights necessary to obtain an acceptable result.  But as the number of neurons increases, so does the complexity of the calculations.  The back distribution network can be trained to establish the necessary weights.  We just have to provide the desired results with the corresponding inputs. <br>  After training, the neural network will respond to produce a result close to what you want when giving a known result, and to ‚Äúguess‚Äù the correct answer at any input not corresponding to the trainer. <br>  Actual calculations are beyond the scope of this article.  There are many good books explaining how networks work with back-propagation errors. <br>  The neural network used in this case has 4 layers ( <em>Fig. 2</em> ).  I tried various combinations of three to six layers.  Everything worked perfectly with the three layers, but when I was teaching the network on a set of twenty-two inputs-outputs, the function approximation was not accurate enough.  Five and six layers performed their task perfectly, but I had to spend considerable time on training (from 20 to 30 minutes on PII), and when I ran the program, it took a lot of processor time to perform the calculations. <br>  In this network there are three neurons in the input layer and two in the resulting layer.  Later I will explain why.  Between them are two layers of eight neurons each.  Again, I tested a layer with a larger and smaller number of neurons and stopped at eight, since this number gives an acceptable result. <br>  When choosing the number of neurons, keep in mind that each layer and each neuron added to the system will increase the time required to calculate the weights. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/943/e05/a49/943e05a495bb43587cc1ed0f644003f3.png" width="612" height="393"><br>  Figure 2 <br>  <em><strong>Adding neurons:</strong></em> <em><br></em>  <em>We have an input layer <strong>I</strong> with <strong>i</strong> neurons, and the resulting layer <strong>O</strong> with <strong>o</strong> neurons.</em>  <em>We want to add one neuron to the middle layer <strong>M.</strong></em>  <em>The number of connections between neurons that we add is <strong>(i + o)</strong> .</em> <br>  <em><strong>Adding layers:</strong></em> <em><br></em>  <em>We have an input layer <strong>I</strong> with <strong>i</strong> neurons, and the resulting layer <strong>O</strong> with <strong>o</strong> neurons.</em>  <em>We want to add <strong>M</strong> layers with <strong>m</strong> neurons in each.</em>  <em>The number of connections between neurons that we add is <strong>(m * (i + o))</strong> .</em> <br>  Now that we have looked at how the brain works, we need to understand how to determine the inputs and outputs of a neural network.  The neural network itself does nothing if we give it information from the virtual world and do not respond to the network controller of the vehicle. <br><h3>  entrance </h3><br>  What information is important for driving?  First, we must know the position of the obstacle towards us.  Is this position to the right, to our left, or in front of us?  If there are buildings on either side of the road, but there is nothing ahead, we accelerate.  But if the car stopped in front of us, we slow down.  Secondly, we need to know the distance from our position to the object.  If the object is far away, we will continue to move until it approaches, and in this case, we slow down or stop. <br>  This is exactly the information that we will use for our neural network.  For simplicity, we introduce three relative directions: left, front, and right.  As well as the distance from the obstacle to the vehicle. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/34b/31e/eeb/34b31eeeb699dd7a368eee4caf2c1fc6.png" width="640" height="485"><br>  Figure 3 <br>  We define the field of view of our AI driver and compile a list of objects that he sees.  For simplicity, we use a circle in our example, but we could use a real cone truncated by six intersecting planes.  Now for each object in this circle, we check if it is in the left field of view, right, or in the center. <br>  At the entrance to the neural network is an array: <strong>float Vision [3]</strong> .  The distances to the nearest obstacle to the left, in the center, and to the right of the vehicle will be stored in <strong>Vision [0]</strong> , <strong>Vision [1]</strong> and <strong>Vision [2],</strong> respectively.  <em>Figure 3</em> shows how this array looks like.  The obstacle on the left is at a distance of 80% of the maximum distance, on the right - by 40%, and there are no obstacles in the center. <br>  In order to calculate this, we need the position <strong>(x, y) of</strong> each object, the position <strong>(x, y) of the</strong> vehicle and the angle of the vehicle.  We also need <strong>r</strong> (radius of the circle) and <strong>d <sub>right</sub></strong> , <strong>d <sub>left</sub></strong> - the vectors between the car and the <strong>L <sub>right</sub></strong> and <strong>L <sub>left</sub></strong> lines.  These lines are parallel to the direction of movement of the car.  Both vectors are perpendicular to the lines. <br>  Although this is a 3D world, all math is two-dimensional, since the car cannot move in the third dimension, because it does not fly.  All equations include only <strong>x</strong> and <strong>y</strong> , but not <strong>z</strong> . <br>  First, we calculate the equations for the <strong>L <sub>right</sub></strong> and <strong>L <sub>left</sub></strong> lines to help us determine if an obstacle is to the right, left, or center of the vehicle. <br>  <em>Figure 4</em> is an illustration of all calculations. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/8c3/588/b7e/8c3588b7e59b0f28f23d6b10adf82a98.png" width="640" height="480"><br>  Figure 4 <br><img src="https://habrastorage.org/getpro/geektimes/post_images/925/122/55c/92512255cc33529840987e58306329f6.png" width="192" height="32"><br>  Where <br><img src="https://habrastorage.org/getpro/geektimes/post_images/19a/f85/dbf/19af85dbfe156b349edc0cdf8e7564b5.png" width="96" height="75"><br>  Then we calculate the coordinates of a point on the line. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/0b3/acb/498/0b3acb49808cc5823fac8a7067bd53be.png" width="133" height="75"><br>  where V <sub>x</sub> and V <sub>y</sub> position of the vehicle. <br>  Now we can finally calculate <strong>c <sub>r</sub></strong> <br><img src="https://habrastorage.org/getpro/geektimes/post_images/c10/e8a/32e/c10e8a32ebbcc59695d58bdff9707952.png" width="183" height="32"><br>  Similarly, we find the equation of the line <strong>L <sub>left</sub></strong> using the vector <strong>d <sub>left</sub></strong> . <br>  Next, we must calculate the center of the circle.  Everything inside the circle will be visible AI.  The center of the circle <strong>C (x, y)</strong> at a distance <strong>r</strong> from the position of the car <strong>V (x, y)</strong> . <br><img src="https://habrastorage.org/getpro/geektimes/post_images/e3f/67d/ff9/e3f67dff95ce9634cae86714a3141965.png" width="168" height="34"><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a18/9be/c17/a189bec17622aa0bdc37228d84119a24.png" width="175" height="36"><br>  where <strong>V <sub>x</sub></strong> , <strong>V <sub>y is the</sub></strong> position of the vehicle and <strong>C <sub>x</sub></strong> , <strong>C <sub>y</sub></strong> is the center of the circle. <br>  Then we check if each object in the world is within a circle (if the objects are organized into a quad tree or an octree tree, this process is much faster than a linked list). <br>  If a <img src="https://habrastorage.org/getpro/geektimes/post_images/015/63f/524/01563f5241387a928d18f97bd98d0f7b.png">  , then the object is in a circle, where <strong>O <sub>x</sub></strong> , <strong>O <sub>y are the</sub></strong> coordinates of the obstacle. <br>  For each object within a circle, we must check whether it is to the right, left, or center of the vehicle. <br>  If a <img src="https://habrastorage.org/getpro/geektimes/post_images/89b/abb/6a3/89babb6a3cc6e50156f6824bc0dec998.png" width="216" height="36">  then the object is on the right side of the circle <br>  otherwise if <img src="https://habrastorage.org/getpro/geektimes/post_images/7af/825/b37/7af825b375fae79dea7d89c74d8d4108.png" width="214" height="36">  then the left side <br>  otherwise in the center. <br>  Calculate the distance from the object to the car <br><img src="https://habrastorage.org/getpro/geektimes/post_images/9b6/60e/e8a/9b660ee8a50303bff82e9b933d42842f.png" width="216" height="36"><br>  Now we store the distance in the corresponding part of the array ( <strong>Vision [0]</strong> , <strong>Vision [1]</strong> or <strong>Vision [2]</strong> ), provided that the previously stored distance is greater than the one just calculated.  Initially, the Vision array must be initialized with the values <strong>2r</strong> . <br>  After checking each object, we have an array of <strong>Vision</strong> with distances to the nearest objects to the right, center and left of the car.  If no object was found in this field of view, the array element will have a default value. <img src="http://formula11.png" width="37" height="23">  , which means: "there is no object within sight." <br>  Since the neural network uses the sigmoid function, the input data must be in the range from <em>0.0</em> to <em>1.0</em> .  <em>0.0</em> will mean that the object touches the vehicle and <em>1.0</em> means that there are no objects within sight.  Since we have set the maximum distance at which the AI ‚Äã‚Äãdriver can see, we can easily bring all distances to a range from <em>0.0</em> to <em>1.0</em> . <br><img src="https://habrastorage.org/getpro/geektimes/post_images/010/e30/313/010e303132c3b24d12099d724cabec3f.png" width="235" height="32">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Output </h3><br>  At the exit, we should receive instructions on how to change the vehicle speed and direction.  It can be acceleration, braking and steering wheel angle.  So we need two choices;  one will be the acceleration / deceleration value (braking is just a negative acceleration), and the other will indicate a change in direction. <br>  The result is between <em>0.0</em> and <em>1.0</em> for the same reason as the input.  For acceleration, <em>0.0</em> means "full brake";  <em>1.0</em> is full throttle and <em>0.5</em> is no braking or acceleration.  For steering, <em>0.0</em> means ‚Äúall the way to the left,‚Äù <em>1.0</em> means ‚Äúall the way to the right,‚Äù and <em>0.5</em> means not to change direction.  So we need to translate the results into values ‚Äã‚Äãthat we can use. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/95b/943/f3e/95b943f3ebc56271c8db5e7261617180.png" width="460" height="30"><br><img src="https://habrastorage.org/getpro/geektimes/post_images/991/91f/e1d/99191fe1d863c61b07c3e6ec3678e65d.png" width="452" height="30"><br>  It should be noted that "negative acceleration" means braking if the vehicle moves forward, but it also means moving in the opposite direction if the car is at rest.  In addition, "positive acceleration" means braking if the vehicle moves in the opposite direction. <br><br><h3>  Training </h3><br>  As I mentioned earlier, we first need to train a neural network.  We need to create a set of inputs and their corresponding outputs. <br>  Choosing the right I / O for training a neural network is probably the hardest part of the job.  I had to train a network with a lot of data, watch how the car acted in the environment, and then change the records as needed.  Depending on how we train the network, the vehicle may ‚Äúfluctuate‚Äù in some situations and be immobilized. <br>  We make a table ( <em>Table 1</em> ) of the different position of the obstacles relative to the vehicle and the desired response of the AI. <br>  <strong>Table 1</strong> <br><table border="1"><tbody><tr><td width="128" colspan="3">  <strong>Input neurons</strong> <br>  <strong>Relative distance to the obstacle</strong> </td><td width="128" colspan="2">  <strong>Output neurons</strong> </td></tr><tr><td width="128">  <em><strong>Left</strong></em> </td><td width="128">  <em><strong>Centered</strong></em> </td><td width="128">  <em><strong>On right</strong></em> </td><td width="128">  <em><strong>Acceleration</strong></em> </td><td width="128">  <em><strong>Direction</strong></em> </td></tr><tr><td width="128">  No obstacles </td><td width="128">  No obstacles </td><td width="128">  No obstacles </td><td width="128">  Full throttle </td><td width="128">  Straight </td></tr><tr><td width="128">  Half way </td><td width="128">  No obstacles </td><td width="128">  No obstacles </td><td width="128">  Slight acceleration </td><td width="128">  Little to the right </td></tr><tr><td width="128">  No obstacles </td><td width="128">  No obstacles </td><td width="128">  Half way </td><td width="128">  Slight acceleration </td><td width="128">  Little left </td></tr><tr><td width="128">  No obstacles </td><td width="128">  Half way </td><td width="128">  No obstacles </td><td width="128">  Braking </td><td width="128">  Little left </td></tr><tr><td width="128">  Half way </td><td width="128">  No obstacles </td><td width="128">  Half way </td><td width="128">  Acceleration </td><td width="128">  Straight </td></tr><tr><td width="128">  Touching an object </td><td width="128">  Touching an object </td><td width="128">  Touching an object </td><td width="128">  Reverse </td><td width="128">  To the left </td></tr><tr><td width="128">  Half way </td><td width="128">  Half way </td><td width="128">  Half way </td><td width="128">  Without changes </td><td width="128">  Little left </td></tr><tr><td width="128">  Touching an object </td><td width="128">  No obstacles </td><td width="128">  No obstacles </td><td width="128">  Braking </td><td width="128">  Full right </td></tr><tr><td width="128">  No obstacles </td><td width="128">  No obstacles </td><td width="128">  Touching an object </td><td width="128">  Braking </td><td width="128">  Full left </td></tr><tr><td width="128">  No obstacles </td><td width="128">  Touching an object </td><td width="128">  No obstacles </td><td width="128">  Reverse </td><td width="128">  To the left </td></tr><tr><td width="128">  Touching an object </td><td width="128">  No obstacles </td><td width="128">  Touching an object </td><td width="128">  Full throttle </td><td width="128">  Straight </td></tr><tr><td width="128">  Touching an object </td><td width="128">  Touching an object </td><td width="128">  No obstacles </td><td width="128">  Reverse </td><td width="128">  Full right </td></tr><tr><td width="128">  No obstacles </td><td width="128">  Touching an object </td><td width="128">  Touching an object </td><td width="128">  Reverse </td><td width="128">  Full left </td></tr><tr><td width="128">  Object close </td><td width="128">  Object close </td><td width="128">  The object is very close </td><td width="128">  Without changes </td><td width="128">  To the left </td></tr><tr><td width="128">  The object is very close </td><td width="128">  Object close </td><td width="128">  Object close </td><td width="128">  Without changes </td><td width="128">  To the right </td></tr><tr><td width="128">  Touching an object </td><td width="128">  The object is very close </td><td width="128">  The object is very close </td><td width="128">  Braking </td><td width="128">  Full right </td></tr><tr><td width="128">  The object is very close </td><td width="128">  The object is very close </td><td width="128">  Touching an object </td><td width="128">  Braking </td><td width="128">  Full left </td></tr><tr><td width="128">  Touching an object </td><td width="128">  Object Close </td><td width="128">  Object Far </td><td width="128">  Without changes </td><td width="128">  To the right </td></tr><tr><td width="128">  Object away </td><td width="128">  Object close </td><td width="128">  Touching an object </td><td width="128">  Without changes </td><td width="128">  To the left </td></tr><tr><td width="128">  The object is very close </td><td width="128">  Object close </td><td width="128">  Object closer than halfway </td><td width="128">  Without changes </td><td width="128">  Full right </td></tr><tr><td width="128">  Object closer than halfway </td><td width="128">  Object close </td><td width="128">  The object is very close </td><td width="128">  Braking </td><td width="128">  Full left </td></tr></tbody></table><br>  And now you can translate it into numbers in <em>table 2</em> . <br>  <strong>table 2</strong> <br><table border="1"><tbody><tr><td width="128" colspan="3">  Input neurons </td><td width="128" colspan="2">  Output neurons </td></tr><tr><td width="128">  <em><strong>Left</strong></em> </td><td width="128">  <em><strong>Centered</strong></em> </td><td width="128">  <em><strong>On right</strong></em> </td><td width="128">  <em><strong>Acceleration</strong></em> </td><td width="128">  <em><strong>Direction</strong></em> </td></tr><tr><td width="128">  1.0 </td><td width="128">  1.0 </td><td width="128">  1.0 </td><td width="128">  1.0 </td><td width="128">  0.5 </td></tr><tr><td width="128">  0.5 </td><td width="128">  1.0 </td><td width="128">  1.0 </td><td width="128">  0.6 </td><td width="128">  0.7 </td></tr><tr><td width="128">  1.0 </td><td width="128">  1.0 </td><td width="128">  0.5 </td><td width="128">  0.6 </td><td width="128">  0.3 </td></tr><tr><td width="128">  1.0 </td><td width="128">  0.5 </td><td width="128">  1.0 </td><td width="128">  0.3 </td><td width="128">  0.4 </td></tr><tr><td width="128">  0.5 </td><td width="128">  1.0 </td><td width="128">  0.5 </td><td width="128">  0.7 </td><td width="128">  0.5 </td></tr><tr><td width="128">  0.0 </td><td width="128">  0.0 </td><td width="128">  0.0 </td><td width="128">  0.2 </td><td width="128">  0.2 </td></tr><tr><td width="128">  0.5 </td><td width="128">  0.5 </td><td width="128">  0.5 </td><td width="128">  0.5 </td><td width="128">  0.4 </td></tr><tr><td width="128">  0.0 </td><td width="128">  1.0 </td><td width="128">  1.0 </td><td width="128">  0.4 </td><td width="128">  0.9 </td></tr><tr><td width="128">  1.0 </td><td width="128">  1.0 </td><td width="128">  0.0 </td><td width="128">  0.4 </td><td width="128">  0.1 </td></tr><tr><td width="128">  1.0 </td><td width="128">  0.0 </td><td width="128">  1.0 </td><td width="128">  0.2 </td><td width="128">  0.2 </td></tr><tr><td width="128">  0.0 </td><td width="128">  1.0 </td><td width="128">  0.0 </td><td width="128">  1.0 </td><td width="128">  0.5 </td></tr><tr><td width="128">  0.0 </td><td width="128">  0.0 </td><td width="128">  1.0 </td><td width="128">  0.3 </td><td width="128">  0.8 </td></tr><tr><td width="128">  1.0 </td><td width="128">  0.0 </td><td width="128">  0.0 </td><td width="128">  0.3 </td><td width="128">  0.2 </td></tr><tr><td width="128">  0.3 </td><td width="128">  0.4 </td><td width="128">  0.1 </td><td width="128">  0.5 </td><td width="128">  0.3 </td></tr><tr><td width="128">  0.1 </td><td width="128">  0.4 </td><td width="128">  0.3 </td><td width="128">  0.5 </td><td width="128">  0.7 </td></tr><tr><td width="128">  0.0 </td><td width="128">  0.1 </td><td width="128">  0.2 </td><td width="128">  0.3 </td><td width="128">  0.9 </td></tr><tr><td width="128">  0.2 </td><td width="128">  0.1 </td><td width="128">  0.0 </td><td width="128">  0.3 </td><td width="128">  0.1 </td></tr><tr><td width="128">  0.0 </td><td width="128">  0.3 </td><td width="128">  0.6 </td><td width="128">  0.5 </td><td width="128">  0.8 </td></tr><tr><td width="128">  0.6 </td><td width="128">  0.3 </td><td width="128">  0.0 </td><td width="128">  0.5 </td><td width="128">  0.2 </td></tr><tr><td width="128">  0.2 </td><td width="128">  0.3 </td><td width="128">  0.4 </td><td width="128">  0.5 </td><td width="128">  0.9 </td></tr><tr><td width="128">  0.4 </td><td width="128">  0.3 </td><td width="128">  0.2 </td><td width="128">  0.4 </td><td width="128">  0.1 </td></tr></tbody></table><br><br>  <strong>Entrance:</strong> <br>  <em>0.0:</em> The object almost touches the vehicle. <br>  <em>1.0:</em> Object at the maximum distance from the vehicle or not an object in sight <br>  <strong>Output:</strong> <strong><em><br></em></strong>  <strong><em>Acceleration</em></strong> <br>  <em>0.0:</em> Maximum negative acceleration (braking or vice versa) <br>  <em>1.0:</em> Maximum Positive Acceleration <br>  <em><strong>Direction</strong></em> <br>  <em>0,0:</em> Complete left turn <br>  <em>0.5:</em> Straight <br>  <em>1.0:</em> Turn right <br><h3>  Conclusion / Ways to Improve </h3><br>  The use of a neural network back propagation is suitable for our purposes, but there are some problems identified during testing.  Some changes could make the program more reliable and adapt it to other situations.  Now I will describe to you some problems that you might want to think about. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/8f4/184/a74/8f4184a74d2dc7bc04e1428c06ac359f.png"><br>  Figure 5 <br>  The vehicle is ‚Äústuck‚Äù for a while, as it fluctuates in deciding whether to drive left or right.  This was to be expected: people sometimes have the same problem.  To fix this is not so easy, trying to adjust the weights of the neural network.  But we can add a line of code that says: <br>  "If (the vehicle does not move for 5 seconds), then (take control and turn it 90 degrees to the right)." <br>  By this we can guarantee that the car will never stand still, not knowing what to do. <br>  The vehicle will not see a small gap between the two houses, as shown in <em>Figure 5</em> .  Since we do not have a high level of accuracy in vision (on the left, in the center, on the right), two buildings that are close to each other will be like a wall for artificial intelligence.  To have a clearer view of our AI, we need to have 5 or 7 levels of accuracy at the entrance to the neural network.  Instead of "right, center, left," we could have "far right, right side, center, side left, far left."  With a good learning of the neural network, artificial intelligence will see the gap and understand that it can pass through it. <br>  It works in a 2D world, but what if the vehicle is able to fly through a cave?  With some changes to this technique, we can make the AI ‚Äã‚Äãfly, not ride.  By analogy with the last problem, we increase the accuracy of the gaze.  But instead of adding ‚Äúrights‚Äù and ‚Äúlion‚Äù, we can do it as shown in <em>table 3</em> . <br>  <strong>Table 3</strong> <br><table border="1"><tbody><tr><td width="213">  Top left </td><td width="213">  Up </td><td width="213">  Top right </td></tr><tr><td width="213">  Left </td><td width="213">  Centre </td><td width="213">  On right </td></tr><tr><td width="213">  Bottom left </td><td width="213">  Down below </td><td width="213">  Bottom right </td></tr></tbody></table><br>  Now that our neural network can see the world in 3D, we just need to change our vehicle control and response to the world. <br>  The vehicle only "wanders" without any specific purpose.  It does nothing but circumvent obstacles.  Depending on where we want to go, we can ‚Äútune‚Äù the brain as needed.  We can have many different neural networks and use the right one in a particular situation.  For example, we could follow the car in sight.  We just need to connect another neural network trained to follow another vehicle, receiving as input the location of the second transport. <br>  As we have just seen, this method can be improved and applied in various fields.  Even if it is not used for any useful purpose, it will still be interesting for us to observe how the artificial intelligence system behaves in the environment.  If you observe for a long time, we will understand that in difficult conditions, the vehicle will not always follow the same path due to the small difference in the decision due to the nature of the neural network.  The car will sometimes drive to the left of the building, and sometimes to the right of the same building. <br><br><h3>  Literature </h3><br><ol><li>  Joey Rogers, Object-Oriented Neural Network in C ++, Academic Press, San Diego, CA, 1997 </li><li>  MT Hagan, HB Demuth and MH Beale, Neural Network Design, PWS Publishing, Boston, MA, 1995 </li></ol></div><p>Source: <a href="https://habr.com/ru/post/101789/">https://habr.com/ru/post/101789/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../101779/index.html">In the US, condemned the idea of ‚Äã‚ÄãGoogle on the two-tier Internet</a></li>
<li><a href="../101781/index.html">SharpMap: GIS Engine Overview</a></li>
<li><a href="../101782/index.html">PostgreSQL tuning and scaling</a></li>
<li><a href="../101786/index.html">Automation of trade: a brief example of implementation</a></li>
<li><a href="../101787/index.html">An overview of modern projects of large-scale modeling of brain activity</a></li>
<li><a href="../101793/index.html">Do not build from scratch. Now you have a template for HTML5 layout.</a></li>
<li><a href="../101796/index.html">Policy-based Routing (PBR), as the main purpose (Part 1)</a></li>
<li><a href="../101797/index.html">We get internet via USB from a computer on Android</a></li>
<li><a href="../101798/index.html">We buy a used SLR</a></li>
<li><a href="../101805/index.html">To live in the App Store is good. Shop of programs "At Stevie" eyes of the developer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>