<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Classical mechanics: about diffusions "on the fingers"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently looked at the Farseer Physics Engine . It became interesting how a dynamic object is implemented in this engine. As expected, I did not meet ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Classical mechanics: about diffusions "on the fingers"</h1><div class="post__text post__text-html js-mediator-article">  Recently looked at the <a href="http://farseerphysics.codeplex.com/">Farseer Physics Engine</a> .  It became interesting how a dynamic object is implemented in this engine.  As expected, I did not meet there the usual differential equations and their discrete realizations in the form of difference equations or discrete models of the state space.  The main <s>excuse is the</s> declared reason for the abandonment of ‚Äúfair‚Äù mechanics in many gaming physics engines - the excessive complexity of working with differential equations and too much computational load. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  In this article, I continue the topic of digital signal processing.  In it, I will try to speak in simple language about the concept of game mechanics (physics) using an approach based on differential equations.  In the future, I am going to assess whether the implementation of such an approach will really lead to a sharp increase in the computational load.  In the framework of this article will not work - too much.  In this I am going to describe the purpose of the coefficients included in the mathematical model of a dynamic object, to describe their physical meaning, i.e.  their influence on the behavior of a dynamic object. <br>  Perhaps we will start ... <br><br><h4>  Physical sense </h4><br>  In my article <a href="http://habrahabr.ru/blogs/algorithm/120133/">about the Kalman Filter,</a> I described what the ‚Äúinput-output‚Äù equations are, the transfer function, and the operator form for writing differential equations (see the section ‚ÄúBasic concepts‚Äù in [2]).  The following equation can serve as an example of a <b>part of a</b> mathematical model of a dynamic object in the operator record form: <br>  (one) <img src="https://habrastorage.org/storage/2c6ca920/2cda7caa/dda35d01/13eaf555.png" alt="image"><br>  This is a common simplified model of dynamic systems.  Ahead of it, I will write that the body model in the <a href="http://farseerphysics.codeplex.com/">Farseer</a> engine uses a stripped-down analog of the model presented above (second-order dynamic link).  Below is a description of the notation adopted in it. <br><ul><li>  a0, a1, a2 are the coefficients of inertia, damping and stiffness, respectively. </li><li>  b0, b1 - input factors. </li><li>  s is the Laplass operator (d / dt). </li><li>  Œ± (s), Œ≤ (s) are the output and input variables, as functions of the Laplass operator. </li></ul><br>  The presented equation describes a dynamic system of the type ‚Äúsingle input - single output‚Äù (SISO).  It can be used to describe the dynamics of an object according to one of its degrees of freedom.  As you may know, a free body has six degrees of freedom - three translational (linear motion along the three axes of the coordinate system (SC)) and three rotational (turns around the axes of the SC).  Thus, the complete model of the physical body will be described by six such equations (or four for the 2D case).  You can immediately say that this already indicates that the approach is too complex.  But in fact, in Farseer, for example, the body class (Body) contains both the linear coordinates of the body (essentially, it is the Œ± (s) pair for OX and OY), and the linear velocities (the s * Œ± (s) pair for OX and OY) ) and orientation parameters and angular velocity.  These parameters are calculated separately for each of the axes, i.e.  the number of equations is the same - two equations along the axis OX (linear and angular motion) and two for the axis OY.  The only difference is in the form of equations. <br>  The algorithm in the Farseer engine is approximate and simplified, but it allows you to work with varying time slices.  The function of calculation of motion parameters ( <i>Island.Solve (ref <b>TimeStep</b> step, ref Vector2 gravity)</i> ) transmits the time elapsed after the last calculation of parameters.  This allows, with insufficient computer performance, to keep the flow rate of game time approximately constant to the detriment of the smoothness and realism of the movement of game objects. <br>  When constructing a discrete model based on differential equations, we clearly tie in to a fixed time quantum.  The equations are integrated for the initially specified discretization rate, and if since the last calculation, for some reason, more time has passed than the specified quantum (in the English literature it is called ‚Äútime sample‚Äù), then we must either calculate several times, or we will get a slowdown the movement of the object.  Last I just watched in the game " <a href="http://ru.wikipedia.org/wiki/Cortex_Command">Command Cortex</a> " on a weak machine.  The movements of the actors were smooth but slow (the actors controlled by man gain an advantage).  Thus, one cannot speak of the exceptional advantage of one of these approaches. <br>  Now, about what the coefficients of the above equation are responsible for.  This equation describes the movement of the physical body relative to its equilibrium position with Œ± (s) = 0. This is another reason for the seeming inconvenience of using such a model in game mechanics.  In the absence of applied external forces, this model will sooner or later return (if the model is stable) the body to an equilibrium position.  Imagine a game world filled with balls that all the time tend to the origin (for example, to the upper left corner of the screen).  The presence of a stiffness coefficient leads to this behavior (see a2 above).  Imagine that the body is connected to the origin of the spring.  While forces act on the body, the spring is stretched, but it is necessary to remove the external effect and the body will rush to zero.  The bodies in the Farseer engine do not have this behavior.  If we set the coefficient a2 to zero, then in this case the bodies will not tend to the origin of coordinates (see above, I wrote that the models in Farseer are in fact trimmed versions of this model).  Well, why is this coefficient then needed, you ask.  If you open the brackets on the left side of equation (1) and instead of the addend <br>  a2 * Œ± (s) <br>  write <br>  a2 * (Œ± (s) - Œ±0) <br>  then through Œ±0 we will be able to set the position to which the game object will strive.  The magnitude of the coefficient a2 is responsible for how quickly the body moves to a given equilibrium position (the higher the value, the higher the spring stiffness).  How this is implemented in Farseer, I have not yet figured out, but I think I will have to create an additional source of impact. <br>  Now the coefficient a1.  This is the damping coefficient.  The greater the value of this coefficient, the faster the speed is quenched (linear or angular).  Life analogy - viscous liquids such as oil, honey, epoxy resin.  These fluids are very viscous (the damping coefficient is very important).  The higher the speed of movement of the body in them, the higher the resistance to this movement.  If you slowly move a spoon in them, for example, you will not be able to overcome the resistance of big work, but if you strike with a swing, then the blow will be tough. <br>  The value of the coefficient a0 characterizes the inertia of the object.  In describing linear motion, mass is used as the coefficient a0.  The higher its value, the slower the body picks up speed when external forces are applied to it. <br>  Now about the coefficients on the right side of equation (1).  It should be noted here that this model is extended to the case when the input action is determined not only by the value of the external force itself, but also by its change.  To describe the dynamics of game objects, this may be superfluous.  However, in industrial systems management there are also such models.  What is their physical meaning?  The coefficient b1 is essentially the coefficient of transfer of external force into the object.  It is usually equal to one unit, i.e.  power is transmitted as is. <br>  The coefficient b0 is interesting.  It plays the role of a forcing factor.  Imagine a very inertial object to which a force is applied that gradually increases with time.  If the rate of increase and the final magnitude of the force will be small, then the object is very slowly gaining speed.  But if a force is made large, then after an external force reaches a given value, the object will not stop in some position, but will oscillate under the action of inertia.  Forcing is an impact proportional to the rate of increase of external force.  If we choose a large one, then even at a low rate of increase in external force, our object will pick up speed fairly quickly, and when the external force reaches the specified value, the boost will turn off.  Here is such a cunning this "b0". <br><br><h4>  Dynamics in pictures </h4><br>  To clearly show the effect of diff factors.  equations for the behavior of a dynamic object decided to construct graphs of the transition process with <b>step response</b> and <b>impulse response</b> input effects.  A total of 6 groups of graphs are presented (one group for each coefficient).  The graphs are built in the Octave package (v. 3.4) with the ‚ÄúSignal Processing‚Äù package installed. <br>  So, let's take the model of the form as the initial one: <br>  ========================================= <br>  &gt;&gt;&gt; w = tf ([1 1], [1 1 1]) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Transfer function "w" from input "u1" to output ... <br><br>  y1: (s + 1) / (s ^ 2 + s + 1) <br><br>  Continuous-time model. <br>  ========================================= <br><img src="https://habrastorage.org/storage2/dee/633/4b6/dee6334b6e6f0c0f9d8e33bef9b370c9.png"><br><img src="https://habrastorage.org/storage2/49c/d20/880/49cd20880aa79dff12214164cedaf5c7.png"><br>  The code "w = tf ([1 1], [1 1 1])" in symbolic form is: <br>  &gt;&gt;&gt; w = tf ([b0 b1], [a0 a1 a2]) <br>  In the screenshots at the bottom right, the approximate stabilization time (the stability corridor is ¬± 5% of the specified value). <br><br>  Let's try to play with the stiffness coefficient a2. <br>  &gt;&gt;&gt; w1 = 0.1 * tf ([1 1], [1 1 0.1]) <br>  y1: (s + 1) / (s ^ 2 + s + 0.1) <br><br>  &gt;&gt;&gt; w2 = 10 * tf ([1 1], [1 1 10]) <br>  y1: (s + 1) / (s ^ 2 + s + 10) <br>  <i>Note: it was necessary to podshamanit with gain factors so that the resulting gain factor was equal to one.</i> <br><img src="https://habrastorage.org/storage2/0ff/40e/f66/0ff40ef66c9d17c628da7ffc8bc3c774.png"><br><img src="https://habrastorage.org/storage2/810/524/e7f/810524e7f6244e9de0c5a92d94088813.png"><br>  What can be seen on the charts?  From left to right are graphs for w, w1 and w2, respectively.  The w1 plots are smoother and more slowly reach steady-state values.  The w2 plots are more oscillatory in nature, but reach a steady-state value more quickly.  Conclusion: stiffer spring - more oscillations, but a shorter transition process. <br><br>  Let's try to play with damping (a1). <br>  &gt;&gt;&gt; w1 = tf ([1 1], [1 0.25 1]) <br>  y1: (s + 1) / (s ^ 2 + 0.25s + 1) <br><br>  &gt;&gt;&gt; w2 = tf ([1 1], [1 2 1]) <br>  y1: (s + 1) / (s ^ 2 + 2s + 1) <br><img src="https://habrastorage.org/storage2/586/4c5/ae8/5864c5ae808fd1bee14f8d91faf95612.png"><br><img src="https://habrastorage.org/storage2/0d1/5e6/aff/0d15e6aff727d2e2b756d581c584e295.png"><br>  Immediately conclusion: more viscosity - oscillations damp out faster. <br><br>  Let's try to play with inertia (a0). <br>  &gt;&gt;&gt; w1 = tf ([1 1], [0.1 1 1]) <br>  y1: (s + 1) / (0.1s ^ 2 + s + 1) <br><br>  &gt;&gt;&gt; w2 = tf ([1 1], [2 1 1]) <br>  y1: (s + 1) / (2s ^ 2 + s + 1) <br><img src="https://habrastorage.org/storage2/ea0/f70/454/ea0f70454bdca69d286e721479586740.png"><br><img src="https://habrastorage.org/storage2/314/449/e80/314449e8091f5584b6369bfc80e3482d.png"><br>  Conclusion: the weight of the cast iron is less - less turbulence and a shorter transition process. <br><br>  We turn to the right side and play with b1. <br>  &gt;&gt;&gt; w1 = 10 * tf ([1 0.1], [1 1 1]) <br>  y1: (10 s + 1) / (s ^ 2 + s + 1) <br><br>  &gt;&gt;&gt; w2 = 0.25 * tf ([1 4], [1 1 1]) <br>  y1: (0.25 s + 1) / (s ^ 2 + s + 1) <br><img src="https://habrastorage.org/storage2/071/9a8/ee3/0719a8ee302fb98655141591d3cf8002.png"><br><img src="https://habrastorage.org/storage2/af2/06c/9ff/af206c9ff9af83150c79d4894fcfa6d4.png"><br>  It seems that the difference is barely noticeable when you look at the Step Response graphics.  But on the Impulse Response graphs, the effect of this coefficient is clearly visible.  If it is equal to one, then the pulse transition process starts from one (in fact, it goes out of zero, but it doesn‚Äôt matter - the second value in the unit graph).  The graph w1 ‚Äústarts‚Äù from the value 10 (the reciprocal of 0.1), and the graph w2 starts from the value 0.25 (inverse to 4).  Thus, the coefficient b1 can be ‚Äúdenounced‚Äù by the coefficient of management efficiency (input action). <br><br>  And finally, delicious - games with coefficient b0.  This is a tricky ratio, because the comparison will not be as it was above.  To show its effect will have to vary several factors. <br>  &gt;&gt;&gt; w1 = tf ([6 1], [1 1 1]) <br>  y1: (6 s + 1) / (s ^ 2 + s + 1) <br><br>  &gt;&gt;&gt; w2 = tf ([6 1], [1 3 1]) <br>  y1: (6 s + 1) / (s ^ 2 + 3 s + 1) <br><img src="https://habrastorage.org/storage2/7e2/6c1/31c/7e26c131cc27a9b3cc49f6fbb9f22aac.png"><br><img src="https://habrastorage.org/storage2/e34/a82/c41/e34a82c41355e9219c9f0f3f169ece1b.png"><br>  What is the difference between w1 and w2?  W2 has three times the damping coefficient.  As a result, we get interesting conclusions.  Graphs w1 and w2 cross the steady-state level earlier than the default graph.  However, the w1 graph retains the default form with its oscillation, while the w2 graph retains a more smoothed due to the increased damping.  Thus, playing with forcing and damping, we can make even a cast iron iron flit around the ring like a butterfly without hesitation to and fro. <br><br><h4>  As PS </h4><br>  In this article I considered only positive values ‚Äã‚Äãof the coefficients.  Their positivity is a necessary condition for the stability of the mat.  models.  However, you can try to play with negative values.  An unstable system can also be controlled.  Think of the fifth generation aircraft (for example, our Golden Eagle).  The reverse sweep of the wing is an unstable glider, but on the other hand, it has high maneuverability.  Automation is able to correct this instability and at the same time, when necessary, lay steep turns. <br>  If it works out, I'll concoct a toy with which you can visually see all these effects. <br><br><h4>  Sources </h4><br><ol><li>  Game physics engine " <a href="http://farseerphysics.codeplex.com/">Farseer</a> " </li><li>  <a href="http://habrahabr.ru/blogs/algorithm/120133/">Kalman filter - is it difficult?</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/135794/">https://habr.com/ru/post/135794/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../135784/index.html">PayPal may ask the buyer to destroy the item for a refund</a></li>
<li><a href="../135786/index.html">Parallel loading of JavaScript and CSS without blocking page parsing</a></li>
<li><a href="../135788/index.html">Unkillable USB flash drive :: 2</a></li>
<li><a href="../135790/index.html">Radio-controlled Wi-Fi machine with a camera</a></li>
<li><a href="../135793/index.html">Nokia Maps 3D demo (WebGL)</a></li>
<li><a href="../135795/index.html">Artificial intelligence in CAM-systems for solving problems of automating the creation of control programs</a></li>
<li><a href="../135796/index.html">Social Internet services as tools for creating social media</a></li>
<li><a href="../135797/index.html">Groovy implicit type casting features</a></li>
<li><a href="../135798/index.html">Backup Time Machine do it yourself</a></li>
<li><a href="../135800/index.html">Getting rid of PGP in the mutt mailbox</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>