<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cach√© Globals Bitmap Indexes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the Cach√© object DBMS, bitmap and bitslice indexes are supported. It is very easy to use them in Cach√© classes: it is enough to indicate Bitmap or ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cach√© Globals Bitmap Indexes</h1><div class="post__text post__text-html js-mediator-article">  In the Cach√© object DBMS, bitmap and bitslice indexes are supported.  It is very easy to use them in Cach√© classes: it is enough to indicate <a href="">Bitmap</a> or <a href="">Bitslice</a> in the description of the index, and the performance of some SQL queries is improved dramatically.  But how does this work? <br>  This article describes how bitmap indexes are organized, how to create a bitmap index on an arbitrary global structure, how to use bit logic functions and how to use them effectively when working with NoSQL in Cach√©. <br><a name="habracut"></a><br>  Since the very beginning of the time, when developing applications to quickly find interesting records in globals, type indices were most often built <br><br>  <font color="#0000ff">set</font> <font color="#000000">^ Index (</font> <font color="#008000">"Property"</font> <font color="#000000">,</font> <font color="#800000">value</font> <font color="#000000">,</font> <font color="#800000">id</font> <font color="#000000">) =</font> <font color="#008000">""</font> <br><br>  Such indexes allow you to easily and quickly find records for which the property of interest has a specified value: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <font color="#0000ff">set</font> <font color="#800000">id</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">for set</font> <font color="#800000">id</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(^ Index (</font> <font color="#008000">"Property"</font> <font color="#000000">,</font> <font color="#800000">value</font> <font color="#000000">,</font> <font color="#800000">id</font> <font color="#000000">))</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">id</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">write</font> <font color="#800000">id</font> <font color="#0000ff">,!</font> <br><br>  will give the identifiers of all records that have the value of the property ‚ÄúProperty‚Äù equal to value, and you can check for the existence of records with this property value, for example, using this code: <br><br>  <font color="#0000ff">if $ data</font> <font color="#000000">(^ Index (</font> <font color="#008000">"Property"</font> <font color="#000000">,</font> <font color="#800000">value</font> <font color="#000000">))&gt; 1</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">write</font> <font color="#008000">"id"</font> <font color="#000000">_</font> <font color="#0000ff">$ order</font> <font color="#000000">(^ Index (</font> <font color="#008000">"Property"</font> <font color="#000000">,</font> <font color="#800000">value</font> <font color="#000000">,</font> <font color="#008000">""</font> <font color="#000000">)) _</font> <font color="#008000">"with"</font> <font color="#000000">_</font> <font color="#800000">value</font> <font color="#000000">_</font> <font color="#008000">"exists"</font> <font color="#800080">}</font> <font color="#800080"><br></font>  <font color="#0000ff">else</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">write</font> <font color="#008000">"records with"</font> <font color="#000000">_</font> <font color="#800000">value</font> <font color="#000000">_</font> <font color="#008000">"do not exist"</font> <font color="#800080">}</font> <br><br>  It is easy to come up with an algorithm for the effective search of records that satisfy several conditions at once, combined by the logic of "AND".  But for more complex queries, it was necessary either to develop (and to debug each time) a more complex algorithm, or to abandon the use of indices in favor of directly iterating over all records in the database. <br><br>  A revolutionary change was the emergence in Cach√© of full- <a href="">bit bit functions</a> : <b>$ bit</b> (), <b>$ bitlogic</b> (), <b>$ bitfind</b> () and <b>$ bitcount</b> ().  Now you can build bitmap-indices, in the simplest case - of the form <br><br>  <font color="#0000ff">set $ bit</font> <font color="#000000">(^ Index (</font> <font color="#008000">"Property"</font> <font color="#000000">,</font> <font color="#800000">value</font> <font color="#000000">),</font> <font color="#800000">id</font> <font color="#000000">) = 1</font> <br><br>  Of course, since the length of the bit string is limited to 256K, in real-world applications, the bitmap index has to be placed not in a single bit string, but in an array. <br>  The $ bitlogic () functions make it easy to create a resultant bitmap index corresponding to a sample of records that satisfy any arbitrary query, $ bitcount () determines the number of records included in the sample, and $ bitfind () provides easy navigation through received sample. <br><br>  For example, to collect records for which the property ‚ÄúPr1‚Äù has the values ‚Äã‚Äã‚ÄúA‚Äù or ‚ÄúB‚Äù, and the property ‚ÄúPr2‚Äù - the value ‚ÄúC‚Äù: <br><br>  <font color="#0000ff">set</font> <font color="#000000">^ mtemp.resbitmap =</font> <font color="#0000ff">$ bitlogic</font> <font color="#000000">(^ Index (</font> <font color="#008000">"Pr1"</font> <font color="#000000">,</font> <font color="#008000">"A"</font> <font color="#000000">) | ^ Index (</font> <font color="#008000">"Pr1"</font> <font color="#000000">,</font> <font color="#008000">"B"</font> <font color="#000000">))</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">^ mtemp.resbitmap =</font> <font color="#0000ff">$ bitlogic</font> <font color="#000000">(^ mtemp.resbitmap &amp; ^ Index (</font> <font color="#008000">"Pr2"</font> <font color="#000000">,</font> <font color="#008000">"C"</font> <font color="#000000">))</font> <br><br>  and give them an id: <br><br>  <font color="#0000ff">if</font> <font color="#000000">'</font> <font color="#0000ff">$ bitcount</font> <font color="#000000">(^ mtemp.resbitmap)</font> <font color="#0000ff">write</font> <font color="#008000">"No records found"</font> <font color="#000000">,!</font> <font color="#000000"><br></font>  <font color="#0000ff">else set</font> <font color="#800000">id</font> <font color="#000000">= 0</font> <font color="#0000ff">for set</font> <font color="#800000">id</font> <font color="#000000">=</font> <font color="#0000ff">$ bitfind</font> <font color="#000000">(^ mtemp.resbitmap, 1,</font> <font color="#800000">id</font> <font color="#000000">)</font> <font color="#0000ff">quit</font> <font color="#000000">: '</font> <font color="#800000">id</font> <font color="#0000ff">write</font> <font color="#800000">id</font> <font color="#000000">,!</font> <br><br>  This is not all that can be squeezed out of the bit functions in Cach√©.  To calculate the values ‚Äã‚Äãof the grouping function (sum, arithmetic average, minimum, maximum), it was still necessary to cycle through all the records in the sample, which, with a sufficient sample size, was not fast.  But a small modification of the structure of bitmap-indices significantly speeds up this procedure, if the property values ‚Äã‚Äãare integer or with a fixed decimal point. <br>  The essence of this modification is the construction of separate bitmap-indices for each bit of the property value.  Such constructions are called bit-slices: <br><br>  <font color="#0000ff">set $ bit</font> <font color="#000000">(^ Index (</font> <font color="#008000">"Property"</font> <font color="#000000">,</font> <font color="#800000">N</font> <font color="#000000">),</font> <font color="#800000">id</font> <font color="#000000">) =</font> <font color="#800000">NthBitOfValue</font> <br><br>  In reality, again, instead of a bit string, an array is used. <br>  When using bitslices, it is somewhat more difficult, for example, to search for ‚Äúmore‚Äù or ‚Äúless‚Äù restrictions, but the gain in calculating grouping functions outweighs this inconvenience.  In fact, to calculate the sum of the values ‚Äã‚Äãof the property of interest for the selected records, the cycle of records is no longer needed.  It is enough to sum up with the corresponding weights $ bitcount () in the resulting bitmap-index for all bits of the value of the property of interest.  With a sufficient sample size, the performance gain can be called amazing without exaggeration. <br><br><div class="spoiler">  <b class="spoiler_title">Class code</b> <div class="spoiler_text"> <font color="#000080">/// A set of methods for creating and working with bitmap and bit-slice indexes</font> <font color="#000080"><br></font>  <font color="#000080">///</font> <font color="#000080"><br></font>  <font color="#000080">/// bitmap index structure</font> <font color="#000080"><br></font>  <font color="#000080">/// array of the form array (value) whose elements are</font> <font color="#000080"><br></font>  <font color="#000080">/// bit strings with 1 in positions corresponding to record numbers,</font> <font color="#000080"><br></font>  <font color="#000080">/// for which some parameter takes the value value,</font> <font color="#000080"><br></font>  <font color="#000080">/// split into an array of strings with a maximum length $$$ MAXBITLENGTH</font> <font color="#000080"><br></font>  <font color="#000080">/// numbering of records - with 1, array elements - with 0,</font> <font color="#000080"><br></font>  <font color="#000080">/// (further, for brevity - bit arrays).</font> <font color="#000080"><br></font>  <font color="#000080">/// example of filling</font> <font color="#000080"><br></font>  <font color="#000080">/// let the record number idfact par parameter is val</font> <font color="#000080"><br></font>  <font color="#000080">/// set idf0 = idfact-1 \ $$$ MAXBITLENGTH, idf1 = idfact-1 # $$$ MAXBITLENGTH + 1</font> <font color="#000080"><br></font>  <font color="#000080">/// set $ bit (^ BM ("I", par, val, idf0), idf1) = 1</font> <font color="#000080"><br></font>  <font color="#000080">/// set $ bit (^ BM ("EXIST", idf0), idf1) = 1</font> <font color="#000080"><br></font>  <font color="#000080">/// index of existing records is useful, first, because</font> <font color="#000080"><br></font>  <font color="#000080">/// makes it easy to perform logical deletion, and secondly,</font> <font color="#000080"><br></font>  <font color="#000080">/// allows you to find the number of records in the repository without</font> <font color="#000080"><br></font>  <font color="#000080">/// calls to other structures, which is necessary for correct</font> <font color="#000080"><br></font>  <font color="#000080">/// work procedure BMNot (see below)</font> <font color="#000080"><br></font>  <font color="#000080">/// structure of the bayslay-index:</font> <font color="#000080"><br></font>  <font color="#000080">/// array of bitmap indexes.</font>  <font color="#000080">1st array element - character index</font> <font color="#000080"><br></font>  <font color="#000080">/// of values, the 2nd is the index of the least significant bit of the values ‚Äã‚Äã(1/0), the 3rd is</font> <font color="#000080"><br></font>  <font color="#000080">/// index of the last but one bit (2/0), etc.</font> <font color="#000080"><br></font>  <font color="#000080">///</font> <font color="#000080"><br></font>  <font color="#000080">/// example of filling</font> <font color="#000080"><br></font>  <font color="#000080">/// let the record number idfact parameter par has an integer</font> <font color="#000080"><br></font>  <font color="#000080">/// value of val</font> <font color="#000080"><br></font>  <font color="#000080">/// set idf0 = idfact-1 \ $$$ MAXBITLENGTH, idf1 = idfact-1 # $$$ MAXBITLENGTH + 1</font> <font color="#000080"><br></font>  <font color="#000080">/// set val = $$ CvtToBin (val)</font> <font color="#000080"><br></font>  <font color="#000080">/// for ix = 1: 1: $ length (val) set: $ extract (val, ix) $ bit (^ BM ("S", par, ix, idf0), idf1) = 1</font> <font color="#000080"><br></font>  <font color="#000080">/// when mass filling, in order to avoid a catastrophic fall</font> <font color="#000080"><br></font>  <font color="#000080">/// performance, it is recommended to impose the corresponding fragment</font> <font color="#000080"><br></font>  <font color="#000080">/// code functions $ sortbegin (^ BM) and $ sortend (^ BM)</font> <font color="#000080"><br></font>  <font color="#000080">/// for sampling the facts according to the given constraints and calculations for the obtained</font> <font color="#000080"><br></font>  <font color="#000080">/// samples of grouping functions "sum", "maximum" and "minimum"</font> <font color="#000080"><br></font>  <font color="#000080">/// are intended functions BSSum (), BSMax () and BSMin ()</font> <font color="#000080"><br></font>  <font color="#000080">Class User.BitMapSlice Extends% RegisteredObject</font> <font color="#000000">[</font> <font color="#000080">ProcedureBlock</font> <font color="#000000">]</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br><br></font>  <font color="#000080">/// Name ($ na) of bitmaps and bits</font> <font color="#000080"><br></font>  <font color="#000080">/// Default value is "^ BM"</font> <font color="#000080"><br></font>  <font color="#000080">Property</font> <font color="#000000">BMGLOB</font> <font color="#000080">As% String</font> <font color="#000000">(</font> <font color="#000080">TRUNCATE</font> <font color="#000000">=</font> <font color="#000080">1</font> <font color="#000000">) [</font> <font color="#000080">InitialExpression</font> <font color="#000000">=</font> <font color="#800080">"^ BM"</font> <font color="#000000">];</font> <font color="#000000"><br><br></font>  <font color="#000080">/// Maximal length of $ bit string to use</font> <font color="#000080"><br></font>  <font color="#000080">Parameter</font> <font color="#000000">MAXBITLENGTH =</font> <font color="#000080">64000</font> <font color="#000000">;</font> <font color="#000000"><br><br></font>  <font color="#000080">/// Creates and returns the name ($ na ()) of the temporary global subnode</font> <font color="#000080"><br></font>  <font color="#000080">/// to store intermediate bitmaps</font> <font color="#000080"><br></font>  <font color="#000080">ClassMethod</font> <font color="#000000">GetNewTMP ()</font> <font color="#000080">As% String</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">quit $ name</font> <font color="#000000">(^ CacheTemp (</font> <font color="#008000">"BM"</font> <font color="#000000">,</font> <font color="#0000ff">$ job</font> <font color="#000000">_</font> <font color="#0000ff">$ zutil</font> <font color="#000000">(110),</font> <font color="#0000ff">$ increment</font> <font color="#000000">(^ CacheTemp (</font> <font color="#008000">"BM"</font> <font color="#000000">,</font> <font color="#0000ff">$ job</font> <font color="#000000">_</font> <font color="#0000ff">$ zutil</font> <font color="#000000">(110)))))</font> <font color="#000000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// Removes all temporary subnodes created by this process.</font> <font color="#000080"><br></font>  <font color="#000080">ClassMethod</font> <font color="#000000">KillAllTMP ()</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">^ CacheTemp (</font> <font color="#008000">"BM"</font> <font color="#000000">,</font> <font color="#0000ff">$ job</font> <font color="#000000">_</font> <font color="#0000ff">$ zutil</font> <font color="#000000">(110))</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// Operations on bitmaps</font> <font color="#000080"><br></font>  <font color="#000080">/// here and hereinafter, in order to be flexible, bit indices,</font> <font color="#000080"><br></font>  <font color="#000080">/// arrays and slices are passed by name ($ na ())</font> <font color="#000080"><br></font>  <font color="#000080">///</font> <font color="#000080"><br></font>  <font color="#000080">/// finds the position next to pos with a single bit</font> <font color="#000080"><br></font>  <font color="#000080">/// in bm - transmitted by the name of the bitmap</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMOrder (</font> <font color="#ff00ff">bm</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">pos</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000080">As% String</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">sub</font> <font color="#000000">=</font> <font color="#800000">pos</font> <font color="#000000">\ ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ bitfind</font> <font color="#000000">(</font> <font color="#0000ff">$ get</font> <font color="#000000">(@</font> <font color="#800000">bm</font> <font color="#000000">@ (</font> <font color="#800000">sub</font> <font color="#000000">)), 1,</font> <font color="#800000">pos</font> <font color="#000000"># ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">+1)</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix sub</font> <font color="#000000">* ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">+</font> <font color="#800000">ix</font> <font color="#800000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">sub</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">bm</font> <font color="#000000">@ (</font> <font color="#800000">sub</font> <font color="#000000">))</font> <font color="#0000ff">quit</font> <font color="#000000">: '</font> <font color="#800000">sub</font> <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ bitfind</font> <font color="#000000">(</font> <font color="#0000ff">$ get</font> <font color="#000000">(@</font> <font color="#800000">bm</font> <font color="#000000">@ (</font> <font color="#800000">sub</font> <font color="#000000">)), 1)</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#800000"><br></font>  <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix sub</font> <font color="#000000">* ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">+</font> <font color="#800000">ix</font> <font color="#800000"><br></font>  <font color="#0000ff">quit</font> <font color="#008000">""</font> <font color="#008000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// bmdest = bmdest &amp; bmsrc</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMAnd (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">bmsrc</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">sub1</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">bmdest</font> <font color="#000000">@ (</font> <font color="#0000ff">$ char</font> <font color="#000000">(0)), - 1),</font> <font color="#800000">sub</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">bmsrc</font> <font color="#000000">@ (</font> <font color="#0000ff">$ char</font> <font color="#000000">(0)), - 1)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">:</font> <font color="#800000">sub</font> <font color="#000000">&lt;</font> <font color="#800000">sub1 sub</font> <font color="#000000">=</font> <font color="#800000">sub1</font> <font color="#800000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">ix</font> <font color="#000000">= 0: 1:</font> <font color="#800000">sub</font> <font color="#0000ff">set</font> <font color="#000000">:</font> <font color="#0000ff">$ data</font> <font color="#000000">(@</font> <font color="#800000">bmdest</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)) &amp;</font> <font color="#0000ff">$ data</font> <font color="#000000">(@</font> <font color="#800000">bmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)) @</font> <font color="#800000">bmdest</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">) =</font> <font color="#0000ff">$ bitlogic</font> <font color="#000000">(@</font> <font color="#800000">bmdest</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">) &amp; @</font> <font color="#800000">bmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#0000ff">kill</font> <font color="#000000">: '</font> <font color="#0000ff">$ data</font> <font color="#000000">(@</font> <font color="#800000">bmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)) @</font> <font color="#800000">bmdest</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// bmdest = bmdest |</font>  <font color="#000080">bmsrc</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMOr (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">bmsrc</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">sub1</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">bmdest</font> <font color="#000000">@ (</font> <font color="#0000ff">$ char</font> <font color="#000000">(0)), - 1),</font> <font color="#800000">sub</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">bmsrc</font> <font color="#000000">@ (</font> <font color="#0000ff">$ char</font> <font color="#000000">(0)), - 1)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">:</font> <font color="#800000">sub</font> <font color="#000000">&lt;</font> <font color="#800000">sub1 sub</font> <font color="#000000">=</font> <font color="#800000">sub1</font> <font color="#800000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">ix</font> <font color="#000000">= 0: 1:</font> <font color="#800000">sub</font> <font color="#0000ff">set</font> <font color="#000000">:</font> <font color="#0000ff">$ data</font> <font color="#000000">(@</font> <font color="#800000">bmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)) @</font> <font color="#800000">bmdest</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">) =</font> <font color="#0000ff">$ select</font> <font color="#000000">(</font> <font color="#0000ff">$ data</font> <font color="#000000">(@</font> <font color="#800000">bmdest</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)):</font> <font color="#0000ff">$ bitlogic</font> <font color="#000000">(@</font> <font color="#800000">bmdest</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">) | @</font> <font color="#800000">bmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)), 1: @</font> <font color="#800000">bmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">Method</font> <font color="#000000">BMNot (</font> <font color="#ff00ff">bm</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">maxblk</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"EXIST"</font> <font color="#000000">,</font> <font color="#008000">""</font> <font color="#000000">), - 1),</font> <font color="#800000">blklen</font> <font color="#000000">=</font> <font color="#0000ff">$ bitcount</font> <font color="#000000">(@ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"EXIST"</font> <font color="#000000">,</font> <font color="#800000">maxblk</font> <font color="#000000">))</font> <font color="#000000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">maxblk</font> <font color="#000000">: -1: 0</font> <font color="#0000ff">set</font> <font color="#800000">blk</font> <font color="#000000">=</font> <font color="#0000ff">$ get</font> <font color="#000000">(@</font> <font color="#800000">bm</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#0000ff">set</font> <font color="#000000">:</font> <font color="#0000ff">$ bitcount</font> <font color="#000000">(</font> <font color="#800000">blk</font> <font color="#000000">) &lt;</font> <font color="#800000">blklen</font> <font color="#0000ff">$ bit</font> <font color="#000000">(</font> <font color="#800000">blk</font> <font color="#000000">,</font> <font color="#800000">blklen</font> <font color="#000000">) = 0</font> <font color="#0000ff">set</font> <font color="#000000">@</font> <font color="#800000">bm</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">) =</font> <font color="#0000ff">$ bitlogic</font> <font color="#000000">(~</font> <font color="#800000">blk</font> <font color="#000000">),</font> <font color="#800000">blklen</font> <font color="#000000">= ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#0000ff"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bm</font> <font color="#000000">,</font> <font color="#0000ff">$ name</font> <font color="#000000">(@ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"EXIST"</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// returns the number of single bits in the array</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMCount (</font> <font color="#ff00ff">bm</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000080">As% Integer</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#000000">,</font> <font color="#800000">bmcret</font> <font color="#000000">= 0</font> <font color="#000000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">bm</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">'= +</font> <font color="#800000">ix</font> <font color="#0000ff">set</font> <font color="#800000">bmcret</font> <font color="#000000">=</font> <font color="#800000">bmcret</font> <font color="#000000">+</font> <font color="#0000ff">$ bitcount</font> <font color="#000000">(@</font> <font color="#800000">bm</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">), 1)</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#800000">bmcret</font> <font color="#800000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbmsrc bitmap index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the value of the parameter is val</font> <font color="#000080"><br></font>  <font color="#000080">///</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMEq (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#000000">= @</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">val</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbmsrc bitmap index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is not equal to val</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMNe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMEq</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbmsrc</font> <font color="#000000">,</font> <font color="#800000">val</font> <font color="#000000">)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbmsrc bitmap index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is less (sorted to) val</font> <font color="#000080"><br></font>  <font color="#000080">/// bmdest: = U (vbmsrc (v): v &lt;val)</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMLt (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">val</font> <font color="#800000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">), - 1)</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#0000ff">$ name</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// similar to BMLt () but "less than or equal to"</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMLe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">value</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#000000">= @</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">val</font> <font color="#000000">)</font> <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">val</font> <font color="#800000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">), - 1)</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#0000ff">$ name</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// similar to BMLe, but "greater or equal"</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMGe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#000000">= @</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">val</font> <font color="#000000">)</font> <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">val</font> <font color="#800000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#0000ff">$ name</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// similarly, the value is greater than or equal to min and less than or equal to max</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMGeLe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">min</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">max</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#000000">= @</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">min</font> <font color="#000000">)</font> <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">min</font> <font color="#800000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">]]</font> <font color="#800000">max</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#0000ff">$ name</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// similar to BMGe (), but "strictly more"</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMGt (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">val</font> <font color="#800000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#0000ff">$ name</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// similarly, values ‚Äã‚Äãgreater than min and less than max</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMGtLt (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">min</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">max</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">min</font> <font color="#800000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">max</font> <font color="#000000">']]</font> <font color="#800000">ix</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#0000ff">$ name</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// similarly, the value is greater than or equal to min and less than max</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMGeLt (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">min</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">max</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#000000">= @</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">min</font> <font color="#000000">)</font> <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">min</font> <font color="#800000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">max</font> <font color="#000000">']]</font> <font color="#800000">ix</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#0000ff">$ name</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// similarly, values ‚Äã‚Äãare greater than min and less than or equal to max</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BMGtLe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbmsrc</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">min</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">max</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">min</font> <font color="#800000"><br></font>  <font color="#0000ff">for set</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">))</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">]]</font> <font color="#800000">max</font> <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#0000ff">$ name</font> <font color="#000000">(@</font> <font color="#800000">vbmsrc</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// Bit-Sliced ‚Äã‚ÄãData Operations</font> <font color="#000080"><br></font>  <font color="#000080">/// converts an integer value to a text bit string</font> <font color="#000080"><br></font>  <font color="#000080">/// {sign, 1,2,4, ..., 2 ** N}</font> <font color="#000080"><br></font>  <font color="#000080">ClassMethod</font> <font color="#000000">CvtToBin (</font> <font color="#ff00ff">value</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000080">As% String</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">value</font> <font color="#000000">=</font> <font color="#0000ff">$ fnumber</font> <font color="#000000">(+</font> <font color="#800000">value</font> <font color="#000000">,</font> <font color="#008000">""</font> <font color="#000000">, 0),</font> <font color="#800000">res</font> <font color="#000000">= (</font> <font color="#800000">value</font> <font color="#000000">&lt;0)</font> <font color="#000000"><br></font>  <font color="#0000ff">for quit</font> <font color="#000000">: '</font> <font color="#800000">value</font> <font color="#0000ff">set</font> <font color="#800000">res</font> <font color="#000000">=</font> <font color="#800000">res</font> <font color="#000000">_ (</font> <font color="#800000">value</font> <font color="#000000"># 2),</font> <font color="#800000">value</font> <font color="#000000">=</font> <font color="#800000">value</font> <font color="#000000">\ 2</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#800000">res</font> <font color="#800000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// converts the bit list $ lb (sign, 1,2,4, ... 2 ** N) into an integer</font> <font color="#000080"><br></font>  <font color="#000080">ClassMethod</font> <font color="#000000">CvtFromSlice (</font> <font color="#ff00ff">slice</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000080">As% Integer</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">res</font> <font color="#000000">= 0</font> <font color="#000000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">i</font> <font color="#000000">=</font> <font color="#0000ff">$ listlength</font> <font color="#000000">(</font> <font color="#800000">slice</font> <font color="#000000">): - 1: 2</font> <font color="#0000ff">set</font> <font color="#800000">res</font> <font color="#000000">=</font> <font color="#800000">res</font> <font color="#000000">+</font> <font color="#800000">res</font> <font color="#0000ff">set</font> <font color="#800000">res</font> <font color="#000000">=</font> <font color="#800000">res</font> <font color="#000000">+</font> <font color="#0000ff">$ listget</font> <font color="#000000">(</font> <font color="#800000">slice</font> <font color="#000000">,</font> <font color="#800000">i</font> <font color="#000000">, 0)</font> <font color="#000000"><br></font>  <font color="#0000ff">quit $ select</font> <font color="#000000">(</font> <font color="#0000ff">$ listget</font> <font color="#000000">(</font> <font color="#800000">slice</font> <font color="#000000">): -</font> <font color="#800000">res</font> <font color="#000000">, 1:</font> <font color="#800000">res</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// puts the bits from the pos position of the slbs vbs to the list ($ lb ())</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">GetSlice (</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">pos</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000080">As% String</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">sub</font> <font color="#000000">=</font> <font color="#800000">pos</font> <font color="#000000">\ ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">pos</font> <font color="#000000">-1 # ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">+1</font> <font color="#000000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">i</font> <font color="#000000">= 1: 1:</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#008000">""</font> <font color="#000000">), - 1)</font> <font color="#0000ff">set $ list</font> <font color="#000000">(</font> <font color="#800000">slice</font> <font color="#000000">,</font> <font color="#800000">i</font> <font color="#000000">) =</font> <font color="#0000ff">$ bit</font> <font color="#000000">(</font> <font color="#0000ff">$ get</font> <font color="#000000">(@</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#800000">i</font> <font color="#000000">,</font> <font color="#800000">sub</font> <font color="#000000">)),</font> <font color="#800000">ix</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#800000">slice</font> <font color="#800000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bestslay index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the value of the parameter is val</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSEq (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">bswork</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#0000ff">set</font> <font color="#800000">vbit</font> <font color="#000000">= ..</font> <font color="#0000ff">CvtToBin</font> <font color="#000000">(</font> <font color="#800000">val</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#000000">= @ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"EXIST"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">maxbit</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#008000">""</font> <font color="#000000">), - 1)</font> <font color="#0000ff">set</font> <font color="#000000">:</font> <font color="#800000">maxbit</font> <font color="#000000">&lt;</font> <font color="#0000ff">$ length</font> <font color="#000000">(</font> <font color="#800000">vbit</font> <font color="#000000">)</font> <font color="#800000">maxbit</font> <font color="#000000">=</font> <font color="#0000ff">$ length</font> <font color="#000000">(</font> <font color="#800000">vbit</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">ix</font> <font color="#000000">= 1: 1:</font> <font color="#800000">maxbit</font> <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bswork</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bswork</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)</font> <font color="#0000ff">do</font> <font color="#000000">: '</font> <font color="#0000ff">$ extract</font> <font color="#000000">(</font> <font color="#800000">vbit</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">) ..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bswork</font> <font color="#000000">)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">bswork</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bswork</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bestslay index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is greater than or equal to val</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSGe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BSLt</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val</font> <font color="#000000">), ..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">)</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bestslay index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is not equal to val</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSNe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BSEq</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val</font> <font color="#000000">), ..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bestslay index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the value of the parameter is greater than val</font> <font color="#000080"><br></font>  <font color="#000080">///</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSGt (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BSLe</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val</font> <font color="#000000">), ..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">)</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bestslay index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter sign is equal to sign (zero is considered positive)</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSSign (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">sign</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">bswork</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#800000"><br></font>  <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#000000">= @ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"EXIST"</font> <font color="#000000">), @</font> <font color="#800000">bswork</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (1)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">:</font> <font color="#0000ff">$ get</font> <font color="#000000">(</font> <font color="#800000">sign</font> <font color="#000000">) '&lt;0 ..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bswork</font> <font color="#000000">)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">bswork</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bswork</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bestslay index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is less than or equal to val</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSLe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">tmpLe</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BSLtAbs</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val</font> <font color="#000000">), ..</font> <font color="#0000ff">BSSign</font> <font color="#000000">(</font> <font color="#800000">tmpLe</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">, -1)</font> <font color="#000000"><br></font>  <font color="#0000ff">if</font> <font color="#800000">val</font> <font color="#000000">'&lt;0</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpLe</font> <font color="#000000">), ..</font> <font color="#0000ff">BSEq</font> <font color="#000000">(</font> <font color="#800000">tmpLe</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val</font> <font color="#000000">), ..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpLe</font> <font color="#000000">)</font> <font color="#0000ff">if</font> <font color="#000000">1</font> <font color="#000000"><br></font>  <font color="#0000ff">else do</font> <font color="#000000">..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">), ..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpLe</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">tmpLe</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bestslay index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is less than val</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSLt (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">tmpLt</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BSLtAbs</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val</font> <font color="#000000">), ..</font> <font color="#0000ff">BSSign</font> <font color="#000000">(</font> <font color="#800000">tmpLt</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">, -1)</font> <font color="#000000"><br></font>  <font color="#0000ff">if</font> <font color="#800000">val</font> <font color="#000000">'&lt;0</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpLt</font> <font color="#000000">)</font> <font color="#0000ff">if</font> <font color="#000000">1</font> <font color="#000000"><br></font>  <font color="#0000ff">ELSE do</font> <font color="#000000">..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">), ..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpLt</font> <font color="#000000">), ..</font> <font color="#0000ff">BSNe</font> <font color="#000000">(</font> <font color="#800000">tmpLt</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val</font> <font color="#000000">), ..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpLt</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">tmpLt</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bestslay index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is greater than or equal to val1 and less than or equal to val2</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSGeLe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val1</font> <font color="#000080">As% Integer</font> <font color="#000000">,</font> <font color="#ff00ff">val2</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">tmpGeLe</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BSGe</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val1</font> <font color="#000000">), ..</font> <font color="#0000ff">BSLe</font> <font color="#000000">(</font> <font color="#800000">tmpGeLe</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val2</font> <font color="#000000">), ..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpGeLe</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">tmpGeLe</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bit-slice index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is greater than or equal to val1 and less than val2</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSGeLt (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val1</font> <font color="#000080">As% Integer</font> <font color="#000000">,</font> <font color="#ff00ff">val2</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">tmpGeLt</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BSGe</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val1</font> <font color="#000000">), ..</font> <font color="#0000ff">BSLt</font> <font color="#000000">(</font> <font color="#800000">tmpGeLt</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val2</font> <font color="#000000">), ..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpGeLt</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">tmpGeLt</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bestslay index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is greater than val1 and less than or equal to val2</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSGtLe (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val1</font> <font color="#000080">As% Integer</font> <font color="#000000">,</font> <font color="#ff00ff">val2</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">tmpGtLe</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BSGt</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val1</font> <font color="#000000">), ..</font> <font color="#0000ff">BSLe</font> <font color="#000000">(</font> <font color="#800000">tmpGtLe</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val2</font> <font color="#000000">), ..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpGtLe</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">tmpGtLe</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bit-slice index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the parameter value is greater than val1 and less than val2</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSGtLt (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val1</font> <font color="#000080">As% Integer</font> <font color="#000000">,</font> <font color="#ff00ff">val2</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">tmpGtLt</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BSGt</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val1</font> <font color="#000000">), ..</font> <font color="#0000ff">BSLt</font> <font color="#000000">(</font> <font color="#800000">tmpGtLt</font> <font color="#000000">,</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">val2</font> <font color="#000000">), ..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">tmpGtLt</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">tmpGtLt</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// places in the bmdest bitmap a sample of the vbs bit-slice index,</font> <font color="#000080"><br></font>  <font color="#000080">/// where the value of the parameter in absolute value is less than val</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSLtAbs (</font> <font color="#ff00ff">bmdest</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">val</font> <font color="#000080">As% Integer</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">bswork</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">(),</font> <font color="#800000">test</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#0000ff">set</font> <font color="#800000">vbit</font> <font color="#000000">= ..</font> <font color="#0000ff">CvtToBin</font> <font color="#000000">(</font> <font color="#800000">val</font> <font color="#000000">),</font> <font color="#800000">ixmax</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#008000">""</font> <font color="#000000">), - 1)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">test</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">test</font> <font color="#000000">= @ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"EXIST"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">if</font> <font color="#800000">ixmax</font> <font color="#000000">&lt;</font> <font color="#0000ff">$ length</font> <font color="#000000">(</font> <font color="#800000">vbit</font> <font color="#000000">)</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bmdest</font> <font color="#000000">= @</font> <font color="#800000">test</font> <font color="#800000"><br></font>  <font color="#800080">}</font> <font color="#0000ff">else</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">for</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#800000">ixmax</font> <font color="#000000">: -1: 2</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bswork</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">bswork</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bswork</font> <font color="#000000">), ..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">bswork</font> <font color="#000000">,</font> <font color="#800000">test</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">:</font> <font color="#0000ff">$ extract</font> <font color="#000000">(</font> <font color="#800000">vbit</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">) ..</font> <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">bmdest</font> <font color="#000000">,</font> <font color="#800000">bswork</font> <font color="#000000">), ..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bswork</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">test</font> <font color="#000000">,</font> <font color="#800000">bswork</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#800080">}</font> <font color="#800080"><br></font>  <font color="#800080">}</font> <font color="#800080"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">test</font> <font color="#000000">@</font> <font color="#800000">bswork</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// grouping functions for bit-slips</font> <font color="#000080"><br></font>  <font color="#000080">/// returns the maximum value (with the optional parameter</font> <font color="#000080"><br></font>  <font color="#000080">/// bsmin '= 0 - minimum) for sampling a bitmap from the vbs bit-time-index</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSMax (</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">bitmap</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">bsmin</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000080">As% Integer</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">bsmin</font> <font color="#000000">= ''</font> <font color="#0000ff">$ get</font> <font color="#000000">(</font> <font color="#800000">bsmin</font> <font color="#000000">),</font> <font color="#800000">bswork</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">resBSM</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">(),</font> <font color="#800000">tmpBSM</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">resBSM</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (1)</font> <font color="#0000ff">do</font> <font color="#000000">: '</font> <font color="#800000">bsmin</font> <font color="#000000">..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">resBSM</font> <font color="#000000">)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">resBSM</font> <font color="#000000">,</font> <font color="#800000">bitmap</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">if</font> <font color="#000000">..</font> <font color="#0000ff">BMCount</font> <font color="#000000">(</font> <font color="#800000">resBSM</font> <font color="#000000">)</font> <font color="#0000ff">set</font> <font color="#800000">min</font> <font color="#000000">= 0</font> <font color="#000000"><br></font>  <font color="#0000ff">ELSE set</font> <font color="#800000">min</font> <font color="#000000">= 1</font> <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">resBSM</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">resBSM</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (1)</font> <font color="#0000ff">do</font> <font color="#000000">:</font> <font color="#800000">bsmin</font> <font color="#000000">..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">resBSM</font> <font color="#000000">)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">resBSM</font> <font color="#000000">,</font> <font color="#800000">bitmap</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">ix</font> <font color="#000000">=</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#008000">""</font> <font color="#000000">), - 1): - 1: 2</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">tmpBSM</font> <font color="#000000">, @</font> <font color="#800000">bswork</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">tmpBSM</font> <font color="#000000">= @</font> <font color="#800000">resBSM</font> <font color="#000000">, @</font> <font color="#800000">bswork</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">:</font> <font color="#800000">min</font> <font color="#000000">..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">bswork</font> <font color="#000000">)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">tmpBSM</font> <font color="#000000">,</font> <font color="#800000">bswork</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">if</font> <font color="#000000">..</font> <font color="#0000ff">BMCount</font> <font color="#000000">(</font> <font color="#800000">tmpBSM</font> <font color="#000000">)</font> <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">resBSM</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">resBSM</font> <font color="#000000">= @</font> <font color="#800000">tmpBSM</font> <font color="#800000"><br></font>  <font color="#800080">}</font> <font color="#800080"><br></font>  <font color="#0000ff">set</font> <font color="#800000">pos</font> <font color="#000000">= ..</font> <font color="#0000ff">BMOrder</font> <font color="#000000">(</font> <font color="#800000">resBSM</font> <font color="#000000">, 0)</font> <font color="#0000ff">quit</font> <font color="#000000">: '</font> <font color="#800000">pos</font> <font color="#000000">0</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">val</font> <font color="#000000">= ..</font> <font color="#0000ff">CvtFromSlice</font> <font color="#000000">(..</font> <font color="#0000ff">GetSlice</font> <font color="#000000">(</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">pos</font> <font color="#000000">))</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bswork</font> <font color="#000000">, @</font> <font color="#800000">resBSM</font> <font color="#000000">, @</font> <font color="#800000">tmpBSM</font> <font color="#0000ff">quit</font> <font color="#800000">val</font> <font color="#800000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">Method</font> <font color="#000000">BSMin (</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">bitmap</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000080">As% Integer</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#000000">..</font> <font color="#0000ff">BSMax</font> <font color="#000000">(</font> <font color="#800000">vbs</font> <font color="#000000">,</font> <font color="#800000">bitmap</font> <font color="#000000">, 1)</font> <font color="#000000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// returns the sum of values ‚Äã‚Äãfor sampling a bitmap from a vbs bit-time-index</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">BSSum (</font> <font color="#ff00ff">vbs</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">bitmap</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000080">As% Integer</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">bswork</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">(),</font> <font color="#800000">resBSSum</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">(),</font> <font color="#800000">tmpBSSum</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">resBSSum</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (1)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMNot</font> <font color="#000000">(</font> <font color="#800000">resBSSum</font> <font color="#000000">), ..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">resBSSum</font> <font color="#000000">,</font> <font color="#800000">bitmap</font> <font color="#000000">)</font> <font color="#0000ff">set</font> <font color="#800000">slice</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#008000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">ix</font> <font color="#000000">= 2: 1:</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#008000">""</font> <font color="#000000">), - 1)</font> <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">tmpBSSum</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">tmpBSSum</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">tmpBSSum</font> <font color="#000000">,</font> <font color="#800000">resBSSum</font> <font color="#000000">)</font> <font color="#0000ff">set $ list</font> <font color="#000000">(</font> <font color="#800000">slice</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">) = ..</font> <font color="#0000ff">BMCount</font> <font color="#000000">(</font> <font color="#800000">tmpBSSum</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">val</font> <font color="#000000">= ..</font> <font color="#0000ff">CvtFromSlice</font> <font color="#000000">(</font> <font color="#800000">slice</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">resBSSum</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">resBSSum</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (1)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">resBSSum</font> <font color="#000000">,</font> <font color="#800000">bitmap</font> <font color="#000000">)</font> <font color="#0000ff">set</font> <font color="#800000">slice</font> <font color="#000000">=</font> <font color="#008000">""</font> <font color="#008000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">ix</font> <font color="#000000">= 2: 1:</font> <font color="#0000ff">$ order</font> <font color="#000000">(@</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#008000">""</font> <font color="#000000">), - 1)</font> <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">tmpBSSum</font> <font color="#0000ff">merge</font> <font color="#000000">@</font> <font color="#800000">tmpBSSum</font> <font color="#000000">= @</font> <font color="#800000">vbs</font> <font color="#000000">@ (</font> <font color="#800000">ix</font> <font color="#000000">)</font> <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">tmpBSSum</font> <font color="#000000">,</font> <font color="#800000">resBSSum</font> <font color="#000000">)</font> <font color="#0000ff">set $ list</font> <font color="#000000">(</font> <font color="#800000">slice</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">) = ..</font> <font color="#0000ff">BMCount</font> <font color="#000000">(</font> <font color="#800000">tmpBSSum</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">val</font> <font color="#000000">=</font> <font color="#800000">val</font> <font color="#000000">- ..</font> <font color="#0000ff">CvtFromSlice</font> <font color="#000000">(</font> <font color="#800000">slice</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#000000">@</font> <font color="#800000">bswork</font> <font color="#000000">, @</font> <font color="#800000">resBSSum</font> <font color="#000000">, @</font> <font color="#800000">tmpBSSum</font> <font color="#0000ff">quit</font> <font color="#800000">val</font> <font color="#800000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// methods to fill in bitmap and bitlist indexes</font> <font color="#000080"><br></font>  <font color="#000080">///</font> <font color="#000080"><br></font>  <font color="#000080">/// sets the corresponding bit in the bitmap index</font> <font color="#000080"><br></font>  <font color="#000080">/// of the given value of this property</font> <font color="#000080"><br></font>  <font color="#000080">/// with optional parameter setexist = 1 also sets the bit to</font> <font color="#000080"><br></font>  <font color="#000080">/// bitmap index of existing records (necessary for correct</font> <font color="#000080"><br></font>  <font color="#000080">/// work method BMNot ())</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">SetBitMap (</font> <font color="#ff00ff">idfact</font> <font color="#000080">As% Integer</font> <font color="#000000">,</font> <font color="#ff00ff">property</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">value</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">setexist</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">idf0</font> <font color="#000000">=</font> <font color="#800000">idfact</font> <font color="#000000">-1 \ ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">,</font> <font color="#800000">idf1</font> <font color="#000000">=</font> <font color="#800000">idfact</font> <font color="#000000">-1 # ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">+1</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">:</font> <font color="#0000ff">$ get</font> <font color="#000000">(</font> <font color="#800000">setexist</font> <font color="#000000">)</font> <font color="#0000ff">$ bit</font> <font color="#000000">(@ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"EXIST"</font> <font color="#000000">,</font> <font color="#800000">idf0</font> <font color="#000000">),</font> <font color="#800000">idf1</font> <font color="#000000">) = 1</font> <font color="#000000"><br></font>  <font color="#0000ff">set $ bit</font> <font color="#000000">(@ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"I"</font> <font color="#000000">,</font> <font color="#800000">property</font> <font color="#000000">,</font> <font color="#800000">value</font> <font color="#000000">,</font> <font color="#800000">idf0</font> <font color="#000000">),</font> <font color="#800000">idf1</font> <font color="#000000">) = 1</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// sets the corresponding bit in the bit-slice index</font> <font color="#000080"><br></font>  <font color="#000080">/// of the given value of this property.</font> <font color="#000080"><br></font>  <font color="#000080">/// Optional setexist parameter - similar to SetBitMap () method</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">SetBitSlice (</font> <font color="#ff00ff">idfact</font> <font color="#000080">As% Integer</font> <font color="#000000">,</font> <font color="#ff00ff">property</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">value</font> <font color="#000080">As% Integer</font> <font color="#000000">,</font> <font color="#ff00ff">setexist</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">idf0</font> <font color="#000000">=</font> <font color="#800000">idfact</font> <font color="#000000">-1 \ ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">,</font> <font color="#800000">idf1</font> <font color="#000000">=</font> <font color="#800000">idfact</font> <font color="#000000">-1 # ..</font> <font color="#0000ff">#MAXBITLENGTH</font> <font color="#000000">+1</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">:</font> <font color="#0000ff">$ get</font> <font color="#000000">(</font> <font color="#800000">setexist</font> <font color="#000000">)</font> <font color="#0000ff">$ bit</font> <font color="#000000">(@ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"EXIST"</font> <font color="#000000">,</font> <font color="#800000">idf0</font> <font color="#000000">),</font> <font color="#800000">idf1</font> <font color="#000000">) = 1</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">v</font> <font color="#000000">= ..</font> <font color="#0000ff">CvtToBin</font> <font color="#000000">(+</font> <font color="#800000">value</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">ix</font> <font color="#000000">= 1: 1:</font> <font color="#0000ff">$ length</font> <font color="#000000">(</font> <font color="#800000">v</font> <font color="#000000">)</font> <font color="#0000ff">set</font> <font color="#000000">:</font> <font color="#0000ff">$ extract</font> <font color="#000000">(</font> <font color="#800000">v</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">)</font> <font color="#0000ff">$ bit</font> <font color="#000000">(@ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"S"</font> <font color="#000000">,</font> <font color="#800000">property</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">,</font> <font color="#800000">idf0</font> <font color="#000000">),</font> <font color="#800000">idf1</font> <font color="#000000">) = 1</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// returns the name of the index global subnode containing</font> <font color="#000080"><br></font>  <font color="#000080">/// bitmap-index (if slice = 0 or not defined) or bit-slice (ghb slice '= 0)</font> <font color="#000080"><br></font>  <font color="#000080">/// for this property.</font>  <font color="#000080">If property is empty or undefined -</font> <font color="#000080"><br></font>  <font color="#000080">/// then the bitmap index of existing records</font> <font color="#000080"><br></font>  <font color="#000080">Method</font> <font color="#000000">GetBitMapName (</font> <font color="#ff00ff">property</font> <font color="#000080">As% String</font> <font color="#000000">,</font> <font color="#ff00ff">slice</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000080">As% String</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">quit</font> <font color="#000000">:</font> <font color="#0000ff">$ get</font> <font color="#000000">(</font> <font color="#800000">property</font> <font color="#000000">) =</font> <font color="#008000">""</font> <font color="#0000ff">$ name</font> <font color="#000000">(@ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#008000">"EXIST"</font> <font color="#000000">))</font> <font color="#000000"><br></font>  <font color="#0000ff">quit $ name</font> <font color="#000000">(@ (..</font> <font color="#0000ff">BMGLOB</font> <font color="#000000">) @ (</font> <font color="#0000ff">$ select</font> <font color="#000000">(+</font> <font color="#0000ff">$ get</font> <font color="#000000">(</font> <font color="#800000">slice</font> <font color="#000000">):</font> <font color="#008000">"S"</font> <font color="#000000">, 1:</font> <font color="#008000">"I"</font> <font color="#000000">),</font> <font color="#800000">property</font> <font color="#000000">))</font> <font color="#000000"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// demo fill and sample</font> <font color="#000080"><br></font>  <font color="#000080">///</font> <font color="#000080"><br></font>  <font color="#000080">ClassMethod</font> <font color="#000000">Populate (</font> <font color="#ff00ff">count</font> <font color="#000080">As% String</font> <font color="#000000">=</font> <font color="#000080">10000</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">= ..</font> <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">BMGLOB</font> <font color="#000000">=</font> <font color="#0000ff">$ name</font> <font color="#000000">(^ BMI)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">count</font> <font color="#000000">=</font> <font color="#0000ff">$ get</font> <font color="#000000">(</font> <font color="#800000">count</font> <font color="#000000">, 10000),</font> <font color="#800000">m</font> <font color="#000000">= 0</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">names</font> <font color="#000000">=</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(</font> <font color="#008000">"SantaClause"</font> <font color="#000000">,</font> <font color="#008000">"Crocodile"</font> <font color="#000000">,</font> <font color="#008000">"Simba"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">colors</font> <font color="#000000">=</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(</font> <font color="#008000">"Cyan"</font> <font color="#000000">,</font> <font color="#008000">"Magenta"</font> <font color="#000000">,</font> <font color="#008000">"Yellow"</font> <font color="#000000">,</font> <font color="#008000">"Black"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">if $ sortbegin</font> <font color="#000000">(^ BMI)</font> <font color="#000000"><br></font>  <font color="#0000ff">for</font> <font color="#800000">idfact</font> <font color="#000000">= 1: 1:</font> <font color="#800000">count</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">set</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#0000ff">$ list</font> <font color="#000000">(</font> <font color="#800000">names</font> <font color="#000000">, 1 +</font> <font color="#0000ff">$ random</font> <font color="#000000">(</font> <font color="#0000ff">$ listlength</font> <font color="#000000">(</font> <font color="#800000">names</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">color</font> <font color="#000000">=</font> <font color="#0000ff">$ list</font> <font color="#000000">(</font> <font color="#800000">colors</font> <font color="#000000">, 1 +</font> <font color="#0000ff">$ random</font> <font color="#000000">(</font> <font color="#0000ff">$ listlength</font> <font color="#000000">(</font> <font color="#800000">colors</font> <font color="#000000">)))</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">length</font> <font color="#000000">= 10 +</font> <font color="#0000ff">$ random</font> <font color="#000000">(90)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">weight</font> <font color="#000000">= (10+</font> <font color="#0000ff">$ random</font> <font color="#000000">(40)) * 100</font> <font color="#000000"><br></font>  <font color="#008000">;</font>  <font color="#008000">for color we create bitmap index</font> <font color="#008000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">SetBitMap</font> <font color="#000000">(</font> <font color="#800000">idfact</font> <font color="#000000">,</font> <font color="#008000">"C"</font> <font color="#000000">,</font> <font color="#800000">color</font> <font color="#000000">, 1)</font> <font color="#000000"><br></font>  <font color="#008000">;</font>  <font color="#008000">for weight and length create bit-slides indices</font> <font color="#008000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">SetBitSlice</font> <font color="#000000">(</font> <font color="#800000">idfact</font> <font color="#000000">,</font> <font color="#008000">"L"</font> <font color="#000000">,</font> <font color="#800000">length</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">SetBitSlice</font> <font color="#000000">(</font> <font color="#800000">idfact</font> <font color="#000000">,</font> <font color="#008000">"W"</font> <font color="#000000">,</font> <font color="#800000">weight</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#008000">;</font>  <font color="#008000">to check the test sample (see below) we consider</font> <font color="#008000"><br></font>  <font color="#008000">;</font>  <font color="#008000">total weight of black and yellow crocodiles 45-70 cm long</font> <font color="#008000"><br></font>  <font color="#008000">;</font>  <font color="#008000">inclusive</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">: ((</font> <font color="#800000">color</font> <font color="#000000">=</font> <font color="#008000">"Black"</font> <font color="#000000">)! (</font> <font color="#800000">color</font> <font color="#000000">=</font> <font color="#008000">"Yellow"</font> <font color="#000000">)) &amp; (</font> <font color="#800000">length</font> <font color="#000000">'&lt;45) &amp; (</font> <font color="#800000">length</font> <font color="#000000">'&gt; 70)</font> <font color="#800000">m</font> <font color="#000000">=</font> <font color="#800000">m</font> <font color="#000000">+</font> <font color="#800000">weight</font> <font color="#800000"><br></font>  <font color="#800080">}</font> <font color="#800080"><br></font>  <font color="#0000ff">if $ sortend</font> <font color="#000000">(^ BMI)</font> <font color="#000000"><br></font>  <font color="#0000ff">write</font> <font color="#800000">m</font> <font color="#000000">_</font> <font color="#008000">"gramms total",!</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#800000">ix</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000080">/// test sample</font> <font color="#000080"><br></font>  <font color="#000080">ClassMethod</font> <font color="#000000">TestGetData ()</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">= ..</font> <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">BMGLOB</font> <font color="#000000">=</font> <font color="#0000ff">$ name</font> <font color="#000000">(^ BMI)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">b</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">(),</font> <font color="#800000">b1</font> <font color="#000000">= ..</font> <font color="#0000ff">GetNewTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">BMEq</font> <font color="#000000">(</font> <font color="#800000">b</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">.</font> <font color="#0000ff">GetBitMapName</font> <font color="#000000">(</font> <font color="#008000">"C"</font> <font color="#000000">),</font> <font color="#008000">"Black"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">BMEq</font> <font color="#000000">(</font> <font color="#800000">b1</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">.</font> <font color="#0000ff">GetBitMapName</font> <font color="#000000">(</font> <font color="#008000">"C"</font> <font color="#000000">),</font> <font color="#008000">"Yellow"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">BMOr</font> <font color="#000000">(</font> <font color="#800000">b</font> <font color="#000000">,</font> <font color="#800000">b1</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">BSGeLe</font> <font color="#000000">(</font> <font color="#800000">b1</font> <font color="#000000">,</font> <font color="#800000">ix</font> <font color="#000000">.</font> <font color="#0000ff">GetBitMapName</font> <font color="#000000">(</font> <font color="#008000">"L"</font> <font color="#000000">, 1), 45.70)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">BMAnd</font> <font color="#000000">(</font> <font color="#800000">b</font> <font color="#000000">,</font> <font color="#800000">b1</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">count</font> <font color="#000000">=</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">BMCount</font> <font color="#000000">(</font> <font color="#800000">b</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">write</font> <font color="#800000">count</font> <font color="#000000">_</font> <font color="#008000">"items selected",!</font> <font color="#000000"><br></font>  <font color="#008000">;</font>  <font color="#008000">determine the total weight of the selected</font> <font color="#008000"><br></font>  <font color="#0000ff">write</font> <font color="#800000">ix</font> <font color="#000000">.</font>  <font color="#0000ff">BSSum</font> <font color="#000000">(</font> <font color="#800000">ix</font> <font color="#000000">.</font> <font color="#0000ff">GetBitMapName</font> <font color="#000000">(</font> <font color="#008000">"W"</font> <font color="#000000">, 1),</font> <font color="#800000">b</font> <font color="#000000">) _</font> <font color="#008000">"gramms total",!</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">KillAllTMP</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">kill</font> <font color="#800000">ix</font> <font color="#0000ff">quit</font> <font color="#0000ff"><br></font>  <font color="#000000">}</font> <font color="#000000"><br><br></font>  <font color="#000000">}</font> </div></div><br>  The <a href="http://yadi.sk/d/LKbjrbL85LETv">attached code</a> contains a complete set of functions for developing a data warehouse using bitmap indexes and bitslices in classes and routines, supporting all the required manipulations with these structures.  Also included is a demonstration method for filling the test repository with data, during which the value of the grouping function is calculated directly - the sum for the subsequent test request: <br><br>  <font color="#0000ff">do</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">User.BitMapSlice</font> <font color="#000000">).</font>  <font color="#0000ff">Populate</font> <font color="#000000">(1,000,000)</font> <font color="#008000">;</font>  <font color="#008000">million records</font> <br><br>  and a method for executing this test query, in which the value of the same grouping function is computed using bitslices: <br><br>  <font color="#0000ff">do</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">User.BitMapSlice</font> <font color="#000000">).</font>  <font color="#0000ff">TestGetData</font> <font color="#000000">()</font> <br><br>  You can compare the result and the time spent on getting it. <br><br>  For those who are accustomed to the abbreviated COS syntax, I recall that Cach√© Studio, starting with version 5.2, allows you to <a href="">easily convert the</a> selected code fragment from the full form to the abbreviated form - <b>Ctrl-Shift-E</b> and back - <b>Ctrl-E</b> . <br>  In conclusion, you need to comment on one subtlety.  It is recommended to build intermediate and resulting bitmap indices for sampling in globals with ^ CacheTemp or ^ mtemp prefixes.  Such globals are physically located in the CACHETEMP database and due to the fact that <a href="">they are not logged</a> , which we have no need for, <i>work with them is more productive than even with local variables.</i>  <i>The use of local variables for this purpose is also undesirable for another reason - the possibility of resting on the 16-megabyte memory limit of the user process.</i> <br><blockquote>  The <i>italicized</i> note does not apply to newer versions of the Cach√© DBMS: <ol><li>  <a href="">Large local arrays</a> </li><li>  <a href="">Extended memory</a> </li><li>  <a href="">Unlimited Local Arrays</a> </li></ol></blockquote>  The code described in this article owes its appearance to the information kindly provided by InterSystems at one of the presentations of the DeepSee product, and was subsequently applied by MakovaSoft in its Orthofact data storage. </div><p>Source: <a href="https://habr.com/ru/post/174657/">https://habr.com/ru/post/174657/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../174643/index.html">Cyberbunker vs Spamhaus</a></li>
<li><a href="../174647/index.html">Wrapper Interceptor Library</a></li>
<li><a href="../174649/index.html">Habr's export to FB2</a></li>
<li><a href="../174651/index.html">Bitcoin: How to get 25+ Mhash / s for free without SMS</a></li>
<li><a href="../174655/index.html">Versioned data storage in Cach√© Persistent classes</a></li>
<li><a href="../174661/index.html">Simultaneous work of several Android on one device</a></li>
<li><a href="../174667/index.html">New Facebook home on Android: April 4</a></li>
<li><a href="../174669/index.html">April 12-13 on Strike! in Ulyanovsk</a></li>
<li><a href="../174671/index.html">Dual core brain</a></li>
<li><a href="../174673/index.html">Control of inventory in systems 1C</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>