<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Website monitoring with Google Docs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Digital Inspirations blog author Amid Agarwal (Amit Agarwal) has published a script for Google Docs, which polls the status of the site and puts the a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Website monitoring with Google Docs</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/0b0/ce7/9ac/0b0ce79acce9fc6f8a4dd7dafeb84b43.png"><br><br>  Digital Inspirations blog author Amid Agarwal (Amit Agarwal) has published a <a href="http://ctrlq.org/code/19030-google-apps-script-website-monitor">script</a> for Google Docs, which polls the status of the site and puts the answer in a table cell.  Thus, you can make a monitoring service yourself.  Google Docs allows you to run the script at one minute intervals and receive notifications by email. <br><a name="habracut"></a><br>  The instruction is as follows: copy <a href="https://docs.google.com/spreadsheet/ccc%3Fkey%3D0Aofk8L6brI_edDBrWTh1T05zWkxyS1hUMFZWSXJYMEE%26newcopy%3Dtrue">this document to</a> yourself, enter the monitoring URL in cell E3 and your email address in cell E5, then set the minute trigger to execute the script in Tools ‚Üí Script Editor ‚Üí Resources ‚Üí Current Script's Triggers. <br><br><img src="https://habrastorage.org/storage2/8f5/67e/edf/8f567eedf711b278e139c96e52939442.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When you try to save a trigger, a large red warning will appear with a request for authorization. <br><br>  <a href="http://ctrlq.org/code/19030-google-apps-script-website-monitor">Script code</a> <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** Monitor your Site's Uptime **/</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isMySiteDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Get the URL of the Website to monitor var url = SpreadsheetApp.getActiveSheet().getRange("E3").getValue(); // HTTP Response Code of the last server request if (!ScriptProperties.getProperty("status")) { ScriptProperties.setProperty("status", 200); } var response, error; try { // Fetch the web page using UrlFetchApp response = UrlFetchApp.fetch(url); } catch(error) { insertData(error, -1, "Website down"); return; } var code = response.getResponseCode(); // code = 200 means the fetch request was successful if (code == 200) insertData("Up", code, "Website up"); else insertData(response.getContent()[0], code, "Website down"); } function insertData(error, code, msg) { // Ignore if the error message is logged already if (ScriptProperties.getProperty("status") == code) return; // Log the server error in a Google Sheet var sheet = SpreadsheetApp.getActiveSheet(); var email = sheet.getRange("E5").getValue(); var row = sheet.getLastRow() + 1; sheet.getRange(row,1).setValue(new Date()); sheet.getRange(row,2).setValue(error); sheet.getRange(row,3).setValue(code); // Send an email alert for the downtime ScriptProperties.setProperty("status", code); MailApp.sendEmail(email, msg, error); }</span></span></code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/141686/">https://habr.com/ru/post/141686/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141681/index.html">Podcast "Notes on Qt" - first, pilot, release</a></li>
<li><a href="../141682/index.html">Google Blogger allows you to upload pictures directly from a webcam</a></li>
<li><a href="../141683/index.html">Guess the news</a></li>
<li><a href="../141684/index.html">Breaking the bank in the style of smash the stack!</a></li>
<li><a href="../141685/index.html">Preventing accidents in Google‚Äôs autonomous cars</a></li>
<li><a href="../141687/index.html">Meet Parallax Scrolling</a></li>
<li><a href="../141688/index.html">Dropbox chat</a></li>
<li><a href="../141690/index.html">Load Testing with Visual Studio 2010</a></li>
<li><a href="../141691/index.html">Practical use of a thermistor with Arduino</a></li>
<li><a href="../141692/index.html">What part of your life does a computer take?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>