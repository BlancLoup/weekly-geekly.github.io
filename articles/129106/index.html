<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zoomify: Looking for the whole picture</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many of you used Google or Yandex maps to view satellite images of the earth, but not many thought about how these data are stored on servers, because...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zoomify: Looking for the whole picture</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/a7be0a21/136c7c7a/1eb5314e/f1d845aa.png"><br><br>  Many of you used Google or Yandex maps to view satellite images of the earth, but not many thought about how these data are stored on servers, because if the user downloaded even individual photos, he would need a very impressive channel.  Therefore, these images are processed and cut into separate small pieces. <br><br>  In this topic, I will talk about one of the implementations and how to glue the Zoomify image so that it is immediately clear what is being said, you can follow the link: <a href="http://www.zoomify.com/assets/dynamic/urlDrivenWebPageAnyViewer.htm%3FZoomifyViewer.swf%3FzoomifyImagePath%3D../../images/folders/2DollarBill">$ 2</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      About half a year ago, I wrote a utility for converting a picture into a Zoomify image, even though there was a free proprietary utility at that time, and Photoshop has this functionality, but it required batch processing, sending via ftp and some other features.  After some time I needed to do the inverse functionality, this is what this topic will be about. <br><br><a name="habracut"></a><br><h2>  Why do you need it? </h2><br>  The link above pointed to a page with a picture of 2 dollars, I glued this image and the size turned out to be more than 100 megabytes (7500 x 6500 pixels), of course, I did not squeeze it, but in any case the size will be impressive.  I think that few could wait for the download of this image, especially if they do not need super detailing or are just interested in some piece.  With satellite maps everything is much sadder, for example, the size of Minsk is more than 4 GB (I don‚Äôt remember the exact figure, Google‚Äôs cache was once saved on the hard drive without a maximum increase). <br><br>  I will talk about how to glue the picture, but as you can see, the inverse actions are completely based on the algorithms that will be described later with an example implementation in C #. <br><br><h2>  How it works? </h2><br>  In order not to stretch the article, I will immediately begin to describe the implementation mixed with theory.  We launch Fiddler and go to the page with two dollars (I cleared the browser cache so that the files are downloaded over the network again and displayed in Fiddler). <br><br><img src="https://habrastorage.org/storage1/766a7bc0/d18ffb30/ac655c88/9359449a.png"><br><br>  The picture shows that the page is loaded, after which the flash application (ZoomifyViewer.swf) and ImageProperties.xml for the 2DollarBill image is loaded.  All images are stored in separate folders on the server, so ImageProperties.xml is always called the same.  Flash viewer loads the file ImageProperties.xml, after which it begins to load the pieces.  What does it contain that he immediately knows what to ship? <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">IMAGE_PROPERTIES</font> <font color="#ff0000">WIDTH</font> <font color="#0000ff">="7500"</font> <font color="#ff0000">HEIGHT</font> <font color="#0000ff">="6500"</font> <font color="#ff0000">NUMTILES</font> <font color="#0000ff">="1052"</font> <font color="#ff0000">NUMIMAGES</font> <font color="#0000ff">="1"</font> <font color="#ff0000">VERSION</font> <font color="#0000ff">="1.8"</font> <font color="#ff0000">TILESIZE</font> <font color="#0000ff">="256"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  As you can see, there is not a single link to the pictures, although the viewer has loaded more than ten pictures.  Let's sort the parameters in order: <br><br>  WIDTH = "7500" - the width of the source image <br>  HEIGHT = "6500" - the height of the original image <br>  NUMTILES = "1052" - the number of the resulting pieces <br>  NUMIMAGES = "1" - the number of images <br>  VERSION = "1.8" - version <br>  TILESIZE = "256" - the size of the piece <br><br><img src="https://habrastorage.org/storage1/d849241a/55cc1312/64a556c6/895fda4c.png"><br><br>  How these parameters can bring us closer to the links you ask.  Here the most interesting begins: <br>  TileGroup0 is a folder, as soon as 256 files appear in the folder, a new folder is created (TileGroup1, etc.) <br>  0-0-0.jpg - the first zero is the level (the minimum picture that fits in 256 * 256), the second and third are the array (the column and the line respectively, as in most programming languages, the numbering starts from zero) <br><br><img src="https://habrastorage.org/storage1/6ee18c88/c6d4cf6f/78171600/9d57ad8c.png"><br><img src="https://habrastorage.org/storage1/e40d4650/f194d505/bbda5559/7ca5697a.png"><br><br><h2>  Algorithm </h2><br>  We calculate how many times you need to reduce the image so that it fits into the square of 256 * 256, for this we divide the original image by 2. As a result, we get 234 * 203 pixels and the level is 6. Here the viewer window is quite large, so the third level was taken at once, and the first went to the navigation.  We need to immediately take the maximum level, divide the image into pieces and start downloading them, after which we can glue them together and enjoy the result. <br><br><h2>  Total </h2><br>  As it seems to me, I described everything in some detail, in addition I attach the code, so there should be no questions.  In any case, I will be glad to answer your questions, if any.  Under the debugger, I looked at quite a few sites and from the larger principles are the same everywhere with a few amendments, but I think that now you know where to dig. <br><br>  Project for Visual Studio 2010, C # implementation language: <a href="">download</a> <br><br><h2>  Links </h2><br>  <a href="http://www.zoomify.com/">Official site</a> <br>  <a href="http://ecommons.cornell.edu/bitstream/1813/5410/1/Introducing_Zoomify_Image.pdf">The document, which contains the theory and reference to the Python generation generation</a> <br></div><p>Source: <a href="https://habr.com/ru/post/129106/">https://habr.com/ru/post/129106/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../129098/index.html">HTC Hero - restoration of normal operation of the touch glass</a></li>
<li><a href="../129101/index.html">Why WiMax and LTE use OFDM</a></li>
<li><a href="../129102/index.html">Site for launching a little-known product on the market</a></li>
<li><a href="../129103/index.html">Meeting with Opera staff in Moscow</a></li>
<li><a href="../129105/index.html">FreeRTOS: introduction</a></li>
<li><a href="../129107/index.html">Django and Selenium Integration</a></li>
<li><a href="../129109/index.html">Dynamic applications with Ocsigen or Yob returns</a></li>
<li><a href="../129111/index.html">Daily Sales - aggregator of discount offers from Chinese online stores</a></li>
<li><a href="../129114/index.html">Cheap and fast usability testing</a></li>
<li><a href="../129117/index.html">Flood-it game automation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>