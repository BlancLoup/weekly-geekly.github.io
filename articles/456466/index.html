<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PHP generics today (well, almost)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you ask PHP developers what opportunity they want to see in PHP, most would call generics. 


 Generic language support would be the best solution....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PHP generics today (well, almost)</h1><div class="post__text post__text-html js-mediator-article"><p>  If you ask PHP developers what opportunity they want to see in PHP, most would call generics. </p><br><p>  Generic language support would be the best solution.  But it is <a href="https://www.youtube.com/watch%3Fv%3DteKnckg5x7I%26feature%3Dyoutu.be%26t%3D1121">difficult to</a> implement them.  We hope that one day the native support will become part of the language, but it is likely that this will have to wait several years. </p><br><p>  This article will show how, using existing tools, in some cases with minimal modifications, we can get the power of generics in PHP right now. </p><a name="habracut"></a><br><blockquote>  From the translator: I deliberately use tracing from English "generics", because  I have never heard anyone communicate that he called it "generalized programming." </blockquote><br><h2 id="soderzhanie">  Content: </h2><br><ul><li>  What are generics? </li><li>  How to implement generics without language support </li><li>  Standardization </li><li>  Tool support </li><li>  Support for third-party code </li><li>  Further steps </li><li>  Restrictions </li><li>  Why don't you just add generics to the language? </li><li>  What if I don't need generics? </li></ul><br><h2 id="chto-takoe-dzheneriki">  What are generics? </h2><br><p>  This section covers a brief introduction to <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D0%25BE%25D0%25B1%25D1%2589%25D1%2591%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">generics</a> . </p><br><p>  Links to read: </p><br><ul><li>  <a href="https://wiki.php.net/rfc/generics">RFC</a> on adding PHP generics </li><li>  <a href="https://github.com/phan/phan/wiki/Generic-Types">Phan</a> generic support </li><li>  Generics and <a href="https://psalm.dev/docs/templated_annotations/">Patterns</a> in Psalm </li></ul><br><h3 id="prosteyshiy-primer">  Simplest example </h3><br><p>  Since it is currently not possible to define generics at the language level, we will have to use another great opportunity - to define them in docblocks. </p><br><p>  We already use this option in a variety of projects.  Take a look at this example: </p><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string[] $names * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> User[] */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createUsers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(iterable $names)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span><span class="hljs-function"> </span></span>{ ... }</code> </pre> <br><p>  In the code above, we do what is possible at the language level.  We have defined the <code>$names</code> parameter as something that can be listed.  We also indicated that the function will return an array.  PHP will throw a <code>TypeError</code> if the parameter types and return value do not match. </p><br><p>  Dokblok improves understanding of the code.  <code>$names</code> must be strings, and the function must return an array of <code>User</code> objects.  PHP itself does not make such checks.  But IDE, such as PhpStorm, understand this notation and warn the developer that the additional contract is not respected.  In addition to this, static analysis tools such as Psalm, PHPStan and Phan can validate the correctness of the transferred data to and from the function. </p><br><h3 id="dzheneriki-dlya-opredeleniya-klyuchey-i-znacheniy-perechislyaemyh-tipov">  Generics for defining keys and values ‚Äã‚Äãof enumerated types </h3><br><p>  The above is the simplest example of a generic.  More sophisticated methods include the ability to specify the type of its keys, along with the type of values.  Below is one of the ways of this description: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> array&lt;string, User&gt; */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span><span class="hljs-function"> </span></span>{ ... }</code> </pre> <br><p>  It says that the array returned by the <code>getUsers</code> function has string keys and values ‚Äã‚Äãof type <code>User</code> . </p><br><p>  Static analyzers such as Psalm, PHPStan and Phan understand this annotation and will take it into account when checking. </p><br><p>  Consider the following code: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> array&lt;string, User&gt; */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span><span class="hljs-function"> </span></span>{ ... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showAge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $age)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ ... } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(getUsers() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $name =&gt; $user) { showAge($name); }</code> </pre> <br><p>  Static analyzers will throw a warning on the <code>showAge</code> call with an error like this: <code>Argument 1 of showAge expects int, string provided</code> . </p><br><p>  Unfortunately, at the time of writing, PhpStorm does not know how. </p><br><h3 id="bolee-slozhnye-dzheneriki">  More complicated generics </h3><br><p>  We continue to delve into the topic of generics.  Consider an object representing a <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2582%25D0%25B5%25D0%25BA">stack</a> : </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Stack</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($item)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ ... } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ... } }</code> </pre> <br><p>  The stack can accept any type of object.  But what if we want to limit the stack to only <code>User</code> objects? </p><br><p>  Psalm and Phan support the following annotations: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@template</span></span></span><span class="hljs-comment"> T */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Stack</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> T $item */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($item)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> T */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br><p>  A dockblock is used to transfer additional information about types, for example: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> Stack&lt;User&gt; $userStack */</span></span> $stack = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Stack(); Means that $userStack must only contain Users.</code> </pre> <br><p>  Psalm, when analyzing the following code: </p><br><pre> <code class="php hljs">$userStack-&gt;push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User()); $userStack-&gt;push(<span class="hljs-string"><span class="hljs-string">"hello"</span></span>);</code> </pre> <br><p>  Will complain about line 2 with the error <code>Argument 1 of Stack::push expects User, string(hello) provided.</code> </p><br><p>  Currently PhpStorm does not support this annotation. </p><br><p>  In fact, we have covered only some of the information on generics, but for now, that‚Äôs sufficient. </p><br><h2 id="kak-vnedrit-dzheneriki-bez-podderzhki-yazyka">  How to implement generics without language support </h2><br><p>  You must perform the following steps: </p><br><ul><li>  At the community level, define generic standards in docblocks (for example, a new PSR, or go back to PSR-5) </li><li>  Add docblock annotations to code </li><li>  Use IDEs that understand this notation to perform real-time static analysis to find inconsistencies. </li><li>  Use static analysis tools (such as Psalm) as one of the CI steps to catch errors. </li><li>  Define a method for passing information about types in third-party libraries. </li></ul><br><h2 id="standartizaciya">  Standardization </h2><br><p>  At the moment, the PHP community has unofficially adopted this generic format (they are supported by most tools and their meaning is clear to most): </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> User[] */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span><span class="hljs-function"> </span></span>{ ... }</code> </pre> <br><p>  However, we have problems with simple examples, like this: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> array&lt;string, User&gt; */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span><span class="hljs-function"> </span></span>{ ... }</code> </pre> <br><p>  Psalm understands it, and knows what type the key has and the value of the returned array. </p><br><p>  At the time of writing, PhpStorm does not understand this.  Using this entry, I miss the power of real-time static analysis offered by PhpStorm. </p><br><p>  Consider the code below.  PhpStorm does not understand that <code>$user</code> is of type <code>User</code> , and <code>$name</code> is string: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(getUsers() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $name =&gt; $user) { ... }</code> </pre> <br><p>  If I chose Psalm as a static analysis tool, I could write the following: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> User[] * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@psalm</span></span></span><span class="hljs-comment">-return array&lt;string, User&gt; */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span><span class="hljs-function"> </span></span>{ ... }</code> </pre> <br><p>  Psalm understands all this. </p><br><p>  PhpStorm knows that the <code>$user</code> variable is of type <code>User</code> .  But, he still does not understand that the array key refers to the string.  Phan and PHPStan do not understand the psalm specific annotations.  The maximum that they understand in this code is the same as in PhpStorm: the type of <code>$user</code> </p><br><p>  You can argue that PhpStorm just needs to accept the agreement <code>array&lt;keyType, valueType&gt;</code> .  I do not agree with you, because  I believe that this dictation of standards is the task of the language and the community, and the tools only have to follow them. </p><br><p>  I assume that the agreement described above will be warmly welcomed by most of the PHP community.  The one that is interested in generics.  However, things get much more complicated when it comes to patterns.  Currently neither PHPStan nor PhpStorm support templates.  Unlike Psalm and Phan.  Their purpose is similar, but if you dig deeper, you will realize that the implementations are a little different. </p><br><p>  Each of the options presented is a kind of compromise. </p><br><p>  Simply put, there is a need for an agreement on the format of the generic drugs: </p><br><ul><li>  They improve the lives of developers.  Developers can add generics to their code and benefit from it. </li><li>  Developers can use the tools they like best and switch between them (tools) as needed. </li><li>  The creators of the tools can create these very tools, realizing the benefits to the community and not fearing that something will change, or that they will be accused of "the wrong approach." </li></ul><br><h2 id="podderzhka-instrumentami">  Tool support </h2><br><p>  Psalm has all the necessary functionality to test generics.  Phan is kind of like, too. </p><br><p>  I‚Äôm sure PhpStorm will implement generics as soon as the single format agreement appears in the community. </p><br><h2 id="podderzhka-storonnego-koda">  Support for third-party code </h2><br><p>  The final part of the generics puzzle is the addition of support for third-party libraries. </p><br><p>  Hopefully, as soon as the standard for the definition of generics appears, most libraries will implement it.  However, this will not happen immediately.  Some libraries are used, but have no active support.  When using static analyzers for type validation in generics, it is important that all functions that accept or return these generics are defined. </p><br><p>  What happens if your project relies on the work of third-party libraries that do not have generic support? </p><br><p>  Fortunately, this problem has already been solved, and the solutions are stub functions.  Psalm, <a href="https://github.com/phan/phan/wiki/How-To-Use-Stubs">Phan</a> and <a href="https://github.com/JetBrains/phpstorm-stubs/tree/master/standard">PhpStorm</a> support stubs. </p><br><p>  Stubs are ordinary files that contain the signatures of functions and methods, but do not implement them.  By adding docblocks to the stubs, the static analysis tools get the additional information they need.  For example, if you have a stack class without taypkhintov and generics, like this. </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Stack</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($item)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* some implementation */</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* some implementation */</span></span> } }</code> </pre> <br><p>  You can create a stub file that has identical methods, but with the addition of docblocks and without implementing functions. </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@template</span></span></span><span class="hljs-comment"> T */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Stack</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> T $item * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($item)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> T */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br><p>  When a static analyzer sees a stack class, it takes type information from the stub, rather than from the actual code. </p><br><p>  The ability to simply share the stub code (for example, through the composer) would be extremely useful, since  would allow to share the work done. </p><br><h2 id="dalneyshie-shagi">  Further steps </h2><br><p>  The community needs to move away from agreements and define standards. </p><br><p>  Maybe the best option would be a PSR about generics? </p><br><p>  Or, perhaps, the creators of the basic static analyzers, PhpStorm, other IDEs, and some of the people involved in the development of PHP (for control) could develop a standard that everyone would use. </p><br><p>  As soon as the standard appears, everyone will be able to help with adding generics to existing libraries and projects, creating pull requests.  And where this is not possible, developers can write and share stubs. </p><br><p>  When everything is done, we will be able to use tools like PhpStorm to test generics in real time while we are writing code.  We can use static analysis tools as part of our CI as a security guarantee. </p><br><p>  In addition, generics can be implemented in PHP (well, almost). </p><br><h2 id="ogranicheniya">  Restrictions </h2><br><p>  There are a number of restrictions.  PHP is a dynamic language that allows you to do many "magical" things, such as <a href="https://www.youtube.com/watch%3Fv%3DRfXO5Y-QqPo">these</a> .  If you use too much PHP magic, it may happen that static analyzers cannot accurately extract all types in the system.  If any types are unknown, then the tools will not be able to correctly use generics in all cases. </p><br><p>  However, the main use of this analysis is to test your business logic.  If you are writing clean code, then you should not use too much magic. </p><br><h2 id="pochemu-by-vam-prosto-ne-dobavit-dzheneriki-v-yazyk">  Why don't you just add generics to the language? </h2><br><p>  That would be the best option.  PHP has open source code, and no one bothers you to clone sources and implement generics! </p><br><h2 id="chto-esli-mne-ne-nuzhny-dzheneriki">  What if I don't need generics? </h2><br><p>  Just ignore the above.  One of the main advantages of PHP is that it is flexible in choosing the right level of implementation complexity depending on what you create.  With a one-time code, you don‚Äôt need to think about things like tyinghinting.  But in large projects it is worth using such opportunities. </p><br><blockquote>  Thanks to all who read to this place.  I will be glad to your comments on drugs. </blockquote></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/456466/">https://habr.com/ru/post/456466/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456450/index.html">DO-RA.Avia for monitoring cosmic radiation in aviation</a></li>
<li><a href="../456452/index.html">C ++ code examples before and after Ranges</a></li>
<li><a href="../456454/index.html">A review of the new javascript framework Htmlix</a></li>
<li><a href="../45646/index.html">Boyan instead of lowering karma</a></li>
<li><a href="../456462/index.html">Building a library of angular components in the form of web components</a></li>
<li><a href="../45647/index.html">Botnets returned to service</a></li>
<li><a href="../456470/index.html">Pitfalls WSUS Package Publisher</a></li>
<li><a href="../456472/index.html">Introduction to Go and Mggo Framework</a></li>
<li><a href="../456474/index.html">Comparison: Svelte and React</a></li>
<li><a href="../45648/index.html">Rails. Rating system. Plugins</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>