<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zend Framework of the first freshness, part 1: we are rending MVC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I was disbanded here at the request of Dean, and I decided to benefit society. Since I am a fool and I do not know how, let me think I will write abou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zend Framework of the first freshness, part 1: we are rending MVC</h1><div class="post__text post__text-html js-mediator-article">  <i>I was disbanded here at the request of Dean, and I decided to benefit society.</i>  <i>Since I am a fool and I do not know how, let me think I will write about ZF - an awesome thing that for some reason everyone sincerely hates.</i>  <i>It is necessary to have time, however, until Pelevin was shown on NTV (unfortunately not real).</i> <br><br>  The main problem with all kinds of QS is that they are really quick and really start, but if you do everything there, you‚Äôll end up with a not-so-scalable application that‚Äôs not very clear what to do.  Compared to the official quickstart of the previous version of Zend Framework, the <a href="http://framework.zend.com/docs/quickstart">new one is</a> just great, but not without flaws.  I will go from the other end: instead of explaining how to do something meaningless and typical, I will try (!) To tell you how to write an application in general, using Zend Framework in various ways.  And it is time to do habrakat. <br><a name="habracut"></a><br>  <a href="http://framework.zend.com/">Zend Framework</a> is a magical and happy PHP framework for real men (;-)).  For me, ZF is the only opportunity to write a easily-written, scalable and quite accompanying web application in a very short time (6 hours is easily done without much effort authorization set + registration + posts + tape + tree comments + tea + coffee + dance), favorably differing from solutions, where in general almost nothing needs to be done (Wordpress, Drupal, ...) because the programmer does not impose anything at all: ZF, in principle, is a set of interrelated classes: you can use only those that you want, keeping that style razra  bots that you like best.  You do not want to use Zend_Auth for authorization?  And who forbids you to write your something?  ;) At the same time, it is beautifully and very logically built (all sorts of classes, parentes, interfaces, all garbage): it is convenient to rewrite it, for example, simply by inheriting some of your own class from the standard Zendovsky and adding what you want to finish writing (just not arrange in the comments of the holivars "ZF against something. Please, do not arrange at all). <br><br>  Aha  So, what we will have will be (I hope) difficult, but logical and more or less beautiful: it will be easy to finalize and easy to understand where we have what.  I am an idiot and amateur, and therefore I can‚Äôt claim that all my moves are really reasonable, correct and that I use all the possibilities: I will say ‚Äúthank you‚Äù for valuable advice, additions, refutations and so on.  Oh yeah, and I think that one article here is not limited to.  Moreover, the first may seem rather trivial, then wait for the second 8) Specifically, in this one I will talk about working with Zend's MVC implementation, later I will stick to it, but I hope not to forget about the workers who don‚Äôt like it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I decided to repeat: ‚ÄúI'm not a hacker, I'm just learning.‚Äù  Do you know better?  Let's rewrite this / write the following article together so that it is even cooler ;-) <br><br>  <i>And yes, I love you very much, but in the comments you will point out grammatical or punctuation errors or typos in the code - Nasru into karma.</i>  <i>Write in habraposhta.</i>  <i>No one needs these temporary fixes looming under the article that cannot be removed.</i> <br><br>  Go! <br><br>  The first step is to <a href="http://framework.zend.com/download/latest">download the</a> ZF, and then run through the <a href="http://framework.zend.com/docs/quickstart">quikstart</a> , at least until ‚ÄúCreate a Configuration and Registry‚Äù.  Then some kind of garbage comes with SQLite (I‚Äôll never understand the sense of skylight), and then Zend_Form is used in general (I‚Äôm against this kind of entertainment, bitch - we‚Äôll write all html with pens or ask the web designers, if you want, nothing complicated there).  From the skeleton that you succeed, we will dance. <br><br>  So, we have something like the following (which is not - leave it, if something extra - well, figure out what to do with it): <br><pre> + application /
   + config /
     * app.ini
   + controllers /
     * IndexController.php
	 * ErrorController.php
   + layouts /
	 + scripts /
	   * layout.html
	 + helpers /
   + models /
	 + dbtable /
	 * SuperModel.php
   + views /
     + scripts /
	   + index /
	     * index.phtml
       + error /
	     * error.phtml
	 + helpers /
   * routes.php [1]
   * bootstrap.php
 + library / // [2]
   + zend /
	 // tru la la ...
 + public / (he's htdocs / for me, but it doesn't matter)
   + static /
     // [3]
   * index.php
</pre><br><br>  [1] - in this file are all routes.  It is then included in bootstrap.php (after qs the routes should go in the bootstrap itself, but usually I get a lot of them) <br>  [2] - I would take this folder to a higher level, that is, say, if you have it all in /home/va1en0k/coolsite.ru/, then why not keep the libraries in / home / va1en0k / library / instead of / home / va1en0k / coolsite.ru / library /: it will be easier for the rest of the programs to reach them <br>  [3] - there will be different cool CSS, JS files, pictures - all canoe.  They can be spread by styles /, images /, can be transferred to some other server, no one forces them to keep them here: HTML, we write all <br><br>  Everything is quite simple, the usual MVC.  The algorithm for writing a program like this (it is somewhat different from the ‚Äúdevelopment through testing‚Äù, which everyone loves so much, but, in principle, you can arrange tests of the type, controller, and model before / after / during their development): <br><ol><li>  First of all, we need something that happens during a certain user action: the designer asked us about it or something else there; </li><li>  Action is always a url challenge.  We come up with an url (it can be any, but we all are very happy with urls of the form / ‚Äúcontroller_name‚Äù / ‚Äúaction_name‚Äù. But, let's say, to get a post, it's better to have something like this: / post / 12321, isn't it?), We decide how it will be processed by the controller (none does not fit? We create a new one in / application / controllers /), we add an action to this controller; </li><li>  We create /views/scripts/ controller controller name / action_name.phtml, draw the html we need there; <br><ul><li>  Where you need to display something that is not displayed on other pages, we write: &lt;? = $ This-&gt; shachlo?&gt;, Write down or remember what we need; </li><li>  Where it is necessary to display something that is displayed a lot where, for example, the name of a user, we write something like &lt;? = $ This-&gt; printUser ($ this-&gt; user)?&gt;; </li></ul><br></li><li>  Now we go and create all the helpers we need (helpers are functions that are called like this: &lt;? = $ This-&gt; printUser ($ this-&gt; user)?&gt;).  We write them in / views / helpers /.  It is better to make them separately so that at any time you can add an icon to the names of users or apply some other style.  Or replace them all with the word SCHACO, so that all users simply ohreneli with surprise!  %) </li><li>  Jumping up with happiness, we write an action.  The whole action code can (why not) be divided into 3 parts: <br><ul><li>  We deal with the arguments: get the data from the forms or from the URL there (if the URL was / user / 12345); </li><li>  We do what is required of the action: we launch a rocket into space or send a message to the taxi driver on a pager.  If we need data from the database, or if we need data from some Last.fm or Twitter, or some other data ‚Äî any at all ‚Äî ask for a model.  If the model [for now] does not know how to issue, we ask as if it can: $ this-&gt; m-&gt; twitter-&gt; getUser (‚Äúva1ka‚Äù);  or is there $ this-&gt; m-&gt; getUsersTable () -&gt; getUser ("va1en0k");  - as you wish, request; </li><li>  We give the view all that he asked in step 3: $ this-&gt; view-&gt; shachlo = "popyachtsa";  etc.; </li></ul></li><li>  We add to the model everything we asked for in the previous step. </li></ol><br><br>  This algorithm is almost universal (if we need what happens in any action of the user, we must act a little differently), and I recommend sticking to it as clearly as possible.  Why first view, and then the rest?  Well, for two reasons, firstly, 37signals are advised this way, and secondly, this is the most reasonable way to understand what we need and how to receive.  It is important to make sure that all requests to the data go only encapsulated through the model: then, luck, we can in case of something leave the database without looking at another or add a nice cache that speeds up our program, like resetting a stepped module.  It is important to ensure that all HTML, well, that is, very, very all, goes through views or layouts in folders, in helpers, or just like that. <br><br>  And now specifically for the three whales MVC. <br><br><h5>  View </h5><br>  As I have eloquently hinted, there should be all the whole HTML in the views.  Any errors, anything, that's all that happens in the controller and - even more so - in the model should be devoid of tags and be a bare line.  Any output constants (I mean, for example, taglines or ‚ÄúError! The user name must be up to 25 characters! Kill yourself!‚Äù) Should also be stored in view. <br><br>  How to do it?  Helpers rush to the rescue!  Create a helper (an amazing code goes on, which is not a fact that it is worth using as is, but, in principle, there is nothing absolutely awful in it. Just think for yourself how you want to organize what is happening): <br><pre> class Zend_View_Helper_Errors extends Zend_View_Helper_Abstract {
	 public function errors ($ err) {
		 if (! sizeof ($ err)) return '';<font></font>
		<font></font>
		 $ html = '&lt;div class = "errors"&gt;';<font></font>
		<font></font>
		 foreach ($ err as $ er)
			 $ html. = '&lt;p&gt;'.  AppErrors :: getErrorString ($ er). '&lt;/ P&gt;';<font></font>
		<font></font>
		 $ html. = '&lt;/ div&gt;';<font></font>
		<font></font>
		 return $ html;
	 }
 }
</pre><br>  And also a class with a static method: <br><pre> class AppErrors {
	 static function getErrorString ($ er) {
	   // return the string.  We take it from somewhere: an array there or a database or somewhere else, translate, if necessary, via Zend_Translate and return
	 }
 }
</pre><br><br>  The $ err itself, the helper argument, is an array of "errors."  An error can be encoded simply by a number of some, and maybe even an array, say, array ('err_id' =&gt; 666, 'err_arg' =&gt; 'satan'), if the error has arguments%) Well, or even an object, whom far fantasy perverted. <br><br><h5>  Controller </h5><br>  The controller consists of actions.  Actions are the backbone (just like in a structural-functional sociology based on an integration approach) application.  This is how an ideal request from a program designer to a programmer looks like: ‚ÄúCome on, if you press this button, this and that will happen‚Äù.  Here, ‚Äúthis and that‚Äù are actions (to whom do I explain this?). <br><br>  Before producing packs of controllers, I suggest making a cunning move: create our own front and action controllers and inherit them from them.  Then, in which case, we will be able, for example, to prohibit visiting any pages without entering the site (as in the leper colony, for example), set various variables necessary for action controllers, and so on: <br><pre> class SchachloFrontController extends Zend_Front_Controller {
	 // </pre>  here we do not forget to overload getInstance (), as the doctor <a href="http://framework.zend.com/manual/en/zend.controller.front.html">prescribed for</a> us <pre> } // don't forget to change bootstrap.php!
 class SchachloActionController extends Zend_Action_Controller {
	 // in my opinion, it‚Äôs not necessary to overload%)
 } // and inherit all the action controllers from it (these are the ones in / application / controllers /
</pre><br><br>  Well, then everything is more or less clear.  I advise as much as possible to break the code down into small functions, shoving them into the model or leaving to the share of helpers (both view helpers and action helpers).  And do not forget: any data should be received in the model, even your grandmother's middle name%) Although not, its better to be in the config if only your grandmother is needed. <br><br><h5>  Model </h5><br>  With the model, in fact, I have the most doubt because of inexperience.  Well, I personally usually do this: <br>  For each data type I create labels in the database.  There for the post, for comments, all the cases.  If the data type has an array variable (for example, tags for a post), for it, the stump is clear, a separate label.  Then for each tablet I create in / application / models / DbTable / my own file.  Well, the main file is SuperModel.php - in which our lovely Angelina Jolie, who returns all the labels (which are stored in static variables) by their methods.  Similarly, I shove the necessary classes next to work with the file system or external data sources (I recently worked with last.fm, with the help of Zend_Rest_Client without any pressure at all), and I shove methods into the supermodel to get them. <br><br>  So, if I suddenly need to find out something, I‚Äôm looking at how many data sources it is.  If one label: I add a method to its own class.  If there is one tablet and several more for it (like, we get a post from a posts table and tags to it from tags, etc.), then that too.  And if we need 2 or more more or less equal tables, I put the method in the model, but I organize work with each of the participating tables in it. <br><br>  What else to say?  Oh yes.  Do not forget about cash.  You can add a cache snoop to each method, or you can take 2 models at once: one will be as described above, and the other will call the first through the cache, at the same time turning it off when it is not needed at all.  I‚Äôll probably write about the cache if I‚Äôm not banned again.  : D <br><br>  Phew  Like 13 kilobytes, and not very much and told.  Amateur, what could be here!  Waiting for your feedback. </div><p>Source: <a href="https://habr.com/ru/post/52108/">https://habr.com/ru/post/52108/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../52098/index.html">Objective-J, MacOS technology on the web</a></li>
<li><a href="../52100/index.html">Information banditry</a></li>
<li><a href="../52105/index.html">Belarusian colleagues "colleague" - I cried all</a></li>
<li><a href="../52106/index.html">QA Bonus for MMO Development</a></li>
<li><a href="../52107/index.html">How to avoid a zoo or give users working buttons ...</a></li>
<li><a href="../52110/index.html">Planning paradigm and free swimming</a></li>
<li><a href="../52111/index.html">Data model as a bridge between data and user interface</a></li>
<li><a href="../52114/index.html">There is an idea and a prototype - feedback is needed.</a></li>
<li><a href="../52116/index.html">/ 3GB / Userva = 2900</a></li>
<li><a href="../52117/index.html">Working quality</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>