<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A new version of LinqTestable has been released - libraries for testing requests to the database via ORM</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="LinqTestable is a library that helps to overcome in tests a conceptual gap between OOP and a relational database arising from the difference in NULL b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A new version of LinqTestable has been released - libraries for testing requests to the database via ORM</h1><div class="post__text post__text-html js-mediator-article">  LinqTestable is a library that helps to overcome in tests a conceptual gap between OOP and a relational database arising from the difference in NULL behavior in these two paradigms.  For example, comparing NULL == NULL returns true in object languages, and false in the relational model.  In addition, NULL.SomeField will return NULL in the relational model and throw a NullReferenceException in C #.  LinqTestable is designed to solve this problem. <br><br><img src="https://habrastorage.org/files/766/fac/30e/766fac30ef764c5aac471c89d7cb47d7.jpg"><br><a name="habracut"></a><br><br>  I‚Äôll say right away that the library is not yet fully prepared, but in principle it is already possible to use it.  I am currently working on processing OrderBy correctly. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To demonstrate the capabilities of the library that are currently ready, I will give examples of some unit tests, which can also be viewed in the <a href="https://github.com/FiresShadow/LinqTestable">source code of the</a> library. <br><br><h4>  <b>Eliminate NullRefenceException</b> </h4><br><br>  The following example demonstrates how to eliminate the problem of throwing a NullRefenceException at the time of a call to null.DOOR_ID;  instead, it returns null correctly. <br><div class="spoiler">  <b class="spoiler_title">Test code</b> <div class="spoiler_text"><pre><code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">TestFixture</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TwoLeftJoins</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteTwoLeftJoins</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isSmart</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dataModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TestDataModel {Settings = {IsSmart = isSmart}}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> carId = <span class="hljs-number"><span class="hljs-number">100</span></span>; dataModel.CAR.AddObject(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CAR{CAR_ID = carId}); dataModel.CAR.AddObject(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CAR{CAR_ID = carId + <span class="hljs-number"><span class="hljs-number">1</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cars = (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> car <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dataModel.CAR <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> door <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dataModel.DOOR <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> car.CAR_ID <span class="hljs-keyword"><span class="hljs-keyword">equals</span></span> door.CAR_ID <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> joinedDoor <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> door <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> joinedDoor.DefaultIfEmpty() <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> doorHandle <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dataModel.DOOR_HANDLE <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> door.DOOR_ID <span class="hljs-keyword"><span class="hljs-keyword">equals</span></span> doorHandle.DOOR_ID <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> joinedDoorHandle <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> doorHandle <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> joinedDoorHandle.DefaultIfEmpty() <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> car).ToList(); Assert.AreEqual(<span class="hljs-number"><span class="hljs-number">2</span></span>, cars.Count); Assert.AreEqual(carId, cars.First().CAR_ID); } [Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TwoLeftJoinsShouldThrow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Assert.Throws&lt;NullReferenceException&gt;(() =&gt; ExecuteTwoLeftJoins(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)); } [Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SmartTwoLeftJoinsShouldNotThrow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ExecuteTwoLeftJoins(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); } }</code> </pre> <br></div></div><br><br>  To prevent a NullReferenceException, you could manually add a null check to the code, but in this case, you risk getting another SQL and a query execution plan that is different from the original one.  I wrote about this in the <a href="http://habrahabr.ru/post/269917/">last article devoted to this library</a> . <br><br>  A case similar to the previous one, however, this time NullReferenceException is prevented when Nullable accesses Value: <br><div class="spoiler">  <b class="spoiler_title">Test code</b> <div class="spoiler_text"><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">TestFixture</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Contains</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteContains</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isSmart</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dataModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TestDataModel { Settings = { IsSmart = isSmart } }; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DOOR_HANDLE {DOOR_HANDLE_ID = <span class="hljs-number"><span class="hljs-number">1</span></span>, MATERIAL_ID = <span class="hljs-number"><span class="hljs-number">1</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DOOR_HANDLE {DOOR_HANDLE_ID = <span class="hljs-number"><span class="hljs-number">2</span></span>, MATERIAL_ID = <span class="hljs-number"><span class="hljs-number">2</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DOOR_HANDLE {DOOR_HANDLE_ID = <span class="hljs-number"><span class="hljs-number">3</span></span>, MATERIAL_ID = <span class="hljs-literal"><span class="hljs-literal">null</span></span>} } .ForEach(dataModel.DOOR_HANDLE.AddObject); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doorHandleIds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;{<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doorHandles = (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> doorHandle <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dataModel.DOOR_HANDLE <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> doorHandleIds.Contains(doorHandle.MATERIAL_ID.Value) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> doorHandle).ToList(); Assert.AreEqual(<span class="hljs-number"><span class="hljs-number">2</span></span>, doorHandles.Count); } [Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContainsShouldFail</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Assert.Throws&lt;InvalidOperationException&gt;(() =&gt; ExecuteContains(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)); } [Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SmartContainsShouldSuccess</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ExecuteContains(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); } }</code> </pre><br></div></div><br><br><h4>  <b>Sum correct behavior</b> </h4><br><br>  The Sum method behaves differently in the database and in C # above the list of data.  In the case of a sum from an empty sample, the database returns NULL, and 0 is returned in C #. If the field to which the result of the sum is transferred was not Nullable &lt;&gt;, then ORM throws an exception.  When using LinqTestable, Sum will either return NULL or throw an exception, just as if you were using the database: <br><div class="spoiler">  <b class="spoiler_title">Test code</b> <div class="spoiler_text"><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">TestFixture</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SumFromEmptyTable</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteSumFromEmptyTable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isSmart</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dataModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TestDataModel {Settings = {IsSmart = isSmart}}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = dataModel.CAR.Sum(x =&gt; x.CAR_ID); } [Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SmartSumShouldThrow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Assert.Throws&lt;InvalidOperationException&gt;(() =&gt; ExecuteSumFromEmptyTable(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)); } [Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SumShouldNotThrow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ExecuteSumFromEmptyTable(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteNullableSumFromEmptyTable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isSmart</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dataModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TestDataModel { Settings = { IsSmart = isSmart } }; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>? sum = dataModel.DOOR_HANDLE.Sum(x =&gt; x.MATERIAL_ID); Assert.AreEqual(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, sum); } [Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NullableSumShouldFail</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Assert.Throws&lt;AssertionException&gt;(() =&gt; ExecuteNullableSumFromEmptyTable(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)); } [Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NullableSmartSumShouldSuccess</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ExecuteNullableSumFromEmptyTable(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); } }</code> </pre><br></div></div><br><br><h4>  <b>Comparison null == null</b> </h4><br><br>  When using LinqTestable, null == null will mean false unless you explicitly make a comparison of something with null in the query, just as if you were making a query to the database: <br><div class="spoiler">  <b class="spoiler_title">Test code</b> <div class="spoiler_text"><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">TestFixture</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">NullComparison</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteNullComparison</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isSmart</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dataModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TestDataModel { Settings = { IsSmart = isSmart } }; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DOOR_HANDLE {DOOR_HANDLE_ID = <span class="hljs-number"><span class="hljs-number">1</span></span>, MATERIAL_ID = <span class="hljs-number"><span class="hljs-number">1</span></span>, MANUFACTURER_ID = <span class="hljs-number"><span class="hljs-number">1</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// &lt;---- new DOOR_HANDLE {DOOR_HANDLE_ID = 2, MATERIAL_ID = 2, MANUFACTURER_ID = 2}, // |-- this is only pair new DOOR_HANDLE {DOOR_HANDLE_ID = 3, MATERIAL_ID = 1, MANUFACTURER_ID = 1}, // &lt;---- new DOOR_HANDLE {DOOR_HANDLE_ID = 4, MATERIAL_ID = 5, MANUFACTURER_ID = null}, new DOOR_HANDLE {DOOR_HANDLE_ID = 5, MATERIAL_ID = 5, MANUFACTURER_ID = null}, new DOOR_HANDLE {DOOR_HANDLE_ID = 6, MATERIAL_ID = null, MANUFACTURER_ID = null}, new DOOR_HANDLE {DOOR_HANDLE_ID = 7, MATERIAL_ID = null, MANUFACTURER_ID = null} } .ForEach(x =&gt; dataModel.DOOR_HANDLE.AddObject(x)); var handlePairsWithSameMaterialAndManufacturer = (from handle in dataModel.DOOR_HANDLE join anotherHandle in dataModel.DOOR_HANDLE on handle.MATERIAL_ID equals anotherHandle.MATERIAL_ID where handle.MANUFACTURER_ID == anotherHandle.MANUFACTURER_ID &amp;&amp; handle.DOOR_HANDLE_ID &lt; anotherHandle.DOOR_HANDLE_ID select new {handle, anotherHandle}).ToList(); Assert.AreEqual(1, handlePairsWithSameMaterialAndManufacturer.Count); var pair = handlePairsWithSameMaterialAndManufacturer.First(); Assert.AreEqual(1, pair.handle.MATERIAL_ID); Assert.AreEqual(pair.handle.MATERIAL_ID, pair.anotherHandle.MATERIAL_ID); Assert.AreEqual(1, pair.handle.MANUFACTURER_ID); Assert.AreEqual(pair.handle.MANUFACTURER_ID, pair.anotherHandle.MANUFACTURER_ID); } [Test] public void NullComparisonShouldFail() { Assert.Throws&lt;AssertionException&gt;(() =&gt; ExecuteNullComparison(false)); } [Test] public void SmartNullComparisonShouldSuccess() { ExecuteNullComparison(true); } }</span></span></code> </pre><br></div></div><br><br><h4>  <b>How to start using</b> </h4><br><br>  The library refers to free software and is supplied ‚Äúas is‚Äù (as is, no warranty).  You can download via Nuget. <br><br><img src="https://habrastorage.org/files/7fd/e1a/6ef/7fde1a6ef3ef4392be38219a1f20be17.png"><br><br>  After connecting the library, replace in your test ObjectSet the implementation of the Expression and Provider properties with: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> System.Linq.Expressions.Expression Expression { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _collection.AsQueryable&lt;T&gt;().ToTestable().Expression; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IQueryProvider Provider { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _collection.AsQueryable&lt;T&gt;().ToTestable().Provider; } }</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">You can add a switch to enable / disable LinqTestable</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Expression Expression { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _settings.IsSmart ? _collection.AsQueryable().ToTestable().Expression : _collection.AsQueryable().Expression; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IQueryProvider Provider { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _settings.IsSmart ? _collection.AsQueryable().ToTestable().Provider : _collection.AsQueryable().Provider; } }</code> </pre><br></div></div><br><br>  You can see an example of how the test database is implemented and LinqTestable is connected to it in the tests of the library itself.  Here are the <a href="https://github.com/FiresShadow/LinqTestable">sources</a> . <br><br>  Just in case, here‚Äôs <a href="http://www.codeproject.com/Articles/447988/How-to-Mock-Test-an-Entity-Framework-Model-First-P">an article</a> on how to implement a test database using the Entity Framework as an example. <br><br>  At the moment, the library does not know how to work with sorting (OrderBy), there are several other minor issues that are planned to be fixed in the near future.  I'm also going to <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D1%2584%25D0%25B0%25D0%25BA%25D1%2582%25D0%25BE%25D1%2580%25D0%25B8%25D0%25BD%25D0%25B3">revise the</a> code. <br><br>  If you find any bugs or cases where the behavior in the database and in C # is different, which are not handled by the library - I would be grateful if you send a problem unit test to LinqTestable@mail.ru </div><p>Source: <a href="https://habr.com/ru/post/273801/">https://habr.com/ru/post/273801/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273791/index.html">Embedded Hyper-V Virtualization - First Step</a></li>
<li><a href="../273793/index.html">SID change during cloning and mass deployment</a></li>
<li><a href="../273795/index.html">Creating a website. Course young fighter</a></li>
<li><a href="../273797/index.html">How we made Rich Text Editor with support for co-editing under Android</a></li>
<li><a href="../273799/index.html">New Year Promotion for HPE ProLiant Gen9 Servers</a></li>
<li><a href="../273803/index.html">IBM FlashSystem 900 storage system overview</a></li>
<li><a href="../273805/index.html">Zabbix + SoapUI = monitoring web services</a></li>
<li><a href="../273807/index.html">Parse HTML in .NET and Survive: Analyzing and Comparing Libraries</a></li>
<li><a href="../273809/index.html">Comparison of free software accounting traffic SQUID</a></li>
<li><a href="../273811/index.html">New Year's release of PVS-Studio 6.00: check Roslyn</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>