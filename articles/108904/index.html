<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hg Init: Part 3. We get used to working in a team</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the third part of the Hg Init Series : A Mercurial Study Guide by Joel Spolsky . Previous parts: 


- "Retraining for Subversion Users" 
- "Th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hg Init: Part 3. We get used to working in a team</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/eebea7f1/5482efc4/01467053/55589e0f.png" align="left">  This is the third part of the <b>Hg Init</b> Series <b>: A Mercurial Study Guide by</b> <a href="http://www.joelonsoftware.com/">Joel Spolsky</a> .  Previous parts: <br><ul><li>  <a href="http://habrahabr.ru/blogs/development_tools/108443/">"Retraining for Subversion Users"</a> </li><li>  <a href="http://habrahabr.ru/blogs/development_tools/108658/">"The Basics of Mercurial"</a> </li></ul><br><br>  One of the advantages of using Mercurial is the ability to work as a team on one code.  Mercurial allows everyone to work independently and helps to merge their changes. <br><br><h4>  Part 3. Getting used to working in a team </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage/7b7801cf/49b2fd7d/6d606de3/1c97bbd1.png" align="left"><br>  When teaming with Mercurial, it is common to set up a central repository in addition to the personal repositories located on the computers of team members.  The central repository can be considered as a kind of flea market, that is, as a place where they meet and exchange what has been done. <br><br><a name="habracut"></a><br><br><img src="https://habrastorage.org/storage/32a5f305/c4895d33/2f30d931/4210364d.png"><br><br>  The easiest way is to create a central repository using the built-in Mercurial web server.  You just need to create a repository with <code>hg init</code> and open it with <code>hg serve</code> .  By default, the repository will be available on port 8000. <br><br><img src="https://habrastorage.org/storage/1918f1bf/d865dae0/d4966f24/12e8fe35.png"><br><br><blockquote> <code>hg serve</code> <br>  starts the web server and makes the current repository available on the Internet. <br></blockquote><br><br>  Since the server is running on <b>joel.example.com</b> , I can simply open <b>joel.example.com:8000</b> in the browser and see that the server is running, though the repository is completely empty. <br><br><img src="https://habrastorage.org/storage/0140b8e0/896882e3/4baa6617/d1a267f3.png"><br><br>  Having a running central web server, I can <i>clone the</i> central repository <i>from the server to my computer</i> for personal use.  The repository is currently empty, so I will get another empty repository as a result of cloning. <br><br><img src="https://habrastorage.org/storage/2c740a45/4fabec98/c98fcb7a/92f422c6.png"><br><br><blockquote> <code>hg clone</code> <br>  makes a complete copy of the entire repository. <br></blockquote><br><br>  Now I will create a <b>guac</b> file in which I will write down my famous recipe for <a href="http://ru.wikipedia.org/wiki/%25D0%2593%25D1%2583%25D0%25B0%25D0%25BA%25D0%25B0%25D0%25BC%25D0%25BE%25D0%25BB%25D0%25B5">guacamole</a> . <br><br><img src="https://habrastorage.org/storage/4aff84ff/486ba60c/9057e021/c0035b15.png"><br><br>  I will add and save this file to the repository.  This will be the first official version: <br><br><img src="https://habrastorage.org/storage/44d3a55b/e0d4e124/e42c1cf7/cf3b7c31.png"><br><br>  I will write a comment to the commit: <br><br><img src="https://habrastorage.org/storage/89a503a1/b5c6d82d/6c6b4193/13248894.png"><br><br>  I will quickly edit the file, making one small change, so that we have at least a little history of changes in the repository. <br><br><img src="https://habrastorage.org/storage/deaba090/1260460f/410b04a4/5167fd72.png"><br><br>  And fix the changes: <br><br><img src="https://habrastorage.org/storage/233f2aa8/8318239c/90025c61/b72bd994.png"><br><br>  Notice that when I commit this time, I used the argument <code>-m</code> , which I hadn‚Äôt done before.  This is simply to specify a comment on the commit in the command line and not to use the editor. <br><br>  Well, what do we have?  I currently have a central repository and my personal clone of this repository.  I made two changes and fixed them, but these changes are stored in my clone.  They are not in the central repository yet.  So it looks like this: <br><br><img src="https://habrastorage.org/storage/24badfd6/f67bd275/c3ddb80b/26b09b8b.png"><br><br>  And now I will use the <code>hg push</code> command, which will push my changes from local to central repository: <br><br><blockquote> <code>hg push</code> <br>  pushes recent changes from the current repository to the central one. <br></blockquote><br><br><img src="https://habrastorage.org/storage/5a06d34f/2bc320d7/b153b069/e629a0db.png"><br><br>  Well, great.  It is clear that this will not work.  I don‚Äôt want to think about the security and consequences of launching a web server with the permission of everyone to push its stupid changes into it.  Suffer a little, I'm going to set up the server so that he is allowed to do anything.  You need to edit the .hg \ hgrc file on the server: <br><br><img src="https://habrastorage.org/storage/36e5b657/454f8d10/28fb9c5f/d8f05740.png"><br><br>  Needless to say, it is not safe.  But if you are in a secure LAN at work, and you have a good firewall, and you trust everyone in your network, then this can be done.  Otherwise, you should read about the security settings. <br><br>  Well, it's time to restart the server: <br><br><img src="https://habrastorage.org/storage/105523b5/59e1b4bf/6342c521/267d945e.png"><br><br>  Now I should be able to push through the changes: <br><br><img src="https://habrastorage.org/storage/a2b9811f/4badc381/b95e5697/f5eb54c8.png"><br><br>  Aha  Now everything looks like this: <br><br><img src="https://habrastorage.org/storage/4dbad5c0/8258e140/798f5ae3/e02b095c.png"><br><br>  I know what you're thinking.  You think: ‚ÄúLord, Joel, this is all strange.  Why in the repositories are <i>changes</i> , <i>not files</i> ?  Where is that guac <b>file</b> ? ‚Äù. <br><br>  Well, yes, strange.  But this is how distributed version control works.  Repositories simply store large stacks of changes.  Imagine that one change is like a sheet of partially transparent material.  If you have a pack of such sheets, and you stack them on top of each other so that the latest change is on top, and then look at this pack from top to bottom, then - yes, yes, yes, ladies!  - see the current version of the file.  If you remove sheets one by one from the top of the stack, you will see more and earlier versions of the file. <br><br>  We use the browser and again look into the central repository: <br><br><img src="https://habrastorage.org/storage/3c857027/d3fe2213/746c3e1a/bd26eb0f.png"><br><br>  There is exactly what was expected. <br><br>  Now I‚Äôll call Rosa to help me with my recipe.  Rosa from the testers team.  Anyone will confirm that it resembles one of those grannies that can be seen in Vegas, sitting for hours with a hanging jaw in front of a ‚Äúone-armed gangster‚Äù and throwing coin after coin into a coveted crack.  All the difference is that the Rose program is testing.  You can give her a new version of the program, and she will check it on 23 Linux distributions.  Will check in turn on each.  Showing no emotion, without making unnecessary movements.  Stopping only to inform you that a dot over i has been missed in the Turkish version of Ubuntu Linux.  The rose tests well, but I swear it sometimes behaves like a zombie. <br><br><img src="https://habrastorage.org/storage/371530e4/00fbd7ce/85609735/4208ce7b.png"><br><br>  Rosa used the <code>hg clone</code> command to create her own complete repository copy.  <code>hg clone</code> takes two arguments: the repository URL and the name of the directory you want to clone to.  Rosa has her own <b>recipes</b> catalog. <br><br><img src="https://habrastorage.org/storage/3750c07a/f5b90d1b/06d55bb2/ecd4d3a6.png"><br><br>  Note that when <code>hg log</code> executed, it sees the whole story.  That is, Rosa downloaded the entire repository with the complete history of everything that has already happened. <br><br>  Now Rose will make a change and make it to the repository: <br><br><img src="https://habrastorage.org/storage/625ee93f/4abace04/4fa31409/85261f2d.png"><br><br>  Here, commit.  Please note that it can work even if the server is not working: the commit is fully executed on its machine. <br><br><img src="https://habrastorage.org/storage/2326821c/0aa0eb4e/1b0ff6ad/985efcd6.png"><br><br>  While Rosa was making her changes, I also did something. <br><br><img src="https://habrastorage.org/storage/5e8ea447/72ead90e/263bba3f/8721f9eb.png"><br><br>  After I register my changes, it will be seen that in my log at number two the same is not indicated for Rosa. <br><br><img src="https://habrastorage.org/storage/2dba88e3/6da5d0aa/a3bb4bd9/7b38c1e1.png"><br><br>  The stories in our repositories began to differ. <br><br><img src="https://habrastorage.org/storage/a9c1352a/9d5dc961/99774de2/5ae54129.png"><br><br>  Do not worry, we will soon see how to bring all these changes together to get excellent sweets with chips and <a href="http://ru.wikipedia.org/wiki/%25D0%25A5%25D0%25B0%25D0%25B1%25D0%25B0%25D0%25BD%25D0%25B5%25D1%2580%25D0%25BE">peppers habanero</a> . <br><br>  Rose can continue to work without connecting to the server, making as many changes as you like.  It can commit or roll back changes in its repository.  However, the moment will come when she decides to share her changes with the others.  She can run the <code>hg outgoing</code> command and see a list of changes waiting to be sent to the central repository.  These are the changes that will be sent when <code>hg push</code> executed. <br><br><img src="https://habrastorage.org/storage/db449ef2/d6b61d93/156b0919/f19dd056.png"><br><br><blockquote> <code>hg outgoing</code> <br>  displays a list of pending changes in the current repository. <br></blockquote><br><br>  <code>hg outgoing</code> is just a list of all such changes in the current repository that are not in the central repository. <br><br>  Well, here Rosa pushes her changes into the central repository. <br><br><img src="https://habrastorage.org/storage/7fce8e5d/56405199/c27ae4af/25722734.png"><br><br>  And now it looks like this: <br><br><img src="https://habrastorage.org/storage/28086fde/fee793f7/af840235/a9751709.png"><br><br>  After I went to drink the fourth cup of <a href="http://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B0%25D1%2582%25D1%2582%25D0%25B5">latte</a> for today, I am also ready to push through my change about potato chips. <br><br><img src="https://habrastorage.org/storage/66211440/3bef48f3/e7d8fa43/4a17dfb5.png"><br><br>  AAAAA !!!  Mistake!  Oh, by the way, see the message?  Which one is written in, <i>use the -f switch to force push</i> (use push -f to force)?  This is <i>terrible</i> advice.  Never <b>use the -f option</b> for anything.  You will regret using it.  Just trust me at the moment. <br><br>  The reason why Rosa managed to push through the changes, but I don‚Äôt have to say that potato chips and guacamole do not mix well.  Just kidding!  Just wanted to make sure that you haven't fallen asleep there yet. <br><br>  The team ended up with an error because each of us made changes, which means they need to be merged together, and Mercurial knows this. <br><br>  First of all, I will take away all the changes from the central repository, which I don‚Äôt have yet to merge. <br><br><img src="https://habrastorage.org/storage/cc14316f/6d00f829/c045eaff/b28a5dff.png"><br><br>  There's some gibberish about +1 head (+1 heads).  This is because my repository, in which three changes had previously been carefully arranged, became a two-headed monster.  At the top of the repository, two different changes are located dangerously.  Here's what it looks like: <br><br><img src="https://habrastorage.org/storage/d20fe311/841ec62a/25136b20/a75b2b3b.png"><br><br>  I now have both versions in the repository.  Here is my: <br><br><img src="https://habrastorage.org/storage/7727aca4/0638daad/bddcb9a2/1cb4c06e.png"><br><br>  And here is the Rose version: <br><br><img src="https://habrastorage.org/storage/ccca055a/4385a92c/1b996f55/8e9755c9.png"><br><br>  And I have to merge these versions together.  Fortunately, it's simple: <br><br><img src="https://habrastorage.org/storage/94ed4e43/6c8c1c1c/f34767ff/9825f25a.png"><br><br>  Look!  The <code>hg merge</code> team took and merged both my ‚Äúheads‚Äù (changes at the top of the repository) into one.  Since in this case Rosa and I changed different parts of the file, there were no conflicts during the merge and everything went without a hitch. <br><br><blockquote> <code>hg merge</code> <br>  merges (merges) two "heads". <br></blockquote><br><br>  I still have to commit.  It is important.  If the merger failed, then I could always roll back and try again.  But, since the merger was successful, I will commit.  After that, I can push my changes into the central repository. <br><br><img src="https://habrastorage.org/storage/2372798e/f0a49c6a/2f49a1ee/75085756.png"><br><br>  Now in the central repository is the same as in my: <br><br><img src="https://habrastorage.org/storage/3301ab87/9868c9ff/9bb6c7ea/acb0e87e.png"><br><br>  Well, I have the changes Roses and my own changes, but Rosa does not yet have my changes. <br><br>  There is one more thing related to Rosa, which I forgot to tell you.  She is a doctor.  Yeah, doctor, who is a doctor.  Well, not wonderful?  She was the head pediatrician at <a href="http://www.mountsinai.org/">Mt.</a>  <a href="http://www.mountsinai.org/">Sinai</a> and received, probably, "five times more than this nasty pork pays its testers."  No one knows for sure why she left medicine.  The rest of the testers think something tragic has happened.  She also had a family: on her desk a picture of a lovely ten-year-old child.  But now she lives alone, and we do not want to climb into her soul. <br><br>  Rosa needs to pull (pull) fresh incoming changes from the repository to get my changes. <br><br><img src="https://habrastorage.org/storage/19f31f66/0a623177/f258cc66/5667615b.png"><br><br>  Is done.  Now, - it may seem strange to you, - despite the fact that Rosa has drawn new changes into her repository, <i>these changes are not in her working directory</i> . <br><br><img src="https://habrastorage.org/storage/c8bc0274/0d8008f0/40c44b5b/b92c3101.png"><br><br>  See, She still works with <a href="http://en.wikipedia.org/wiki/Tortilla_chip">corn chips</a> .  With corn chips! <br><br>  She <i>has</i> my recent changes somewhere in the repository ... <br><br><img src="https://habrastorage.org/storage/37e67e82/67a3e142/e9022010/4fd8cfde.png"><br><br>  Just my changes are not in her working directory.  This is because it still changes the second set of changes.  This can be seen by running the <code>hg parent</code> command: <br><br><img src="https://habrastorage.org/storage/248c9d9e/b3027e43/dee45f23/6063a7e3.png"><br><br><blockquote> <code>hg parent</code> <br>  displays the change set in the working directory. <br></blockquote><br><br>  Mercurial is kind to us.  Pulling changes is always safe.  All that happens is getting fresh changes made by other people.  We can start working with these changes later when it‚Äôs convenient for us. <br><br>  Remember that the <code>hg up</code> command with no arguments will result in a working directory to the ‚Äútip‚Äù, that is, it will apply all changes to the topmost set of changes.  In this case, this is the fourth set of changes: <br><br><img src="https://habrastorage.org/storage/06bd58a7/84eba403/73124798/54b38879.png"><br><br>  Now Rosa sees the latest version with changes from both of us. <br><br>  When you work in a team, the workflow will look much like this: <br><ol><li>  Pick up the latest version that everyone works with if you haven‚Äôt done this for a long time by doing: <br><ul><li>  hg pull </li><li>  hg up </li></ul><br></li><li>  Make changes </li><li>  Commit changes (locally) </li><li>  Repeat paragraphs 2-3 until you get a good code that you want to dump on all the others. </li><li>  When you are ready to share, execute: <br><ul><li>  hg pull to get someone else's changes (if any) </li><li>  hg merge to merge these changes with your </li><li>  testing!  in order to make sure that nothing happened during the merger </li><li>  hg commit (to commit the result of the merge) </li><li>  hg push </li></ul><br></li></ol><br><br><h5>  check yourself </h5><br><br>  Here is all that you should be able to do at the moment: <br><ol><li>  Set up a central repository and give team members the opportunity to make clones of it. </li><li>  Push changes to the central repository </li><li>  Pull changes from the central repository </li><li>  To merge changes from different authors </li></ol><br><br>  Continued here: <br>  <a href="http://habrahabr.ru/blogs/development_tools/109074/">Hg Init: Part 4. Correcting errors</a> </div><p>Source: <a href="https://habr.com/ru/post/108904/">https://habr.com/ru/post/108904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../108896/index.html">Japan plans to develop efficient smart grid technology</a></li>
<li><a href="../108897/index.html">Samsung Wave II</a></li>
<li><a href="../108900/index.html">0day vulnerability in modern OS from Microsoft</a></li>
<li><a href="../108901/index.html">HTML5 - a look through the security lens</a></li>
<li><a href="../108903/index.html">New vulnerability allows elevating privileges in Win7 / Vista bypassing UAC</a></li>
<li><a href="../108906/index.html">Netbook with italian roots</a></li>
<li><a href="../108908/index.html">Runet 2010 Prize or Tina Kandelaki Twitter PR</a></li>
<li><a href="../108910/index.html">Do you have a website?</a></li>
<li><a href="../108914/index.html">Authorities seized Torrent-Finder.com domain (changed DNS)</a></li>
<li><a href="../108915/index.html">Understanding prototype, __proto__, constructor and their chains in pictures</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>