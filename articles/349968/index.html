<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to build a strong team of analysts and data engineers? Experience company Wish. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first part, we looked at how the data infrastructure was rebuilt in the Wish company in order to increase their analytical capabilities. This t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to build a strong team of analysts and data engineers? Experience company Wish. Part 2</h1><div class="post__text post__text-html js-mediator-article">  In the <a href="https://habrahabr.ru/company/newprolab/blog/347360/">first part,</a> we looked at how the data infrastructure was rebuilt in the Wish company in order to increase their analytical capabilities.  This time we will pay attention to human resources and talk about how to further scale the company and create an ideal team of engineers and analysts.  We will also tell about our approach to hiring the most talented candidates on the market. <br><br><img src="https://habrastorage.org/webt/ne/hz/0d/nehz0dbff6rpimu6dsbahla8wxu.png"><br><a name="habracut"></a><br><h3>  Scaling data engineering </h3><br>  Data engineering in a company can develop in two opposite directions.  <i>The first path</i> is a classic one, in which case the data engineers mainly build and support the data pipelines, which are then used by analysts.  The main disadvantage of this approach is the routine and monotony that can turn any engineer into a gear of a working system, which means it will be harder to retain talented employees in the company. <br><br>  <i>The second approach</i> is different in that with it, data engineers are engaged in the construction and support of not pipelines of data, but platforms with the help of which anyone in the company can build and use their own pipelines.  This allows analysts and data scientists to work end-to-end and fully control their projects. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you want to attract the most talented to the company, then this way is for you, because the <b>best ones want to work on scaling systems and platforms</b> , solving complex technical problems.  The productivity of analysts also increases as they no longer depend on anyone. <br><br>  Of course, there are a couple of drawbacks.  Firstly, there will be too many new tables, because it is always easier to create new ones than to try to change and adjust old ones.  This will lead to confusion and incompatibility of different metrics and reports.  Secondly, the costs and the workload of the infrastructure will increase, since ETL jobs written by analysts are often not optimal. <br><br>  As a result, neither of the two approaches is imperfect, and the truth lies somewhere in the middle. <br><br>  <b>Scaling ETL and Luigi.</b>  Our <a href="https://github.com/spotify/luigi">Luigi-</a> based data <a href="https://github.com/spotify/luigi">pipeline</a> , described in the first part, worked fine, however, as soon as we began to build on additional functions, problems began to appear: <br><br><img src="https://habrastorage.org/webt/hh/aa/te/hhaate905rtetdvigckv6pjzyre.png"><br><br><ul><li>  The system was fragile because all the tasks had to be performed within the same queue.  A single error or poor request could break the entire pipeline. </li><li>  It was difficult to carry out maintenance tasks, the backfill algorithm also failed, it was necessary to manually update / delete tasks in MongoDB. </li><li>  Errors generated by queries in Hive could easily overload the cluster, especially when there are hundreds of them due to backfilling caused by a task with a bug inside. </li><li>  The monitoring system based on emails has ceased to cope, as the number of people using the pipeline grew and the number of emails per day grew.  It became very difficult to sort and track them in order to react to errors in time. </li></ul><br>  We managed to find very simple solutions to these problems: <br><br><ul><li>  We divided all tasks into 4 main streams: key ones for the whole company, for the data management team, infrastructure management teams and analysts working on individual projects. </li><li>  We wrote our own shell for maintenance tasks, for example, for backfill. </li><li>  Added circuit breakers that run in case of errors, so that system resources are not spent on bad code over and over again. </li><li>  We built our warning and monitoring system in Prometheus + Pagerduty, which allows you to respond to errors and problems on the server. </li></ul><br>  Thus, a simple pipeline, with which several people work and the one used by more than a hundred, are completely different things and require different approaches. <br><br>  <b>Scaling data storage.</b>  Since we have Redshift and Hive clusters in our company, whose capacities are finite, it is necessary to keep track of queries and tables so that they do not slow down the system and it can continue to grow.  For this we have taken several measures.  First, we <b>analyze the logs of requests</b> , look for slow ones and, in which case, denormalize them.  Secondly, it is a <b>code review</b> to maintain the quality of the code and train analysts.  The scripts of our pipelines are regularly uploaded to the Git repository. <br><br><img src="https://habrastorage.org/webt/34/hc/su/34hcsugmw3_uledavcgs3pcwovi.jpeg"><br><br>  <b>Handling system errors.</b>  One of the key duties of a data engineer is the error handling of the system, which generates a considerable number of them.  At the moment, we have over 1000 active ETL jobs written by data engineers and analysts, some of whom have already left the company, some are interns who have recently left school.  Therefore, even 1% of errors per week will mean 10 broken pipelines for this period. <br><br>  To avoid the negative consequences of these mistakes, we assign ‚Äúattendants‚Äù who are responsible for correcting them, and every week ‚Äúattendants‚Äù change. <br><br>  <b>We build a team of engineers.</b>  In our team, the roles in data engineering are distributed like this: <br><br><ul><li>  <b>Data Infrastructure Engineer.</b>  Focused on scaling and reliability of distributed systems.  Must have experience in building such systems, be able to explain the choice of various tools. </li><li>  <b>Data Platform Engineer.</b>  Engaged in building data pipelines.  The ideal candidate is a person with a classic background in programming and a desire to build effective systems. </li><li>  <b>Analytics Engineer.</b>  Focuses on building the main ETL job s and refactoring bad queries and data models.  It is enough to own Python + SQL and have developed analytical skills. </li></ul><br><h3>  Analytics scaling </h3><br>  No matter how good the data infrastructure is, if the people who use it are incompetent.  Below we discuss how to create a strong team of analysts. <br><br>  At the very beginning, analysts were engaged only in extracting data and building reports.  It was wrong: <b>analysts are not becoming for this</b> .  They always want to control not only the process of building a report, but also the final result - the <b>decision made on its basis</b> .  They want to influence the company, not just an API to provide information. <br><br>  <b>3 key skills for analytics.</b>  Of course, analysts have a specialization, and what makes analytics in the field of logistics successful will not necessarily provide him with the same success in marketing.  However, there are still 3 skills that each analyst team needs to be effective: <br><br><img src="https://habrastorage.org/webt/ur/oq/xb/uroqxbfra1lhdvejasfay8iizhc.jpeg"><br><br><ul><li>  <b>Understanding the goal.</b>  First, analysts must understand why they are performing a particular task.  You need to be able to look critically and from different angles at the original question that came from management in order to catch its true value and context. </li><li>  <b>Understanding infrastructure and data.</b>  Secondly, analysts should understand perfectly how their system works, and how it affects the data.  Using data as it is is a disgusting habit, which leads to a distortion of the situation and poor-quality analysis. </li><li>  <b>To bring everything to the end.</b>  In the course of work it is very easy to forget about the final goal, so analysts should always bring their projects to a logical conclusion.  The end result of the analyst‚Äôs work is not a dashboard, in which all the available information is aggregated, but recommendations or actions that can have a positive impact on the business. </li></ul><br>  <b>Business intelligence support.</b>  The main goal of all BI tools is data democratization, providing everyone with the opportunity to analyze data and make decisions based on them.  That is why we launched <a href="https://looker.com/">Looker</a> . <br><br>  The problem is that not everyone has enough skills to analyze the data qualitatively.  Bad data, illogical reports - all this flooded the company.  In addition, the number of requests took off, because people could not cope with bad data and, instead of processing it, they demanded new metrics. <br><br>  Therefore, we deployed a self-analytics system too early.  There were so many problems that we had to restrict access and hire more analysts to help other employees process the data. <br><br>  <b>We build a team of analysts.</b>  Only in the case when your analysts are perfect and as if sent from above, you do not need to work out the development strategy of your team.  I believe that analysts in a team should be in three main areas: business, technical component and statistics: <br><br><ul><li>  <b>Report Designer.</b>  Most often they come from consulting, finance, or operations.  They are able to make profitable business decisions based on quantitative information and are most useful when they are key drivers of change.  They need to own SQL, but Python is optional (although it will be a plus). </li><li>  <b>Data analysts.</b>  Excellent knowledge of Python and SQL, efficiently extract data and, if new tables are required, can build their own ETL pipelines.  Finally, they can automate analytics and write non-reusable scripts to speed up work. </li><li>  <b>Statistics.</b>  Data analysts should not be proficient in statistics, but it‚Äôs stupid not to have a person on the team who‚Äôs ‚Äúon you‚Äù.  Using aggregated metrics, conducting A / B testing on limited data, building predictive models - all this undoubtedly brings great benefits to the business. </li></ul><br><h3>  Recruiting </h3><br>  And finally, after more than 150 interviews with engineers, analysts and managers at Wish, I gained enough experience to talk about how we approach hiring employees and how to find worthy candidates for the position. <br><br><img src="https://habrastorage.org/webt/l7/wp/tn/l7wptn3zjhrmmrrezn071ukrq8m.jpeg"><br><br>  <b>Resume Screening.</b>  For recent graduates, the first thing we look at in the resume is grades and the school they graduated from.  For more experienced candidates, it is important for us which companies and teams they worked in: organizations with a strong engineering component or data-driven?  How important was their role in them? <br><br>  <b>Interviewing.</b>  Strong interviewers should ask flexible questions that can be changed depending on the reaction of the candidate.  If it seems that the candidate has rather weak analytical skills, then you need to put pressure on more complex questions, and if he looks uncommunicative, then you can ask him a vague and lengthy question and see how he explains it. <br><br>  In general, candidates must go through 1-2 phone screenings and 4 face-to-face interviews to get to Wish.  Interviews take place quickly, with writing notes, so that the next interviewer can correct his questions. <br><br>  Interviews should end on a positive note, since this is a very exciting experience for candidates, they may be vulnerable.  There is no easier way to destroy the whole motivation of a person than to humiliate him at the interview.  Also, conducting the interview in a negative way, the company can quickly earn a bad reputation. <br><br><h3>  Results </h3><br>  Over the past couple of years we have managed to achieve incredible things.  We rebuilt the infrastructure and created a data work team for one of the largest online retailers in the world.  And all this was done on the go, during this period the business did not stop for a second.  We can say that we changed the tires on a Formula 1 car right while driving.  We did it, I hope that thanks to this series of articles, you will succeed! <br><br><hr><br>  And if you decide to become a big data analyst or data engineer, but you‚Äôll have to figure it out for yourself for a long time, and you don‚Äôt have to ask anyone, then come to the Newprolab programs: <br><br><ul><li>  The program <a href="https://goo.gl/ummktS">‚ÄúBig Data Specialist 8.0‚Äù</a> starts on March 22 </li><li>  April 2 launch <a href="https://goo.gl/AwxvYH">‚ÄúData Engineer 2.0‚Äù</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/349968/">https://habr.com/ru/post/349968/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349958/index.html">Come and pick up the prototype books</a></li>
<li><a href="../349960/index.html">Disable PowerShell and other features of the fight against Malware. Part I</a></li>
<li><a href="../349962/index.html">"Do not get involved, kill!" Or the whole truth about the safety of automated process control systems. Part 2</a></li>
<li><a href="../349964/index.html">Useful tips on archiving Veeam backups to tape</a></li>
<li><a href="../349966/index.html">Vulnerability of technology to identify users in public wi-fi networks</a></li>
<li><a href="../349972/index.html">Disabling PowerShell and other ways to combat Malware, Part II</a></li>
<li><a href="../349974/index.html">3 interesting spring ICOs: gold-backed cryptocurrency, a cure for HIV and earnings on hedge funds</a></li>
<li><a href="../349978/index.html">Wrong understanding of the principle of DRY</a></li>
<li><a href="../349980/index.html">Benjamin Franklin method for reading programming books</a></li>
<li><a href="../349982/index.html">The dark side of the serverless architecture or the complexity of estimating the real cost of serverless computing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>