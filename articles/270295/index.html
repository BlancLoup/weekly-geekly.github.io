<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 45: escape from the sandbox, bypassing EMET through WOW64, breaking into 000webhost</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quotes from the book by Yevgeny Kaspersky, which I attach to each news digest, well show the landscape of threats as of the beginning of the 90s of th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 45: escape from the sandbox, bypassing EMET through WOW64, breaking into 000webhost</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/3f7/a0e/ca5/3f7a0eca569e4842be45433f308d0ba5.png" align="right">  Quotes from the book by Yevgeny Kaspersky, which I attach to each news digest, well show the landscape of threats as of the beginning of the 90s of the last century, or rather, the location of the information security topic in relation to the rest of the world.  Approximately before the beginning of the two thousandth, before the appearance of the first mass epidemics of still quite simple malware, information security was perceived as something even more complex than IT as a whole.  These were good times, but they ended.  In the mid-tenths, cyber threats are discussed by everyone: scientists, parliamentarians and even pop stars.  This is clearly seen in the October digests of the most popular news: first we <a href="http://habrahabr.ru/company/kaspersky/blog/269393/">hit</a> the theory of cryptography, and then suddenly <a href="http://habrahabr.ru/company/kaspersky/blog/269815/">jumped</a> into the law.  And yes, it‚Äôs necessary: ‚Äã‚Äãit all somehow affects cyberspace, even if not right now. <br><br>  But in general, in fact, practical security as it was a complex purely technical topic, remained.  The landscape of threats cannot be adequately assessed if one looks only at the reaction of society or only at scientific research.  Those bills are important, but they have little in common with practice.  They are connected with IT as a whole only because their text was typed on a computer in a Word.  This is not a great discovery, but an obvious hint: it would be nice to strike a balance.  It is gratifying that this week all the most popular news is from the practical sphere.  No politics, no threats, potentially exploited in fifteen years.  Everything is here and now, as we love.  To live a moderate hardcore.  Wiiii! <br>  The previous series <a href="http://habrahabr.ru/search/%3Ftarget_type%3Dposts%26q%3D%255Bklsw%255D%2520%26order_by%3Ddate">live here</a> . <br><a name="habracut"></a><br>  <b>Xen closed dangerous vulnerability to allow sandbox escape</b> <br>  <a href="https://threatpost.ru/xen-patches-7-year-old-vm-escape-hypervisor-vulnerability/13063/">News</a>  <a href="http://xenbits.xen.org/xsa/advisory-148.html">Security Advisory</a> .  QubesOS Developer <a href="https://github.com/QubesOS/qubes-secpack/blob/master/QSBs/qsb-022-2015.txt">Advisory</a> . <br><br>  What they found: a vulnerability in the Xen hypervisor since version 3.4.0, which allows, under a number of conditions, to gain complete control over the system from a virtual machine by completing what is called ‚Äúsandbox escape‚Äù.  Eyewitnesses of events interpret the incident in different ways.  A discreet Xen bulletin reads: ‚ÄúThe code used to validate the data in the second-level tables can be circumvented if certain conditions are met.‚Äù  The developers of QubesOS, an operating system with an emphasis on security, are expressed more simply: ‚ÄúPerhaps the worst [vulnerability] of all that we have seen in the Xen hypervisor.  Unfortunately". 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Xen Developer Reaction: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bd0/3a4/fb4/bd03a4fb474d47018b337b42c7894894.png"></div><br><br>  QubesOS Developer Reaction: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/928/3ff/ee7/9283ffee7f024430b8b9faadc4285c04.png"></div><br><br>  They can be understood: QubesOS uses virtualization to isolate tasks from each other as much as possible: work from entertainment, banking from <s>porn</s> sites with pictures and so on.  Any vulnerability of the sandbox escape class covers all their carefully tuned protection with a copper basin, hence the frustration.  And not only among them: the Xen code base is actively used by the same Amazon, and thousands more companies around the world.  In particular, an expert from Chinese Alibaba reported this vulnerability.  About Amazon, I recommend reading <a href="http://www.networkworld.com/article/2892313/cloud-computing/what-happens-inside-amazon-when-there-s-a-xen-vulnerability.html">this article</a> , describing the process of mitigation in some detail.  But in general, this is understandable: you need to assess the scale of the problem, roll a patch, and do it quickly, but without breaking anything at the clients (ideally, not even rebooting their VM).  Not an easy task. <br><br>  But important, because, in theory, you can buy a dozen virtual machine kopecks in different data centers Amazon EC2, through them to gain control over the hosts and then go to an exciting quest for other servers.  The key word here is <i>theoretically</i> : there was no proof and it is not expected, and I don‚Äôt think that Amazon relies only on Xen code for security.  But to assess the magnitude of the problem, this is the right example.  Do they often find such holes?  More often than we would like.  A QubesOS spokesperson writes that it‚Äôs not very noticeable in the Xen development process that security is a priority.  The previous vulnerability (also sandbox escape, but with more severe restrictions on exploitation) was <a href="https://threatpost.ru/xen-patches-vm-escape-flaw/10551/">found</a> at the end of July. <br><br>  <b>The WOW64 subsystem can be used to bypass EMET in Windows.</b> <br>  <a href="https://threatpost.ru/latest-emet-bypass-targets-wow64-windows-subsystem/13103/">News</a>  <a href="https://www.duosecurity.com/blog/wow64-and-so-can-you">Research</a> company Duo Security. <br><br>  Enhanced Mitigation Experience Toolkit is a set <a href="https://support.microsoft.com/en-us/kb/2458544">of</a> Microsoft <a href="https://support.microsoft.com/en-us/kb/2458544">technologies</a> aimed at increasing application security.  In other words, it allows you to apply methods that complicate the life of hackers, such as <a href="https://en.wikipedia.org/wiki/Address_space_layout_randomization">ASLR</a> and <a href="https://en.wikipedia.org/wiki/Data_Execution_Prevention">DEP,</a> to programs, even if the developers themselves have not taken care of implementing these useful technologies on their own.  This "convenience" leads to an obvious drawback: if the EMET system is bypassed, it will lead to a decrease in the level of protection not for a particular application, but for the whole set at once. <br><br>  What Duo Security researchers have found is not even a vulnerability in the sense of an exploited hole in EMET.  It‚Äôs rather a ‚Äúleak at the interface‚Äù - EMET turned out to be less effective in a 64-bit OS, if you work with a program written for the 32-bit version.  What happens often, if not almost always: for example, most browsers are a 32-bit process in a 64-bit environment.  As a proof, I‚Äôll attach a picture from my computer (and as a memory it eats!). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bcc/296/69e/bcc29669ef5643acaf99e821a46d8469.png"></div><br><br>  For the correct operation of such a design in Windows 64-bit there is a WoW64 subsystem (not ‚Äúwow‚Äù, but Windows on Windows).  The success of EMET depends on how well the protection technologies control someone else's code, and in the case of using WoW64, it turns out that they control this code poorly.  As an example, researchers cite an exploit of the type of use-after-free vulnerability in Adobe Flash, <a href="https://threatpost.ru/vyshel_patch_dlja_0-day_flash_adobe_obeshchaet_vtoroj/5750/">discovered</a> in January of this year.  EMET is designed to deal with such memory tricks (if the developer could not), but a small modification of the exploit by experts allowed to completely circumvent the Windows protection system, due to the complexity of the interaction between EMET and WoW64. <br><br>  No one can be trusted.  Fortunately, this is still only a study, but the conclusion is clear: Microsoft is a great fellow with the EMET system, but you cannot fully rely on it.  If the vulnerability is still detected and exploited, then you need to be able to block it in several ways, and the more there are, the better.  Ideally, an exploit should not be allowed at all to boot onto a vulnerable OS or run in a vulnerable application, shooting it at a long-distance line, using a black list of questionable URLs.  The story of Xen, though from a completely different opera, says the same thing: there should be a lot of security and, if possible, everywhere. <br><br>  Cherry on the cake: some research saves me from the problem of finding funny pictures.  Duo Security offers the following: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/486/2c6/00f/4862c600fc504674b2f2f8cfe5c1bb29.jpg"></div><br><br>  <b>Hacking the 000webhost has caused a password leak of 13.5 million users</b> <br>  <a href="https://threatpost.ru/web-hosting-service-000webhost-hacked-information-of-13-million-leaked/13057/">News</a>  <a href="https://www.000webhost.com/000webhost-database-hacked-data-leaked">FAQ</a> hoster.  The original <a href="https://www.facebook.com/000webhost.Global/posts/998566216830981">post</a> about hacking on Facebook (100 likes).  <a href="http://www.troyhunt.com/2015/10/breaches-traders-plain-text-passwords.html">The post of</a> expert Troy Hunt with the details. <br><br>  Theoretically, the history of the vulnerability with Xen can be used to crack a hosting provider: there are virtuals, there is a vulnerability, there is an exploit, there is an access to private information, for example, to the customer base.  Hacking the Lithuanian hoster 000webhost shows that such a complicated tactic is not needed at all (even if possible), when there are much simpler and more reliable methods.  In this case, they broke the outdated version of PHP on the company's website, through which they got access to customer data, including passwords.  Troy Hunt, the owner of the Have I been pwned? Service, claims that user passwords were stored in plain text at the hoster. <br><br>  Well, what's the point of using complex attack methods and exploring the vulnerability of ciphers, when in reality our data flow away like this?  However, they reacted correctly to the 000webhost incident: they put out all the necessary information, dropped passwords, temporarily closed access to some services (and did not forget to let them know when access was reopened).  In capital letters, bold, italics, and underlined in the FAQ on the incident, the following is written: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/19f/f81/ff7/19ff81ff727448e4beb13de2b9c5676b.png"></div><br><br>  Well, I admit, italics were not there.  But the idea is correct: do not use compromised passwords anywhere else.  I would add that passwords should be unique in general.  In the bright future of our more secure cyberworld will be just that. <br><br>  <b>What else happened:</b> <br>  Sotsinzhiniring news: mobile malware <a href="https://threatpost.ru/malicious-android-app-impersonates-microsoft-word-doc/13069/">pretends to be</a> a Word document with a well-known and understandable to all icon.  Steals personal data, sends paid SMS, calls to paid phone numbers. <br><br>  <a href="https://threatpost.ru/monthly-android-security-update-patches-more-stagefright-vulnerabilities/13100/">The patch of</a> vulnerabilities Stagefright 2.0 has been released, the owners of Nexus smartphones and those who regularly synchronize the code base with the Android Open Source Project will receive it first.  The rest, as usual, will have to wait from one month to <i>never</i> . <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right">  <b>Antiquities:</b> <br>  Family "Flip" <br><br>  When the infected file is launched, the MBR of the hard drive is affected (the size of the logical disk is reduced and the old MBR sector and its continuation are written into the free space).  Files (COM and EXE) are typically infected at startup.  In files, ‚ÄúFlip‚Äù is a ‚Äúghost‚Äù virus: it is encrypted, and the decryptor does not have a permanent segment (signature) longer than 2 bytes. <br><br>  The second number at 4:00 pm ‚Äúturns over‚Äù the screen: change (top-bottom, right-left) the arrangement of characters on the screen and turn over their image ('P' - 'b'). <br><br>  "Flip-2327" replaces a set of commands in files: <br>  MOV DX, Data_1 <br>  MOV Data_2, DX <br>  MOV DX, Data_3 <br>  MOV Data_4, DX <br><br>  (this combination of commands is found in the COMMAND.COM file in the subroutine responsible for displaying the results of the DOS functions FindFirst and FindNext on the screen) to the INT 9Fh call.  The virus contains an int 9Fh handler and ‚Äúreduces‚Äù file lengths.  Files modified in this way should be restored from software backups. <br><br>  They contain the text OMICRON by PsychoBlast.  They hook int 10h, 1Ch, 21h, 9Fh. <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Pages 103,104.</i> <br><br>  <i>Disclaimer: This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/270295/">https://habr.com/ru/post/270295/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270283/index.html">Internal Adobe Flash Player Update Server</a></li>
<li><a href="../270287/index.html">GDG DevFest Nizhny Novgorod 2015</a></li>
<li><a href="../270289/index.html">Java Gauss Method</a></li>
<li><a href="../270291/index.html">About Swift, and why my big projects will be on Objective-C for some (maybe long) time</a></li>
<li><a href="../270293/index.html">We create an interactive vector scheme of the Moscow metro</a></li>
<li><a href="../270297/index.html">DDoS from an unexpected direction or ‚Äúare PS bots afraid?‚Äù</a></li>
<li><a href="../270299/index.html">Workflow automation for a small development team (Part 1)</a></li>
<li><a href="../270301/index.html">Grow Big: Simple Tips for New Business Application Makers</a></li>
<li><a href="../270307/index.html">A cryptographic program encrypts user files offline.</a></li>
<li><a href="../270309/index.html">Creating a plugin for Intellij IDEA. Notes and small tips</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>