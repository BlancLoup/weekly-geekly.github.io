<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>System.Addin or "Games with reliable plugins." Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 

 Good day. I think the absolute majority of you have been faced with the problem of application extensibility. Likewise, I think that m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>System.Addin or "Games with reliable plugins." Part 1</h1><div class="post__text post__text-html js-mediator-article">  <b>Introduction</b> <br><br>  Good day.  I think the absolute majority of you have been faced with the problem of application extensibility.  Likewise, I think that many of you had to dig Reflection to find out if the build is a plug-in for your program.  Many did not like the fact that in .NET assemblies are loaded by default into the same domain as the application, and then they could not be unloaded.  Many, of course, created objects in separate domains through CreateInstanceAndUnwrap, but all this had to be done by hand.  In general, "the mice cried and injected ...".  With the advent of System.Addin, developers got their hands on a tool for creating an extensible application that is devoid of these problems, as they say, out of the box.  I will also tell about this technology in several articles. <br><a name="habracut"></a><br>  Before we begin - let's deal with the terminology: <br>  <strong>Host, Host application</strong> is, in fact, an extensible application, which, as a rule, searches for and activates extensions. <br>  <strong>Addin. An extension</strong> is a module that contains some additional functionality for a host application. <br><br>  <strong>System.Addin features</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What is System.Addin?  This is a new namespace (namespace), which appeared in the .NET Framework 3.5.  In essence, System.Addin provides developers with a software model for expanding the functionality of the application.  Moreover, the use of this software model provides several key features: <br><br>  1. The host application and the Addin may have independent versions.  Thus, it is possible to build a host application that would work with extension assemblies that were built for previous versions of the application, or for later versions of the application, or that were generally built for another application. <br><br>  2. The ability to activate Addin with the desired level of isolation and security rights.  That is, the System.Addin software model allows you to take care of the security of the application even if the Addin was created by third-party developers.  Now no major expansion module will overwhelm your program. <br><br>  3. Support for multiple levels of isolation extensions from the host application and other extensions.  That is, there are several possible scenarios for building isolation at the domain or process level, thereby enhancing the security of the host application. <br><br>  4. More convenient life management expansion.  Since isolation is used at the level of domains or processes, upon completion of work with the plugin, it is sufficient to simply unload the required domain. <br><br>  Okay.  With some opportunities sorted out.  Go ahead. <br><br>  <strong>Architecture</strong> <br><br>  The entire architecture of System.Addin is built around such a key concept as the <i>Add-in pipeline</i> (I would translate as an "extension pipeline").  Under this phrase, in fact, everything is hidden.  We look at the following picture, all with architecture clarifying: <br><br><div style="text-align:center;"><img src="http://pic.ipicture.ru/uploads/090312/36MLu3SVQe.jpg" alt="image"></div><br><br>  This is the very <i>Add-in pipeline</i> .  Due to all these segments in the pipeline, the required level of abstraction is achieved and isolation is provided.  We will analyze in more detail.  At the ends of the pipeline we see the host application and the extension itself.  These are not the most interesting things, so we will immediately move on to considering what is between them: <br><br>  1. <i>Contract</i> .  As can be seen from the figure, the contract is an interface, the "protocol of interaction" of the host and the extension, and is the point of contact. <br><br>  2. Next, <i>adapters</i> are created on both sides of the contract (inherit Views), which implement the corresponding <i>view classes (views)</i> and wrap the contract with an interface that provides the view.  Also, if you do not combine the Addin view and Host view with one assembly, you can combine the Host and Host view into one assembly.  In any case, my advice to you: use a separate assembly for each segment of the pipeline.  It will be easier. <br><br>  3. Well, the third item is <i>the presentation classes</i> (they must be strictly interfaces or inherited classes).  They are the appropriate representations of the types and methods that are used in the interaction between the host and the extension. <br><br>  At this stage, this information is enough for us.  It‚Äôs enough just to imagine what the Add-in pipeline looks like.  In more detail the role of each of the segments of this pipeline, we consider in one of the following articles. <br>  It is also worth noting that the architecture imposes some limitations that we encounter during the creation process: <br><br>  1. First, each segment of the pipeline ideally is a separate assembly.  Views can be combined into a single assembly, but only with the same combination of adapters. <br><br>  2. Secondly, Addins, adapters and contracts must be public and labeled with special attributes.  See picture below: <br><div style="text-align:center;"><img src="http://pic.ipicture.ru/uploads/090312/9rYEou9766.jpg" alt="image"></div><br><br>  Required attributes are marked with square brackets.  As you can see the presentation from the host side does not require a special attribute. <br><br>  3. Thirdly, compliance with a rigid folder structure is required, which must be strictly observed for the normal functioning of the pipeline: <br><br><div style="text-align:center;"><img src="http://pic.ipicture.ru/uploads/090312/Povh80133K.jpg" alt="image"></div><br><br>  * <i>Addins do not necessarily lie next to adapters, views, and contracts.</i>  <i>Extensions can be located anywhere.</i> <br>  You may notice that each pipeline segment must be located in its own folder, and the AddInSideAdapters, AddInViews, Contracts and HostSideAdapters folders do not allow the presence of subdirectories in them. <br><br>  4. Fourthly, since the most typical scenario is with the activation of expansion in a separate domain, when designing you should not forget that the objects crossing the domain boundaries (as parameters or return values) should be serializable. <br><br>  Like this.  No more, no less.  At first glance, the architecture and restrictions imposed may seem unnecessarily complex, but in reality this is not the case.  I think many of you now imagine what System.Addin is. <br>  That's all. <br><br>  In the next article, I will show an example demonstrating the use of System.Addin. <br><br></div><p>Source: <a href="https://habr.com/ru/post/54189/">https://habr.com/ru/post/54189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../54179/index.html">Go to Open Source and save 50 million euros. Experience the French gendarmerie.</a></li>
<li><a href="../54180/index.html">But who wanted to productively run over the OS Phantom?</a></li>
<li><a href="../54183/index.html">About resource development pipeline</a></li>
<li><a href="../54186/index.html">Karmagram or diagrammatic ranking method in social networks</a></li>
<li><a href="../54187/index.html">Panda USB and AutoRun Vaccine - a cure for autorun viruses on a flash drive</a></li>
<li><a href="../54190/index.html">Bremmerman Limit - Uncomputable Tasks</a></li>
<li><a href="../54192/index.html">Fedora 11</a></li>
<li><a href="../54193/index.html">How to get PMP in 2 months and meet in 24000r</a></li>
<li><a href="../54197/index.html">Sony DR-BT21G Bluetooth Headset Bluetooth Survey and Pick History</a></li>
<li><a href="../54199/index.html">Weather forecast for sms (* nix + shell script, email2sms)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>