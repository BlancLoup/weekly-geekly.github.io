<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Code navigation in JetBrains IDE using REST API and command line</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When developing applications, one often comes across the need to view the exception stack trace output (in logs or with debug-ing). I would like to be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Code navigation in JetBrains IDE using REST API and command line</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/e30/091/b18/e30091b18aaf45939d01af4c84d38a53.png" alt="image"></p><br><p>  When developing applications, one often comes across the need to view the exception stack trace output (in logs or with debug-ing).  I would like to be able to automatically get to the necessary place of the code, directly by clicking on the line in the output of stack trace in the browser or in the terminal. </p><br><p>  If you are a user of one of the latest products from <a href="https://www.jetbrains.com/">JetBrains</a> (in particular, PhpStorm), you can use the internal REST API (for navigation from the browser) and command line launcher (for navigation in the terminal) for these purposes. </p><br><h1 id="navigaciya-v-brauzere">  Browser navigation </h1><br><p>  A partial description of the JetBrains REST API IDE methods can be found here: </p><br><p>  ¬ª <a href="http://develar.org/idea-rest-api/">Http://develar.org/idea-rest-api/</a> </p><br><p>  One of the methods of this API is the ability to open a project file and move to an arbitrary position in this file within the IDE itself. </p><a name="habracut"></a><br><p> Calls to API method calls are made via a call at <code>http://localhost:63342/</code> </p><br><p>  An example of an API call to open a file looks like: </p><br><p> <code>http://localhost:63342/api/file?file=src/path/to/file.php&amp;line=100&amp;column=34</code> </p> <br><p>  Where: </p><br><p>  <strong>file</strong> - relative or absolute file path <br>  <strong>line</strong> - the line in the file where you want to move the cursor <br>  <strong>column</strong> - position on the specified line </p><br><p><img src="https://habrastorage.org/files/b1d/e7d/4b6/b1de7d4b69964e449e16751d02ed9b98.png" alt="alert"></p><br><p>  In order to remove the message that appears every time when you call an API in the IDE, you can in the settings: <code>Build, Execution, Deployment ‚Üí Debugger</code> put a tick <em>"Allow unsigned request"</em> (or each time you have to click the Ok button in the dialog). </p><br><p><img src="https://habrastorage.org/files/1b2/d58/804/1b2d5880486240c986c6ed9f130d5a73.png" alt="Settings"></p><br><h1 id="primer-obrabotki--vyvoda-standartnogo-gettraceasstring-v-php">  Example of processing output of standard getTraceAsString () in php </h1><br><p>  Below is the Regexp, which handles the standard output stack trace of Exception via <a href="http://php.net/manual/ru/exception.gettraceasstring.php">getTraceAsString ().</a> </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">// some code }(\Exception $e){ $traceAsString = preg_replace('/#(\d+) (.+?\.php)\((\d+)\):/', '#$1 &lt;a href="#" onclick="_goToEditorCodeLine(\'$2\', \'$3\'); return false;"&gt;$2($3):&lt;/a&gt;', $e-&gt;getTraceAsString() ); // some code }</span></span></code> </pre> <br><p>  Each line in Exception becomes a link, a click on which opens in the IDE file on the desired line. </p><br><p>  You also need to connect the JS function, which will directly "pull" the API method. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_goToEditorCodeLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">file, line</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xmlhttp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttpRequest(); xmlhttp.open(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>, <span class="hljs-string"><span class="hljs-string">"http://localhost:63342/api/file?file="</span></span> + file + <span class="hljs-string"><span class="hljs-string">"&amp;line="</span></span> + line, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); xmlhttp.send(); }</code> </pre> <br><h1 id="primer-realizacii-na-primere-obrabotki-exception-v-symfony-3">  Sample implementation using Exception in Symfony 3 as an example </h1><br><p>  Since I am currently working with symfony, I will show you how to modify a page with standard Exception in order to implement opening an IDE file with a specific example. </p><br><p>  In order to override a piece of the template that is responsible for displaying the Exception page, you need to create two files in the <code>app/Resources/TwigBundle/views/Exception/</code> folder </p><br><ul><li>  exception.html.twig </li><li>  trace.html.twig </li></ul><br><p>  In the file exception.html.twig add the simplest function <code>_goToEditorCodeLine()</code> , the code of which is described above. </p><br><p>  In the trace.html.twig file, we find the place where the string is displayed and add an arrow to the end, clicking on which will open the file in the IDE. </p><br><pre> <code class="hljs django"><span class="xml"><span class="xml"> in </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ trace.file|format_file(trace.line) }}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"_goToEditorCodeLine('</span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ trace.file }}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">', '</span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ trace.line }}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'); return false;"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">&amp;rarr;</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">&amp;nbsp;</span></span></code> </pre> <br><p>  After that, an arrow appears in the stack trace line, clicking on which opens the file in the IDE and moves the cursor to the desired position. </p><br><p><img src="https://habrastorage.org/files/c51/8da/1be/c518da1bea9d47bbbd1127bc27e5222a.png" alt="Symfony exception"></p><br><p>  The final version of the two files for symfony 3 can be <a href="https://github.com/dlevsha/ide-code-navigation">viewed here</a> . </p><br><h1 id="integraciya-s-komandnoy-strokoy-v-iterm2">  Integration with command line in iTerm2 </h1><br><p>  If you work on MacOS and use iTerm2, you can integrate iTerm2 and Command Line Launcher of the corresponding IDE, which will allow you to open files in the IDE directly from the terminal. </p><br><p>  To install a launcher, you need to call the <code>Tool ‚Üí Create Command-line Launcher...</code> menu in the IDE and in the dialog box confirm the path where the launcher will be installed.  In my case, this is <code>/usr/local/bin/phpstorm</code> (or <code>/usr/local/bin/pstorm</code> for earlier versions) for IntelliJ IDEA is <code>/usr/local/bin/idea</code> . </p><br><p>  This launcher allows, when called from the command line, to open a file and go to the desired line in it. </p><br><p>  Call example: </p><br><p> <code>/usr/local/bin/phpstorm --line 40 /path/to/file</code> </p> <br><p>  or </p><br><p> <code>/usr/local/bin/phpstorm /path/to/file:40</code> </p> <br><p>  In both cases, the file <code>/path/to/file</code> will be opened on line 40. </p><br><p>  Now we will do the command line launcher and iTerm2 integration.  Go to Edit Session ‚Üí Advanced. </p><br><p><img src="https://habrastorage.org/files/eae/fb5/4aa/eaefb54aaf7c4615a523dfc0047e3e46.png" alt="iTerm"></p><br><p>  In the <code>Semantic History</code> section, from the drop-down list, select the <code>run command...</code> and enter: </p><br><p> <code>/usr/local/bin/phpstorm --line \2 \1</code> </p> <br><p>  Now, if you click Cmd and hover the cursor on any file in the terminal, it will become a link and click on it to open it in the IDE. </p><br><p>  If your logs are <code>/path/to/file/:40</code> , i.e.  line number is indicated after the colon after the file - then the IDE will open the file directly on this line. </p><br><p>  The problem with the php-exception logs is that the output is <code>/path/to/file/(40)</code> , i.e.  the line in the file is in brackets.  As a result, the file is opened, but does not go to the desired line. </p><br><p>  To solve this problem, you can convert the log output to the format we need using the stream editor sed. </p><br><p> <code>sed -E 's/#([0-9]+) (.+\.php)\(([0-9]+)\):/#\1 \2:\3/g'</code> </p> <br><p>  Example of tail output processing </p><br><p> <code>tail test.log | sed -E 's/#([0-9]+) (.+\.php)\(([0-9]+)\):/#\1 \2:\3/g'</code> </p> <br><p>  In conclusion, I would like to emphasize once again that this scheme works with almost any language and any IDE from JetBrains. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/315690/">https://habr.com/ru/post/315690/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315678/index.html">Https support without any settings</a></li>
<li><a href="../315680/index.html">Greenland programmer (PHP creator): ‚ÄúI hate programming. But I love to solve problems. ‚Äù</a></li>
<li><a href="../315682/index.html">The digest of interesting materials for the mobile # 180 developer (November 14-20)</a></li>
<li><a href="../315684/index.html">Mars rover, landing coordinates</a></li>
<li><a href="../315688/index.html">Silent software development crisis</a></li>
<li><a href="../315694/index.html">We continue to set up almost free advertising on Habr users. This time using the authorization widget</a></li>
<li><a href="../315696/index.html">Played == okay</a></li>
<li><a href="../315700/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ237 (November 14 - 20, 2016)</a></li>
<li><a href="../315702/index.html">Beta versions of 3CX clients for Android and iOS, and solving the problem with 3CX activation on Windows 7</a></li>
<li><a href="../315706/index.html">Five systemd tools to start using right now</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>