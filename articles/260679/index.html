<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Aggregation of time series data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, we open a series of publications on specific problems solved as part of the implementation of AggreGate, which we hope will be able t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Aggregation of time series data</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/409/036/b8c/409036b8c32c46b0a90f5ad8d5eb4794.jpg"><br><br>  In this article, we open a series of publications on specific problems solved as part of the implementation of AggreGate, which we hope will be able to help you in your real projects. <br><br>  Some time ago, a cellular operator in Africa turned to our partners involved in the manufacture and maintenance of integrated power supply systems for base stations.  The project was designed for 1000-2000 base stations.  As part of this project, AggreGate was used to monitor, control, visualize, and build reports.  Logging system operation required reports, with which you can quickly see the basic parameters of the equipment.  These reports were later used to form the KPI of the power supply system, select the optimal parameters, determine the maintenance schedule and build a route for the engineering team. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We have created a flexible tool for AggreGate that allows you to conveniently create this table using both historical data and statistical data.  Function <b><a href="http://aggregate.tibbo.com/docs/ru/index.htm%3Fls_conref_utils.htm">summary ()</a></b> .  In this article we will look at how to get a table of data on historical values. <br><a name="habracut"></a><br>  In our example, I propose to use data on the ambient temperature and the SOC temperature used in the sites to control energy sources. <br><br>  <b>STEP 1: Choose which fields of the variable we need.</b> <br>  It is most convenient to study the device snapshot and determine which names of the fields of interest to us. <br><img src="https://habrastorage.org/files/675/701/a05/675701a0506040fd9234f251186d63eb.jpg"><br><br>  <b>STEP 2: We write the expression to get the data and understand the parameters of the function.</b> <br><img src="https://habrastorage.org/files/2b7/9b7/af2/2b79b7af2d5949d3a6613601ed8b84df.jpg"><br><br>  To call the function <b>summary ()</b> , which is in the context of utilities, we used the function <b>callFunction ()</b> , which allows us to call a function of any context and pass parameters for this function: <br><br>  <b>subtable (callFunction ("utilities", "summary", "systemCPUTemperature", "System CPU Temperature", date (2015, 05, 10, 0, 0, 0), date (2015, 05, 19, 0, 0, 0 ), "Users.d3.devices.TH3DGM", "device_data", 1, "{system_cpu_temperature}", null, 4, 2, 0, 0, null, null, null, true, false, 0), "periodName" , ‚ÄúContext‚Äù, ‚ÄúsystemCPUTemperature‚Äù)</b> <br><br>  Where: <br>  1) <b>‚ÄúsystemCPUTemperature‚Äù</b> field ID in the resulting table (without spaces). <br>  2) <b>‚ÄúSystem CPU Temperature‚Äù</b> Description of the field in the resulting table. <br>  3) <b>date (2015, 05, 10, 0, 0, 0)</b> Start date <br>  4) <b>date (2015, 05, 19, 0, 0, 0)</b> End date <br>  5) <b>‚Äúusers.d3.devices.TH3DGM‚Äù</b> Path to device context or mask. <br>  6) <b>‚Äúdevice_data‚Äù</b> ID of the variable on which the function will work. <br>  7) <b>1</b> Data type, in our case - variable, it is also possible to work with events. <br>  8) <b>"{system_cpu_temperature}"</b> Expression to calculate the field value in the resulting table.  In our case, this is the value of the system_cpu_temperature field. <br>  9) <b>null</b> Expression to calculate the date.  (By default, the time stamp is taken from the database, if you need to use another date, you can write an expression here so that the date is the same variable field) <br>  10) <b>4</b> Period of data aggregation. <br>  11) <b>2</b> Type of aggregation (max in our example) <br>  12) <b>0</b> Type of value changes (we have raw data) <br>  13) <b>0</b> Data normalization (we ignore such data in our example) <br>  14) <b>null</b> Minimum allowed value for batch input <br>  15) <b>null</b> Maximum allowed value for batch input <br>  16) <b>null</b> Time zone of initial data (we use server time zone) <br>  17) <b>true</b> Whether to show the result for each period of aggregation. <br>  18) <b>false</b> Whether to show the final result for the entire selected period of the original data. <br>  19) <b>0</b> Sorted by time or by device (we use by time) <br><br>  We get the following table: <br><img src="https://habrastorage.org/files/0fd/497/b44/0fd497b444164ab19d7277b02d38e06c.jpg"><br><br>  <b>STEP 3: We remove the extra fields and enjoy the result.</b> <br><img src="https://habrastorage.org/files/e2b/0d0/d3f/e2b0d0d3f792472d89532237aa1131f4.jpg"><br>  We use the <b><a href="http://aggregate.tibbo.com/docs/ru/index.htm%3Fls_internals_expressions_functions.htm">subtable ()</a></b> function, with the first parameter we submit our table, and then we list which fields we want to leave. <br><br><img src="https://habrastorage.org/files/7e7/399/80e/7e739980ec9049a1be980abb916f043e.jpg"><br><br>  In the next post, we will look at how AggreGate‚Äôs built-in tools work with events and how to parameterize your queries and reports to make them more flexible and versatile. <br>  We will be glad to any suggestions about what to describe in the following articles and your personal experience, solving specific problems. </div><p>Source: <a href="https://habr.com/ru/post/260679/">https://habr.com/ru/post/260679/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260667/index.html">Google, Microsoft, Mozilla, and others have teamed up to launch WebAssembly, a new binary format for the Web.</a></li>
<li><a href="../260669/index.html">Thread pools: NGINX accelerates 9 or more times.</a></li>
<li><a href="../260671/index.html">Digest about 2GIS technologies</a></li>
<li><a href="../260673/index.html">What was the main Russian-speaking testers conference in 2015?</a></li>
<li><a href="../260675/index.html">Unusual hackathon according to open data</a></li>
<li><a href="../260681/index.html">Anatomy of virtual telephony. Introduction to the interface</a></li>
<li><a href="../260683/index.html">Free speech recognition from the Russian company Stel</a></li>
<li><a href="../260685/index.html">Erasure Code - more storage space on Nutanix</a></li>
<li><a href="../260691/index.html">The history of light and shadow in one small but proud game</a></li>
<li><a href="../260693/index.html">Fighting phishing and malicious Web links in email</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>