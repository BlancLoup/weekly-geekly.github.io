<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>C # language is almost functional</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear readers! Our searches in the field of C # language have much in common with this article, the author of which is a specialist in functiona...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>C # language is almost functional</h1><div class="post__text post__text-html js-mediator-article">  Hello, dear readers!  Our searches in the field of C # language have much in common with this article, the author of which is a specialist in functional programming in C #.  The article is an excerpt from the upcoming book, so at the end of the post we suggest voting for this book. <br><br><img src="https://habrastorage.org/files/e1b/694/f55/e1b694f554424d9c8bbbde5be94ddd91.jpeg"><br><a name="habracut"></a><br>  Many programmers implicitly imply that "functional programming (FP) should be implemented only in a functional language."  C # is an object-oriented language, so you should not even try to write functional code on it. <br><br>  Of course, this is a superficial interpretation.  If you have a little deeper knowledge of C # and imagine its evolution, then you probably know that C # is multi-paradigm (just like F #) and that, even if it was originally imperative and object-oriented, in each subsequent versions added and continue to add numerous features. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, the question arises: how good is the current C # language for functional programming?  Before answering this question, I will explain what I mean by "functional programming".  This is a paradigm in which: <br><br><ol><li>  Emphasis is placed on working with functions. </li><li>  It is customary to avoid state changes. </li></ol><br>  In order for a language to promote programming in this style, it must: <br><br><ol><li>  Support functions as elements of 1st class;  that is, it should be possible to treat a function like any other value, for example, use functions as arguments or return values ‚Äã‚Äãof other functions, or store functions in collections </li><li>  Prevent any partial ‚Äúlocal‚Äù replacements (or make them impossible at all): variables, objects, and default data structures should be immutable, and it should be easy to create modified versions of the object </li><li>  Automatically manage memory: after all, we create such modified copies, and do not update the data on the spot, and as a result we multiply objects.  This is impractical in a language where there is no automatic memory management. </li></ol><br>  With all this in mind, we put the question squarely: <br><br>  <b>How much is C # functional?</b> <br><br>  Well ... let's see. <br><br>  1) Functions in C # are really first class values.  Consider, for example, <br>  The following code: <br><br><pre><code class="cs hljs">Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; triple = x =&gt; x * <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = Enumerable.Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> triples = range.Select(triple); triples <span class="hljs-comment"><span class="hljs-comment">// =&gt; [3, 6, 9]</span></span></code> </pre> <br>  Here you can see that functions are really first-class values, and you can assign a function to a triple variable, and then set it as a Select argument. <br><br>  In fact, support for functions as first-class values ‚Äã‚Äãexisted in C # from the first versions of the language; this was done using the Delegate type.  Subsequently, lambda expressions were introduced, and syntax support for this feature only improved. <br><br>  The language reveals some quirks and limitations when it comes to type inference (especially if we want to pass multi-argument functions to other functions as arguments);  we'll talk about this in Chapter 8. But, in general, function support as first-class values ‚Äã‚Äãis quite good here. <br><br>  2) Ideally, the language should also suppress local replacements.  Here is the biggest drawback of C #;  everything is changeable by default, and the programmer needs a lot of work to ensure immutability.  (Compare with F #, where variables are immutable by default, and in order for a variable to be changed, it must be specifically marked as mutable.) <br><br>  What about types?  There are several immutable types in the framework, for example, string and DateTime, but the user-defined changeable types are poorly supported in the language (although, as will be shown below, the situation has been slightly corrected in C #, and should also be improved in future versions).  Finally, collections in the framework are mutable, but there is already a solid library of immutable collections. <br><br>  3) On the other hand, C # fulfills a more important requirement: automatic memory management.  Thus, although the language does not stimulate a programming style that does not allow local substitutions, programming in this style in C # is convenient due to garbage collection. <br><br>  So, in C #, some (but not all) functional programming techniques are very well supported.  The language is evolving, and the support for functional techniques in it is improving. <br><br>  Next, we will look at several features of C # from the past, present, and foreseeable future ‚Äî we will focus on features that are especially important in the context of functional programming. <br><br>  <b>LINQ functional entity</b> <br><br>  When C # 3 came out at the same time as the .NET 3.5 framework, there were a lot of possibilities, essentially borrowed from functional languages.  Some of them were included in the library ( <code>System.Linq</code> ), and some other features provided or optimized certain LINQ features ‚Äî for example, extension methods and expression trees. <br><br>  LINQ proposes implementations of many common list operations (or, more generally, over ‚Äúsequences‚Äù, that‚Äôs the technical point of view to call <code>IEnumerable</code> );  The most common of these operations are mapping, sorting, and filtering.  Here is an example in which all three are presented: <br><br><pre> <code class="cs hljs">Enumerable.Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>). Where(i =&gt; i % <span class="hljs-number"><span class="hljs-number">20</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>). OrderBy(i =&gt; -i). Select(i =&gt; $‚Äù{i}%‚Äù) <span class="hljs-comment"><span class="hljs-comment">// =&gt; [‚Äú100%‚Äù, ‚Äú80%‚Äù, ‚Äú60%‚Äù, ‚Äú40%‚Äù, ‚Äú20%‚Äù]</span></span></code> </pre> <br>  Notice how Where, OrderBy, and Select take other functions as arguments and do not change the resulting IEnumerable, but return a new IEnumerable, illustrating both the FP principles I mentioned above. <br><br>  LINQ allows you to query not only objects in memory (LINQ to Objects), but also various other data sources, such as SQL tables and data in XML format.  Programmers working with C # have recognized LINQ as the standard tool for working with lists and relational data (and such information accounts for a substantial part of any code base).  On the one hand, this means that you already have a little idea what the API of the functional library is. <br><br>  On the other hand, when working with other types, C # specialists usually follow an imperative style, expressing the intended behavior of the program in the form of sequential flow control instructions.  Therefore, most of the C # code bases I‚Äôve seen are intersecting the functional (working with <code>IEnumerable</code> and <code>IQueryable</code> ) and imperative styles (everything else). <br><br>  Thus, although C # programmers are aware of the advantages of working with a functional library, for example, with LINQ, they are not sufficiently familiar with the principles of the LINQ device, which prevents them from using such techniques themselves when designing. <br>  This is one of the problems that my book is intended to solve. <br><br>  <b>Functionality in C # 6 and C # 7</b> <br><br>  Although C # 6 and C # 7 are not as revolutionary as C # 3, these versions introduce many small changes to the language, which together significantly increase the usability and idiomaticity of the syntax when writing code. <br><br>  <b>NOTE</b> : Most innovations in C # 6 and C # 7 optimize syntax, rather than complement the functionality.  Therefore, if you work with the old version of C #, you will still be able to use all the techniques described in this book (unless there will be a little more manual work).  However, new features greatly increase the readability of the code, and programming in the functional style becomes more pleasant. <br><br>  Consider how these features are implemented in the listing below, and then we discuss why they are important in the FI. <br><br>  <i>Listing 1. C # 6 and C # 7 features that are important in the context of functional programming</i> <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> System.Math; &lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Circle</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Circle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius</span></span></span><span class="hljs-function">)</span></span> =&gt; Radius = radius; &lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Radius { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } &lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Circumference &lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt; =&gt; PI * <span class="hljs-number"><span class="hljs-number">2</span></span> * Radius; &lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Area { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Square</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> d</span></span></span><span class="hljs-function">)</span></span> =&gt; Pow(d, <span class="hljs-number"><span class="hljs-number">2</span></span>); &lt;<span class="hljs-number"><span class="hljs-number">4</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> PI * Square(Radius); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Circumference, <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Area) Stats &lt;<span class="hljs-number"><span class="hljs-number">5</span></span>&gt; =&gt; (Circumference, Area); }</code> </pre> <br><ol><li>  <code>using static</code> provides unqualified access to the static <code>System.Math</code> members, for example, <code>PI</code> and <code>Pow</code> below </li><li>  The <code>getter-only</code> auto property can <code>getter-only</code> be set in the constructor. </li><li>  Property in the body of the expression </li><li>  Local function is a method declared inside another method. </li><li>  C # 7 tuple syntax allows member names </li></ol><br>  <b>Import static members with using static</b> <br><br>  The <code>using static</code> in C # 6 allows you to ‚Äúimport‚Äù static class members (in this case, the <code>System.Math</code> class).  Thus, in our case, you can call the members of <code>PI</code> and <code>Pow</code> from <code>Math</code> without additional qualifications. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> System.Math; <span class="hljs-comment"><span class="hljs-comment">//... public double Circumference =&gt; PI * 2 * Radius;</span></span></code> </pre> <br>  Why is it important?  In the FP, priority is given to such functions, whose behavior depends only on their input arguments, since each such function can be separately tested and reasoned about it out of context (compare with the methods of the instances, the implementation of each of them depends on the members of the instance).  These functions in C # are implemented as static methods, so the functional library in C # will consist mainly of static methods. <br><br>  The <code>using static</code> facilitates the consumption of such libraries and, although its abuse can lead to namespace pollution, moderate use gives clean, readable code. <br><br>  <b>More simple immutable types with getter-only auto-properties</b> <br><br>  When <code>getter-only</code> declares auto-properties, for example, <code>Radius</code> , the compiler implicitly declares a readonly backup field.  As a result, the value of these properties can be assigned only in the constructor or inline. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Circle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius</span></span></span><span class="hljs-function">)</span></span> =&gt; Radius = radius; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Radius { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; }</code> </pre> <br>  <code>Getter-only</code> auto <code>Getter-only</code> properties in C # 6 make it easy to define immutable types.  This is seen in the example of the Circle class: it has only one field (a backup <code>Radius</code> field) that is read-only;  so, having created <code>Circle</code> , we can no longer change it. <br><br>  <b>More concise functions with members in the body of the expression</b> <br><br>  The <code>Circumference</code> property <code>Circumference</code> declared along with the ‚Äúexpression body‚Äù, which begins with <code>=&gt;</code> , and not with the usual ‚Äúinstruction body‚Äù contained in <code>{ }</code> .  Pay attention to how concise this code is compared to the Area property! <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Circumference =&gt; PI * <span class="hljs-number"><span class="hljs-number">2</span></span> * Radius;</code> </pre> <br>  In FP, it is customary to write a set of simple functions, among which there is a full one-line function.  These functions are then assembled into more complex worker control threads.  Methods declared in the body of the expression, in this case, minimize syntactic interference.  This is especially obvious if you try to write a function that returns a function ‚Äî this is done very often in a book. <br><br>  The syntax with the declaration in the body of the expression appeared in C # 6 for methods and properties, and in C # 7 it became more universal and is also used with designers, destructors, getters and setters. <br><br>  <b>Local functions</b> <br><br>  If you have to write a lot of simple functions, this means that often a function is called from just one place.  In C # 7, this can be programmed explicitly by declaring methods in the method scope;  for example, the Square method is declared in the <code>Area</code> getter scope. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Square</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> d</span></span></span><span class="hljs-function">)</span></span> =&gt; Pow(d, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> PI * Square(Radius); }</code> </pre> <br>  Optimized tuple syntax <br><br>  Perhaps this is the most important property of C # 7.  Therefore, you can easily create and consume tuples and, most importantly, assign meaningful names to their elements.  For example, the <code>Stats</code> property returns a tuple of type <code>(double, double)</code> , but additionally specifies meaningful names for the elements of the tuple, and by these we can refer to these elements. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Circumference, <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Area) Stats =&gt; (Circumference, Area);</code> </pre> <br>  The reason for the importance of tuples in the OP is, again, explained by the same tendency: to break tasks into as compact functions as possible.  You may not have a data type that is used to capture information returned by just one function and accepted by another function as input.  It would be irrational to determine for such structures the selected types that do not correspond to any abstractions from the subject area ‚Äî exactly in such cases tuples will be useful. <br><br>  <b>Will C # become more functional in the future?</b> <br><br>  When at the beginning of 2016 I wrote a draft of this chapter, I noted with interest that all the features that evoked a "strong interest" in the development team are traditionally associated with functional languages.  Among these features: <br><br><ul><li>  Registered types (immutable types without a stencil code) </li><li>  Algebraic data types (a powerful addition to the type system) </li><li>  Pattern matching (recalls the `switch` operator toggles data‚Äú form ‚Äù, for example, their type, not just the value) </li><li>  Optimized tuple syntax </li></ul><br>  However, I had to be content with only the last point.  Comparison with the template has been implemented to a limited extent, but for now this is only a faint shadow of the comparison with the template available in functional languages, and in practice this version is usually not enough. <br><br>  On the other hand, such opportunities are planned in the next versions, and the relevant proposals are already being worked out.  Thus, in the future, we are likely to see in C # registered types and pattern matching. <br><br>  So, C # will continue to develop as a multi-paradigm language with an increasingly pronounced functional component. </div><p>Source: <a href="https://habr.com/ru/post/321546/">https://habr.com/ru/post/321546/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321534/index.html">How to get the top five using data analysis?</a></li>
<li><a href="../321538/index.html">VxRail Hyper Converged Devices</a></li>
<li><a href="../321540/index.html">How to fill 100 timeshits in 2 minutes</a></li>
<li><a href="../321542/index.html">PIC Controller Programming Tools</a></li>
<li><a href="../321544/index.html">Events and streams. Part 1</a></li>
<li><a href="../321548/index.html">How smart contracts will change our lives</a></li>
<li><a href="../321550/index.html">It's hard to be a junior</a></li>
<li><a href="../321552/index.html">The first application on Spring Boot + ReactJS</a></li>
<li><a href="../321554/index.html">About ranks and virtualization in RAM</a></li>
<li><a href="../321558/index.html">Is it worth it for a IT start-up cofounder to learn programming?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>