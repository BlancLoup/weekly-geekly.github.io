<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Access MySQL data from a UWP application without using services</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Windows Store and UWP applications, web services must be used to access databases stored on the network. If you use Azure databases, then you can u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Access MySQL data from a UWP application without using services</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/7af/02e/335/7af02e33516e4efcb71747073ddaf7d8.png"></div><br><br>  In Windows Store and UWP applications, web services must be used to access databases stored on the network.  If you use Azure databases, then you can use a service like <a href="https://habrahabr.ru/post/277567/">Azure Mobile Apps</a> <br><br>  Let me teach you the ‚Äúbad‚Äù and tell you how you can access data from the MySQL database in the UWP application directly using Connector / Net.  The code will be identical for .Net WPF applications. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/files/9c6/b52/945/9c6b529453eb4a58bfbf7b1d283543be.jpg"></div><br><a name="habracut"></a><br>  Using direct data access is not recommended for obvious reasons.  The connection string is stored in the application, so anyone who downloads the application can potentially access the string.  This is partly why in UWP applications there are no specific opportunities for working with data directly.  In addition, updating the service logic will immediately affect all applications attached to it, while forcing all users to instantly update the application will fail. <br><br>  Why use a non-recommended method?  You can find some use cases.  For example, I came up with the option of creating the MySQL database admin application for easy editing of phone records.  Of course, there is also an option to create a user with read-only rights.  In some cases, it can be used, despite the fact that the name of the server and database is compromised in the connection string.  Alternatively, you can force the user to enter the data required for authorization each time. <br><br>  As a test database, I use ClearDB's MySQL cloud database, which can be created in Azure.  Owners of a free student account DreamSpark can create such a database for free.  However, the method that I describe is suitable for any MySQL database, and not just for databases deployed in the Azure cloud. <br><br>  Creating a database is quite simple.  On the new <a href="https://portal.azure.com/">Azure portal,</a> click the plus <a href="https://portal.azure.com/">sign</a> in the menu, select ‚ÄúData + Storage‚Äù - ‚ÄúMySQL Database‚Äù, set the name of the database, configure the parameters and agree to the terms. <br><br><img src="https://habrastorage.org/files/c73/f03/0df/c73f030dfac54b718d54dbccf8319fa8.PNG"><br><br>  Literally in a minute the base will be deployed. <br><br><img src="https://habrastorage.org/files/e5c/fef/dff/e5cfefdff6bc4f7397a718f7bd026497.PNG"><br><br>  Now you can find the connection string in the properties. <br><br><img src="https://habrastorage.org/files/12b/ff2/94b/12bff294ba4b49d0be86591c87aa874b.PNG"><br><br>  As I already mentioned, we need Connector / Net to work with the MySQL database. <br><br>  At the time of writing, NuGet has issued MySQL.Net Connector / Net version 6.6.4. <br>  And on the site mysql <a href="http://dev.mysql.com/doc/connector-net/en/connector-net-versions.html">Chapter 2 Connector / Net Versions</a> indicated that WinRT applications are supported, starting with version 6.7 <br>  So you have to download the installer from the official site: <a href="https://dev.mysql.com/downloads/connector/net/6.9.html">Download Connector / Net</a> <br><br>  When installing using the installer, you will be prompted to install the examples in C # and VB.  The examples turned out to be on .Net version 2.0, so they seemed to me not very relevant (for me, even .Net of this version was not installed). <br><br>  Let's proceed to the creation of the application.  In Visual Studio, we create a project for a universal Windows application.  Add to it a link to the library <b>MySql.Data.RT.dll</b> , which should be located at <br>  <b>C: \ Program Files (x86) \ MySQL \ MySQL Connector Net 6.9.8 \ Assemblies \ RT \</b> <br>  Officially, UWP is not yet supported, but the WinRT library is quite suitable for universal applications (after all, the UWP is based on the WinRT API, although not all of WinRT is available or used in UWP). <br><br>  If you have a WPF application, then you need a library. <br>  <b>C: \ Program Files \ MySQL \ MySQL Connector Net 6.9.8 \ Assemblies \ v4.5 \ MySql.Data.dll</b> <br><br>  In the manifest of the universal application, you need to add the ability to use the Internet - the Internet (Client).  Usually this feature is installed by default, so just go in and check that the check mark is in the right place. <br><br>  You can write code. <br>  The namespace in which the MySQL classes are located is MySql.Data.MySqlClient.  Add it in order not to be mentioned in the code every time: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MySql.Data.MySqlClient;</code> </pre> <br>  First, an example of how you can create a table and enter data into it: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlConnection connection = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlConnection(<span class="hljs-string"><span class="hljs-string">"Database=as_bfb6f501597b777;Data Source=us-cdbr-azure-west-c.cloudapp.net;User Id=b74038821f5aea;Password=2564f4e5;SslMode=None;"</span></span>)) { connection.Open(); MySqlCommand createCommand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlCommand(<span class="hljs-string"><span class="hljs-string">"CREATE TABLE demotable(salary int,surname varchar(255))"</span></span>, connection); createCommand.ExecuteNonQuery(); MySqlCommand addCommand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlCommand(<span class="hljs-string"><span class="hljs-string">"INSERT INTO demotable (salary,surname) VALUES (1234,'')"</span></span>, connection); addCommand.ExecuteNonQuery(); }</code> </pre><br>  Here I created a table with the name demotable with two fields, salary and surname, and entered into it a row with the values ‚Äã‚Äãof last name and salary.  The employee with the surname Vader will receive 1234 for meritorious service. <br>  Pay attention to the connection string.  We took it from the portal.  At the end, you need to add " <b>SslMode = None;</b> ", since Connector / Net does not support SSL for the time being. <br><br>  Now a simple example of reading data. <br>  We need to create a class of the model with the same fields that are in our database.  We do it like this: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CloudTable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _surname; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> surname { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _surname; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { _surname = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _salary; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> salary { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _salary; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { _salary = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } }</code> </pre><br>  Then you can declare a collection in the code of our page: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ObservableCollection&lt;CloudTable&gt; demodata = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObservableCollection&lt;CloudTable&gt;();</code> </pre><br>  The data will be displayed in a ListView.  Let the XAML code be like this: <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myListView"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"400"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"400"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20,20,0,0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemsSource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListView.ItemTemplate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DataTemplate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Path=surname}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Path=salary}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DataTemplate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListView.ItemTemplate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListView</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  As you can see, I didn‚Äôt bother too much and made the display template for the list item just as a panel, inside which there are 2 text blocks.  The block text values ‚Äã‚Äãare bound to the surname and salary values ‚Äã‚Äãfrom the data context.  We will set the data context in C # code.  You can, if you wish, make a better design, of course. <br><br>  The code itself for reading data into a collection and linking it to a ListView is as follows: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlConnection connection = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlConnection(<span class="hljs-string"><span class="hljs-string">"Database=as_bfb6f501597b777;Data Source=us-cdbr-azure-west-c.cloudapp.net;User Id=b74038821f5aea;Password=2564f4e5;SslMode=None;"</span></span>)) { connection.Open(); MySqlCommand readCommand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlCommand(<span class="hljs-string"><span class="hljs-string">"SELECT * FROM demotable"</span></span>, connection); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlDataReader reader = readCommand.ExecuteReader()) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (reader.Read()) { demodata.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CloudTable { surname = reader.GetString(<span class="hljs-number"><span class="hljs-number">1</span></span>), salary = reader.GetInt32(<span class="hljs-number"><span class="hljs-number">0</span></span>) }); } } } myListView.DataContext = demodata;</code> </pre><br>  Data is read in a loop, which looks at least old-fashioned.  However, thanks to Connector / Net and for the opportunities that exist. </div><p>Source: <a href="https://habr.com/ru/post/277655/">https://habr.com/ru/post/277655/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277639/index.html">Implementing a MODBUS RTU server using the Fastwel interface module and CoDeSys software</a></li>
<li><a href="../277643/index.html">Load testing - product quality assurance stage</a></li>
<li><a href="../277645/index.html">Amelisa. Offline and realtime engine for React and Mongo</a></li>
<li><a href="../277649/index.html">50 shades of paranoia or how to store passwords without saving</a></li>
<li><a href="../277653/index.html">Installing a Django project on a VPS (centOS 7) [For Beginners]</a></li>
<li><a href="../277657/index.html">Your cloud hosting in 5 minutes. Part 0: Virtualization</a></li>
<li><a href="../277663/index.html">What we should build LVM (principle of operation, performance, Thin Provision)</a></li>
<li><a href="../277665/index.html">Alternative to native support module in JIRA</a></li>
<li><a href="../277669/index.html">Java.util.concurrent. * Synchronizer reference</a></li>
<li><a href="../277671/index.html">Math on the fingers: linear-quadratic controller</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>