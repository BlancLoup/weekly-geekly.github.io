<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ESET CrackMe - CONFidence 2o1o</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For several years now, Eset has been sponsoring a conference dedicated to the practical aspects of information security - CONFidence . And every year ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ESET CrackMe - CONFidence 2o1o</h1><div class="post__text post__text-html js-mediator-article">  For several years now, Eset has been sponsoring a conference dedicated to the practical aspects of information security - <a href="http://2010.confidence.org.pl/">CONFidence</a> .  And every year we offer a task in the form of a crackme, for a quick solution of which valuable prizes are given.  This year, our <a href="http://habrahabr.ru/company/eset/blog/86397/">Polish office</a> , which officially opened at the beginning of the year, prepared a very original task.  After all, the conference was held in their hometown, in Krakow. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/82c/bff/5f4/82cbff5f493d1df247f4f4ea5dc1ace8.png" alt="image"><br><br>  If you want to try your hand, then do not read the information rolled up, as there we published a description of the registration code verification algorithm.  Download crackme <a href="">here</a> . <br><a name="habracut"></a><br>  With the passage of last year's crackme can be found <a href="http://gynvael.coldwind.pl/%3Fid%3D198">here</a> , but, in our opinion, this year's task is more interesting.  We did not know in advance the principles of its successful passage, and we passed it under identical conditions with the participants of the competition. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A virtual machine that performs calculations with the entered data, based on the simplest bit operations, has fallen into the technological basis of computing the correct registration code.  This kind of code virtualization is used to build software protection against illegal distribution and copying.  For example, the protectors VmProtect and Themida (considered by the people as one of the most complex protections for reverse analysis) also use the technology of converting the original program code into some byte code.  This byte code is already executed by the virtual machine's handlers, which is largely redundant in order to complicate the inverse analysis and restoration of the logic of the original algorithm. <br><br>  Let's return to our virtual machine, which has at its disposal 8 pseudo-registers, let's call them conditionally: rA, rB, rC, rD, rE, rF, rG, rH.  Each register has a size of 1 bit.  The set of supported commands is as follows: <br><br>  <b>ret</b> - virtual machine shutdown; <br><br>  <b>set</b> <i>&lt;</i> register_name <i>&gt;</i> - set the register value to one state; <br><br>  <b>jz</b> <i>&lt;</i> <b>register_name</b> <i>&gt;</i> - conditional command transfer control (if the contents of the register is 0, then the control is transferred to the following procedure (procedures are arranged in the memory sequentially)); <br><br>  <b>and</b> <i>&lt;register_name1&gt;, &lt;register_name2&gt;</i> is a logical operation, the result is stored in the first register; <br><br>  <b>mov</b> <i>&lt;register_name1&gt;, &lt;register_name2&gt;</i> - copy the contents of the second register to the first; <br><br>  <b>mov</b> <i>&lt;register_name, &lt;address&gt;</i> - copy the contents of the memory (bit) at the specified address into the specified register; <br><br>  <b>mov</b> <i>&lt;address&gt;, &lt;register_name&gt;</i> - copy the contents of the specified register (bit) to the specified address in memory <br><br>  The size of the virtual machine instruction has a fixed size and is 2 bytes.  The principle of coding instructions can be represented in the form of the following scheme: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b9/400/60f/6b940060f05e2d5078b526b6fd4d99b4.png" alt="image"><br><br>  This virtual machine performs the conversion of the contents of the memory, in accordance with the control sequence (which just needs to be found), which is also located in the memory: <br><br>  <i>start of memory + 0x00: control sequence (16 bytes)</i> <br><br>  <i>beginning of memory + 0x10: hash value from the entered name (16 bytes)</i> <br><br>  <i>start of memory + 0x20: encrypted hash value (16 bytes)</i> <br><br>  <i>start of memory + 0x30: the result of the virtual machine function conversion (16 bytes)</i> <br><br>  The processing cycle of the virtual machine commands does not look too hard compared to the analogs of commercial protectors. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/29e/7fd/601/29e7fd6019d494acc19befe5f01c1904.png" alt="image"><br><br>  For a more convenient analysis of the byte-code of commands executed by the virtual machine, we wrote a processor module for the IDA Pro disassembler, which greatly simplified our further analysis.  This is how a set of commands looks like before their conversion by our processor module: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ee7/d8c/da7/ee7d8cda74b5594dbdd3af082c535f2c.png" alt="image"><br><br>  And in the picture below is a variant of processing by the processor module: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/895/a19/b88/895a19b88198a87256ac6512721f96c9.png" alt="image"><br><br>  We gave the name to the teams, similar to the analogs from the x86 assembler already familiar to us.  But further analysis revealed the redundancy of the initial instruction set, since  modulo-two addition (exclusive or) operations were expressed in terms of equivalent calculations using other Boolean operations.  After that, we decided to implement optimization in our processor module, which greatly reduced after that the volumes of the analyzed code that calculates the registration number. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/764/b1c/76b/764b1c76b3c34821063d326305c12311.png" alt="image"><br><br>  We decided not to post the source code of the generator of the correct registration numbers so that you still have a research fuse, see for yourself this crackme. <br><br>  But we still give some correct combinations as an example: <br><br>  <b>Name:</b> habrahabr <br>  <b>Registration Code:</b> 984116e52ad86d6bd144b11b975a595e <br><br>  <b>Name:</b> SVH <br>  <b>Registration Code:</b> 271a300e1174f46f944c5c67dc59dd57 <br><br>  <b>Name:</b> CONFidence <br>  <b>Registration Code:</b> 24a2b8dc7c1578de64f8e8e114c2bf00 </div><p>Source: <a href="https://habr.com/ru/post/96263/">https://habr.com/ru/post/96263/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../96255/index.html">User data protection</a></li>
<li><a href="../96257/index.html">Apple Inc. is going to buy ARM Holdings again?</a></li>
<li><a href="../96259/index.html">Foxconn closes its factories in China</a></li>
<li><a href="../96260/index.html">Eight daring, or "Causes Taimyr!", Part One</a></li>
<li><a href="../96262/index.html">Drupal at the 2010 FIFA World Cup</a></li>
<li><a href="../96266/index.html">Habrafutbol: orgpost</a></li>
<li><a href="../96268/index.html">Tour of the World Cup 2010 stadiums using a flight over Bing Maps</a></li>
<li><a href="../96269/index.html">Real Walle</a></li>
<li><a href="../96270/index.html">Google Maps: Explore South Africa</a></li>
<li><a href="../96271/index.html">Confidentiality in communication networks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>