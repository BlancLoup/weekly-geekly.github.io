<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IoT example: Making a bitcoin monitor from a Nokia screen, a Netduino board and a cloud</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="My intern and I were asked to speak at Durban University of Technology to third-year students in order to inspire them with the possibilities of using...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IoT example: Making a bitcoin monitor from a Nokia screen, a Netduino board and a cloud</h1><div class="post__text post__text-html js-mediator-article">  My intern and I were asked to speak at Durban University of Technology to third-year students in order to inspire them with the possibilities of using Netduino and / or Windows Phone in their projects. <br><br>  We wanted to show not just a flashing LED, but something that would be relevant to real live scenarios.  And we decided to demonstrate this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/92d/5fd/ffe/92d5fdffe5ee2dbbcce94c3fbe1f23b0.gif">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Sorry for the terrible gif.  You can call it a bitcoin price tracker.  The graph reflects the change, and the LED changes to green when the price rises and red when the price drops.  (You may find a typo on the screen - instead of USD, BTC should be displayed). <br><a name="habracut"></a><br> <a href=""><img alt="WP_20140213_10_14_46_Pro - Copy" src="https://habrastorage.org/getpro/habr/post_images/be6/cc6/abe/be6cc6abedb5c04f25fc26f0da2cc622.jpg" width="640" height="360"></a> <br><br><h3>  Azure </h3><br>  The first obvious step for us is to determine where the data will come from.  One of the simple and easy-to-use APIs comes from <a href="https://data.mtgox.com/api/2/BTCUSD/money/ticker">mtgox</a> (note: due to various kind of conflicting discussions around them, it may make sense to use something like Bitstamp).  The problem is that, along with the price data we need, the source produces a lot of other data that would be too expensive to load and process on Netduino.  The solution is to create an intermediate service between the device and the API, which cuts out unnecessary data.  And doing it with Azure is REALLY easy. <br><br>  Create a new website on the Azure portal: <br><br> <a href=""><img title="image" alt="image" src="https://habrastorage.org/getpro/habr/post_images/583/790/f2c/583790f2cbb646d0fa341f43867cb873.png" width="535" height="136"></a> <br><br>  Specify any URL as desired and start the creation of the site, then going to Visual Studio.  Create a new ASP.NET MVC web application: <br><br> <a href=""><img title="image" alt="image" src="https://habrastorage.org/getpro/habr/post_images/3e7/efe/bd6/3e7efebd6cb4c0c2f21d94f88759765c.png" width="492" height="331"></a> <br><br>  We are going to download the latest price data from the mtgox API and send abbreviated price data.  To do this, we need to deserialize JSON data into .NET objects.  <a href="https://data.mtgox.com/api/2/BTCUSD/money/ticker">Access the API</a> and copy the JSON result.  Then create a new .cs file in the Models folder called <em>MtGoxTicker.cs</em> .  Remove the default class definition and paste the copied text using the <em>Edit&gt; Paste Special&gt; Paste JSON as classes</em> command.  A whole pack of classes that displays the structure of the API will be created automatically.  Rename the RootObject to <em>MtGoxTicker.</em> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MtGoxTicker</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> result { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Data data { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Data</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> High high { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Low low { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Avg avg { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vwap vwap { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vol vol { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Last_Local last_local { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Last_Orig last_orig { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Last_All last_all { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Last last { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Buy buy { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Sell sell { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> item { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> now { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">High</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Low</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Avg</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Vwap</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Vol</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Last_Local</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Last_Orig</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Last_All</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Last</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Buy</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Sell</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> value_int { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> display_short { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> currency { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre> </div></div><br>  In the <em>Controllers</em> folder, create a new WebAPI controller or use one of the existing ones.  You can remove all methods except Get.  All that is required of this method is to load the latest price data from the API and return the single BUY value we need. <br><br>  Change the return data type Get to double, then bring the method to the following form: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs cs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebClient(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = JsonConvert.DeserializeObject&lt;MtGoxTicker&gt;(wc.DownloadString(<span class="hljs-string"><span class="hljs-string">"https://data.mtgox.com/api/2/BTCUSD/money/ticker"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.Parse(response.data.buy.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception) { } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; }</code> </pre> </div></div><br>  Simply put, when someone calls the Get method, it loads prices from the API, deserializes them and returns only the data we need. <br><br>  The last thing we need to do is make our API always return a response in JSON.  Go to the last line of the Appication_Start method in <em>Global.asax.cs</em> and add the following code after the existing lines: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">GlobalConfiguration</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Configuration</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Formatters</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Clear</span></span>(); <span class="hljs-selector-tag"><span class="hljs-selector-tag">GlobalConfiguration</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Configuration</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Formatters</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Add</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">JsonMediaTypeFormatter</span></span>());</code> </pre> <br>  At this point, your website in Azure should have already been created, so we can move on and place the site directly from Visual Studio.  The easiest way to do this is to right-click on the project in Solution Explorer and select the Publsh command.  Then click Import and go through the process of login and import of the details of your Azure subscription (this process looks much nicer in Visual Studio 2013).  Publishing your site may take a minute or two, after which you can go to it. <br><br>  In order to test how your site should look, you can go to my <a href="http://bitcoinpusher.azurewebsites.net/api/Price">http://bitcoinpusher.azurewebsites.net/api/Price</a> (note: I cannot guarantee that this link will work forever). <br><br><h3>  Hardware </h3><br>  - <strong><a href="http://netduino.com/">Netduino</a> Plus (or Plus 2)</strong> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/464/bda/4c0/464bda4c015a0a65f83325f03c6826ae.jpg" width="221" height="155"><br><br>  - <strong>Nokia 5110 LCD</strong> <a href="http://dx.com/p/replacement-1-6-lcd-screen-with-blue-backlight-for-nokia-5110-blue-145860">($ 4 on the DX portal)</a> <br><br>  - <strong>RGB LED -</strong> we used SMD 5050, but any RGB LED will do. <br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e6c/2dc/a26/e6c2dca26ad972806420fab48c4e641f.jpg"><br><br><h3>  Netduino </h3><br>  Netduino will upload the latest price data from the service to Azure, display it and draw a graph.  This process will be repeated periodically in an infinite loop and will update the data as quickly as it can (will depend on the speed of the Internet). <br><br>  To write on the screen of the Nokia 5110 LCD, we will use a library developed by a member of the Netduino community, about which you can read about <a href="http://blog.roguecode.co.za/oldschool-newschool-snake-with-lumia920-controlling-nokia-lcd-netduino">this link</a> .  Keep in mind that there is an error in the line drawing algorithm, so you may need to download the source code (at the end of this article) in order to use my revised version. <br><br>  To simplify network calls, we can use an HTTP client from the <a href="http://netmftoolbox.codeplex.com/">.NET MF Toolbox</a> . <br><br>  Instead of describing the code line by line, I publish all the code in <em>Program.cs</em> with comments.  It is simple enough to understand: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Program { //the red <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> green pins <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the RGB LED private static OutputPort _redPin = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> OutputPort(Pins.GPIO_PIN_D1, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); private static OutputPort _greenPin = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> OutputPort(Pins.GPIO_PIN_D0, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> Main() { //setup the LCD <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> appropriate pins. var lcd = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Nokia_5110(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, Pins.GPIO_PIN_D10, Pins.GPIO_PIN_D9, Pins.GPIO_PIN_D7, Pins.GPIO_PIN_D8) { BacklightBrightness = <span class="hljs-number"><span class="hljs-number">100</span></span> }; //<span class="hljs-keyword"><span class="hljs-keyword">create</span></span> these <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> store <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> var history = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Queue(); <span class="hljs-type"><span class="hljs-type">double</span></span> lastValue = <span class="hljs-number"><span class="hljs-number">0</span></span>; var nextUpdateTime = DateTime.MinValue; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { try { //download the price <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> our API var WebSession = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> HTTP_Client(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> IntegratedSocket("bitcoinpusher.azurewebsites.net", <span class="hljs-number"><span class="hljs-number">80</span></span>)); var response = WebSession.<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>("/api/price/"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.ResponseCode == <span class="hljs-number"><span class="hljs-number">200</span></span>) { //convert the price <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> a <span class="hljs-type"><span class="hljs-type">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> a string var result = <span class="hljs-type"><span class="hljs-type">double</span></span>.Parse(response.ResponseBody); //<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> went up, change the LED <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> green, <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> it went down change <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> red <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result &gt; lastValue) { _greenPin.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); _redPin.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result &lt; lastValue) { _greenPin.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); _redPin.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } //store this <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> so we can compare it <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the next one lastValue = result; //<span class="hljs-keyword"><span class="hljs-keyword">only</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> points <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the graph every x seconds, <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> it will barely <span class="hljs-keyword"><span class="hljs-keyword">move</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DateTime.Now &gt; nextUpdateTime) { history.Enqueue(result); //store a max <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> data points <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> <span class="hljs-type"><span class="hljs-type">point</span></span> will take up <span class="hljs-number"><span class="hljs-number">1</span></span> pixel, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> the screen <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> //<span class="hljs-keyword"><span class="hljs-keyword">only</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> wide <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (history.Count &gt; <span class="hljs-number"><span class="hljs-number">80</span></span>) { history.Dequeue(); } //store a <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> what <span class="hljs-type"><span class="hljs-type">time</span></span> we should <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> the next data <span class="hljs-type"><span class="hljs-type">point</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the list nextUpdateTime = DateTime.Now.AddSeconds(<span class="hljs-number"><span class="hljs-number">15</span></span>); } var high = <span class="hljs-number"><span class="hljs-number">0</span></span>d; var low = <span class="hljs-type"><span class="hljs-type">double</span></span>.MaxValue; //find the max <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> min <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> determine our range (<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the graph). //The reason <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> this <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> so that the min <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> will be the very bottom <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the graph, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> //the max <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> will be the very top <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the graph regardless <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> what the <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> are <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-type"><span class="hljs-type">double</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> history) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item &lt; low) { low = item; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item &gt; high) { high = item; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (high == low) { //<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> numbers are the same, artificially seperate high <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> low so that the //graph will draw <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the middle <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the screen. <span class="hljs-keyword"><span class="hljs-keyword">Without</span></span> doing this the //<span class="hljs-type"><span class="hljs-type">point</span></span> will be at the very top. high<span class="hljs-comment"><span class="hljs-comment">--; low++; } double diff = high - low; lcd.Clear(); short x = 1; short prevY = -1; //this loop draws a line from the previous point to the current point, which makes the graph foreach (double item in history) { //work out the y value based on the min/max range, and the available height. //We have 39 pixels height to work with, and shift it by 9 at the end so it doesn't //overlap the text at the top var thisY = (short)((39 - (((item - low) / diff) * 39)) + 9); if (prevY != -1) //don't draw from 0,0 { //draw a line from the previous point to this point lcd.DrawLine((short)(x - 1), prevY, x, thisY, true); } //remember this pos so we can draw a line from it in the next iteration prevY = thisY; x++; } //Refresh pushes all DrawLine/Rect/Point calls to the screen //Note that this does not apply to writing text, which pushes instantly lcd.Refresh(); //there is no Math.Round(double,int) so use ToString to get 4 decimals lcd.WriteText("$ " + result.ToString("f4") + " / BTC"); } else { FlickerLEDForFaliure(); } } catch (Exception) { FlickerLEDForFaliure(); } } } private static void FlickerLEDForFaliure() { //if the downlaod of the new value fails then flicker the LED. After flickering turn the LED off for (int i = 0; i &lt; 30; i++) { _redPin.Write(true); Thread.Sleep(100); _greenPin.Write(true); Thread.Sleep(100); _redPin.Write(false); Thread.Sleep(100); _greenPin.Write(false); } } }</span></span></code> </pre> </div></div><br>  The following is the connection diagram: <br><br> <a href=""><img alt="BitcoinPusher_bb" src="https://habrastorage.org/getpro/habr/post_images/438/b42/041/438b42041850953dc895584487f9036a.png"></a> <br><br> <a href=""><img alt="WP_20140128_16_08_32_Pro - Copy" src="https://habrastorage.org/getpro/habr/post_images/932/2b8/86f/9322b886fb0f8afcf75ec65d433b8fba.jpg" width="640" height="360"></a> <br><br>  I left this circuit connected for the night and it worked fine.  Disconnection from the network and reverse connection is also processed normally. <br><br><h3>  Windows phone </h3><br>  A Windows Phone application does exactly the same thing as Netduino itself: it loads the price, displays it, and then draws a graph. <br><br>  The UI is just a <em>TextBlock</em> for displaying the price and a <em>Grid</em> that will contain lines. <br><br> <a href=""><img alt="wp_ss_20140202_0001" src="https://habrastorage.org/getpro/habr/post_images/785/9ce/052/7859ce0527fb29d78ef475fd2d9a1aa2.png" width="327" height="546"></a> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"LayoutRoot"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Transparent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Auto"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TitlePanel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"12,17,0,28"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"price"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PriceTextBlock"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"9,-7,0,0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource PhoneTextTitle2Style}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">FontSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"40"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ContentPanel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br>  Below you will find the code.  Please note that since the code is completely based on the code for Netduino, I did not comment on it in detail.  Refer to the code for Netduino, if you do not understand something. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> partial <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MainPage : PhoneApplicationPage { private Queue&lt;<span class="hljs-type"><span class="hljs-type">double</span></span>&gt; _history = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Queue&lt;<span class="hljs-type"><span class="hljs-type">double</span></span>&gt;(); private <span class="hljs-type"><span class="hljs-type">double</span></span> _lastValue = <span class="hljs-number"><span class="hljs-number">0</span></span>; private DateTime _nextUpdateTime = DateTime.MinValue; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> MainPage() { InitializeComponent(); DownloadAndPlotPrice(); } private async <span class="hljs-type"><span class="hljs-type">void</span></span> DownloadAndPlotPrice() { try { var WebSession = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> HttpClient(); var response = await WebSession.GetAsync("http://bitcoinpusher.azurewebsites.net/api/price/"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.IsSuccessStatusCode) { var result = <span class="hljs-type"><span class="hljs-type">double</span></span>.Parse(await response.Content.ReadAsStringAsync()); //<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> went up, change the back <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> green, <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> it went down change <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> red <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result &gt; _lastValue) { LayoutRoot.Background = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SolidColorBrush(Colors.Green); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result &lt; _lastValue) { LayoutRoot.Background = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SolidColorBrush(Colors.Red); } _lastValue = result; //<span class="hljs-keyword"><span class="hljs-keyword">only</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> points <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the graph every x seconds, <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> it will barely <span class="hljs-keyword"><span class="hljs-keyword">move</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DateTime.Now &gt; _nextUpdateTime) { _history.Enqueue(result); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_history.Count &gt; <span class="hljs-number"><span class="hljs-number">400</span></span>) { _history.Dequeue(); } _nextUpdateTime = DateTime.Now.AddSeconds(<span class="hljs-number"><span class="hljs-number">4</span></span>); } var high = <span class="hljs-number"><span class="hljs-number">0</span></span>d; var low = <span class="hljs-type"><span class="hljs-type">double</span></span>.MaxValue; //find the max <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> min <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> determine our range (<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the graph) <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-type"><span class="hljs-type">double</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _history) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item &lt; low) { low = item; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item &gt; high) { high = item; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (high == low) { //<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> numbers are the same, artificially seperate high <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> low so that the //graph will draw <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the middle <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the screen high<span class="hljs-comment"><span class="hljs-comment">--; low++; } double diff = high - low; //remove all previous lines in preperation for redrawing them ContentPanel.Children.Clear(); short x = 1; short prevY = -1; foreach (double item in _history) { //we now have 300 pixels of vertical space to play with var thisY = (short)(300 - (((item - low) / diff) * 300)); if (prevY != -1) //don't draw from 0,0 { //draw a line from the previous point to this point //Line is a XAML control that we use to display lines ContentPanel.Children.Add(new Line { X1 = (x - 1), Y1 = prevY, X2 = x, Y2 = thisY, StrokeThickness = 4, Stroke = new SolidColorBrush(Colors.White) }); } prevY = thisY; x++; } PriceTextBlock.Text = ("$ " + result.ToString("f5") + " / BTC"); } else { ShowFaliureFaliure(); } } catch (Exception) { ShowFaliureFaliure(); } DownloadAndPlotPrice(); } private async void ShowFaliureFaliure() { //if the download of the new value fails then flicker the background. for (int i = 0; i &lt; 30; i++) { LayoutRoot.Background = new SolidColorBrush(Colors.Orange); await Task.Delay(100); LayoutRoot.Background = new SolidColorBrush(Colors.Black); await Task.Delay(100); } } }</span></span></code> </pre> </div></div><br>  That's all.  Let me know if you have questions or problems in the comments (on the original article - approx. Transl.) Or <a href="https://twitter.com/roguecode">on Twitter</a> . <br><br><h3>  You can download the source files <a href="http://aka.ms/Uh0rjz">from here</a> ! </h3><br><h3>  Additional links </h3><br><ul><li><h5>  <a href="http://aka.ms/azure_trial_free_rus">Try Azure</a> for free for 30 days! </h5><br></li><li><h5>  <a href="http://aka.ms/getvsrus">Download</a> free or trial Visual Studio </h5><br></li><li><h5>  Take a training course at the <a href="http://aka.ms/gomvarus">Microsoft Virtual Academy</a> (MVA) </h5><br><ul><li>  <a href="http://www.microsoftvirtualacademy.com/training-courses/app-development-on-microsoft-platform-rus">Application Development on the Microsoft Platform</a> </li><li>  <a href="http://www.microsoftvirtualacademy.com/training-courses/cross-platforming-dev-for-windows-phone-windows-8-rus">Cross-platform application development for Windows Phone and Windows 8</a> </li><li>  <a href="http://www.microsoftvirtualacademy.com/training-courses/build-for-windows-8-windows-phone">Developing applications with common code for Windows 8 and Windows Phone platforms</a> </li><li>  <a href="http://www.microsoftvirtualacademy.com/training-courses/windows-phone-8-for-begginers">Complicated techniques for developing applications for Windows Phone 8</a> </li><li>  <a href="http://www.microsoftvirtualacademy.com/training-courses/advanced-possibilities-appdev-windows-phone-8-rus">Advanced Development Features for Windows Phone 8</a> </li><li>  or <a href="http://www.microsoftvirtualacademy.com/product-training/product-windows-azure-ru">Azure cloud development courses</a> </li><li>  or many other <a href="http://aka.ms/gomvarus">free MVA courses</a> ! </li></ul><br></li><li><h5>  <a href="http://aka.ms/wpstartrus">Become a</a> Windows Phone Application <a href="http://aka.ms/wpstartrus">Developer</a> </h5><br></li></ul></div><p>Source: <a href="https://habr.com/ru/post/228285/">https://habr.com/ru/post/228285/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../228273/index.html">How to correctly issue intellectual rights to the program?</a></li>
<li><a href="../228277/index.html">Up-selling (upselling): increase the average sales receipt</a></li>
<li><a href="../228279/index.html">Gson or "There and Back"</a></li>
<li><a href="../228281/index.html">Electronic passports from 2016 throughout Russia</a></li>
<li><a href="../228283/index.html">Hydrointegrator Lukyanova</a></li>
<li><a href="../228287/index.html">Google plans to lay its own fiber optic cable across the Pacific Ocean.</a></li>
<li><a href="../228289/index.html">We distinguish the bus from the car by GPS tracks</a></li>
<li><a href="../228291/index.html">Development and testing of the ASCAE module</a></li>
<li><a href="../228293/index.html">Now Bitcoin in Ukraine can be bought for cash at any of the 4000 terminals</a></li>
<li><a href="../228295/index.html">Radioisotope thermoelectric generator for Cassini: 10 years on plutonium batteries</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>