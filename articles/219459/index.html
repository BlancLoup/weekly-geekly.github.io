<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Go language for beginners</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The purpose of this article is to tell about the Go programming language (Golang) to those developers who are looking in the direction of this languag...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Go language for beginners</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/667/f8f/496/667f8f4964d6951ab27d15ece675161e.jpg" alt="Gopher" align="left"><br><br>  The purpose of this article is to tell about the <b>Go</b> programming language (Golang) to those developers who are looking in the direction of this language but have not yet decided to take up its study.  The story will be conducted on the example of a real application, which is a RESTful API web service. <br><a name="habracut"></a><br>  My task was to develop a backend for a mobile service.  The essence of the service is quite simple.  Mobile application that shows posts of users located near the current location.  Users can post their comments on posts, which, in turn, can also be commented.  It turns out a kind of geo-forum. <br><br>  I have long wanted to try Go language for any serious projects.  The choice was obvious, since this language is best suited for such tasks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The main advantages of the Go language: <br><br><ul><li>  <b>Simple and clear syntax</b> .  This makes writing code a pleasant experience. </li><li>  <b>Static typing</b> .  Allows you to avoid mistakes made by inattention, simplifies reading and understanding of the code, makes the code unambiguous. </li><li>  <b>Speed ‚Äã‚Äãand compilation</b> .  Go speeds are ten times faster than scripting languages, with less memory consumption.  At the same time, the compilation is almost instantaneous.  The whole project is compiled into one binary file, without dependencies.  As the saying goes, "just add water."  And you do not have to worry about memory, there is a garbage collector. </li><li>  <b>Departure from OOP</b> .  There are no classes in the language, but there are data structures with methods.  Inheritance is replaced by an embedding mechanism.  There are interfaces that do not need to be explicitly implemented, but only enough to implement interface methods. </li><li>  <b>Parallelism</b> .  Parallel computing in the language is done simply, elegantly and without a headache.  Gorutin (something like streams) are lightweight, consume little memory. </li><li>  <b>Rich standard library</b> .  The language has everything you need for web development and not only.  The number of third-party libraries is constantly growing.  In addition, it is possible to use the C and C ++ libraries. </li><li>  <b>The ability to write in a functional style</b> .  The language has closures and anonymous functions.  Functions are first-order objects, they can be passed as arguments and used as data types. </li><li>  <b>Authoritative founding fathers and a strong community</b> .  Rob Pike, Ken Thompson, Robert Grizmer stood at the origins.  Now more than 300 contributors have a language.  The language has a strong community and is constantly evolving. </li><li>  <b>Open source</b> </li><li>  <b>Charming talisman</b> </li></ul><br><br>  All these, and many other features allow you to select the language among others.  This is a worthy candidate for the study, besides, mastering the language is quite simple. <br><br>  So back to our task.  Although the language does not impose restrictions on the structure of the project, I decided to organize this application according to the MVC model.  True View is implemented on the client side.  In my case, it was AngularJS, in the future - a native mobile application.  Here I will only talk about the API on the service side. <br><br>  The structure of the project is as follows: <br><br><pre><code class="go hljs">/project/ /conf/ errors.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span> settings.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span> /controllers/ posts.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span> users.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span> /models/ posts.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span> users.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span> /utils/ helpers.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span> loctalk.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span></code> </pre> <br><br>  The program in Go is divided into packages (package), which is indicated at the beginning of each file.  The package name must correspond to the directory in which the files included in the package are located.  Also, there should be a main main package with a main () function.  I have it in the root file of the loctalk.go application.  Thus, I got 5 packages: conf, controllers, models, utils, main. <br>  I will give incomplete content files, but only the minimum necessary for understanding. <br><br>  The conf package contains constants and site settings. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> conf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"os"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ( SITE_NAME <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> = <span class="hljs-string"><span class="hljs-string">"LocTalk"</span></span> DEFAULT_LIMIT <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> MAX_LIMIT <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> = <span class="hljs-number"><span class="hljs-number">1000</span></span> MAX_POST_CHARS <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> = <span class="hljs-number"><span class="hljs-number">1000</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { mode := os.Getenv(<span class="hljs-string"><span class="hljs-string">"MARTINI_ENV"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> mode { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"production"</span></span>: SiteUrl = <span class="hljs-string"><span class="hljs-string">"http://loctalk.net"</span></span> AbsolutePath = <span class="hljs-string"><span class="hljs-string">"/path/to/project/"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: SiteUrl = <span class="hljs-string"><span class="hljs-string">"http://127.0.0.1"</span></span> AbsolutePath = <span class="hljs-string"><span class="hljs-string">"/path/to/project/"</span></span> } }</code> </pre><br><br>  I think there is nothing to comment on.  The init () function is called in each packet before the main () call.  They may be several in different files. <br><br>  Package main. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/go-martini/martini"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> <span class="hljs-string"><span class="hljs-string">"loctalk/conf"</span></span> <span class="hljs-string"><span class="hljs-string">"loctalk/controllers"</span></span> <span class="hljs-string"><span class="hljs-string">"loctalk/models"</span></span> <span class="hljs-string"><span class="hljs-string">"loctalk/utils"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { m := martini.Classic() m.Use(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter)</span></span></span></span> { w.Header().Set(<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>, <span class="hljs-string"><span class="hljs-string">"application/json; charset=utf-8"</span></span>) }) m.Map(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(utils.MarshUnmarsh)) Auth := <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mu *utils.MarshUnmarsh, req *http.Request, rw http.ResponseWriter)</span></span></span></span> { reqUserId := req.Header.Get(<span class="hljs-string"><span class="hljs-string">"X-Auth-User"</span></span>) reqToken := req.Header.Get(<span class="hljs-string"><span class="hljs-string">"X-Auth-Token"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !models.CheckToken(reqUserId, reqToken) { rw.WriteHeader(http.StatusUnauthorized) rw.Write(mu.Marshal(conf.ErrUserAccessDenied)) } } <span class="hljs-comment"><span class="hljs-comment">// ROUTES m.Get("/", controllers.Home) // users m.Get("/api/v1/users", controllers.GetUsers) m.Get("/api/v1/users/:id", controllers.GetUserById) m.Post("/api/v1/users", controllers.CreateUser) // ‚Ä¶ // posts m.Get("/api/v1/posts", controllers.GetRootPosts) m.Get("/api/v1/posts/:id", controllers.GetPostById) m.Post("/api/v1/posts", Auth, controllers.CreatePost) // ... m.Run() }</span></span></code> </pre><br><br>  At the very top is the name of the package.  Next comes the list of imported packages.  We will use the <a href="https://github.com/go-martini/martini">Martini</a> package.  It adds an easy layer for quick and easy creation of web applications.  Notice how this package is imported.  You need to specify the path to the repository from where it was taken.  And to get it, just go to the console to get go github.com/go-martini/martini <br><br>  Next, we create an instance of Martini, configure it and run it.  Pay attention to the ": =" sign.  This is an abbreviated syntax, it means: create a variable of the appropriate type and initialize it.  For example, by writing a: = "hello", we will create a variable of type string and assign it the string "hello". <br><br>  The variable m in our case is of the type * ClassicMartini, and that is what martini.Classic () returns.  * means a pointer, i.e. it is not the value itself that is transmitted, but only a pointer to it.  In the m.Use () method, we pass a handler function.  This Middleware allows Martini to do certain actions on each request.  In this case, we define the Content-Type for each request.  The m.Map () method allows us to bind our structure and then use it in controllers if necessary (mechanism of dependency injection).  In this case, I created a wrapper for encoding the data structure in json format. <br><br>  Immediately we create an internal function Auth, which checks the user's authorization.  It can be inserted into our routes and it will be called before the controller is called.  These things are possible thanks to Martini.  Using the standard library, the code would have been a little different. <br><br>  Take a look at the errors file of the conf package. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> conf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ApiError <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Code <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-string"><span class="hljs-string">`json:"errorCode"`</span></span> HttpCode <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-string"><span class="hljs-string">`json:"-"`</span></span> Message <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"errorMsg"`</span></span> Info <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"errorInfo"`</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e *ApiError)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e.Message } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewApiError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err error)</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ApiError</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &amp;ApiError{<span class="hljs-number"><span class="hljs-number">0</span></span>, http.StatusInternalServerError, err.Error(), <span class="hljs-string"><span class="hljs-string">""</span></span>} } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ErrUserPassEmpty = &amp;ApiError{<span class="hljs-number"><span class="hljs-number">110</span></span>, http.StatusBadRequest, <span class="hljs-string"><span class="hljs-string">"Password is empty"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ErrUserNotFound = &amp;ApiError{<span class="hljs-number"><span class="hljs-number">123</span></span>, http.StatusNotFound, <span class="hljs-string"><span class="hljs-string">"User not found"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ErrUserIdEmpty = &amp;ApiError{<span class="hljs-number"><span class="hljs-number">130</span></span>, http.StatusBadRequest, <span class="hljs-string"><span class="hljs-string">"Empty User Id"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ErrUserIdWrong = &amp;ApiError{<span class="hljs-number"><span class="hljs-number">131</span></span>, http.StatusBadRequest, <span class="hljs-string"><span class="hljs-string">"Wrong User Id"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>} <span class="hljs-comment"><span class="hljs-comment">// ‚Ä¶  . .</span></span></code> </pre><br><br>  The language supports returning multiple values.  Instead of the try-catch mechanism, a technique is often used when the second argument returns an error.  And, if available, it is processed.  There is a built-in error type, which is the interface: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> error <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Error() <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> }</code> </pre><br><br>  Thus, to implement this interface, it is enough to have the Error () string method.  I created my own type for ApiError errors, which is more specific for my tasks, but compatible with the built-in type error. <br><br>  Note the - type ApiError struct.  This is the definition of the structure, the data model that you will use constantly in your work.  It consists of fields of certain types (I hope you have noticed that the data type is written after the variable name).  By the way, other structures can be fields, inheriting all methods and fields.  In single quotes `` tags are specified.  They do not have to be specified.  In this case, they are used by the encoding / json package to specify the name in the json output (the minus sign ‚Äú-‚Äù generally excludes the field from the output). <br><br>  Note that the structure fields are capitalized.  This means that they have scope outside the package.  If you write them in capital letters, they will not be exported, but will be available only within the package.  The same applies to functions and methods.  Here is such a simple encapsulation mechanism. <br><br>  Moving on.  Definition of func (e * ApiError) Error () string means nothing more than a method of this structure.  The variable e is a pointer to a structure, a kind of self / this.  Accordingly, by calling the .Error () method on the structure, we get its Message field. <br><br>  Next, we define the preset errors and fill in their fields.  Fields of the form http.StatusBadRequest are int values ‚Äã‚Äãin the http package for standard response codes, a kind of alias.  We use the abbreviated syntax for declaring the &amp; ApiError {} structure with initialization.  Otherwise one could write this: <br><br><pre> <code class="go hljs">MyError := <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(ApiError) MyError.Code = <span class="hljs-number"><span class="hljs-number">110</span></span> <span class="hljs-comment"><span class="hljs-comment">// ‚Ä¶</span></span></code> </pre><br><br>  The symbol &amp; means to get a pointer to this structure.  The new () operator also returns a pointer, not a value.  In the beginning there is a little confusion with pointers, but, over time, you get used to it. <br><br>  Let us turn to our models.  I will give a trimmed version of the post model: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"labix.org/v2/mgo/bson"</span></span> <span class="hljs-string"><span class="hljs-string">"loctalk/conf"</span></span> <span class="hljs-string"><span class="hljs-string">"loctalk/utils"</span></span> <span class="hljs-string"><span class="hljs-string">"time"</span></span> <span class="hljs-string"><span class="hljs-string">"unicode/utf8"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">// GeoJSON format type Geo struct { Type string `json:"-"` Coordinates [2]float64 `json:"coordinates"` } type Post struct { Id bson.ObjectId `json:"id" bson:"_id,omitempty"` UserId bson.ObjectId `json:"userId"` UserName string `json:"userName"` ThumbUrl string `json:"thumbUrl"` ParentId bson.ObjectId `json:"parentId,omitempty" bson:",omitempty"` Enabled bool `json:"-"` Body string `json:"body"` Geo Geo `json:"geo"` Date time.Time `json:"date" bson:",omitempty"` } func NewPost() *Post { return new(Post) } func (p *Post) LoadById(id string) *conf.ApiError { if !bson.IsObjectIdHex(id) { return conf.ErrPostIdWrong } session := utils.NewDbSession() defer session.Close() c := session.Col("posts") err := c.Find(bson.M{"_id": bson.ObjectIdHex(id), "enabled": true}).One(p) if p.Id == "" { return conf.ErrPostNotFound } if err != nil { return conf.NewApiError(err) } return nil } func (p *Post) Create() (id string, err *conf.ApiError) { // validation switch { case p.UserId == "": err = conf.ErrUserIdEmpty case p.Body == "": err = conf.ErrPostBodyEmpty case utf8.RuneCountInString(p.Body) &gt; conf.MAX_POST_CHARS: err = conf.ErrPostMaxSize case p.Geo.Coordinates[0] == 0.0 || p.Geo.Coordinates[1] == 0.0: err = conf.ErrPostLocationEmpty } if err != nil { return } p.Id = bson.NewObjectId() p.Geo.Type = "Point" p.Enabled = true p.Date = time.Now() session := utils.NewDbSession() defer session.Close() c := session.Col("posts") errDb := c.Insert(p) if errDb != nil { return "", conf.NewApiError(errDb) } return p.Id.Hex(), nil } func (p *Post) Update() *conf.ApiError { session := utils.NewDbSession() defer session.Close() c := session.Col("posts") err := c.UpdateId(p.Id, p) if err != nil { return conf.NewApiError(err) } return nil } func (p *Post) Disable() *conf.ApiError { session := utils.NewDbSession() defer session.Close() p.Enabled = false c := session.Col("posts") err := c.UpdateId(p.Id, p) if err != nil { return conf.NewApiError(err) } return nil } // ‚Ä¶</span></span></code> </pre><br><br>  Here we use a great driver for MongoDb - mgo to save data.  For convenience, I created a small wrapper over api mgo - utils.NewDbSession.  The logic of working with data: first we create an object in the internal structure of the language, and then, using the method of this structure, save it to the database. <br><br>  Note that in these methods we use our type of error conf.ApiError everywhere.  We convert standard errors to ours using conf.NewApiError (err).  Also, the defer statement is important.  It is executed at the very end of the method execution.  In this case, closes the connection with the database. <br><br>  Well, it remains to look at the controller, which processes requests and displays json in response. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> controllers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"encoding/json"</span></span> <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/go-martini/martini"</span></span> <span class="hljs-string"><span class="hljs-string">"labix.org/v2/mgo/bson"</span></span> <span class="hljs-string"><span class="hljs-string">"loctalk/conf"</span></span> <span class="hljs-string"><span class="hljs-string">"loctalk/models"</span></span> <span class="hljs-string"><span class="hljs-string">"loctalk/utils"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPostById</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mu *utils.MarshUnmarsh, params martini.Params)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { id := params[<span class="hljs-string"><span class="hljs-string">"id"</span></span>] post := models.NewPost() err := post.LoadById(id) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err.HttpCode, mu.Marshal(err) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> http.StatusOK, mu.Marshal(post) } <span class="hljs-comment"><span class="hljs-comment">// ...</span></span></code> </pre><br><br>  Here we get the URL of the requested post from the URL, create a new instance of our structure, and call the LoadById (id) method on it to load data from the database and fill this structure.  Which we output the HTTP response, having previously converted to json by our mu.Marshal (post) method. <br><br>  Pay attention to the function signature: <br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPostById</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mu *utils.MarshUnmarsh, params martini.Params)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span></code> </pre><br>  Input parameters are provided to us by Martini using the dependency injection mechanism.  And we return two parameters (int, [] byte) - a number (response status) and an array of bytes. <br><br>  So, we have disassembled the main components and approaches, using which, you can make an effective RESTful API interface in a short time.  Hope the article was helpful and will inspire some of you to learn the wonderful language of Go.  I'm sure the future will be his. <br><br>  For study I can recommend a good book in Russian ‚Äú <a href="http://dmkpress.com/catalog/computer/programming/978-5-94074-854-0/">Programming in the Go language</a> ‚Äù Mark Summerfield.  And, of course, practice more. <br><br>  UPD: <a href="http://go-tour-ru.appspot.com/">Tour Go</a> in Russian. </div><p>Source: <a href="https://habr.com/ru/post/219459/">https://habr.com/ru/post/219459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../219447/index.html">Google has given itself the right to scan user letters.</a></li>
<li><a href="../219449/index.html">Computer that changed everything</a></li>
<li><a href="../219453/index.html">HP iLO 2 is vulnerable to Heartbleed - defend and upgrade!</a></li>
<li><a href="../219455/index.html">Bear on the stairs</a></li>
<li><a href="../219457/index.html">Build your Android for BeagleBoard</a></li>
<li><a href="../219461/index.html">Network scan on Xerox 3220 with VPN connected</a></li>
<li><a href="../219463/index.html">Add IP phones to a separate pool of IP addresses on a Mac address</a></li>
<li><a href="../219465/index.html">10 steps to create the perfect infographic</a></li>
<li><a href="../219467/index.html">Save our eyes: LED projectors</a></li>
<li><a href="../219469/index.html">Entertaining zhirovedenie or consequence of the principle of Peter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>