<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Conference DEFCON 22. GTVHacker Group. Breaking it all: 20 devices in 45 minutes. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conference DEFCON 22. GTVHacker Group. Breaking it all: 20 devices in 45 minutes. Part 1 

 Mike Baker: The following, the 14th device to which we got...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Conference DEFCON 22. GTVHacker Group. Breaking it all: 20 devices in 45 minutes. Part 2</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://habr.com/company/ua-hosting/blog/424907/">Conference DEFCON 22. GTVHacker Group.</a>  <a href="https://habr.com/company/ua-hosting/blog/424907/">Breaking it all: 20 devices in 45 minutes.</a>  <a href="https://habr.com/company/ua-hosting/blog/424907/">Part 1</a> <br><br>  <b>Mike Baker: The</b> following, the 14th device to which we got root access, is the Motorola RAZR LTE Baseband smartphone.  I'm not going to talk about Android, it is already ‚Äúrooted‚Äù.  This phone is special because it uses Baseband, a separate signal processor isolated from the main processor.  This is a completely separate piece of smartphone hardware. <br><br><img src="https://habrastorage.org/webt/jc/yi/e6/jcyie6gzk6kyk_4ts0dmyyhkfjo.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Communication between Android and Baseband is through a USB network connection.  Baseband listens to the internal USB network port, has limited access to the shell through port 3023 and runs the diagnostic script through port 3002 as root. <br><br>  If you look at the script, you can see that using AWK, the command busybox is launched: <br><br><pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">busybox</span></span> awk <span class="hljs-string"><span class="hljs-string">'{print+substr(" '</span></span> <span class="hljs-string"><span class="hljs-string">"$ {outFilePath}"</span></span> <span class="hljs-string"><span class="hljs-string">' ",0,1)}'</span></span></code> </pre> <br>  That is, the file name is transmitted via the AWK script.  This means that using the file name we can inject into the shell.  For rutting the shell, we use the file name containing: <br><br><pre> <code class="hljs objectivec"> x<span class="hljs-string"><span class="hljs-string">",0,1);system("</span></span>‚Ä¶<span class="hljs-string"><span class="hljs-string">");("</span></span></code> </pre> <br>  This allows you to enter into the system any command and run it with root-rights. <a name="habracut"></a><br><br>  The next hacked device at number 15 was the PogoPlug Mobile mobile storage, which serves as a personal cloud storage.  It is used to transfer content from your mobile device to anywhere, connecting to your home network and sharing files over the Internet. <br><br><img src="https://habrastorage.org/webt/uc/ci/4u/ucci4urpqmzuaenkvt8qm548bs8.jpeg"><br><br>  The cost of this device is less than $ 10.  You can connect a USB drive or an SD card to it and it will automatically upload information to the cloud.  It is based on the Marvell Feroceon processor and is managed by Linux 2.6.31.8. <br><br>  There are 4 traditional UART contacts on the PCB, which gives us access to the bootloader and the root shell, but we can also implement the command line using a web page. <br><br><img src="https://habrastorage.org/webt/0w/go/bk/0wgobkbwwdqzudidgwpccaniob4.jpeg"><br><br>  Using this interface allows you to enter arbitrary commands and run them on behalf of the superuser with root-rights. <br><br>  The next exhibit # 16 is the Netgear Push2TV set-top box (PTV3000).  It uses open technology Miracast, supported by Google, which is found in some models of smartphones and tablets with Android and Intel WiDi technology. <br><br><img src="https://habrastorage.org/webt/gv/in/w7/gvinw7b2z7l7cczzgvv-dyo9lje.jpeg"><br><br>  On the printed circuit board of this wireless receiver, there are UART pins through which you can connect to the device, then press the space bar during the bootup, thereby interrupting the U-boot operation, and run your own commands for Linux.  You can not mess with the bootloader and use the Root console, which is active for 2-3 seconds after the download.  It is also possible to implement commands via the web interface via the device name, while the command will be executed on behalf of the superuser with root privileges.  An SPI Flash memory chip containing U-boot commands can be reflashed to launch your custom bootloader. <br>  Device 17 is a VOIP Ooma Telo router running the OpenWRT OS and equipped with an ARM processor. <br><br><img src="https://habrastorage.org/webt/m2/ni/s7/m2nis7qrjihhbvl_n6k49lfxeoo.jpeg"><br><br>  The UART is here again, which uses console input, but we are considering command injections.  There is also an SSH port that works by default as a firewall, so we first need to implement a command that will change the rules of this firewall.  We did this through a web interface to be able to subsequently enter any command.  Interestingly, the default password for root access was "! Ooma123", so hacking it was not difficult.  As soon as we entered, we immediately "reset" the password file and started hacking.  By default, SSH is only available over the LAN. <br><br>  The next slide shows the Olo Olo web interface, the arrow shows the line where we entered the command.  The ability to adjust the rules of the IP address tables gives access to SSH, where you can use the password provided. <br><br><img src="https://habrastorage.org/webt/x6/c7/e0/x6c7e080hcj57bknhbvcdsqljlc.jpeg"><br><br>  Device 18 is a streaming multimedia player Netgear NTV200-100NAS based on Adobe Flash, priced from 10 to $ 30, which plays SWF files. <br><br>  It is equipped with a Wi-Fi module, a Broadcom SOC processor with an encrypted and signed firmware update. <br><br>  Everything is signed on the PCB, so finding the UART was not difficult.  But let's talk about command-line injection via the web interface, as updates and applications are downloaded to this player via an unencrypted HTTPS connection.  This is a very bad idea, because unlike encrypted updates, applications can be freely downloaded and installed.  Therefore, when installing the application, it becomes possible to use a man-in-the-middle attack: <br><br><ul><li>  we create a copy of the application; </li><li>  insert the symlink malicious soft link into it; </li><li>  repack the application and place it on the local host; </li><li>  run the application; </li><li>  we modify it again by adding a shell script during operation that contains a symlink inside to call Telnet; </li><li>  run the application again, reboot, and now we have permanent root access! </li></ul><br><br><img src="https://habrastorage.org/webt/vd/kk/0a/vdkk0av6wfme6fxghq8xiiobtng.jpeg"><br><br>  So, move on.  Device number 19 is the ASUS Cube, the ‚Äúbridge‚Äù between the Internet and streaming video, a set-top box that enables the large-scale operation of the Google TV hardware and software platform.  It is equipped with a 1.2 GHz dual-core Marvell 88de3100 SOC processor.  At the DefCon 21 conference, we already presented an additional CubeRoot exploit for this device, which was designed to control the processor in safe mode. <br><br><img src="https://habrastorage.org/webt/th/vv/i9/thvvi9mr3aiqg79i1bfqk1sviqy.jpeg"><br><br>  We had an application available on the Play Store, unfortunately Google removed it, they do not like these applications.  Let's talk about how we get back to this cube again.  Multimedia applications built into it allow you to mount the SMB network protocol for remote access to files, in this case they allow sharing Windows files without any restrictions.  The procedure for obtaining root-rights is as follows: <br><br><ul><li>  creating an SMB share using a superuser binary; </li><li>  use of the media application to connect to SMB share; </li><li>  adding it to Cube, launching the superuser binary file, getting root-rights! </li><li>  Remounting the system, installing SuperSu and full control over the capabilities of the device. </li></ul><br>  At this point, I hand over to Amir. <br><br>  <b>Amir Etemadi:</b> thanks, Mike! <br><br>  Let's continue our fun and consider some more interesting devices.  I want to tell you about a baby monitor - a baby's activity monitor called Summer Baby Zoom WiFi. <br><br>  This device allows you to watch children using a video camera and transfer the image to your smartphone via Wi-Fi.  He has his own compact monitor with a speaker and a display that allows you to remotely control the camera over the radio channel.  On the market, it is positioned as "protected".  This is the 20th device we hacked. <br><br><img src="https://habrastorage.org/webt/6d/zq/xb/6dzqxbgad6q2srywca4vlvo0mya.jpeg"><br><br>  Having disassembled it, we, as usual, first of all began to search for the UART and made out contacts, which were quite difficult to connect to.  How we managed to do this, we can tell after the presentation, and now we will look at the mistakes that the developers of this device made when creating it. <br><br><img src="https://habrastorage.org/webt/t2/no/4c/t2no4ckdwcz06jqqvndd1czfgbk.jpeg"><br><br>  The first mistake is to have a hard-coded username and password on the device, which uses a binary file to communicate with the web interface.  This is just a terrible practice.  From a security point of view, you should not have hard-coded credentials on every single device. <br><br><img src="https://habrastorage.org/webt/zg/of/lg/zgoflgwc6k-tzodkfvllfxtlu94.jpeg"><br><br>  We found an interesting encrypted string and system calls in a binary ‚Äúsnapcam‚Äù file that contained authentication data.  Next, we moved on to parsing hard-coded data. <br><br>  Having performed the ‚Äúnvram show‚Äù system call from the command line, we received a list of 3 users and their passwords.  Two users had passwords that were different for each camera, and provided different user rights. <br><br><img src="https://habrastorage.org/webt/1u/va/kz/1uvakz86o_xzam9-rlosz5urbme.jpeg"><br><br>  Next, we found the SystemGT.cgi system configuration file, access to which was provided using admin privileges, and which was directly executed using the system () operator on behalf of the superuser.  We entered the command line shown at the bottom of the next slide and got access to the Telnet server with root privileges. <br><br><img src="https://habrastorage.org/webt/1o/xa/xj/1oxaxjfpjq2cojl1ufwkrsv7wbi.jpeg"><br><br>  Remember that in most cases, when the device is not password protected, you can enter the shell by simply typing an expression of the type l / bin / login on the command line. <br><br>  In many cases, you can use the / bin / sh command, and if someone enters the device in the normal way, the attacker immediately throws it into the shell.  Therefore, do not allow people to connect to your device, keep it safe. <br><br>  So, since this is DefCon 22, why don‚Äôt we tell us about hacking 22 devices in 45 minutes?  Therefore, we will continue the presentation with two more devices. <br><br><img src="https://habrastorage.org/webt/jl/l-/ac/jll-acrj8ol4c9kbv6rmijynafk.jpeg"><br><br>  Let's move on to the next item on our list ‚Äî this is the Samsung SmartCam standalone webcam with a microphone and speaker.  It can be controlled using a mobile application, and uses a web interface for local access.  The camera is equipped with a TI DaVinci ARM SOC processor and runs under Linux 2.6.18.  Structurally, this device is very similar to the summer baby Zoom WiFi baby monitor, but it does not change its position to track an object. <br><br><img src="https://habrastorage.org/webt/tk/v0/_x/tkv0_xxdahlfcmj5h1w6pvs_3aw.jpeg"><br><br>  On the printed circuit board is a classic UART adapter with the contacts of the receiver, transmitter, ground and power.  Below is a block of contacts to configure the connection.  Here, only the Console Logging method is used, which displays debug information in the console, hiding it from the user. <br><br>  Interestingly, we discovered this by looking at how logins are processed and how the original administrator password is created when the device is first configured.  With this setting, you are prompted to set your own administrator password.  The disadvantage is that the device does not check if the password is already configured, so you can call the script to change the existing password to the administrator password.  Thus, it is possible to reset the device administrator password without knowing the user's password.  Access to the command line is possible only via LAN. <br><br>  The WEP encryption key is not checked for shell commands and placed in a configuration file, from where it can be pulled out and used to enter commands through the console.  In this case, you must disconnect the network cable if the camera is already connected to the network via Wi-Fi, because if you change the WEP key, when the camera is connected via Wi-Fi, the device may disconnect you and you will lose access to it. <br><br>  If the camera is connected to a Wi-Fi network, it can be hacked without physical contact with the device, after which the web interface starts working with root-rights. <br><br>  Thus, the injection of the superuser command is made by changing the WEP-key of access to the Wi-Fi network.  To connect to the Telnet network, just enter the $ command (busybox telnetd - l / bin / sh) <br><br><img src="https://habrastorage.org/webt/6-/rq/2o/6-rq2oups88697yj1l6weqnzs4q.jpeg"><br><br>  The most interesting of all the considered devices seemed to us device number 22, because it provides a large field of activity for hackers.  This device is called Wink Hub, and I like it more than others, mainly because it has a large range of peripheral devices. <br><br>  This thing controls all wireless "smart" home devices using a mobile application, which allows you to abandon individual control panels.  Wink Hub has a Wi-Fi, Bluetooth, Zwawe and Zigbee module, as well as an excellent product of the RF Toolkit developers. <br><br><img src="https://habrastorage.org/webt/ot/9z/nv/ot9znvwcjufonj9my3i9ide_hai.jpeg"><br><br>  This is a software toolkit for any hacker, as through it the interaction of peripheral devices.  Wink Hub is essentially a home gateway that integrates devices with already configured APIs, which has all the communication methods, it even has its own set of devices, ranging from a gas leak detector to sensors for adjusting humidity, temperature, lighting and motion detection.  It also manages smart locks and obtains information on the status of all monitored devices. <br>  The next slide shows a board that looks quite nice. <br><br><img src="https://habrastorage.org/webt/ev/y4/pb/evy4pby41iadphzt97prynvx1xw.jpeg"><br><br>  So, this is a board, it is really beautiful. <br><br>  Everything is signed here, and what else is nice about this device is that it costs less than $ 50, and there is a suggestion that if you buy peripherals, you can get Wink Hub for free.  Therefore, if you are interested in RF devices, this is a really cool board. <br>  On it are separate chips for each type of connected devices that it supports.  So this device has a command line injection error.  If you do not understand PHP, there is a sudo command that allows you to run programs with administrator privileges without entering the superuser password. <br><br><img src="https://habrastorage.org/webt/6c/zm/pz/6czmpzb15bdyzjn0n_-kgbfpd4m.jpeg"><br><br>  This command gives the node ID of the node the node ID of the ID attribute value by the POST variables.  So take this team into service, and when you return home, buy yourself this device and have fun with it as you wish. <br><br>  Well, now we will show you what you have been waiting for!  A video recording of the hacking demonstration of all 22 devices will take place under a real hacker rep.  For this, we invited our friend, rapper Ned from Dual Core!  Let's welcome him and the song "All these things"! <br><br>  We have almost a hundred different UART adapters here, and hromecast CDs, and while you watch the video and enjoy the rap, we'll go to the gym and give it all to you. <br><br>  <b>Dual Core:</b> great guys, I'm trying to catch my breath ... my name is Ned, I'm a rapper in Dual Core, maybe you heard our songs like "Drink Everything and Break Everything."  Have any of you cracked cars?  Fine! <br><br>  I want to present you a book of my friend, this is a hacker‚Äôs guide for hacking cars, you can download it for free, buy it on Amazon, I have a few pieces with me that I will distribute.  So, rap music ... if I don‚Äôt get enough breath, I can die! <br><br>  So where is my DJ?  Press the spacebar and start the video so that I can start! <br><br><img src="https://habrastorage.org/webt/1d/qf/p-/1dqfp-3cg8whoufxoq2logm_ktu.jpeg"><br><br>  On the screen begins the demonstration of hacking devices, which were discussed in this presentation.  The phrase ‚Äúnot every geek with Commodore 64 is able to hack NASA‚Äù sounds, then the music track is started, under which Ned plays the rap ‚ÄúDrink all the booze‚Äù of approximately the following content: <br><br>  I tell you to drink all the drinks, <br>  guys so quickly hacked all the stuff <br>  that you didn't even have time to count them, <br>  disaster recovery requires even more fists <br>  put your bytes on it all <br>  my C64 will blow everything up in orbit <br>  the perfect boom will break all the chains <br>  optimize the process execution time <br>  to avoid a sentence, you just need a stream, <br>  you just need a stream <br>  engine size does not matter <br>  there are mines in the command line, <br>  and before they see me, <br>  break the captcha, finish the chapter, <br>  drink all the drinks, <br>  take this bike, which is red, <br>  he still winks at me <br>  drink all booze, drink all alcohol <br>  I'm waiting for my Blackberry to die <br>  to replace it with a raspberry pi, <br>  neutralize any threat to the Red Skull <br>  dead virus writers climbed the VX7, <br>  which logs our data live, <br>  hello to you, ciphers and device drivers, <br>  where we will go before they run the format <br>  Internet Mike wants to get your Wi-Fi, <br>  he took to crack Pineapple 5, <br>  are you ready to hack all things? <br>  Yes, you are ready to hack all things! <br>  like this, sir, we drink all the drinks, <br>  we drink everything <br>  you know that there will be safety rules <br>  but first we drink all the drinks, and then we break them, <br><br><img src="https://habrastorage.org/webt/yc/k8/uk/yck8ukwt7cxsum3ncjtrbwoyxly.jpeg"><br><br>  it's all about the system or firmware <br>  what do you pray for regardless of service, <br>  recode and connect to the Internet <br>  gathering his own, it will spoil the pirates <br>  clapping an attack above the cloud, <br>  but we will return to the subway, <br>  where there is no mass control, <br>  down the Thor nodes around the world <br>  hakai traffic devices online, <br>  the challenge of the state is the hunt for us <br>  my Konrad Zuse is a trigger-debugger, <br>  I need a plan that works, <br>  I want to see how everything burns, <br>  and now it's your turn <br>  drink all the booze yes <br>  drink all the drinks, this fight is a game <br>  this horror still winks at me <br>  so eat all the food and drink all the drinks! <br>  I thank the guys from GTVHacker! <br><br><img src="https://habrastorage.org/webt/2s/zw/e2/2szwe2tdorklw_c0jpnr6nfhjzo.jpeg"><br><br>  <b>Amir Etemadi:</b> I find it hard to believe that we had a Dual Core visiting!  He did it without any conditions, without any payment, he is just a great guy!  Yes, I was also out of breath.  We have absolutely no time, so if you have questions, we are ready to answer them after the conference. <br><br>  We provide links to our resources here, welcome to the GTV Hacker channel and thank you all, we love you! <br><br>  Presentation Slides: <a href="http://dc22.gtvhacker.com/">DC22.GTVHacker.com</a> <br>  WIKI: <a href="http://www.gtvhacker.com/">www.GTVHacker.com</a> <br>  Forum: <a href="http://forum.gtvhacker.com/">forum.GTVHacker.com</a> <br>  Blog: <a href="http://blog.gtvhacker.com/">blog.GTVHacker.com</a> <br>  IRC: irc.freenode.net #GTVHacker <br>  Twitter: @GTVHacker </div><p>Source: <a href="https://habr.com/ru/post/424915/">https://habr.com/ru/post/424915/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../424905/index.html">Developing a hexapod from scratch (part 2) - build</a></li>
<li><a href="../424907/index.html">Conference DEFCON 22. GTVHacker Group. Breaking it all: 20 devices in 45 minutes. Part 1</a></li>
<li><a href="../424909/index.html">Microsoft stops supporting classic desktop version of Skype from November 1</a></li>
<li><a href="../424911/index.html">Briefly about the types of software architectures, and which of them we have chosen for the IaaS provider</a></li>
<li><a href="../424913/index.html">International Energy Agency: wind power will prevail in Europe by 2027</a></li>
<li><a href="../424917/index.html">How we rewrote bad forecasting for slightly better</a></li>
<li><a href="../424919/index.html">Pearl from the flea market or reverse engineering of the DCS-5220A1 IP camera</a></li>
<li><a href="../424921/index.html">How network math can help you find friends</a></li>
<li><a href="../424923/index.html">Meet anarchists who make their own drugs</a></li>
<li><a href="../424925/index.html">Wi-Fi is safer: everything you need to know about WPA3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>