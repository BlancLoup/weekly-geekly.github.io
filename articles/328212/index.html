<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reverse Engineering "Kazakov", the last part: the second breath</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After several months of working on the source code of the Cossacks: War Again game, I can finally wash my hands and present the results of my labors ....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reverse Engineering "Kazakov", the last part: the second breath</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/b43/961/cfa/b43961cfafc64a0782ef977a2c348cdb.png"><br><br>  After several months of working on the source code of the Cossacks: War Again game, I can finally wash my hands and present the <a href="https://github.com/ereb-thanatos/cossacks-revamp-2017">results of my labors</a> .  In this article I would like to share with you the experience of refactoring this extraordinary project, in particular, code curiosities.  All lovers of necro programming is dedicated to ... <br><a name="habracut"></a><br><h3>  Start </h3><br>  The first and one of the most unpleasant obstacles was not in the code, but in the projects themselves.  There are four of them: <br><br><ul><li>  static library CommCore.lib (GSCp network protocol based on UDP) </li><li>  IntExplorer.dll dynamic library (game lobby on the server) </li><li>  IChat.dll dynamic library (chat in the game lobby) </li><li>  dmcr.exe executable </li></ul><br>  And these guys have seen some code!  Because of the circular dependency between the IChat.dll projects and the dmcr.exe, at least one lib file from the previous build is required for linking.  Project files themselves are incorrectly converted in Visual Studio 2015: they contain links to libraries that are not displayed in project properties, absolute paths to files in the system of one of the developers, and other surprises.  In the end, I was bored with dancing with tambourines, and I created all the projects anew, having learned in passing that there are extra files in the archive with outdated source code, which when included in the project leads to conflicts.  Well, where could it be without linking features, for which it is necessary to exclude libc.lib. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  We start </h3><br>  So, with the projects figured out, now you can get down to business.  The compiler is happy for us and welcomes with a lot of errors <a href="https://msdn.microsoft.com/ru-ru/library/ewcf0002(v%3Dvs.110).aspx">C2065: undeclared identifier</a> .  We look at the code and see the following picture everywhere: <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; max1; i++) { <span class="hljs-comment"><span class="hljs-comment">/*  ‚Ññ1 */</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; max2; i++) { <span class="hljs-comment"><span class="hljs-comment">/* C2065 */</span></span> } <span class="hljs-comment"><span class="hljs-comment">// : for (int i = 0; i &lt; max &amp;&amp; arr[i] != value; i++); /*      */ if (i &lt; max) { /*    .  C2065   */ }</span></span></code> </pre> <br>  Of course, you could put <a href="https://msdn.microsoft.com/ru-ru/library/84wcsx8x.aspx">/ Zc: forScope-</a> and forget about it, but we are not firemen and carpenters.  Rule pens more than a hundred of these pieces of code, we continue. <br><br>  The next obstacle was in the graphic element, more precisely in DirectDraw 7. It actively uses the system palette replacement mechanism.  And if earlier it was common practice, then since Windows Vista such tricks no longer pass.  The fact is that <abbr title="Desktop Window Manager">DWM</abbr> with Windows Aero closely work with the palette and do not tolerate competition.  As a result, many old games suffer from color distortion. <br><br>  Not being a DirectX expert, I began to look for a ready-made solution and found it in the version of "Cossacks", published on <a href="http://store.steampowered.com/app/4850/Cossacks_Back_to_War/">Steam</a> in 2010.  In addition to the ddraw.dll library itself, there is an additional library mdraw.dll in the game folder, which exports the initialization function DirectDrawCreate ().  To be honest, I don‚Äôt know what exactly the guys from GSC wrote in their <i>DDemu DirectDraw Emulator</i> library in 2008, but it does an excellent job with its task.  Without thinking, I added the <a href="">appropriate wrapper</a> to Ddini.cpp and forgot about this issue. <br><br>  Then there was the question of debugging a full-screen application.  Here I was lucky again - the code provided a debug mode in which the game was launched in the corner of the screen in a frameless window with a fixed size.  I only needed to bring it to mind, add a change of resolution, process the capture and return the cursor depending on whether the player is in the menu or in the active game and add the corresponding parameters at the start.  Now it was possible to conveniently start the game in the debugger with the key / window. <br><br><div class="spoiler">  <b class="spoiler_title">Small retreat</b> <div class="spoiler_text">  The following are the weird, problematic and erroneous sections of the Cossacks: War Again game code that I encountered during my work.  Please note that the purpose of this article in no way is to criticize or ridicule the developers of this game.  I believe that ‚ÄúCossacks: War Again‚Äù is an exceptional result of diligent robots and painstaking optimization of a small team of developers who have raised the bar for performance and scope of battles for RTS games very high.  Thank you, GSC! <br></div></div><br><h3>  Fun arithmetic </h3><br>  One of my goals was to add settings for multiplayer games, for example, the ability to disable the diplomatic center and the market or limit the available ships in the shipyard.  Expanding the interface of the game room and adding the necessary branches in the code, I increased the array PlayerInfo.UserParam [], in which these settings are stored, from seven to ten elements.  But I couldn‚Äôt test new options in any way - when starting the game, the AI ‚Äã‚Äãstarted to control my peasants instead of their own and play for me, while its peasants stood motionless.  It's fun, but it won't do that. <br><br>  The reason for this behavior of the AI ‚Äã‚Äãwas in the following <a href="">trick with the ears</a> when copying settings from the game host to the clipboard: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//PlayerInfo PINFO[8]; //byte* BUFB = (byte*) ( BUF + 10 + 8 + 32 - 10 ); memcpy( BUFB, PINFO[HostID].MapName + 44 + 16, 16 );</span></span></code> </pre><br><a name="PlayerInfo"></a>  And this is how the PlayerInfo structure is declared: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> pack(1) struct PlayerInfo { char name[32]; DPID1 PlayerID; byte NationID; byte ColorID; byte GroupID; char MapName[36 + 8]; int ProfileID; DWORD Game_GUID; byte UserParam[7]; byte Rank; word COMPINFO[8]; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//‚Ä¶ ( 12 ) }</span></span></span></span></code> </pre><br>  As you can see, by offset MapName + 60 is COMPINFO [8].  Accordingly, as the UserParam [7] array increases, the memcpy () call misses, and incorrect data about which players the AI ‚Äã‚Äãshould play for gets into the buffer.  The problem is solved by replacing offset mathematics with a direct call at PINFO [HostID] .COMPINFO. <br><br>  As a result, I still decided not to touch UserParam [], but to add UserParam2 [3] array at the end of the structure, since the client version is stored in one of the last elements and any change of structure before it is fraught with incorrect definition of versions in the game lobby.  And so players with version 1.35 will see that others have an updated version of the game. <br><br>  What lessons can you learn from this? <br><br><ul><li>  In the structure transmitted over the network, the first element should be the client version. </li><li>  Never assume that the location of the structure in memory will be unchanged. </li><li>  Write serialization functions, not rely on <a href="https://msdn.microsoft.com/ru-ru/library/2e70t5y1.aspx">#pragma pack (1)</a> and byte-wise copying. </li></ul><br><h3>  Invisible Joe Define </h3><br>  Understanding the mechanics of displaying in-game text messages in order to increase the display time and the maximum number of messages on the screen, I came across an <a href="">interesting constant</a> : <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SIGNBYTE </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">' '</span></span></span><span class="hljs-meta"> void ShowCharUNICODE( int x, int y, byte* strptr, lpRLCFont lpr ) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (strptr[0] == SIGNBYTE) { </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*  */</span></span></span><span class="hljs-meta"> } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* ascii */</span></span></span><span class="hljs-meta"> } }</span></span></code> </pre><br>  ‚ÄúSo what's the big deal?  - you ask - Just a space as a constant. "  Well, firstly, a space would be an extremely strange choice to identify something in a line of text, and secondly, it is not a space at all.  SIGNBYTE is defined as 0x7F, or the <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BB%25D1%258F%25D1%258E%25D1%2589%25D0%25B8%25D0%25B5_%25D1%2581%25D0%25B8%25D0%25BC%25D0%25B2%25D0%25BE%25D0%25BB%25D1%258B">escape character</a> DEL.  And if your browser is sufficiently circumspect and at least shows that there is something between the quotes, then Visual Studio 2015 faithlessly draws <b>''</b> , between which the cursor ‚Äústumbles‚Äù one character. <br><br>  Please, if you use non-printable characters, specify them in the code in hexadecimal value, and not as a character. <br><br><h3>  Legal aspect </h3><br>  Every time I am surprised when administrator rights are required to start the game.  And every time I think something like ‚Äúwell, how can you program games somehow.‚Äù  But this time I had the code on my hands, and I collected it myself, and the <abbr title="User Account Control">UAC</abbr> window still did not give me rest. <br><br>  The answer was found quite by accident, when I thought that it would be nice to write in the properties of the executable file that this version of the game is not original and is not supported by the developers.  Naturally, there was no manifesto in the project, but there was a resource file <a href="">Script1.rc</a> .  What was my surprise when after changing the VS_VERSION_INFO block, the game no longer required administrator rights! <br><br>  It turns out that Windows, starting with Windows Vista, uses a heuristic algorithm to identify applications that may require elevation of privileges.  This feature is called ‚ÄúInstaller Detection Technology‚Äù (see the <a href="https://technet.microsoft.com/ru-ru/library/cc709628(v%3Dws.10).aspx">article in the Windows IT center</a> ), and it usually responds to keywords like install or setup.  But in our case, the culprit was <a href="">the CompanyName parameter</a> - if it contains the string "-GSC- \ 0", then UAC wakes up and requires administrative rights. <br><br>  How to protect your application from such heuristics on the part of Microsoft, existing and coming?  No way.  Today you are developing games, and tomorrow you are already on a par with Inno Setup and InstallShield. <br><br><h3>  Guerrilla sscanf () </h3><br>  I came across this bug when after adding additional game settings when playing records of past games, a synchronization error occurred, i.e.  the recording did not go along the course along which the game developed.  At the same time, the error appeared, apparently by chance and for a long time I could not find the reason. <br><br>  I'll skip the boring debugging details and go to the juice itself.  The game settings, the map view and the data of the selected nations are transmitted through the file name of the random map, which has the format <nobr>RN0 1A3C 12345 0KFH31CJ 4501326.m3d</nobr> , where <br><br><ul><li>  <b>RN0</b> : RN prefix and map size (0 - 2) </li><li>  <b>1A3C</b> : <b>PRNG</b> value for random card initialization </li><li>  <b>12345</b> : Map view (landscape, mountains, deposits, etc.) </li><li>  <b>0KFH31CJ</b> : Nations that Players <b>Have</b> Chosen (0 - K) </li><li>  <b>4501326</b> : Game Settings (Artillery, <abbr title="Peacte Time">PT</abbr> , etc.) </li></ul><br>  And now let's look at the <a href="">code segment</a> that processes the game settings, reading the random card file name when loading the game record: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v1, v2, v3, ADD_PARAM; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ccc[<span class="hljs-number"><span class="hljs-number">32</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> z = <span class="hljs-built_in"><span class="hljs-built_in">sscanf</span></span>( Name, <span class="hljs-string"><span class="hljs-string">"%s%x%x%x%d"</span></span>, ccc, &amp;v1, &amp;v2, &amp;v3, &amp;ADD_PARAM ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( z == <span class="hljs-number"><span class="hljs-number">5</span></span> ) { <span class="hljs-comment"><span class="hljs-comment">/*    ADD_PARAM */</span></span> }</code> </pre><br>  The catch here is that the fourth variable indicates the type <b>% x</b> , while the range of characters in it goes beyond the hexadecimal system and extends to the letter <b>K.</b>  If there are players in the game who have chosen nations with an index higher than F, then sprintf () will prematurely finish parsing and return 4. The parameters will not be interpreted, the AI ‚Äã‚Äãwill have incorrect information about the game and it will make other decisions, which will lead to out of sync. <br><br>  In addition to this, there is the fact that sprintf () is called exclusively for ADD_PARAM ‚Äî the other variables are not used anywhere.  The solution is relatively simple: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> options = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> z = <span class="hljs-built_in"><span class="hljs-built_in">sscanf</span></span>( Name, <span class="hljs-string"><span class="hljs-string">"%*s %*s %*s %*s %d"</span></span>, &amp;options ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-number"><span class="hljs-number">1</span></span> == z ) { <span class="hljs-comment"><span class="hljs-comment">/*    ADD_PARAM */</span></span> }</code> </pre><br>  <a href="http://www.c-cpp.ru/content/scanf">The</a> <b>*</b> <a href="http://www.c-cpp.ru/content/scanf">flag</a> indicates functions that the value should not be stored in a variable.  By the way, see how I implemented the coding of 10 game settings in place of the same 7 digits <a href="">here</a> .  <i>‚ÄúWhy?‚Äù - you ask.</i>  <i>But because changing the length of the line with the name of the map file at my own discretion seemed to me not a very good idea (see <a href="https://habr.com/ru/post/328212/">above</a> in ‚ÄúMerry arithmetic‚Äù).</i> <br><br>  The most interesting thing for me here is the fact that the bug manifested itself only when compiled in <nobr><abbr title="Microsoft Visual C ++ 2015">MSVC 14</abbr></nobr> .  It turns out that the implementation of the sscanf () function in the standard library over the years has become more stringent and will not continue to forgive such freedoms on the part of programmers. <br><br>  Memo: Follow first the requirements of the documentation, and not the principle of "working code - the correct code." <br><br><h3>  Subtleties of language </h3><br>  Localization is a separate topic for any developer, but <i><a href="">this is the</a></i> first time I saw this: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> RUSSIAN #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _CRYPT_KEY_ 0x78CD #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> RUSSIAN #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">undef</span></span></span><span class="hljs-meta"> _CRYPT_KEY_ #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _CRYPT_KEY_ 0x4EBA #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre><br>  If this is not enough for you, I suggest to look under the spoiler and see what this ‚Äúcrypto-key‚Äù is for. <br><br><div class="spoiler">  <b class="spoiler_title">Do not do this.</b>  <b class="spoiler_title">You are welcome.</b> <div class="spoiler_text"><pre> <code class="cpp hljs">VOID CGSCarch::MemDecrypt( LPBYTE lpbDestination, DWORD dwSize ) { BYTE Key = (BYTE) ~( HIBYTE( _CRYPT_KEY_ ) ); isiDecryptMem( lpbDestination, dwSize, Key ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isiDecryptMem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( LPBYTE lpbBuffer, DWORD dwSize, BYTE dbKey )</span></span></span><span class="hljs-function"> </span></span>{ _asm { mov ecx, dwSize mov ebx, lpbBuffer mov ah, dbKey next_byte: mov al, [ebx] <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> al xor al, ah mov [ebx], al inc ebx loop next_byte } }</code> </pre><br></div></div><br>  This is the simple way to screw up localization at the compilation stage.  If, for example, the ‚ÄúEnglish‚Äù dmcr.exe is slipped into the archive with resources from the Russian version, then all that remains of the game is the access violation error window.  Because neither before nor after ‚Äúisi memory decryption‚Äù the contents of the buffer are checked.  But if we unpack the archive all.gsc, replace the files and pack it back, then the Russian interface will be waiting for us in the game. <br><br>  Having looked at this XOR-orgy, I decided to limit myself to the English version, but with the support of the Cyrillic alphabet in the chat.  Since all the text is drawn through the game's own fonts, I copied the mainfont.gp resource from the Russian version.  It remains only to catch the characters that fall outside the ascii range, and correctly match the letter codes with the ‚Äúframe index‚Äù of this file (the GP format is used everywhere in the game for storing graphics, including animation).  Not the most elegant <a href="">solution</a> , but it works flawlessly, and on the server in a chat with players under version 1.35, too. <br><br><h3>  UDP without holes </h3><br>  Unfortunately, the original Cossacks did not implement the <a href="https://en.wikipedia.org/wiki/UDP_hole_punching">UDP hole punching mechanism</a> , which would allow players to connect to the game rooms, even if their host is located on the other side of their provider‚Äôs <abbr title="Network Address Translation">NAT</abbr> . <br><br>  Fortunately, the comrade, known as [-RUS-] AlliGator, who started and maintains the server cossacks-server.net, allocated some of his time and we agreed on an additional protocol by which the game host will support a UDP connection to the server, and by which the server will be able to communicate the host's external UDP port to players who wish to connect to it. <br><br>  All implementation details can be viewed in the <a href="">UdpHolePuncher</a> class.  The connection is <a href="">initialized</a> when the game room is created by the host, after which it <a href="">keeps in</a> touch until the game starts, sending small packets.  This is necessary because  NAT can assign a different external port with each new UDP connection, and so the server probably knows that at this point in time the host is available because of NAT on the port from which the packets come. <br><br>  Corresponding changes were made to the <a href="https://github.com/ereb-thanatos/cossacks-revamp-2017/blob/master/src/IChat%2520library/GSC_ChatWindow.cpp/">procedure for processing</a> server commands and to the <a href="https://github.com/ereb-thanatos/cossacks-revamp-2017/blob/master/src/IChat%2520library/GSC_ChatWindow.cpp/">RoomInfo</a> structure in the IChat.dll library.  The following additional variables are supported when creating a game room: <br><br><ul><li>  <b>% PROF</b> : Player ID.  With it, the server can distinguish between hosts. </li><li>  <b>% CG_HOLEHOST</b> : address of the server processing UDP packets </li><li>  <b>% CG_HOLEPORT</b> : server port on which UDP is listened </li><li>  <b>% CG_HOLEINT</b> : the interval at which the client should send packets </li></ul><br>  After receiving this data, the game host opens an additional connection and maintains it.  Those who wish to join receive an additional variable <b>% CG_PORT</b> when connected to a room.  And only if it is not there, the constant <a href="">DATA_PORT is used</a> . <br><br>  Although this whole mechanism has already been implemented in the game client, I haven‚Äôt managed to test it yet, because  contact with the Alligator broke.  Shortly before this, he laid out the <a href="https://github.com/rloger">source code of</a> his server for open access - <i>thank you for that!</i>  - so if someone is ready to raise the baton, I will be all for it. <br><br><h3>  Afterword </h3><br>  The article already came out longer than I had planned, so I will be brief.  Although this project took a long time and significantly depleted my enthusiasm for reverse engineering and source code analysis, I am glad that I took it.  I am glad that I wrote an article on Habr with a description of my first, assembler, crutch for Kazakov.  I am glad that Max <a href="https://habrahabr.ru/users/fsou11/" class="user_link">fsou11</a> came to the comments and laid out the source code of the game for free access.  I am also grateful to the <abbr title="League Cossackers Net">LCN</abbr> community for valuable advice, explanations, and testing assistance. <br><br><h5>  References: </h5><br><ul><li>  <a href="https://github.com/ereb-thanatos/cossacks-revamp-2017">GitHub repository with new code</a> </li><li>  <a href="https://github.com/GSC-fake/Cossacks-back-to-war">Repository with original source code</a> </li><li>  <a href="https://github.com/rloger">Repositories with server source code</a> </li><li>  <a href="http://forum.newlcn.com/viewtopic.php%3Fp%3D451656">Short list of changes made on the LCN forum</a> </li><li>  <a href="http://forum.newlcn.com/viewtopic.php%3Ft%3D17524%26start%3D240">Additional Information</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/328212/">https://habr.com/ru/post/328212/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328202/index.html">Correction codes "on the fingers"</a></li>
<li><a href="../328204/index.html">Where to go for those who have decided to leave Ubuntu Unity</a></li>
<li><a href="../328206/index.html">Using the NSProxy class on a simple example</a></li>
<li><a href="../328208/index.html">Adding to_string simplifies development and debugging code on Elixir</a></li>
<li><a href="../328210/index.html">Exhibitions and conferences on virtual reality 2017</a></li>
<li><a href="../328218/index.html">Idiom Kotlin, a set of good practices</a></li>
<li><a href="../328220/index.html">Table design</a></li>
<li><a href="../328224/index.html">Taiwan and Hong Kong: promising markets with huge opportunities</a></li>
<li><a href="../328226/index.html">Docker container with Postgres data for integration testing and easy extension</a></li>
<li><a href="../328228/index.html">How to define?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>