<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Selection of RSA cipher parameters and possible consequences</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Under the cat are described examples of the choice of "bad" parameters of the RSA cipher. 

 Let us quote the authors of the textbook ‚ÄúFundamentals of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Selection of RSA cipher parameters and possible consequences</h1><div class="post__text post__text-html js-mediator-article">  Under the cat are described examples of the choice of "bad" parameters of the RSA cipher. <a name="habracut"></a><br><br>  Let us quote the authors of the textbook ‚ÄúFundamentals of Cryptography‚Äù by A.P.  Alferov, A.Yu.  Zubov, A.S.  Kuzmin, A.V.  Cheryomushkin, Moscow.  Helios ARV, 2001, on page 316: <br><br>  ‚ÄúIt is necessary to emphasize the need for caution in choosing the RSA module ( <b>n</b> numbers) for each correspondent in the network.  In this regard, we can say the following.  The reader can verify for himself that knowing one of the three values ‚Äã‚Äãof <b>p</b> , <b>q</b> or <b>œÜ (n)</b> , you can easily find the RSA secret key ... ". 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's add this text.  If the RSA cipher module is unsuccessful, as is done in the example of the manual below, you can decrypt the text without having a secret key, i.e.  without knowing any of these three quantities. <br><br>  To do this, it is enough to have the cipher text specified by the cipher module <b>n</b> , the public key <b>e of the</b> cipher and perform only three steps of the ‚Äúkeyless reading‚Äù attack.  After the fourth attacking step, it is established that at the previous step the source code was received, it can be read.  We show how easy it is. <br><br>  First we give an example from pp. 313-315 of the mentioned manual. <br><habracut><br><h3>  Example </h3><br>  Short source text message <b>encryption</b> : <b>RSA</b> . <br>  The recipient sets a cipher with the characteristics <b>n = pq = 527</b> , where <b>p = 17</b> , <b>q = 31</b> and <b>œÜ (n) = (p ‚Äì1) (q - 1) = 480</b> .  As a public key, <b>e is a</b> number that is mutually simple with <b>œÜ (n)</b> , <b>e = 7</b> .  For this number, using the Euclidean extended algorithm, the integers <b>u</b> and <b>v are found</b> that satisfy the relation <b>e ‚àô u + œÜ (n) v = 1</b> : <br><br>  <b>480 = 7 ‚àô 68 + 4,</b> <b><br></b>  <b>7 = 4 ‚àô 1 + 3,</b> <b><br></b>  <b>4 = 3 ‚àô 1 + 1,</b> <b><br></b>  <b>1 = 4‚Äì3 ‚àô 1 = 4‚Äì (7‚Äì4 ‚àô 1) ‚àô 1 = 4 2‚Äì7 ‚àô 1 = (480‚Äì7 ‚àô 68) 2‚Äì7 1 = 480 2‚Äì7 137,</b> <b><br></b>  <b>v = 2, u = ‚Äì137</b> . <br><br>  Since <b>‚Äì137‚â°343 (mod480)</b> , then <b>d = 343</b> . <br><br>  Check: <b>7 ‚àô 343 = 2401‚â°1 (mod480)</b> . <br><br>  A text message is represented as a sequence of numbers contained in the interval <b>[0, 526]</b> .  For this, the letters <b>R</b> , <b>S,</b> and <b>A</b> are encoded with five-digit binary numbers.  The sequence numbers of these letters in the English alphabet are used for their binary representation: <br><br>  <b>R = 18 <sub>10</sub> = (10010) <sub>2</sub></b> , <b>S = 19 <sub>10</sub> = (10011) <sub>2</sub></b> , <br>  <b>A = 1 <sub>10</sub> = (00001) <sub>2</sub></b> . <br><br>  Then <b>RSA = (100101001100001) <sub>2</sub></b> .  Splitting text into blocks of limited length gives an idea of ‚Äã‚Äãtwo blocks: <b>RSA = (100101001), (100001) = (M <sub>1</sub> = 297, M <sub>2</sub> = 33)</b> . <br><br>  Blocks of the source text <b>M <sub>1</sub> = 297</b> , <b>M <sub>2</sub> = 33</b> are sequentially encrypted: <br>  <b>y <sub>1</sub> =  <sub>k</sub> ( <sub>1</sub> ) =  <sub>1</sub> <sup>e</sup> ‚â°297 <sup>7</sup> (mod527) = 474</b> . <br><br>  It took advantage of the fact that: <br><br>  <b>297 <sup>7</sup> = ((297 <sup>2</sup> ) <sup>3</sup> ) 297‚â° (mod527) = (200 <sup>3</sup> (mod527) 297) (mod527) = 474</b> , <br>  <b>y <sub>2</sub> =  <sub>k</sub> ( <sub>2</sub> ) = M <sub>2</sub> <sup>e</sup> ‚â°33 <sup>7</sup> (mod527) = 407</b> . <br><br>  The cipher text, as well as the source, is obtained in the form of two blocks: <b><sub>1</sub> = 474</b> ;  <b>y <sub>2</sub> = 407</b> . <br><br>  <i>Decryption</i> is represented by a sequence of actions <b>D <sub>k</sub> (y <sub>i</sub> ) = (y <sub>i</sub> ) <sup>d</sup> = (y <sub>i</sub> ) <sup>343</sup> (mod 527)</b> , <b>i = 1,2</b> . <br><br>  It is more convenient to carry out calculations of raising to the power <b>d</b> by first representing the exponent by the sum of the powers of <b>2</b> , namely: <b>343 = 256 + 64 + 16 + 4 + 2 + 1</b> . <br><br>  Using this representation of the exponent <b>d = 343</b> , we get: <br><br>  <b>474 <sup>2</sup> ‚â° 174 (mod527),</b> <b><br></b>  <b>474 <sup>4</sup> ‚â° 237 (mod527),</b> <b><br></b>  <b>474 <sup>8</sup> ‚â°307 (mod527),</b> <b><br></b>  <b>474 <sup>16</sup> ‚â° 443 (mod527),</b> <b><br></b>  <b>474 <sup>32</sup> ‚â°205 (mod527),</b> <b><br></b>  <b>474 <sup>64</sup> ‚â°392 (mod527),</b> <b><br></b>  <b>474,128 ‚â°307 (mod527),</b> <b><br></b>  <b>474,256 ‚â°443 (mod527),</b> <br>  and finally <b>474,343 (mod527) = (443 ‚àô 392 443 ‚àô 237 ‚àô 174 ‚àô 474) (mod527) = 297</b> . <br><br>  Similarly, the value <b>407 <sup>343</sup> (mod527) = 33 is</b> calculated. <br><br>  The transition to the letter representation of the decrypted message gives: <b>RSA</b> . <br><br>  After reviewing the example, the handbook discusses the resilience of the RSA system.  It emphasizes the need for caution in choosing the RSA cipher module ( <b>n</b> numbers) for each of the network correspondents.  Indicates the inadmissibility of ignoring the requirements for the selected characteristics of the encryption system.  Among such requirements, unfortunately, is not specified the violation of which is illustrated by the given example. <br><br><h3>  RSA attack </h3><br>  Consider an example of an attack on the RSA cipher.  We will use the data of the example given on page 313-315 in the textbook "Fundamentals of Cryptography" by A.P.  Alferov, A.Yu.  Zubov, A.S.  Kuzmin, A.V.  Cheryomushkin, Moscow.  Helios ARV, 2001. <br><br>  The failure (inadmissibility) of the selected system parameters in this example is easily shown by calculations that implement the attack of the keyless reading of the source text.  The essence of such an attack is as follows.  The public key of the RSA cipher ( <b> = 7</b> , <b>n = 527</b> ) and the cipher text are given.  In the example, the cipher text is represented by two blocks. <br>  <b>y = (y <sub>1</sub> = 474, y <sub>2</sub> = 407)</b> . <br><br>  Each encrypted block is attacked individually, first we attack <b>at <sub>1</sub> = 474</b> , after decrypting it, we attack another block <b>at <sub>2</sub> = 407</b> . <br><br>  Further, it is formed by repeated encryption with preservation of the results of two successive steps of the attack algorithm and using the public key a sequence of numerical values <b>for <sub>i</sub></b> , <b>for <sub>1</sub> = for the</b> existing ciphertext. <br><br>  In the cipher text attack algorithm, the step number <b>j</b> is defined for which <b>y <sub>i</sub> <sup>e <sup>j</sup></sup> (mod n) = (y <sub>i</sub> <sup>e <sup>j ‚Äì 1</sup></sup> (mod n)) <sup>e</sup> (mod n) = y <sub>i</sub></b> , <b>i&gt; 1</b> .  From the last relation, we see that when raising to the power <b>e the</b> value <b>(y <sub>i</sub> <sup>e <sup>j ‚Äì 1</sup></sup> (mod n)) we</b> get the initial code text <b>y <sub>i</sub> = y <sub>1</sub></b> . <br><br>  But this means that the plaintext was encrypted at this step.  By direct calculations (there are very few of them) using the on-screen calculator, we find the value <b>j</b> , at which the encryption cycle ends with the value <b>y <sub>1</sub></b> , from which the cycle was started. <br><br>  <i>Attack on the first block <b>at <sub>1</sub> = 474</b> ciphertext.</i> <br>  <b>Step 1</b> : <b>474 <sup>7</sup> (mod527) = 382</b> ; <br>  <b>Step 2</b> : <b>382 <sup>7</sup> (mod527) = 423</b> ; <br>  <b>Step 3</b> : <b>423 <sup>7</sup> (mod527) = 297</b> ; <br>  <b>Step 4</b> : in this step, the already found source code is encrypted, but it must be performed, because the attacker does not know the source text.  A sign of the completion of the attack is the coincidence of the initial value of the ciphertext ( <b>474</b> ) and the result of the 4th step of encryption.  It is such a coincidence that takes place. <br><br>  <b>297 <sup>7</sup> (mod527) = 474</b> received the initial (first) ciphertext block.  The attack on the first block was completed successfully <b>at <sub>1</sub> = 474</b> .  The preceding result of step 3 is the plaintext <b>M <sub>1</sub> = 297</b> . <br><br>  Essentially, in the residue ring modulo <b>n = 527</b> , a short cycle of processing the residue <b>r = 297</b> modulo <b>n = 527 was</b> realized.  This is written as <b>y <sub>i</sub> = y <sub>1</sub> = 297</b> .  Form power deductions <br>  <b>(((297 <sup>7</sup> (mod527)) <sup>7</sup> (mod527)) <sup>7</sup> (mod527)) <sup>7</sup> = 297</b> . <br><br>  <i>Attack on the second block <b>at <sub>2</sub> = 407</b> ciphertext.</i> <br>  <b>Step 1</b> : <b>407 <sup>7</sup> (mod527) = 16</b> ; <br>  <b>Step 2</b> : <b>16 <sup>7</sup> (mod527) = 101</b> ; <br>  <b>Step 3</b> : <b>101 <sup>7</sup> (mod527) = 33</b> ; <br>  <b>Step 4</b> : <b>33 <sup>7</sup> (mod527) = 407</b> . <br><br>  Again, in the third step, the source text block ( <b>M <sub>2</sub> = 33</b> ) was obtained, but the attacker is unknown, and he performs the next (fourth step), the result of which ( <b>407</b> ) coincides with the initial ciphertext <b>at <sub>2</sub> = 407</b> . <br><br>  Essentially, in the residue ring modulo <b>n = 527</b> , a short cycle of processing the residue <b>r = 33</b> modulo <b>n = 527 was</b> realized.  This is written as <b>y <sub>i</sub> = y <sub>2</sub> = 33</b> . <br>  We form power residues <b>((33 <sup>7</sup> (mod527)) <sup>7</sup> (mod527)) <sup>7</sup> (mod527) = 33</b> . <br><br>  The result of the attack (source text <b>M <sub>1</sub> = 297</b> , <b>M <sub>2</sub> = 33</b> ) was obtained by triple encryption of the given ciphertext.  Greater success for the attacker ciphertext is hard to imagine. <br><br>  Continuing the discussion on the choice of the module and other parameters of the cipher, you can add that the cipher module ( <b>n = 527</b> ) does not allow any ciphers to be encrypted at all.  At the same time, the choice of the public key value is not important.  There are source code values ‚Äã‚Äãthat cannot be encrypted at all with the selected cipher with the <b>n = 527</b> module. <br><br>  None of the specified e can not encrypt the source code, represented by numbers <br>  <b>187</b> , <b>341</b> , <b>154</b> and <b>373</b> . <br><br><h3>  Example (inability to encrypt the values ‚Äã‚Äãof some source texts) </h3><br>  Let the source texts be represented by four blocks <b>y = (y <sub>1</sub> = 154, y <sub>2</sub> = 187, y <sub>3</sub> = 341, y <sub>4</sub> = 373)</b> .  The cipher public key exponent <b>e</b> can be any mutually simple number with the Euler function <b>œÜ (n) = œÜ (527) = 480</b> .  However, for the case in question, the public key <b>e</b> can be set arbitrarily.  Indeed, let <b>e = 2, 4, 7, 9, 17, 111</b> then: <br><br>  <b>154 <sup>2</sup> (mod527) = 1</b> ; <br>  <b>154 <sup>4</sup> (mod527) = 1</b> ; <br>  <b>154 <sup>7</sup> (mod527) = 154</b> ; <br>  <b>154 <sup>9</sup> (mod527) = 154</b> ; <br>  <b>154 <sup>17</sup> (mod527) = 154</b> ; <br>  <b>154 <sup>111</sup> (mod527) = 154</b> ; <br>  <b>187 <sup>2</sup> (mod527) = 187</b> ; <br>  <b>187 <sup>4</sup> (mod527) = 187</b> ; <br>  <b>187 <sup>7</sup> (mod527) = 187</b> ; <br>  <b>187 <sup>9</sup> (mod527) = 187</b> ; <br>  <b>187 <sup>17</sup> (mod527) = 187</b> ; <br>  <b>187,111 (mod527) = 187</b> ; <br>  <b>341 <sup>2</sup> (mod527) = 341</b> ; <br>  <b>341 <sup>4</sup> (mod527) = 1</b> ; <br>  <b>341 <sup>7</sup> (mod527) = 341</b> ; <br>  <b>341 <sup>9</sup> (mod527) = 341</b> ; <br>  <b>341 <sup>17</sup> (mod527) = 341</b> ; <br>  <b>341 <sup>111</sup> (mod527) = 341</b> ; <br>  <b>373 <sup>2</sup> (mod527) = 1</b> ; <br>  <b>373 <sup>4</sup> (mod527) = 373</b> ; <br>  <b>373 <sup>7</sup> (mod527) = 373</b> ; <br>  <b>373 <sup>9</sup> (mod527) = 373</b> ; <br>  <b>373 <sup>17</sup> (mod527) = 373</b> ; <br>  <b>373,111 (mod527) = 373</b> . <br><br>  From the considered example follows a simple conclusion.  Indeed, the choice of the parameters of the encryption process must be approached very carefully and a thorough preliminary analysis of such parameters must be carried out.  How to do this is a separate issue, and in the framework of this work it is not considered. </habracut></div><p>Source: <a href="https://habr.com/ru/post/224523/">https://habr.com/ru/post/224523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../224511/index.html">Desktop on the palm</a></li>
<li><a href="../224515/index.html">Non-standard solutions to complex problems</a></li>
<li><a href="../224517/index.html">How to make friends with Android, Visual Studio and Parallels Desktop</a></li>
<li><a href="../224519/index.html">How not to get stuck in the wheel of failures and build the right business. Implementation of business processes</a></li>
<li><a href="../224521/index.html">CC1101 running a PIC controller or building a peer-to-peer network for a radio engineer</a></li>
<li><a href="../224525/index.html">Creating a Zero Player Game using libgdx</a></li>
<li><a href="../224527/index.html">Why does Intel make an alliance with Rockchip?</a></li>
<li><a href="../224535/index.html">Ext JS 5: MVC, MVVM, etc</a></li>
<li><a href="../224537/index.html">Coursera experiments with on-demand model</a></li>
<li><a href="../224541/index.html">Encryption GOST 28147-89 in Acronis Backup 11.5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>