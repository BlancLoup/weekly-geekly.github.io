<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tracking user‚Äôs browser and OS settings as a measure to prevent account hijacking (updated)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dear Habrovchane! Yesterday's version of the article, I thought it was in the drafts. And therefore it was displayed unfinished. I offer the full, add...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tracking user‚Äôs browser and OS settings as a measure to prevent account hijacking (updated)</h1><div class="post__text post__text-html js-mediator-article">  <b>Dear Habrovchane!</b>  <b>Yesterday's version of the article, I thought it was in the drafts.</b>  <b>And therefore it was displayed unfinished.</b>  <b>I offer the full, added version</b> <br><br><img src="http://www.habrastorage.com/images/browsers.jpg" alt="image"><br><br>  Many online services seek to secure the accounts of their users in a variety of ways.  Someone is tracking an IP address, dropping cookies when it is changed (this happens at the <a href="http://www.securitylab.ru/">Seklab</a> ; vKontakte simply asks to confirm the last 4 digits of the mobile phone).  Someone session lives for a limited time, forcing the user to log in again and again.  These methods have their advantages and disadvantages.  But whichever mechanism is used, tracking the browser‚Äôs settings and the user's OS will provide additional protection against account hijacking ( <b>as additional protection, but by no means the main one</b> ).  And it is very strange that I still have not been able to meet a single service supporting this protection mechanism. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Ask a question: in what cases at the next visit of a resource at the user will the cookies be similar to the previous visit, but will the data of the browser and the OS used (which can be pulled out from the User-Agent) change?  Only in 3 cases: <br><br>  1. The user has logged in from different computers (for example, at home and at work) and for some reason uses different browsers. <br>  2. The user has logged in from 1 computer in different browsers (this will probably suffer only web developers and especially curious).  <s>Or those who pollute the OS with obscure baubles (hello to vkSaver fans)</s> <br>  3. The user has hijacked the session. <br><br>  <b>Detecting is not offered the entire parameter User-Agent, but the type of browser (IE, FF, Chrome, Safari, etc.) and the operating system (Windows, Linux, MacOS).</b>  <b>This will solve the problem of false positives when updating software on the user's computer.</b> <br><br>  Yes, the User-Agent can be replaced.  But: <br>  1. Quite often, none of the session hijackers are soared with this. <br>  2. <b>Substitution of User-Agent can be defined</b> (read below how). <br><br>  Consider the proposed method of protection in addition to the existing ones.  In conjunction with the classic cases of theft session. <br><br><a name="habracut"></a><br><br><h5>  IP address change tracking </h5><br><br>  This is a good practice.  But it will not help if the user <s>does not have brains</s> had the sense to enter his account via the wireless network, where his session was listened to.  Either he became a victim of the man-in-the-middle attack from an attacker who is on the same subnet as the provider (do not laugh, a case that is bearded, but still often encountered).  Most likely, the attacker will not bathe with the change User-Agent.  That's what we count on.  As a result, additional protection works. <br><br><h5>  Session lives for a limited time. </h5><br>  Well, moreover, it is inconvenient for the user (often log in).  So also the situation is absolutely similar to the previous one.  And again: changing the User-Agent can be a clear signal of attempted session hijacking. <br><br><h5>  And what about those who still use different browsers at home and at work? </h5><br><br>  Alternatively, one of the cookie variables can be generated on the basis of the User-Agent.  Because  malefactors quite often copy to themselves all cookies of the server indiscriminately, then they will fall back, copying to themselves a variable bound to another User-Agent. <br><br><h5>  ‚ÄúWell, it‚Äôs not difficult to replace the User-Agent, only experienced shackers will not cope with this <s>shkolota</s> ,‚Äù </h5>  - someone here will say their visitors. <br><br><img src="http://www.habrastorage.com/images/useragents.png" alt="image"><br><br>  Indeed, who needs - he will be able to replace.  But an <a href="http://habrahabr.ru/blogs/javascript/135743/">interesting way to determine the browser</a> via javascript comes to the rescue.  The method is very effective, he checked. <br><img src="http://www.habrastorage.com/images/testcaoho.png" alt="image"><br><br>  Although, this method can be circumvented:  javascript is executed in the browser, on the user‚Äôs side (a potential attacker), then we can control its execution and, thereby, bypass the check ( <a href="http://getfirebug.com/">Firebug</a> as one of the options).  But this must be clearly known.  In addition, obfuscation of the script greatly complicates the task. </div><p>Source: <a href="https://habr.com/ru/post/139604/">https://habr.com/ru/post/139604/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139596/index.html">Workshop on using Schuhart control charts</a></li>
<li><a href="../139597/index.html">Published a stop list of zones. RF and .RU</a></li>
<li><a href="../139598/index.html">Apple event March 7, 2012 - New iPad and new Apple TV, iOS 5.1, iPhoto</a></li>
<li><a href="../139601/index.html">STM32F1xx - Developer Tools and FreeRTOS</a></li>
<li><a href="../139603/index.html">Congratulations! We are all under the hood</a></li>
<li><a href="../139606/index.html">iOS 5.1 available for download</a></li>
<li><a href="../139607/index.html">Insert the code generator into the qmake assembly</a></li>
<li><a href="../139611/index.html">The company Carl Zeiss has released "virtual" glasses</a></li>
<li><a href="../139612/index.html">WebSence has discovered a new massive Wordpress blog infection.</a></li>
<li><a href="../139614/index.html">What is wrong with Android?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>