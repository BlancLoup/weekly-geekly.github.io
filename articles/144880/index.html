<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sending letters to Google Docs (Drive)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Creating statistics and managing mailings 
 to Google Docs (from different accounts) based on FormEmailer 

 We, Big Brother Ltd., decided to create s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sending letters to Google Docs (Drive)</h1><div class="post__text post__text-html js-mediator-article"><h1>  Creating statistics and managing mailings <br>  to Google Docs (from different accounts) based on FormEmailer </h1><br><br>  <a href="http://bigbrotherlog.com/">We, Big Brother Ltd., decided to create statistics for</a> mailing results using a script - FormEmailer template.  Let's tell how it was done. <br><br>  For the curious, I'll show you what we are striving for. <br>  It will look something like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="http://habrastorage.org/storage2/ea6/646/3e8/ea66463e87c38179ebde13a42ff12fe5.jpg"><br><a name="habracut"></a><br>  Figure 1: Final View. <br><br>  Now we will start the most interesting - implementation. <br>  To work with the mailing list, we will use a script - the FormEmailer template.  It is multi-functional, flexible to configure, and with little effort becomes a really powerful tool. <br>  Create a ‚ÄúNewsletter‚Äù table in Google Docs. <br>  Click ‚ÄúInsert‚Äù -&gt; ‚ÄúScript‚Äù, find FormEmailer from hgabreu, click Install.  Log in, giving the right to use your calendar. <br><img src="https://habrastorage.org/storage2/a40/a1e/aac/a40a1eaac462ce82f544306c97bb4089.jpg"><br>  After installation, the Form Emailer item appears in the menu. <br><img src="https://habrastorage.org/storage2/8cd/bf5/311/8cdbf53116b1fe9a046b018a9b9b863d.jpg"><br><br>  When you click on it, you will see the Install menu.  Click on it and get a form with a choice of language and a sheet with data (here you will collect the base for distribution). <br>  I will make a reservation, in the BASIS FOR BROADCAST we include only our subscribers. <br><br>  <strong>It is also important to take into account the specifics of the limitations of Google tables.</strong>  <strong>Therefore, we strongly recommend that you read this section.</strong> <a href="http://support.google.com/docs/bin/answer.py%3Fhl%3Dru%26answer%3D37603">Read here.</a> <br><br>  <strong>IMPORTANT:</strong> In order for everything to be created without errors and problems, the sheet must contain at least the names of the columns (to have a header). <br><img src="https://habrastorage.org/storage2/834/448/ec3/834448ec370c4cbbe3f60074429468ec.jpg"><br>  If the base for sending you have more than a couple of thousand, you need to use additional accounts and make the same manipulations in them. <br>  If you have any problems with the installation, go to the program website.  <a href="https://sites.google.com/site/formemailer/">Site</a> <br><br>  As a result, we get a tool for mass mailing with a limit on the use of your Gmail account - 500 emails per day.  It is advisable not to use the maximum limit due to the risk of getting a ban. <br><br>  This is how our documents look: <br><img src="https://habrastorage.org/storage2/f77/cae/6ca/f77cae6cacdc27ea29b27cab22c78aa1.jpg"><br><br>  Figure 2: Sheet Types <br>  1. - sheet ‚ÄúData‚Äù;  2. - sheet ‚ÄúFormEmailer‚Äù;  3. - sheet ‚Äú05/2012‚Äù;  4. - sheet ‚ÄúReport‚Äù. <br><br>  When creating, from Install you will get 2 tabs: <br>  1) Data is our base.  You will use this document as a mailing list. <br>  2) FormEmailer - template and basic mailing settings. <br><br>  We create another sheet - ‚ÄúReport‚Äù, and we will create a sheet of the archive using the program.  All dispatch reports will be collected. <br><img src="https://habrastorage.org/storage2/223/bf5/099/223bf509993982dd9c9f691a6c59283e.jpg"><br><br>  So, let's get down to bringing the FormEmailer-a script for you.  Version does not matter. <br><br>  Open the script editor, open the code FormEmailera. <br>  Use Ctrl + F to find the function processManually and enter our code before it. <br>  In order for everything to work, it is necessary that the code be the same as mine. <br><br>  This code will add to our document an archive sheet with the name of the current month and year in the form ‚Äú05/2012‚Äù - month / year. <br><br><img src="https://habrastorage.org/storage2/520/82e/1b7/52082e1b7484277d2f771ea2ba1b4c7e.jpg"><br><br><pre><code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thisMonth = Utilities.formatDate(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(), SpreadsheetApp.getActiveSpreadsheet().getSpreadsheetTimeZone(), <span class="hljs-string"><span class="hljs-string">"MM/yyyy"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> outputSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(thisMonth); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !outputSheet ) { SpreadsheetApp.getActiveSpreadsheet().insertSheet(thisMonth); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> outputSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(thisMonth); }</code> </pre> <br><br>  We add the counter of the sent letters. <br><br><img src="https://habrastorage.org/storage2/e33/b56/532/e33b5653210f06b496c779ffbd35d818.jpg"><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count_send_email = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br><br>  Create a cell in the columns with the date and copy to the archive for reference and comment on the text that is responsible for the statistical data. <br><br><img src="https://habrastorage.org/storage2/2c0/ab2/2ee/2c0ab22eeef2d95980ab139d5af3b0cf.jpg"><br><br><pre> <code class="hljs pgsql">var thisDate_send_email = Utilities.formatDate(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">Date</span></span>(), SpreadsheetApp.getActiveSpreadsheet().getSpreadsheetTimeZone(), "MM/dd/yyyy"); var time_send_email = Utilities.formatDate(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">Date</span></span>(), SpreadsheetApp.getActiveSpreadsheet().getSpreadsheetTimeZone(), "MM/dd/yyyy hh:mm:ss"); c.fs.getRange(<span class="hljs-type"><span class="hljs-type">line</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>).setValue("Email sent, " + time_send_email); c.fs.getRange(<span class="hljs-type"><span class="hljs-type">line</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>).setValue(thisDate_send_email); var dataHeight = c.fs.getDataRange().getHeight(); var dataWidth = c.fs.getDataRange().getWidth(); // <span class="hljs-keyword"><span class="hljs-keyword">Check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> there free <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the output sheet <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(outputSheet.getDataRange().getHeight()==outputSheet.getMaxRows()) outputSheet.insertRowAfter(outputSheet.getMaxRows()); Logger.log("height:"+outputSheet.getDataRange().getHeight()); Logger.log("max: "+outputSheet.getMaxRows()) count_send_email++; c.fs.getRange(<span class="hljs-type"><span class="hljs-type">line</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, dataWidth).moveTo(outputSheet.getRange(outputSheet.getDataRange().getHeight()+<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); c.fs.deleteRow(<span class="hljs-type"><span class="hljs-type">line</span></span>); } catch(e) { status.push(repl_(T.statusError, s.qtt == <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-string"><span class="hljs-string">''</span></span> : i+<span class="hljs-number"><span class="hljs-number">1</span></span>, e)); c.err.push(repl_(T.mailError, s.qtt == <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-string"><span class="hljs-string">''</span></span> : i+<span class="hljs-number"><span class="hljs-number">1</span></span>, e, <span class="hljs-type"><span class="hljs-type">line</span></span>)); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { status.push(T.statusQuota); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( c.err.length == <span class="hljs-number"><span class="hljs-number">0</span></span> || !startsWith_(c.err[c.err.length<span class="hljs-number"><span class="hljs-number">-1</span></span>], T.statusQuota) ) c.err.push(t.statusQuota+<span class="hljs-string"><span class="hljs-string">'. '</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">Date</span></span>()); break; } } outputSheet.getRange(outputSheet.getLastRow(),<span class="hljs-number"><span class="hljs-number">5</span></span>).setValue(count_send_email); <span class="hljs-comment"><span class="hljs-comment">/* c.fs.getRange(line,1).setValue(status.join('; ')); if( c.fl &amp;&amp; line != 2 ) { if( s.closure === 'values' ) all.setValues([values]); else if( s.closure === 'clear' ) all.clearContent(); //else formulas &gt; just leave them there }*/</span></span></code> </pre> <br><br>  We will not go into the details of writing the script. <br>  If you have any questions, write - answer. <br>  This completes the refinement of FormEmailer. <br><br>  <strong>We start the statistics.</strong> <br><br>  Create a file where statistics will be collected. <br><br>  Next, we need to ensure that the ‚ÄúReport‚Äù summary table is copied into the summary document <a href="https://docs.google.com/spreadsheet/ccc%3Fkey%3D0AtxnobaOdwU2dFF0ZkNFcmVSUXYwSFZCOW9iTHdtM3c">Statistics</a> <br><br>  To do this, create a new updateData function in the FormEmailera script. <br>  At the end of the code, approximately on line 1164, after the closing bracket of the previous function, add the following: <br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> SOURCE_SPREADSHEET_ID = <span class="hljs-string"><span class="hljs-string">" ,    "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> SOURCE_SHEET_NAME = <span class="hljs-string"><span class="hljs-string">"  "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> DESTINATION_SPREADSHEET_ID = <span class="hljs-string"><span class="hljs-string">" ,   "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> DESTINATION_SHEET_NAME = <span class="hljs-string"><span class="hljs-string">" ,   "</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sourceSheet = SpreadsheetApp.openById(SOURCE_SPREADSHEET_ID).getSheetByName(SOURCE_SHEET_NAME); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(sourceSheet!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sourceData = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(SOURCE_SHEET_NAME).getDataRange().getValues(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> destinSheet = SpreadsheetApp.openById(DESTINATION_SPREADSHEET_ID).getSheetByName(DESTINATION_SHEET_NAME); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(destinSheet!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>) destinSheet.getRange(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, sourceData.length, sourceData[<span class="hljs-number"><span class="hljs-number">0</span></span>].length).setValues(sourceData); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">"Destination sheet not found."</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">"Source sheet not found."</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(e) { Logger.log(e.message); Browser.msgBox(Logger.getLog()); } }</code> </pre> <br><br>  In order for our summary statistics sheet to become final, we will write the formulas for collecting the number of category letters sent / waiting to be sent. <br><br>  SENT: <br>  = (ARRAYFORMULA (SUMIF ('05 / 2012 '! $ B: $ B, $ A2, '05 / 2012'! $ E: $ E))) <br><br>  Decipher the formula: <br><br>  ARRAYFORMULA ‚Äî Array-in-a-cell formulas allow you to write formulas using array input, rather than output data. <br>  SUMIF - Amount (range; criteria; total_range) <br>  range - page 05/2012 column B, the $ sign reinforces this column when the formula is propagated by ‚Äúpull down‚Äù (that is, each cell will have a range of $ B: $ B; $ B: $ B; $ B: $ B if if $ were not, it would be like this: B: B; C: C; D: D. (in this case, this is the date). <br>  $ A2 is the criterion by which summation should be carried out, in our case it is 5/1/2012, and so on. <br>  IMPORTANT: in order for you to have all the calculations correct, the type of criteria you are looking for must be the same.  That is, if you select on 5/1/2012, it is not the same as 1/5/2012, MM / DD / YYYY is not equal to DD / MM / YYYY. <br>  total_range - '05 / 2012 '! $ E: $ E is the column where calculations should be made (in our case, this is the number of letters). <br><br>  WAITING: <br>  = COUNTIF ('Data'! C: C, "* @ *") <br>  decipher the formula - READ IF (In the C column of the ‚ÄúData‚Äù sheet there is a text with the contents of @) <br>  <a href="https://support.google.com/docs/bin/static.py%3Fhl%3Dru%26topic%3D25273%26page%3Dtable.cs%26ctx%3Dtooltip">more about formulas</a> <br><br><h4>  List of Google Spreadsheets features </h4><br><br>  There is one problem - if we write our formula in all columns, then we get the same number in all columns, and we need a real number tied to the date. <br><br><br>  In order to correctly process waiting letters, it is necessary to bind the number to the date and, when working with the formula, leave only the resulting value.  The code below solves this problem. <br><br><img src="https://habrastorage.org/storage2/f5d/df9/062/f5ddf9062e4aa84bd06bb1ca56dc2ed9.jpg"><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thisDay = Utilities.formatDate(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(), SpreadsheetApp.getActiveSpreadsheet().getSpreadsheetTimeZone(), <span class="hljs-string"><span class="hljs-string">"dd"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myArray_Date = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(); myArray_Date = [<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">17</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">21</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>,<span class="hljs-number"><span class="hljs-number">23</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>,<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">29</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">31</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dataSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(<span class="hljs-string"><span class="hljs-string">"Report"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> date_count = <span class="hljs-number"><span class="hljs-number">0</span></span>; date_count &lt; <span class="hljs-number"><span class="hljs-number">30</span></span>; date_count++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (myArray_Date[date_count]==thisDay) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = myArray_Date[date_count] + <span class="hljs-number"><span class="hljs-number">1</span></span>; dataSheet.getRange(y, <span class="hljs-number"><span class="hljs-number">3</span></span>).setFormula(<span class="hljs-string"><span class="hljs-string">"=COUNTIF('Date'!C:C, \"*@*\")"</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> datatocopy = dataSheet.getRange(y, <span class="hljs-number"><span class="hljs-number">3</span></span>).getValues(); dataSheet.getRange(y, <span class="hljs-number"><span class="hljs-number">3</span></span>).setValues(datatocopy);</code> </pre><br>  Now we will start forming statistics. <br>  We have a document for generating statistics, but in order to form it completely, not one such document is necessary, but several. <br>  But for the time being we will proceed only from one document that we have. <br>  For the formation of using the formula. <br><br>  Create a page for the total count. <br><img src="http://habrastorage.org/storage2/ea6/646/3e8/ea66463e87c38179ebde13a42ff12fe5.jpg"><br>  Figure 3. Statistics that we wanted to see. <br>  In order to speed up the work, we will write a script to collect data from our two sheets. <br><pre> <code class="hljs kotlin">function myFunction() { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> workSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(<span class="hljs-string"><span class="hljs-string">"REPORT"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rew; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myReport_Name = new Array(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> first_work_row = <span class="hljs-number"><span class="hljs-number">3</span></span>, last_work_row = <span class="hljs-number"><span class="hljs-number">33</span></span>, count_column = <span class="hljs-number"><span class="hljs-number">2</span></span>; workSheet.getRange(<span class="hljs-string"><span class="hljs-string">"B"</span></span> + first_work_row + <span class="hljs-string"><span class="hljs-string">":F"</span></span> + last_work_row).clearContent(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=first_work_row; i&lt;=last_work_row; i++) { rew = i - <span class="hljs-number"><span class="hljs-number">1</span></span>; workSheet.getRange(i, <span class="hljs-number"><span class="hljs-number">2</span></span>).setFormula(<span class="hljs-string"><span class="hljs-string">"=(ARRAYFORMULA(SUMIF('  '!</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$A</span></span></span><span class="hljs-string">:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$A</span></span></span><span class="hljs-string">&amp;'  '!</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$A</span></span></span><span class="hljs-string">$1; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$A</span></span></span><span class="hljs-string">"</span></span> + i + <span class="hljs-string"><span class="hljs-string">"&amp;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$B</span></span></span><span class="hljs-string">$1; '  '!B:B)))"</span></span>); workSheet.getRange(i, <span class="hljs-number"><span class="hljs-number">3</span></span>).setFormula(<span class="hljs-string"><span class="hljs-string">"=(ARRAYFORMULA(SUMIF('  '!</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$A</span></span></span><span class="hljs-string">:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$A</span></span></span><span class="hljs-string">&amp;'  '!</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$A</span></span></span><span class="hljs-string">$1; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$A</span></span></span><span class="hljs-string">"</span></span> + i + <span class="hljs-string"><span class="hljs-string">"&amp;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$B</span></span></span><span class="hljs-string">$1; '  '!C:C)))"</span></span>); workSheet.getRange(i, <span class="hljs-number"><span class="hljs-number">4</span></span>).setFormula(<span class="hljs-string"><span class="hljs-string">"=Report_!F"</span></span> + rew); workSheet.getRange(i, <span class="hljs-number"><span class="hljs-number">5</span></span>).setFormula(<span class="hljs-string"><span class="hljs-string">"=Report_!E"</span></span> + rew); workSheet.getRange(i, <span class="hljs-number"><span class="hljs-number">6</span></span>).setFormula(<span class="hljs-string"><span class="hljs-string">"=Report_!D"</span></span> + rew); } }</code> </pre> <br>  In order for the menu to have a button, we add a small code: <br><pre> <code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onOpen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ SpreadsheetApp.getActiveSpreadsheet().addMenu(<span class="hljs-string"><span class="hljs-string">"?"</span></span>, [{name: <span class="hljs-string"><span class="hljs-string">"!"</span></span>, functionName: <span class="hljs-string"><span class="hljs-string">"myFunction"</span></span>}]); }</code> </pre> <br><br>  Now you do not need to enter the script every time you need to make a calculation.  Just click on the ‚ÄúDig‚Äù button and wait for the result. <br><br>  To automate the process of starting a script, you can also use triggers that are configured in the script editor (Resources - Trigerras of the current script). <br><br>  Such a table should appear, click on the ‚ÄúAdd‚Äù link and set the following parameters. <br><img src="http://habrastorage.org/storage2/344/147/ded/344147ded9729e4244902fe9d1a3fe2c.jpg"><br>  Now the script will run automatically without your participation every 2 hours.  You can customize in different ways. <br><br>  You can write formulas manually, but when you have more than one sheet, but 20 or more, you can easily make a mistake when compiling the same formulas. <br><br>  The only thing missing in our script is the ‚Äúonly values‚Äù parameter, which is necessary in order not to load the document with formulas. <br><br>  Table with account and criteria - <a href="https://docs.google.com/spreadsheet/ccc%3Fkey%3D0ArJ3TrTw5_iGdDJyaXJrZzl3ajlCVmxwMHAwdkpBVWc">Account</a> <br>  Pivot table - Pivot <br><br>  The only disadvantage of this statistic is the need to enter dates manually.  If someone offers to automate the process of putting a date, excluding weekends, we will be grateful for your help. <br><br>  That's all that we could tell you about the organization of statistics with online access. <br><br>  Use files, learn, share links with friends. <br>  We are waiting for your feedback. <br><br>  Sincerely, Anton. </div><p>Source: <a href="https://habr.com/ru/post/144880/">https://habr.com/ru/post/144880/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../144871/index.html">Samsung and Google introduced new chromabuki</a></li>
<li><a href="../144872/index.html">Generating DTO and remote interfaces from Java to ActionScript</a></li>
<li><a href="../144875/index.html">On the road to the clouds with Windows Server 2012 and not only</a></li>
<li><a href="../144876/index.html">Akismet has already eliminated 50 billion spam comments on Wordpress blogs</a></li>
<li><a href="../144877/index.html">Turn on Yandex.Music on iPhone</a></li>
<li><a href="../144881/index.html">Neural networks for dummies. Part 2 - Perceptron</a></li>
<li><a href="../144884/index.html">Phorm</a></li>
<li><a href="../144885/index.html">We correspond with the torrent client</a></li>
<li><a href="../144886/index.html">Introduction to modular arithmetic</a></li>
<li><a href="../144888/index.html">Powershell: Shuffle Files</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>