<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Digging into the data as a degree of freedom</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings dear readers. 
 This material will shed light on the problem of the convenience of working with RDBMS, to which I have devoted many years, b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Digging into the data as a degree of freedom</h1><div class="post__text post__text-html js-mediator-article">  Greetings dear readers. <br>  This material will shed light on the problem of the convenience of working with RDBMS, to which I have devoted many years, but did not find the time to tell. <br><br>  If you do not search, view and analyze data or do it, but are completely comfortable and do not have anything to do, feel free to stop reading this text. <br><br><h1>  Problematics </h1><br>  So, you are a user who has the right to read in a certain DBMS.  Probably, you are faced with a set of typical subtasks: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Understand the data structure </li><li>  Find the right entities in it. </li><li>  Find the fields in them </li><li>  Find relationships between entities </li><li>  Find values ‚Äã‚Äãof interest </li><li>  Select a set of values </li><li>  Select the desired data </li><li>  Make sure that this is really the MOST data you were looking for. </li><li>  Save results </li><li>  Prepare reports from them </li></ul><br><br>  Finally, it is very likely that these tasks you need to solve regularly. <br><br>  There are a huge amount of tools devoted to building queries, cubes and reports on the data processing tools market.  Regrettably, but most of them do not see that the user has the above tasks in their entirety.  Here are the typical problems, in reverse order from the previous list: <br><a name="habracut"></a><ul><li>  Rarely where you will find the opportunity to fix the knowledge found, each new request - as from scratch </li><li>  Previously prepared requests can only be raised in <br>  pure SQL </li><li>  The query structure (fields, filters, groupings) is hard to change.  As a rule, the price of rapid changes is loss of integrity or residual redundancy. </li><li>  The preparation of the filters is done blindly. </li><li>  Relationships between entities are subject to manual indication. </li><li>  All the database schema available to him falls out on the user. </li></ul><br><br>  All this in the absence of documentation on the structure.  Although it is out of the tool, the problem concerns the tools directly. <br><br>  If you don‚Äôt understand the reality of the problems listed above, then I hope that you will understand this after learning how I try to solve them.  If, in your opinion, these problems are contrived, then it will be easier for us if you do not read further. <br><br><h1>  Decision </h1><br>  A comprehensive solution to the problems identified in the Freedom of Sampling program is conducted in several directions simultaneously.  The text of this section describes in detail the applied concepts and implementation nuances. <br><br><h2>  Clear and convenient data structure </h2><br>  Only the simplest database contains entities in which it is impossible to get lost.  In a well-developed application area, tables and fields are measured in tens and hundreds, respectively, and if we talk about repositories, these are hundreds and thousands.  In addition, a developer or analyst often has several connections (test, production, archive) for each subject area, which, as a rule, are also quite a lot. <br><br>  Distinguishing the necessary from the completely unnecessary is one of the first tasks solved by our tool. <br><br><h3>  Databases and tables </h3><br>  Within the selected ‚Äúengine‚Äù of access, you can create and remember connections, which, incidentally, is standard. <br><br>  In the full list of tables you can find the fields of interest by substring, for example: <br><br><img width="478" height="212" src="https://habrastorage.org/getpro/habr/post_images/154/893/7e0/1548937e07869dfcac8f6beea6d3ad35.png"><h3>  Context </h3><br>  An entity / table context is a concept that is close to Business Objects universes, but broader.  It is natural to proceed from the assumption that the user is not interested in tables that are not related to the selected one.  At the same time, it would be a mistake to think that only directly related tables are included in the context - therefore in the context we can see the nesting of any level: <br><br><img width="204" height="416" src="https://habrastorage.org/getpro/habr/post_images/804/8f9/f2b/8048f9f2b5052b71ddbb70265ecaedad.png"><br><br>  Nodes are entities, leaves are fields.  Associated entities are shown next to the fields of the entity with which they have a connection.  Multiple links to the same entity are distinguished by the fields through which the link is indicated: <br><br><img width="197" height="187" src="https://habrastorage.org/getpro/habr/post_images/992/328/2a4/9923282a4c710f577fafcf6c0e2e0806.png"><br><br>  By default, only entities referenced by the fields are shown, but you can also see connections from the other side. <br><br><img width="210" height="496" src="https://habrastorage.org/getpro/habr/post_images/678/f82/032/678f82032c9d126ae895f9bc9107216b.png"><br><br>  This operation is performed either one-time, individually for each table, or the mode for all tables is turned on automatically. <br><br><br><h4>  Recognition </h4><br>  You are lucky if the system architect has provided all the foreign keys and registered them in the scheme, then the connections will be determined automatically and you will almost not need to take care of this.  I love watching such databases;  The examples in the screenshots above are made in one of them - thanks to my teachers on one of the projects. <br><br>  You are not lucky, not only if the architect has not provided for this, but also if the sub-driver of the access components does not support the receipt of this information.  In ADO and ODBC, this is often the case, but these engines are not the only ones our tool can work with. <br><br><h4>  Definition </h4><br>  Suppose, for some reason, we are still faced with the fact that the data on the connections cannot be taken from the scheme.  But they are so convenient to use each time. <br><br>  We can define them on our own.  There are several ways to do this. <br><br>  The simplest is a one-time bundle of one field, through the context menu and the dialog (in some cases this can be done via drag'n'drop fields on each other): <br><br><img width="393" height="306" src="https://habrastorage.org/getpro/habr/post_images/cfa/f4f/b49/cfaf4fb495ff29298af4672d85d5729d.png"><br><br>  More complex is a bunch of several fields: <br><br><img width="370" height="373" src="https://habrastorage.org/getpro/habr/post_images/483/b49/a6d/483b49a6d4bb214e16db60e6ae3478db.png"><br><br>  Finally, aerobatics is a multiple typical connection of all necessary tables: <br><br><img width="363" height="220" src="https://habrastorage.org/getpro/habr/post_images/822/ca4/d49/822ca4d495bfcaf782c3f7f958af3f9f.png"><br><br>  I had to perform the last task by analyzing the schema of one popular Open Source portal, where there are several dozen obvious links to each of the reference tables, in which, in turn, the number of links reaches the same order of magnitude. <br><br>  All these links will be stored in the local "scheme" that exists as an addition to the automatically recognized links through the driver to the database, and henceforth will be determined by contexts along with them. <br><br><h4>  Other features </h4><br>  For individual special cases, there are separate goodies that make the context more flexible.  We will not dwell in detail, just a snapshot of the context menu: <br><br><img width="401" height="297" src="https://habrastorage.org/getpro/habr/post_images/3c3/1c4/40a/3c31c440af41cffffdcc61a960406680.png"><h3>  Fine, but what is all this for ?! </h3><br>  The definition and display of the context of the entity with which the user works is not only done so that he can focus on choosing the data he needs, nested in the links.  The user does not think about linking them, because the query builder takes into account binding fields and the nature of the link is transparent to the user. <br><br><h2>  Convenience request building </h2><br>  We have taken the first step for convenient work - we have separated the important from the secondary.  Now our task is to simplify the selection of the essential from the available. <br><br><h3>  On the run </h3><br>  Our task is to open the context to the desired depth and select the required fields.  Tables are only a way to navigate to them, their indication is not required at all.  Typical operations with fields in the query - adding to the selection, adding to the filter and adding to the expression (in the selection or filter). <br><br>  The figure highlights three buttons-icons of typical actions and shows the result of one of them (adding to the filter) using the example of the Name field of the ServiceSubGroup table referenced by the Service table: <br><br><img width="278" height="502" src="https://habrastorage.org/getpro/habr/post_images/1a1/7f0/b3a/1a17f0b3a86702b8fb5261400c82b92e.png"><br><br>  When you select a table in the tool, you can automatically add all fields to the selection.  However, we do not need extra garbage in the results, so we want to get rid of some fields (in the figure, the same Service table is shown): <br><br><img width="233" height="312" src="https://habrastorage.org/getpro/habr/post_images/4e9/c6e/a01/4e9c6ea0193744f68da72d07ce3af1b4.png"><br><br>  ... And add a field from the depth of the context (done via drag'n'drop): <br><br><img width="410" height="190" src="https://habrastorage.org/getpro/habr/post_images/ddd/33f/d90/ddd33fd900805d5e88690ba2f9930338.png"><br><br>  ... find the maximum value of the field in groups and the number of lines: <br><br><img width="624" height="202" src="https://habrastorage.org/getpro/habr/post_images/dcb/88c/81f/dcb88c81f19d109ee7c8e300411247e8.png"><br><br>  ... then regroup the fields: <br><br><img width="214" height="136" src="https://habrastorage.org/getpro/habr/post_images/af7/a19/3f9/af7a193f91b83b00bd99c34d9a781a0e.png"><br><br>  ... make a request (filter definition is omitted, about it later): <br><br><img width="623" height="222" src="https://habrastorage.org/getpro/habr/post_images/a28/62b/77c/a2862b77c29460c361cfb03f7dae53f5.png"><br><br>  ... temporarily remove one field from the selection and ungroup another: <br><br><img width="231" height="137" src="https://habrastorage.org/getpro/habr/post_images/94f/d81/686/94fd816867749491d72620a919ecb7f1.png"><br><br>  ... make a new query and see a more interesting result: <br><br><img width="623" height="222" src="https://habrastorage.org/getpro/habr/post_images/b88/c88/882/b88c8888260b10e0e6b0e9c3ea977366.png"><br><br>  All this and much more now we can do with a minimum of clicks. <br><br><h3>  Object model </h3><br>  The most important feature of the Freedom of Sampling tool is that database objects are treated in a holistic manner everywhere: shown, added, deleted, hidden, and so on.  It allows the user to relax, operating with them, and not to lose the tool and not <br>  spoil them in dialogue with the user. <br><br>  The object model clearly controls the need and sufficiency of connections, takes into account the fields that need to be grouped by request.  For example: <br><br><img width="623" height="333" src="https://habrastorage.org/getpro/habr/post_images/42e/1d0/7cd/42e1d07cd11d9a31449da89110195b6f.png"><br><br>  We make a grouping request for the sum of all services in the group, divided by subgroup and service name, in the middle of the figure the generated request is shown. <br><br>  Then we want to group only by subgroup, for this we ‚Äúhide‚Äù the name of the service: <br><br><img width="623" height="328" src="https://habrastorage.org/getpro/habr/post_images/9a3/65b/5ca/9a365b5ca488f4b18608d7d463ed52ed.png"><br><br>  In the request, the Shortname disappeared from both parts (select, group by). <br><br>  Finally, remove the selection condition (again, temporarily): <br><br><img width="623" height="330" src="https://habrastorage.org/getpro/habr/post_images/3f0/e17/4dc/3f0e174dc306a63010bc5c5e522d3031.png"><br><br>  The request not only completely disappeared the where section, but also became one join less, since we no longer need the fields of the ServiceGroup table. <br><br>  Naturally, in the same few clicks you can return the request to the opposite state. <br><br><h3>  Expression editor </h3><br>  The use of fields and connections alone is sufficient only up to a certain limit.  Sooner or later it is necessary to calculate from them new values ‚Äã‚Äãthat are not presented in the database directly.  How to combine the conveniences already known to us and the manual creation, and even more so the change of designs? <br><br>  The output is quite simple: you must continue to use the fields as objects, and the rest of the richest syntax (except for standard aggregate functions) to give all the various DBMS to the user.  That is, everything that is not a field, he will write with the text, plus there is an opportunity to refer or not to refer to the fields in the "correct style". <br><br>  The expression editor is designed so that you can insert a link to any available field in the expression text anywhere or delete any of the previously mentioned links: <br><br><img width="624" height="291" src="https://habrastorage.org/getpro/habr/post_images/dae/6bd/e37/dae6bde3730600f3720be26e25ea0400.png"><br><br>  In the figure you can see that we have made the difference between the sum of the session and the sum of the sum of operations (in the hope that it will give 0, as it should) and divided it all into 100 (the sums were initially in kopecks).  In this expression, there are six objects that can be controlled and are distinguished by a tool: an opening bracket, two fields, an aggregate function, and two closing brackets.  The brackets are moved to managed objects to simplify the control of their pairing (when you remove the bracket, on the one hand, the bracket / function on the other is automatically removed) and the possibility of checking the occurrence of the field in the aggregate expression.  All other characters: <b>-</b> , <b>/</b> , <b>1</b> , <b>0</b> , <b>0</b> will be transferred to the server "as is" and for the tool they do not mean anything. <br><br>  This may not seem very convenient - to switch between creating links and writing the rest of the expression.  However, even if we only compare the speed of typing the average number of characters in a field, we already get the gain.  Let's add here the possible depth of context.  And as a payment for the convenience of manipulation, considered both earlier and later in this text, this difference can not be considered at all. <br><br>  Any field specified in the selection or filter is already ready to be changed, for example: <br><br><img width="346" height="172" src="https://habrastorage.org/getpro/habr/post_images/9e2/410/eb1/9e2410eb1da93dc7917c60b1ab44eff2.png"><h2>  The most convenient filtering </h2><br>  It is clear that in the presence of excellent means for manipulating the sample, working with limiters should be no less simple.  Consider what opportunities we have at our disposal. <br><br><h3>  Set filters in a few clicks </h3><br>  The filter panel initially contains an empty container for them: <br><br><img width="279" height="104" src="https://habrastorage.org/getpro/habr/post_images/fd3/52f/05e/fd352f05ec6749529dd66e25e5fd3d9a.png"><br><br>  There are several ways to add a filter to a container: <br><br><ul><li>  Create new, empty </li><li>  Click on the button "in the filter" in the scheme </li><li>  Drag a field from the map </li><li>  Drag an expression from the selection into the container (a filter will be created with a copy of the expression) </li></ul><br><br>  As a result, we get something like (filters are only sketched, but all are non-predefined): <br><br><img width="513" height="75" src="https://habrastorage.org/getpro/habr/post_images/170/b39/5d1/170b395d1d57fbd56e4668f16637e66a.png"><br><br>  You can add filters by selecting any of them and then specify its type and value: <br><br><img width="624" height="192" src="https://habrastorage.org/getpro/habr/post_images/0ea/e14/35b/0eae1435b8949387b33d3ee6c718897d.png"><h4>  Predictive selection of values </h4><br>  Regardless of the complexity of the expression on the left, we have the opportunity to quickly understand the set of possible values ‚Äã‚Äãthat we are going to filter.  Let's make our expression a bit more catchy, and see what the ‚Äúdirectory‚Äù offers to us: <br><br><img width="623" height="274" src="https://habrastorage.org/getpro/habr/post_images/0c6/f3b/9d7/0c6f3b9d7da5c954cf60cffbd39121e8.png"><br><br>  The handbook diligently gave us all the combinations for this expression. <br><br>  However, this was the simplest case, since all combinations of the fields of the tables to which they belong were selected.  Often there are too many of them, and there is no guarantee that they will be in the sample at all.  For such cases, there are two additional selection modes: <br><br><img width="277" height="199" src="https://habrastorage.org/getpro/habr/post_images/f49/576/c48/f49576c48324361015c56e1cb6e359cb.png"><br><br>  They are arranged by increasing request duration. <br><br>  ‚ÄúExpected without filter‚Äù means that only those values ‚Äã‚Äãthat are referenced from the tables of selected fields will be selected. <br><br>  "Expected with the filter" take into account the superimposed filters, thereby further narrowing the options.  Naturally, the current filter is discarded. <br><br>  After removing the empty filter from the previous example, and setting the ‚ÄúExpected with filter‚Äù selection, we will see the following result: <br><br><img width="623" height="279" src="https://habrastorage.org/getpro/habr/post_images/d95/328/937/d95328937a1cab3f76c0e6277df4d725.png"><br><br>  We could take away the values ‚Äã‚Äãlong and painfully, each time getting an empty sample, since  the filter for this expression is either redundant or "incompatible with life." <br><br><h3>  Group, regroup, and disable filters </h3><br>  We have so far considered the simplest set of several simple filters.  However, the panel allows you to group them into any combination, to perform over them the operations of association on the basis of "and", "or", to deny.  This is done using the drag'n'drop gesture and toolbar buttons.  Each filter can be disabled, even the root.  You can, say, create such a composition: <br><br><img width="624" height="141" src="https://habrastorage.org/getpro/habr/post_images/64d/e6d/b7a/64de6db7a432617e5bbc78fa63a1a0d3.png"><h2>  Short and for ages </h2><br>  What was once done does not want to be repeated again, at least if we are talking about labor.  Let us enumerate, what results can be relied upon, having once produced them. <br><br><h3>  Saving link configuration </h3><br>  One of the foundations of the tool's convenience is table contexts.  If you had to work on them manually, then they are saved to a file, which, among other things, can be edited manually or carried with them to another workplace.  However, everyone is better if this information is spelled out by the architect. <br><br><h3>  Recoverable query structure </h3><br>  The created request can be saved and transferred as a full-fledged ‚Äúdocument‚Äù: when opened at another time or in another place, it will be restored in all trifles.  The only natural limitation is that the connection to the database must be accessible and its structure must match up to the fields used.  The transfer of context settings is not required, copies of the necessary links are written in the document. <br><br><img width="563" height="423" src="https://habrastorage.org/getpro/habr/post_images/1ea/ce0/9e4/1eace09e45d1c8d021921101cafb4412.png"><h3>  Each completed request is saved to the historical pool. </h3><br>  As soon as you have completed the request, it is added to the list of previously executed.  This is done so that you can compare the results between iterations of the refinement of fields, conditions, groupings and other things.  In addition to the data set, the query structure is saved (as a document) - it can be restored, and the original SQL query (it could be changed manually). <br><br><img width="623" height="282" src="https://habrastorage.org/getpro/habr/post_images/cc9/677/5bb/cc96775bb3227acca9d92034155b3d0f.png"><h3>  Auto-save and restore session </h3><br>  Finally, the entire request history is saved in case of a program crash, after restarting, it is completely restored. <br><br><img width="264" height="122" src="https://habrastorage.org/getpro/habr/post_images/b86/c67/52f/b86c6752f4e02c64514bd9d5fb96aa4f.png"><h2>  Development directions </h2><br>  There are many little things in the tool that were not mentioned here, since they are not distinctive features.  In addition, many of these little things may have died or died out due to infrequent use, or by-products of refactoring. <br><br>  While the tool is little known, it contains only what the developer is facing.  If there is interest and demand, much can be repaired and completed. <br><br>  Initially, the tool developed as a desktop, but recently, as an experiment, a simplified web interface to it was implemented.  The desktop interface itself is rather outdated. <br><br>  Your reaction, dear readers, I hope, and will determine whether the instrument is worth living a dynamic life, or is it just an illustration <br>  another dead end branch of development.  Thanks for attention! <br></div><p>Source: <a href="https://habr.com/ru/post/197424/">https://habr.com/ru/post/197424/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197414/index.html">Protecting the site from spammers and account hijacking</a></li>
<li><a href="../197416/index.html">Writing an HTML5 game in 20 minutes, or an introduction to the Phaser framework</a></li>
<li><a href="../197418/index.html">Techno Anarchism</a></li>
<li><a href="../197420/index.html">Meet the free and free font Imperial</a></li>
<li><a href="../197422/index.html">Convenient utilities for android</a></li>
<li><a href="../197428/index.html">IT Professional Principles</a></li>
<li><a href="../197434/index.html">Concepts P2P social networks and Diaspora</a></li>
<li><a href="../197436/index.html">Oracle OpenScript: automated functional testing system</a></li>
<li><a href="../197438/index.html">Linux Kernel EFI Boot Stub or "Self Loader"</a></li>
<li><a href="../197442/index.html">Replenishment of Yandex.Money: any account from any (almost) card</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>