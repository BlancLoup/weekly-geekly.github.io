<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implementation of the skin system in the Android application, or changing colors in one click</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings to all habravchan! 

 I recently implemented an interesting, in my opinion, task in an android application and decided to share my experienc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implementation of the skin system in the Android application, or changing colors in one click</h1><div class="post__text post__text-html js-mediator-article">  Greetings to all habravchan! <br><br>  I recently implemented an interesting, in my opinion, task in an android application and decided to share my experience with you. <br>  The task is as follows: change the color gamut of the application with one click.  The so-called implementation of skins for the application. <br><br><a name="habracut"></a><h5>  Task </h5><br>  To make dynamic all views of the application, as well as in runtime to implement the change of skins. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Solution idea </h5><br>  When creating an activity, the system first parses the xml markup and constantly pulls the overrayd method getResources () when it encounters a link to resources from the markup.  It is precisely in this link that we can intervene and slip the system‚Äôs own resources, and not those that it requests.  At the same time, without noticing the trick, the system will apply the necessary resources to the views.  And this is what we, in fact, sought. <br><br><h5>  Implementation of the idea </h5><br>  Based on the above, we need: <br><br>  1) in the markup it is necessary to indicate links to resources (ie, implicitly).  Well, of course, everything is specified via drawable, as well as colors <pre><code class="xml hljs">android:background="@color/color_tabbar_background"</code> </pre> <br>  2) to create a basic class BasicActivity, which is inherited from Activity and from which all our activities in the application will be inherited, override the getResources () method in it. <br><br>  3) Also, we will need a class, let's call it ResourseManager, which is inherited from Resourses. <br><br>  Let's take a closer look at what the getResources () method does in the activation.  This is what the official <a href="http://developer.android.com/reference/android/content/Context.html">source</a> tells us.  Those.  it returns an object of the Resources type, so we need in our BasicActivity class in the overridden getResources () method to check which theme is current and whether it is applied at all, if so, then create our own instance of the ResourseManager class.  Here is a sample code for clarity. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BasicActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ResourceManager manager = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Resources </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getResources</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (App.checkCurrentSkin()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (manager == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { manager = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ResourceManager(<span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.getResources()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> manager; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.getResources(); } }</code> </pre><br>  This is all that needs to be done in the basic activation. <br>  Now go to our ResourseManager.  In it, we definitely need a constructor, as well as overridden methods getColor (int id), loadDrawable (TypedValue value, int id), getColorStateList (int id).  With the last two methods we have small problems - they are packaged.  This means that we do not have access to them.  But in such cases, <a href="http://habrahabr.ru/post/69552/">JAVA Reflection</a> comes to our rescue!  How it works, you can familiarize yourself, I will not tell, because  This is not the topic of my article.  Just give you the code for a better understanding. <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ResourceManager</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Resources</span></span></span><span class="hljs-class"> </span></span>{ Skin mSkin = App.getCurrentSkin(); Method loadDrawable; Method loadColorStateList; Resources mBaseResources; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ResourceManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Resources baseResources)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(baseResources.getAssets(), baseResources.getDisplayMetrics(), baseResources.getConfiguration()); mBaseResources = baseResources; Method[] methods = Resources.class.getDeclaredMethods(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Method method : methods) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (method.getName().equals(<span class="hljs-string"><span class="hljs-string">"loadDrawable"</span></span>)) { loadDrawable = method; loadDrawable.setAccessible(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (method.getName().equals(<span class="hljs-string"><span class="hljs-string">"loadColorStateList"</span></span>)) { loadColorStateList = method; loadColorStateList.setAccessible(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } } }</code> </pre><br>  So  we have allowed the use of the methods we need.  Now it remains for the small, in these methods to determine the desired resource by its ID and return another.  In your application, you can somehow keep the Skin object, which describes the fields corresponding to your dynamic views and the meaning of their colors.  Here is a piece of implementation methods <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getColor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> NotFoundException </span></span>{ String color; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (id) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.color.chat_in: color = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_RECEIVE_MESSAGE_BUBLE).getBackgroundColor(); <span class="hljs-comment"><span class="hljs-comment">//    #b7c0c7 return Color.parseColor(color); case R.color.chat_send: color = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_SEND_MESSAGE_BUBLE).getBackgroundColor(); return Color.parseColor(color); ‚Ä¶.</span></span></code> </pre><br>  Next method <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Drawable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadDrawable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TypedValue value, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ Drawable d = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; String color; String colorSel; GradientDrawable result; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (value.resourceId) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.color.color_background_main: color = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_VIEW).getBackgroundColor(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ColorDrawable(Color.parseColor(color)); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.drawable.button_blue_selector: color = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_BUTTON_BLUE).getBackgroundColor(); colorSel = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_BUTTON_BLUE).getHighlightedBackgroundColor(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> createSelector(Color.parseColor(color), getDarkerColor(color), colorSel); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.drawable.chat_in: color = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_RECEIVE_MESSAGE_BUBLE).getBackgroundColor(); result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GradientDrawable(Orientation.TOP_BOTTOM, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{Color.parseColor(color), Color.parseColor(color)}); result.setCornerRadius(<span class="hljs-number"><span class="hljs-number">25</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.drawable.list_view_selector: colorSel = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_TABLE_VIEW_CELL) .getHighlightedBackgroundColor(); ColorDrawable drawable = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ColorDrawable(Color.parseColor(colorSel)); StateListDrawable listDrawable = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StateListDrawable(); listDrawable.addState(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{android.R.attr.state_pressed}, drawable); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> listDrawable; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.drawable.button_last_menu_selector: color = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_TABLE_VIEW_CELL).getBackgroundColor(); colorSel = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_TABLE_VIEW_CELL) .getHighlightedBackgroundColor(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> createSelectorForDifferentCorers(Color.parseColor(color), getDarkerColor(color), colorSel, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { d = (Drawable) loadDrawable.invoke(mBaseResources, value, id); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IllegalArgumentException e) { e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IllegalAccessException e) { e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvocationTargetException e) { e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> d; }</code> </pre><br>  And last <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ColorStateList </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getColorStateList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> NotFoundException </span></span>{ String color; String colorSel; ColorStateList res; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (id) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.drawable.tab_text_selector: color = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_TABBAR_ITEM).getTextColor(); colorSel = mSkin.getControlWithType(SkinConstants.SKIN_CONTROL_TABBAR_ITEM).getHighlightedTextColor(); res = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ColorStateList(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[][]{<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{android.R.attr.state_selected}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{-android.R.attr.state_selected}}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{Color.parseColor(colorSel), Color.parseColor(color)}); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.getColorStateList(id); }</code> </pre><br><br>  From this code it is clear that we programmatically create all the drawabls.  For example <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Drawable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createSelectorForDifferentCorers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> startColor, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> endColor, String colorSel, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> topLeft, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> topRight, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bottomRight, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bottomLeft)</span></span></span><span class="hljs-function"> </span></span>{ StateListDrawable drawable = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StateListDrawable(); GradientDrawable gradientDrawable1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GradientDrawable(Orientation.TOP_BOTTOM, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{startColor, endColor}); GradientDrawable gradientDrawable2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GradientDrawable(Orientation.TOP_BOTTOM, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{ Color.parseColor(colorSel), getDarkerColor(colorSel)}); gradientDrawable1.setShape(GradientDrawable.RECTANGLE); gradientDrawable1.setCornerRadii(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>[]{topLeft, topLeft, topRight, topRight, bottomRight, bottomRight, bottomLeft, bottomLeft}); gradientDrawable1.setStroke(<span class="hljs-number"><span class="hljs-number">1</span></span>, endColor); gradientDrawable2.setShape(GradientDrawable.RECTANGLE); gradientDrawable2.setCornerRadii(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>[]{topLeft, topLeft, topRight, topRight, bottomRight, bottomRight, bottomLeft, bottomLeft}); gradientDrawable2.setStroke(<span class="hljs-number"><span class="hljs-number">1</span></span>, endColor); drawable.addState(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{android.R.attr.state_pressed}, gradientDrawable2); drawable.addState(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{android.R.attr.state_checked}, gradientDrawable2); drawable.addState(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{-android.R.attr.state_selected}, gradientDrawable1); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> drawable; }</code> </pre><br><br>  In general, a huge flight for your imagination. <br>  I also want to immediately discuss one important point.  If you have a complicated picture that you cannot programmatically draw, such as an icon for tobacco, then you can also change its color.  For this, it is necessary that the picture for the icon be pure white, since we will mix it with the color we need by multiplying the meanings of the colors.  Here we get the color of the picture we need <br><pre> <code class="java hljs">Drawable example = ImageManager.blendColorDrawable(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.drawable.arrow, R.color.color_2_end);</code> </pre><br>  and we can do with it, anything.  At least put an icon on the tab. <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Drawable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blendColorDrawable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> baseId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> colorId)</span></span></span><span class="hljs-function"> </span></span>{ Resources res = context.getResources(); BitmapFactory.Options options = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BitmapFactory.Options(); options.inPreferredConfig = Bitmap.Config.ARGB_8888; Bitmap base = BitmapFactory.decodeResource(res, baseId, options); Bitmap blend = Bitmap.createBitmap(base.getWidth(), base.getHeight(), Config.ARGB_8888); blend.eraseColor(context.getResources().getColor(colorId)); Bitmap result = base.copy(Config.ARGB_8888, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); Paint p = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Paint(); p.setXfermode(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PorterDuffXfermode(Mode.MULTIPLY)); p.setShader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BitmapShader(blend, TileMode.CLAMP, TileMode.CLAMP)); Canvas c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Canvas(); c.setBitmap(result); c.drawBitmap(base, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); c.drawRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, base.getWidth(), base.getHeight(), p); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BitmapDrawable(context.getResources(), result);</code> </pre><br><br>  Since  I chose pieces from a large project, where it‚Äôs just one of the features, I don‚Äôt attach an example of the project.  If you do not understand and it will be very necessary, I can give you an example of the source code.  Write in the comments! <br><br>  PS Remember, in order for the changes to take effect, you need to recreate the activation <br><br>  <b>Update:</b> I want to note that this method is for those whose skins (themes) are dynamic objects that you cannot prescribe in xml. </div><p>Source: <a href="https://habr.com/ru/post/165787/">https://habr.com/ru/post/165787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165775/index.html">Windows Azure Summit: large conference, free participation</a></li>
<li><a href="../165777/index.html">Electroluminescent backlight: cold neon</a></li>
<li><a href="../165779/index.html">Gamification - a fresh look at user motivation?</a></li>
<li><a href="../165781/index.html">Legal security of IT business in the CIS</a></li>
<li><a href="../165785/index.html">MeteoBoard Controller</a></li>
<li><a href="../165797/index.html">Psychological test to evaluate the IT product, or how Habrahabr is inferior to Facebook</a></li>
<li><a href="../165799/index.html">Phonerlite - the best free SIP client for Windows</a></li>
<li><a href="../165801/index.html">Spanking ideas - a convenient and secure web-manager of hidden text notes with javascript</a></li>
<li><a href="../165805/index.html">Creating simple HTML5, CSS and jQuery tooltips</a></li>
<li><a href="../165807/index.html">Cloud Storage Service Update</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>