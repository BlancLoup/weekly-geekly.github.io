<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Yii 2.0.14</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Yii team is pleased to present a new version of the PHP framework: Yii 2.0.14. It includes more than a hundred improvements and fixes , including ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Yii 2.0.14</h1><div class="post__text post__text-html js-mediator-article"><p>  The Yii team is pleased to present a new version of the PHP framework: Yii 2.0.14.  It includes more than a <a href="">hundred improvements and fixes</a> , including security fixes. </p><br><p>  The release includes several changes that may affect already running applications.  These changes are described in UPGRADE.md. </p><br><p>  Thanks to <a href="https://github.com/yiisoft/yii2/graphs/contributors">the Yii community</a> for helping out with this update! </p><br><p>  You can follow the development process by putting an asterisk on <a href="https://github.com/yiisoft/yii2">GitHub</a> .  We have <a href="https://github.com/yiisoft/yii2/wiki/communities">many Yii communities</a> where you can ask for help or share your experience - we and thousands of other Yii users will be happy to participate. </p><br><p>  This release is significant because it is becoming the <a href="http://www.yiiframework.com/news/156/yii-2-1-and-yii-2-0-feature-freeze/">latest release in Yii 2.0, containing improvements</a> .  This means that we will concentrate our efforts on developing version 2.1.x, which will include many new improvements that cannot be included in the 2.0.x branch due to limitations in maintaining backward compatibility.  Despite this, the 2.0.x branch will receive fixes and security improvements.  Deadlines for support for 2.0.x will be announced along with the release of version 2.1. </p><br><p> Make sure that the version of the framework in <code>composer.json</code> spelled correctly ( <code>~2.0.14</code> ) and you will not upgrade to 2.1 by accident when it is released. </p><br><p>  Below we look at the most interesting improvements and fixes release.  The full list can, as usual, be found in <a href="">CHANGELOG</a> . </p><a name="habracut"></a><br><h2 id="masshtabiruemost-i-parallelizm">  Scalability and concurrency </h2><br><p>  The problems of scalability and concurrency often fade into the background at the beginning of development, but they ‚Äúpop up‚Äù as the business grows.  In this release, we found and fixed an error that related to writing values ‚Äã‚Äãto the database and updating the session ID.  When using master-slave replication, <code>yii\web\DbSession</code> , <code>yii\validators\UniqueValidator</code> and <code>yii\validators\ExistValidator</code> could access the slave server, while it would be more correct to contact the master server. </p><br><h2 id="uluchsheniya-validatorov">  Validator improvements </h2><br><p>  In addition to the above, there are a few more validator improvements. </p><br><p>  First, <code>ExistValidator</code> can now check for the existence of links if the <code>targetRelation</code> property is <code>targetRelation</code> .  This means that you can now describe the following configuration of validation rules: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ [[<span class="hljs-string"><span class="hljs-string">'customer_id'</span></span>], <span class="hljs-string"><span class="hljs-string">'exists'</span></span>, <span class="hljs-string"><span class="hljs-string">'targetRelation'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'customer'</span></span>], ]; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCustomer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hasOne(Customer::class, [<span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'customer_id'</span></span>]); }</code> </pre> <br><p>  Secondly, <code>FileValidator</code> received a new <code>minFiles</code> property indicating the minimum number of files that the user must upload. </p><br><h2 id="povedeniya">  Behavior </h2><br><p>  <code>yii\behaviors\BlameableBehavior</code> received a new <code>defaultValue</code> property, which is used when a user ID cannot be defined.  This usually happens if the ActiveRecord model is used in a console application. </p><br><p>  In <code>yii\behaviors\AttributeTypecastBehavior</code> a new property <code>typecastAfterSave</code> .  If it is set to <code>true</code> , the attribute values ‚Äã‚Äãwill be cast to the specified types immediately after saving the model.  The types will be the same as when loading the model from the database. </p><br><p>  The behavior of <code>yii\behaviors\CacheableWidgetBehavior</code> been added.  It automatically caches the widget content according to the dependencies settings and the cache validity time.  For example: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">behaviors</span></span>\<span class="hljs-title"><span class="hljs-title">CacheableWidgetBehavior</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">behaviors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; CacheableWidgetBehavior::className(), <span class="hljs-string"><span class="hljs-string">'cacheDuration'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'cacheDependency'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'yii\caching\DbDependency'</span></span>, <span class="hljs-string"><span class="hljs-string">'sql'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'SELECT MAX(updated_at) FROM posts'</span></span>, ], ], ]; }</code> </pre> <br><h2 id="bazy-dannyh-i-activerecord">  Databases and ActiveRecord </h2><br><p>  This release adds many new things related to databases and ActiveRecord.  These improvements were implemented by <a href="https://github.com/SilverFire">Dmitry Naumenko</a> , <a href="https://github.com/sergeymakinen">Sergey Makinen</a> , <a href="https://github.com/rob006">Robert Korulchyk</a> , <a href="https://github.com/Kolyunya">Nikolay Oleynikov</a> and other community members. </p><br><h3 id="obektnyy-format-opisaniya-usloviya-i-polzovatelskie-tipy-dannyh">  Object format for describing the condition and user data types </h3><br><p>  Support for custom data types has been implemented.  Added <a href="">JSON</a> support <a href="">for MySQL and PostgreSQL</a> , as well as <a href="">arrays for PostgreSQL</a> .  To achieve this, the internal implementation of Query Builder has been significantly reworked, which also made it possible to implement support for describing <a href="">conditions in an object format</a> .  Support for the usual format of describing the conditions remained unchanged.  In addition, the formats can be combined: </p><br><pre> <code class="php hljs">$query-&gt;andWhere(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrCondition([ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InCondition(<span class="hljs-string"><span class="hljs-string">'type'</span></span>, <span class="hljs-string"><span class="hljs-string">'in'</span></span>, $types), [<span class="hljs-string"><span class="hljs-string">'like'</span></span>, <span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'%good%'</span></span>], <span class="hljs-string"><span class="hljs-string">'disabled=false'</span></span>, ]));</code> </pre> <br><p>  This improvement has several advantages.  First, it‚Äôs now easier for the Yii development team to maintain conditional code.  This has already added a new condition <a href="https://github.com/yiisoft/yii2/blob/master/framework/db/conditions/BetweenColumnsCondition.php"><code>BetweenColumnsCondition</code></a> , which collects SQL like <code>15 BETWEEN min_age AND max_age</code> .  Release 2.1 is likely to add support for new condition types.  Secondly, now you can <a href="">conveniently create your own classes of conditions</a> and use them in your projects. </p><br><h3 id="gibkost-query-builder">  Query Builder Flexibility </h3><br><p>  The changes described above allowed us to accept <code>yii\db\Query</code> in conditions wherever it was possible to transfer <code>yii\db\Expression</code> before.  For example: </p><br><pre> <code class="php hljs">$subquery = (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Query) -&gt;select([<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Expression(<span class="hljs-number"><span class="hljs-number">1</span></span>)]) -&gt;from(<span class="hljs-string"><span class="hljs-string">'tree'</span></span>) -&gt;where([<span class="hljs-string"><span class="hljs-string">'parent_id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Expression(<span class="hljs-string"><span class="hljs-string">'tree.parent_id'</span></span>])); (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Query()) -&gt;from(<span class="hljs-string"><span class="hljs-string">'tree'</span></span>) -&gt;where([<span class="hljs-string"><span class="hljs-string">'or'</span></span>, <span class="hljs-string"><span class="hljs-string">'parent_id = 1'</span></span>, $subquery])</code> </pre> <br><h3 id="upsert">  Upsert </h3><br><p>  Another significant improvement in the database layer is support for <code>UPSERT</code> , an atomic operation that creates new records if they do not already exist (a unique key is being checked) or changes existing records.  For example, take a look at the following code: </p><br><pre> <code class="php hljs">Yii::$app-&gt;db-&gt;createCommand()-&gt;upsert(<span class="hljs-string"><span class="hljs-string">'pages'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Front page'</span></span>, <span class="hljs-string"><span class="hljs-string">'url'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'http://example.com/'</span></span>, <span class="hljs-comment"><span class="hljs-comment">// URL  'visits' =&gt; 0, ], [ 'visits' =&gt; new \yii\db\Expression('visits + 1'), ], $params)-&gt;execute();</span></span></code> </pre> <br><p>  It either creates a new page, or increases its visitor count automatically. </p><br><h3 id="schema-builder-i-migracii">  Schema builder and migration </h3><br><p>  Schema builder now supports tiny integer and JSON types, so you can use them in writing migrations: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;createTable(<span class="hljs-string"><span class="hljs-string">'post'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;primaryKey(), <span class="hljs-string"><span class="hljs-string">'text'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;text(), <span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;string()-&gt;notNull(), <span class="hljs-string"><span class="hljs-string">'attributes'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;json(), <span class="hljs-string"><span class="hljs-string">'status'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;tinyInteger(), ]);</code> </pre> <br><p>  Another improvement allows you to create and delete views (views): </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;createView( <span class="hljs-string"><span class="hljs-string">'top_10_posts'</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \yii\db\Query()) -&gt;from(<span class="hljs-string"><span class="hljs-string">'post'</span></span>) -&gt;orderBy([<span class="hljs-string"><span class="hljs-string">'rating'</span></span> =&gt; SORT_DESC]) -&gt;limit(<span class="hljs-number"><span class="hljs-number">10</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;dropView(<span class="hljs-string"><span class="hljs-string">'top_10_posts'</span></span>);</code> </pre> <br><h3 id="novyy-api-keshirovaniya-zaprosov">  New Request Caching API </h3><br><p>  Previously, it was possible to cache the result of a query by wrapping it in <a href="http://www.yiiframework.com/doc-2.0/guide-caching-data.html"><code> Connection::cache()</code></a> .  Now you can use a more convenient API: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   query (new Query())-&gt;cache(7200)-&gt;all(); //   AR User::find()-&gt;cache(7200)-&gt;all();</span></span></code> </pre> <br><h3 id="svyazi-v-active-record">  Links in Active Record </h3><br><p>  Active Record now resets the associated models when the attribute on which this relationship is built changes: </p><br><pre> <code class="php hljs">$item = Item::findOne(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $item-&gt;category_id; <span class="hljs-comment"><span class="hljs-comment">// 1 echo $item-&gt;category-&gt;name; // weapons $item-&gt;category_id = 2; echo $item-&gt;category-&gt;name; // toys</span></span></code> </pre> <br><h2 id="obrabotka-oshibok">  Error processing </h2><br><p>  Logging targets now throw an exception when they cannot export the log correctly.  Previously, they silently ignored the error, which could lead to the absence of logs, for example, due to incorrect rights to the directory. </p><br><p>  Also now if HTTP headers have already been sent, when trying to send additional ones, the exception <code>yii\web\HeadersAlreadySentException</code> will be thrown.  Previously, this situation was silently ignored. </p><br><p>  Now it is possible to configure the Yii error handler by changing the <code>$traceLine</code> property.  This can be used, for example, to generate links that can be opened immediately in the development environment.  The setting is similar to setting up links for <a href="https://github.com/yiisoft/yii2-debug">the debug panel</a> : </p><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">'components'</span></span> =&gt; [ <span class="hljs-comment"><span class="hljs-comment">// ... 'errorHandler' =&gt; [ 'errorAction' =&gt; 'site/error', 'traceLine' =&gt; '&lt;a href="ide://open?url={file}&amp;line={line}"&gt;{html}&lt;/a&gt;', ], ],</span></span></code> </pre> <br><p>  Using the <code>yii\web\ErrorAction::$layout</code> property, you can conveniently change the error page template: </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SiteController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... /** * @inheritdoc */ public function actions() { return [ 'error' =&gt; [ 'class' =&gt; 'yii\web\ErrorAction', 'layout' =&gt; 'error', // &lt;-- HERE ], ]; }</span></span></code> </pre> <br><h2 id="bezopasnost">  Security </h2><br><p>  Two vulnerabilities were discovered and fixed: </p><br><ul><li>  <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-6009">CVE-2018-6009</a> .  The <code>switchIdentity()</code> method in <code>web/User.php</code> did not recreate the CSRF token when the user <code>web/User.php</code> . </li><li>  <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-6010">CVE-2018-6010</a> .  In some cases, it was possible to obtain debug information from the exceptions that the error handler handled. </li></ul><br><h2 id="php-72">  PHP 7.2 </h2><br><p>  Yii 2.0.14 fully supports PHP 7.2.  We have <code>yii\filters\HttpCache</code> , <code>FileHelper::getExtensionsByMimeType()</code> and <code>yii\web\Session</code> for normal operation on all supported versions of PHP. </p><br><h2 id="vidzhety-formy-klientskiy-javascript">  Widgets, forms, client javascript </h2><br><p>  The <code>&lt;script&gt;</code> no longer contains the <code>type</code> property.  It looks shorter and makes HTML5 validators happy :) </p><br><p>  In the fields generated by the Active Form and Html helper for model attributes, you can use an automatically generated placeholder: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= Html::activeTextInput($post, <span class="hljs-string"><span class="hljs-string">'title'</span></span>, [<span class="hljs-string"><span class="hljs-string">'placeholder'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><p>  On the way to Bootstrap 4 support, added the ability to specify which element will receive a class mark indicating that there is a validation error: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $form = ActiveForm::begin([ <span class="hljs-string"><span class="hljs-string">'validationStateOn'</span></span> =&gt; ActiveForm::VALIDATION_STATE_ON_INPUT, <span class="hljs-comment"><span class="hljs-comment">//  VALIDATION_STATE_ON_CONTAINER ]) </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br><p>  Now you can safely register JavaScript variables from PHP code: </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SiteController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;view-&gt;registerJsVar(<span class="hljs-string"><span class="hljs-string">'username'</span></span>, <span class="hljs-string"><span class="hljs-string">'SilverFire'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'index'</span></span>); } }</code> </pre> <br><p>  Despite the fact that this method is widely used to transfer data from PHP to JS, we still recommend that you first try to use the HTML5 feature - <a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Howto/Use_data_attributes">data attributes</a> . </p><br><h2 id="sobytiya">  Developments </h2><br><p>  Pavel Klimov added support for event handling masks, so now you can subscribe to a group of event objects that fall under the mask. <br>  This can be very useful for logging and auditing. <a href="http://www.yiiframework.com/doc-2.0/guide-concept-events.html">A new section of the documentation</a> contains a detailed description and many examples of using this feature. </p><br><h2 id="api-serializaciya-i-filtry">  API, serialization and filters </h2><br><p>  When configuring <code>JsonResponseFormatter</code> you can now specify the type of content: </p><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">'components'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'response'</span></span> =&gt; [ <span class="hljs-comment"><span class="hljs-comment">// ... 'formatters' =&gt; [ \yii\web\Response::FORMAT_JSON =&gt; [ 'class' =&gt; \yii\web\JsonResponseFormatter::className(), 'contentType' =&gt; \yii\web\JsonResponseFormatter::CONTENT_TYPE_HAL_JSON, ], ], ], ]</span></span></code> </pre> <br><p>  <a href="http://www.yiiframework.com/doc-2.0/yii-data-datafilter.html">Data filter</a> now supports <code>lt</code> , <code>gt</code> , <code>lte</code> and <code>gte</code> for <code>yii\validators\DateValidator</code> . </p><br><p>  <code>yii\base\ArrayableTrait::toArray()</code> now supports recursion in the <code>$fields</code> and <code>$expand</code> properties.  Requests to <a href="http://www.yiiframework.com/doc-2.0/guide-rest-resources.html"><code>REST APIs  expand</code></a> can be described as <code>extra1.extra2</code> and this will mean that you need to deploy <code>extra1</code> in the initial data set, and then <code>extra2</code> in <code>extra1</code> .  That is, requests like <code>http://localhost/comments?expand=post.author</code> are now possible. </p><br><p>  It is now easier to implement support for your authentication headers using <code>yii\filters\auth\HttpHeaderAuth</code> . </p><br><p>  In the case when you need to serialize validation errors in JSON, you can use the new method <code>\yii\helpers\Json::errorSummary()</code> . </p><br><h2 id="konsol">  Console </h2><br><p>  Console applications also have a convenient way to serialize model validation errors: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$model-&gt;validate()) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Model is not valid:\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> \yii\helpers\Console::errorSummary($model); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ExitCode::DATAERR; }</code> </pre> <br><p>  Improved <a href="http://www.yiiframework.com/doc-2.0/guide-tutorial-console.html">auto completion script for bash and zsh</a> .  Now it supports autocompletion for <code>./yii help</code> . </p><br><p>  By calling console commands, the parameters can be specified in both camelCase and kebab-case: <code>--selfUpdate</code> and <code>--self-update</code> will be considered the same parameter. <br>  Moreover, in addition to <code>--&lt;option&gt;=&lt;value&gt;</code> there is support for syntax <code>--&lt;option&gt; &lt;value&gt;</code> . </p><br><h2 id="marshrutizaciya">  Routing </h2><br><p>  Short syntax support has been added to describe the method in group rules: </p><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">'components'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'urlManager'</span></span> =&gt; [ <span class="hljs-comment"><span class="hljs-comment">// ... 'rules' =&gt; [ new GroupUrlRule([ 'prefix' =&gt; 'file', 'rules' =&gt; [ 'POST document' =&gt; 'document/create', ], ]), ], ],</span></span></code> </pre> <br><h2 id="i18n">  i18n </h2><br><p>  The <code>yii\i18n\Locale</code> component has been added with the <code>getCurrencySymbol()</code> method, which returns the currency symbol in the selected locale. </p><br><h2 id="helpery">  Helpery </h2><br><p>  This release contains some interesting helper improvements. </p><br><p>  Two new methods <code>yii\helpers\FileHelper</code> : </p><br><ul><li>  <code>findDirectories()</code> - returns found directories and subdirectories in the specified path.  This method works similar to <code>findFiles()</code> , but looks for directories. </li><li>  <code>unlink()</code> - deletes a file or simlink cross-platform.  As it turned out, even there are features. </li></ul><br><p>  The <code>yii\helpers\StringHelper</code> <code>matchWildcard()</code> method has been added to <code>yii\helpers\StringHelper</code> , which does the same as the native <code>fnmatch()</code> method, but taking into account the features of the operating system.  It is confirmed that the native implementation gives different results on different operating systems. </p><br><p>  Added <code>yii\helpers\IpHelper</code> .  It provides methods for determining the IP address version, checking the IP address or subnet for entering another subnet, and expanding the IPv6 address to the full format.  For example: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!IpHelper::inRange($ip, <span class="hljs-string"><span class="hljs-string">'192.168.1.0/24'</span></span>)) { <span class="hljs-comment"><span class="hljs-comment">// deny access }</span></span></code> </pre> <br><h2 id="konteyner-di">  DI Container </h2><br><p>  In the container, it became possible to reuse the descriptions in the properties: </p><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">'container'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'definitions'</span></span> =&gt; [ \console\models\TestService::class =&gt; [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; \console\models\TestService::class, <span class="hljs-string"><span class="hljs-string">'model'</span></span> =&gt; Instance::of(\console\models\TestModel::class) ], \console\models\TestModel::class =&gt; [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; \console\models\TestModel::class, <span class="hljs-string"><span class="hljs-string">'property'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">20</span></span>, ], ], ]</code> </pre> <br><p>  In this example, the value of the <code>model</code> property in the <code>TestService</code> class will be an object of the <code>TestModel</code> class, configured as described. </p><br><h2 id="shablony-prilozheniy">  Application Templates </h2><br><p>  In addition to some minor improvements, the basic template received support from Docker and Vagrant. </p><br><h2 id="podgotovka-k-relizu-21">  Preparing for Release 2.1 </h2><br><p>  To simplify the transition from 2.0 to 2.1, Brandon Kelly suggested <code>@deprecated</code> methods and classes that have already been deleted in branch 2.1 with the <code>@deprecated</code> annotation in branch 2.0.x.  This mark received: </p><br><ul><li>  <code>yii\base\BaseObject::className()</code> in favor of the native syntax <code>::class</code> , which does not cause autoloading (supported in PHP&gt; = 5.5); </li><li>  XCache and Zend data cache support modules; </li><li>  Method <code>yii\BaseYii::powered()</code> ; </li><li>  <code>yii\base\InvalidParamException</code> in favor of <code>yii\base\InvalidArgumentException</code> ; </li><li>  <code>yii\BaseYii::trace()</code> in favor of <code>yii\BaseYii::debug()</code> . </li></ul><br><p>  The code that uses these methods will continue to work, but the IDE will highlight it as outdated. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/349408/">https://habr.com/ru/post/349408/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349398/index.html">Safely speeding up the Erlang application using NIF on Rust</a></li>
<li><a href="../349400/index.html">FastTrack Training. "Network Basics". "Basics of switching or switches." Part one. Eddie Martin December 2012</a></li>
<li><a href="../349402/index.html">UWP game: Where to start</a></li>
<li><a href="../349404/index.html">Search under the hood. Cloud indexing</a></li>
<li><a href="../349406/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ302 (February 12 - 18, 2018)</a></li>
<li><a href="../349412/index.html">Experience of transition of the project to phalcon from php 5.6 to 7.1</a></li>
<li><a href="../349414/index.html">The digest of interesting materials for the mobile developer # 241 (February 12 ‚Äî February 18)</a></li>
<li><a href="../349416/index.html">Proportional time management</a></li>
<li><a href="../349418/index.html">Spam Attack to CleanTalk Service</a></li>
<li><a href="../349420/index.html">CleanTalk, WordPress Security Launch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>