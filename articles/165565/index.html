<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Knockoutjs Grow a tree</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Judging by the frequency of appearance of articles, KnockoutJS is gaining popularity in Habr√©. I will make my contribution too. I want to highlight th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Knockoutjs Grow a tree</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/55a/b59/9a8/55ab599a86f9d4532c91928b4971cf4a.png"><br>  Judging by the frequency of appearance of articles, <a href="http://knockoutjs.com/">KnockoutJS</a> is gaining <a href="http://habrahabr.ru/search/%3Fq%3Dknockoutjs">popularity</a> in Habr√©.  I will make my contribution too.  I want to highlight the topic of non-standard HTML controls and the "tree" in particular.  The tree here is understood as an analogue of the TreeView control.  The article assumes that the reader is already familiar with KnockoutJS at a basic level.  The publication can be considered as a study guide for KnockoutJS.  On the other hand, I hope that experienced KnockoutJS users will be able to learn something new. <br><a name="habracut"></a><br>  There are many libraries written to display TreeView.  A for the use of third-party libraries with KnockoutJS traditionally created the appropriate binding (binding) for KnockoutJS.  Unfortunately, often the TreeView libraries are huge, contain an excess of functionality, it is often necessary to adapt your data model to the library.  If you want to use TreeView in conjunction with KnockoutJS, the programmer searches for the ideal library and bindings.  Not always, under the found library, there is a ready-made binding, so you have to create your own binding, and here the most interesting part begins - the study of the inside of the library, which is not always pleasant.  And you just want to work ... Here an alternative approach is proposed - to make a TreeView right on KnockoutJS. <br><br>  To begin with, we will build an abstract tree without data binding.  Binding to the real data you can do yourself when you "grow" your trees.  Either this problem will be solved by my way of reusing the KnockoutJS code, which I will show at the end. <br><br><h1>  ... and not a tree, but a list. </h1><br>  Traditionally, HTML trees are built using a set of nested, unordered lists (UL tag) and CSS styles.  Those.  To build a tree, you need to generate approximately the following HTML markup: <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> 1 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> 3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> 2 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The appearance of the nodes is configured using css classes. <br>  The display model (ViewModel), obviously, can be constructed from two objects - TreeViewNode and TreeView for starters like this: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">caption,children</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.caption = caption; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = children; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = children; }}</code> </pre><br>  Here there is a temptation to do only one TreeViewNode, since the TreeView differs only in the absence of the caption field.  However, this should not be rushed, because later these objects will have much more differences. <br>  Model-bound markup will use a recursive pattern: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'with: tree'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'template: {name:"treeNode", foreach: children}'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'treeNode'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'text/html'</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'text:caption'</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'template: {name:"treeNode", foreach: children}'</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Of course, we need to fill our model with data and initialize the binding: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vm = { <span class="hljs-attr"><span class="hljs-attr">tree</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeView([ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeViewNode(<span class="hljs-string"><span class="hljs-string">'Node 1'</span></span>,[ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeViewNode(<span class="hljs-string"><span class="hljs-string">'Node 3'</span></span>) ]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeViewNode(<span class="hljs-string"><span class="hljs-string">'Node 2'</span></span>) ]) }; ko.applyBindings(vm);</code> </pre><br><br>  Here's what we got: <br><img src="https://habrastorage.org/storage2/1ae/cb1/177/1aecb1177dbcad83f333054b7fd09429.png" alt="image"><br>  <a href="http://jsfiddle.net/xdenser/wjTqf/">JSFiddle</a> for experiments. <br><br>  For now, this is not like a TreeView.  You must assign CSS classes and add the appropriate styles. <br><br><h1>  Reflection of the situation. </h1><br>  Classes should reflect the position and state of the tree node.  The state of the node should be reflected in the model, so we move on to the model. <br>  The node can be expanded or collapsed.  One state from another can be obtained by a simple operation, but for convenience, we define both: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">caption,children</span></span></span><span class="hljs-function">)</span></span>{ ... this.isOpen = ko.observable(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isClosed = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isOpen(); },<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); ... }</code> </pre><br>  I made the properties <code>.isOpen, .isClosed</code> observable, because they depend on each other, and changing them will automatically lead to changes in the DOM.  By changing these properties, we will expand / collapse tree nodes. <br>  I made the <code>.isClosed</code> property read-only, in order not to produce extra code and not to introduce an extra cyclic dependency here, although it can be ‚Äúfixed‚Äù.  Thus, only the <code>.isOpen</code> property can be directly changed. <br><br>  To display correctly, it is also important for us to know whether the node has children (can it be opened) and whether the node is the last in its level so as not to draw a line from it to the next node. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">caption,children</span></span></span><span class="hljs-function">)</span></span>{ ... this.children = children||[]; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isLeaf = !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children.length; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isLast = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; ... }</code> </pre><br>  Since the node may not have children, which means that the <code>children</code> property is either empty (null or undefined), or is an array of zero length, I added unambiguity to this question ‚Äî I initialized the property with an empty array if children were not passed to us. <br><br>  As for the isLast property, there are two options for approaching its implementation.  It can be made by ko.computed with the transfer to the node of the link to its parent, or it can be made so that the parent calculates the isLast properties of its children.  I chose the second approach, because with him so far less code.  The first approach can also be useful, since the link to the node's parent is useful in many scenarios.  However, it will be easy to move from one to another. <br>  So, we add the processing of the isLast property: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setIsLast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>,l=children.length;i&lt;l;i++){ children[i].isLast = (i==(l<span class="hljs-number"><span class="hljs-number">-1</span></span>)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">caption,children</span></span></span><span class="hljs-function">)</span></span>{ ... setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children); ... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children</span></span></span><span class="hljs-function">)</span></span>{ ... setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children); ... }</code> </pre><br><br>  Now we add bindings for the corresponding classes in the node template: <br><pre> <code class="html hljs xml">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'css:{closed:isClosed,open:isOpen, leaf: isLeaf, last: isLast}'</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre><br><br>  It remains to add the ability to collapse and expand nodes: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">caption,children</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; ... this.toggleOpen = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ self.isOpen(!self.isOpen()); }; ... }</code> </pre><br>  And add a binding: <br><pre> <code class="html hljs xml">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'css:{closed:isClosed,open:isOpen, leaf: isLeaf, last: isLast}, click: toggleOpen, clickBubble: false'</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre><br>  <code>clickBubble: false</code> needed so that the event does not pop up to the parents and does not affect them. <br><br><h1>  Op-pa new style. </h1><br>  You can go to CSS.  I did not invent my CSS, but simply simplified styles from another library. <br><br>  I quote them below: <br><div class="spoiler">  <b class="spoiler_title">Styles</b> <div class="spoiler_text"><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">"http://habrastorage.org/storage2/0eb/507/98d/0eb50798dca00f5cc8e153e6da9a87f9.png"</span></span>); <span class="hljs-attribute"><span class="hljs-attribute">background-repeat</span></span>:no-repeat; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>:transparent; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>:-<span class="hljs-number"><span class="hljs-number">90px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-repeat</span></span>:repeat-y; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:block; <span class="hljs-attribute"><span class="hljs-attribute">min-height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">line-height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">white-space</span></span>:nowrap; <span class="hljs-attribute"><span class="hljs-attribute">margin-left</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">min-width</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ul</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:block; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">list-style-type</span></span>:none; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:block; <span class="hljs-attribute"><span class="hljs-attribute">min-height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">line-height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">white-space</span></span>:nowrap; <span class="hljs-attribute"><span class="hljs-attribute">margin-left</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">min-width</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ul</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">margin-left</span></span>:<span class="hljs-number"><span class="hljs-number">0px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.last</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>:transparent; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.open</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>:-<span class="hljs-number"><span class="hljs-number">72px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.closed</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>:-<span class="hljs-number"><span class="hljs-number">54px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.leaf</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>:-<span class="hljs-number"><span class="hljs-number">36px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:inline-block; <span class="hljs-attribute"><span class="hljs-attribute">text-decoration</span></span>:none; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.open</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ul</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:block; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.closed</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ul</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:none; }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Full JavaScript</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setIsLast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>,l=children.length;i&lt;l;i++){ children[i].isLast = (i==(l<span class="hljs-number"><span class="hljs-number">-1</span></span>)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">caption,children</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.caption = caption; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = children||[]; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isOpen = ko.observable(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isClosed = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isOpen(); },<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isLeaf = !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children.length; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isLast = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toggleOpen = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ self.isOpen(!self.isOpen()); }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = children; setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vm = { <span class="hljs-attr"><span class="hljs-attr">tree</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeView([ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeViewNode(<span class="hljs-string"><span class="hljs-string">'Node 1'</span></span>,[ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeViewNode(<span class="hljs-string"><span class="hljs-string">'Node 3'</span></span>) ]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeViewNode(<span class="hljs-string"><span class="hljs-string">'Node 2'</span></span>) ]) }; ko.applyBindings(vm);</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Full HTML</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'tree'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'with: tree'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'template: {name:"treeNode", foreach: children}'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'treeNode'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'text/html'</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'css:{closed:isClosed,open:isOpen, leaf: isLeaf, last: isLast}, click: toggleOpen, clickBubble: false'</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ins</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ins</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'text:caption'</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'template: {name:"treeNode", foreach: children}'</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br>  It turned out like this: <br><img src="http://habrastorage.org/storage2/1b5/81c/a34/1b581ca3456039a2c27bd764a84205d1.png"><br>  <a href="http://jsfiddle.net/xdenser/wjTqf/13/">JSFiddle</a> for experiments. <br><br>  Not very beautiful, but already quite functional.  Now it‚Äôs not difficult to add an icon or a checkbox to each node.  You can make nodes selectable.  But first of all I would like to make the code more universal so that the TreeView can be easily used with an arbitrary hierarchical data structure.  Moreover, it is necessary that changes in the data are automatically reflected in the tree model, and further in the DOM. <br><br><h1>  In FP, this is called a ‚Äúmap‚Äù. </h1><br>  To begin with, we introduce an auxiliary function that will associate an array of node models with the data array. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dataToNodes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dataArray</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>,l=dataArray.length;i&lt;l;i++){ res.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeViewNode(dataArray[i])); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; }</code> </pre><br>  <code>TreeViewNode</code> now takes as input not a label for the node and "children", but some abstract data.  Obviously, the inscription and the "children" he must himself extract from the data.  And first, suppose that the data is not completely abstract, and this is an object in which the signature is stored in the <code>caption</code> property, and ‚Äúchildren‚Äù in the <code>children</code> property, which is an array. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ ... this.data = data; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.caption = data.caption; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(data.children) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = dataToNodes(data.children); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = []; ... }</code> </pre><br><br><h1>  This is not a map that is a map in OP. </h1><br>  However, it is easy for us to abandon the rigid binding to the names of properties.  Let a certain <code>map</code> object be passed to us, in which the corresponding properties are indicated: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ ... this.data = data; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> captionProp = (map &amp;&amp; map.caption)||<span class="hljs-string"><span class="hljs-string">'caption'</span></span>, childrenProp = (map &amp;&amp; map.children)||<span class="hljs-string"><span class="hljs-string">'children'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.caption = data[captionProp]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(data[childrenProp]) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = dataToNodes(data[childrenProp]); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = []; ... }</code> </pre><br><br>  And even better, to be able to determine the compliance of properties dynamically, based on the type of the <code>data</code> object: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ ... this.data = data; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> map = (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> propMap == <span class="hljs-string"><span class="hljs-string">'function'</span></span>) ? propMap(data):propMap, captionProp = (map &amp;&amp; map.caption)||<span class="hljs-string"><span class="hljs-string">'caption'</span></span>, childrenProp = (map &amp;&amp; map.children)||<span class="hljs-string"><span class="hljs-string">'children'</span></span>; ... }</code> </pre><br><br>  You can now hide the <code>TreeViewNode</code> declaration and support functions inside the <code>TreeView</code> model declaration, since the <code>TreeViewNode</code> instances should no longer be created by the user on their own. <br><div class="spoiler">  <b class="spoiler_title">Full JavaScript</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, propMap</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.data = data; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = dataToNodes(data); setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dataToNodes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dataArray</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>,l=dataArray.length;i&lt;l;i++){ res.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeViewNode(dataArray[i])); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setIsLast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>,l=children.length;i&lt;l;i++){ children[i].isLast = (i==(l<span class="hljs-number"><span class="hljs-number">-1</span></span>)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.data = data; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> map = (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> propMap == <span class="hljs-string"><span class="hljs-string">'function'</span></span>) ? propMap(data):propMap; captionProp = (map &amp;&amp; map.caption)||<span class="hljs-string"><span class="hljs-string">'caption'</span></span>, childrenProp = (map &amp;&amp; map.children)||<span class="hljs-string"><span class="hljs-string">'children'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.caption = data[captionProp]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(data[childrenProp]) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = dataToNodes(data[childrenProp]); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = []; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isOpen = ko.observable(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isClosed = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isOpen(); },<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isLeaf = !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children.length; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isLast = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toggleOpen = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ self.isOpen(!self.isOpen()); }; } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vm = { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">'Node 1'</span></span>, <span class="hljs-attr"><span class="hljs-attr">list</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Node 3'</span></span> }] }, { <span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">'Node2'</span></span>, <span class="hljs-attr"><span class="hljs-attr">list</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Node 6'</span></span>, <span class="hljs-attr"><span class="hljs-attr">list</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Node 5'</span></span> }] }] } ] }; vm.tree = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeView(vm.data,{<span class="hljs-attr"><span class="hljs-attr">caption</span></span>:<span class="hljs-string"><span class="hljs-string">'name'</span></span>,<span class="hljs-attr"><span class="hljs-attr">children</span></span>:<span class="hljs-string"><span class="hljs-string">'list'</span></span>}); ko.applyBindings(vm);</code> </pre><br></div></div><br>  <a href="http://jsfiddle.net/xdenser/4ebM7/3/">JSFiddle</a> for experiments. <br><br><h1>  The magic begins here. </h1><br>  Now we need to fulfill the last requirement - automatic reflection of data changes in the ‚Äútree‚Äù model.  We use the ‚Äúmagic‚Äù of KnockoutJS with the help of <code>ko.observable, ko.computed, ko.observableArray</code> .  To do this, we just need to make the <code>children</code> property computable.  And also change the code for other properties that depend on it: <br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ ... if(data[childrenProp]) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dataToNodes(ko.utils.unwrapObservable(data[childrenProp])); }); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; ... this.isLeaf = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children().length); },<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isLast = ko.observable(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children){ setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children.subscribe(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newVal</span></span></span><span class="hljs-function">)</span></span>{ setIsLast(newVal); }); } ...</code> </pre><br>  The <code>ko.utils.unwrapObservable</code> function returns the current value of the observed object, or, if it is not an observed object, the same value that was passed to it on input.  Using <code>ko.utils.unwrapObservable</code> inside <code>ko.computed</code> will automatically create a dependency and <code>.children</code> will be automatically updated if we used the observed value as data.  On the other hand, you can simply use the JS array, then there will be no automatic change tracking. <br>  We do the same for <code>TreeView</code> <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, propMap</span></span></span><span class="hljs-function">)</span></span>{ ... this.children = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dataToNodes(ko.utils.unwrapObservable(data)); }); setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children.subscribe(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newVal</span></span></span><span class="hljs-function">)</span></span>{ setIsLast(newVal); }); ...</code> </pre><br>  Now changes in data will be automatically reflected in the model of the "tree" and then automatically in the DOM. <br>  You can experiment with <a href="http://jsfiddle.net/xdenser/4ebM7/4/">JSFiddle</a> . <br>  There is only one unpleasant problem - adding nodes collapses our tree.  This happens because every time we update, we re-create the <code>TreeViewNode</code> models.  A smarter approach is needed - create models only for new data, and for old ones, use old ones.  This can be implemented in two ways: <br><ol><li>  Save the link to <code>TreeViewNode</code> in the data; </li><li>  When updating the list of nodes, look for the <code>TreeViewNode</code> in the old list. </li></ol><br>  I will show the first way, because it is shorter.  However, it has a limitation - if you want to use the same object for different nodes of the tree, this method will not work.  More precisely, it will lead to unexpected effects.  But if you have only one tree node for each data object, then everything will be fine. <br>  So: <br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ ... data._treeviewNode = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-comment"><span class="hljs-comment">//        ... } function dataToNodes(dataArray,old){ var res = []; for(var i=0,l=dataArray.length;i&lt;l;i++){ res.push(dataArray[i]._treeviewNode || new TreeViewNode(dataArray[i])); //        } return res; }</span></span></code> </pre><br><br><h1>  A choice is always a pleasure. </h1><br>  Our "tree" is practically grown.  For complete happiness, we lack only the ability to select individual nodes of the "tree". <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, propMap</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> treeView = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    TreeView this.selectedNode = ko.observable(); //   ... function TreeViewNode(data){ ... this.isSelected = ko.computed(function(){ //      return (treeView.selectedNode()===this) },this); this.toggleSelection = function(){ //     if(this.isSelected()) treeView.selectedNode(null); else treeView.selectedNode(this); } } }</span></span></code> </pre><br>  You also need to add a template: <br><pre> <code class="html hljs xml">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'caption'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'text:caption, css: {selected:isSelected},click:toggleSelection, clickBubble: false'</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre><br><br>  Now we can build a full-fledged editor of the "tree". <br><div class="spoiler">  <b class="spoiler_title">Full JavaScript</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, propMap</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> treeView = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.data = data; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.selectedNode = ko.observable(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dataToNodes(ko.utils.unwrapObservable(data)); }); setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children.subscribe(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newVal</span></span></span><span class="hljs-function">)</span></span>{ setIsLast(newVal); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dataToNodes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dataArray,old</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>,l=dataArray.length;i&lt;l;i++){ res.push(dataArray[i]._treeviewNode || <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeViewNode(dataArray[i])); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setIsLast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>,l=children.length;i&lt;l;i++){ children[i].isLast(i==(l<span class="hljs-number"><span class="hljs-number">-1</span></span>)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TreeViewNode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.data = data; data._treeviewNode = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> map = (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> propMap == <span class="hljs-string"><span class="hljs-string">'function'</span></span>) ? propMap(data):propMap; captionProp = (map &amp;&amp; map.caption)||<span class="hljs-string"><span class="hljs-string">'caption'</span></span>, childrenProp = (map &amp;&amp; map.children)||<span class="hljs-string"><span class="hljs-string">'children'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.caption = data[captionProp]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(data[childrenProp]) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dataToNodes(ko.utils.unwrapObservable(data[childrenProp])); }); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isOpen = ko.observable(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isClosed = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isOpen(); },<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isLeaf = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children().length); },<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isLast = ko.observable(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children){ setIsLast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.children.subscribe(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newVal</span></span></span><span class="hljs-function">)</span></span>{ setIsLast(newVal); }); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toggleOpen = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ self.isOpen(!self.isOpen()); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isSelected = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (treeView.selectedNode()===<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) },<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toggleSelection = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isSelected()) treeView.selectedNode(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> treeView.selectedNode(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SomeObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">col</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = ko.observable(<span class="hljs-string"><span class="hljs-string">'New SomeObject'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list = ko.observableArray(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.collection = col; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vm = { <span class="hljs-attr"><span class="hljs-attr">data</span></span>:ko.observableArray(), <span class="hljs-attr"><span class="hljs-attr">AddRootNode</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.data.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SomeObject(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.data)); }, <span class="hljs-attr"><span class="hljs-attr">AddChildNode</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tree.selectedNode().data; data.list.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SomeObject(data.list)); }, <span class="hljs-attr"><span class="hljs-attr">RemoveNode</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tree.selectedNode().data; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tree.selectedNode(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); data.collection.remove(data); } }; vm.tree = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeView(vm.data,{<span class="hljs-attr"><span class="hljs-attr">caption</span></span>:<span class="hljs-string"><span class="hljs-string">'name'</span></span>,<span class="hljs-attr"><span class="hljs-attr">children</span></span>:<span class="hljs-string"><span class="hljs-string">'list'</span></span>}); ko.applyBindings(vm);</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Full HTML</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'click:AddRootNode'</span></span></span><span class="hljs-tag">&gt;</span></span>Add New Root Node<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'click:AddChildNode,visible: tree.selectedNode'</span></span></span><span class="hljs-tag">&gt;</span></span>Add Child toSelected Node<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'click:RemoveNode,visible: tree.selectedNode'</span></span></span><span class="hljs-tag">&gt;</span></span>Delete Selected Node<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'tree'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'with: tree'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'template: {name:"treeNode", foreach: children}'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'with: tree.selectedNode'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ko with: data --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'value:name'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- /ko --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'treeNode'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'text/html'</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'css:{closed:isClosed,open:isOpen, leaf: isLeaf, last: isLast}, click: toggleOpen, clickBubble: false'</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ins</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ins</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'caption'</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'text:caption, css: {selected:isSelected},click:toggleSelection, clickBubble: false'</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'template: {name:"treeNode", foreach: children}'</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Full CSS</b> <div class="spoiler_text"><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">"http://habrastorage.org/storage2/0eb/507/98d/0eb50798dca00f5cc8e153e6da9a87f9.png"</span></span>); <span class="hljs-attribute"><span class="hljs-attribute">background-repeat</span></span>:no-repeat; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>:transparent; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>:-<span class="hljs-number"><span class="hljs-number">90px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-repeat</span></span>:repeat-y; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:block; <span class="hljs-attribute"><span class="hljs-attribute">min-height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">line-height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">white-space</span></span>:nowrap; <span class="hljs-attribute"><span class="hljs-attribute">margin-left</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">min-width</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ul</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:block; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">list-style-type</span></span>:none; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:block; <span class="hljs-attribute"><span class="hljs-attribute">min-height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">line-height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">white-space</span></span>:nowrap; <span class="hljs-attribute"><span class="hljs-attribute">margin-left</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">min-width</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ul</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">margin-left</span></span>:<span class="hljs-number"><span class="hljs-number">0px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.last</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>:transparent; } <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.open</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>:-<span class="hljs-number"><span class="hljs-number">72px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.closed</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>:-<span class="hljs-number"><span class="hljs-number">54px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.leaf</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>:-<span class="hljs-number"><span class="hljs-number">36px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ins</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:inline-block; <span class="hljs-attribute"><span class="hljs-attribute">text-decoration</span></span>:none; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>:<span class="hljs-number"><span class="hljs-number">18px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.open</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ul</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:block; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">li</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.closed</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ul</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:none; } <span class="hljs-selector-class"><span class="hljs-selector-class">.selected</span></span> {<span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-number"><span class="hljs-number">#ccc</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">span</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.caption</span></span> {<span class="hljs-attribute"><span class="hljs-attribute">cursor</span></span>: pointer}</code> </pre><br></div></div><br><br>  <a href="http://jsfiddle.net/xdenser/4ebM7/5/">JSFiddle</a> for experiments. <br><br><h1>  Results  Hidden PR.  Distribution of elephants. </h1><br>  So, we got a fully functional implementation of the TreeView adapted for working with Knockout, which takes a little more than 60 lines of code in JavaScript, is understandable, can be easily expanded with new functions, easily adapts to the data model.  Now consider the possible reuse scenarios: <br><ol><li>  Copy &amp; Paste TreeView functions your JS code or putting it into a separate file.  Insert styles in your styles, or import styles as a separate file.  Insert and adaptation of templates.  This script is similar to the code snippet usage scenario. </li><li>  Make your own binding. </li><li>  Use my <a href="https://github.com/xdenser/knockout-component">knockout-component</a> library to convert a set of pattern + model into a binding. </li></ol><br><br>  I used the third method.  Now the insertion of the tree is reduced to this HTML code: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'kc.treeView: {data:data,map:{caption:"name",children:"list"}},kc.assign:tree'</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  How I did it - a topic for a separate article.  And look at the previous example, but using the TreeView as a component you can here <a href="http://jsfiddle.net/xdenser/kuBXG/1/">JSFiddle</a> <br>  The component itself is available on <a href="https://github.com/xdenser/kc-tree-habr">GitHub</a> . </div><p>Source: <a href="https://habr.com/ru/post/165565/">https://habr.com/ru/post/165565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165549/index.html">Take care of your sight, use f.lux</a></li>
<li><a href="../165551/index.html">For a scrap of colored tape</a></li>
<li><a href="../165553/index.html">Magic Panel - jQuery plugin for fast page scrolling</a></li>
<li><a href="../165559/index.html">We play in Haskell</a></li>
<li><a href="../165563/index.html">Simulate the night vision of a person in a 3D game</a></li>
<li><a href="../165567/index.html">OpenVPN 2.3 released</a></li>
<li><a href="../165569/index.html">Yota site was hacked</a></li>
<li><a href="../165571/index.html">Timothy Farris - How to work 4 hours a week</a></li>
<li><a href="../165575/index.html">Downloading GNU / Linux without a third-party bootloader</a></li>
<li><a href="../165577/index.html">TextBox with cookies using User Control, Windows Phone / Store</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>