<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Anatomy of an attack on Skype users</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Massive attacks to install malicious code have a large negative impact on users. In addition, they show the ability of cybercriminals to reuse the alr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Anatomy of an attack on Skype users</h1><div class="post__text post__text-html js-mediator-article">  Massive attacks to install malicious code have a large negative impact on users.  In addition, they show the ability of cybercriminals to reuse the already known methods of compromising users, which will act in subsequent cases of attacks.  We already <a href="http://habrahabr.ru/company/eset/blog/182754/">wrote</a> about a massive spam attack on Skype users in May of this year.  Users all over the world received messages from their contacts through various Skype and Gtalk instant messaging services.  The messages contained malicious links that led the user to install several types of malware, including <b>Win32 / Rodpicom.C</b> .  Within a few hours, a large number of users were infected by this malware.  The attackers repeatedly resorted to such campaigns and used various languages ‚Äã‚Äãwhen writing phishing messages to attack users in different countries, as well as special infection methods to complicate their detection. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ad/bbc/f03/5adbbcf03e2bdbb30093456565d294c3.png"><br><br>  In this post we will take a detailed look at each stage of such an attack in order to understand what methods the attackers used to overcome the system‚Äôs security capabilities.  Of course, various social engineering methods for delivering malicious code provide these attacks with additional opportunities to enhance the effect. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  <b>Nature of attack</b> <br><br>  There are life cycles of such attacks, which attackers use in a special way.  During the period of the cycle, the effectiveness of the attack changes, reaching at a certain point the maximum level of efficiency, i.e., when the maximum number of infections of users is recorded or when links follow malicious links.  In such a period of time, the probability that a user of a certain service will receive a phishing message is, of course, higher. <br><br>  When the number of potential victims of an attack, in a short period of time, begins to exceed a certain threshold, we begin to observe peculiar chain reactions of infection of users, on which this attack was not originally designed.  A similar situation was fixed by us in May, when, in addition to notifications from the ESET Early Warning System, we received requests for technical support from affected users. <br><br>  On May 20, we recorded a big surge in spam messages that were distributed via Skype and invited users to view various photos on social networks.  The messages contained links that were shortened by the Google URL Shortener service and instead of photos pointed to downloadable malicious code.  One of such distributed threats was detected by our products as <b>Win32 / Kryptik.BBKB</b> and through Google statistics about 300 thousand <b>clicks</b> on the links through which this malicious code was downloaded were recorded.  At the same time, 67% of all cases of infection occurred in Latin America. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b0/8e5/2a2/3b08e52a25dfeaffdadd9ab148011b08.png"><br>  Fig.  Malicious link navigation statistics showing a splash on May 20th. <br><br>  After a more detailed analysis of the malicious code, we found that the code we detect is one of the modifications of the <b>Win32 / Gapz threat</b> , the detailed analysis of which we <a href="http://habrahabr.ru/company/eset/blog/169131/">published earlier</a> .  One of the modifications of Gapz is a powerful bootkit with the ability to inject its code into the explorer.exe process to perform destructive functions from there.  Both of these malicious codes are based on the <a href="http://habrahabr.ru/company/eset/blog/174169/">PowerLoader dropper</a> code. <br><br>  One of the dropper features is bypassing various mechanisms used in antivirus software.  In addition, it downloads another version of a malicious program that uses its method of distribution through Skype.  This malware is detected by ESET as a <b>Win32 / Rodpicom.C worm</b> .  Rodpicom is often used in conjunction with other malicious programs, as it contains the possibility of distribution through instant messaging services. <br><br>  Malicious link statistics show that only five goo.gl addresses were used by users to navigate about half a million times throughout the campaign.  Of the total number of conversions (clicks), 27% were from Latin American countries: Mexico (27.023), Brazil (37.757), and Colombia (54.524).  Russia was also one of the most affected countries with more than 40,000 transitions. Germany is the global leader in transitions, with more than 80,000 clicks during the first wave. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/131/f16/d3c/131f16d3c92deb19cd62b93c48df8b3b.png"><br>  Fig.  Statistics on the used platforms for users who clicked malicious links on the first day of the attack on Skype.  85% of users used different versions of Microsoft Windows. <br><br>  Below is an example of a message that was sent to the user for the purpose of compromise. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8a7/8be/c28/8a78bec28e22bc90fcec206d6ad14b4a.png"><br>  Fig.  An example of a spam message sent from a computer infected with Win32 / Rodpicom. <br><br>  Similar messages came to users of different countries on thousands of computers.  Five malicious links that were used by attackers during the first 24 hours redirected users to download files with the following names: <br><br><ul><li>  Fotos91-lol.zip </li><li>  Fotos92-lol.zip </li><li>  Fotos93-lol.zip </li></ul><br>  Shortened links led to the 4shared hosting service, with the exception of one link for which another service was used.  Notice that such phishing methods are not new and it is really strange that attackers managed to achieve such attack efficiency.  These statistics allow us to claim that it was one of the largest malicious campaigns on Skype in all time. <br><br>  In the following days of the attack, that is, after the first wave, the attackers responsible for this attack continued to use various variants of spam messages with the delivery of new variants of malicious programs.  At the same time, these days the number of clicks on the links was not as high as at the beginning. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2c0/642/442/2c064244265463abab8eb85b0dfbe490.png"><br>  Fig.  The number of URLs (links) that were used by attackers on the days of the attacks. <br><br>  For two weeks, we observed a total of forty-one links that sent the user to download malware.  Various link shortening services were used to form such links: <br><br><ul><li>  goo.gl </li><li>  bit.ly </li><li>  ow.ly </li><li>  urlq.d </li><li>  is.gd </li><li>  fur.ly </li></ul><br>  Not all of these link reduction services can provide information on the number of clicks and information about the OS or source (referrers).  For those services that provide such information, we counted more than 700 thousand clicks on the links.  Below is a more detailed statistics on the number of transitions, which allows you to more detailed assess the development of the spam campaign. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/05b/295/869/05b29586907c9d35f4d561df9c1bb82a.png"><br>  Fig.  Malicious link navigation statistics. <br><br>  You can see a drop in the number of transitions at the end of the wave of propagation of malicious code.  Obviously, this is due to the lack of the effect of surprise, user awareness of malicious activity and warnings from anti-virus companies about such an attack.  The figure below shows the regions of attack activity for different links.  It can be seen that Russia is one of the most affected regions with high activity for all three links. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e32/7c5/a68/e327c5a685437bc61435a51d9b098640.png"><br>  Fig.  Countries with the most "active" links to malicious links. <br><br>  In many cases, users continue to use their operating system unaware that they have been compromised.  For some of these users, we observed more than 30 malware update files in the system directories. <br><br>  <b>Analysis</b> <br><br>  After two weeks of activity of the malicious campaign and its tracking, we had at our disposal a sufficient number of artifacts to analyze the attack itself, as well as the various families of malicious code and their modifications that were used for it.  In total, more than 130 different malicious files were recorded that were used for this attack.  At the same time, the two main families of threats to which these files belong are <a href="http://virusradar.com/en/Win32_PowerLoader/detail">Win32 / PowerLoader modifications</a> , which are responsible for the direct infection of the system and Win32 / Rodpicom, which is a worm and can spread itself through instant messaging services. <br><br>  As we have indicated, Win32 / PowerLoader is associated with another threat - Win32 / Gapz.  The droppers of the latter are based on PowerLoader codes, which is a bot builder for creating malware, known as downloaders.  This malware creation tool is an example of a modular approach and the subsequent distribution of malicious code.  The builder itself has been seen in use by intruders since the beginning of this year and has also been used in modifications of another threat - Win32 / Dorkbot.  The tool allows attackers to specify up to three URLs with which the bot will interact on the infected computer.  Another malicious program will be downloaded from these URLs, i.e. Win32 / Rodpicom, in case of this Skype attack. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d94/e82/df2/d94e82df254dbd4bd76326fde719b0ab.png"><br>  Fig.  Win32 / PowerLoader bot configuration file. <br><br>  It can be seen that this file contains the same URL (C &amp; C) for receiving instructions from the attackers, as well as other configuration data.  After successfully infecting the computer, the bot will interact with C &amp; C every 15 minutes to download other malicious code that will allow attackers to perform various tasks on the user's computer. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c29/023/73d/c2902373dbd9252fc80e49a5ecba2fb5.png"><br>  Fig.  Report sent by the bot to the server. <br><br>  Malicious files downloaded by the bot are stored in the ‚ÄúC: \ ProgramData‚Äù directory, and during the bot activity period we detected more than 50 such files. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/41e/738/4b4/41e7384b472cb7fae06284e9ca24689d.png"><br>  Fig.  Malicious files downloaded by the Win32 / PowerLoader bot. <br><br>  Among the malicious programs that participate in the second stage of system compromise, the following families were detected: <br><br><ul><li>  <a href="http://virusradar.com/en/Win32_injector/description">Win32 / Injector</a> : is a family of malicious programs that implements the introduction of its code into other processes and has the ability to steal usernames and passwords from online services. </li><li>  <a href="http://virusradar.com/en/Win32_Agent.ODG/description">Win32 / Agent</a> : a family of malicious software with the ability to steal user information. </li><li>  <a href="http://www.virusradar.com/en/Win32_Rodpicom/detail">Win32 / Rodpicom</a> : is a worm that is used in conjunction with other malware and contains the ability to spread malicious links through instant messaging services. </li></ul><br>  Rodpicom lists all the processes in the system trying to find a Skype process, and then injects its code into it to send messages to the list of contacts.  The malware itself does not act on its own; rather, it is used by other threats as a propagation vector.  At the same time, the system settings are used to select the language in which the messages will be distributed, i.e. the current user language.  Below are Win32 / Rodpicom.C sample hashes and the number of attempts to distribute them for this spam campaign. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bc8/c8f/984/bc8c8f9844ba1d4175b91df55d3b4327.png"><br><br>  Malicious code not only uses Skype to send malicious links.  Below is a list of other instant messaging services that malicious code is trying to search for in the user's system: <br><br><ul><li>  Windows messenger </li><li>  Quite Internet Pager </li><li>  Googletalk </li><li>  Digsby </li></ul><br>  <b>Conclusion</b> <br><br>  It is obvious that such a massive spam attack was well planned in advance and the attackers wanted to achieve high rates of user compromise.  We recorded that one of its stages began at 9 am European time, which corresponds to the beginning of the working day, when the traffic in social networks is quite high. <br><br>  The practice of using attackers of four different modifications of malicious programs in conjunction with phishing messages has proven to be very effective.  Each component of the malware performed its specified function.  Power Loader was responsible for the initial compromise of the system with protection bypass, working with the C &amp; C manager and loading the Rodpicom malware for the next step.  In turn, Rodpicom was responsible for the subsequent distribution of malicious code through instant messaging services.  Two other malicious programs that Power Loader downloaded onto a user's computer are means to collect various user data, including usernames and passwords from various accounts. </div><p>Source: <a href="https://habr.com/ru/post/203088/">https://habr.com/ru/post/203088/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../203070/index.html">IPhone application localization: how to get 767% more downloads using keyword translation</a></li>
<li><a href="../203072/index.html">Google showed a tricky WebGL world for mobile Chrome</a></li>
<li><a href="../203076/index.html">Generating HTML reports for dynamic table-structures</a></li>
<li><a href="../203082/index.html">We continue to study Love2d</a></li>
<li><a href="../203086/index.html">Pencil and paper vs design tools</a></li>
<li><a href="../203094/index.html">Eternal cake: an interview with Denis Kryuchkov, the founder of Habrahabr</a></li>
<li><a href="../203096/index.html">Mail.Ru Games changed the model of ArcheAge at the request of the players</a></li>
<li><a href="../203098/index.html">KUB-Pico Ethernet Controllers from Tehnotroniks</a></li>
<li><a href="../203100/index.html">Selling design online store. Part 1. Analytics</a></li>
<li><a href="../203106/index.html">Clear, bold and affordable. Highscreen Alpha R Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>