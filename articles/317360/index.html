<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>$ mol_atom: theory and practice of reactivity</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, my name is Dmitry Karlovsky and I ... a wealthy person. I have a state on the server, there are states in local storages, there is a browser wi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>$ mol_atom: theory and practice of reactivity</h1><div class="post__text post__text-html js-mediator-article"><p>  Hello, my name is Dmitry Karlovsky and I ... a wealthy person.  I have a state on the server, there are states in local storages, there is a browser window state, there is a domain model state, there is an interface state.  And all this variety of states must be kept synchronized.  If one state changes somehow, the other states associated with it should be updated as soon as possible.  A special piquancy of the situation is given by the fact that synchronization with the server can take seconds, and the user interface can only be blocked for a split second. </p><br><p><img src="https://habrastorage.org/files/58d/bcb/fb0/58dbcbfb06774308b87267267b1ea9ca.jpg" alt="Wealthy person"></p><br><p>  Then you will learn how reactivity conquers asynchrony, how imperative reactivity gets along with functional, how simple abstractions allow you to write reliable and fast code, and how I once switched to the idempotent side of force and wrap everything </p><a name="habracut"></a><br><h1 id="razbiraemsya-v-sortah-reaktivnosti">  Understanding Reactivity Varieties </h1><br><p>  First of all, it is necessary to determine the concept of "reactivity" (reactivity).  This is a phenomenon when a change in one state leads to a cascade change in other states.  Reactive programming uses this principle to describe the rules for changing one state when another changes.  In the following, the unit of the reactive state for simplicity will be called the "atom". </p><br><p>  If you have never programmed in the reactive paradigm, then I can recommend to read <a href="https://habrahabr.ru/post/235121/">my article two years ago</a> , which explains why it is needed at all.  Nevertheless, it is slightly out of date, since $ mol_atom implements more advanced logic. </p><br><pre><code class="hljs erlang-repl">[ State1 ]----/ Rule1-<span class="hljs-number"><span class="hljs-number">2</span></span> /----&gt;[ State2 ]----/ Rule2-<span class="hljs-number"><span class="hljs-number">3</span></span> /----&gt;[ State3 ]</code> </pre> <br><p>  Reactive rules can be described in three paradigms: </p><br><p>  <strong>Restarts</strong> .  The rules are stored separately from the state and are a procedure that changes some states based on other states.  When any state involved by this procedure changes, the procedure automatically restarts.  The problem of this approach is in the stationarity of synchronization rules, large overheads and the risk of going into an infinite loop. </p><br><pre> <code class="hljs css"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[ State ]</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span>&gt;<span class="hljs-selector-attr"><span class="hljs-selector-attr">[ Rule1-2( State ) ]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[ State ]</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span>&gt;<span class="hljs-selector-attr"><span class="hljs-selector-attr">[ Rule2-3( State ) ]</span></span></code> </pre> <br><p>  Examples of implementations: <a href="https://docs.angularjs.org/api/ng/type/%24rootScope.Scope">AngularJS @ 1</a> , <a href="https://docs.meteor.com/api/tracker.html">MeteorJS</a> . </p><br><p>  <strong>Pushing</strong> .  Inside the atom are stored the rules for the formation of states of other atoms.  Usually the rules are set during application initialization and do not change in the future, and if they change, then manually.  The APIs of the libraries implementing this approach are greatly inflated ‚Äî tens and hundreds of methods solve its many problems: immediate execution of the rules, dependence on a single atom, response even if the new value is equal to the old one and others. </p><br><pre> <code class="hljs javascript">[ <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">State1</span></span></span><span class="hljs-function"> =&gt;</span></span> Rule2( State1 ) ]--------&gt;[ <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">State2</span></span></span><span class="hljs-function"> =&gt;</span></span> Rule3( State2 ) ]--------&gt;[ State3 ]</code> </pre> <br><p>  Examples of implementations: <a href="https://baconjs.github.io/">BaconJS</a> , <a href="https://rpominov.github.io/kefir/">KefirJS</a> , <a href="https://github.com/Reactive-Extensions/RxJS">RxJS</a> . </p><br><p>  <strong>Pulling</strong> .  Inside the atom is stored the rule of formation of its state as a function of the states of other atoms.  The state is formed lazily, at the moment of addressing it.  If someone ceases to depend on the state of the atom, then he can ‚Äúfall asleep‚Äù losing dependence on other atoms.  In the "laziness", dynamic automatic activation and deactivation of the rules the main advantage of this approach, therefore, the further narration will go about it. </p><br><pre> <code class="hljs css"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[ State1 ]</span></span><span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span>&gt;<span class="hljs-selector-attr"><span class="hljs-selector-attr">[ State2 = Rule2( State1 ) ]</span></span><span class="hljs-selector-tag"><span class="hljs-selector-tag">--------</span></span>&gt;<span class="hljs-selector-attr"><span class="hljs-selector-attr">[ State3 = Rule3( State2 ) ]</span></span></code> </pre> <br><p>  Examples of implementations: <a href="http://knockoutjs.com/">KnockOutJS</a> , <a href="https://github.com/mobxjs/mobx">MobXJS</a> , <a href="https://github.com/Riim/cellx">CellX</a> and <a href="https://github.com/eigenmethod/mol/tree/master/atom">$ mol_atom itself</a> . </p><br><p>  It should be noted that the above division of principles is conditional and reflects the basic principle of the work of the respective libraries. </p><br><h1 id="net-vremeni-obyasnyat">  There is no time to explain </h1><br><p><img src="https://habrastorage.org/files/154/b9c/dda/154b9cdda1fd41a58abaa70de9ecc8f8.jpg" alt="And so wanted"></p><br><p>  Create a pair of mutable atoms with a calculated default value: </p><br><pre> <code class="hljs ruby">const userName = new $mol_atom( <span class="hljs-string"><span class="hljs-string">'userName'</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> <span class="hljs-params"><span class="hljs-params">||</span></span> <span class="hljs-string"><span class="hljs-string">'Anonymous'</span></span> ) const showName = new $mol_atom( <span class="hljs-string"><span class="hljs-string">'showName '</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> <span class="hljs-params"><span class="hljs-params">||</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> )</code> </pre> <br><p>  Create a computed atom that does not allow a direct change in its value: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> greeting = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> $mol_atom( <span class="hljs-string"><span class="hljs-string">'greeting'</span></span> , next =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( !showName.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>() ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Hello!'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> `Hello, ${ userName.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>() }!` } )</code> </pre> <br><p>  Create a presentation atom that displays a greeting to the console whenever something in the data changes: </p><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> presenting = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> $mol_atom( <span class="hljs-string"><span class="hljs-string">'presenting'</span></span> , next =&gt; { console.log( greeting.value() ) } )</code> </pre> <br><p>  Forcibly activate the presentation atom: </p><br><pre> <code class="hljs cs">presenting.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>() <span class="hljs-comment"><span class="hljs-comment">//Hello!</span></span></code> </pre> <br><p>  We change 2 atoms at once, but there will be only one output: </p><br><pre> <code class="hljs cs">showName.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>( <span class="hljs-literal"><span class="hljs-literal">true</span></span> ) userName.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>( <span class="hljs-string"><span class="hljs-string">'John'</span></span> ) <span class="hljs-comment"><span class="hljs-comment">//Hello, John!</span></span></code> </pre> <br><p>  Forcibly present after each change of data: </p><br><pre> <code class="hljs pgsql">userName.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>( <span class="hljs-string"><span class="hljs-string">'Jin'</span></span> ) presenting.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>() // Hello, Jin! showName.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> ) presenting.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>() // Hello!</code> </pre> <br><p>  We are trying to change the greeting directly - nothing comes out: </p><br><pre> <code class="hljs cs">greeting.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>( <span class="hljs-string"><span class="hljs-string">'Hi!'</span></span> )</code> </pre> <br><p>  Forcibly set a greeting to bypass the rules: </p><br><pre> <code class="hljs cs">greeting.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>( <span class="hljs-string"><span class="hljs-string">'Hi!'</span></span> , $mol_atom_force ) <span class="hljs-comment"><span class="hljs-comment">//Hi!</span></span></code> </pre> <br><p>  Change the original data - zero reaction: </p><br><pre> <code class="hljs cs">showName.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>( <span class="hljs-literal"><span class="hljs-literal">false</span></span> )</code> </pre> <br><p>  Force update the value of greeting according to the rules: </p><br><pre> <code class="hljs cs">greeting.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> , $mol_atom_force ) <span class="hljs-comment"><span class="hljs-comment">//Hello!</span></span></code> </pre> <br><p>  We enable logging of all atoms and change one of them: </p><br><pre> <code class="hljs bash"><span class="hljs-variable"><span class="hljs-variable">$mol_log</span></span>.filter( <span class="hljs-string"><span class="hljs-string">''</span></span> ) showName.value( <span class="hljs-literal"><span class="hljs-literal">true</span></span> ) //21:44:11 showName.value() [<span class="hljs-string"><span class="hljs-string">"push"</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>] //21:44:11 greeting.value() [<span class="hljs-string"><span class="hljs-string">"obsolete"</span></span>] //21:44:11 <span class="hljs-variable"><span class="hljs-variable">$mol_atom</span></span>.sync [] //21:44:11 userName.value() [<span class="hljs-string"><span class="hljs-string">"push"</span></span>, <span class="hljs-string"><span class="hljs-string">"Anonymous"</span></span>, undefined] //21:44:11 greeting.value() [<span class="hljs-string"><span class="hljs-string">"push"</span></span>, <span class="hljs-string"><span class="hljs-string">"Hello, Anonymous!"</span></span>, <span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>] //21:44:11 presenting.value() [<span class="hljs-string"><span class="hljs-string">"obsolete"</span></span>] //Hello, Anonymous!</code> </pre> <br><p>  Turn off logging: </p><br><pre> <code class="hljs vbscript">$mol_log.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span>( <span class="hljs-literal"><span class="hljs-literal">null</span></span> )</code> </pre> <br><p>  <a href="http://jsbin.com/cezaruzuti/1/edit%3Fjs,console">Try online.</a>  <a href="http://jsbin.com/xuwuyilavu/1/edit%3Fjs,output">Another example.</a> </p><br><h1 id="a-vnutre-u-ney-chto">  What about her? </h1><br><p>  It would seem that it could be simpler: when changing one state, to cause recalculation of dependent states.  But.. </p><br><p><img src="https://habrastorage.org/files/69e/df8/bbc/69edf8bbc1ac4c7999e70322deecf0c6.jpg" alt="It is not that simple"></p><br><p>  First of all, you need to decide what depends on. </p><br><p>  Suppose you are doing a blog and on the page of some post you need to display the title of the post in the window title, and on the page of posts filtered by tag - the name of the tag.  It turns out that the state of the window title dynamically changes its dependencies.  It depends on the name of the post, then on the name of the tag, but in both cases it depends on some condition that determines what it needs to depend on. </p><br><p>  Already in this simple example, one can see how important the support of dynamic dependencies is.  Therefore, we do not accept such an abstraction as "stream", around which the popular "push" libraries are built. </p><br><p>  A typical "pull" implementation works as follows: </p><br><ol><li><p>  When an atom calculates its state, it first puts itself in a global variable, which allows other atoms to understand which atom is being calculated. </p><br></li><li><p>  Next, he creates an empty list of his dependencies, in which all atoms will be registered, to which one way or another will be addressed. </p><br></li><li><p>  Only now is the execution of the formula - a normal function that returns some result. </p><br></li><li><p>  In the process of executing a formula, there may be a call to any other functions, objects, and browser interfaces. </p><br></li><li><p>  If in the process of executing a formula, the value of another atom is addressed, then the one, taking the dependent atom from the global variable, links them in such a way that both will know that the value of one depends on the value of the other. </p><br></li><li><p>  After the formula is calculated, the resulting value is stored in the atom, so that later it can be returned immediately, without a relatively long calculation of the formula. </p><br></li><li><p>  Finally, a new list of dependencies is compared with the old one, in order to ‚Äúseparate‚Äù the atoms that are no longer dependent on each other. </p><br></li><li>  If the value of an atom changes, then there is a notification of atoms hiding from it, that their values ‚Äã‚Äãare outdated and they also need updating. </li></ol><br><p>  Thus, we always have an actual network of atoms, which is dynamically rebuilt, reflecting real dependencies at a given time. </p><br><p>  It is worth noting that the formulas (and, as a result, all the functions called in one way or another) are required to be idempotent.  That is, if no dependency has changed, then the result of the function should remain unchanged.  The result here is understood not only the value returned by the formula, but also the side effects produced in the calculation process. </p><br><p>  Thanks to ideponentnosti, it is possible to cache the result for an indefinite period and reset the cache only when it is either no longer needed or not relevant anymore. </p><br><p>  But what if there is an exception when calculating the value?  If it is not intercepted, then the current "calculated atom" placed in the global variable will remain so there that in the future work of the application may lead to the appearance of very strange dependencies, which is not quite easy to debug.  In addition, every time an atom is accessed, a formula will be calculated and an exception will pop up, which not only clogs the console on large amounts of data, but also causes non-weak brakes.  And the cherry on the cake of problems will be that some of the atoms will remain in irrelevant condition. </p><br><p>  In simple terms, the state of the application will no longer be consistent and will start to work unstably.  To prevent this, each atom must intercept the exception and save it in itself instead of the value and allow it to surface further.  Thus, the next time the atom is accessed, this exception will be thrown again.  If the exception was the result of incorrect data, then as soon as the data becomes correct, the atom will recalculate its value and, instead of throwing an exception, will return the current value. </p><br><p>  But at what point should the dependent atoms recalculate their values?  If you do this right away when you receive a notice of obsolescence, an atom can fulfill a formula many times in vain, when several of its dependencies sequentially change.  Therefore, in good implementations, the atom is immediately only marked out-of-date, but now it is already deferred. </p><br><p>  Generally speaking, the problem of extra calculations is not as harmless as it may seem.  It can lead to the following unpleasant consequences: </p><br><ol><li>  Decrease in productivity up to impossibility to use the application. </li><li>  The occurrence of exceptions in unexpected places.  A typical situation is a call to an object that has already been deleted. </li><li>  Unnecessary requests to the server, notifications and the like are not "collapsing" repetition. </li></ol><br><p>  There are several strategies for deferred actualization of atoms: </p><br><ol><li><p>  <strong>In order of obsolescence.</strong>  At the time of obsolescence, the atom is added to the end of the queue for recalculation.  The simplest strategy.  However, it leaves a fairly large number of unnecessary recalculations. </p><br></li><li><p>  <strong>In order of creation.</strong>  Each atom is given a numeric identifier.  Later created atoms have a larger identifier value.  Atoms are counted starting at the atom with the lowest identifier.  It turns out that dependent atoms are recalculated earlier than those on which they depend, since they are often created in the process of calculating dependent ones.  All this again leads to unnecessary calculations. </p><br></li><li><p>  <strong>In order of increasing depth.</strong>  Atoms are sorted by maximum depth of dependencies.  At first, atoms without dependencies are recalculated, then dependent on atoms without dependencies, then on atoms that depend on atoms without dependencies, and so on.  With this scheme, there is almost no extra recalculation.  However, sometimes there are incidents when the atom has a shallow depth, but its existence is determined by an atom with greater depth.  Thus, he recounts his value first, and later removes it, since it is no longer necessary. </p><br></li><li>  <strong>In the right order.</strong>  Dependencies are updated in the same order in which they were addressed when calculating the dependent atom. </li></ol><br><p><img src="https://habrastorage.org/files/72a/6b0/cd4/72a6b0cd4f8945408e49da116b052df4.jpg" alt="Come on, tell me how to"></p><br><p>  To ensure the correct order of actualization, each atom can be in one of 4 states: </p><br><ol><li><p>  <strong>Obsolete</strong> .  At the next call, its value will be calculated by the formula.  When an atom enters this state, it notifies the dependent atoms that they are "possibly outdated." </p><br></li><li><p>  <strong>Perhaps outdated</strong> (checking).  On the next appeal, he will first make sure that all his dependencies are up to date.  As soon as one of them changes its value, the atom will become "obsolete" with all the consequences.  Otherwise, it will become "relevant" without recalculating the value.  When an atom enters the state of "possibly outdated", it immediately notifies the dependent atoms that they are also "possibly outdated."  Thus, this state is cascaded to the entire dependent subtree.  If nobody depends on this atom, then it adds itself to the queue for deferred update. </p><br></li><li><p>  <strong>Actual</strong> .  When referencing, returns the memorized value.  If during the transition to the current state, its value has changed, then it notifies the dependent atoms that they are "obsolete". </p><br></li><li>  <strong>Calculated</strong> (pulling).  When an atom begins to be recalculated, it enters this state.  Appealing to an atom in this state leads to an exception, since it indicates a cyclical dependence.  After the calculation, even if it ended in an error, the atom remembers the result, moving into the "actual" state. </li></ol><br><p>  This logic may seem overly complex and redundant, but it does guarantee that: </p><br><ol><li>  The application does not hang due to cyclic dependencies. </li><li>  The recalculation of an atom will occur no sooner than its dependencies take on their current meaning. </li><li>  The recalculation of an atom will not be performed if the actual values ‚Äã‚Äãof its dependencies have not changed. </li><li>  When accessing an atom, we are guaranteed to get the current value (other schemes do not guarantee this, since they do not exclude the possible need for its re-calculation). </li></ol><br><h1 id="nuzhno-bolshe-memovhttpsyoutubet9kqlu_o5lut1m2s">  <a href="https://youtu.be/t9kQLU_o5lU%3Ft%3D1m2s">Need more memes</a> </h1><br><p>  Here and further examples are in TypeScript, which is ES6 with the addition of typing after the colon. </p><br><p>  Working with atoms directly is not very convenient.  They need to be given unique names so that something meaningful is displayed in the logs, and not just abstract numbers.  It is necessary to store them somewhere and not to create once again.  To get rid of this routine, we introduce the concept of "property" as a polymorphic method, which, depending on the number of parameters, "returns" or "sets and immediately returns" some value. </p><br><p>  A common property has the following interface: </p><br><pre> <code class="hljs pgsql">{ &lt; <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> &gt;() : <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> &lt; Vlaue &gt;( nextValue : <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> ) : <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> }</code> </pre> <br><p>  For example: </p><br><pre> <code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ title( next? : string ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( next !== <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.title = next <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.title } }</code> </pre> <br><p>  It can be made reactive (cached with automatic cache invalidation) by simply adding the <code>$mol_mem()</code> decorator: </p><br><pre> <code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ @ $mol_mem() title( next? : string ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( next !== <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.title = next <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.title } }</code> </pre> <br><p>  Let's make the code of the greeting application as a class (for convenience, we use $ mol_object to help generate the correct names, but you can not use it by defining the toString method of the object manually): </p><br><pre> <code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">$mol_object</span></span></span><span class="hljs-class"> </span></span>{ @ $mol_mem() userName( next? : string ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> next || <span class="hljs-symbol"><span class="hljs-symbol">'Anonymou</span></span>s' } @ $mol_mem() showName( next? : boolean ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> next || <span class="hljs-literal"><span class="hljs-literal">false</span></span> } greeting() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showName() ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'Hello</span></span>!' <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> `<span class="hljs-type"><span class="hljs-type">Hello</span></span>, ${ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.userName() }!` } @ $mol_mem() presenting() { console.log( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.greeting() ) } }</code> </pre> <br><p>  As you can see, the <code>greeting</code> property is not reactive, so this method will be called every time you access it.  But <code>showName</code> is reactive, so the method will be called only at the first reading of the default value and when the new value is passed to it. </p><br><p>  We could declare properties in the spirit of MobX, but for this, we would have to write more cumbersome code with duplication of the name of the property: </p><br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@observable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> userName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Anonymous'</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> userName( next : string ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> next } <span class="hljs-meta"><span class="hljs-meta">@observable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> showName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> showName( next : boolean ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> next } <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> greeting() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showName ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Hello!'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> `Hello, ${ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.userName }!` } <span class="hljs-meta"><span class="hljs-meta">@computed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> presenting { console.log( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.greeting ) } }</code> </pre> <br><p>  In addition, it would not be as easy and simple to overload the property as a whole from the outside, as in the following example: </p><br><pre> <code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">My</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mol_object</span></span></span><span class="hljs-class"> </span></span>{ @ $mol_mem() <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> instance() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> } name(){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`Jin #</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${ </span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">Date</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.now() }</span></span></span><span class="hljs-string">`</span></span> } @ $mol_mem() showName( next ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> next === </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span></span><span class="hljs-function">) ? </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">true</span></span></span><span class="hljs-function"> : </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">next</span></span></span><span class="hljs-function"> } @ </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$mol_mem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">app</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">app</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">new</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">App</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">app</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">userName</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">=&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name() app.showName = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> next </span></span></span><span class="hljs-function">)=&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showName( next ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> app } } My.instance().app().presenting() <span class="hljs-comment"><span class="hljs-comment">//Hello, Jin #1481383086982!</span></span></code> </pre> <br><p>  <a href="http://jsbin.com/fifugofohu/1/edit%3Fjs,console">Try online.</a>  <a href="http://jsbin.com/givowayepe/1/edit%3Fjs,console">Another example.</a> </p><br><p>  Here we used property overloading to elegantly create one-sided binding for the <code>userName</code> property and two-sided for the <code>showName</code> property.  This is a very powerful technique that allows you to fine-tune the behavior of any object, immediately after its creation, without the risk of breaking it. </p><br><p>  It is worth paying attention to exceptionally clear logs, which clearly show which states have changed as: </p><br><pre> <code class="hljs bash"><span class="hljs-variable"><span class="hljs-variable">$mol_log</span></span>.filter( <span class="hljs-string"><span class="hljs-string">''</span></span> ) My.instance().app().showName( <span class="hljs-literal"><span class="hljs-literal">false</span></span> ) <span class="hljs-variable"><span class="hljs-variable">$mol_log</span></span>.filter( null ) //11:27:58 My.instance().showName() [<span class="hljs-string"><span class="hljs-string">"push"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>] //11:27:58 My.instance().app().presenting() [<span class="hljs-string"><span class="hljs-string">"obsolete"</span></span>] //Hello!</code> </pre> <br><p><img src="https://habrastorage.org/files/158/92a/526/15892a52636f431c9094d4ad894b7bfd.png" alt="We need something more complicated"></p><br><p>  It is often necessary to work not with one value, but with a whole family of values ‚Äã‚Äãdistinguished by a certain key, but according to the same logic.  For these cases, the following interface is used: </p><br><pre> <code class="hljs pgsql">{ &lt; Key , <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> &gt;( key : Kay ) : <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> &lt; Key , Vlaue &gt;( key : Key , nextValue : <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> ) : <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> }</code> </pre> <br><p>  For example, let's create the simplest class that allows using REST resources: </p><br><pre> <code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Rest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mol_object</span></span></span><span class="hljs-class"> </span></span>{ @ $mol_mem_key() <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> resource( uri : string , next? : any , <span class="hljs-attr"><span class="hljs-attr">force</span></span> : $mol_atom_force ) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttpRequest <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> method = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> next === </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span></span><span class="hljs-function">) ? '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">get</span></span></span><span class="hljs-function">' : '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">put</span></span></span><span class="hljs-function">' </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">onload</span></span></span><span class="hljs-function"> = (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> event : Event </span></span></span><span class="hljs-function">)=&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resource( uri , request.responseText , $mol_atom_force ) } request.onerror = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> event : ErrorEvent </span></span></span><span class="hljs-function">)=&gt;</span></span> { setTimeout( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">=&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resource( uri , event.error || <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>( <span class="hljs-string"><span class="hljs-string">'Unknown HTTP error'</span></span> ) , $mol_atom_force ) } ) } request.open( method , uri ) request.send( next ) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> $mol_atom_wait( <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${ method }</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${ uri }</span></span></span><span class="hljs-string">`</span></span> ) } }</code> </pre> <br><p>  Separate atoms will be created for different uri.  But when referring to the same uri, the same atom will be used.  As you can see, the logic for obtaining data and setting values ‚Äã‚Äãis completely the same.  The only difference is that when requesting data, the http-method "get" will be used, and during data transfer - "put". </p><br><p>  Since atoms are able to work adequately with exceptional situations, here we used this property of theirs to abstract the application code from asynchrony.  Since the data is not yet loaded, we cannot immediately return it.  Instead, a special exception is thrown and the calculation of properties dependent on this property is interrupted pending any changes.  When a response comes from the server, it is set as the property value and the dependent atoms "come to life", but this time their calculation is not interrupted.  It is worth noting that the error handler can be called by the browser synchronously, so the property is set deferred to ensure that it is installed, and not $ mol_atom_wait, which rushes further. </p><br><p>  Let's implement an application that draws all the emoji that the githab supports: </p><br><pre> <code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mol_object</span></span></span><span class="hljs-class"> </span></span>{ @ $mol_mem() <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> presenting() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> emojis = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse( Rest.resource( <span class="hljs-string"><span class="hljs-string">'http://api.github.com/emojis'</span></span> ) ) <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> emojis ) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> image = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement( <span class="hljs-string"><span class="hljs-string">'img'</span></span> ) image.src = emojis[ id ] <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.appendChild( image ) } } } App.presenting()</code> </pre> <br><p>  <a href="http://jsbin.com/vehuwuzeli/1/edit%3Fjs,output">Try online.</a> </p><br><p>  As you can see, we did not have to dance with callbacks, promises, generators, streams, asynchronous functions and other hellish creatures.  Instead, our code is simple and straightforward. </p><br><p>  A more complex example of parallel file downloads is discussed in a <a href="https://habrahabr.ru/post/311172/">detailed article about $ mol</a> . </p><br><h1 id="no-ya-ved-tolko-vnedril">  But I just introduced .. </h1><br><h2 id="rxjshttpsgithubcomreactive-extensionsrxjs">  <a href="https://github.com/Reactive-Extensions/RxJS/">Rxjs</a> </h2><br><p>  <a href="">Light version</a> - only 250KB. </p><br><p><img src="https://habrastorage.org/files/7ff/5c2/d6d/7ff5c2d6de6141b2b0798be6e7837254.jpg" alt="250KB!"></p><br><p>  All this is only to write combinators of combinators of a heap of small closures instead of sequential code.  Maintainers of AngularJS @ 2, after all, cannot be mistaken.  Speaker with * JsConfTalksMeetUpDays waving his hands convincingly about it.  This is how you need to write code in 2k16: </p><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> greeting = showName .select( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">showName</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( showName ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> userName.map( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">userName</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">`Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${ userName }</span></span></span><span class="hljs-string">!`</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Rx.Observable.from([ <span class="hljs-string"><span class="hljs-string">'Hello!'</span></span> ]) } ) .switch()</code> </pre> <br><p>  And for such an obsolete product, you need to tear off your hands: </p><br><pre> <code class="hljs kotlin">greeting() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showName() ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> `Hello, ${ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.userName() }!` <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Hello!'</span></span> }</code> </pre> <br><h2 id="promiseshttpsdevelopermozillaorgrudocswebjavascriptreferenceglobal_objectspromise">  <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promises</a> </h2><br><p><img src="https://habrastorage.org/files/2d5/d4a/709/2d5d4a709c7848c698ca137d2255c021.png" alt="The godfather of the whole team"></p><br><p>  Built into almost every browser, they allow you to write ... chains of chains of small closures.  After all, this is what the code of this signor looks like: </p><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> _config <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getConfig = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">=&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( _config ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _config <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _config = $.get( <span class="hljs-string"><span class="hljs-string">'config.json'</span></span> ).then( <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse ) } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> _profile <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getProfile = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">=&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( _profile ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _profile <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _profile = $.get( <span class="hljs-string"><span class="hljs-string">'profile.json'</span></span> ).then( <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse ) } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getGreeting = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">=&gt;</span></span> getConfig() .then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">config</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( !config.showName ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Hello!'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getProfile() .then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">profile</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">`Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${profile.userName}</span></span></span><span class="hljs-string">!`</span></span> ) } )</code> </pre> <br><p>  This same code is simply impossible to maintain: </p><br><pre> <code class="hljs kotlin">@ $mol_mem() config() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> JSON.parse( Rest.resource( <span class="hljs-string"><span class="hljs-string">'config.json'</span></span> ) ) } @ $mol_mem() profile() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> JSON.parse( Rest.resource( <span class="hljs-string"><span class="hljs-string">'profile.json'</span></span> ) ) } @ $mol_mem() greeting() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.config().showName ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Hello!'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> `Hello, ${ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.profile().userName }!` }</code> </pre> <br><h2 id="async-functionshttpsdevelopermozillaorgen-usdocswebjavascriptreferencestatementsasync_function">  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">Async functions</a> </h2><br><p><img src="https://habrastorage.org/files/fa8/d9f/a95/fa8d9fa9500947349655812d03ff04d4.jpg" alt="Misunderstood genius"></p><br><p>  You are at the cutting edge of technology.  On so acute that many browsers do not understand what you are writing: </p><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> _config <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getConfig = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> ()=&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( _config ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _config <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _config = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse( <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> $.get( <span class="hljs-string"><span class="hljs-string">'config.json'</span></span> ) ) } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> _profile <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getProfile = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> ()=&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( _profile ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _profile <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _profile = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse( <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> $.get( <span class="hljs-string"><span class="hljs-string">'profile.json'</span></span> ) ) } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getGreeting = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> ()=&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( !( <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> getConfig() ).showName ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Hello!'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${ ( </span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">await</span></span></span></span><span class="hljs-string"><span class="hljs-subst"> getProfile() ).userName }</span></span></span><span class="hljs-string">!`</span></span> }</code> </pre> <br><p>    <a href="https://webpack.js.org/">webpack</a>  <a href="https://babeljs.io/">babel</a> ,       ,     ,     : </p><br><pre> <code class="hljs javascript"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_asyncToGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fn</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gen = fn.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key, arg</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> info = gen[key](arg); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value = info.value; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { reject(error); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (info.done) { resolve(value); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.resolve(value).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{ step(<span class="hljs-string"><span class="hljs-string">"next"</span></span>, value); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">) </span></span>{ step(<span class="hljs-string"><span class="hljs-string">"throw"</span></span>, err); }); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> step(<span class="hljs-string"><span class="hljs-string">"next"</span></span>); }); }; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _config = <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getConfig = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _ref = _asyncToGenerator(regeneratorRuntime.mark(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_callee</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> regeneratorRuntime.wrap(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_callee$</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_context</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (_context.prev = _context.next) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_config) { _context.next = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.abrupt(<span class="hljs-string"><span class="hljs-string">'return'</span></span>, _config); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: _context.t0 = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>; _context.next = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.get(<span class="hljs-string"><span class="hljs-string">'config.json'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: _context.t1 = _context.sent; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.abrupt(<span class="hljs-string"><span class="hljs-string">'return'</span></span>, _config = _context.t0.parse.call(_context.t0, _context.t1)); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'end'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context.stop(); } } }, _callee, <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>); })); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConfig</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _ref.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); }; }(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _profile = <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getProfile = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _ref2 = _asyncToGenerator(regeneratorRuntime.mark(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_callee2</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> regeneratorRuntime.wrap(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_callee2$</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_context2</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (_context2.prev = _context2.next) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_profile) { _context2.next = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context2.abrupt(<span class="hljs-string"><span class="hljs-string">'return'</span></span>, _profile); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: _context2.t0 = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>; _context2.next = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.get(<span class="hljs-string"><span class="hljs-string">'profile.json'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: _context2.t1 = _context2.sent; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context2.abrupt(<span class="hljs-string"><span class="hljs-string">'return'</span></span>, _profile = _context2.t0.parse.call(_context2.t0, _context2.t1)); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'end'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context2.stop(); } } }, _callee2, <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>); })); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getProfile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _ref2.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); }; }(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getGreeting = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _ref3 = _asyncToGenerator(regeneratorRuntime.mark(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_callee3</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> regeneratorRuntime.wrap(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_callee3$</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_context3</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (_context3.prev = _context3.next) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: _context3.next = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getConfig(); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_context3.sent.showName) { _context3.next = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context3.abrupt(<span class="hljs-string"><span class="hljs-string">'return'</span></span>, <span class="hljs-string"><span class="hljs-string">'Hello!'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: _context3.next = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getProfile(); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>: _context3.t0 = _context3.sent.userName; _context3.t1 = <span class="hljs-string"><span class="hljs-string">'Hello, '</span></span> + _context3.t0; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context3.abrupt(<span class="hljs-string"><span class="hljs-string">'return'</span></span>, _context3.t1 + <span class="hljs-string"><span class="hljs-string">'!'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'end'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _context3.stop(); } } }, _callee3, <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>); })); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGreeting</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _ref3.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); }; }();</code> </pre> <br><p>  ,   -   : </p><br><pre> <code class="hljs kotlin">@ $mol_mem() config() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> JSON.parse( Rest.resource( <span class="hljs-string"><span class="hljs-string">'config.json'</span></span> ) ) } @ $mol_mem() profile() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> JSON.parse( Rest.resource( <span class="hljs-string"><span class="hljs-string">'profile.json'</span></span> ) ) } @ $mol_mem() greeting() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( !<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.config().showName ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Hello!'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> `Hello, ${ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.profile().userName }!` }</code> </pre> <br><p>    ,   <code>config</code>  ,      ! </p><br><h1 id="no-esli-vsyo-zhe">    .. </h1><br><p><img src="https://habrastorage.org/files/fcd/b30/979/fcdb30979f8f44edbc8483bdc681d7b4.jpg" alt=" "></p><br><p> $mol_atom     <a href="https://github.com/eigenmethod/mol"> $mol</a> .          ,       .    ,   (-,  )    ,       .     ,   .     ,   ,          . <a href="">  $mol_atom+$mol_mem</a>   25KB        . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/317360/">https://habr.com/ru/post/317360/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317346/index.html">VulnHub 64Base Simple Solution: Boot2Root</a></li>
<li><a href="../317348/index.html">Parallel fast sorting on Haskell and how hard it turned out to write</a></li>
<li><a href="../317350/index.html">Presentations and video presentations from the VR-Today virtual reality meeting</a></li>
<li><a href="../317354/index.html">OpenWRT + OpenVPN: point bypass blocking</a></li>
<li><a href="../317356/index.html">Automatic backup of virtual machines in XenServer</a></li>
<li><a href="../317362/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ240 (December 5 - 11, 2016)</a></li>
<li><a href="../317364/index.html">Linux kernel 4.9 introduced</a></li>
<li><a href="../317366/index.html">PHP Digest number 98 - interesting news, materials and tools (November 28 - December 11, 2016)</a></li>
<li><a href="../317368/index.html">Firsthand about software lifecycle management products</a></li>
<li><a href="../317370/index.html">Comparison of 2048 game strategies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>