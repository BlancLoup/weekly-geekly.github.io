<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We study Adversarial Tactics, Techniques & Common Knowledge (ATT @ CK). Enterprise Tactics. Part 10</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Exfiltration or Data Leakage (Exfiltration) 
 Links to all parts: 
 Part 1. Getting Initial Access 
 Part 2. Execution 
 Part 3. Persistence 
 Part 4....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We study Adversarial Tactics, Techniques & Common Knowledge (ATT @ CK). Enterprise Tactics. Part 10</h1><div class="post__text post__text-html js-mediator-article"><h2>  <a href="https://attack.mitre.org/tactics/TA0010/">Exfiltration or Data Leakage (Exfiltration)</a> </h2><br>  <b>Links to all parts:</b> <br>  <a href="https://habr.com/post/423405/">Part 1. Getting Initial Access</a> <br>  <a href="https://habr.com/post/424027/">Part 2. Execution</a> <br>  <a href="https://habr.com/post/425177/">Part 3. Persistence</a> <br>  <a href="https://habr.com/post/428602/">Part 4. Privilege Escalation</a> <br>  <a href="https://habr.com/post/432624/">Part 5. Defense Evasion</a> <br>  <a href="https://habr.com/post/433566/">Part 6. Getting Credential Access</a> <br>  <a href="https://habr.com/ru/post/436350/">Part 7. Discovery</a> <br>  <a href="https://habr.com/ru/post/439026/">Part 8. Lateral Movement (Lateral Movement)</a> <br>  <a href="https://habr.com/ru/post/441896/">Part 9. Data Collection (Collection)</a> <br><br>  In this section, ATT &amp; CK Enterprise Tactics describes data transmission techniques used by hackers / malware to extract / steal / leak target information from a compromised system. <br><a name="habracut"></a><br>  <i>The author is not responsible for the possible consequences of the application of the information contained in the article, and also apologizes for any inaccuracies in some formulations and terms.</i>  <i>The published information is a free recount of <a href="https://attack.mitre.org/wiki/Main_Page">MITER ATT &amp; CK</a> content.</i> <br><br><h3>  <a href="https://attack.mitre.org/wiki/Technique/T1020">Automated Exfiltration (Automated Exfiltration)</a> </h3><br>  <i>System:</i> Windows, Linux, macOS <br>  <i>Description: The</i> exfiltration of data containing confidential information can be performed using automated information processing tools and scripts after or during the collection of targeted information.  In conjunction with exfiltration automation tools, exfiltration methods via the control channel (C2) or an alternative protocol can also be used to transmit data over the network. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>Protection</i> tips <i>:</i> Identify and block potentially dangerous and malicious software using white-listing tools such as AppLocker or Software Restriction Policies. <br><br><h3>  <a href="https://attack.mitre.org/wiki/Technique/T1002">Data Compressed</a> </h3><br>  <i>System:</i> Windows, Linux, macOS <br>  <i>Description:</i> In order to reduce the amount of data, an adversary can compress target data collected for exfiltration.  Compression is performed outside the transmission channel using custom software, a compression algorithm, or a common library / utility, such as 7zip, RAR, ZIP, or zlib. <br><br>  <i>Protection recommendations:</i> In order to bypass IPS or DLP, blocking the transfer of files of a certain type or containing a certain header over unencrypted communication channels, an attacker can switch to using encryption of the exfiltration channel.  Compression software and compressed files can be detected in advance by monitoring the processes and command line arguments associated with calling known data compression utilities, but this approach involves analyzing a large number of false events. <br><br><h3>  <a href="https://attack.mitre.org/wiki/Technique/T1022">Data Encryption</a> </h3><br>  <i>System:</i> Windows, Linux, macOS <br>  <i>Description:</i> Before exfiltration, target data can be encrypted in order to hide the stolen information, escape detection, or make the process less noticeable.  Encryption is performed using a utility, library, or custom algorithm and is performed outside the control channel (C2) and the file transfer protocol.  Common archive formats with data encryption support are RAR and zip. <br><br>  <i>Security Tips:</i> Running well-known file encryption software can be detected by monitoring processes and command line arguments, but this approach involves analyzing a large number of false events.  Processes that load Windows crypt.32.dll DLLs can be used by an adversary to encrypt, decrypt, or verify file signatures.  Detection of the fact of transmission of encrypted data can be performed by analyzing the entropy of network traffic.  If the channel is not encrypted, then transfer of files of known types can be detected by IDS or DLP systems that analyze file headers. <br><br><h3>  <a href="https://attack.mitre.org/wiki/Technique/T1030">Data Transfer Size Limits</a> </h3><br>  <i>System:</i> Windows, Linux, macOS <br>  <i>Description:</i> In order to protect against protections and possible warnings about exceeding the allowable threshold for data transmitted over a network, an attacker can split exfiltered files into many fragments of the same size or limit the size of network packets below a threshold value. <br><br>  <i>Security</i> Tips <i>:</i> IDS and DLP using traffic signature analysis can be used to detect and block only known specific management and control tools (C2) and malware, so the adversary is likely to change the tools used over time or set up a data transfer protocol to avoid detection by known means of protection. <br><br>  As a detection technique, we recommend analyzing network traffic for unusual data streams (for example, the client sends much more data than it receives from the server).  A malicious process can maintain a connection for a long time by sequentially sending packets of a fixed size or opening a connection and performing data transfer at fixed intervals.  Such activity processes, which usually do not use the network, should be suspicious.  The mismatch of the port number used for data transmission and the port number set in the default network protocol may also indicate malicious activity. <br><br><h3>  <a href="https://attack.mitre.org/wiki/Technique/T1048">Exfiltration over Alternative Protocol (Exfiltration Over Alternative Protocol)</a> </h3><br>  <i>System:</i> Windows, Linux, macOS <br>  <i>Description:</i> Data exfiltration is usually performed using an alternative protocol other than the one used by the adversary to establish the control channel (C2).  Alternative protocols include FTP, SMTP, HTTP / S, DNS and other network protocols, as well as external web services, such as cloud storage. <br><br>  <i>Security Tips:</i> Follow the recommendations for configuring firewalls, restricting traffic to entering and exiting the network from allowed ports only.  For example, if you do not use the FTP service to send information outside the network, then block the ports associated with the FTP protocol around the network perimeter.  In order to reduce the possibility of organizing the control channel and exfiltration, use proxy servers and dedicated servers for such services as DNS, allow interaction of the systems only through the appropriate ports and protocols. <br><br>  To detect and prevent known methods of organizing the control channel and exfiltration of data, use IDS / IPS systems that use traffic signature analysis.  However, attackers are likely to change the control and exfiltration protocol with time so as to avoid detection by means of protection. <br><br>  As a detection technique, we also recommend analyzing network traffic for unusual data streams (for example, the client sends significantly more data than it receives from the server).  Not matching the port number used and the port number set in the default network protocol may also indicate malicious activity. <br><br><h3>  <a href="https://attack.mitre.org/wiki/Technique/T1041">Exfiltration via the C2 control channel (Exfiltration Over Command and Control Channel)</a> </h3><br>  <i>System:</i> Windows, Linux, macOS <br>  <i>Description:</i> Data can be exfiltrated using the same protocol that an attacker uses as a control channel (C2). <br><br>  <i>Protection recommendations:</i> Use IDS / IPS systems to organize traffic signature-based analysis to identify known means of organizing the control channel and exfiltration.  Analyze traffic for unusual data streams (for example, the client sends significantly more data than it receives from the server).  Not matching the port number used and the port number set in the default network protocol may also indicate malicious activity. <br><br><h3>  <a href="https://attack.mitre.org/wiki/Technique/T1011">Exfiltration over Other Network Medium</a> </h3><br>  <i>System:</i> Windows, Linux, macOS <br>  <i>Description:</i> Data exfiltration can take place in a network environment different from the environment in which the control channel (C2) is organized.  If the control channel uses a wired connection to the Internet, then exfiltration can occur via a wireless connection ‚Äî WiFi, a cellular network, a Bluetooth connection, or another radio channel.  If there is availability and proximity, the adversary will use an alternative data transmission medium, since the traffic in it will not be routed through the attacked corporate network, and the network connection may be either protected or open. <br><br>  <i>Security Recommendations:</i> Ensure that the security sensors on the hosts support auditing the use of all network adapters and, if possible, prevent the connection of new ones.  Track and analyze changes in network adapter settings related to the addition or replication of network interfaces. <br><br><h3>  <a href="https://attack.mitre.org/wiki/Technique/T1052">Exfiltration through an alternative physical medium (Exfiltration Over Physical Medium)</a> </h3><br>  <i>System:</i> Windows, Linux, macOS <br>  <i>Description:</i> Under certain circumstances, such as physical isolation of a compromised network, exfiltration may occur through physical media or a device connected by the user.  Such media can be an external hard drive, USB drive, cell phone, mp3 player, or any other removable storage or information processing device.  The physical medium or device can be used by the adversary as an end point for exfiltration or for transitions between isolated systems. <br><br>  <i>Security Tips:</i> Disable autorun removable storage devices.  Prohibit or restrict the use of removable devices at the level of an organization‚Äôs security policy if they are not required for business operations. <br><br>  As a measure to detect exfiltration through the physical environment, it is recommended to organize monitoring access to files on removable media, as well as auditing processes that start when removable media are connected. <br><br><h3>  <a href="https://attack.mitre.org/wiki/Technique/T1029">Scheduled Transfer</a> </h3><br>  <i>System:</i> Windows, Linux, macOS <br>  <i>Description:</i> Data can be exfiltrated only at certain times of the day or at regular intervals.  Such scheduling is used to mix the filtered data with normal traffic on the network.  When using planned exfiltration, other methods of information leakage are also used, such as exfiltration via a control channel (C2) and an alternative protocol. <br><br>  <i>Protection recommendations:</i> The use of IDS / IPS systems with traffic signature analysis.  As measures to detect malicious activity, it is recommended to monitor the access patterns of processes to files, and the processes and scenarios that scan the file system and then send network traffic.  Network connections to the same address occurring at the same time of day for several days should be suspicious. </div><p>Source: <a href="https://habr.com/ru/post/447240/">https://habr.com/ru/post/447240/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447222/index.html">Linux Quest. Congratulations to the winners and tell about solutions</a></li>
<li><a href="../447226/index.html">Interview with the popularizer of science, the head of the only private school of astronomy in Russia, Pavel Skripnichenko</a></li>
<li><a href="../447232/index.html">Personal experience. How we connected international telephony: comparison of 6 virtual PBXs</a></li>
<li><a href="../447234/index.html">How to write polymorphic programs with Arrow</a></li>
<li><a href="../447236/index.html">Creating a farm of Android devices using Open STF</a></li>
<li><a href="../447242/index.html">Automation of SQL server in Jenkins: we return the result beautifully</a></li>
<li><a href="../447246/index.html">Prototype in 1 day instead of 2-3 weeks: 3D-printing in concern ‚ÄúOceanpribor‚Äù</a></li>
<li><a href="../447248/index.html">What is explored in the stratosphere?</a></li>
<li><a href="../447250/index.html">Learning to communicate between microservices on Node.js via RabbitMQ</a></li>
<li><a href="../447252/index.html">Help Duke to find a way out</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>