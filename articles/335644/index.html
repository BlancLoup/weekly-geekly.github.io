<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Postgres 9.x Partitioning Using pg_pathman to optimize the insertion and pruning of partitions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! I want to talk about the features of partitioning in the current postgresql 9.x and its improvement with the pg_pathman extension (and here ), ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Postgres 9.x Partitioning Using pg_pathman to optimize the insertion and pruning of partitions</h1><div class="post__text post__text-html js-mediator-article">  Hello!  I want to talk about the features of partitioning in the current postgresql 9.x and its improvement with the <a href="https://github.com/postgrespro/pg_pathman">pg_pathman</a> extension (and <a href="https://postgrespro.com/docs/postgresproee/9.6/pg-pathman">here</a> ), created by the guys from <a href="https://postgrespro.com/">Postgres Professional</a> .  The article is intended for developers who are familiar with partitioning, who needed to break a large database into postgres, or for those who want to appreciate the complexity of migrating an already partitioned non-postgres database to postgres. <br><br>  First we will create a database schema, then partition it in two ways (‚Äúregular‚Äù and pg_pathman), then fill it with data and check how queries on partitioned tables work. <br><br>  I will also tell you how to embed this remarkable extension into the data schema, already beaten into partitions in the ‚Äúregular‚Äù way. <br><a name="habracut"></a><br><h2>  1. Create a data schema </h2><br>  Our small schema will consist of three tables: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ‚Ä¢ parent table partitioned into three parts, <br>  ‚Ä¢ a child table referencing it in the same way, <br>  ‚Ä¢ a regular table of some result results with links to parent records with partition numbers. <br><br>  The parent and child tables are partitioned by partition_id.  In these tables added columns with some data parent_data and child_data, respectively.  And also in the child table an indexed field child_index has been added for use in subqueries. <br><br><img src="https://habrastorage.org/web/e9e/f8a/6fe/e9ef8a6fe2704585b0dcb37d7a21db82.png"><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> public.parent ( parent_id <span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, parent_data <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>), partition_id <span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (parent_id) ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> public.child ( child_id <span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, parent_id <span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, child_data <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>), child_index <span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>, partition_id <span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (child_id) ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ix_child_parent <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child(parent_id); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> ix_child_index <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child(child_index); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> public.result ( result_id <span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, parent_id <span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, partition_id <span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> idx_result <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.result(result_id);</code> </pre> <br><h2>  2. We partition the scheme in a ‚Äúregular‚Äù way. </h2><br>  So, if your eye caught the headline and you decided to see this article, then you probably know that there is no built-in partitioning in postgres yet.  Instead, it is proposed to use the existing <a href="https://www.postgresql.org/docs/9.6/static/ddl-partitioning.html">mechanism of inheritance</a> . <br><br>  Here's what it looks like: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> public.parent_1 ( <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> public.parent <span class="hljs-keyword"><span class="hljs-keyword">including</span></span> <span class="hljs-keyword"><span class="hljs-keyword">indexes</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span>(partition_id = <span class="hljs-number"><span class="hljs-number">1</span></span>) ) inherits (public.parent); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> public.parent_2 ( <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> public.parent <span class="hljs-keyword"><span class="hljs-keyword">including</span></span> <span class="hljs-keyword"><span class="hljs-keyword">indexes</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span>(partition_id = <span class="hljs-number"><span class="hljs-number">2</span></span>) ) inherits (public.parent); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> public.parent_3 ( <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> public.parent <span class="hljs-keyword"><span class="hljs-keyword">including</span></span> <span class="hljs-keyword"><span class="hljs-keyword">indexes</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span>(partition_id = <span class="hljs-number"><span class="hljs-number">3</span></span>) ) inherits (public.parent); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> public.child_1 ( <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> public.child <span class="hljs-keyword"><span class="hljs-keyword">including</span></span> <span class="hljs-keyword"><span class="hljs-keyword">indexes</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span>(partition_id = <span class="hljs-number"><span class="hljs-number">1</span></span>)) inherits (public.child); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> public.child_2 ( <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> public.child <span class="hljs-keyword"><span class="hljs-keyword">including</span></span> <span class="hljs-keyword"><span class="hljs-keyword">indexes</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span>(partition_id = <span class="hljs-number"><span class="hljs-number">2</span></span>)) inherits (public.child); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> public.child_3 ( <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> public.child <span class="hljs-keyword"><span class="hljs-keyword">including</span></span> <span class="hljs-keyword"><span class="hljs-keyword">indexes</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">check</span></span>(partition_id = <span class="hljs-number"><span class="hljs-number">3</span></span>)) inherits (public.child); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">replace</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> public.trigger_function() <span class="hljs-keyword"><span class="hljs-keyword">returns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $trg_func$ <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span> <span class="hljs-string"><span class="hljs-string">'insert into '</span></span> || tg_table_name || <span class="hljs-string"><span class="hljs-string">'_'</span></span> || new.partition_id ||<span class="hljs-string"><span class="hljs-string">' values ($1.*)'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>; return null; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;$trg_func$ language plpgsql security definer; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span> parent_trigger <span class="hljs-keyword"><span class="hljs-keyword">before</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parentfor <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> public.trigger_function(); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span> child_trigger <span class="hljs-keyword"><span class="hljs-keyword">before</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.childfor <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> public.trigger_function();</code> </pre><br>  We partition our two tables into three parts each; I didn‚Äôt do more partitions, otherwise the query plans will turn the article into an endless sheet.  Tables are inherited in like mode, including indexes, so that the primary key and indexes are copied to the inherited tables.  Local PK will not give global uniqueness, but there will be local uniqueness in partitions and local indices.  Also, in the inherited tables, a restriction is created on the partition identifier so that the regular cut-off mechanism works. <br>  The mechanism of triggers and the universal trigger function public.trigger_function is used to spread records by partitions when inserting.  The disadvantage of this mechanism is that when inserted into the main table, the number of records inserted returns 0. <br><br><h2>  3. We partition the scheme using pg_pathman </h2><br>  Partitioning tables with this extension in postgres is done by calling the special function create_range_partitions: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> public.create_range_partitions(c.oid, <span class="hljs-string"><span class="hljs-string">'partition_id'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pg_class c <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> pg_namespace n <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> c.relnamespace = n.oid <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> n.nspname = <span class="hljs-string"><span class="hljs-string">'public'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> c.relname <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'parent'</span></span>, <span class="hljs-string"><span class="hljs-string">'child'</span></span>);</code> </pre><br>  With this partitioning, all indexes from the source tables are copied to the partition tables, and special restrictions are created for the operation of this extension. <br><br><h2>  4. Testing methodology </h2><br>  Before showing the results, I will describe the stand and testing methodology. <br>  The bench on which I tested is a VMware virtual machine with 2 gigabytes of RAM.  It hosts Red Hat Server 6.7, Postresql 9.6.3 and pg_pathman 1.4.2.  In the postgres config, shared_buffers = 512M, effective_cache_size = 1GB, constraint_exclusion = partition. <br>  The insert block and each query were tested as follows: <br><br>  1. When testing a query, the query itself is first executed so that its data is swapped into the host windows disk cache, nothing is done to insert it.  I did not succeed in throwing this cache for the virtual files and leaving it for the rest of the applications, the complete drop of this cache caused wild brakes and did not allow me to measure anything correctly.  Therefore, we will not be much oriented during the execution of queries, we will look at the number of data blocks viewed by queries.  This number on the usual large system will be proportional to the number of disk reads, and hence the query execution time in the same place. <br><br>  2. Linux caches are discarded using the echo 3&gt; / proc / sys / vm / drop_caches command. <br><br>  3. Postgres is restarted in order to reset its caches. <br><br>  4. A query or insert is executed with the preceding explain statement (analyze, verbose, buffers) to determine the plan, time and other characteristics of their execution. <br><br><h2>  5. Insert the data </h2><br>  We insert the data in the following script: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> public.parent (parent_id, parent_data, partition_id) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> a, gen_random_bytes(<span class="hljs-number"><span class="hljs-number">25</span></span>), trunc(random() * <span class="hljs-number"><span class="hljs-number">3</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10000000</span></span>) a; <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> public.child (child_id, parent_id, child_data, child_index, partition_id) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> parent_id * <span class="hljs-number"><span class="hljs-number">20</span></span> + a, parent_id, gen_random_bytes(<span class="hljs-number"><span class="hljs-number">25</span></span>), trunc(random() * <span class="hljs-number"><span class="hljs-number">100000</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>, partition_id <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent, generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) a <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> random() &lt; <span class="hljs-number"><span class="hljs-number">0.1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> public.result (result_id, parent_id, partition_id) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> a, parent_id, partition_id <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>) a, public.parent <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> random() &lt; <span class="hljs-number"><span class="hljs-number">0.001</span></span>;</code> </pre><br>  We insert 10 million entries into the parent table, about twice as many in the child. <br>  On one child_index value there will be approximately 200 entries in child.  One result_id value ‚Äî one million parent records each. <br><br>  After inserting records, analyze all tables. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span> public.parent; <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span> public.parent_1; <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span> public.parent_2; <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span> public.parent_3; <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span> public.child; <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span> public.child_1; <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span> public.child_2; <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span> public.child_3; <span class="hljs-keyword"><span class="hljs-keyword">analyze</span></span> public.result;</code> </pre><br>  So, the insertion into our two tables, partitioned by the standard postgres method, lasted 38:39, and with the help of pg_pathman - 15:10.  That is, the insertion speed has increased two and a half times.  In pg_pathman in terms of insertion, a special step PartitionFilter appears to redirect the inserted record and the effect is visible.  The trigger is no longer needed.  Also, the exception of the trigger for redirecting inserted records allows you to know the number of inserted records, as well as when inserting into a regular table.  For example, here‚Äôs a plot of inserts into the parent table: <br><br><pre> <code class="sql hljs">"<span class="hljs-keyword"><span class="hljs-keyword">Insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.00</span></span>.<span class="hljs-number"><span class="hljs-number">.45</span></span><span class="hljs-number"><span class="hljs-number">.00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1000</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Custom <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> (PartitionFilter) (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.00</span></span>.<span class="hljs-number"><span class="hljs-number">.45</span></span><span class="hljs-number"><span class="hljs-number">.00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1000</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Subquery <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-string"><span class="hljs-string">"*SELECT*"</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.00</span></span>.<span class="hljs-number"><span class="hljs-number">.45</span></span><span class="hljs-number"><span class="hljs-number">.00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1000</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> generate_series a (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.00</span></span>.<span class="hljs-number"><span class="hljs-number">.22</span></span><span class="hljs-number"><span class="hljs-number">.50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1000</span></span> width=<span class="hljs-number"><span class="hljs-number">44</span></span>)<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> <br><h2>  6. Implement pg_pathman in an already partitioned scheme </h2><br>  In order to properly compare partitioning performance, the same data is required.  To do this, I will make a standardly partitioned scheme, I will test queries using the above method.  And then in this scheme I will implement the pg_pathman extension for testing with it. <br><br>  The extension has functions both for partitioning an empty table and for parallel partitioning a table with data.  But there is no mechanism for registering the already partitioned and data-filled table, and this is sad. <br><br>  We cannot register the main table right away.  pg_pathman also uses the inheritance mechanism to designate the associations of partitions with the main table. <br><br>  And when trying to register the main table, pg_pathman will not detect its limitations on the partitions and will generate an error. <br><br>  But this problem can be solved in the following way: <br><br>  1) The first step is to remove all partitions from the main heirs: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> parent_1 <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> inherit <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> parent_2 <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> inherit <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> parent_3 <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> inherit <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> child_1 <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> inherit <span class="hljs-keyword"><span class="hljs-keyword">child</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> child_2 <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> inherit <span class="hljs-keyword"><span class="hljs-keyword">child</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> child_3 <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> inherit <span class="hljs-keyword"><span class="hljs-keyword">child</span></span>;</code> </pre><br>  2) Then you need to register the main tables in pg_pathman: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> public.add_to_pathman_config(c.oid, <span class="hljs-string"><span class="hljs-string">'partition_id'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pg_class c <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> pg_namespace n <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> n.oid = c.relnamespace <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> n.nspname = <span class="hljs-string"><span class="hljs-string">'public'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> c.relname <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'parent'</span></span>, <span class="hljs-string"><span class="hljs-string">'child'</span></span>);</code> </pre><br>  3) Register partitions with pg_pathman: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> public.attach_range_partition(parent.oid, child.oid, partition_id.partition_id::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>, (partition_id.partition_id + <span class="hljs-number"><span class="hljs-number">1</span></span>)::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pg_namespace n <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> n.oid = parent.relnamespace <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> parent.relname <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'parent'</span></span>, <span class="hljs-string"><span class="hljs-string">'child'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) partition_id <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">child</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> n.oid = child.relnamespace <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> child.relname = parent.relname || <span class="hljs-string"><span class="hljs-string">'_'</span></span> || partition_id.partition_id <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> n.nspname = <span class="hljs-string"><span class="hljs-string">'public'</span></span>;</code> </pre><br>  4) Now you can delete all triggers and trigger function: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span> parent_trigger <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent; <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span> child_trigger <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child; <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> trigger_function();</code> </pre><br>  5) At the end you need to check the insert and queries.  Everything should work. <br><br><h2>  7. We test requests </h2><br>  The standard partitioning mechanism works through constraints on partitions, which it compares with the constants specified in the request. <br><br>  In this article I am using version 1.4.2 of pg_pathman.  The extension documentation describes a new special type of query plan step, RuntimeAppend, which is used instead of the standard Append and differs from it by selectively scanning partitions with the necessary key already during the execution of the query.  That is, the partitioning of partitions in this case should work dynamically using the partitioning key of each record. <br><br>  Therefore, we will first look at how queries work with one constant partition key value, then with two constant values ‚Äã‚Äãand at the end with partition key values ‚Äã‚Äãfrom a regular table.  Query plans will be with execution statistics.  First, the results of the query for the usual partitioning mechanism (postgres) will be given, and then via pg_pathman. <br><br><h3>  7.1.  Query with joining partitioned tables in from </h3><br>  One constant in the partitioning key condition: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p, public.child c <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> c.partition_id = p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.parent_id = p.parent_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> p.partition_id = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br>  postgres: <br><br><pre> <code class="sql hljs">"Limit (cost=20.41..31.31 rows=100 width=181) (actual time=2.517..3.093 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared hit=4 read=9" ... "Planning time: 19.035 ms" "Execution time: 3.607 ms"</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Fully</b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=20.41..31.31 rows=100 width=181) (actual time=2.517..3.093 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared hit=4 read=9" " -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">20.41</span></span>.<span class="hljs-number"><span class="hljs-number">.726234</span></span><span class="hljs-number"><span class="hljs-number">.12</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662376</span></span> width=<span class="hljs-number"><span class="hljs-number">181</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">2.516</span></span>.<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.079</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Cond: (p.parent_id = c.parent_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.56</span></span>.<span class="hljs-number"><span class="hljs-number">.184529</span></span><span class="hljs-number"><span class="hljs-number">.87</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332147</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.397</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.414</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">47</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: p.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent p (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.006</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.006</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 p_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142869</span></span><span class="hljs-number"><span class="hljs-number">.88</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.389</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.400</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">47</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p_1.parent_id, p_1.parent_data, p_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p_1.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Materialize (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.57</span></span>.<span class="hljs-number"><span class="hljs-number">.450113</span></span><span class="hljs-number"><span class="hljs-number">.45</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662376</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.094</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.605</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.57</span></span>.<span class="hljs-number"><span class="hljs-number">.433457</span></span><span class="hljs-number"><span class="hljs-number">.51</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662376</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.089</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.590</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: c.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ix_child_parent <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child c (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">346</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.004</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.004</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (c.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_3_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_3 c_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.350169</span></span><span class="hljs-number"><span class="hljs-number">.66</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.083</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.554</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_1.child_id, c_1.parent_id, c_1.child_data, c_1.child_index, c_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (c_1.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span>Planning <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">19.035</span></span> ms<span class="hljs-string"><span class="hljs-string">" "</span></span>Execution <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">3.607</span></span> ms<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> </div></div><br>  pg_pathman: <br><br><pre> <code class="sql hljs">"Limit (cost=15.99..25.01 rows=100 width=628) (actual time=0.934..1.111 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared hit=2 read=9" ... "Planning time: 16.164 ms" "Executiontime: 1.174 ms"</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Fully</b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=15.99..25.01 rows=100 width=628) (actual time=0.934..1.111 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared hit=2 read=9" " -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">15.99</span></span>.<span class="hljs-number"><span class="hljs-number">.601209</span></span><span class="hljs-number"><span class="hljs-number">.25</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">628</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.934</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.101</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Cond: (p.parent_id = c.parent_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.44</span></span>.<span class="hljs-number"><span class="hljs-number">.142832</span></span><span class="hljs-number"><span class="hljs-number">.56</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.464</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.480</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">47</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: p.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 p (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142832</span></span><span class="hljs-number"><span class="hljs-number">.55</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.464</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.477</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">47</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Materialize (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.44</span></span>.<span class="hljs-number"><span class="hljs-number">.366781</span></span><span class="hljs-number"><span class="hljs-number">.74</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.464</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.583</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.44</span></span>.<span class="hljs-number"><span class="hljs-number">.350125</span></span><span class="hljs-number"><span class="hljs-number">.80</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.459</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.563</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: c.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_3_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_3 c (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.350125</span></span><span class="hljs-number"><span class="hljs-number">.79</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.459</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.550</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (c.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span>Planning <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">16.164</span></span> ms<span class="hljs-string"><span class="hljs-string">" "</span></span>Executiontime: <span class="hljs-number"><span class="hljs-number">1.174</span></span> ms<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> </div></div><br>  Two constants in the partitioning key condition: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p, public.child c <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> c.partition_id = p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.parent_id = p.parent_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br>  postgres: <br><br><pre> <code class="sql hljs">"Limit (cost=44.98..78.34 rows=100 width=181) (actual time=8.167..8.543 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared hit=2 read=21" ... "Planning time: 17.618 ms" "Execution time: 8.870 ms"</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Fully</b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=44.98..78.34 rows=100 width=181) (actual time=8.167..8.543 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared hit=2 read=21" " -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">44.98</span></span>.<span class="hljs-number"><span class="hljs-number">.2223585</span></span><span class="hljs-number"><span class="hljs-number">.66</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6665904</span></span> width=<span class="hljs-number"><span class="hljs-number">181</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">8.165</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.534</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Cond: (p.parent_id = c.parent_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> Filter: (p.partition_id = c.partition_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">21</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.01</span></span>.<span class="hljs-number"><span class="hljs-number">.408142</span></span><span class="hljs-number"><span class="hljs-number">.24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6665413</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">5.390</span></span>.<span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.416</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">53</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: p.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent p (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.004</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.004</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_2_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_2 p_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142956</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3333266</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">3.594</span></span>.<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.598</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">28</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p_1.parent_id, p_1.parent_data, p_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p_1.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 p_2 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142869</span></span><span class="hljs-number"><span class="hljs-number">.88</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.786</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.798</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">26</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p_2.parent_id, p_2.parent_data, p_2.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p_2.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Materialize (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.46</span></span>.<span class="hljs-number"><span class="hljs-number">.1498856</span></span><span class="hljs-number"><span class="hljs-number">.74</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">19997711</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">2.746</span></span>.<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.039</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">173</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">13</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.46</span></span>.<span class="hljs-number"><span class="hljs-number">.1448862</span></span><span class="hljs-number"><span class="hljs-number">.46</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">19997711</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">2.736</span></span>.<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.987</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">173</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: c.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">13</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ix_child_parent <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child c (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">346</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.004</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.004</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_1_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_1 c_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.331779</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6666670</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.559</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.744</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">74</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_1.child_id, c_1.parent_id, c_1.child_data, c_1.child_index, c_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_2_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_2 c_2 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.333612</span></span><span class="hljs-number"><span class="hljs-number">.86</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6668665</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.022</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.029</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">51</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_2.child_id, c_2.parent_id, c_2.child_data, c_2.child_index, c_2.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_3_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_3 c_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.333513</span></span><span class="hljs-number"><span class="hljs-number">.72</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.146</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.152</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">50</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_3.child_id, c_3.parent_id, c_3.child_data, c_3.child_index, c_3.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span>Planning <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">17.618</span></span> ms<span class="hljs-string"><span class="hljs-string">" "</span></span>Execution <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">8.870</span></span> ms<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> </div></div><br>  pg_pathman: <br><br><pre> <code class="sql hljs">"Limit (cost=32.45..57.22 rows=100 width=628) (actual time=2.457..2.714 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared read=21" ... "Planning time: 18.944 ms" "Executiontime: 2.798 ms"</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Fully</b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=32.45..57.22 rows=100 width=628) (actual time=2.457..2.714 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared read=21" " -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">32.45</span></span>.<span class="hljs-number"><span class="hljs-number">.1651206</span></span><span class="hljs-number"><span class="hljs-number">.45</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6665904</span></span> width=<span class="hljs-number"><span class="hljs-number">628</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">2.455</span></span>.<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.705</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Cond: (p.parent_id = c.parent_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> Filter: (p.partition_id = c.partition_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">21</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.87</span></span>.<span class="hljs-number"><span class="hljs-number">.285722</span></span><span class="hljs-number"><span class="hljs-number">.16</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6665412</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.011</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.037</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">53</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: p.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_2_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_2 p (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142889</span></span><span class="hljs-number"><span class="hljs-number">.60</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3333266</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.522</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.528</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">28</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 p_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142832</span></span><span class="hljs-number"><span class="hljs-number">.55</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.486</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.493</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">26</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p_1.parent_id, p_1.parent_data, p_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p_1.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Materialize (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.32</span></span>.<span class="hljs-number"><span class="hljs-number">.1048885</span></span><span class="hljs-number"><span class="hljs-number">.37</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">19997710</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.437</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.595</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">173</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">13</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.32</span></span>.<span class="hljs-number"><span class="hljs-number">.998891</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">19997710</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.432</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.561</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">173</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: c.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">13</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_1_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_1 c (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.331772</span></span><span class="hljs-number"><span class="hljs-number">.15</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6666670</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.433</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.510</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">74</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_2_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_2 c_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.333608</span></span><span class="hljs-number"><span class="hljs-number">.02</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6668665</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.561</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.563</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">51</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_1.child_id, c_1.parent_id, c_1.child_data, c_1.child_index, c_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_3_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_3 c_2 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.333510</span></span><span class="hljs-number"><span class="hljs-number">.91</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.437</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.442</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">50</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_2.child_id, c_2.parent_id, c_2.child_data, c_2.child_index, c_2.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span>Planning <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">18.944</span></span> ms<span class="hljs-string"><span class="hljs-string">" "</span></span>Executiontime: <span class="hljs-number"><span class="hljs-number">2.798</span></span> ms<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> </div></div><br>  Partitioning key from the table: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.result r, public.parent p <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> r.partition_id = p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r.parent_id = p.parent_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r.result_id = <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br>  postgres: <br><br><pre> <code class="sql hljs">"Limit (cost=199.17..6528.51 rows=100 width=100) (actual time=14.815..65.450 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=651 read=431" ... "Planning time: 13.773 ms" "Execution time: 65.750 ms"</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Fully</b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=199.17..6528.51 rows=100 width=100) (actual time=14.815..65.450 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=651 read=431" " -&gt; Nested Loop (cost=199.17..192800.93 rows=3043 width=100) (actual time=14.813..65.407 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=651 read=431" " -&gt; Bitmap Heap Scan on public.result r (cost=199.17..7003.62 rows=9129 width=16) (actual time=11.301..17.396 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id" " Recheck Cond: (r.result_id = '50'::numeric)" " Heap Blocks: exact=49" " Buffers: shared read=87" " -&gt; Bitmap Index Scan on idx_result (cost=0.00..196.89 rows=9129 width=0) (actual time=10.438..10.438 rows=10051 loops=1)" " Index Cond: (r.result_id = '50'::numeric)" " Buffers: shared read=38" " -&gt; Append (cost=0.00..20.31 rows=4 width=84) (actual time=0.255..0.477 rows=1 loops=100)" " Buffers: shared hit=651 read=344" " -&gt; Seq Scan on public.parent p (cost=0.00..0.00 rows=1 width=282) (actual time=0.000..0.000 rows=0 loops=100)" " Output: p.parent_id, p.parent_data, p.partition_id" " Filter: ((r.partition_id = p.partition_id) AND (r.parent_id = p.parent_id))" " -&gt; Index Scan using parent_1_pkey on public.parent_1 p_1 (cost=0.43..6.77 rows=1 width=84) (actual time=0.252..0.253 rows=1 loops=100)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Index Cond: (p_1.parent_id = r.parent_id)" " Filter: (r.partition_id = p_1.partition_id)" " Buffers: shared hit=222 read=178" " -&gt; Index Scan using parent_2_pkey on public.parent_2 p_2 (cost=0.43..6.77 rows=1 width=84) (actual time=0.112..0.112 rows=0 loops=99)" " Output: p_2.parent_id, p_2.parent_data, p_2.partition_id" " Index Cond: (p_2.parent_id = r.parent_id)" " Filter: (r.partition_id = p_2.partition_id)" " Buffers: shared hit=214 read=84" " -&gt; Index Scan using parent_3_pkey on public.parent_3 p_3 (cost=0.43..6.77 rows=1 width=84) (actual time=0.108..0.108 rows=0 loops=99)" " Output: p_3.parent_id, p_3.parent_data, p_3.partition_id" " Index Cond: (p_3.parent_id = r.parent_id)" " Filter: (r.partition_id = p_3.partition_id)" " Buffers: shared hit=215 read=82" "Planning time: 13.773 ms" "Execution time: 65.750 ms"</code> </pre> </div></div><br>  pg_pathman: <br><br><pre> <code class="sql hljs">"Limit (cost=199.60..2457.44 rows=100 width=298) (actual time=7.354..30.780 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=222 read=265" ... "Planning time: 11.799 ms" "Executiontime: 30.920 ms"</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Fully</b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=199.60..2457.44 rows=100 width=298) (actual time=7.354..30.780 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=222 read=265" " -&gt; Nested Loop (cost=199.60..68905.63 rows=3043 width=298) (actual time=7.352..30.742 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=222 read=265" " -&gt; Bitmap Heap Scan on public.result r (cost=199.17..7003.62 rows=9129 width=16) (actual time=6.838..10.367 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id" " Recheck Cond: (r.result_id = '50'::numeric)" " Heap Blocks: exact=49" " Buffers: shared read=87" " -&gt; Bitmap Index Scan on idx_result (cost=0.00..196.89 rows=9129 width=0) (actual time=5.997..5.997 rows=10051 loops=1)" " Index Cond: (r.result_id = '50'::numeric)" " Buffers: shared read=38" " -&gt; Custom Scan (RuntimeAppend) (cost=0.43..6.77 rows=1 width=84) (actual time=0.194..0.196 rows=1 loops=100)" " Output: p.parent_id, p.parent_data, p.partition_id" " Prune by: (r.partition_id = p.partition_id)" " Buffers: shared hit=222 read=178" " -&gt; Index Scan using parent_1_pkey on public.parent_1 p_1 (cost=0.43..6.77 rows=1 width=84) (actual time=0.193..0.194 rows=1 loops=100)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Index Cond: (p_1.parent_id = r.parent_id)" " Filter: (r.partition_id = p_1.partition_id)" " Buffers: shared hit=222 read=178" "Planning time: 11.799 ms" "Executiontime: 30.920 ms"</code> </pre> </div></div><br>  With the standard partitioning method, clipping partitions with one constant has spread to the associated partitioned table and cut off the wrong parts.  But the empty main table was still viewed, since there is no partition constant on it.  In the query with two constants, the pruning worked only on the parent table, on the partition key of which the condition is set.  The child table connected to it was viewed completely.  That is, clipping partitions of connected tables only works when specifying one constant value of the partition key.  In the query with partitioning keys from the related table, the cut did not work at all, which is very bad, although it corresponds to the documentation. <br><br>  The pg_pathman extension removed the empty main tables from consideration, but for the first and second queries did not change the structure of the plans, the number of block reads was almost the same, which is not surprising. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But it seems that pg_pathman got a bug with the record size: in the Merge Join, in the usual version, the record size is considered to be the addition of the size of the records of the joined tables (width = 182 = 84 + 98), while in the extension it is possible to take the maximum sizes of the records of the joined tables. And the maximum sizes are theoretical maximum sizes from the main tables parent and child (width = 628 = 282 + 346). And this despite the fact that these pg_pathman tables exclude from consideration. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also in the two-constant query, the child table is viewed completely without the main one, the pruning and their magic step RuntimeAppend for some reason does not work.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In a query with partitioning keys from a regular table, the RuntimeAppend step is triggered, the passage only goes through the required partition, and this speeds up the execution of the query. </font><font style="vertical-align: inherit;">This is not surprising, it is enough to compare the number of reads in the query Buffers: shared hit = 651 read = 431 and Buffers: shared hit = 222 read = 265. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Requests with connections through inner and left jon behave similarly, so we will skip the analysis of their plans.</font></font><br><br><h3>  7.2.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Request with subquery in the fields. </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> One constant in the partitioning key condition: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> *, (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(c.child_data) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.child c <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> c.partition_id = p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.parent_id = p.parent_id) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> p.partition_id = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> postgres: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=0.00..2588.75 rows=100 width=116) (actual time=1.939..4.835 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, ((SubPlan 1))" " Buffers: shared hit=977 read=18" ... "Planning time: 14.819 ms" "Execution time: 4.935 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=0.00..2588.75 rows=100 width=116) (actual time=1.939..4.835 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, ((SubPlan 1))" " Buffers: shared hit=977 read=18" " -&gt; Result (cost=0.00..86260794.66 rows=3332147 width=116) (actual time=1.936..4.817 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, (SubPlan 1)" " Buffers: shared hit=977 read=18" " -&gt; Append (cost=0.00..89615.83 rows=3332147 width=84) (actual time=0.026..0.130 rows=100 loops=1)" " Buffers: shared read=2" " -&gt; Seq Scan on public.parent p (cost=0.00..0.00 rows=1 width=282) (actual time=0.002..0.002 rows=0 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Filter: (p.partition_id = '3'::numeric)" " -&gt; Seq Scan on public.parent_3 p_1 (cost=0.00..89615.83 rows=3332146 width=84) (actual time=0.024..0.117 rows=100 loops=1)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Filter: (p_1.partition_id = '3'::numeric)" " Buffers: shared read=2" " SubPlan 1" " -&gt; Aggregate (cost=25.84..25.85 rows=1 width=32) (actual time=0.046..0.046 rows=1 loops=100)" " Output: min((c.child_data)::text)" " Buffers: shared hit=977 read=16" " -&gt; Append (cost=0.00..25.78 rows=25 width=79) (actual time=0.042..0.044 rows=2 loops=100)" " Buffers: shared hit=977 read=16" " -&gt; Seq Scan on public.child c (cost=0.00..0.00 rows=1 width=218) (actual time=0.000..0.000 rows=0 loops=100)" " Output: c.child_data" " Filter: ((c.partition_id = p.partition_id) AND (c.parent_id = p.parent_id))" " -&gt; Index Scan using child_1_parent_id_idx on public.child_1 c_1 (cost=0.43..8.59 rows=8 width=73) (actual time=0.013..0.013 rows=0 loops=100)" " Output: c_1.child_data" " Index Cond: (c_1.parent_id = p.parent_id)" " Filter: (c_1.partition_id = p.partition_id)" " Buffers: shared hit=296 read=4" " -&gt; Index Scan using child_2_parent_id_idx on public.child_2 c_2 (cost=0.43..8.59 rows=8 width=73) (actual time=0.012..0.012 rows=0 loops=100)" " Output: c_2.child_data" " Index Cond: (c_2.parent_id = p.parent_id)" " Filter: (c_2.partition_id = p.partition_id)" " Buffers: shared hit=296 read=4" " -&gt; Index Scan using child_3_parent_id_idx on public.child_3 c_3 (cost=0.43..8.59 rows=8 width=73) (actual time=0.015..0.016 rows=2 loops=100)" " Output: c_3.child_data" " Index Cond: (c_3.parent_id = p.parent_id)" " Filter: (c_3.partition_id = p.partition_id)" " Buffers: shared hit=385 read=8" "Planning time: 14.819 ms" "Execution time: 4.935 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pg_pathman: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=0.00..865.96 rows=100 width=314) (actual time=1.569..3.879 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, ((SubPlan 1))" " Buffers: shared hit=385 read=10" ... "Planning time: 22.729 ms" "Executiontime: 4.006 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=0.00..865.96 rows=100 width=314) (actual time=1.569..3.879 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, ((SubPlan 1))" " Buffers: shared hit=385 read=10" " -&gt; Result (cost=0.00..28854985.31 rows=3332146 width=314) (actual time=1.564..3.858 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, (SubPlan 1)" " Buffers: shared hit=385 read=10" " -&gt; Append (cost=0.00..89615.83 rows=3332146 width=84) (actual time=0.403..0.531 rows=100 loops=1)" " Buffers: shared read=2" " -&gt; Seq Scan on public.parent_3 p (cost=0.00..89615.83 rows=3332146 width=84) (actual time=0.401..0.518 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Filter: (p.partition_id = '3'::numeric)" " Buffers: shared read=2" " SubPlan 1" " -&gt; Aggregate (cost=8.61..8.62 rows=1 width=32) (actual time=0.031..0.032 rows=1 loops=100)" " Output: min((c.child_data)::text)" " Buffers: shared hit=385 read=8" " -&gt; Custom Scan (RuntimeAppend) (cost=0.43..8.59 rows=8 width=218) (actual time=0.024..0.025 rows=2 loops=100)" " Output: c.child_data" " Prune by: (c.partition_id = p.partition_id)" " Buffers: shared hit=385 read=8" " -&gt; Index Scan using child_3_parent_id_idx on public.child_3 c_1 (cost=0.43..8.59 rows=8 width=73) (actual time=0.023..0.024 rows=2 loops=100)" " Output: c_1.child_data, c_1.partition_id" " Index Cond: (c_1.parent_id = p.parent_id)" " Filter: (c_1.partition_id = p.partition_id)" " Buffers: shared hit=385 read=8" "Planning time: 22.729 ms" "Executiontime: 4.006 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Two constants in the partitioning key condition: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> *, (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(c.child_data) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.child c <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> c.partition_id = p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.parent_id = p.parent_id) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> postgres: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=0.00..2588.75 rows=100 width=116) (actual time=1.420..2.874 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, ((SubPlan 1))" " Buffers: shared hit=978 read=15" ... "Planning time: 15.798 ms" "Execution time: 2.988 ms"</code> </pre><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=0.00..2588.75 rows=100 width=116) (actual time=1.420..2.874 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, ((SubPlan 1))" " Buffers: shared hit=978 read=15" " -&gt; Result (cost=0.00..172550562.28 rows=6665413 width=116) (actual time=1.418..2.868 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, (SubPlan 1)" " Buffers: shared hit=978 read=15" " -&gt; Append (cost=0.00..179266.65 rows=6665413 width=84) (actual time=0.122..0.170 rows=100 loops=1)" " Buffers: shared read=2" " -&gt; Seq Scan on public.parent p (cost=0.00..0.00 rows=1 width=282) (actual time=0.002..0.002 rows=0 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Filter: (p.partition_id = ANY ('{2,3}'::numeric[]))" " -&gt; Seq Scan on public.parent_2 p_1 (cost=0.00..89650.83 rows=3333266 width=84) (actual time=0.119..0.153 rows=100 loops=1)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Filter: (p_1.partition_id = ANY ('{2,3}'::numeric[]))" " Buffers: shared read=2" " -&gt; Seq Scan on public.parent_3 p_2 (cost=0.00..89615.83 rows=3332146 width=84) (never executed)" " Output: p_2.parent_id, p_2.parent_data, p_2.partition_id" " Filter: (p_2.partition_id = ANY ('{2,3}'::numeric[]))" " SubPlan 1" " -&gt; Aggregate (cost=25.84..25.85 rows=1 width=32) (actual time=0.026..0.026 rows=1 loops=100)" " Output: min((c.child_data)::text)" " Buffers: shared hit=978 read=13" " -&gt; Append (cost=0.00..25.78 rows=25 width=79) (actual time=0.018..0.025 rows=2 loops=100)" " Buffers: shared hit=978 read=13" " -&gt; Seq Scan on public.child c (cost=0.00..0.00 rows=1 width=218) (actual time=0.000..0.000 rows=0 loops=100)" " Output: c.child_data" " Filter: ((c.partition_id = p.partition_id) AND (c.parent_id = p.parent_id))" " -&gt; Index Scan using child_1_parent_id_idx on public.child_1 c_1 (cost=0.43..8.59 rows=8 width=73) (actual time=0.006..0.006 rows=0 loops=100)" " Output: c_1.child_data" " Index Cond: (c_1.parent_id = p.parent_id)" " Filter: (c_1.partition_id = p.partition_id)" " Buffers: shared hit=297 read=3" " -&gt; Index Scan using child_2_parent_id_idx on public.child_2 c_2 (cost=0.43..8.59 rows=8 width=73) (actual time=0.011..0.011 rows=2 loops=100)" " Output: c_2.child_data" " Index Cond: (c_2.parent_id = p.parent_id)" " Filter: (c_2.partition_id = p.partition_id)" " Buffers: shared hit=384 read=7" " -&gt; Index Scan using child_3_parent_id_idx on public.child_3 c_3 (cost=0.43..8.59 rows=8 width=73) (actual time=0.007..0.007 rows=0 loops=100)" " Output: c_3.child_data" " Index Cond: (c_3.parent_id = p.parent_id)" " Filter: (c_3.partition_id = p.partition_id)" " Buffers: shared hit=297 read=3" "Planning time: 15.798 ms" "Execution time: 2.988 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pg_pathman: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=0.00..865.96 rows=100 width=314) (actual time=0.672..1.692 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, ((SubPlan 1))" " Buffers: shared hit=384 read=9" ... "Planning time: 17.897 ms" "Execution time: 1.774 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=0.00..865.96 rows=100 width=314) (actual time=0.672..1.692 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, ((SubPlan 1))" " Buffers: shared hit=384 read=9" " -&gt; Result (cost=0.00..57719674.22 rows=6665412 width=314) (actual time=0.670..1.683 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, (SubPlan 1)" " Buffers: shared hit=384 read=9" " -&gt; Append (cost=0.00..179266.65 rows=6665412 width=84) (actual time=0.126..0.270 rows=100 loops=1)" " Buffers: shared read=2" " -&gt; Seq Scan on public.parent_2 p (cost=0.00..89650.83 rows=3333266 width=84) (actual time=0.124..0.257 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Filter: (p.partition_id = ANY ('{2,3}'::numeric[]))" " Buffers: shared read=2" " -&gt; Seq Scan on public.parent_3 p_1 (cost=0.00..89615.83 rows=3332146 width=84) (never executed)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Filter: (p_1.partition_id = ANY ('{2,3}'::numeric[]))" " SubPlan 1" " -&gt; Aggregate (cost=8.61..8.62 rows=1 width=32) (actual time=0.013..0.014 rows=1 loops=100)" " Output: min((c.child_data)::text)" " Buffers: shared hit=384 read=7" " -&gt; Custom Scan (RuntimeAppend) (cost=0.43..8.59 rows=8 width=218) (actual time=0.010..0.010 rows=2 loops=100)" " Output: c.child_data" " Prune by: (c.partition_id = p.partition_id)" " Buffers: shared hit=384 read=7" " -&gt; Index Scan using child_2_parent_id_idx on public.child_2 c_1 (cost=0.43..8.59 rows=8 width=73) (actual time=0.009..0.010 rows=2 loops=100)" " Output: c_1.child_data, c_1.partition_id" " Index Cond: (c_1.parent_id = p.parent_id)" " Filter: (c_1.partition_id = p.partition_id)" " Buffers: shared hit=384 read=7" "Planning time: 17.897 ms" "Execution time: 1.774 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partitioning key from the table: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> *, (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(p.parent_data) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> r.partition_id = p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r.parent_id = p.parent_id) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.result r <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> r.result_id = <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> postgres: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=0.00..2743.60 rows=100 width=48) (actual time=1.751..41.373 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, ((SubPlan 1))" " Buffers: shared hit=655 read=409" ... "Planning time: 10.229 ms" "Execution time: 41.462 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=0.00..2743.60 rows=100 width=48) (actual time=1.751..41.373 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, ((SubPlan 1))" " Buffers: shared hit=655 read=409" " -&gt; Seq Scan on public.result r (cost=0.00..250463.09 rows=9129 width=48) (actual time=1.748..41.339 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, (SubPlan 1)" " Filter: (r.result_id = '50'::numeric)" " Rows Removed by Filter: 9709" " Buffers: shared hit=655 read=409" " SubPlan 1" " -&gt; Aggregate (cost=25.36..25.37 rows=1 width=32) (actual time=0.382..0.382 rows=1 loops=100)" " Output: min((p.parent_data)::text)" " Buffers: shared hit=655 read=346" " -&gt; Append (cost=0.00..25.35 rows=4 width=109) (actual time=0.221..0.379 rows=1 loops=100)" " Buffers: shared hit=655 read=346" " -&gt; Seq Scan on public.parent p (cost=0.00..0.00 rows=1 width=218) (actual time=0.000..0.000 rows=0 loops=100)" " Output: p.parent_data" " Filter: ((r.partition_id = p.partition_id) AND (r.parent_id = p.parent_id))" " -&gt; Index Scan using parent_1_pkey on public.parent_1 p_1 (cost=0.43..8.45 rows=1 width=73) (actual time=0.218..0.219 rows=1 loops=100)" " Output: p_1.parent_data" " Index Cond: (r.parent_id = p_1.parent_id)" " Filter: (r.partition_id = p_1.partition_id)" " Buffers: shared hit=222 read=178" " -&gt; Index Scan using parent_2_pkey on public.parent_2 p_2 (cost=0.43..8.45 rows=1 width=73) (actual time=0.078..0.078 rows=0 loops=100)" " Output: p_2.parent_data" " Index Cond: (r.parent_id = p_2.parent_id)" " Filter: (r.partition_id = p_2.partition_id)" " Buffers: shared hit=216 read=85" " -&gt; Index Scan using parent_3_pkey on public.parent_3 p_3 (cost=0.43..8.45 rows=1 width=73) (actual time=0.077..0.077 rows=0 loops=100)" " Output: p_3.parent_data" " Index Cond: (r.parent_id = p_3.parent_id)" " Filter: (r.partition_id = p_3.partition_id)" " Buffers: shared hit=217 read=83" "Planning time: 10.229 ms" "Execution time: 41.462 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pg_pathman: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=0.00..1052.85 rows=100 width=48) (actual time=0.946..27.732 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, ((SubPlan 1))" " Buffers: shared hit=222 read=241" ... "Planning time: 13.332 ms" "Executiontime: 27.792 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=0.00..1052.85 rows=100 width=48) (actual time=0.946..27.732 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, ((SubPlan 1))" " Buffers: shared hit=222 read=241" " -&gt; Seq Scan on public.result r (cost=0.00..96114.52 rows=9129 width=48) (actual time=0.944..27.685 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, (SubPlan 1)" " Filter: (r.result_id = '50'::numeric)" " Rows Removed by Filter: 9709" " Buffers: shared hit=222 read=241" " SubPlan 1" " -&gt; Aggregate (cost=8.45..8.46 rows=1 width=32) (actual time=0.245..0.245 rows=1 loops=100)" " Output: min((p.parent_data)::text)" " Buffers: shared hit=222 read=178" " -&gt; Custom Scan (RuntimeAppend) (cost=0.43..8.45 rows=1 width=218) (actual time=0.232..0.233 rows=1 loops=100)" " Output: p.parent_data" " Prune by: (r.partition_id = p.partition_id)" " Buffers: shared hit=222 read=178" " -&gt; Index Scan using parent_1_pkey on public.parent_1 p_1 (cost=0.43..8.45 rows=1 width=73) (actual time=0.230..0.231 rows=1 loops=100)" " Output: p_1.parent_data, p_1.partition_id" " Index Cond: (r.parent_id = p_1.parent_id)" " Filter: (r.partition_id = p_1.partition_id)" " Buffers: shared hit=222 read=178" "Planning time: 13.332 ms" "Executiontime: 27.792 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But everything is more interesting with the subquery: in the standard mode, forwarding the constant to the subquery did not work, and all the partitions get over there. </font><font style="vertical-align: inherit;">pg_pathman also includes its RuntimeAppend step, and as a result, queries iterate over 400-500 blocks instead of 1000. For a larger number of partitions, the efficiency will increase. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The second query showed one interesting feature of the Append postgres step: it can be seen that Part 3 was not viewed (never executed), that is, the step found the required hundred entries in the second partition, and did not go into the third one.</font></font><br><br><h3>  7.3.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Query with join with partitioned tables connected through union </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> One constant in the partitioning key condition: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p, ( <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> partition_id, parent_id, parent_data <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> partition_id, parent_id, child_data <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.child ) u <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> u.partition_id = p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> u.parent_id = p.parent_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> p.partition_id = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> postgres: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=1.72..12.33 rows=100 width=168) (actual time=1.448..1.795 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, parent.partition_id, parent.parent_id, parent.parent_data" " Buffers: shared hit=9 read=9" ... "Planning time: 10.951 ms" "Execution time: 1.945 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=1.72..12.33 rows=100 width=168) (actual time=1.448..1.795 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, parent.partition_id, parent.parent_id, parent.parent_data" " Buffers: shared hit=9 read=9" " -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.72</span></span>.<span class="hljs-number"><span class="hljs-number">.1060723</span></span><span class="hljs-number"><span class="hljs-number">.28</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">9994523</span></span> width=<span class="hljs-number"><span class="hljs-number">168</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.447</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.785</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id, parent.partition_id, parent.parent_id, parent.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Cond: (p.parent_id = parent.parent_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.56</span></span>.<span class="hljs-number"><span class="hljs-number">.184533</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332147</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.660</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.677</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">32</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: p.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent p (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.003</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.003</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 p_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142873</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.656</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.667</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">32</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p_1.parent_id, p_1.parent_data, p_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p_1.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Materialize (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.15</span></span>.<span class="hljs-number"><span class="hljs-number">.742928</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">9994523</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.781</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.064</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent.partition_id, parent.parent_id, parent.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.15</span></span>.<span class="hljs-number"><span class="hljs-number">.717941</span></span><span class="hljs-number"><span class="hljs-number">.88</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">9994523</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.773</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.025</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: parent.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.004</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.004</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent.partition_id, parent.parent_id, parent.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (parent.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142873</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.008</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.023</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">33</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_3.partition_id, parent_3.parent_id, parent_3.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (parent_3.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ix_child_parent <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.004</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.004</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child.partition_id, child.parent_id, child.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (child.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_3_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.350175</span></span><span class="hljs-number"><span class="hljs-number">.59</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.755</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.953</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">68</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child_3.partition_id, child_3.parent_id, child_3.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (child_3.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span>Planning <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">10.951</span></span> ms<span class="hljs-string"><span class="hljs-string">" "</span></span>Execution <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">1.945</span></span> ms<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pg_pathman: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=1.31..794053.33 rows=2 width=564) (actual time=0.926..1.108 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, parent_3.partition_id, parent_3.parent_id, parent_3.parent_data" " Buffers: shared hit=6 read=9" ... "Planning time: 13.963 ms" "Executiontime: 1.197 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=1.31..794053.33 rows=2 width=564) (actual time=0.926..1.108 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, parent_3.partition_id, parent_3.parent_id, parent_3.parent_data" " Buffers: shared hit=6 read=9" " -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.31</span></span>.<span class="hljs-number"><span class="hljs-number">.794053</span></span><span class="hljs-number"><span class="hljs-number">.33</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">2</span></span> width=<span class="hljs-number"><span class="hljs-number">564</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.925</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.097</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id, parent_3.partition_id, parent_3.parent_id, parent_3.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Cond: (p.parent_id = parent_3.parent_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.44</span></span>.<span class="hljs-number"><span class="hljs-number">.142832</span></span><span class="hljs-number"><span class="hljs-number">.56</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.435</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.448</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">32</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: p.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 p (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142832</span></span><span class="hljs-number"><span class="hljs-number">.55</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.435</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.445</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">32</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Materialize (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.87</span></span>.<span class="hljs-number"><span class="hljs-number">.517958</span></span><span class="hljs-number"><span class="hljs-number">.89</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">9994521</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.482</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.609</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_3.partition_id, parent_3.parent_id, parent_3.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.87</span></span>.<span class="hljs-number"><span class="hljs-number">.492972</span></span><span class="hljs-number"><span class="hljs-number">.59</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">9994521</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.477</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.586</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: parent_3.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142832</span></span><span class="hljs-number"><span class="hljs-number">.55</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.008</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.017</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">33</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_3.partition_id, parent_3.parent_id, parent_3.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (parent_3.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_3_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.350140</span></span><span class="hljs-number"><span class="hljs-number">.00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.469</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.549</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">68</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child_3.partition_id, child_3.parent_id, child_3.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (child_3.partition_id = <span class="hljs-string"><span class="hljs-string">'3'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span>Planning <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">13.963</span></span> ms<span class="hljs-string"><span class="hljs-string">" "</span></span>Executiontime: <span class="hljs-number"><span class="hljs-number">1.197</span></span> ms<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Two constants in the partitioning key condition: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p, ( <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> partition_id, parent_id, parent_data <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> partition_id, parent_id, child_data <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.child ) u <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> u.partition_id = p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> u.parent_id = p.parent_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> postgres: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=3.97..2222.49 rows=100 width=168) (actual time=6.006..6.250 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, parent.partition_id, parent.parent_id, parent.parent_data" " Buffers: shared hit=11 read=24" ... "Planning time: 15.399 ms" "Execution time: 6.391 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=3.97..2222.49 rows=100 width=168) (actual time=6.006..6.250 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, parent.partition_id, parent.parent_id, parent.parent_data" " Buffers: shared hit=11 read=24" " -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">3.97</span></span>.<span class="hljs-number"><span class="hljs-number">.3327548</span></span><span class="hljs-number"><span class="hljs-number">.38</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">149989</span></span> width=<span class="hljs-number"><span class="hljs-number">168</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">6.006</span></span>.<span class="hljs-number"><span class="hljs-number">.6</span></span><span class="hljs-number"><span class="hljs-number">.235</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id, parent.partition_id, parent.parent_id, parent.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Cond: (p.parent_id = parent.parent_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> Filter: (p.partition_id = parent.partition_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">24</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">1.01</span></span>.<span class="hljs-number"><span class="hljs-number">.408151</span></span><span class="hljs-number"><span class="hljs-number">.48</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6665413</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.012</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.029</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">35</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: p.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent p (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.003</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.003</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_2_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_2 p_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142962</span></span><span class="hljs-number"><span class="hljs-number">.29</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3333266</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.516</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.520</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">18</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p_1.parent_id, p_1.parent_data, p_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p_1.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 p_2 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142873</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.491</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.500</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">18</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p_2.parent_id, p_2.parent_data, p_2.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p_2.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Materialize (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">2.96</span></span>.<span class="hljs-number"><span class="hljs-number">.2452767</span></span><span class="hljs-number"><span class="hljs-number">.42</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">29997730</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">4.978</span></span>.<span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.135</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">173</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent.partition_id, parent.parent_id, parent.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">16</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">2.96</span></span>.<span class="hljs-number"><span class="hljs-number">.2377773</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">29997730</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">4.964</span></span>.<span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.057</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">173</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: parent.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">16</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.003</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.003</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent.partition_id, parent.parent_id, parent.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_1_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.134721</span></span><span class="hljs-number"><span class="hljs-number">.74</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3334606</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.411</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.415</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">25</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_1.partition_id, parent_1.parent_id, parent_1.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_2_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_2 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.134629</span></span><span class="hljs-number"><span class="hljs-number">.12</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3333266</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.005</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.006</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">19</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_2.partition_id, parent_2.parent_id, parent_2.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.134542</span></span><span class="hljs-number"><span class="hljs-number">.83</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.005</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.010</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">18</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_3.partition_id, parent_3.parent_id, parent_3.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ix_child_parent <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.12</span></span>.<span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.001</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.001</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child.partition_id, child.parent_id, child.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_1_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.331794</span></span><span class="hljs-number"><span class="hljs-number">.06</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6666670</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">3.310</span></span>.<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.321</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">50</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child_1.partition_id, child_1.parent_id, child_1.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_2_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_2 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.333623</span></span><span class="hljs-number"><span class="hljs-number">.06</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6668665</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.553</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.553</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">29</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child_2.partition_id, child_2.parent_id, child_2.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_3_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.333519</span></span><span class="hljs-number"><span class="hljs-number">.65</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.670</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.679</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">37</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child_3.partition_id, child_3.parent_id, child_3.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span>Planning <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">15.399</span></span> ms<span class="hljs-string"><span class="hljs-string">" "</span></span>Execution <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">6.391</span></span> ms<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pg_pathman: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=3.54..2230075.76 rows=1 width=564) (actual time=3.679..4.028 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, parent_1.partition_id, parent_1.parent_id, parent_1.parent_data" " Buffers: shared hit=8 read=24" ... "Planning time: 20.042 ms" "Execution time: 4.162 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=3.54..2230075.76 rows=1 width=564) (actual time=3.679..4.028 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, parent_1.partition_id, parent_1.parent_id, parent_1.parent_data" " Buffers: shared hit=8 read=24" " -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">3.54</span></span>.<span class="hljs-number"><span class="hljs-number">.2230075</span></span><span class="hljs-number"><span class="hljs-number">.76</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> width=<span class="hljs-number"><span class="hljs-number">564</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">3.678</span></span>.<span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.014</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id, parent_1.partition_id, parent_1.parent_id, parent_1.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Cond: (p.parent_id = parent_1.parent_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> Filter: (p.partition_id = parent_1.partition_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">24</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.87</span></span>.<span class="hljs-number"><span class="hljs-number">.285722</span></span><span class="hljs-number"><span class="hljs-number">.16</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6665412</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.279</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.299</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">35</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: p.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_2_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_2 p (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142889</span></span><span class="hljs-number"><span class="hljs-number">.60</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3333266</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.492</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.498</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">18</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 p_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.142832</span></span><span class="hljs-number"><span class="hljs-number">.55</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.786</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.793</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">18</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p_1.parent_id, p_1.parent_data, p_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p_1.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Materialize (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">2.67</span></span>.<span class="hljs-number"><span class="hljs-number">.1477724</span></span><span class="hljs-number"><span class="hljs-number">.15</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">29997728</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">2.381</span></span>.<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.618</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">173</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_1.partition_id, parent_1.parent_id, parent_1.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">16</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">2.67</span></span>.<span class="hljs-number"><span class="hljs-number">.1402729</span></span><span class="hljs-number"><span class="hljs-number">.83</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">29997728</span></span> width=<span class="hljs-number"><span class="hljs-number">282</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">2.371</span></span>.<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.575</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">173</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: parent_1.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">16</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_1_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.134675</span></span><span class="hljs-number"><span class="hljs-number">.44</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3334606</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.482</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.508</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">25</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_1.partition_id, parent_1.parent_id, parent_1.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_2_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_2 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.134599</span></span><span class="hljs-number"><span class="hljs-number">.76</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3333266</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.007</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.016</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">19</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_2.partition_id, parent_2.parent_id, parent_2.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.134526</span></span><span class="hljs-number"><span class="hljs-number">.41</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">3332146</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.006</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.016</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">18</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: parent_3.partition_id, parent_3.parent_id, parent_3.parent_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_1_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.331789</span></span><span class="hljs-number"><span class="hljs-number">.90</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6666670</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.473</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.483</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">50</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child_1.partition_id, child_1.parent_id, child_1.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_2_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_2 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.333620</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6668665</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.716</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.724</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">29</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child_2.partition_id, child_2.parent_id, child_2.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_3_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.43</span></span>.<span class="hljs-number"><span class="hljs-number">.333517</span></span><span class="hljs-number"><span class="hljs-number">.99</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">6662375</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.679</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.691</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">37</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: child_3.partition_id, child_3.parent_id, child_3.child_data<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span>Planning <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">20.042</span></span> ms<span class="hljs-string"><span class="hljs-string">" "</span></span>Execution <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">4.162</span></span> ms<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partitioning key from the table: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.result r, ( <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> partition_id, parent_id, parent_data <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> partition_id, parent_id, child_data <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.child ) u <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> u.partition_id = r.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> u.parent_id = r.parent_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r.result_id = <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> postgres: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=199.17..27826.77 rows=100 width=100) (actual time=10.168..39.515 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, parent.partition_id, parent.parent_id, parent.parent_data" " Buffers: shared hit=393 read=271" ... "Planning time: 14.982 ms" "Execution time: 39.747 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=199.17..27826.77 rows=100 width=100) (actual time=10.168..39.515 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, parent.partition_id, parent.parent_id, parent.parent_data" " Buffers: shared hit=393 read=271" " -&gt; Nested Loop (cost=199.17..423453.93 rows=1532 width=100) (actual time=10.166..39.486 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, parent.partition_id, parent.parent_id, parent.parent_data" " Buffers: shared hit=393 read=271" " -&gt; Bitmap Heap Scan on public.result r (cost=199.17..7003.62 rows=9129 width=16) (actual time=9.257..10.275 rows=31 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id" " Recheck Cond: (r.result_id = '50'::numeric)" " Heap Blocks: exact=14" " Buffers: shared read=52" " -&gt; Bitmap Index Scan on idx_result (cost=0.00..196.89 rows=9129 width=0) (actual time=7.507..7.507 rows=10051 loops=1)" " Index Cond: (r.result_id = '50'::numeric)" " Buffers: shared read=38" " -&gt; Append (cost=0.00..45.33 rows=29 width=84) (actual time=0.249..0.939 rows=3 loops=31)" " Buffers: shared hit=393 read=219" " -&gt; Seq Scan on public.parent (cost=0.00..0.00 rows=1 width=282) (actual time=0.001..0.001 rows=0 loops=31)" " Output: parent.partition_id, parent.parent_id, parent.parent_data" " Filter: ((r.partition_id = parent.partition_id) AND (r.parent_id = parent.parent_id))" " -&gt; Index Scan using parent_1_pkey on public.parent_1 (cost=0.43..7.19 rows=1 width=84) (actual time=0.244..0.245 rows=1 loops=31)" " Output: parent_1.partition_id, parent_1.parent_id, parent_1.parent_data" " Index Cond: (parent_1.parent_id = r.parent_id)" " Filter: (r.partition_id = parent_1.partition_id)" " Buffers: shared hit=71 read=53" " -&gt; Index Scan using parent_2_pkey on public.parent_2 (cost=0.43..7.19 rows=1 width=84) (actual time=0.102..0.102 rows=0 loops=31)" " Output: parent_2.partition_id, parent_2.parent_id, parent_2.parent_data" " Index Cond: (parent_2.parent_id = r.parent_id)" " Filter: (r.partition_id = parent_2.partition_id)" " Buffers: shared hit=68 read=26" " -&gt; Index Scan using parent_3_pkey on public.parent_3 (cost=0.43..7.19 rows=1 width=84) (actual time=0.104..0.104 rows=0 loops=31)" " Output: parent_3.partition_id, parent_3.parent_id, parent_3.parent_data" " Index Cond: (parent_3.parent_id = r.parent_id)" " Filter: (r.partition_id = parent_3.partition_id)" " Buffers: shared hit=67 read=26" " -&gt; Seq Scan on public.child (cost=0.00..0.00 rows=1 width=282) (actual time=0.000..0.000 rows=0 loops=31)" " Output: child.partition_id, child.parent_id, child.child_data" " Filter: ((r.partition_id = child.partition_id) AND (r.parent_id = child.parent_id))" " -&gt; Index Scan using child_1_parent_id_idx on public.child_1 (cost=0.43..7.92 rows=8 width=84) (actual time=0.194..0.194 rows=2 loops=31)" " Output: child_1.partition_id, child_1.parent_id, child_1.child_data" " Index Cond: (child_1.parent_id = r.parent_id)" " Filter: (r.partition_id = child_1.partition_id)" " Buffers: shared hit=64 read=56" " -&gt; Index Scan using child_2_parent_id_idx on public.child_2 (cost=0.43..7.92 rows=8 width=84) (actual time=0.144..0.144 rows=0 loops=30)" " Output: child_2.partition_id, child_2.parent_id, child_2.child_data" " Index Cond: (child_2.parent_id = r.parent_id)" " Filter: (r.partition_id = child_2.partition_id)" " Buffers: shared hit=62 read=28" " -&gt; Index Scan using child_3_parent_id_idx on public.child_3 (cost=0.43..7.92 rows=8 width=84) (actual time=0.145..0.145 rows=0 loops=30)" " Output: child_3.partition_id, child_3.parent_id, child_3.child_data" " Index Cond: (child_3.parent_id = r.parent_id)" " Filter: (r.partition_id = child_3.partition_id)" " Buffers: shared hit=61 read=30" "Planning time: 14.982 ms" "Execution time: 39.747 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pg_pathman: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=199.60..411799.35 rows=1 width=298) (actual time=7.118..37.285 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, parent_1.partition_id, parent_1.parent_id, parent_1.parent_data" " Buffers: shared hit=393 read=271" ... "Planning time: 20.112 ms" "Executiontime: 37.466 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=199.60..411799.35 rows=1 width=298) (actual time=7.118..37.285 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, parent_1.partition_id, parent_1.parent_id, parent_1.parent_data" " Buffers: shared hit=393 read=271" " -&gt; Nested Loop (cost=199.60..411799.35 rows=1 width=298) (actual time=7.115..37.259 rows=100 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id, parent_1.partition_id, parent_1.parent_id, parent_1.parent_data" " Buffers: shared hit=393 read=271" " -&gt; Bitmap Heap Scan on public.result r (cost=199.17..7003.62 rows=9129 width=16) (actual time=6.511..7.714 rows=31 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id" " Recheck Cond: (r.result_id = '50'::numeric)" " Heap Blocks: exact=14" " Buffers: shared read=52" " -&gt; Bitmap Index Scan on idx_result (cost=0.00..196.89 rows=9129 width=0) (actual time=5.642..5.642 rows=10051 loops=1)" " Index Cond: (r.result_id = '50'::numeric)" " Buffers: shared read=38" " -&gt; Append (cost=0.43..44.07 rows=27 width=282) (actual time=0.209..0.950 rows=3 loops=31)" " Buffers: shared hit=393 read=219" " -&gt; Index Scan using parent_1_pkey on public.parent_1 (cost=0.43..6.77 rows=1 width=84) (actual time=0.207..0.208 rows=1 loops=31)" " Output: parent_1.partition_id, parent_1.parent_id, parent_1.parent_data" " Index Cond: (parent_1.parent_id = r.parent_id)" " Filter: (r.partition_id = parent_1.partition_id)" " Buffers: shared hit=71 read=53" " -&gt; Index Scan using parent_2_pkey on public.parent_2 (cost=0.43..6.77 rows=1 width=84) (actual time=0.102..0.102 rows=0 loops=31)" " Output: parent_2.partition_id, parent_2.parent_id, parent_2.parent_data" " Index Cond: (parent_2.parent_id = r.parent_id)" " Filter: (r.partition_id = parent_2.partition_id)" " Buffers: shared hit=68 read=26" " -&gt; Index Scan using parent_3_pkey on public.parent_3 (cost=0.43..6.77 rows=1 width=84) (actual time=0.121..0.121 rows=0 loops=31)" " Output: parent_3.partition_id, parent_3.parent_id, parent_3.parent_data" " Index Cond: (parent_3.parent_id = r.parent_id)" " Filter: (r.partition_id = parent_3.partition_id)" " Buffers: shared hit=67 read=26" " -&gt; Index Scan using child_1_parent_id_idx on public.child_1 (cost=0.43..7.92 rows=8 width=84) (actual time=0.260..0.261 rows=2 loops=31)" " Output: child_1.partition_id, child_1.parent_id, child_1.child_data" " Index Cond: (child_1.parent_id = r.parent_id)" " Filter: (r.partition_id = child_1.partition_id)" " Buffers: shared hit=64 read=56" " -&gt; Index Scan using child_2_parent_id_idx on public.child_2 (cost=0.43..7.92 rows=8 width=84) (actual time=0.125..0.125 rows=0 loops=30)" " Output: child_2.partition_id, child_2.parent_id, child_2.child_data" " Index Cond: (child_2.parent_id = r.parent_id)" " Filter: (r.partition_id = child_2.partition_id)" " Buffers: shared hit=62 read=28" " -&gt; Index Scan using child_3_parent_id_idx on public.child_3 (cost=0.43..7.92 rows=8 width=84) (actual time=0.129..0.129 rows=0 loops=30)" " Output: child_3.partition_id, child_3.parent_id, child_3.child_data" " Index Cond: (child_3.parent_id = r.parent_id)" " Filter: (r.partition_id = child_3.partition_id)" " Buffers: shared hit=61 read=30" "Planning time: 20.112 ms" "Executiontime: 37.466 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In connection with the union subquery, one constant worked and limited the partitions used, pg_pathman only removed the main tables from consideration, without changing the structure of the plan. </font><font style="vertical-align: inherit;">In a two-constant query, the constant values ‚Äã‚Äãonly affected the parent table and its partitions; the subquery was not optimized with and without the extension. </font><font style="vertical-align: inherit;">In the third request, the RuntimeAppend step did not appear and the difference with the standard partitioning is not significant. </font><font style="vertical-align: inherit;">That is, there is still the possibility of using pg_pathman.</font></font><br><br><h3>  7.4.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Request by condition </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> One constant in the partitioning key condition: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * frompublic.parent p <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> (p.partition_id, p.parent_id) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> c.partition_id, c.parent_id <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.child c <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> c.child_index = <span class="hljs-number"><span class="hljs-number">5000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.partition_id = <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> postgres: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=273.21..858.33 rows=69 width=84) (actual time=5.816..30.351 rows=82 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=134 read=279" ... "Planning time: 16.899 ms" "Execution time: 30.710 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=273.21..858.33 rows=69 width=84) (actual time=5.816..30.351 rows=82 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=134 read=279" " -&gt; Nested Loop (cost=273.21..858.33 rows=69 width=84) (actual time=5.807..30.321 rows=82 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=134 read=279" " -&gt; HashAggregate (cost=273.21..273.90 rows=69 width=12) (actual time=5.228..5.276 rows=82 loops=1)" " Output: c.partition_id, c.parent_id" " Group Key: c.partition_id, c.parent_id" " Buffers: shared read=85" " -&gt; Append (cost=0.00..272.87 rows=69 width=12) (actual time=1.185..5.143 rows=82 loops=1)" " Buffers: shared read=85" " -&gt; Seq Scan on public.child c (cost=0.00..0.00 rows=1 width=64) (actual time=0.005..0.005 rows=0 loops=1)" " Output: c.partition_id, c.parent_id" " Filter: ((c.child_index = '5000'::numeric) AND (c.partition_id = '3'::numeric))" " -&gt; Bitmap Heap Scan on public.child_3 c_1 (cost=4.96..272.87 rows=68 width=11) (actual time=1.180..5.118 rows=82 loops=1)" " Output: c_1.partition_id, c_1.parent_id" " Recheck Cond: (c_1.child_index = '5000'::numeric)" " Filter: (c_1.partition_id = '3'::numeric)" " Heap Blocks: exact=82" " Buffers: shared read=85" " -&gt; Bitmap Index Scan on child_3_child_index_idx (cost=0.00..4.94 rows=68 width=0) (actual time=1.120..1.120 rows=82 loops=1)" " Index Cond: (c_1.child_index = '5000'::numeric)" " Buffers: shared read=3" " -&gt; Append (cost=0.00..8.45 rows=2 width=84) (actual time=0.302..0.304 rows=1 loops=82)" " Buffers: shared hit=134 read=194" " -&gt; Seq Scan on public.parent p (cost=0.00..0.00 rows=1 width=282) (actual time=0.000..0.000 rows=0 loops=82)" " Output: p.parent_id, p.parent_data, p.partition_id" " Filter: ((p.partition_id = '3'::numeric) AND (c.parent_id = p.parent_id))" " -&gt; Index Scan using parent_3_pkey on public.parent_3 p_1 (cost=0.43..8.45 rows=1 width=84) (actual time=0.299..0.300 rows=1 loops=82)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Index Cond: (p_1.parent_id = c.parent_id)" " Filter: (p_1.partition_id = '3'::numeric)" " Buffers: shared hit=134 read=194" "Planning time: 16.899 ms" "Execution time: 30.710 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pg_pathman: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=273.64..849.17 rows=68 width=282) (actual time=11.865..34.016 rows=82 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=134 read=279" ... "Planning time: 21.265 ms" "Executiontime: 34.098 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=273.64..849.17 rows=68 width=282) (actual time=11.865..34.016 rows=82 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=134 read=279" " -&gt; Nested Loop (cost=273.64..849.17 rows=68 width=282) (actual time=11.862..33.985 rows=82 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=134 read=279" " -&gt; HashAggregate (cost=273.21..273.89 rows=68 width=11) (actual time=11.323..11.364 rows=82 loops=1)" " Output: c.partition_id, c.parent_id" " Group Key: c.partition_id, c.parent_id" " Buffers: shared read=85" " -&gt; Append (cost=4.96..272.87 rows=68 width=11) (actual time=1.940..11.150 rows=82 loops=1)" " Buffers: shared read=85" " -&gt; Bitmap Heap Scan on public.child_3 c (cost=4.96..272.87 rows=68 width=11) (actual time=1.938..11.132 rows=82 loops=1)" " Output: c.partition_id, c.parent_id" " Recheck Cond: (c.child_index = '5000'::numeric)" " Filter: (c.partition_id = '3'::numeric)" " Heap Blocks: exact=82" " Buffers: shared read=85" " -&gt; Bitmap Index Scan on child_3_child_index_idx (cost=0.00..4.94 rows=68 width=0) (actual time=1.655..1.655 rows=82 loops=1)" " Index Cond: (c.child_index = '5000'::numeric)" " Buffers: shared read=3" " -&gt; Append (cost=0.43..8.45 rows=1 width=84) (actual time=0.274..0.275 rows=1 loops=82)" " Buffers: shared hit=134 read=194" " -&gt; Index Scan using parent_3_pkey on public.parent_3 p (cost=0.43..8.45 rows=1 width=84) (actual time=0.273..0.274 rows=1 loops=82)" " Output: p.parent_id, p.parent_data, p.partition_id" " Index Cond: (p.parent_id = c.parent_id)" " Filter: (p.partition_id = '3'::numeric)" " Buffers: shared hit=134 read=194" "Planning time: 21.265 ms" "Executiontime: 34.098 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Two constants in the partitioning key condition: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> (p.partition_id, p.parent_id) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> c.partition_id, c.parent_id <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.child c <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> c.child_index = <span class="hljs-number"><span class="hljs-number">5000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.partition_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> postgres: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=538.59..3078.59 rows=100 width=84) (actual time=20.449..90.114 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=510 read=642" ... "Planning time: 14.024 ms" "Execution time: 90.484 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=538.59..3078.59 rows=100 width=84) (actual time=20.449..90.114 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=510 read=642" " -&gt; Nested Loop (cost=538.59..3967.59 rows=135 width=84) (actual time=20.446..90.045 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=510 read=642" " -&gt; HashAggregate (cost=538.59..539.94 rows=135 width=11) (actual time=19.387..19.486 rows=100 loops=1)" " Output: c.partition_id, c.parent_id" " Group Key: c.partition_id, c.parent_id" " Buffers: shared read=155" " -&gt; Append (cost=0.00..537.91 rows=135 width=11) (actual time=1.090..19.200 rows=149 loops=1)" " Buffers: shared read=155" " -&gt; Seq Scan on public.child c (cost=0.00..0.00 rows=1 width=64) (actual time=0.005..0.005 rows=0 loops=1)" " Output: c.partition_id, c.parent_id" " Filter: ((c.partition_id = ANY ('{2,3}'::numeric[])) AND (c.child_index = '5000'::numeric))" " -&gt; Bitmap Heap Scan on public.child_2 c_1 (cost=4.94..265.05 rows=66 width=11) (actual time=1.083..5.456 rows=67 loops=1)" " Output: c_1.partition_id, c_1.parent_id" " Recheck Cond: (c_1.child_index = '5000'::numeric)" " Filter: (c_1.partition_id = ANY ('{2,3}'::numeric[]))" " Heap Blocks: exact=67" " Buffers: shared read=70" " -&gt; Bitmap Index Scan on child_2_child_index_idx (cost=0.00..4.93 rows=66 width=0) (actual time=1.003..1.003 rows=67 loops=1)" " Index Cond: (c_1.child_index = '5000'::numeric)" " Buffers: shared read=3" " -&gt; Bitmap Heap Scan on public.child_3 c_2 (cost=4.96..272.87 rows=68 width=11) (actual time=1.271..13.668 rows=82 loops=1)" " Output: c_2.partition_id, c_2.parent_id" " Recheck Cond: (c_2.child_index = '5000'::numeric)" " Filter: (c_2.partition_id = ANY ('{2,3}'::numeric[]))" " Heap Blocks: exact=82" " Buffers: shared read=85" " -&gt; Bitmap Index Scan on child_3_child_index_idx (cost=0.00..4.94 rows=68 width=0) (actual time=0.781..0.781 rows=82 loops=1)" " Index Cond: (c_2.child_index = '5000'::numeric)" " Buffers: shared read=3" " -&gt; Append (cost=0.00..25.35 rows=4 width=84) (actual time=0.615..0.704 rows=1 loops=100)" " Buffers: shared hit=510 read=487" " -&gt; Seq Scan on public.parent p (cost=0.00..0.00 rows=1 width=282) (actual time=0.000..0.000 rows=0 loops=100)" " Output: p.parent_id, p.parent_data, p.partition_id" " Filter: ((c.partition_id = p.partition_id) AND (c.parent_id = p.parent_id))" " -&gt; Index Scan using parent_1_pkey on public.parent_1 p_1 (cost=0.43..8.45 rows=1 width=84) (actual time=0.193..0.193 rows=0 loops=100)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Index Cond: (p_1.parent_id = c.parent_id)" " Filter: (c.partition_id = p_1.partition_id)" " Buffers: shared hit=171 read=129" " -&gt; Index Scan using parent_2_pkey on public.parent_2 p_2 (cost=0.43..8.45 rows=1 width=84) (actual time=0.225..0.225 rows=0 loops=100)" " Output: p_2.parent_id, p_2.parent_data, p_2.partition_id" " Index Cond: (p_2.parent_id = c.parent_id)" " Filter: (c.partition_id = p_2.partition_id)" " Buffers: shared hit=170 read=172" " -&gt; Index Scan using parent_3_pkey on public.parent_3 p_3 (cost=0.43..8.45 rows=1 width=84) (actual time=0.280..0.280 rows=1 loops=99)" " Output: p_3.parent_id, p_3.parent_data, p_3.partition_id" " Index Cond: (p_3.parent_id = c.parent_id)" " Filter: (c.partition_id = p_3.partition_id)" " Buffers: shared hit=169 read=186" "Planning time: 14.024 ms" "Execution time: 90.484 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pg_pathman: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=539.01..1385.69 rows=100 width=282) (actual time=17.913..48.317 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=152 read=403" ... "Planning time: 14.037 ms" "Execution time: 48.413 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=539.01..1385.69 rows=100 width=282) (actual time=17.913..48.317 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=152 read=403" " -&gt; Nested Loop (cost=539.01..1673.56 rows=134 width=282) (actual time=17.911..48.286 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=152 read=403" " -&gt; HashAggregate (cost=538.58..539.92 rows=134 width=11) (actual time=17.359..17.411 rows=100 loops=1)" " Output: c.partition_id, c.parent_id" " Group Key: c.partition_id, c.parent_id" " Buffers: shared read=155" " -&gt; Append (cost=4.94..537.91 rows=134 width=11) (actual time=0.503..17.149 rows=149 loops=1)" " Buffers: shared read=155" " -&gt; Bitmap Heap Scan on public.child_2 c (cost=4.94..265.05 rows=66 width=11) (actual time=0.503..7.763 rows=67 loops=1)" " Output: c.partition_id, c.parent_id" " Recheck Cond: (c.child_index = '5000'::numeric)" " Filter: (c.partition_id = ANY ('{2,3}'::numeric[]))" " Heap Blocks: exact=67" " Buffers: shared read=70" " -&gt; Bitmap Index Scan on child_2_child_index_idx (cost=0.00..4.93 rows=66 width=0) (actual time=0.392..0.392 rows=67 loops=1)" " Index Cond: (c.child_index = '5000'::numeric)" " Buffers: shared read=3" " -&gt; Bitmap Heap Scan on public.child_3 c_1 (cost=4.96..272.87 rows=68 width=11) (actual time=0.591..9.346 rows=82 loops=1)" " Output: c_1.partition_id, c_1.parent_id" " Recheck Cond: (c_1.child_index = '5000'::numeric)" " Filter: (c_1.partition_id = ANY ('{2,3}'::numeric[]))" " Heap Blocks: exact=82" " Buffers: shared read=85" " -&gt; Bitmap Index Scan on child_3_child_index_idx (cost=0.00..4.94 rows=68 width=0) (actual time=0.357..0.357 rows=82 loops=1)" " Index Cond: (c_1.child_index = '5000'::numeric)" " Buffers: shared read=3" " -&gt; Custom Scan (RuntimeAppend) (cost=0.43..8.45 rows=1 width=84) (actual time=0.299..0.300 rows=1 loops=100)" " Output: p.parent_id, p.parent_data, p.partition_id" " Prune by: (c.partition_id = p.partition_id)" " Buffers: shared hit=152 read=248" " -&gt; Index Scan using parent_2_pkey on public.parent_2 p_1 (cost=0.43..8.45 rows=1 width=84) (actual time=0.293..0.293 rows=1 loops=42)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Index Cond: (p_1.parent_id = c.parent_id)" " Filter: (c.partition_id = p_1.partition_id)" " Buffers: shared hit=62 read=106" " -&gt; Index Scan using parent_3_pkey on public.parent_3 p_2 (cost=0.43..8.45 rows=1 width=84) (actual time=0.301..0.302 rows=1 loops=58)" " Output: p_2.parent_id, p_2.parent_data, p_2.partition_id" " Index Cond: (p_2.parent_id = c.parent_id)" " Filter: (c.partition_id = p_2.partition_id)" " Buffers: shared hit=90 read=142" "Planning time: 14.037 ms" "Execution time: 48.413 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partitioning key from the table: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> (p.partition_id, p.parent_id) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> r.partition_id, r.parent_id <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.result r <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> r.result_id = <span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> postgres: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=7049.27..9084.40 rows=100 width=84) (actual time=593.094..692.189 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=506 read=5583" ... "Planning time: 8.554 ms" "Execution time: 692.468 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=7049.27..9084.40 rows=100 width=84) (actual time=593.094..692.189 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=506 read=5583" " -&gt; Nested Loop (cost=7049.27..192836.06 rows=9129 width=84) (actual time=593.091..692.134 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=506 read=5583" " -&gt; HashAggregate (cost=7049.27..7140.51 rows=9124 width=11) (actual time=592.396..592.519 rows=100 loops=1)" " Output: r.partition_id, r.parent_id" " Group Key: r.partition_id, r.parent_id" " Buffers: shared read=5094" " -&gt; Bitmap Heap Scan on public.result r (cost=199.17..7003.62 rows=9129 width=11) (actual time=10.049..576.423 rows=10051 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id" " Recheck Cond: (r.result_id = '50'::numeric)" " Heap Blocks: exact=5056" " Buffers: shared read=5094" " -&gt; Bitmap Index Scan on idx_result (cost=0.00..196.89 rows=9129 width=0) (actual time=9.087..9.087 rows=10051 loops=1)" " Index Cond: (r.result_id = '50'::numeric)" " Buffers: shared read=38" " -&gt; Append (cost=0.00..20.31 rows=4 width=84) (actual time=0.733..0.994 rows=1 loops=100)" " Buffers: shared hit=506 read=489" " -&gt; Seq Scan on public.parent p (cost=0.00..0.00 rows=1 width=282) (actual time=0.000..0.000 rows=0 loops=100)" " Output: p.parent_id, p.parent_data, p.partition_id" " Filter: ((r.partition_id = p.partition_id) AND (r.parent_id = p.parent_id))" " -&gt; Index Scan using parent_1_pkey on public.parent_1 p_1 (cost=0.43..6.77 rows=1 width=84) (actual time=0.315..0.316 rows=0 loops=100)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Index Cond: (p_1.parent_id = r.parent_id)" " Filter: (r.partition_id = p_1.partition_id)" " Buffers: shared hit=170 read=158" " -&gt; Index Scan using parent_2_pkey on public.parent_2 p_2 (cost=0.43..6.77 rows=1 width=84) (actual time=0.355..0.358 rows=0 loops=99)" " Output: p_2.parent_id, p_2.parent_data, p_2.partition_id" " Index Cond: (p_2.parent_id = r.parent_id)" " Filter: (r.partition_id = p_2.partition_id)" " Buffers: shared hit=168 read=170" " -&gt; Index Scan using parent_3_pkey on public.parent_3 p_3 (cost=0.43..6.77 rows=1 width=84) (actual time=0.318..0.319 rows=0 loops=99)" " Output: p_3.parent_id, p_3.parent_data, p_3.partition_id" " Index Cond: (p_3.parent_id = r.parent_id)" " Filter: (r.partition_id = p_3.partition_id)" " Buffers: shared hit=168 read=161" "Planning time: 8.554 ms" "Execution time: 692.468 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pg_pathman: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=7049.70..7728.77 rows=100 width=282) (actual time=531.946..564.520 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=137 read=5358" ... "Planning time: 8.863 ms" "Executiontime: 564.741 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=7049.70..7728.77 rows=100 width=282) (actual time=531.946..564.520 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=137 read=5358" " -&gt; Nested Loop (cost=7049.70..69008.61 rows=9124 width=282) (actual time=531.943..564.483 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id" " Buffers: shared hit=137 read=5358" " -&gt; HashAggregate (cost=7049.27..7140.51 rows=9124 width=11) (actual time=531.407..531.479 rows=100 loops=1)" " Output: r.partition_id, r.parent_id" " Group Key: r.partition_id, r.parent_id" " Buffers: shared read=5094" " -&gt; Bitmap Heap Scan on public.result r (cost=199.17..7003.62 rows=9129 width=11) (actual time=11.477..518.114 rows=10051 loops=1)" " Output: r.result_id, r.parent_id, r.partition_id" " Recheck Cond: (r.result_id = '50'::numeric)" " Heap Blocks: exact=5056" " Buffers: shared read=5094" " -&gt; Bitmap Index Scan on idx_result (cost=0.00..196.89 rows=9129 width=0) (actual time=10.655..10.655 rows=10051 loops=1)" " Index Cond: (r.result_id = '50'::numeric)" " Buffers: shared read=38" " -&gt; Custom Scan (RuntimeAppend) (cost=0.43..6.77 rows=1 width=84) (actual time=0.320..0.322 rows=1 loops=100)" " Output: p.parent_id, p.parent_data, p.partition_id" " Prune by: (r.partition_id = p.partition_id)" " Buffers: shared hit=137 read=264" " -&gt; Index Scan using parent_1_pkey on public.parent_1 p_1 (cost=0.43..6.77 rows=1 width=84) (actual time=0.329..0.330 rows=1 loops=28)" " Output: p_1.parent_id, p_1.parent_data, p_1.partition_id" " Index Cond: (p_1.parent_id = r.parent_id)" " Filter: (r.partition_id = p_1.partition_id)" " Buffers: shared hit=37 read=75" " -&gt; Index Scan using parent_2_pkey on public.parent_2 p_2 (cost=0.43..6.77 rows=1 width=84) (actual time=0.313..0.317 rows=1 loops=40)" " Output: p_2.parent_id, p_2.parent_data, p_2.partition_id" " Index Cond: (p_2.parent_id = r.parent_id)" " Filter: (r.partition_id = p_2.partition_id)" " Buffers: shared hit=56 read=105" " -&gt; Index Scan using parent_3_pkey on public.parent_3 p_3 (cost=0.43..6.77 rows=1 width=84) (actual time=0.317..0.317 rows=1 loops=32)" " Output: p_3.parent_id, p_3.parent_data, p_3.partition_id" " Index Cond: (p_3.parent_id = r.parent_id)" " Filter: (r.partition_id = p_3.partition_id)" " Buffers: shared hit=44 read=84" "Planning time: 8.863 ms" "Executiontime: 564.741 ms"</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first request did not bring surprises, everything, like in the previously reviewed ones. But in the second, an extension worked, which reduced the number of blocks considered by almost two times. Here you can see the classic case of partition pruning: in the RuntimeAppend step, the run for two partitions took place exactly one hundred times (42 + 58), that is, the search was carried out strictly for those partitions that were needed. In the third query, the cut-off works correctly, but the number of reads is not reduced by several times due to the fact that in the results table there are too many results for a specific value. Their reduction to the required hundred is made already after. On the other hand, everything will be fine for a normal database, regular tables should not be large there (otherwise they will be partitioned),and cutting off unnecessary partitions on large tables will result in a significant reduction in the scanned blocks.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The query with the exists condition worked completely the same way, here is its example: </font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.child c <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> p.partition_id = c.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> p.parent_id = c.parent_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.child_index = <span class="hljs-number"><span class="hljs-number">5000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.partition_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.5. </font><font style="vertical-align: inherit;">Request for 30 partitions.</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I was very upset that RuntimeAppend often does not work in the case of two constants in the condition for the partitioning key and I decided to check the request for more partitions. </font><font style="vertical-align: inherit;">A schema was created with the same tables and 30 partitions in each with the pg_pathman extension. </font><font style="vertical-align: inherit;">The data was uploaded there and the following query from 7.1 was tested by the method:</font></font><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> public.parent p, public.child c <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> c.partition_id = p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> c.parent_id = p.parent_id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> p.partition_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> His plan: </font></font><br><br><pre> <code class="sql hljs">"Limit (cost=17.38..294.92 rows=100 width=628) (actual time=31.483..33.538 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared hit=2 read=131" ... "Planning time: 48.911 ms" "Executiontime: 34.143 ms"</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fully</font></font></b> <div class="spoiler_text"><pre> <code class="sql hljs">"Limit (cost=17.38..294.92 rows=100 width=628) (actual time=31.483..33.538 rows=100 loops=1)" " Output: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id" " Buffers: shared hit=2 read=131" " -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">17.38</span></span>.<span class="hljs-number"><span class="hljs-number">.1318082</span></span><span class="hljs-number"><span class="hljs-number">.71</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">474913</span></span> width=<span class="hljs-number"><span class="hljs-number">628</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">31.482</span></span>.<span class="hljs-number"><span class="hljs-number">.33</span></span><span class="hljs-number"><span class="hljs-number">.514</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id, c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Cond: (p.parent_id = c.parent_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> Filter: (p.partition_id = c.partition_id)<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">131</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.85</span></span>.<span class="hljs-number"><span class="hljs-number">.28624</span></span><span class="hljs-number"><span class="hljs-number">.08</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">666900</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">2.625</span></span>.<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.651</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">48</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: p.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_2_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_2 p (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.14289</span></span><span class="hljs-number"><span class="hljs-number">.87</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">332887</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.362</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.370</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">28</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p.parent_id, p.parent_data, p.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> parent_3_pkey <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.parent_3 p_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.14334</span></span><span class="hljs-number"><span class="hljs-number">.21</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">334013</span></span> width=<span class="hljs-number"><span class="hljs-number">84</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.262</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.272</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">21</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: p_1.parent_id, p_1.parent_data, p_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Filter: (p_1.partition_id = <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> (<span class="hljs-string"><span class="hljs-string">'{2,3}'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">numeric</span></span>[]))<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; Materialize (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">13.49</span></span>.<span class="hljs-number"><span class="hljs-number">.1059692</span></span><span class="hljs-number"><span class="hljs-number">.47</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">20004382</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">28.789</span></span>.<span class="hljs-number"><span class="hljs-number">.30</span></span><span class="hljs-number"><span class="hljs-number">.453</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1369</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">123</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Merge</span></span> Append (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">13.49</span></span>.<span class="hljs-number"><span class="hljs-number">.1009681</span></span><span class="hljs-number"><span class="hljs-number">.51</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">20004382</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">28.782</span></span>.<span class="hljs-number"><span class="hljs-number">.30</span></span><span class="hljs-number"><span class="hljs-number">.170</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">1369</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Key</span></span>: c.parent_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">123</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_1_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_1 c (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.32766</span></span><span class="hljs-number"><span class="hljs-number">.35</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">664299</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.895</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.909</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">47</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c.child_id, c.parent_id, c.child_data, c.child_index, c.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_2_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_2 c_1 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33032</span></span><span class="hljs-number"><span class="hljs-number">.19</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">664696</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.835</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.048</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">62</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_1.child_id, c_1.parent_id, c_1.child_data, c_1.child_index, c_1.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_3_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_3 c_2 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33625</span></span><span class="hljs-number"><span class="hljs-number">.31</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">668577</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.849</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.858</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">39</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_2.child_id, c_2.parent_id, c_2.child_data, c_2.child_index, c_2.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_4_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_4 c_3 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.32859</span></span><span class="hljs-number"><span class="hljs-number">.69</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">668831</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.746</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.772</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">58</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_3.child_id, c_3.parent_id, c_3.child_data, c_3.child_index, c_3.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_5_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_5 c_4 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34070</span></span><span class="hljs-number"><span class="hljs-number">.24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">667684</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.037</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.043</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">44</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_4.child_id, c_4.parent_id, c_4.child_data, c_4.child_index, c_4.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_6_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_6 c_5 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34413</span></span><span class="hljs-number"><span class="hljs-number">.73</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">668521</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.248</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">63</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_5.child_id, c_5.parent_id, c_5.child_data, c_5.child_index, c_5.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_7_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_7 c_6 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33858</span></span><span class="hljs-number"><span class="hljs-number">.17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">664992</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.084</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.089</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">31</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_6.child_id, c_6.parent_id, c_6.child_data, c_6.child_index, c_6.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_8_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_8 c_7 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33396</span></span><span class="hljs-number"><span class="hljs-number">.85</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">666651</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.674</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.804</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">64</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_7.child_id, c_7.parent_id, c_7.child_data, c_7.child_index, c_7.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_9_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_9 c_8 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33535</span></span><span class="hljs-number"><span class="hljs-number">.73</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">665594</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.142</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.148</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">53</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_8.child_id, c_8.parent_id, c_8.child_data, c_8.child_index, c_8.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_10_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_10 c_9 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34376</span></span><span class="hljs-number"><span class="hljs-number">.76</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">667885</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.112</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.117</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">36</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_9.child_id, c_9.parent_id, c_9.child_data, c_9.child_index, c_9.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_11_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_11 c_10 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34520</span></span><span class="hljs-number"><span class="hljs-number">.23</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">667304</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.875</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.883</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">43</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_10.child_id, c_10.parent_id, c_10.child_data, c_10.child_index, c_10.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_12_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_12 c_11 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34516</span></span><span class="hljs-number"><span class="hljs-number">.73</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">667192</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.725</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.731</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">37</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_11.child_id, c_11.parent_id, c_11.child_data, c_11.child_index, c_11.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_13_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_13 c_12 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34775</span></span><span class="hljs-number"><span class="hljs-number">.47</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">665684</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.799</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.807</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">46</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_12.child_id, c_12.parent_id, c_12.child_data, c_12.child_index, c_12.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_14_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_14 c_13 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.32759</span></span><span class="hljs-number"><span class="hljs-number">.51</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">667829</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.952</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.966</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">51</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_13.child_id, c_13.parent_id, c_13.child_data, c_13.child_index, c_13.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_15_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_15 c_14 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33834</span></span><span class="hljs-number"><span class="hljs-number">.34</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">666471</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.713</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.719</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">30</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_14.child_id, c_14.parent_id, c_14.child_data, c_14.child_index, c_14.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_16_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_16 c_15 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33276</span></span><span class="hljs-number"><span class="hljs-number">.75</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">665648</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.887</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.892</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">40</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_15.child_id, c_15.parent_id, c_15.child_data, c_15.child_index, c_15.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_17_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_17 c_16 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34426</span></span><span class="hljs-number"><span class="hljs-number">.11</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">666740</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.820</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.835</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">50</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_16.child_id, c_16.parent_id, c_16.child_data, c_16.child_index, c_16.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_18_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_18 c_17 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.31990</span></span><span class="hljs-number"><span class="hljs-number">.71</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">665008</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.780</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.794</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">52</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_17.child_id, c_17.parent_id, c_17.child_data, c_17.child_index, c_17.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_19_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_19 c_18 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34141</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">669231</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.782</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.792</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">42</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_18.child_id, c_18.parent_id, c_18.child_data, c_18.child_index, c_18.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_20_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_20 c_19 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33065</span></span><span class="hljs-number"><span class="hljs-number">.75</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">666164</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.134</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.143</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">44</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_19.child_id, c_19.parent_id, c_19.child_data, c_19.child_index, c_19.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_21_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_21 c_20 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34236</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">667822</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.122</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.131</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">53</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_20.child_id, c_20.parent_id, c_20.child_data, c_20.child_index, c_20.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_22_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_22 c_21 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33809</span></span><span class="hljs-number"><span class="hljs-number">.84</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">664828</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.334</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.344</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">52</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_21.child_id, c_21.parent_id, c_21.child_data, c_21.child_index, c_21.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_23_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_23 c_22 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34169</span></span><span class="hljs-number"><span class="hljs-number">.35</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">668321</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.478</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.482</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">30</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_22.child_id, c_22.parent_id, c_22.child_data, c_22.child_index, c_22.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_24_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_24 c_23 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.31693</span></span><span class="hljs-number"><span class="hljs-number">.94</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">669014</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.936</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.940</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">30</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_23.child_id, c_23.parent_id, c_23.child_data, c_23.child_index, c_23.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_25_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_25 c_24 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34224</span></span><span class="hljs-number"><span class="hljs-number">.95</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">666004</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.869</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.881</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">60</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_24.child_id, c_24.parent_id, c_24.child_data, c_24.child_index, c_24.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_26_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_26 c_25 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.32132</span></span><span class="hljs-number"><span class="hljs-number">.54</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">665401</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.129</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.138</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">53</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_25.child_id, c_25.parent_id, c_25.child_data, c_25.child_index, c_25.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_27_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_27 c_26 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34930</span></span><span class="hljs-number"><span class="hljs-number">.21</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">668930</span></span> width=<span class="hljs-number"><span class="hljs-number">97</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.307</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.312</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">42</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_26.child_id, c_26.parent_id, c_26.child_data, c_26.child_index, c_26.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_28_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_28 c_27 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33712</span></span><span class="hljs-number"><span class="hljs-number">.49</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">666743</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.782</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.793</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">39</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_27.child_id, c_27.parent_id, c_27.child_data, c_27.child_index, c_27.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_29_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_29 c_28 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.34281</span></span><span class="hljs-number"><span class="hljs-number">.07</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">665822</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.879</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.886</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">42</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_28.child_id, c_28.parent_id, c_28.child_data, c_28.child_index, c_28.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Scan</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> child_30_parent_id_idx <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.child_30 c_29 (<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0.42</span></span>.<span class="hljs-number"><span class="hljs-number">.33248</span></span><span class="hljs-number"><span class="hljs-number">.03</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">666496</span></span> width=<span class="hljs-number"><span class="hljs-number">98</span></span>) (actual <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.816</span></span>.<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.934</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>=<span class="hljs-number"><span class="hljs-number">65</span></span> loops=<span class="hljs-number"><span class="hljs-number">1</span></span>)<span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Output</span></span>: c_29.child_id, c_29.parent_id, c_29.child_data, c_29.child_index, c_29.partition_id<span class="hljs-string"><span class="hljs-string">" "</span></span> Buffers: <span class="hljs-keyword"><span class="hljs-keyword">shared</span></span> hit=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-string"><span class="hljs-string">" "</span></span>Planning <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">48.911</span></span> ms<span class="hljs-string"><span class="hljs-string">" "</span></span>Executiontime: <span class="hljs-number"><span class="hljs-number">34.143</span></span> ms<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The staff cut-off worked for parent, unfortunately the pg_pathman extension did not work on the child table, which from my point of view is wrong. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8. Conclusions </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) Although the regular partitioning of tables is quite shorter, it can cut partitions for queries with one constant partition key value, but not for subqueries in select. For two or more partitioning key constants in the query, the cut-off only works for the table on which this condition is set. That is, this partitioning is suitable only for simple cases of partitioning, or for complex ones, but then you have to greatly optimize the queries, the ways of their execution, break them into pieces, that is, greatly change the interaction with the database. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) The insert with the pg_pathman extension accelerates approximately two to three times. With an increase in the number of partitions, I think the situation will not change.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3) Requests in the considered examples due to dynamic clipping of partitions reduce the number of required blocks by two times, but with an increase in the number of partitions to the usual for a large database (100-1000), the difference in the required resources will be much larger. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4) The pg_pathman extension, when the RuntimeAppend step is triggered, seriously speeds up queries and inserts and uses it to partition NADO tables.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5) But, there is a problem with the fact that the RuntimeAppend step does not always work and the queries work as before. </font><font style="vertical-align: inherit;">That is, while there are problems with scheduling requests. </font><font style="vertical-align: inherit;">According to experience in Oracle, this step is always appropriate when there is information about the necessary partition. </font><font style="vertical-align: inherit;">But here, while often it does not work, maybe the fact is that there are still errors in the calculation of the cost of the query plans. </font><font style="vertical-align: inherit;">Unfortunately, while in the postgrese there is no trace of the choice of the query plan and the exact reason I can not establish. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6) I will draw the attention of the developers of this extension to the found bug with the size of the record and a strange choice of plans. </font><font style="vertical-align: inherit;">Since they fix bugs regularly, the hope of fixing these problems remains. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In conclusion, I want to tell the developers of this extension many thanks for their work and wish them continued success!</font></font></div><p>Source: <a href="https://habr.com/ru/post/335644/">https://habr.com/ru/post/335644/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335632/index.html">Placement of icons on the site page. Make it easier, support it easier</a></li>
<li><a href="../335634/index.html">How to find out the balance of someone else's bank card, knowing its number?</a></li>
<li><a href="../335636/index.html">Warehouse management system using CQRS and Event Sourcing. Service layer</a></li>
<li><a href="../335638/index.html">The cost of real estate on heat maps</a></li>
<li><a href="../335642/index.html">Redesign Habrahabra and Hiktayms. Finish line</a></li>
<li><a href="../335646/index.html">We are testing a new mechanism for synchronization of settings JetBrains IDEs</a></li>
<li><a href="../335648/index.html">Returning a Cisco router with a non-working CF or mini-flash card</a></li>
<li><a href="../335650/index.html">What can chat bot</a></li>
<li><a href="../335652/index.html">Intel Optane SSD: features and benefits</a></li>
<li><a href="../335654/index.html">Datacenter: the stages of big life</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>