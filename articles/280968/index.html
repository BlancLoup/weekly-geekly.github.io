<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Understanding DevOps and Js on the example of Dillinger.io</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I am a Java developer backend, and very rarely reach the front end. This is a big omission. Lack of understanding of the frontend does not allow me to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Understanding DevOps and Js on the example of Dillinger.io</h1><div class="post__text post__text-html js-mediator-article">  I am a Java developer backend, and very rarely reach the front end.  This is a big omission.  Lack of understanding of the frontend does not allow me to see the full picture of the world.  I do not know what they are paying attention to and how they use all the fashionable tools like Node.js, Gulp, Webpack, that is, the fact that they are so frightened by the backend of developers with their diversity and constant changes. <br><br>  And my first <s>victim was the</s> goal of <a href="http://dillinger.io/">Dillinger.io</a> .  It is an open text editor for Markdown, it has syntax highlighting and export of written text to PDF, HTML, Dropbox, Github and Google Drive, you can also add your own way, for example, static website generator or Wordpress. <br><br>  A set of features sounds quite modest.  But in order to understand it, I had to spend a couple of evenings and read about the whole zoo of technologies.  And this project has a lot to learn. <br><a name="habracut"></a><br><h2>  Technology </h2><br>  There is a modest list of technologies used in <a href="https://github.com/joemccann/dillinger">the project repository</a> : <br><ul><li>  <a href="https://angularjs.org/">AngularJs</a> - a front-end framework that allows you to bring logic in HTML (yes, first); </li><li>  <a href="https://ace.c9.io/">Ace Editor</a> - text editor; </li><li>  <a href="https://github.com/chjj/marked">Marked</a> - Markdown parser and compiler; </li><li>  <a href="http://getbootstrap.com/">Twitter Bootstrap</a> - 'Nough said; </li><li>  <a href="https://nodejs.org/en/">Node.js</a> - reactive js on the backend; </li><li>  <a href="http://expressjs.com/">Express</a> - web-framework for Node.js; </li><li>  <a href="http://gulpjs.com/">Gulp</a> - streaming build system for the frontend; </li><li>  <a href="https://github.com/madrobby/keymaster">Keymaster.js</a> - library for handling hotkeys; </li><li>  <a href="http://jquery.com/">jQuery</a> - well, where without it? </li></ul><br>  From myself I can add a couple more: <br><ul><li>  <a href="https://www.docker.com/">Docker</a> - containers (everyone talks about them anyway); </li><li>  <a href="https://www.docker.com/products/docker-compose">Docker Compose</a> - tools for running containers in batches; </li><li>  <a href="https://www.ansible.com/">Ansible</a> - tools for automating configuration management; </li><li>  <a href="https://www.heroku.com/">Heroku</a> - cloud application server; </li><li>  <a href="https://nodesource.com/products/nsolid">N | Solid</a> - monitoring, proxy, orchestrating and managing applications on Node.Js; </li><li>  <a href="http://nginx.org/ru/">NGinx</a> - http and proxy server (in this project); </li><li>  <a href="https://www.npmjs.com/">Npm</a> is a package manager for Node.js; </li><li>  <a href="https://webpack.github.io/">Webpack</a> - JS file collector for frontend; </li><li>  <a href="https://karma-runner.github.io/">Karma</a> - test launcher; </li><li>  <a href="http://www.embeddedjs.com/">Ejs</a> - template engine; </li></ul><br>  This technology zoo surprised me, to say the least.  From all this, I used only AngularJs, Bootstrap and Jquery.  Of course, I heard about most technologies, but everything was limited to rumors. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Infrastructure </h2><br>  When I looked through the list of technologies, I wondered why: ‚ÄúWhy does a text editor, which works in my browser, have a backend?‚Äù.  And all the more I did not understand why, in this case, Docker and the Enterprise platform for managing Node.js are needed.  But I learned more about the creator of the application and the second question was solved by itself.  <a href="https://github.com/joemccann">Joe McCann</a> is the co-founder of <a href="https://www.nodesource.com/">NodeSource</a> , the company that released <a href="https://nodesource.com/products/nsolid">N | Solid</a> (a framework for managing and monitoring Node.js applications).  This means that he is well acquainted with the creation of the application infrastructure and in this area he has something to learn. <br><br><h3>  Can I just run the application? </h3><br>  If you just want to test the application, you can choose a simple option.  Only <a href="https://nodejs.org/en/">Node.js</a> and <a href="http://gulpjs.com/">Gulp are</a> needed.  Node.js brings up and configures the <a href="http://expressjs.com/">Express</a> web server.  And Gulp monitors changes in the Js and Sass files, converts them into a view that is understandable to the browser and reloads the page if any of the files have been changed.  In the <a href="">readme</a> guides can be found on the installation and launch the server. <br><br>  Node.js settings are in the <a href="">app.js</a> file.  This file includes external dependencies and internal modules (routing of the main page, settings and plugins), as well as a web server.  It gives static pages, compiles ejs templates, binds cookies to the user, compresses http-responses, sets up logging and finds handlers for dynamic requests. <br><br>  The scripts for Gulp are in the <a href="https://github.com/joemccann/dillinger/tree/master/gulp">/ gulp</a> folder.  The main interest here are <a href="https://github.com/joemccann/dillinger/tree/master/gulp/tasks">tasks</a> : just by their names you can understand why Gulp is used in this project: watch, build, webpack, sass, browserSync.  Or in Russian: we tell Gulp what files to monitor.  If one of them is updated, then with the help of <a href="https://webpack.github.io/">Webpack,</a> it will assemble a script from dependencies and pieces of Js-code and turn Sass into Css.  Further, he will ask the browser to refresh the page using browserSync. <br><br>  Also in these files you can find different code execution profiles (development mode and production mode), they are different in that there are more debug information in the development mode (mapping of minified files, logs, etc.). <br><br><img src="https://habrastorage.org/files/6b1/bfb/90b/6b1bfb90b269498588a383d03de4d122.jpg"><br><br><h3>  How to transfer the application to the server? </h3><br>  But as soon as you are done with developing and testing the application locally, the question arises of transferring it to the server.  Of course, the easiest option is to do everything and install all the necessary utilities on the remote computer, make sure that it is configured like the local machine, run the application and believe that nothing will change.  But to be sure that the environment is configured correctly and nothing changes, you need to somehow isolate your application.  There are two principal ways: virtual machines and containers.  And, of course, it‚Äôs a sin not to collect all the hipster technologies, if you write on JS =) And the choice towards Docker is obvious. <br><br>  There is nothing supernatural in the <a href="https://github.com/joemccann/dillinger/blob/master/Dockerfile">container Docker configuration</a> .  The base container uses the image on which Node.Js is installed and all the necessary utilities.  The script contains instructions for installing dependencies and starting the server, port 80 is given out, and environment variables are specified. <br><br><img src="https://habrastorage.org/files/aaa/63c/3c4/aaa63c3c40ed4ee1825f8a452e1d9d34.jpg"><br><br><h3>  But why exactly docker? </h3><br>  Fashion is not the only reason for using Docker in this project.  As I said, the author of the project was somehow involved in creating <a href="https://nodesource.com/products/nsolid">N | Solid</a> - an enterprise platform for applications on Node.Js.  In the last paragraph, I did not mention, but the image of N | Solid is used as the base image, and it is not yet clear what advantages this gives.  But there are two more suspicious files that should be studied: <a href="">nsolid.yml</a> and <a href="">docker-compose.yml</a> . <br><br>  These two files are needed to configure the <a href="https://www.docker.com/products/docker-compose">Docker Compose</a> utility.  They describe how to raise this application in cluster mode and configure the N | Solid platform.  All containers rise in one network and as a result 8 containers start: <br><ul><li>  N | Solid service registry (registers infrastructure applications), </li><li>  N | Solid proxy (based on Service Registry distributes requests between applications), </li><li>  N | Solid console (application management tool), </li><li>  4 containers Dillinger (stateless, are registered in the service registry and are ready to accept requests), </li><li>  NGinx (web server, not on Node.JS). </li></ul><br><br>  The repository did not forget about <a href="">the NGinx configuration</a> .  It is used as a proxy.  NGinx, like Express.js, compresses the data and gives out static files.  It processes requests for static files independently, and proxies other requests between the cluster nodes.  It turns out that there are two implementations of Proxy (N | Solid Proxy and NGinx) in the repository, and NGinx is used by default.  Static files can also be sent out in two ways: via Express.js server or using NGinx.  Both of these methods are used: the first - in the case of local development, and the second - if you run the application in cluster mode and use NGinx as a server. <br><br>  Due to the fact that the capabilities of Service Registry, Proxy and Console are not used in this configuration, we simply close our eyes on them and consider only the request proxying in the figure.  And, in general, I did not feel the importance of N | Solid for this project, most of the functionality can be recreated with the help of NGinx, maybe the whole thing is in the convenience of control, but my hands did not reach him. <br><br><img src="https://habrastorage.org/files/932/334/8ca/9323348ca42240498dfa69e5fb6bdfcc.jpg"><br><br><h3>  More automation </h3><br><br>  But this automation does not end there =) At the root are two more interesting files: <a href="">deploy.yml</a> and <a href="https://github.com/joemccann/dillinger/blob/master/dillinger.service">dillinger.service</a> .  They are also associated with the creation of infrastructure. <br><br>  <a href="">The first one</a> is the script for <a href="https://www.ansible.com/">Ansible</a> .  It automates the installation of an application on Debian.  Or rather, it connects extra reps, installs rsync and docker, installs the Dillinger image, creates and runs Debian-service with this image. <br><br>  <a href="https://github.com/joemccann/dillinger/blob/master/dillinger.service">The second file</a> describes this service.  He describes that Dillinger depends on the docker, that the service will be available to several users, and also indicates how to start the service and that every time before starting it is necessary to download a new version of the image. <br><br>  True, this script raises only one image of Dillinger, and not a whole cluster, but the line of thought is clear and you can modify this script so that it runs the entire cluster. <br><br><h2>  Front end </h2><br>  One of the important approaches of the first version of <a href="https://angularjs.org/">AngularJs</a> is double-sided binding.  It allows you to describe part of the logic directly in HTML, and this feature is actively used in this project.  The code turned out to be blurred between the JS-files and ejs-templates, but the project is small and the whole picture can be kept in mind. <br><br><h3>  Templates </h3><br>  For writing HTML, <a href="http://www.embeddedjs.com/">Ejs</a> template engine was used.  As a result, the files turned out small and easy to read.  All templates can be viewed in the <a href="https://github.com/joemccann/dillinger/tree/master/views">/ view</a> folder.  But if you just start reading all the files in a row, you will see tags that are not in normal Html, for example, the <strong>switch</strong> tag in the file <a href="">/ views / dropdowns / settings</a> .  This is a directive described by AngularJs, it is connected with some kind of logic, and this is a good way to use an angular, in this case, the code has become more readable and understandable.  Although, if you use directives too often, you will have to learn your own Domain Specific Language (DSL) for each site.  But with the advent of code, the templates become less readable, for example, in the file <a href="">/views/sidebar.ejs</a> you need to understand what the document means in this context and why you cannot delete the only remaining document. <br><br>  The templates also contain a separation of scripts for development mode and production: in the <a href="">/views/footer.ejs</a> file, asynchronous script loading and Google analytics are included. <br><br><h3>  AngularJs </h3><br>  We have already managed to touch on <a href="https://angularjs.org/">AngularJs</a> , and the time has come to find out in more detail how and why it is used in this project.  If someone is unfamiliar with AngularJs, it's worth mentioning that this is a whole framework like, for example, Spring for Java.  That is, it contains not only auxiliary functions, but also programming approaches that need to be used with it: Dependency Injection (description of dependencies when creating an angular component), modularity (programming pattern, allowing to separate the visibility of variables), double-sided binding (with changing a variable changes the component on the screen, changing the component on the screen (entering text, selecting a checkbox, etc.) changes the state of the variable).  More details can be found <a href="https://habrahabr.ru/post/250149/">here</a> (look under the spoiler). <br><br>  The application code can be found in the <a href="https://github.com/joemccann/dillinger/tree/master/public/js">/ public / js</a> folder.  The file <a href="">/public/js/app.js</a> describes the dependencies, the main module of the angular and the startup screen with the logo and the signature on the download. <br><br><h3>  Services </h3><br>  All main application logic is located in the <a href="https://github.com/joemccann/dillinger/tree/master/public/js/services">/ public / js / services</a> folder. <br><br>  It describes the <a href="">debounce</a> function (a simple query filter that allows you to collapse identical commands and execute the code only once).  Debounce is a programming pattern on js, it is used, for example, so that, without thinking about anything, when changing text, call the save function and be sure that it will not work too often (after each keystroke).  Now this function works very naively and calls the command only some time after the last function call.  If the user prints the text and accidentally closes the tab or reloads the page, then all his precious work may disappear (I once fell for this bug). <br><br>  Also there are services for storing <a href="">documents</a> and <a href="">users</a> .  They store information in the browser‚Äôs local memory and read it at initialization.  The document service, oddly enough, stores the documents, that is, the text, the name and other metadata of the document entered by you.  A user service stores settings. <br><br>  There are two more services in this folder: <a href="">wordscount</a> and <a href="">notification service</a> .  With the first service everything is clear, it is simple.  The amount of code in the second service may scare, but there, too, everything is quite simple: it describes the function with which you can show the user a pop-up window.  The main part of the code calculates the mutual position of the notifications, displays them in order and processes the closing of the window.  An <a href="https://github.com/joemccann/dillinger/blob/master/public/js/base/diNotify.html">html file is</a> used as a notification template, it displays a logo and a message. <br><br><h3>  Controllers </h3><br>  With controllers it is still easier.  They handle the events described in ejs templates.  For example, the <a href="">user controller</a> handles the handling of buttons on the <a href="https://github.com/joemccann/dillinger/tree/master/views/dropdowns">drop-down menu</a> , and the <a href="">document controller</a> handles the events of the left menu, creates a new file, and autosaves. <br><br>  There is also a <a href="">file export</a> controller, it uses the <a href="">form on the main page</a> for downloading files.  And goes to the server in the <a href="https://github.com/joemccann/dillinger/tree/master/plugins/core">core plugin</a> for rendering Markdown. <br>  The controllers also configure the text editor itself.  To my disappointment, little is written about the text editor itself.  The main functions are delegated to the <a href="https://ace.c9.io/">Ace Editor</a> , and all I managed to find is the <a href="">theme</a> and <a href="">configuration of the</a> text editor <a href="">twice</a> (due to code duplication, there may be bugs as well). <br><br><h3>  Directives </h3><br>  I already mentioned the directives when I talked about ejs templates.  A directive is an arbitrary html element or attribute that has its own logic.  There are many of them in the project, and I will not dwell on them in detail, they are very simple, and those who are interested can search for them in the <a href="https://github.com/joemccann/dillinger/tree/master/public/js/components">/ public / js / components</a> folder and in other parts of the project. <br><br><h2>  Backend </h2><br>  About backend, I will tell not so much.  I was surprised to meet him in this project.  The backend in the project is implemented as plug-ins and lies in the <a href="https://github.com/joemccann/dillinger/tree/master/plugins">/ plugins</a> folder.  Among them is the <a href="https://github.com/joemccann/dillinger/tree/master/plugins/core">core</a> plugin, which renders Markdown in PDF, Html and Markdown.  And 4 plug-in integration with external services, it makes sense to read them in conjunction with the corresponding plug-ins on the <a href="https://github.com/joemccann/dillinger/tree/master/public/js/plugins">front end</a> .  These are just adapters that are engaged in authorization, render form files and collect additional information from the user.  So let's say, reading for an amateur, if I find someone interesting, I will not stop. <br><br>  Perhaps enough about this project.  Today we understand the architecture of a simple application on Node.js, including infrastructure, front end and back end.  I hope you learned something new and it became clearer how this project works and, maybe, even a clearer vision appeared on how to make your own better.  I could forget to highlight some important topic or not to notice something, write, I will be happy to fix it. <br><br>  Unfortunately, in the framework of the current version of the text editor, not all the <a href="https://martinbroder.com/dillinger.html">ideas of Martin Broder are</a> implemented, but there is work for the Open-Source community.  When I understood this project, I wrote a couple issue and fixed one bug and urge you to do the same.  Do it at least for your own sake, you will surely find something else interesting.  <a href="https://github.com/joemccann/dillinger/issues">See</a> how much work awaits you. <br><br>  Since the writing of the article could have changed a lot.  Last commit at the time of writing this article: <a href="https://github.com/joemccann/dillinger/tree/c3782a8dc0b91e5a6ae2c2ecd528daa1f42b3a9a">c3782a8dc0b91e5a6ae2c2ecd528daa1f42b3a9a</a> . </div><p>Source: <a href="https://habr.com/ru/post/280968/">https://habr.com/ru/post/280968/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../280956/index.html">What's new in Visual Studio 2015 for C #, Visual Basic and Linux enthusiasts</a></li>
<li><a href="../280960/index.html">The ‚Äúgang of four‚Äù was wrong, and you don't know what delegation is</a></li>
<li><a href="../280962/index.html">Certification and certification: why is it necessary?</a></li>
<li><a href="../280964/index.html">RUVDS thanks Habrahabr users for their choice</a></li>
<li><a href="../280966/index.html">How to transfer business to the cloud</a></li>
<li><a href="../280970/index.html">Road Network OpenStreetMap</a></li>
<li><a href="../280972/index.html">AppCode release 2016.1: improved support for Swift and C ++</a></li>
<li><a href="../280974/index.html">Creating an expert system in Wi! Mi 1.1</a></li>
<li><a href="../280976/index.html">About the Perforce Helix version control system</a></li>
<li><a href="../280978/index.html">Innovations C # 7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>