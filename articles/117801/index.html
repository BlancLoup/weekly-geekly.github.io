<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New wave of the spread of Trojans VKontakte</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Long time I did not receive any spam with viral mailings from the freelist social networks, and nothing unique has long been encountered from this kin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New wave of the spread of Trojans VKontakte</h1><div class="post__text post__text-html js-mediator-article">  Long time I did not receive any spam with viral mailings from the freelist social networks, and nothing unique has long been encountered from this kind of mailings.  But today I got a rather curious sample. <br>  First I received a letter from a person who is on my list of friends: <br><br><img src="https://habrastorage.org/storage/8d6e2992/c844268a/a07cf278/cb345087.png"><br><br>  A rather uncharacteristic manner for a person, but I followed the link because  she did not lead to external resources.  During the transition, we see the profile of a certain Andy Smoke, who promises to give everyone a vote tomorrow for free, if you follow the link.  What is alarming right away?  That's right, shortcut links, which for so long used over the hill for phishing.  Now we have sunk) But this is for me personally, in general, the freebie itself is alarming. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Details under the cut) <a name="habracut"></a><br><br><img src="https://habrastorage.org/storage/55613784/b79beb67/25809025/003a8b1a.png"><br><br>  When clicking on a link, a vigilant and cozy contact person warns us about the danger of phishing, but we are not afraid of such adversity, we go ahead.  Catch redirection to a creepy domain: <br>  <b>_http: //dfkdoi**saxasods.ru/rating/</b> <br><br><img src="https://habrastorage.org/storage/61898c62/990ac8bc/26ec955b/b6007408.png"><br><br>  Immediately you can see that it smells unclean only by the fact that VKontakte is not tied to the size of the monitor, and changing the size of the browser window does not spoil the proportions of the content.  At this point, it‚Äôs not worth risking, if you hit a bunch, then proactivation may not save, turn on the virtual machine and go back to the suspicious page in a safe viral environment) <br>  When you click the "install" button, an executable file is downloaded, weighing 27 kb. <br><br><img src="https://habrastorage.org/storage/e65c4d84/4f9f83a6/425b29f4/a36e3625.png"><br><br>  It becomes interesting.  Look, is it packed? <br>  - Yes, upx: <br><br><img src="https://habrastorage.org/storage/8190c094/15aff04a/0e34b702/91f6865d.png"><br><br>  Unpack, we get a file weighing 79 KB, the compiler is PureBasic. <br><br><img src="https://habrastorage.org/storage/2541fe46/8e2bc3bd/7d698fbb/873d3293.png"><br><br><img src="https://habrastorage.org/storage/2725f9d9/3e82686f/f9e62a09/2557ba5a.png"><br><br>  After unpacking, both files were sent to virustotal: <br>  <a href="http://www.virustotal.com/file-scan/report.html%3Fid%3Dc497796bc8caaf5944dc422a504ff9419089311c5accf2fd1025e09fe0853a70-1303241976">Packed file</a> <br>  <a href="http://www.virustotal.com/file-scan/report.html%3Fid%3D20c62de161ffd1ccd9e02123660b664452f1060c45e8fba66c4df534bdf1dfd3-1303241640">Unpacked</a> <br><br>  Let's see how active the file is.  We throw in the debugger, the functions show that the file can try to find out the path to the temporary directory and extract something from the resources.  We look resources: <br><br><img src="https://habrastorage.org/storage/4588fded/d5b84a26/b2cde50b/be7b7ca7.png"><br><br><img src="https://habrastorage.org/storage/e3f69135/f07c203e/fe7655bc/dbb139d5.png"><br><br>  Obfuscated bat-file, weighing 38.6 kb, recording changes to the hosts file.  There is nothing more interesting. <br>  Decipher the code (just need to remove the garbage lines): <br><br><img src="https://habrastorage.org/storage/252e6318/8748e6bd/f3f08119/de853bce.png"><br><br>  It turns out that a visit to one of the listed sites will now lead to the attacker's page.  What will we see there? <br>  For example, let's take VKontakte: a completely ordinary page that does not evoke suspicion.  Enter the data - we see a completely innocent, albeit suspicious, alert about hacking with the suggestion of replacing the password.  We try to change the password and get this offer to pay for page validation: <br><br><img src="https://habrastorage.org/storage/195048d9/010ac064/573a9377/03dce97e.png"><br><br>  Payment is 100 rubles to the number +79057599377. <br>  When will the Bilayans for the protection of such numbers be closed by the prosecutor's office? <br>  Actually that's all.  Fashionable screenshots from Olly Debuger or IDA Disassembler will not be what they are here for, if everything is trivial) <br><br>  Conclusion: <br>  1) There are no freebies <br>  2) You can not follow unclear links, even if they were sent by a person you know, until you are sure that the link is legitimate or your friend‚Äôs sanity. <br><br>  <b>What to do if you are already infected with a similar virus?</b> <br>  The main thing - in no case do not send the attackers money.  It simply does not help. <br>  Second, open the following file in Notepad or any text editor: <br>  <b>C: \ Windows \ System32 \ drivers \ etc \ hosts</b> <br>  <i>(administrator rights required)</i> <br>  and delete all its contents, save the file and change passwords from the affected resources. </div><p>Source: <a href="https://habr.com/ru/post/117801/">https://habr.com/ru/post/117801/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../117791/index.html">Is it MVC?</a></li>
<li><a href="../117792/index.html">New YouTube videos are now saved in WebM format.</a></li>
<li><a href="../117794/index.html">Freelance VS Office - duel! (Video report)</a></li>
<li><a href="../117797/index.html">Transfer data from one database to any other</a></li>
<li><a href="../117800/index.html">Call to join testing Ubuntu 11.04 Natty Narwhal</a></li>
<li><a href="../117802/index.html">Spring Remoting - Spring + RMI</a></li>
<li><a href="../117803/index.html">Crossbrowser accessors in javascript</a></li>
<li><a href="../117804/index.html">PAP or PNA - that is the question</a></li>
<li><a href="../117805/index.html">Big Evernote update for Android</a></li>
<li><a href="../117807/index.html">The PowerShell Language Specification is released under the Community Promise license.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>