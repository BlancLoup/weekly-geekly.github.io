<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automate the installation of Powerchute Business Edition</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 Recently, my manager set the task to automate the installation and configuration of the Powerchute Business Edition product on a large numb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automate the installation of Powerchute Business Edition</h1><div class="post__text post__text-html js-mediator-article"><h4>  Foreword </h4><br>  Recently, my manager set the task to automate the installation and configuration of the Powerchute Business Edition product on a large number of servers, with various interfaces for connecting UPS, USB, COM.  Previously engaged in the automation of the installation of various software, but with the type of configuration files that this product uses for the first time.  The thing is that java binaries are used as a configuration file, which can be modified by the utility with the GIU interface, it is not suitable for solving the problem. <br><a name="habracut"></a><br><h4>  Powerchute Business Edition from the inside </h4><br>  Let us consider in more detail the product, it is possible to get it on the official <a href="http://www.apc.com/home/ua/ru/">APC</a> website in the <a href="http://www.apc.com/products/resource/include/techspec_index.cfm%3Fbase_sku%3DSFPCBE911">downloads</a> section.  After downloading, we get the <b>pcbesetup.exe</b> file with the help of it, it is possible to install three components, agent, server, console.  The agent installs the driver on the UPS and is responsible for automatically shutting down the server in the event of a power failure.  The server connects to the agent, reads the status of the UPS, in case of problems it can send an alert to the mail.  Console, GUI interface for server and agent settings.  Component three but one, in order to get them separately we will use the usual <b>WinRAR</b> , open the downloaded file, move to the bin folder.  We see three of our components, but four folders, more on that later. <br><br><img src="https://habrastorage.org/files/6df/3b4/6ba/6df3b46ba90b4b59b29989061d1db06f.PNG"><br><br><h4>  Automation of component installation </h4><br>  Since inhaler files are made in InstallShield, it is possible to create an answer file, <a href="">which is written</a> on the manufacturer‚Äôs website.  From the beginning, you must put all the unzipping files for example in the following path <b>C: \ APC</b> , then install the components from the command line in the specified order: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>1.</b> C: \ APC \ agent-upslink \ setup.exe -r agent version 9.0.3 installation <br>  <b>2.</b> C: \ APC \ agent \ setup.exe -r update agent to version 9.1.1 <br>  <b>3.</b> C: \ APC \ server \ setup.exe -r install server version 9.1.1 <br>  <b>4.</b> C: \ APC \ console \ setup.exe -r install console 9.1.1 <br><br>  After each installation, a response file <b>C: \ Windows \ setup.iss</b> will be created, which must be copied to the directory with the installer.  It is important that when installing the UPS detection agent passed automatically, this will further provide an opportunity to install the agent with various USB, COM interfaces, it will detect the UPS itself.  Now we‚Äôll check that the answer files are working, remove the installed components, reinstall with the s key. <br><br>  <b>1.</b> C: \ APC \ agent-upslink \ setup.exe -s <br>  <b>2.</b> C: \ APC \ agent \ setup.exe -s <br>  <b>3.</b> C: \ APC \ server \ setup.exe -s <br>  <b>4.</b> C: \ APC \ console \ setup.exe -s <br><br>  As you can see the installation was successful: <br><br><img src="https://habrastorage.org/files/5ca/001/86f/5ca00186f4f54f8298fda77f63346b2f.PNG"><br><br>  The components are installed, now they need to be configured.  The agent is configured at the time of installation, a login and password is set, which is saved in the file <b>C: \ Windows \ setup.iss</b> , we have already configured it before we created the answer file.  Now comes the most interesting setting up a server with a binary java file.  Open the console and remove the previously configured UPS. <br><br><img src="https://habrastorage.org/files/59a/f78/a12/59af78a1249149cf92d4174b1cce4bba.PNG"><br><br>  after adding a new client, it is important to specify <b>127.0.0. *</b> in the search range, this is necessary for automation, since there will be different agent addresses on different servers, and we will not edit the configuration file manually. <br><br><img src="https://habrastorage.org/files/360/97f/df6/36097fdf68414e04ac23c9cbd547c96b.PNG"><br><br>  We are setting up sending notifications by mail, in the Tools&gt; Chenge Configuration Profile section, I will not describe each field and everything is clear. <br><br><img src="https://habrastorage.org/files/685/a3c/4c5/685a3c4c573c49d39c5208a9ccec66d1.PNG"><br><br>  Everything you need for automation is copied to the server settings files, in the following path C: \ Program Files (x86) \ APC \ PowerChute Business Edition \ server, files m11.bak, m11.cfg.  in the C: \ APC \ server \ directory, remove all previously installed PowerChute components, and install them using the PowerShell script, listing below.  The script logic is as follows, go to the directory where the script file is located, install and update the agent, install the server, stop the server service, change the configuration files, start the server service, install the console. <br><br><pre><code class="cs hljs">function InstallPowerShute{ .\APC\agent-upslink\setup.exe -s | Out-Null .\APC\agent\setup.exe -s | Out-Null $PowerChuteServerFolder= ${env:ProgramFiles(x86)} + <span class="hljs-string"><span class="hljs-string">"\APC\PowerChute Business Edition\server"</span></span> $PowerChuteServerFile1= $PowerChuteServerFolder + <span class="hljs-string"><span class="hljs-string">"\m11.bak"</span></span> $PowerChuteServerFile2= $PowerChuteServerFolder + <span class="hljs-string"><span class="hljs-string">"\m11.cfg"</span></span> .\APC\server\setup.exe -s | Out-Null Stop-Service APCPBEServer -Force | Out-Null <span class="hljs-keyword"><span class="hljs-keyword">remove</span></span>-item -path $PowerChuteServerFile1 -force <span class="hljs-keyword"><span class="hljs-keyword">remove</span></span>-item -path $PowerChuteServerFile2 -force Copy-Item <span class="hljs-string"><span class="hljs-string">".\APC\server\m11.bak"</span></span> -Destination $PowerChuteServerFolder Copy-Item <span class="hljs-string"><span class="hljs-string">".\APC\server\m11.cfg"</span></span> -Destination $PowerChuteServerFolder Start-Service APCPBEServer | Out-Null .\APC\console\setup.exe -s | Out-Null } function Get-ScriptPath{ Split-Path -Path $MyInvocation.ScriptName } $path = Get-ScriptPath cd $path InstallPowerShute</code> </pre> <br><br>  I hope you will succeed. <br><br>  Thank you for your attention. </div><p>Source: <a href="https://habr.com/ru/post/235177/">https://habr.com/ru/post/235177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235165/index.html">Review of educational resources by September 1</a></li>
<li><a href="../235169/index.html">Import Spine 2D animations in Unity 3D and linking effects to bones using 2D Toolkit</a></li>
<li><a href="../235171/index.html">Does a programmer need specialized education? What do they think in Yandex</a></li>
<li><a href="../235173/index.html">Exoskeleton from scrap materials</a></li>
<li><a href="../235175/index.html">We do authorization on Codeigniter 2.0 using ajax and HMVC</a></li>
<li><a href="../235179/index.html">Yota for office - what to choose</a></li>
<li><a href="../235181/index.html">Introduction to Size Classes in Xcode 6</a></li>
<li><a href="../235183/index.html">Update Inforza and monitoring of open tenders for digital services</a></li>
<li><a href="../235185/index.html">How to increase website conversion (on the example of Nike)</a></li>
<li><a href="../235187/index.html">High-tech "boots-fast walkers" will show the owner the right direction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>