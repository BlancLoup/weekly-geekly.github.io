<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bestiary C ++. Mysterious Characters Handbook</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In C ++, pitfalls, traps, reservations and traps are abundant. In the C ++ dungeons, numerous suspicious characters are hiding. Halloween is the right...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bestiary C ++. Mysterious Characters Handbook</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/getpro/habr/post_images/03f/ed1/2e8/03fed12e8ef572c7380d72ac5fd7b3d1.jpg"></p><br><p>  In C ++, pitfalls, traps, reservations and traps are abundant.  In the C ++ dungeons, numerous suspicious characters are hiding.  Halloween is the right time to meet with some of this large pack of monsters. </p><a name="habracut"></a><br><ul><li><img src="https://habrastorage.org/webt/vu/n2/ex/vun2ex2enuph103v6zb2mvjxz30.png">  Nasty types </li><li><img src="https://habrastorage.org/webt/px/-s/fq/px-sfqejgrhznh02iiw07a9sjhg.png">  Strangers </li><li><img src="https://habrastorage.org/webt/fo/jo/be/fojobens62ztsnlnjtgoyljqa-k.png">  Demons </li><li><img src="https://habrastorage.org/webt/wt/rm/em/wtrmemntpbovs4dfamipqlaqhl4.png">  Dll hell </li><li><img src="https://habrastorage.org/webt/bo/dp/g3/bodpg3ovm0qsjvtweajyugyutne.png">  Duck typing </li><li><img src="https://habrastorage.org/webt/xx/6d/o6/xx6do6exml8doyb4uaqrk-_epci.png">  UFO </li><li><img src="https://habrastorage.org/webt/gw/cq/-r/gwcq-rqnwfkhvdstugyg0o9xprk.png">  Demons </li><li><img src="https://habrastorage.org/webt/9q/zf/xk/9qzfxkltxn-janifjcpnj62frxi.png">  Hidden variables </li><li><img src="https://habrastorage.org/webt/gb/zf/gu/gbzfgumh6hoxxycrvoinqhzbdz8.png">  Terminators </li><li><img src="https://habrastorage.org/webt/2a/uz/2t/2auz2t-xup3gxchsllcnckugwmy.png">  Transparent objects </li><li><img src="https://habrastorage.org/webt/um/sz/6n/umsz6njbdu-roazbdmjtpuad5gy.png">  Unicorns </li><li><img src="https://habrastorage.org/webt/tf/vf/bo/tfvfbo1w5qjrlpj1x76rkr_6xg8.png">  Types of Volan de Mort </li><li><img src="https://habrastorage.org/webt/io/xy/0g/ioxy0gj4outlz8ixlccq2tda1hc.png">  Zombie </li><li><img src="https://habrastorage.org/webt/ca/qy/ct/caqyctrjfy290xcmb40vqaqcuo8.png">  Zombies and brains </li></ul><br><h2 id="httpshabrastorageorgwebtvun2exvun2ex2enuph103v6zb2mvjxz30png-merzkie-tipy"><img src="https://habrastorage.org/webt/vu/n2/ex/vun2ex2enuph103v6zb2mvjxz30.png">  Nasty types </h2><br><img src="https://habrastorage.org/webt/ad/bj/c4/adbjc4a7bjurvpb8zdha2gv4zdw.jpeg" align="left"><br><blockquote>  <em>In the type system there are dark corners, about which little is known to someone, except the authors of the compilers ...</em> <br>  Alisdair Meredith ( <a href="https://twitter.com/alisdairmered">Alisdair Meredith</a> ).  <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0172r0.html">Abominable Function Types</a> </blockquote><p>  The <em>abominable</em> function type is the type that results from writing a function type after the <em>cv-ref</em> qualifier. </p><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> abominable = <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> &amp;&amp;;</code> </pre> <br><p>  <code>abominable</code> is the name <em>of the function type</em> , <em>not the</em> pointer type, and despite writing, it is neither <code>const</code> nor qualified type <code>volatile</code> .  In the type system, there is no <em>cv-qualified</em> type of function, and the vile type of function is something completely different. </p><br><p>  <strong>It is impossible</strong> to create a function that has a nasty type! </p><br><blockquote>  ‚ÄúKnown to me examples of explicit writing of such types speak about knowledge of hidden features of compilers and victories in intricate programming contests.  I have not seen such idioms in real projects, besides these scenarios ‚Äù- ibid </blockquote><br><pre> <code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rectangle</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> int_property = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>; <span class="hljs-comment"><span class="hljs-comment">// common signature for several methods int_property top, left, bottom, right, width, height; // declare property methods! // ... ^^^^^^^ };</span></span></code> </pre> <br><p>  Scared?  Intrigued?  Details in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0172r0.html">Tales of the Abominable Function Types</a> ! <br>  <em>Mva ha ha ha ha ...</em> </p><br><h2 id="httpshabrastorageorgwebtpx-sfqpx-sfqejgrhznh02iiw07a9sjhgpng-chuzhie"><img src="https://habrastorage.org/webt/px/-s/fq/px-sfqejgrhznh02iiw07a9sjhg.png">  Strangers </h2><br><img src="https://habrastorage.org/webt/8c/d6/_b/8cd6_b92iw3auos-qyekvdxyfey.jpeg" align="left"><br><blockquote>  <em><strong>Bishop:</strong> No, the cable connection is damaged.</em>  <em>We can not send a plate.</em> <em><br></em>  <em><strong>Ripley:</strong> Someone has to go out, get a portable terminal and connect manually.</em> <br>  "Aliens", 1986 </blockquote><p>  Forgive me this game of words, but it will be about <code>alignas</code> (if you have a strong squint, then you can read as <code>aliens</code> ) and his relatives.  <a href="http://en.cppreference.com/w/cpp/language/alignas">The definition of the keyword</a> <code>alignas keyword specifier</code> appeared in C ++ 11.  It sets the <a href="http://en.cppreference.com/w/cpp/language/object">requirements for</a> type or object <a href="http://en.cppreference.com/w/cpp/language/object">alignment</a> . </p><br><p>  Each type of object has a property called ‚Äúalignment requirement‚Äù.  This is an integer value (type <code>std::size_t</code> and always a power of two) equal to the number of bytes between successive addresses at which objects of this type can be located in memory.  The alignment requirement may be requested using <code>alignof</code> or <code>std::alignment_of</code> .  To get a pointer that is aligned as needed in any buffer, you can use the pointer alignment function <code>std::align</code> , and <code>std::aligned_storage</code> will help you to get the storage aligned as needed.  Any type of object imposes its requirement to align each object of this type.  With the help of <code>alignas</code> you can align more strictly (with the requirement of a larger size).  To meet all the alignment requirements for non-static class members, you can insert indents after some of them. </p><br><h2 id="httpshabrastorageorgwebtfojobefojobens62ztsnlnjtgoyljqa-kpng-demony"><img src="https://habrastorage.org/webt/fo/jo/be/fojobens62ztsnlnjtgoyljqa-k.png">  Demons </h2><br><img src="https://habrastorage.org/webt/ar/ux/w2/aruxw23o5aqkqfebic6udz26byg.jpeg" align="left"><br><blockquote>  <em>Acceptable undefined behavior ranges from completely ignoring the situation with unpredictable consequences to demons departing from your nose.</em> <br>  John F. Woods, <a href="https://groups.google.com/forum/%3Fhl%3Den">comp.</a>  <a href="https://groups.google.com/forum/%3Fhl%3Den">std.</a>  <a href="https://groups.google.com/forum/%3Fhl%3Den">since 1992</a> </blockquote><p>  <strong>Undefined behavior</strong> is perhaps one of the most notorious nasal demons.  It originates in the C language and therefore precedes many other monsters in this directory.  Uncertain behavior is still the real threat, the horror of the unsuspecting apprentice.  <a href="http://en.cppreference.com/w/cpp/language/ub">In</a> short, this behavior makes the <strong>entire</strong> program useless if certain rules of the language are violated. </p><br><p>  Much has already been written about indefinite behavior.  For example, several excellent publications by John Reger ( <a href="https://blog.regehr.org/archives/213">1</a> , <a href="https://blog.regehr.org/archives/1520">2</a> ).  Also look at the recordings of a couple of his speeches ( <a href="https://youtu.be/TPyLrJED0zQ">1</a> , <a href="https://youtu.be/v1COuU2vU_w">2</a> ). </p><br><p>  <strong>Incredible new epic:</strong> in September 2017, the demon showed that he still has gunpowder in the old dog.  This short code snippet <a href="https://www.reddit.com/r/cpp/comments/6xeqr3/compiler_undefined_behavior_calls_nevercalled/">went online</a> : </p><br><pre> <code class="hljs lua">#include &lt;cstdlib&gt; // <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> system() typedef int (*Function)(); // typedef <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pointer</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">type</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Do</span></span></span><span class="hljs-function">; // </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">define</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pointer</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">default</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialized</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to</span></span></span><span class="hljs-function"> 0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EraseAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> system(<span class="hljs-string"><span class="hljs-string">"rm -rf /"</span></span>); } // naughty <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NeverCalled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Do = EraseAll; } // this <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">never</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">called</span></span></span><span class="hljs-function">! </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Do(); } // call default-initialized <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UB</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chaos</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ensues</span></span></span><span class="hljs-function">.</span></span></code> </pre> <br><p>  Clang compiles it into: </p><br><pre> <code class="hljs mel">main: movl $.L.str, %edi jmp <span class="hljs-keyword"><span class="hljs-keyword">system</span></span> .L.str: .asciz <span class="hljs-string"><span class="hljs-string">"rm -rf /"</span></span></code> </pre> <br><p>  And everything, the compiled program executes <code>rm -rf /</code> , although in the source code there is no <code>EraseAll()</code> call!  However, Clang allows you to do this, because the <code>Do</code> function pointer is a static variable and initialized to <code>0</code> , and a call to <code>0</code> results in undefined behavior.  It may seem strange that the compiler generates just such code, but in fact this is only a consequence of how the compilers analyze the program ... </p><br><p>  Read more about this mysterious story <a href="https://kristerw.blogspot.co.il/2017/09/why-undefined-behavior-may-call-never.html">here</a> . </p><br><h2 id="httpshabrastorageorgwebtwtrmemwtrmemntpbovs4dfamipqlaqhl4png-dll-ad"><img src="https://habrastorage.org/webt/wt/rm/em/wtrmemntpbovs4dfamipqlaqhl4.png">  Dll hell </h2><br><img src="https://habrastorage.org/webt/q7/8x/kd/q78xkdchhybbzixens8lbuuzrli.jpeg" align="left"><br><blockquote>  <em>No more terrible suffering</em> <em><br></em>  <em>How to remember the bright times</em> <em><br></em>  <em>In misfortune.</em> <br>  Dante Alighieri, The Divine Comedy, Hell </blockquote><p>  The term <a href="https://ru.wikipedia.org/wiki/DLL_hell">DLL-ad</a> describes the difficulties encountered when working with DLLs that are used by Windows operating systems. </p><br><p>  DLL-hell can manifest itself in different ways when applications do not start or work incorrectly.  Like the <a href="http://historylists.org/art/9-circles-of-hell-dantes-inferno.html">circles of</a> hell Dante Alighieri, dll-hell is a kind of <a href="https://ru.wikipedia.org/wiki/Dependency_hell">dependency hell</a> characteristic of the Windows ecosystem. </p><br><h2 id="httpshabrastorageorgwebtbodpg3bodpg3ovm0qsjvtweajyugyutnepng-utinaya-tipizaciya"><img src="https://habrastorage.org/webt/bo/dp/g3/bodpg3ovm0qsjvtweajyugyutne.png">  Duck typing </h2><br><img src="https://habrastorage.org/webt/eu/gp/sz/eugpsz5woocd88ziofiwqweb9k0.jpeg" align="left"><br><blockquote>  <em>If it looks like a duck and quacks like a duck, but requires a battery, then your abstraction will probably be wrong.</em> <br>  <a href="https://lostechies.com/derickbailey/2009/02/11/solid-development-principles-in-motivational-pictures/">Internets on the Liskov Substitution Principle</a> </blockquote><p>  <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D1%2582%25D0%25B8%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2582%25D0%25B8%25D0%25BF%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">Duck typing</a> is the use of duck dough in type safety.  And the <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D1%2582%25D0%25B8%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2582%25D0%25B8%25D0%25BF%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">duck test</a> is a type of <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25B1%25D0%25B4%25D1%2583%25D0%25BA%25D1%2586%25D0%25B8%25D1%258F_(%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25B8%25D0%25BA%25D0%25B0)">abduction</a> . </p><br><p>  Here is the common expression of abduction: </p><br><p>  <em>If it looks like a duck, swims like a duck and quacks like a duck, then it‚Äôs probably a duck.</em> </p><br><p>  With the "classic" duck typing, type checking should be postponed until the runtime, and for the most part duck typing refers to dynamically typed languages ‚Äã‚Äã(as opposed to C ++).  However, the duck test is used in templates, generic functions, or methods in the context of <strong>static</strong> typing. </p><br><p>  In fact, one of the main goals of applying <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25BD%25D1%2586%25D0%25B5%25D0%25BF%25D1%2586%25D0%25B8%25D1%258F_(%25D0%25A1%252B%252B)">C ++ concepts</a> is a more disciplined template type specification definition (template type specification), and ... well ... </p><br><p>  <strong><em>Behave yourself very, very quietly ... the season of duck typing has come.</em></strong> </p><br><p><img src="https://habrastorage.org/webt/ze/bv/ie/zebviewtwdsxzemccsdned9gzvk.gif"><br>  <em>Concepts against duck typing</em> </p><br><p>  Read more <a href="http://www.drdobbs.com/templates-and-duck-typing/184401971">here</a> . </p><br><h2 id="httpshabrastorageorgwebtxx6do6xx6do6exml8doyb4uaqrk-_epcipng-nlo"><img src="https://habrastorage.org/webt/xx/6d/o6/xx6do6exml8doyb4uaqrk-_epci.png">  UFO </h2><br><img src="https://habrastorage.org/webt/ay/b7/qo/ayb7qoaonrdibla95ixebzkhxfu.jpeg" align="left"><br><blockquote>  <em>Unknown objects are controlled by intelligent beings ...</em> <em><br></em>  <em>It is extremely important to find out where the UFO came from and what their intentions are ...</em> <br>  Admiral Hillenkotter, First Director of the CIA, 1960 </blockquote><p>  C ++ 20 may face intrusion into the language of the new operator. </p><br><p>  <strong>Spacecraft operator &lt;=&gt;!</strong> </p><br><p>  <code>&lt;=&gt;</code> is a single tripartite comparison operator.  If defined, it allows the compiler to automatically generate all other comparison operators: <code>&lt;</code> , <code>&lt;=</code> , <code>==</code> <code>!=</code> , <code>&gt;=</code> , <code>&gt;</code> .  It provides a consistent interface and support for partial ordering and other features. </p><br><p>  Walter E. Brown (Walter E. Brown) <a href="https://youtu.be/_PKpyD6Ba1s">spoke</a> about this operator at CppCon 2017 and introduced the proposal <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0515r2.pdf">P0515R2</a> . </p><br><h2 id="httpshabrastorageorgwebtgwcq-rgwcq-rqnwfkhvdstugyg0o9xprkpng-besy"><img src="https://habrastorage.org/webt/gw/cq/-r/gwcq-rqnwfkhvdstugyg0o9xprk.png">  Demons </h2><br><img src="https://habrastorage.org/webt/z4/me/yk/z4meykthtcmmm73j6swuegfuni4.jpeg" align="left"><br><blockquote>  <em>What is there is easy to confuse with what should be.</em>  <em>Especially if the first is profitable for you.</em> <br>  Tyrion Lanister (Bes) </blockquote><p>  In C ++ standards, two less dangerous brothers of the demon are named ‚Äú <a href="">undefined behavior</a> ‚Äù: demons ‚Äúunspecified behavior‚Äù ( <em><a href="">unspecified behavior</a></em> ) and ‚Äú <a href="">implementation-defined behavior</a> ‚Äù. </p><br><p>  <strong>Implement-dependent behavior</strong> is unspecified behavior in which the selection process is documented by the implementation.  That is, to document / guarantee what exactly should happen, implementation is <strong>necessary</strong> .  And with unspecified behavior, to document or guarantee something, the implementation is <strong>optional</strong> . </p><br><p>  Demons are in different guises - <a href="http://eel.is/c%2B%2Bdraft/impldefindex">this is an impressive (if not depressing) list of famous demons</a> . </p><br><p>  Read on if you dare! </p><br><h2 id="httpshabrastorageorgwebt9qzfxk9qzfxkltxn-janifjcpnj62frxipng-skrytye-peremennye"><img src="https://habrastorage.org/webt/9q/zf/xk/9qzfxkltxn-janifjcpnj62frxi.png">  <strong>Hidden</strong> variables </h2><br><img src="https://habrastorage.org/webt/k-/tl/lh/k-tllhowfy56n8ngrm2kw-2qf-w.jpeg" align="left"><br><blockquote>  <em>Only a lonely enemy can penetrate the cordon.</em>  <em>Once inside, he must become invisible and deliver a strong and sudden blow.</em>  <em>I chose this task.</em> <br>  Shadow, <a href="http://thelivingshadow.wikia.com/wiki/Shadow_Magazine_Vol_1_131">Shadow Magazine # 131 1937</a> </blockquote><p>  <a href="https://en.wikipedia.org/wiki/Variable_shadowing">Variable shadowing</a> occurs when a variable declared in one scope (for example, a block or function) has the same name as another variable defined in the outer scope.  Then the external variable will be hidden by the internal one.  At the same time they say that the internal identifier masks the external one.  Confusion may arise because it is not always clear to which variable the subsequent use of the name of the hidden variable belongs, which depends on the rules for resolving names in the language.  In each scope, the same name or identifier may refer to different variables of completely different types. </p><br><p>  Hiding variables is in no way limited to C ++ alone. </p><br><p>  A vivid <a href="https://godbolt.org/g/WV7DMC">example</a> . </p><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">bool</span></span> x = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; // x <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a <span class="hljs-type"><span class="hljs-type">bool</span></span> auto f(<span class="hljs-type"><span class="hljs-type">float</span></span> x = <span class="hljs-number"><span class="hljs-number">5.</span></span>f) { // x <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a <span class="hljs-type"><span class="hljs-type">float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; <span class="hljs-number"><span class="hljs-number">1</span></span>; ++x) { // x <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> an <span class="hljs-type"><span class="hljs-type">int</span></span> [x = std::string{"Boo!"}](){ // x <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a std::string { auto [x,_] = std::make_pair(<span class="hljs-number"><span class="hljs-number">42</span></span>ul, nullptr);} // x <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> now unsigned long }(); } }</code> </pre> <br><h2 id="httpshabrastorageorgwebtgbzfgugbzfgumh6hoxxycrvoinqhzbdz8png-terminatory"><img src="https://habrastorage.org/webt/gb/zf/gu/gbzfgumh6hoxxycrvoinqhzbdz8.png">  Terminators </h2><br><img src="https://habrastorage.org/webt/mv/kn/6h/mvkn6hp-q2vmkdpl2ovfclmx70i.jpeg" align="left"><br><blockquote>  <em>Hasta la vista, baby!</em> <br>  Terminator </blockquote><p>  In C ++, there are surprisingly many ways to interrupt a program, both routinely and unexpectedly. </p><br><p>  When creating robust programs and libraries, it is important to keep in mind the various methods of abrupt execution interruption.  In addition, many of these conditions can occur when accessing modules, such as a DLL. </p><br><p>  Among the standard terminators of C ++ programs there are numerous varieties of <code>std::exit()</code> , <code>std::abort()</code> , <code>std::terminate()</code> , <code>std::signal()</code> and <code>std::raise()</code> . </p><br><p>  I wrote about some of them in my post about <a href="http://videocortex.io/2016/terminators/">breakers</a> . </p><br><h2 id="httpshabrastorageorgwebt2auz2t2auz2t-xup3gxchsllcnckugwmypng-prozrachnye-obekty"><img src="https://habrastorage.org/webt/2a/uz/2t/2auz2t-xup3gxchsllcnckugwmy.png">  Transparent objects </h2><br><img src="https://habrastorage.org/webt/1p/ks/tc/1pkstc37k36eyamkuprbqobjy5w.jpeg" align="left"><br><blockquote>  <em>A thing, not a man;</em>  <em>child, or even <code>std::less&lt;&gt;</code> something black and amorphous.</em> <br>  Ralph Allison, The Invisible Man </blockquote><p>  A transparent function object appeared in C ++ 14. It accepts arguments of any type and completely redirects them, so you do not need to copy and convert anything when using a function object in a heterogeneous context or with rvalue arguments.  For example, template functions like <code>std::set::find</code> and <code>std::set::lower_bound</code> use this type of element in their comparative types (Compare types). </p><br><p>  Important transparent function objects include <code>std::less&lt;&gt;</code> and <code>std::equal_to&lt;&gt;</code> . </p><br><h2 id="httpshabrastorageorgwebtumsz6numsz6njbdu-roazbdmjtpuad5gypng-edinorogi"><img src="https://habrastorage.org/webt/um/sz/6n/umsz6njbdu-roazbdmjtpuad5gy.png">  Unicorns </h2><br><img src="https://habrastorage.org/webt/gz/6g/wn/gz6gwnghajviqlfrqnimht5m4e0.jpeg" align="left"><br><blockquote>  <em>Good news!</em>  <em>I implemented Unicorn Call Syntax in C ++!</em> <br>  JF Bastien, Twitter, 2016 </blockquote><p>  The proposal for a <em><strong>Unified</strong> Call Syntax</em> describes the idea that <code>f(x,y)</code> could call a component function (member function) <code>xf(y)</code> if <code>f(x,y)</code> missing.  The inverse transform from <code>xf(y)</code> to <code>f(x,y)</code> not proposed. </p><br><p>  <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4474.pdf">For this</a> , a unified call syntax was proposed: <em>‚ÄúWe have already encountered a situation where many types from the standard library are supported by two functions, for example, <code>begin(x)</code> and <code>x.begin()</code> , <code>swap(x,y)</code> and <code>x.swap(y)</code> .</em>  <em>And the problem is aggravated.</em>  <em>It was solved for operators: the expression <code>a+b</code> can be resolved with the help of the separately standing function <code>operator(X,X)</code> or the component function <code>X::operator(X)</code> .</em>  <em>For the set <code>for</code> problem was solved in such a way that both <code>begin(X)</code> and <code>X::begin()</code> can be found.</em>  <em>The existence of solutions for two special cases and a multitude of duplicate functions indicate the need for a common solution.</em>  <em>Each of the two notations has its advantages (for example, it opens sets of overload for non-members and access for members) (open overload sets for members).</em>  <em>But why should the user know what syntax is provided by the library? "</em> </p><br><p>  There are many more questions on the operation of the unified call syntax with the old code, and UCS is not yet implemented in C ++. </p><br><p>  But <a href="http://videocortex.io/2017/Bestiary/godbolt.org/g/yFhKUg">Unicorn Call Syntax will</a> brighten up the most dull code bases: </p><br><pre> <code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _) : _(_) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">operator</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _; }; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>_(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> _) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> unicorn = <span class="hljs-number"><span class="hljs-number">42</span></span>_; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> unicorn; }</code> </pre> <br><h2 id="httpshabrastorageorgwebttfvfbotfvfbo1w5qjrlpj1x76rkr_6xg8png-tipy-volan-de-morta"><img src="https://habrastorage.org/webt/tf/vf/bo/tfvfbo1w5qjrlpj1x76rkr_6xg8.png">  Types of Volan de Mort </h2><br><img src="https://habrastorage.org/webt/_k/gs/wc/_kgswc4trfh8e9eng5h6ngoqf_s.jpeg" align="left"><br><blockquote>  <em>I can move objects without touching them.</em> <br>  Lord Volan de Mort aka He-Who-Who-Can-Call, "Harry Potter" </blockquote><p>  Type Volan de Mort can not be directly given the name outside the scope in which the type was declared, but the external code can use this type. </p><br><p>  The appearance of Volan de Mort types is <a href="https://wiki.dlang.org/Voldemort_types">obliged to the D language</a> , and in C ++ they work the same way.  See these types in action <a href="https://godbolt.org/g/qkD75u">here</a> .  Walter Bright also <a href="http://www.drdobbs.com/article/print%3FarticleId%3D232901591%26siteSectionName%3Dcpp">wrote</a> about them. </p><br><p>  In the example below, <code>Voldemort</code> is a local type inside <code>createVoldemortType()</code> , <code>auto</code> returns a lambda that returns to the caller an instance of <code>Voldemort</code> .  Although we cannot call <code>Voldemort</code> inside <code>main()</code> , but we can use variables of this type, like any other. </p><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">int</span></span> main() { auto createVoldemortType = [] // use lambda auto <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> { struct Voldemort // localy defined <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> { <span class="hljs-type"><span class="hljs-type">int</span></span> getValue() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>; } }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Voldemort{}; // <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> unnameable <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> }; auto unnameable = createVoldemortType(); // must use auto! decltype(unnameable) unnameable2; // but, can be used <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> decltype <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> unnameable.getValue() + // can use unnameable API unnameable2.getValue(); // <span class="hljs-keyword"><span class="hljs-keyword">returns</span></span> <span class="hljs-number"><span class="hljs-number">42</span></span> }</code> </pre> <br><p>  Sometimes Volan de Mort types can be used as a ‚Äúbeggarly‚Äù version of <a href="https://godbolt.org/g/38JynE">anonymous OOP types for operations like ‚Äúfactory‚Äù</a> .  This is a stack polymorphism without pointers and dynamic memory allocation: </p><br><pre> <code class="hljs pgsql">struct IFoo // abstract interface { virtual <span class="hljs-type"><span class="hljs-type">int</span></span> getValue() = <span class="hljs-number"><span class="hljs-number">0</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> auto bar(IFoo&amp; foo) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> foo.getValue(); } // calls virtual interface <span class="hljs-keyword"><span class="hljs-keyword">method</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> main() { auto fooFactory = [] { struct VoldeFoo: IFoo // <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> Voldemort <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> derived <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> IFoo { <span class="hljs-type"><span class="hljs-type">int</span></span> getValue() override { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">42</span></span>; } }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> VoldeFoo{}; }; auto foo = fooFactory(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bar(foo); // works <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> expected, <span class="hljs-keyword"><span class="hljs-keyword">returns</span></span> <span class="hljs-number"><span class="hljs-number">42.</span></span> }</code> </pre> <br><h2 id="httpshabrastorageorgwebtioxy0gioxy0gj4outlz8ixlccq2tda1hcpng-zombi"><img src="https://habrastorage.org/webt/io/xy/0g/ioxy0gj4outlz8ixlccq2tda1hc.png">  Zombie </h2><br><img src="https://habrastorage.org/webt/cz/o9/y6/czo9y6jihuhpcf0uvvdr4-ppxz0.jpeg" align="left"><br><blockquote>  <em>C ++ standards have zombies.</em> <em><br></em>  <em>There are two types of people: some believe that there is nothing bad in having carefully defined zombies, while others think it is better to kill the zombies.</em> <br>  Jens Weller.  <a href="https://www.meetingcpp.com/blog/items/cpp-and-zombies-a-moving-question.html">C ++ and Zombies</a> </blockquote><p>  What happens to an object in scope after moving it? </p><br><p>  Without a destructive movement (which is not currently supported in C ++), the state of the remaining husk object resembles a zombie. </p><br><p>  ‚ÄúWhen you implement displacement constructors and assignment operators, you need to take care not only of the displacement, but also of what remains as a result of it.  Otherwise, you can create a zombie: an object whose value (that is, life) has been moved somewhere. ‚Äù </p><br><p>  In the Eric Niebler manual, it is highly recommended to leave the object in a ‚Äúminimum conscious state‚Äù: ‚ÄúThe <strong>displaced object must be in an adequate but not specified state</strong> ‚Äù.  On the other hand, Sean Parent insists on <strong><a href="http://sean-parent.stlab.cc/2014/05/30/about-move.html">destructive movement</a></strong> . </p><br><p>  Zombies have little to do with <code>std::decay</code> . </p><br><h2 id="httpshabrastorageorgwebtcaqyctcaqyctrjfy290xcmb40vqaqcuo8png-zombi-i-mozgi"><img src="https://habrastorage.org/webt/ca/qy/ct/caqyctrjfy290xcmb40vqaqcuo8.png">  Zombies and brains </h2><br><img src="https://habrastorage.org/webt/ya/vy/y6/yavyy6rxx1bzs4cp4v-acv9hmwc.jpeg" align="left"><br><blockquote>  <em>Brains: what you want to eat [names.zombi].</em> <br>  Richard Smith, <a href="http://eel.is/c%2B%2Bdraft/generalindex">The Holy ISO C ++ Standard Index</a> </blockquote><p>  Okay, kids, ready to really get scared? </p><br><p>  Open your Holy Standard ISO C ++ in Chapter <a href="http://eel.is/c%2B%2Bdraft/zombie.names">20.5.4.3.1 Zombie Names</a> . </p><br><p>  It says: </p><br><p>  <em>" <strong>Brains</strong> : what they want to eat from you [names.zombi]" and " <strong>living dead</strong> , so called [names.Zombi]"</em> </p><br><p>  (I'm not kidding - whoever was waiting for something from this post!) </p><br><p>  We entered the crypt of the Holy Standard, where previously standardized and later obsolete names <code>std</code> rest in peace.  Also among the respected dead are <code>auto_ptr</code> , <code>binary_function</code> , <code>bind1st</code> , <code>bind2nd</code> , <code>random_shuffle</code> , <code>unary_function</code> , <code>unexpected</code> and <code>unexpected_handler</code> . </p><br><p>  But you do not foresee when one of these decrepit inhabitants will suddenly appear in the Legacy code. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  C ++ is a real source of inspiration for creepy Halloween ideas!  But I am sure that this reference book is far from complete.  If I missed someone in the depths of C ++, tell me on Twitter, Reddit, or find me on the <a href="https://cpplang.now.sh/">C ++ Slack</a> channel. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/341584/">https://habr.com/ru/post/341584/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341568/index.html">IBM used in-memory computing for machine learning</a></li>
<li><a href="../341570/index.html">Why a good IaaS-provider does not build its data center: 5 main reasons</a></li>
<li><a href="../341576/index.html">Automation of work in SAP using VBScript</a></li>
<li><a href="../341578/index.html">Announcement of Moscow Python Meetup # 50</a></li>
<li><a href="../341580/index.html">Writing a to-do list in Python 3 for Android via QPython3 and SL4A</a></li>
<li><a href="../341586/index.html">About the stack in simple words - for students and beginners.</a></li>
<li><a href="../341590/index.html">How can I hack your own Web project?</a></li>
<li><a href="../341598/index.html">Cyber ‚Äã‚Äãoracle: search for anomalies in monitoring data using a neural network</a></li>
<li><a href="../341600/index.html">Open broadcast of the main hall HighLoad ++</a></li>
<li><a href="../341602/index.html">Modern Android development on Kotlin. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>