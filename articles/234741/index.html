<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Speed: terminal acceleration for stock trading with undocumented features</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The main means of working in the stock market for most traders is a special trading terminal - even algorithmic traders who run special trading robots...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Speed: terminal acceleration for stock trading with undocumented features</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/410/ef1/eec/410ef1eec3cbc7f0260f95b8cc6157ab.png" align="left">  The main means of working in the stock market for most traders is a special <a href="http://habrahabr.ru/company/itinvest/blog/203668/">trading terminal</a> - even algorithmic traders who run special trading robots use it to control the account balance.  At the junction of HFT and ‚Äúordinary‚Äù trading, problems sometimes arise - often the terminal cannot ‚Äúdigest‚Äù information from tens of thousands and millions of applications and transactions of trading software and starts to work slower. <br><br>  In conditions when each millisecond can cost real and very big money, this is unacceptable.  Today we will talk about a small life hack, which allows you to dramatically increase the performance of the SmartX trading terminal (our development) in five minutes. <a name="habracut"></a><br><br><h4>  Several million applications: what to do? </h4><br>  When developing your project for the SmartX trading terminal (you can read more about the project in a <a href="http://habrahabr.ru/company/itinvest/blog/213825/">separate topic</a> ), special attention was paid to performance.  In particular, it took a lot of effort to make fast-working graphics (the terminal was developed on the basis of the <a href="http://www.modulusfe.com/m4/">M4</a> platform on COM +) ‚Äîfor this, we had to connect third-party developments and switch to .NET. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Attention was also paid to the creation of a special DataManager module, which is responsible for the interaction of the terminal with the brokerage <a href="http://habrahabr.ru/post/201702/">trading system</a> . In the previous version of the terminal, it was single-threaded, which created performance problems in the case of large volumes of ‚Äúpumped‚Äù data.  The new module has become multi-threaded and asynchronous, which allows the terminal to display 2 million applications.  In addition, according to test data, the terminal is faster and sends applications - during a comparative test with another popular terminal on the market, SmartX sent 100 applications in 0.0099 seconds, and its rival - in 0.018 seconds (this is before callback registration of applications) . <br><br>  However, as mentioned above, sometimes these opportunities are not enough for demanding traders - some robots can quite easily make over 2 million requests per day.  There are not so many such users of the program, but they are there, and they needed to be given some opportunities to increase their productivity. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7c5/971/a73/7c5971a730f38b556283fcfd3edd39e7.gif" alt="image"><br><br>  As a result, it was decided to give them the ability to disable certain parameters affecting performance using a special configuration file ‚Äî technically advanced HFT merchants are familiar with this method, while other users did not need to make additional menus in the settings that could confuse them . <br><br><h4>  Performance Improvement and Configuration File </h4><br>  In the folder that is created after installing the trading terminal, there is a file (smartx_exe.config) - it contains a small XML-code with options.  Changing them allows you to configure the terminal more flexibly and get rid of possible performance problems. <br><br>  The content of the file looks like: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">setting</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DoNotMergeOrdersWithQuotes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">serializeAs</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">setting</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">setting</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DoNotCacheCanceledOrders"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">serializeAs</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">setting</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">setting</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DoNotRequestOrdersHistory"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">serializeAs</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">setting</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Changing the value of three fields from True to False helps to significantly improve the performance of the program.  Let us dwell on each of the three points. <br><br><h5>  DoNotMergeOrdersWithQuotes </h5><br>  The flow containing the order data and the flow of information about the change of quotations in the terminal ‚Äúmerge‚Äù - in the ‚Äúapplication‚Äù field in the program, the user sees not only the information directly about it, but also some information about the bidding - purchase and sale prices (bid, ask, ) and some other data (for example, the price of the last transaction).  This is necessary, among other things, for the operation of one of the functions of embedded risk management - ‚Äútrailing stop order‚Äù. <br><br><div class="spoiler">  <b class="spoiler_title">What is a trailing stop?</b> <div class="spoiler_text">  Traders limit losses and take profits with STOP orders.  For example, when buying stocks or futures, a trader can set a stop at a certain price mark, upon reaching which his position is liquidated - in this case stocks or futures will be sold at the current market price.  Such orders have one drawback - they periodically need to be removed and re-exposed with the edited conditions.  If the price "went" upwards, then leaving the original order is unprofitable, since if it falls, the potential profit will be lost. <br><br>  Using the function of a moving stop order, you can automatically ‚Äúpull up‚Äù the value of the stop following the changed price of a financial instrument.  In the case of a long position (presence of purchased shares or futures), the moving stop for the sale of shares (sell operation) will increase with price and will not change with its decrease.  In the case of a short position (sold by a broker to ‚Äúborrow‚Äù shares with the expectation of a drop in their value for further redemption), a sliding stop at its closure (closeshort) will, on the contrary, decrease with a fall in price and will not change if it grows. <br></div></div><br>  In addition, the merging of order flows and bidding information is necessary to calculate information about the collateral that should be withheld from the client to guarantee his transaction obligations ‚Äî the state of the account depends on the number of bids made (the greater the number, the less available funds, since future transactions are needed than provide something). <br><br>  If this value is set to False, then orders and quotes will not merge, which will improve performance.  This method is well suited for those traders who put up many bids and work with instruments that often change market parameters.  Refusal to process them saves system resources. <br><br><h5>  DoNotCacheCanceledOrders </h5><br>  Disabling this feature prevents the program from storing canceled requests in the memory.  In general, they do not carry much value for a trading strategy, but especially active traders may have a lot of them (up to millions).  Refusal to store this information allows you to save system memory, as well as speed up the drawing of the table of requests and schedules (in case current requests are displayed on it by lines). <br><br><h5>  DoNotRequestOrdersHistory </h5><br>  Rejection of this item brings the greatest performance gain in the event that the connection to trading occurs in the middle of the trading session.  In addition, this function is closely related to the previous item. <br><br>  When a trader has a lot of canceled orders (which the trading robot put up and removed, for example), then when connected to the trading terminal, he requests information from the broker's database about all the requests of a particular user.  In the event that there are millions of these applications for their ‚Äúpumping over‚Äù it takes time and memory to store them.  Accordingly, the rejection of this function allows you to speed up the operation of the terminal. <br><br>  In the terminal of the previous generation there were no such opportunities.  As a result, in the presence of several tens of thousands of applications, he began to ‚Äúslow down‚Äù greatly.  The new product is faster by itself and can cope with about 2 million applications without any special problems, and when you turn off the above settings, its performance grows even more.  At the same time, it takes quite a bit of time to make changes to the configuration file. <br><br>  These items are not available through the standard terminal settings menu, so the ‚Äúundocumented features‚Äù can be used by those who really need it, and most users can use the program without complicating its interface. <br><br>  PS If you find a typo or mistake, write us a personal message and we will fix everything promptly. <br><br>  <b>Posts and related links:</b> <br><br><ul><li>  <a href="http://habrahabr.ru/company/itinvest/blog/203668/">Stock Market Tools: Trading Terminal</a> </li><li>  <a href="http://habrahabr.ru/company/itinvest/blog/213825/">Exchange software: the history of the creation of the trading terminal</a> </li><li>  <a href="http://www.itinvest.ru/software/comp/smartx/">SmartX terminal</a> </li><li>  <a href="http://habrahabr.ru/company/itinvest/blog/223551/">Interview: how C # and C ++ help make money on the stock market</a> </li><li>  <a href="http://www.itinvest.ru/services/test/">Test account on the exchange (with virtual money)</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/234741/">https://habr.com/ru/post/234741/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234729/index.html">Protecting the site from scanning and chaotic intensive requests</a></li>
<li><a href="../234731/index.html">Algorithm for adopting someone else's project or what to do when managers have a honeymoon</a></li>
<li><a href="../234735/index.html">Changing the structure of sections on Habrahabr</a></li>
<li><a href="../234737/index.html">Flask Mega-Tutorial, Part 11: Email Support</a></li>
<li><a href="../234739/index.html">InFocus M512 - a budget device for Snapdragon 400 and with support for 4G networks</a></li>
<li><a href="../234743/index.html">Open lecture on the basics of Swift from MasterUp</a></li>
<li><a href="../234745/index.html">New virtual monitoring features for System Center with Veeam Management Pack v7</a></li>
<li><a href="../234747/index.html">Python, how would I like to see it</a></li>
<li><a href="../234749/index.html">Extremely cool tester-style programming!</a></li>
<li><a href="../234753/index.html">Natural selection - the enemy of the bot</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>