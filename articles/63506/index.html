<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automating iTunes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Adding music to iTunes, I was faced with the fact that a large number of songs do not have properly spelled tags. It looks like this 



 A detailed i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automating iTunes</h1><div class="post__text post__text-html js-mediator-article"> Adding music to iTunes, I was faced with the fact that a large number of songs do not have properly spelled tags.  It looks like this <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/882/ad1/8f9/882ad18f9080a11fdf1271dd99deb83a.png" alt="image"><br><br>  A detailed inspection showed that this is not a problem of encodings.  The tags in the tracks are exactly that they were filled with '?' Signs. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  As it turned out, not everything is lost, as the name of the file, as well as the directory in which this file is located, contains all the necessary information, such as artist, album, year, name and track number <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/fae/dea/1b7/faedea1b74d60887f0f0d5baa62b0d7c.png" alt="image"><br><br>  To correct the tracks in iTunes, you can simply take the path to the file, select from it the pieces of interest and write them into the appropriate tags.  For this problem, it was decided to use AppleScript.  Exhaustive documentation on it can be found here <a href="http://developer.apple.com/documentation/applescript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html">AppleScript Guide</a> , and examples of working scripts here <a href="http://dougscripts.com/itunes/">Doug's Scripts</a> <br><br>  Roll up the sleeves, run the Script Editor <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/b13/ac5/ce0/b13ac5ce0a11dea3a78a5ce3038782ec.png" alt="image"><br><br>  In the Windows&gt; Library menu, select the iTunes application that interests us. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/0c1/950/76c/0c195076cc5fc626254cbd1a14bf7ca7.png" alt="image"><br><br>  This will give us a description of the application objects for scripting. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a0a/7d1/b01/a0a7d1b010f77e2def4e0f92fefd3e7f.png" alt="image"><br><br>  AppleScript, unlike other programming languages, is very similar to English. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/345/bb7/888/345bb7888494ae7fe7d8cdf9300f6e5e.png" alt="image"><br><br>  Some AppleScript programs are indistinguishable from high school student notes.  Minus - those who programmed in other languages ‚Äã‚Äãwill initially be quite tight.  However, there is a plus - in addition to the ability to automate applications in Mac OS X, programming with AppleScript gives good practice in English. <br><br>  There are two ways to see the results of the script: using the return and Result console, <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/0ec/ba9/5bf/0ecba95bff267b9721ca61e9c4bf7bc1.png" alt="image"><br><br>  either by using the log in the Event Log panel <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a3f/253/437/a3f253437dacaa33b55180d29230f102.png" alt="image"><br><br>  There is also such a thing as the display dialog, but this is for advanced users. <br><br>  Returning to our problem of parsing the file name.  This is done somewhat unobvious <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/c26/b1e/7eb/c26b1e7eb294ff2c38aba2a4827879c9.png" alt="image"><br><br>  But if you get a grasp, then everything is clear.  English grammar up to possessive declension.  Notice that a list of <code>text items of filename</code> returned.  To get an element of this list, you just need to specify the number of the desired element (numbering from one) <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/8ce/696/df9/8ce696df9d5dc4d5818f2a0651d09447.png" alt="image"><br><br>  And do not forget about the grammar <code>text item 5 of filename</code> .  It is not clear why the developers of AppleScript did not go further and did not replace, say, the numbers with the corresponding verbal notation. <br>  In general, working with strings in AppleScript is somewhat clumsy in a non-English-speaking look, on the other hand you quickly get used to it and sometimes without knowing how to write down this or that construction, you simply write in English.  It turns out a working program. <br><br>  The final parsing of the file name to the parts of interest looks like this <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/139/6fe/2f7/1396fe2f751a8ad1a41874cbe3ee36ce.png" alt="image"><br><br>  Tracks will be processed in iTunes.  For this we will work in a loop with a list of selected tracks.  We will get the list of selected tracks using selection. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/38a/9af/e6a/38a9afe6a3d326d9fa87c2cabcb72243.png" alt="image"><br><br>  The properties (tags) we are interested in can be found in the documentation we opened earlier. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/8da/c74/23f/8dac7423f2a5b24e433ae638537f8719.png" alt="image"><br><br>  The final script looks like this <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/353/ca8/b86/353ca8b86099a237ae660c8c0e655c22.png" alt="image"><br><br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">tell application "iTunes" <br> if selection is not {} then -- there ARE tracks selected... <br> set sel to a reference to selection <br> repeat with aTrack in sel <br> set filename to location of aTrack as text <br> set AppleScript's text item delimiters to ":" <br> set artst to text item 5 of filename as text <br> set albm to text item 6 of filename as text <br> set title to text item 7 of filename as text <br> set AppleScript's text item delimiters to "" <br> -- work on album and year <br> set dashIdx to offset of "-" in albm <br> set yr to items 1 thru (dashIdx - 1) of albm as text <br> set albm to items (dashIdx + 1) thru -1 of albm as text <br> -- work on title <br> set dashIdx to offset of "-" in title <br> set trackNo to items 1 thru (dashIdx - 1) of title as text <br> set title to items (dashIdx + 1) thru -4 of title as text <br> set year of aTrack to (yr as integer) <br> set artist of aTrack to artst <br> set name of aTrack to title <br> set track number of aTrack to (trackNo as integer) <br> set album of aTrack to albm <br> end repeat <br> end if <br> end tell</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">tell application "iTunes" <br> if selection is not {} then -- there ARE tracks selected... <br> set sel to a reference to selection <br> repeat with aTrack in sel <br> set filename to location of aTrack as text <br> set AppleScript's text item delimiters to ":" <br> set artst to text item 5 of filename as text <br> set albm to text item 6 of filename as text <br> set title to text item 7 of filename as text <br> set AppleScript's text item delimiters to "" <br> -- work on album and year <br> set dashIdx to offset of "-" in albm <br> set yr to items 1 thru (dashIdx - 1) of albm as text <br> set albm to items (dashIdx + 1) thru -1 of albm as text <br> -- work on title <br> set dashIdx to offset of "-" in title <br> set trackNo to items 1 thru (dashIdx - 1) of title as text <br> set title to items (dashIdx + 1) thru -4 of title as text <br> set year of aTrack to (yr as integer) <br> set artist of aTrack to artst <br> set name of aTrack to title <br> set track number of aTrack to (trackNo as integer) <br> set album of aTrack to albm <br> end repeat <br> end if <br> end tell</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">tell application "iTunes" <br> if selection is not {} then -- there ARE tracks selected... <br> set sel to a reference to selection <br> repeat with aTrack in sel <br> set filename to location of aTrack as text <br> set AppleScript's text item delimiters to ":" <br> set artst to text item 5 of filename as text <br> set albm to text item 6 of filename as text <br> set title to text item 7 of filename as text <br> set AppleScript's text item delimiters to "" <br> -- work on album and year <br> set dashIdx to offset of "-" in albm <br> set yr to items 1 thru (dashIdx - 1) of albm as text <br> set albm to items (dashIdx + 1) thru -1 of albm as text <br> -- work on title <br> set dashIdx to offset of "-" in title <br> set trackNo to items 1 thru (dashIdx - 1) of title as text <br> set title to items (dashIdx + 1) thru -4 of title as text <br> set year of aTrack to (yr as integer) <br> set artist of aTrack to artst <br> set name of aTrack to title <br> set track number of aTrack to (trackNo as integer) <br> set album of aTrack to albm <br> end repeat <br> end if <br> end tell</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br><br>  Note the type conversion (as text, as integer) when setting or getting the properties of an object. <br><br>  After that, just select the track in iTunes and run the script <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/7a8/d8e/432/7a8d8e43200056075ee260fab73e8e32.png" alt="image"><br><br>  Voila, as they say. <br><br>  It remains only to save the script in <code>~/Library/iTunes/Scripts</code> and it will be available under the name under which you saved it in the iTunes menu <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/b94/1e8/396/b941e83964f866d52deb17dd26b1e97f.png" alt="image"><br><br>  Happy Scripting! <br><br></div><p>Source: <a href="https://habr.com/ru/post/63506/">https://habr.com/ru/post/63506/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../63499/index.html">Finals "What do you do with Linux?"</a></li>
<li><a href="../63500/index.html">BBC trying to convince to give full-text RSS</a></li>
<li><a href="../63501/index.html">OBOOBS.RU // Open B (.) (.) BS Project - a small project about boobs (for women)</a></li>
<li><a href="../63502/index.html">Personal computer (laptop), as a radio station?</a></li>
<li><a href="../63504/index.html">What Do You Think About Future - Award Winners</a></li>
<li><a href="../63507/index.html">Guglonomika Secrets</a></li>
<li><a href="../63509/index.html">Launched the world's largest communications satellite</a></li>
<li><a href="../63510/index.html">Design content will not spoil?</a></li>
<li><a href="../63512/index.html">What hosting services do you use?</a></li>
<li><a href="../63517/index.html">Extrapolation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>