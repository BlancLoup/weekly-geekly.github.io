<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NeoQUEST - summing up</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As planned, on March 14, 2012, we completed NeoQUEST-2012. Total points are calculated, the winners are named; In the next few days, we will definitel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NeoQUEST - summing up</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://neoquest.ru/"><img src="https://habrastorage.org/storage2/21b/956/55c/21b95655c4a06c991a2506e3ea0afe29.png" align="left"></a>  As planned, on March 14, 2012, we completed NeoQUEST-2012.  Total points are calculated, the winners are named;  In the next few days, we will definitely contact them and determine when and where they will receive their honestly deserved prizes (including our main prize, the very MacBookPro, which appeared in the quest). <br>  Now you can summarize the quest, tell about how we did it and about what difficulties we encountered.  And, of course, thank all those who took part both in the quest itself and in its creation and debugging. <a name="habracut"></a><br><br><h4>  Final results </h4><br>  At the date of the official quest closing results, the number of registered participants reached 1,480 people.  Much or less - you decide.  A separate pleasant moment for us was the fact that many participants registered after the start of the competition;  This means that information about the quest spread and interest was not only in the first days. <br><br>  Prizes were taken by: <br><ol><li>  More Smoked Leet Chicken </li><li>  BECHED &amp; Andrey1800. </li><li>  <a href="https://habrahabr.ru/users/ki11obyte/" class="user_link">ki11obyte</a> . </li></ol><br>  The team More Smoked Leet Chicken not only completed all the tasks, but also did it in the shortest time.  They are awarded the main prize of our competition.  The participants of BECHED &amp; Andrey1800 and killobyte are awarded prizes for the second and third places of our competition.  In addition, all participants who completed the first stages of the quest will receive memorable gifts from us.  From the very beginning of the quest, we were amazed at your activity in finding bugs and vulnerabilities, cracking everything hacked and unbreakable.  You found such moves, which we had no idea, and enthusiastically understood those areas that we had not encountered before. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Passage Notes </h4><br>  Despite the fact that the quest is officially completed, two more weeks of assignments will be available for completion.  If you want to try to go through it yourself, then this section is better to skip. <br>  Of course, the described methods of passing tasks are not the only possible ones.  How many participants - so many options for passing. <br><br>  When creating NeoQUEST, we pursued the following goals: <br><ul><li>  find a compromise between complexity and time of passage.  The quest must be successfully completed not only by teams of experienced professional players, but also by qualified computer security specialists, including advanced students of relevant specialties.  The net time for the completion of all tasks, according to our calculations, should have been about 10-12 hours; </li><li>  move away from the prevailing web security quest; </li><li>  to bring tasks to those situations that we all often face in our professional activities.  Quest should not be "art for art's sake"; </li><li>  cover various aspects of information security: from the protection of SCADA-systems to the elements of steganography and social engineering; </li><li>  Combine tasks with a common exciting plot, create a holistic interesting game. </li></ul><br>  Let's see what came of it.  Quest is logically divided into 5 sections: <br><ol><li> Web application security (tasks 1, 2). <code><font color="green">// -       !</font></code> </li><li>  Cryptography (task 3). <code><font color="green">//     , ?</font></code> </li><li>  Security SCADA-systems (task 4). <code><font color="green">//      ‚Ä¶</font></code> </li><li>  Windows security (tasks 5, 6). <code><font color="green">//  ‚Ä¶</font></code> </li><li>  Search for information in the container (tasks 7, 8). <code><font color="green">//     ‚Ä¶</font></code> </li></ol><br><h5>  Section 1 (tasks 1, 2).  Web server: </h5><br>  To complete the tasks in this section, it suffices to be able to identify and use vulnerabilities in web applications, in particular, with SQL-injection.  As a web server, the Mint + lampp combination is used, where there are several php-skipts for working with the database and outputting the contents of the tables.  Some of them contain errors, for example, a vulnerable query to the database: <br><pre> <code class="php hljs">$id = str_replace( <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'_'</span></span>, <span class="hljs-string"><span class="hljs-string">']'</span></span>, <span class="hljs-string"><span class="hljs-string">'['</span></span>, <span class="hljs-string"><span class="hljs-string">')'</span></span>, <span class="hljs-string"><span class="hljs-string">'('</span></span>, <span class="hljs-string"><span class="hljs-string">'$'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://'</span></span>, <span class="hljs-string"><span class="hljs-string">'ftp://'</span></span>, <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-string"><span class="hljs-string">'.'</span></span>, <span class="hljs-string"><span class="hljs-string">'+'</span></span>, <span class="hljs-string"><span class="hljs-string">'='</span></span>, <span class="hljs-string"><span class="hljs-string">'data'</span></span>, <span class="hljs-string"><span class="hljs-string">'base64'</span></span>, <span class="hljs-string"><span class="hljs-string">'cmd'</span></span>, <span class="hljs-string"><span class="hljs-string">'phpinfo()'</span></span>, <span class="hljs-string"><span class="hljs-string">'union'</span></span>, <span class="hljs-string"><span class="hljs-string">'select'</span></span>, <span class="hljs-string"><span class="hljs-string">'from'</span></span>, <span class="hljs-string"><span class="hljs-string">'where'</span></span>, <span class="hljs-string"><span class="hljs-string">'UNION'</span></span>, <span class="hljs-string"><span class="hljs-string">'SELECT'</span></span>, <span class="hljs-string"><span class="hljs-string">'FROM'</span></span>, <span class="hljs-string"><span class="hljs-string">'WHERE'</span></span> ), <span class="hljs-string"><span class="hljs-string">''</span></span>, $id ); $id = htmlspecialchars($id); $query = <span class="hljs-string"><span class="hljs-string">"SELECT * FROM news WHERE id=$id"</span></span>;</code> </pre> <br>  The simplest query that solves the problem is as follows: <br>  <a href="">http: //***/news/comments.php? id = 1 unNion sElect 1, name, pass, 4 fRom users</a> <br><br>  Also on the server is a pseudo-admin panel, which is visible to only one user and allows you to download an image from the FreeBSD virtual machine.  The path to the admin panel can be obtained from the robots.txt file, the contents of which look like this: <br><br> <code>User-agent: * <br> Disallow: /cgi-bin/ <br> Disallow: /administrador/ <br></code> <br><h5>  Section 2 (task 3).  Decryption logs.  FreeBSD + proxy: </h5><br>  This task required participants to know the cryptographic algorithms RC4 and RSA, the specifics of the choice of encryption parameters and the fundamentals of cryptanalysis. <br>  On a FreeBSD virtual machine, the logs pre-encrypted with the RC4 algorithm are stored on the key, which is subsequently encrypted with RSA.  The value of the open exponent for RSA is chosen minimal (equal to 3) so that the messages can be decrypted in a couple of seconds.  To obtain the expansion of the number N (the key module in the RSA algorithm), it is necessary to apply the attack using the keyless decryption of the message: <a href="http://algolist.manual.ru/defence/attack/rsa.php">http://algolist.manual.ru/defence/attack/rsa.php#RSA1</a> .  Having obtained the key of the symmetric cipher, it is necessary to decrypt the logs with the RC4 algorithm, for example, here: <a href="http://www.crypo.com/tools/eng_rc4.php">http://www.crypo.com/tools/eng_rc4.php</a> . <br>  The logs contain records of two addresses: reactor and hider. <br><br><h5>  Section 3 (task 4).  SCADA.  Default password: </h5><br>  Choosing WinCC as a scud, we are faced with some problems that, however, are not unique to this system.  WinCC categorically did not want to take part in NeoQUEST, in particular, completely refused to pick up operating system updates, which left some ‚Äúvery obvious‚Äù vulnerabilities open.  Some participants used these vulnerabilities and "broke" us scud, but we expected this and were ready for such a development of events. <br>  A scheme is deployed on WinCC (according to the legend, the LNPP reactor), when accessed via the web interface, the necessary flag is issued.  Web access has a default password, which can be found in the WinCC documentation. <br><br><h5>  Section 4th (task 5, 6).  Windows: </h5><br>  The tasks in this section covered the security aspects of custom versions of Windows;  for their passage, participants need to know how Windows defines access rights to files (in particular, which give owner privileges), how to increase the level of access in the operating system, using, for example, privilege elevation vulnerabilities.  To distribute the image of virtual machines (800 meters!), It was decided to use a p2p network - torrents, so that the players were more comfortable, and we could maintain a normal speed in any conditions.  In the first part, you need to open files from a folder that only system administrators have access to.  It was planned that for this it is necessary to launch an exploit of privilege escalation, but there is another way (much easier) - to boot from the LiveCD or connect a virtual disk to another virtual machine.  We tried in every way to complicate the second way (from the LiveCD) and push the participants to the first (with the exploit).  To do this, disable the built-in administrator account;  created an ‚ÄúExperienced User‚Äù for which the privilege elevation exploit is widely known;  they made an encrypted TrueCrypt partition, removed it out of sight;  have it be automatically mounted only when logged in as administrator;  and even the source with the exploit (with some errors, of course, but it still significantly simplified the task) was thrown on the desktop. <br>  After obtaining administrator rights, you need to play a little more with the set file permissions to get access to the container. <br><br><h5>  Section 5 (task 7, 8).  Container Parsing: </h5><br>  For the passage of these tasks, you need to subassemble a little bit, and slightly touch on social engineering, and just logically speculate.  The resulting flag produces an exe file that is hidden in the container.  The figure shows the scheme of the container: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/ebf/92a/3cd/ebf92a3cd34aab0c7114ed6a1aaa959d.png"></div><br><br>  Inside the directory on the encrypted section is a PNG file that contains the user id from vk.com.  On this page are a few tips.  An archive is added to the end of the PNG, and if you change the file extension from PNG to RAR, it will open as an archive.  The data is archived with a password, the algorithm for obtaining which is specified in the status of the user on the VK page.  Inside the archive is a file that looks like a WAV file (you can even listen to it), but in fact, it is a clogged exe with a WAV header (a hint about this, too, in VK).  The key for xor is in a PNG image in disguised form.  The executable file accepts a key at the input and issues the last flag. <br><br><h4>  Organizational difficulties that could have been avoided </h4><br>  For our team, this was the first experience of organizing such an event, and now, based on the results of the work done, we can say what things had to be done differently.  The main conclusions will probably be the following: <br><ol><li>  No web-hosting (or time-tested).  When we started developing NeoQUEST-2012, we decided that the registration form should be hung up on some hosting.  They thought that there should be no problems with a simple website.  This is where we made a mistake.  The main overlays were connected with this problem.  Hosting could not resist even a simple site registration.  Failures he gave constantly, and when trying to quickly understand the problem, we received an endless bureaucratic chain of calls and approvals from various people on the part of the hoster, who did not want to take on any additional responsibility.  "Only the administrator can restart the server, but it will not be until Monday."  No, the company can also be understood, we are not their only clients, they still solve problems.  It‚Äôs just that in situations when the result is of high quality and on time, it‚Äôs better to remember the ancient rule: ‚Äúif you want to do something well, do it yourself‚Äù. </li><li>  You need a very careful approach to renting servers.  Server rental has its pros and cons.  Our site does not allow getting round-the-clock physical access to servers, so we decided to rent the server on the side.  The advantages of such a solution seemed obvious - we do not depend on the difficulties that may suddenly arise at the main site (power outages at the weekend, for example) and we don‚Äôt have to be on duty around this server around the clock.  But no, and here we were waited by unexpected surprises.  For example, a sudden decision by a server vendor to reconfigure a network that was never reported to us.  The conclusion is the same as in the previous paragraph. </li></ol><br>  Throughout the registration period, we carefully monitored the comments and comments made here on Habr√© and on other platforms, and tried to promptly correct the jambs.  Many thanks to all who informed us about them. <br><br><h4>  Conclusions and thanks </h4><br>  Hack quests are rather a kind of recreation and entertainment for initiates.  And, despite the stated loud goals (and ominous secret goals that were attributed to us by some commentators), for the whole of our NeoQUEST team first of all served as an opportunity to create an interesting hacker game.  We hope that during the passage of the quest you received no less pleasure than we did when it was prepared.  As we have already said, this was the first experience of such work for our company: the experience is unusual, useful and exciting, and we are not going to stop there. <br><br>  On behalf of our company, we sincerely thank: <br><ul><li>  Danila and Boson, who have devoted a large part of their time to creating and supporting the project; </li><li>  everyone who participated in the filming of our videos; </li><li>  our friends and colleagues on thematic network resources that were not indifferent to the fate of the quest and who (sometimes quite unexpectedly for us!) told about our quest on the Web; </li><li>  all responded here, on Habr√©, and on other resources, and to everyone who wrote us about errors and miscalculations in support - this helped us catch large shoals in time (collapse of the registration form) and promptly retouch small ones (such as a countdown timer). belt, or invalid characters in the city input field, etc.) </li><li>  and, of course, all participants and prize winners for being interested in NeoQUEST and not taking your time to solve our mysteries, for your perseverance and activity. </li></ul><br>  We have worked together nicely and invite everyone to further cooperation! <br>  Thank you very much again and see you at the next NeoQUEST! </div><p>Source: <a href="https://habr.com/ru/post/139818/">https://habr.com/ru/post/139818/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139807/index.html">Examine C # in 30 days</a></li>
<li><a href="../139808/index.html">Instagram for Android "will be something even better than for iOS"</a></li>
<li><a href="../139811/index.html">Decoding HTML5</a></li>
<li><a href="../139812/index.html">Kyiv IT Quest II - 04/20/2012</a></li>
<li><a href="../139816/index.html">Face Recognition in iOS 5.1</a></li>
<li><a href="../139819/index.html">Phobos-Grunt. Lessons for those left on Earth</a></li>
<li><a href="../139820/index.html">Mysterious Marks</a></li>
<li><a href="../139823/index.html">Cognition and internal user experience</a></li>
<li><a href="../139824/index.html">Rescue Technology Competition</a></li>
<li><a href="../139825/index.html">Cisco 1000 Series Routers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>