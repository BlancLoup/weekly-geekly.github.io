<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PVS-Studio and 3DO emulators</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Renounce no longer concern emulation 3DO console, I confess. But then I had the opportunity to work with such an exotic thing as a static code analyze...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PVS-Studio and 3DO emulators</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/420/fa9/602/420fa96027016bc0d3c11cffb604adf3.png" alt="Picture 2"><br>  Renounce no longer concern emulation 3DO console, I confess.  But then I had the opportunity to work with such an exotic thing as a static code analyzer, namely, <a href="http://www.viva64.com/ru/pvs-studio/">PVS-Studio</a> .  The first thing I decided to try out the analyzer of course became my 3DO console emulator (Phoenix Project).  In the beginning of the 90s there was such a prefix, the first 32-bit console with a CD-drive, I remember my brother and I brought her father from Moscow, since then I can not tear myself away.  Well, once the case has turned up, then for one and all the main projects for 3DO emulation we will check.  So let's go ... <br><a name="habracut"></a><br><h2>  FreeDOCore - the original kernel from the repository in GoogleCode. </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/c41/1b3/5e7/c411b35e7f38f631777120f31b51521f.png" alt="Picture 3" title="FreeDO - Project Logo"><br><br>  <i>Project website</i> : <a href="http://www.freedo.org/">http://www.freedo.org/</a> . <br><br>  <i>Audit</i> : 8. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>Help</i> : the first and you can say the only emulator of this console, all the rest one way or another based on this code. <br><br>  <b>Write error</b> <br><br>  <b>V523: The 'then' statement is equivalent to the 'else' statement.</b> <br><br>  <b>Line 673 - clio.cpp</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/daf/8c2/d3b/daf8c2d3bb46a21a77810a786e73b6ef.png" alt="Picture 12" title="Alone In The Dark 2 - Interplay Logo"><br><br>  The usual compiler, even for Warning, does not consider such charm: <br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((cregs[<span class="hljs-number"><span class="hljs-number">0x404</span></span>])&amp;<span class="hljs-number"><span class="hljs-number">0x200</span></span>) { ptr=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(len&gt;=<span class="hljs-number"><span class="hljs-number">0</span></span>) { b3=_xbus_GetDataFIFO(); ... } cregs[<span class="hljs-number"><span class="hljs-number">0x400</span></span>]|=<span class="hljs-number"><span class="hljs-number">0x80</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ptr=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(len&gt;=<span class="hljs-number"><span class="hljs-number">0</span></span>) { b3=_xbus_GetDataFIFO(); ... } cregs[<span class="hljs-number"><span class="hljs-number">0x400</span></span>]|=<span class="hljs-number"><span class="hljs-number">0x80</span></span>; }</code> </pre> <br>  In this case, not only an extra code, but also an emulation error, XBUS is bidirectional, but in this case it always works on reading, which of course is not critical for emulating a CD-ROM drive, but it is still a gross and potentially dangerous error for emulated games. - what if some of them would burn a pig in the head ?!  But seriously, instead of writing to the emulated XBUS interface, the memory specified in the DMA registers will be corrupted, and of course with such an approach it is impossible to emulate such a rarity as the FZ-EM256 3DO Memory Unit. <br><br>  <b>Read error</b> <br><br>  <b>V614: Potentially uninitialized variable 'val' used.</b> <br><br>  <b>Line 803 - clio.cpp</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e58/445/f6c/e58445f6c4dfaac17b5d487a1e886117.png" alt="Picture 13" title="Casper - Intro"><br><br>  At first I thought it was nonsense, but suddenly I remembered the ghosts in the FIFO ... <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> __fastcall _clio_EIFIFO(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> channel) { <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> val,base,mask; ... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(FIFOI[channel].StartAdr!=<span class="hljs-number"><span class="hljs-number">0</span></span>)<span class="hljs-comment"><span class="hljs-comment">//channel enabled { ... } return val; }</span></span></code> </pre> <br>  Here in some cases it is possible to read unpredictable values, since the variable <b><i>val is</i></b> initialized only when the condition is met.  In theory, the FIFO of the DSP processor after emptying should return the last value read from it, such a ghost.  And although in practice reading from an empty FIFO should not occur, but who knows, suddenly after correction another game will start? <br><br>  Total two noteworthy mistakes, to be honest, I thought there would be more. <br><br><h2>  FourDO - modified kernel from SourceForge repository </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/e1d/a95/3f0/e1da953f0f186ca7285b0f3ff8c78f5e.png" alt="Picture 17" title="4DO - Wing Commander III"><br><br>  <i>Project website</i> : <a href="http://www.fourdo.com/">http://www.fourdo.com/</a> . <br><br>  <i>Audit</i> : 387. <br><br>  <i>Help</i> : This project has lived two lives, the first - when the authors began to write their own emulator from scratch, but alas, the patient fell into a coma, and after opening the source codes of FreeDO, a second life began, already with new organs.  So, let's see how implants get accustomed ... <br><br>  <b>Corrected, but still bug.</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/90c/7c2/11c/90c7c211c3548da18cff5a410e8d1adf.png" alt="Picture 4" title="Killing Time &amp; Escape From Monster Manor"><br><br>  I just want to point out the latest error in the original kernel (V614: Potentially uninitialized variable 'val' used. Line 803 - clio.cpp), with the ghosts there they did it without any extra (or with too much?) Conversations: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> __fastcall _clio_EIFIFO(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> channel) { <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> val,base,mask; base=<span class="hljs-number"><span class="hljs-number">0x400</span></span>+(channel*<span class="hljs-number"><span class="hljs-number">16</span></span>); mask=<span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;channel; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(FIFOI[channel].StartAdr!=<span class="hljs-number"><span class="hljs-number">0</span></span>) { ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { val=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// JMK SEZ: What is this? // It was commented out along with this whole "else" block, // but I had to bring this else block back from the dead // in order to initialize val appropriately. } return val; }</span></span></code> </pre> <br>  And in vain they did away with it!  The true problem remained unresolved, but from the outside everything was beautiful, and no one could remember the problem anymore.  The most elegant solution would be to declare the variable <b><i>val</i></b> as <b><i>static</i></b> and initialize to zero, and more correct to take it out of the function and put it into the list of variables for fast saves, and the <b><i>else</i></b> block is to remove so as not to confuse. <br><br>  <b>Uncorrected error.</b> <br><br>  <b>V523: The 'then' statement is equivalent to the 'else' statement.</b> <br><br>  <b>Line 673 - clio.cpp</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/511/135/59c/51113559c9ffb5c6965642addb2af58d.png" alt="Picture 19" title="Lost Iden - Intro"><br><br>  The ‚ÄúCreator‚Äù foot has not stepped here - everything is as in the original.  For those who are not in the subject, the ‚ÄúCreator‚Äù is one of the FourDO authors - Victor (I don‚Äôt know if this is his name or not, he is still Stirlitz), he is also the author of 3DOPlay, another FreeDO fork, the same errors in it as in the original.  There was a funny story with 3DOPlay: Victor decided to make a hit and said that he was the Creator of the 3DO Emulator, and the FreeDO developers allegedly stole the code from him.  To my great shame, I, as a FreeDO co-author, could not pass by and took an active part in the hostilities against his 3DOPlay project - I must say a great name, but someone blurted out - three hollows and rushed ... As a result, Victor joined the FourDO team, and we must pay tribute, he is the only one who has at least done something in terms of the development of 3DO emulation, besides the authors of the original source. <br><br>  <b>Not a mistake yet.</b> <br><br>  <b>V550: An odd comparison: Rez2T! = 0. This is a better way to use precision: fabs (A - B)&gt; Epsilon.</b> <br><br>  <b>Line 778 - madam.cpp</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/12d/2c9/feb/12d2c9feb6f109a81cfc9dd869694775.png" alt="Picture 20" title="Captain Quazar - Mission Instruction Intro"><br><br>  The code below is fully functional, but is of serious concern. <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Rez0T,Rez1T,Rez2T,Rez3T; ... Rez2T=(<span class="hljs-keyword"><span class="hljs-keyword">signed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)((M20*V0+M21*V1+M22*V2)/<span class="hljs-number"><span class="hljs-number">65536.0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Rez2T!=<span class="hljs-number"><span class="hljs-number">0</span></span>) M=Nfrac16/(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)Rez2T; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> M=Nfrac16;</code> </pre> <br>  In the original project, <b><i>Rez2T</i></b> had an <b><i>int</i></b> type, probably the authors thus decided to get rid of type conversion warnings, got rid, but if someone suddenly decides to remove a forced cast to a <b><i>signed int</i></b> type, there will be a risk to catch the coprocessor exception by dividing <b><i>Nfrac16</i></b> by <b><i>Rez2T</i></b> . <br><br>  And another piece of code causes my serious concern this time to the health of the developers from the FourDO team: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> __fastcall _qrz_PushARMCycles(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> clks) { uint32 arm,cnt; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> timers=<span class="hljs-number"><span class="hljs-number">21000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//default int sp=0; if(sdf&gt;0) sdf--; if(sf&gt;0) sf--; if(unknownflag11&gt;0)unknownflag11--; if(ARM_CLOCK&lt;0x5F5E10)ARM_CLOCK=0x5F5E10; if(ARM_CLOCK&gt;0x2FAF080)ARM_CLOCK=0x2FAF080; if(speedfixes&gt;0&amp;&amp;speedfixes&lt;0x186A1) {/*sp=0x2DC6C0;*/ speedfixes--;} else if(speedfixes&gt;0x186A1&amp;&amp;speedfixes&lt;0x30D41) {/*if(sdf==0)sp=0x4C4B40; */speedfixes--;} else if(speedfixes&lt;0) {sp=0x3D0900; speedfixes++;} else if(speedfixes&gt;0x30D41) {/*sp=0x249F00;*/ speedfixes--;} else if(speedfixes==0x30D41||speedfixes==0x186A1) speedfixes=0; if((fixmode&amp;FIX_BIT_TIMING_2)&amp;&amp;sf&lt;=2500000) {sp=0; timers=21000000; if(sf==0)sp=-(0x1C9C380-ARM_CLOCK);} if((fixmode&amp;FIX_BIT_TIMING_1)/*&amp;&amp;jw&gt;0*/&amp;&amp;sf&lt;=1500000) {/*jw--;*/timers=1000000;sp=-1000000;} if((fixmode&amp;FIX_BIT_TIMING_4)/*&amp;&amp;jw&gt;0*/) {/*jw--;*/timers=1000000;sp=-1000000;} if((fixmode&amp;FIX_BIT_TIMING_3)&amp;&amp;(sf&gt;0&amp;&amp;sf&lt;=100000)/*&amp;&amp;jw&gt;0*/) {/*jw--;*/timers=900000;} if((fixmode&amp;FIX_BIT_TIMING_5)&amp;&amp;sf==0/*&amp;&amp;jw&gt;0*/) {/*jw--;*/timers=1000000;} if((fixmode&amp;FIX_BIT_TIMING_6)/*&amp;&amp;jw&gt;0*/) {/*jw--;*/timers=1000000; if(sf&lt;=80000)sp=-23000000;} if(fixmode&amp;FIX_BIT_TIMING_7){sp=-3000000; timers=21000000;} if((sf&gt;0x186A0&amp;&amp;!(fixmode&amp;FIX_BIT_TIMING_2))|| ((fixmode&amp;FIX_BIT_TIMING_2)&amp;&amp;sf&gt;2500000)) sp=-(12200000-ARM_CLOCK); if((ARM_CLOCK-sp)&lt;0x2DC6C0)sp=-(0x2DC6C0-ARM_CLOCK); if((ARM_CLOCK-sp)!=THE_ARM_CLOCK) { THE_ARM_CLOCK=(ARM_CLOCK-sp); io_interface(EXT_ARM_SYNC,(void*)THE_ARM_CLOCK); //fix for working with 4do } arm=(clks&lt;&lt;24)/(ARM_CLOCK-sp); qrz_AccARM+=arm*(ARM_CLOCK-sp); if( (qrz_AccARM&gt;&gt;24) != clks ) { arm++; qrz_AccARM+=ARM_CLOCK; qrz_AccARM&amp;=0xffffff; } qrz_AccDSP+=arm*SND_CLOCK; qrz_AccVDL+=arm*(VDL_CLOCK); if(_clio_GetTimerDelay())qrz_TCount+=arm*((timers)/ (_clio_GetTimerDelay())); }</span></span></code> </pre> <br>  From the analyzer‚Äôs point of view, the code given is correct, but from the point of view of common sense, I can only guess at ‚Äúthis‚Äù when taking into account the cycles of the emulated processor - a disgrace, below is the code from the original: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> __fastcall _qrz_PushARMCycles(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> clks) { uint32 arm; arm=(clks&lt;&lt;<span class="hljs-number"><span class="hljs-number">24</span></span>)/ARM_CLOCK; qrz_AccARM+=arm*ARM_CLOCK; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (qrz_AccARM&gt;&gt;<span class="hljs-number"><span class="hljs-number">24</span></span>) != clks ) { arm++; qrz_AccARM+=ARM_CLOCK; qrz_AccARM&amp;=<span class="hljs-number"><span class="hljs-number">0xffffff</span></span>; } qrz_AccDSP+=arm*SND_CLOCK; qrz_AccVDL+=arm*(VDL_CLOCK); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_clio_GetTimerDelay()) qrz_TCount+=arm*((__temporalfixes?<span class="hljs-number"><span class="hljs-number">12500000</span></span>:<span class="hljs-number"><span class="hljs-number">25000000</span></span>)/ (_clio_GetTimerDelay())); }</code> </pre> <br>  In general, it can be said that the patient is neither alive nor dead, there are few changes in the emulator core, not everything is for the better, and there are no more than a year already, judging by the repository. <br><br><h2>  Phoenix Emu-Project - new kernel - new bugs. </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/64b/515/968/64b515968db182977be03d4063eac7b6.png" alt="Picture 5" title="Phoenix Project - The Need For Speed"><br><br>  <i>Project website</i> : <a href="http://www.arts-union.ru/">http://www.arts-union.ru</a> <br><br>  <i>Version</i> : 1.7 <br><br>  <i>Reference</i> : re-written 3DO emulator, with the maniacal goal of bringing 3DO emulation to perfection, although I thought of it as a multisystem emulator with the appropriate code infrastructure, but so far only 3DO. <br><br>  <b>Error - texture peeled off!</b> <br><br>  <b>V501: There are identical sub-expressions to the left and the right of the! = Operator: val.flags! = Val.flags.</b> <br><br>  <b>Line 207 - gfx_celengine.h</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/75a/a65/35f/75aa6535f082b197a9bd36b5afc47225.png" alt="Picture 7" title="Star Fighter &amp; Shock Wave 2"><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">gfxCelTexturePDECAttrib</span></span></span><span class="hljs-class"> {</span></span> uint32 pre0; uint32 flags; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> plutcount; uint16 plut[<span class="hljs-number"><span class="hljs-number">32</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>==(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gfxCelTexturePDECAttrib &amp;val) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(val.pre0!=pre0)<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(val.flags!=val.flags)<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(val.plutcount!=plutcount)<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;val.plutcount;i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(val.plut[i]!=plut[i])<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } };</code> </pre> <br>  Mistakes made by inattention and leading to texture defects during the game, because if the CEL flags of the textures in the cache are different, and this goes unnoticed, and otherwise they are the same, the wrong shader will be used to display the texture.  Below is the correct option: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(val.flags!=flags)<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;</code> </pre><br>  <b>Error - trash on the screen!</b> <br><br>  <b>It is a V579:</b>  <b>It is possibly a mistake.</b>  <b>Inspect the third argument.</b> <br><br>  <b>Line 36 - vdlp_3do.cpp</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/db0/f5c/ebc/db0f5cebca98fd4a33e3d283b50349f4.png" alt="Picture 22" title="Gex - End of 1st Level"><br>  Everything is simple here - the VDLP fell victim to inattention again when modifying the associated with the addition of support for PAL games.  Previously, the emulator supported only NTSC games, of which the overwhelming majority, and the frame buffer had a fixed size of 320 by 240 pixels, therefore it was declared inside the class as an array, without memory allocations. <br><pre> <code class="cpp hljs">screen=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> uint8[<span class="hljs-number"><span class="hljs-number">384</span></span>*<span class="hljs-number"><span class="hljs-number">288</span></span>*<span class="hljs-number"><span class="hljs-number">3</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(screen,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(screen));</code> </pre><br>  And so that the error goes out of sight (literally, because the first, barely perceptible frame at the start of the game is filled with garbage), you can write, for example, like this: <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(screen,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(uint8)*<span class="hljs-number"><span class="hljs-number">384</span></span>*<span class="hljs-number"><span class="hljs-number">288</span></span>*<span class="hljs-number"><span class="hljs-number">3</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span>);</code> </pre><br>  <b>Error - and there is no disk!</b> <br><br>  <b>V595: The 'adapt' pointer was used before it was verified against nullptr.</b>  <b>Check lines: 375, 376.</b> <br><br>  <b>Line 375 - dumplibrary.cpp</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/8ef/04f/c97/8ef04fc97ce2cf396994e55bda16632e.png" alt="Picture 21" title="FZ-10 BIOS - Demo"><br>  And again carelessness ... Before addressing the object, it would be necessary to check its correctness, therefore, the last two lines should be swapped.  Otherwise, in the absence of the necessary images, we get an exception in the process of loading saved games. <br><pre> <code class="cpp hljs">dumpAdapter *adapt=createDumpAdapter(j, inf-&gt;Parent()-&gt;Attribute(<span class="hljs-string"><span class="hljs-string">"attach"</span></span>).toString()); adapt-&gt;SetSign(signs[names[i]]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!adapt)<span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;</code> </pre><br>  What is there to say?  I need to be more careful or just relax in the evenings instead of programming emulators. <br><br><h2>  Conclusion </h2><br>  So, my first experience showed that static code analysis, a thing that is undoubtedly useful and can save a lot of time and nerves of developers.  But for an emu scene, the issue price is certainly high, as is the case with the Hex-Ray decompiler for ARM, which could move the 3DO emulation many steps ahead. <br></div><p>Source: <a href="https://habr.com/ru/post/218613/">https://habr.com/ru/post/218613/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../218601/index.html">Review of the JPoint 2014 conference reports</a></li>
<li><a href="../218603/index.html">8 programming traps</a></li>
<li><a href="../218607/index.html">Portrait Habra-tutorial</a></li>
<li><a href="../218609/index.html">Critical vulnerability in OpenSSL 1.0.1 and 1.0.2-beta</a></li>
<li><a href="../218611/index.html">Iron sample for HD FPV *</a></li>
<li><a href="../218617/index.html">The biggest Tetris in the world: playing on the wall of a skyscraper</a></li>
<li><a href="../218619/index.html">Video encoding using Intel HD integrated video</a></li>
<li><a href="../218623/index.html">Web Monitoring: Why a low uptime website can pull your business to the bottom</a></li>
<li><a href="../218625/index.html">Personal branding: a recipe for success</a></li>
<li><a href="../218629/index.html">Flexible transdermal patch for EEG and ECG monitoring</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>