<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Checking the PascalABC.NET project with the help of SonarQube plugins: SonarC # and PVS-Studio</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last November, our blog published an article on the development and use of the PVS-Studio plugin for SonarQube. We received a lot of feedback from cus...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Checking the PascalABC.NET project with the help of SonarQube plugins: SonarC # and PVS-Studio</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/getpro/habr/post_images/c86/a1a/ca6/c86a1aca660ad677ce59c58ead77bb06.png" alt="Picture 30" align="left"></p>  Last November, our blog published an article on the development and use of the PVS-Studio plugin for SonarQube.  We received a lot of feedback from customers and simply interested users with requests to test the plug-in on a real project.  Since the interest in this issue has not waned, it was decided to test on C # project PascalABC.NET.  Also, let's not forget that SonarQube contains its own static C # code analyzer - SonarC #.  To complete the picture we will conduct a study and SonarC #.  The goal of this work is not to compare analyzers, but to show the main features of their interaction with the SonarQube service.  A direct comparison of the analyzers would not be entirely correct, because PVS-Studio is a specialized tool for finding errors and potential vulnerabilities, while SonarQube is a service for assessing the quality of a code by a large number of parameters: code duplication, compliance with coding standards, code coverage unit tests, possible errors in the code, the density of comments in the code, technical debt, etc. <br><a name="habracut"></a><br><h2>  Introduction </h2><br>  I recommend beforehand to get acquainted with the materials of the <a href="https://www.viva64.com/ru/b/0452/">article</a> , where we talk about the SonarQube platform and the integration of the PVS-Studio analyzer with it. <br><br>  Now a little about the project under study.  PascalABC.NET is an implementation of the Pascal programming language of a new generation, containing its own development environment, as well as a Web environment for creating programs in PascalABC.NET, C #, Visual Basic.NET, F #, IronPython.  The project is developed in C # and distributed under the free license LGPLv3.  <a href="http://pascalabc.net/">Project site</a> .  Source code can be downloaded from the <a href="https://github.com/pascalabcnet/pascalabcnet">repository</a> on GitHub. <br><br>  The PascalABC.NET solution includes 2628 files with the extension '.cs', which contain about 752 thousand lines of code (metrics are obtained using the <a href="http://www.campwoodsw.com/sourcemonitor.html">SourceMonitor</a> utility).  Thus, the project is quite suitable size for our research purposes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  SonarC # </h2><br>  As mentioned earlier, the <a href="https://sonarqube.com/">SonarQube</a> service includes, among other things, a static analyzer of C # code.  To, as in our case, add an open project to the site, as well as analyze it, a few simple steps are enough. <br><br>  I used a GitHub account to register on the SonarQube website.  Then I used <a href="https://about.sonarqube.com/get-started/">the</a> quick start <a href="https://about.sonarqube.com/get-started/">guide</a> .  The whole configuration process, including linking the PascalABC.NET project to the account, obtaining a unique organization key and setting up on the local computer, took me about 15 minutes.  Another 10 minutes was spent on the analysis of the project.  After that, the <a href="https://sonarqube.com/organizations/skhrenov-github/projects">result</a> was uploaded to the SonarQube website, anyone can read it. <br><br>  SonarQube issued 3636 warnings about possible errors in PascalABC.NET code: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b4d/b01/c5e/b4db01c5e36d5d4021c10d9a42b863e8.png" alt="Picture 1"></p><br>  Of these: 8 blockers (require immediate elimination), 64 critical, 1742 important and 1822 not critical.  Informational messages were not issued.  Let's try to get acquainted with the received warnings, find interesting errors and understand what percentage of false positives.  To do this, we use convenient filtering tools in various dimensions provided by the SonarQube service.  Let's start with blocking warnings. <br><br><h3>  Blocker </h3><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2ee/a99/a68/2eea99a689930e185db2aecf2e45f554.png" alt="Picture 32"></p><br>  As you can see, blocking warnings are issued for two rules: endless recursion and clearing of IDisposable-resources.  Here is an example of one of the blocker warnings: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c12/84f/baf/c1284fbaf460576ef467911f141eabb2.png" alt="Picture 5"></p><br>  In the get-section of the <i>Instance</i> property mistakenly returns <i>Instance</i> , instead of an <i>instance</i> , which causes infinite recursion. <br><br>  All other warnings at the Blocker level are also errors. <br><br><h3>  Critical </h3><br><p><img src="https://habrastorage.org/getpro/habr/post_images/db8/8f2/8a2/db88f28a2b253cf62be2d507a553bfe3.png" alt="Picture 33"></p><br>  At the Critical level, 64 warnings were issued for the rule on invalid casting.  Consider one of these warnings: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9e8/02e/67e/9e802e67ed81d1a8c6fbecad44071bf0.png" alt="Picture 8"></p><br>  Having studied the code and the list of implementations, I agree with the analyzer: at the moment there really is not a single type that implements both <i>IBaseScope</i> and <i>IComparable at once</i> , as a result of which the <i>boxItem.Item is IComparable check</i> will always be <i>false</i> .  However, I would not talk about the error in this case, because, firstly, the very existence of such a check precludes the subsequent occurrence of an exception when attempting to cast <i>(IComparable) boxItem.Item.</i>  Secondly, at any time, for example, a certain <i>dll</i> can be connected to the solution, in which a type that implements both <i>IBaseScope</i> and <i>IComparable</i> interfaces will be declared.  Perhaps, the developer was counting on this, realizing the type conversion only after checking.  The considered warning, in my opinion, should be attributed to the discharge of messages for the Minor section, and not critical for execution, and its presence at the Critical level should be considered a false positive. <br><br>  The remaining 63 warnings are similar to those considered. <br><br><h3>  Major </h3><br>  At this level, a lot of warnings were issued - 1742, for fifteen types of diagnostics: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a2d/cc9/ebc/a2dcc9ebca5c2e0c4ce38cf36d15ddf0.png" alt="Picture 9"></p><br>  Let's go through the list of warnings in order to search for real errors and assess the capabilities of the analyzer. <br><br>  <b>General exceptions should never be thrown</b> <br><br>  The rule reports that a generic exception was thrown using <i>throw</i> .  In the code of the PascalABC.NET project, 634 such constructions were found.  The vast majority is as follows: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b62/c47/d2e/b62c47d2ea40aa14941d75d39d6d7839.png" alt="Picture 10"></p><br>  Also there are a lot of (more than 600) constructions similar to ‚Äústubs‚Äù in the code, intentionally left by the developers: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/392/134/49e/39213449e9ea82963326076326d12020.png" alt="Picture 11"></p><br>  Of course, throwing generic exceptions is ‚Äúbad form.‚Äù  However, it seems to me that these are not errors at all.  Moreover, it is unlikely that the authors of the code deliberately produce them in such quantity.  Yes, the exception handling in the PascalABC.NET project is apparently not up to par.  Nevertheless, the place for all these 634 warnings of the same type in the Minor section or even in the false positives of the analyzer. <br><br>  By the way, this is a good example of the difference between SonarC # and the PVS-Studio analyzer.  SonarC # indicates "smells" in the code and is absolutely right to issue these warnings.  They allow you to judge the quality of the project.  From the point of view of us, the developers of the PVS-Studio analyzer, these are false positives, since we are focused on finding errors and security defects. <br><br>  <b>Dead stores should be removed</b> <br><br>  It is also a very large group of 618 warnings about reassigning the value of a variable, if it is not used between assignments.  Here the following pattern prevails: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/3f3/896/96c/3f389696c793c04d099231555e4ed61a.png" alt="Picture 12"></p><br>  The variable is initialized upon declaration, and then, without ever using the stored value, a new one is assigned.  Of course, this should not be done.  Here and issues of saving resources, and possible suspicions of another mistake or typo.  But in fact - none of these structures is not an error.  Again, it is not clear why all such warnings were placed in the section of errors of high importance?  In my opinion all this is false positives. <br><br>  There are several absolutely clear false-positive warnings of the form: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/792/8e3/45a/7928e345a5b2c050bded636df32d687b.png" alt="Picture 13"></p><br>  If in this case, follow the recommendations of the analyzer, the logic of the program will be violated. <br><br>  Thus, I did not manage to find a single real error among the 618 warnings from the considered group. <br><br>  <b>Floating point numbers should not be tested for equality</b> <br><br>  151 warnings were issued for comparison constructions in which one or both of the compared operands are of the real type.  Indeed, such comparisons often give an erroneous result, which is associated with the peculiarities of storing real variables in memory and can vary, for example, depending on the compiler settings.  Such designs can work for a very long time without problems.  In this case, it is necessary in each particular case to make a decision on the erroneousness of such a code.  For example, if the compared values ‚Äã‚Äãare the result of mathematical calculations, then a direct comparison of these values ‚Äã‚Äãis usually erroneous.  If you compare two real constants, then this is probably done meaningfully and there will be no error. <br><br>  In the PascalABC.NET code, I mainly met the following pattern of comparison with a real variable: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c80/5d4/296/c805d429600dade8a98e52e6e38f03cc.png" alt="Picture 4"></p><br>  Note that the comparison is made both of two real variables, and of a real variable with a variable of integer type.  Of course, such code is not completely safe, since it is not known how the compared values ‚Äã‚Äãwere obtained.  Is it worth talking about a clear error?  It is difficult to give a definite answer.  But the code probably needs some work. <br><br>  By the way, the PVS-Studio analyzer also warns about such suspicious comparisons, but these diagnostics refer to the Low confidence level and are not recommended for our study. <br><br>  Also among the warnings issued by the analyzer there are obvious false positives, for example: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/58b/7fc/2b5/58b7fc2b5e8847808e2ffb14981bf7b6.png" alt="Picture 15"></p><br>  In this case, two <i>byte</i> variables are compared.  The <i>left</i> and <i>right</i> variables are of the type <i>byte_const_node</i> : <br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">byte_const_node</span></span></span><span class="hljs-class"> :</span></span> concrete_constant&lt;byte&gt;, SemanticTree.IByteConstantNode { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">byte_const_node</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte value, location loc)</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(value, loc)</span></span></span><span class="hljs-function"> </span></span>{ } .... } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> abstract <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">concrete_constant</span></span></span><span class="hljs-class">&lt;ConstantType&gt; :</span></span> constant_node { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ConstantType _constant_value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">concrete_constant</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ConstantType value, location loc)</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(compiled_type_node.get_type_node(typeof(ConstantType)), loc)</span></span></span><span class="hljs-function"> </span></span>{ _constant_value = value; } .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ConstantType constant_value { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _constant_value; } .... } .... } .... }</code> </pre> <br>  I think this warning group is rightly located in the Major section.  However, I would not consider all warnings found errors.  The decision must be made by the author of the code in each specific case. <br><br>  <b>Multiline blocks should not be enclosed in curly braces</b> <br><br>  A group of 108 warnings, including potential formatting errors that affect the logic of program execution.  Here I found quite suspicious constructions.  Example: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c26/cf6/ceb/c26cf6ceb71189e8e0589c8eb911d7c1.png" alt="Picture 16"></p><br>  This snippet may have skipped parentheses.  In any case, the developer should format the code to better understand the logic of the program. <br><br>  Another similar warning: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/bb0/394/2d7/bb03942d7c0aa0621bdc079c674b140e.png" alt="Picture 17"></p><br>  There is no error, but the code looks messy.  Refactoring is required. <br><br>  In principle, all warnings from this group were issued in the case, but they did not reveal any real errors. <br><br>  <b>Null pointers should not be dereferenced</b> <br><br>  75 warnings about the possible access to the zero link.  In this block I found interesting errors: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a5f/383/722/a5f3837220d5d56aee0c242b5452b252.png" alt="Picture 18"></p><br>  Indeed, earlier in the code, the variable <i>returned_scope is</i> always checked for <i>null</i> equality before use, but in this case they forgot about it: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">visit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (returned_scope != null &amp;&amp; ....) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (returned_scope != null) { .... } returned_scope.declaringUnit = entry_scope; <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br>  Another similar error: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/3c0/4b6/40c/3c04b640c431f2f1d4b2d5bc134b8491.png" alt="Picture 19"></p><br>  In the first case, the variable <i>pi is</i> checked for <i>null</i> equality before use, but further, when the next call to <i>pi.CompilationUnit,</i> is forgotten. <br><br>  The warning block contains a number of not so obvious errors, as well as false positives.  I would rate the percentage of finding real errors here equal to 85%.  Very good result. <br><br>  <b>Conditions should not unconditionally evaluate to "true" or to "false"</b> <br><br>  Block warnings about conditions that are feasible regardless of the logic of the program.  Typical errors found: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b33/054/9ce/b330549ce11c443680aa4ceabfd1a1cb.png" alt="Picture 20"></p><br>  Strange code that requires refinement by the author.  Perhaps a serious mistake has been made. <br><br>  In general, the group contains about 70% of these errors. <br><br>  <b>Excerpts should not be thrown from property getters</b> <br><br>  Do not throw exceptions in the get-section of the property, and if necessary, use methods instead of properties.  This group contains 46 such warnings.  The overwhelming majority of them are ‚Äústubs‚Äù left by the developers, intentionally or by forgetfulness: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b74/57a/424/b7457a424cc37611fa91f90532f6969b.png" alt="Picture 21"></p><br>  There are not entirely correct constructions that require refactoring: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/4b7/eba/415/4b7eba4156bd5cde1f463c5a6e289f35.png" alt="Picture 22"></p><br>  However, I do not consider these warnings to be errors.  I think it would be more rational to attribute them to the Minor section. <br><br>  <b>Static fields should not be updated in constructors</b> <br><br>  Diagnostics about the danger of updating static fields in constructors: this can lead to inconsistent program behavior, since the field will be reinitialized for all instances of the class.  In total, the analyzer issued 26 such warnings for the PascalABC.NET project.  I did not find any real mistakes among them.  Here are a couple of examples of code snippets found: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/931/653/71f/93165371f8adf869ca32d1f687194391.png" alt="Picture 23"></p><br>  Every time in the static variable <i>_instance a</i> reference is written to a new instance of the class.  Judging by the name of the variable - it was intended. <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a05/55d/9f9/a0555d9f9a59434b0dcc3df84a2c4f64.png" alt="Picture 24"></p><br>  The <i>parsers_loaded</i> flag indicates that at least one instance of the class has already been created.  Nothing criminal. <br><br>  <b>"= +" should not be used instead of "+ ="</b> <br><br>  An interesting diagnosis is that instead of the operator "- =", for example, they mistakenly used "= -".  The analyzer issued 9 such warnings.  Unfortunately, all of them are false positives.  6 warnings are issued for constructions that are variable declarations, where in principle it is impossible to use the operator "- =" or "+ =": <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/597/89a/203/59789a203241228c9bd3fa12dc6c7016.png" alt="Picture 25"></p><br>  The remaining 3 warnings are related to the fact that the authors of the code, apparently, do not like to use spaces to format their code: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d08/319/54f/d0831954fc9b6ff07831cbabfc2def0b.png" alt="Picture 26"></p><br>  <b>Related "if / else if" statements should not have the same condition</b> <br><br>  5 warnings were issued for code fragments with the same condition in the <i>if</i> and <i>else if</i> blocks.  Often this code is either already erroneous or contains the potential for an error.  In our case, 4 out of 5 warnings contained a simple duplication of the condition, as well as the execution unit, which is, of course, suspicious, but not a gross error.  One warning is more interesting: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/3c3/090/9cc/3c30909cc0958549daa3e6ac1c0c04d5.png" alt="Picture 27"></p><br>  Before part of the condition in the first <i>if</i> block was commented out, it was different from the condition in the next <i>if</i> block.  Also note the block for doing this second <i>else if</i> : it is empty.  There is only one operator: ";".  Very strange and suspicious code. <br><br>  <b>Short circuit circuit should not be used</b> <br><br>  Diagnostics warns, for example, about the possible erroneous use of the <i>&amp;</i> operator instead of <i>&amp;&amp;</i> for expressions of type <i>bool</i> .  A total of 5 suspicious constructions were found.  All of them in one way or another require attention, although they may not contain mistakes.  Here is an example of one of them: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/4ca/8fd/776/4ca8fd7765d475d8e86cd9137b54a98c.png" alt="Picture 28"></p><br>  In this case, it is impossible to assert that the use of the operator "|"  erroneously, since in its right side a property with complex logic inside is checked.  Perhaps the developer was trying to ensure that both conditions were always checked. <br><br>  <b>Exceptions should not be explicitly rethrown</b> <br><br>  Diagnosis about the loss of the stack exception.  The analyzer issued 4 warnings of the same type: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/5c0/b4b/600/5c0b4b6007d5f12926e825e663a002e5.png" alt="Picture 29"></p><br>  Of course, this should not be done.  Further debugging of the application will be difficult.  But all these warnings are not so critical.  In my opinion, their place in the Minor section. <br><br>  <b>Variables should not be self-assigned</b> <br><br>  3 warnings about assigning a variable to itself.  Here is an example of one of the code snippets found: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/448/8fa/a1d/4488faa1dffb6301ba185d7e9d9b02d1.png" alt="Picture 3"></p><br>  Strange and obviously wrong code.  The <i>visitNode</i> ad is: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> visitNode = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre> <br>  In total, this group of warnings contains two errors. <br><br>  <b>Identical expressions should not be used</b> <br><br>  Diagnostics searches for conditions in which there are identical subexpressions.  2 suspicious constructions were found.  There is no obvious error in any of them, but perhaps the code should look and work differently.  Example of one of the warnings: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/cc5/867/9df/cc58679df9bd992bfa1f5c3890f48cfb.png" alt="Picture 7"></p><br>  Strange code.  You may have forgotten to replace the second check. <br><br>  <b>"ToString ()" method should not return null</b> <br><br>  The last group of warnings in the Major section.  The overload of the <i>ToString ()</i> method is implemented incorrectly.  2 warnings are issued, and both are errors.  An example of one of them: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9cd/c69/a2c/9cdc69a2c9d0c047844f36064b978e90.png" alt="Picture 14"></p><br>  It is incorrect to return <i>null</i> from the overloaded <i>ToString ()</i> method <i>.</i>  You must use <i>string.Empty</i> . <br><br><h3>  Minor </h3><br>  1822 warnings were issued here.  Since this level is not critical, it is unlikely that here I will discover really interesting errors.  Also, usually, quite a lot of false positives are recorded at this level.  Therefore, I will not consider Minor level warnings in this study. <br><br><h3>  The results of the test analyzer SonarC # </h3><br>  Summing up, I can say that, in general, the analyzer found real errors at the Blocker, Critical and Major levels (I counted 268 erroneous or highly suspicious constructions with 1814 warnings), some of which are really interesting.  However, the percentage of false positives is quite large, at over 85%.  This greatly complicates the analysis of the results. <br><br><h2>  PVS-Studio plugin for SonarQube </h2><br>  The integration of the results of the work of the PVS-Studio analyzer in SonarQube is devoted to the <a href="https://www.viva64.com/ru/m/0037/">section of the documentation</a> on our website.  It took me about 15 minutes to set up the integration from scratch.  The same amount was taken by checking the project and downloading the results to the local SonarQube server. <br><br>  PVS-Studio issued 1039 warnings during the verification of PascalABC.NET code.  Of these: 156 warnings of the Critical level, 541 of the Major level, 342 of the Minor level. <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/cd1/dc8/588/cd1dc85885ab4aeb24f99c29cab2f3ec.png" alt="Picture 31"></p><br>  We will not consider Minor level warnings, since among them the percentage of false positives is usually high. <br><br>  Distribution of warnings by diagnostics at the Critical level: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ac7/1d9/956/ac71d99563225b8751e1f4de3950d503.png" alt="Picture 34"></p><br>  Distribution of warnings by diagnostics at Major level: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/5f0/cee/8dd/5f0cee8dd8f86662f3e339da075f06bf.png" alt="Picture 35"></p><br>  After analyzing 697 warnings at the Critical and Major levels, I found out that 204 of them can be attributed to false positives.  This represents about 29% of the total number of alerts at the first and second level of importance.  Thus, the percentage of identifying real errors and suspicious constructions for the PascalABC.NET project is 71%.  In terms of the number of lines of code (KLOC), this is 0.66 errors per KLOC.  Let's take a look at the most interesting errors found.  For convenience, I will cite errors ascending the number of the diagnostic rule. <br><br>  <b>Copy paste</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3001/">V3001</a> There are identical sub-expressions "token.Kind == openBracketToken"  operator.  ICSharpCode.SharpDevelop NRefactoryInsightWindowHandler.cs 66 <br><br><pre> <code class="cpp hljs">readonly <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> eofToken, commaToken, openParensToken, closeParensToken, openBracketToken, closeBracketToken, openBracesToken, closeBracesToken, statementEndToken; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitializeOpenedInsightWindow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (token.Kind == openParensToken || token.Kind == openBracketToken || token.Kind == openBracketToken) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= bracketCount++; } .... }</span></span></code> </pre> <br>  In the if block condition, the <i>token.Kind == openBracketToken</i> equality is checked twice.  Among the fields declared in a class, you can find a field with the very similar name <i>openBracesToken</i> .  It is probably this field that was omitted from the condition.  In this case, the corrected version of the code could be: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitializeOpenedInsightWindow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (token.Kind == openParensToken || token.Kind == openBracketToken || token.Kind == openBracesToken) { bracketCount++; } .... }</code> </pre> <br>  Similar errors in the code: <br><br><ul><li>  <a href="http://www.viva64.com/ru/w/V3001/">V3001</a> There are identical sub-expressions 'File.Exists (pdbFileName)' operator.  VisualPascalABCNET RunnerManagerHandlers.cs 165 </li><li>  <a href="http://www.viva64.com/ru/w/V3001/">V3001</a> There are identical sub-expressions '_pascal_set_constant.values! = Null' operator.  TreeConverter syntax_tree_visitor.cs 4553 </li></ul><br>  <b>Inattention</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3003/">V3003</a> The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 597, 631. ParserTools SyntaxTreeComparer.cs 597 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CompareInternal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (left is ident) CompareInternal(left as ident, right as ident); .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (left is int64_const) CompareInternal(left as int64_const, right as int64_const); .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (left is int64_const) CompareInternal(left as int64_const, right as int64_const); .... }</code> </pre> <br>  The above code snippet actually contains about thirty checks of the same type, two of which are completely identical.  Perhaps there is no error, and the code is simply duplicated due to inattention.  But one of the checks, according to the developer, could look different.  In this case, we are dealing with a serious logical error. <br><br>  Similar errors: <br><br><ul><li>  <a href="http://www.viva64.com/ru/w/V3003/">V3003</a> The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 1599, 1611. ParserTools SyntaxTreeComparer.cs 1599 </li><li>  <a href="http://www.viva64.com/ru/w/V3003/">V3003</a> The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 1611, 1615. ParserTools SyntaxTreeComparer.cs 1611 </li><li>  <a href="http://www.viva64.com/ru/w/V3003/">V3003</a> The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 103, 209. SyntaxVisitors SimplePrettyPrinterVisitor.cs 103 </li></ul><br>  <b>Copy-Paste v2.0</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  VisualPascalABCNET CodeCompletionWindow.cs 204 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleMouseWheel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (System.Windows.Forms.SystemInformation.MouseWheelScrollLines &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { newValue = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.vScrollBar.Value - (control.TextEditorProperties.MouseWheelScrollDown ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>) * multiplier; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { newValue = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.vScrollBar.Value - (control.TextEditorProperties.MouseWheelScrollDown ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">-1</span></span>) * multiplier; } .... }</code> </pre> <br>  Both branches of the <i>if</i> block contain identical subexpressions.  In this case, it is difficult to conclude that the correct version of this fragment, but in the above form, the code will not work as expected. <br><br>  Similar errors in the code: <br><br><ul><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  NETGenerator NETGenerator.cs 439 </li><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  NETGenerator NETGenerator.cs 2338 </li><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  NETGenerator NETGenerator.cs 4062 </li><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  NETGenerator NETGenerator.cs 5971 </li><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  NETGenerator NETGenerator.cs 6069 </li><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  CodeCompletion CodeFormatter.cs 1254 </li><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  CodeCompletion DomConverter.cs 428 </li><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  TreeConverter type_table.cs 380 </li><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  TreeConverter type_table.cs 401 </li><li>  <a href="http://www.viva64.com/ru/w/V3004/">V3004</a> The 'then' statement is equivalent to the 'else' statement.  TreeConverter type_table.cs 424 </li></ul><br>  I brought only the first 10 of these errors out of 20. <br><br>  <b>The variable is assigned to itself.</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3005/">V3005</a> The 'miGenerateRealization.Visible' variable is assigned to itself.  VisualPascalABCNET OptionsManager.cs 342 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateUserOptions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... tsViewIntellisensePanel.Visible = tssmIntellisence.Visible = tsGotoDefinition.Visible = tsGotoRealization.Visible = tsFindAllReferences.Visible = miGenerateRealization.Visible = miGenerateRealization.Visible = cmGenerateRealization.Visible = cmsCodeCompletion.Visible = cmFindAllReferences.Visible = cmGotoDefinition.Visible = cmGotoRealization.Visible = UserOptions.AllowCodeCompletion; }</code> </pre> <br>  The variable <i>miGenerateRealization.Visible</i> gets the same value twice during assignment.  Probably, extra assignment added randomly.  However, instead of one of the variables <i>miGenerateRealization.Visible there</i> could be some other variable that is not initialized now. <br><br>  Found another similar error: <br><br>  <a href="http://www.viva64.com/ru/w/V3005/">V3005</a> The 'visitNode' variable is assigned to itself.  SyntaxVisitors SimplePrettyPrinterVisitor.cs 106 <br><br>  <b>Reassignment</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3008/">V3008</a> The 'codeCompileUnit' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 126, 124. VisualPascalABCNET CodeDomHostLoader.cs 126 <br><br><pre> <code class="cpp hljs">CodeCompileUnit codeCompileUnit = null; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DesignSurface Designer; .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> override CodeCompileUnit </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Parse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... CodeCompileUnit ccu = null; DesignSurface ds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DesignSurface(); .... ccu = cg.GetCodeCompileUnit(idh); .... codeCompileUnit = ccu; Designer = ds; codeCompileUnit = ccu; <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br>  From the code it can be seen that there is absolutely no logical explanation for reassigning the <i>codeCompileUnit</i> variable <i>to</i> the same value. <br><br>  Similar errors in the code: <br><br><ul><li>  <a href="http://www.viva64.com/ru/w/V3008/">V3008</a> The 'mSTEPToolStripMenuItem_Enabled' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 541, 532. VisualPascalABCNET VisibilityService.cs 541 </li><li>  <a href="http://www.viva64.com/ru/w/V3008/">V3008</a> The variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 62, 60. NETGenerator Helpers.cs 62 </li><li>  <a href="http://www.viva64.com/ru/w/V3008/">V3008</a> The 'loc' variable is assigned twice successively.  Perhaps this is a mistake.  Check lines: 2123, 2122. TreeConverter compilation_context.cs 2123 </li><li>  <a href="http://www.viva64.com/ru/w/V3008/">V3008</a> The 'cnfn.function_code' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 260, 259. TreeConverter functions_calls.cs 260 </li><li>  <a href="http://www.viva64.com/ru/w/V3008/">V3008</a> The 'namespace_func.function_code' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 267, 266. TreeConverter functions_calls.cs 267 </li><li>  <a href="http://www.viva64.com/ru/w/V3008/">V3008</a> The 'ti.init_meth' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 1739, 1735. NETGenerator NETGenerator.cs 1739 </li></ul><br>  <b>The result of the method is always the same.</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3009/">V3009</a> It's one of the same values ‚Äã‚Äãof 'false'.  NETGenerator NETGenerator.cs 5434 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BeginOnForNode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IStatementNode value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//if (value is IForNode) return true; IStatementsListNode stats = value as IStatementsListNode; if (stats == null) return false; if (stats.statements.Length == 0) return false; //if (stats.statements[0] is IForNode) return true; return false; }</span></span></code> </pre> <br>  Probably here we are dealing with inattention when refactoring.  Earlier in the code were blocks of code that return <i>true</i> .  However, now they are commented out, and the method, regardless of the result of their work, will return <i>false</i> . <br><br>  Similar errors in the code: <br><br><ul><li>  <a href="http://www.viva64.com/ru/w/V3009/">V3009</a> It's one of the same value of '0'.  PABCNETC CommandConsoleCompiler.cs 297 </li><li>  <a href="http://www.viva64.com/ru/w/V3009/">V3009</a> It's one of the same value of '0'.  PABCNETCclear CommandConsoleCompiler.cs 266 </li></ul><br>  <b>Inattention</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3010/">V3010</a> The 'OrderBy' is required to be utilized.  ICSharpCode.SharpDevelop RefactoringService.cs 86 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IEnumerable&lt;ITreeNode&lt;IClass&gt;&gt; FindDerivedClassesTree(....) { .... var result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;TreeNode&lt;IClass&gt;&gt;(); .... result.OrderBy(node =&gt; node.Content.FullyQualifiedName); <span class="hljs-comment"><span class="hljs-comment">// &lt;= return result; }</span></span></code> </pre> <br>  The result of sorting the <i>result</i> list is not saved anywhere.  Corrected version of the given fragment: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IEnumerable&lt;ITreeNode&lt;IClass&gt;&gt; FindDerivedClassesTree(....) { .... var result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;TreeNode&lt;IClass&gt;&gt;(); .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.OrderBy(node =&gt; node.Content.FullyQualifiedName); }</code> </pre> <br>  And one more such mistake: <br><br>  <a href="http://www.viva64.com/ru/w/V3010/">V3010</a> The return value of the function 'ToString' is required to be used.  CodeCompletion SymTable.cs 2145 <br><br>  <b>Problem with logic</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3018/">V3018</a> Consider inspecting the application's logic.  It's possible that 'else' keyword is missing.  VisualPascalABCNET InsightWindow.cs 145 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleMouseWheel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MouseEventArgs e)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.Delta &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (control.TextEditorProperties.MouseWheelScrollDown) { CurrentData = (CurrentData + <span class="hljs-number"><span class="hljs-number">1</span></span>) % DataProvider.InsightDataCount; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { CurrentData = (CurrentData + DataProvider.InsightDataCount - <span class="hljs-number"><span class="hljs-number">1</span></span>) % DataProvider.InsightDataCount; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.Delta &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= if (control.TextEditorProperties.MouseWheelScrollDown) { CurrentData = (CurrentData + DataProvider.InsightDataCount - 1) % DataProvider.InsightDataCount; } else { CurrentData = (CurrentData + 1) % DataProvider.InsightDataCount; } } .... }</span></span></code> </pre> <br>  Pay attention to the condition <i>if (e.Delta &lt;0)</i> .  Based on how the code is formatted, as well as from the program logic, the conclusion follows: it is possible that the <i>else</i> keyword is missing.  However, only the author can give an exact answer about the features of this design. <br><br>  <b>The classic mistake when working with the operator "as"</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'baseScope', 'this.baseScope'.  CodeCompletion SymTable.cs 3497 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TypeScope</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(...., SymScope baseScope)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseScope = baseScope as TypeScope; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (baseScope == null) { .... } .... }</code> </pre> <br>  After casting the <i>baseScope</i> argument to a <i>TypeScope</i> type, an error on the equality of <i>null is</i> checked, not the field <i>this.baseScope</i> , but the argument <i>baseScope</i> .  Corrected code: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TypeScope</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(...., SymScope baseScope)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseScope = baseScope as TypeScope; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseScope == null) { .... } .... }</code> </pre> <br>  Similar errors in the code: <br><br><ul><li>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'returned_scope', 'ts'.  CodeCompletion ExpressionVisitor.cs 1595 </li><li>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'returned_scope', 'tmp_scope'.  CodeCompletion DomSyntaxTreeVisitor.cs 1553 </li><li>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'returned_scope', 'ts.elementType'.  CodeCompletion DomSyntaxTreeVisitor.cs 2815 </li><li>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'returned_scope', 'es.elementType'.  CodeCompletion DomSyntaxTreeVisitor.cs 2828 </li><li>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'node', 'solutionFolderNode'.  ICSharpCode.SharpDevelop SolutionNodeCommands.cs 21 </li><li>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'node', 'solutionFolderNode'.  ICSharpCode.SharpDevelop SolutionNodeCommands.cs 91 </li><li>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'node', 'solutionFolderNode'.  ICSharpCode.SharpDevelop SolutionNodeCommands.cs 115 </li><li>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'node', 'solutionFolderNode'.  ICSharpCode.SharpDevelop SolutionNodeCommands.cs 138 </li><li>  <a href="http://www.viva64.com/ru/w/V3019/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'rr', 'mrr'.  ICSharpCode.SharpDevelop RefactoringService.cs 330 </li></ul><br>  <b>Inaccurate code</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression 't == null' is always true.  VisualPascalABCNET Debugger.cs 141 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Type </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTypeForStatic</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name)</span></span></span><span class="hljs-function"> </span></span>{ Type t = stand_types[name] as Type; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t != null) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t == null) <span class="hljs-comment"><span class="hljs-comment">// &lt;= foreach (string s in ns_ht.Keys) { .... } t = PascalABCCompiler.NetHelper.NetHelper.FindType(name); .... }</span></span></code> </pre> <br>  There is no error, but the program looks messy. <br><br>  Similar constructions in code: <br><br><ul><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression 'CodeCompletion.CodeCompletionController.CurrentParser == null' is always false.  VisualPascalABCNET CodeCompletionKeyHandler.cs 91 </li><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression 'CodeCompletion.CodeCompletionController.CurrentParser == null' is always false.  VisualPascalABCNET CodeCompletionKeyHandler.cs 114 </li><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression 'CodeCompletion.CodeCompletionController.CurrentParser == null' is always false.  VisualPascalABCNET CodeCompletionKeyHandler.cs 136 </li><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression 'CodeCompletion.CodeCompletionController.CurrentParser == null' is always false.  VisualPascalABCNET CodeCompletionKeyHandler.cs 183 </li><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression 'defaultCompletionElement == null &amp;&amp; data! = Null' is always false.  VisualPascalABCNET CodeCompletionProvider.cs 507 </li><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression 'inRecalculateNeedsRedraw' is always false.  VisualPascalABCNET DynamicTreeView.cs 1103 </li><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression 'expressionResult! = Null &amp;&amp; expressionResult! = ""' Is always false.  VisualPascalABCNET CodeCompletionActions.cs 225 </li><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression 'SaveCanceled' is always false.  VisualPascalABCNET FileOperations.cs 442 </li><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression '! SaveCanceled' is always true.  VisualPascalABCNET FileOperations.cs 450 </li><li>  <a href="http://www.viva64.com/ru/w/V3022/">V3022</a> Expression '_format_expr.format2! = Null' is always true.  VisualPascalABCNET ExpressionEvaluation.cs 7028 </li></ul><br>  I brought only the first 10 similar warnings from more than 45. <br><br>  <b>Excess check or error?</b> <br><br>  <a href="http://www.viva64.com/ru/w/V3030/">V3030</a> Recurring check.  The 'upperScopeWhereVarsAreCaptured! = Scope' condition was already verified in line 383. TreeConverter CapturedVariablesSubstitutionClassGenerator.cs 391 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VisitCapturedVar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (upperScopeWhereVarsAreCaptured != scope) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (upperScopeWhereVarsAreCaptured != scope) { .... } .... } .... }</code> </pre> <br>  Usually such constructions are not an error, but there is a possibility that one of the checks should have contained another condition. <br><br>  Similar errors in the code: <br><br><ul><li>  <a href="http://www.viva64.com/ru/w/V3030/">V3030</a> Recurring check.  The 'kav.Count == 0' condition was already verified in line 2515. ParserTools DefaultLanguageInformation.cs 2518 </li><li>  <a href="http://www.viva64.com/ru/w/V3030/">V3030</a> Recurring check.  The 'ret_tn! = Null' condition was already verified in line 289. CodeCompletion FindReferences.cs 291 </li><li> <a href="http://www.viva64.com/ru/w/V3030/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3030</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Recurring check. </font><font style="vertical-align: inherit;">The 'kav.Count == 0' condition was already verified in line 885. VBNETParser LanguageInformation.cs 888</font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Strange formatting </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3033/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3033</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It is possible that this 'else' branch must apply to the previous 'if' statement. </font><font style="vertical-align: inherit;">TreeConverter syntax_tree_visitor.cs 14894</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">visit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_var_def_statement.inital_value != null) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_event) AddError(....); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">According to the logic of the program, the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> keyword </font><font style="vertical-align: inherit;">refers to the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if (is_event)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> condition block </font><font style="vertical-align: inherit;">. However, the code is formatted in such a way that a completely different impression is created. Probably using </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{}</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> brackets </font><font style="vertical-align: inherit;">would solve the problem. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typo </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3038/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3038</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> of The 'enum_consts [i]' argument WAS PASSED to 'the Compare' method Several Times. It can be passed. CodeCompletion SymTable.cs 2206</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; enum_consts = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsEqual</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SymScope ts)</span></span></span><span class="hljs-function"> </span></span>{ EnumScope es = ts as EnumScope; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (es == null) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (enum_consts.Count != es.enum_consts.Count) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; es.enum_consts.Count; i++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Compare(enum_consts[i], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.enum_consts[i], <span class="hljs-literal"><span class="hljs-literal">true</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">// &lt;= return false; return true; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unfortunately, the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsEqual</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><i><font style="vertical-align: inherit;">does</font></i><font style="vertical-align: inherit;"> not contain the declaration of a local variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enum_consts</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Therefore, inside a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> loop, the </font><font style="vertical-align: inherit;">elements of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enum_consts</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> list </font><i><font style="vertical-align: inherit;">are</font></i><font style="vertical-align: inherit;"> repeatedly compared to themselves. </font><font style="vertical-align: inherit;">By looking at the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsEqual</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method, </font><i><font style="vertical-align: inherit;">you</font></i><font style="vertical-align: inherit;"> can make an assumption about the correct code version:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsEqual</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SymScope ts)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; es.enum_consts.Count; i++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Compare(enum_consts[i], es.enum_consts[i], <span class="hljs-literal"><span class="hljs-literal">true</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span>) .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problem with Logic v2.0 </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3043/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3043</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The code's operational logic does not correspond with its formatting. </font><font style="vertical-align: inherit;">The statement is indented. </font><font style="vertical-align: inherit;">It is possible that curly brackets are missing. </font><font style="vertical-align: inherit;">VBNETParser LanguageInformation.cs 1002</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindExpression</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (ch) { .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'('</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (kav.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> sb.Insert(<span class="hljs-number"><span class="hljs-number">0</span></span>, ch); punkt_sym = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The assignment of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">punkt_sym = true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be performed regardless of the result of the test </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kav.Count == 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . However, the code is formatted in such a way that it seems that this will be done only if </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kav.Count! = 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another similar error: </font></font><br><br> <a href="http://www.viva64.com/ru/w/V3043/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3043</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The code's operational logic does not correspond with its formatting. The statement is indented. It is possible that curly brackets are missing. ICSharpCode.SharpDevelop AbstractConsolePad.cs 159 </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exception stack loss </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3052/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3052</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The original exception object 'e' was swallowed. Stack of original exception could be lost. NETGenerator NETGenerator.cs 925</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvertFromTree</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { .... } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (System.Runtime.InteropServices.COMException e) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TreeConverter.SaveAssemblyError(e.Message); } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From the object of the thrown exception </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COMException, the</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> developer uses only the text of the message. </font><font style="vertical-align: inherit;">Apparently, this is a sensible decision, since further an exception is thrown of type </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SaveAssemblyError</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the constructor of which requires nothing but the text of the message:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SaveAssemblyError</span></span></span><span class="hljs-class"> :</span></span> CompilationError { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SaveAssemblyError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> text)</span></span></span><span class="hljs-function"> </span></span>{ _text = text; } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, such an implementation option is the author‚Äôs right. </font><font style="vertical-align: inherit;">However, in my opinion, exception handling in this case does not look complete. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Similar errors in the code:</font></font><br><br><ul><li> <a href="http://www.viva64.com/ru/w/V3052/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3052</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The original exception object 'e' was swallowed. </font><font style="vertical-align: inherit;">Stack of original exception could be lost. </font><font style="vertical-align: inherit;">NETGenerator NETGenerator.cs 929</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3052/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3052</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The original exception object 'ex' was swallowed. </font><font style="vertical-align: inherit;">Stack of original exception could be lost. </font><font style="vertical-align: inherit;">ICSharpCode.SharpDevelop ReferenceFolderNodeCommands.cs 92</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3052/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3052</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The original exception object 'ex' was swallowed. </font><font style="vertical-align: inherit;">Stack of original exception could be lost. </font><font style="vertical-align: inherit;">TreeConverter syntax_tree_visitor.cs 16324</font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Error working with substrings </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3053/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3053</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> An excessive expression. </font><font style="vertical-align: inherit;">Examine the substrings 'reduction' and 'reduction ('. TreeConverter OpenMP.cs 267</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessClauses</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Text, ....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (AllowReduction &amp;&amp; (Text.StartsWith(<span class="hljs-string"><span class="hljs-string">"reduction"</span></span>) || Text.StartsWith(<span class="hljs-string"><span class="hljs-string">"reduction("</span></span>))) { .... } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this case, the search for the substring </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúreduction (‚Äù is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> meaningless, since the substring </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúreduction‚Äù</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will always be found earlier </font><font style="vertical-align: inherit;">. </font><a href="http://www.viva64.com/ru/w/V3070/"><font style="vertical-align: inherit;">Wrong </font></a></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initialization order </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3070/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3070</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Uninitialized variable 'event_add_method_prefix' is used</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">compiler_string_consts</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> event_add_method_nameformat = event_add_method_prefix + <span class="hljs-string"><span class="hljs-string">"{0}"</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> event_add_method_prefix = <span class="hljs-string"><span class="hljs-string">"add_"</span></span>; .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a result of executing the above code snippet, the string </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">event_add_method_nameformat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will get the value </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"{0}"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , instead of the expected </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"add_ {0}"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">To correct the error, swap the field initialization lines:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">compiler_string_consts</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> event_add_method_prefix = <span class="hljs-string"><span class="hljs-string">"add_"</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> event_add_method_nameformat = event_add_method_prefix + <span class="hljs-string"><span class="hljs-string">"{0}"</span></span>; .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another similar error: </font></font><br><br> <a href="http://www.viva64.com/ru/w/V3070/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3070</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Uninitialized variable 'event_remove_method_prefix' is used when initializing the 'event_remove_method_nameformat' variable. TreeConverter compiler_string_consts.cs 314 </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zero link access: sloppy refactoring </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3080/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible null dereference. Consider inspecting 'tc'. CodeCompletion CodeCompletionPCUReader.cs 736</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> TypeScope </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTemplateInstance</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TypeScope tc = null;<span class="hljs-comment"><span class="hljs-comment">//GetTemplateClassReference(); int params_count = br.ReadInt32(); for (int i = 0; i &lt; params_count; i++) { tc.AddGenericInstanciation(GetTypeReference()); // &lt;= } return tc; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you can see, the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable was previously </font><font style="vertical-align: inherit;">initialized with the value </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetTemplateClassReference ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">However, now is the value </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">As a result, the first iteration of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> loop </font><font style="vertical-align: inherit;">will result in an access error on the null link. </font><font style="vertical-align: inherit;">Perhaps, the error has not yet manifested itself, as there are no calls to the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetTemplateInstance ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">in the code. </font><font style="vertical-align: inherit;">But there is no guarantee that this will continue. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Similar errors in the code:</font></font><br><br><ul><li> <a href="http://www.viva64.com/ru/w/V3080/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible null dereference. </font><font style="vertical-align: inherit;">Consider inspecting 'bfc'. </font><font style="vertical-align: inherit;">TreeConverter syntax_tree_visitor.cs 7334</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3080/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible null dereference. </font><font style="vertical-align: inherit;">Consider inspecting 'bfc'. </font><font style="vertical-align: inherit;">TreeConverter syntax_tree_visitor.cs 7336</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3080/">V3080</a> Possible null dereference. Consider inspecting 'bfc'. TreeConverter syntax_tree_visitor.cs 7338 </li><li> <a href="http://www.viva64.com/ru/w/V3080/">V3080</a> Possible null dereference. Consider inspecting 'bfc'. TreeConverter syntax_tree_visitor.cs 7340 </li><li> <a href="http://www.viva64.com/ru/w/V3080/">V3080</a> Possible null dereference. Consider inspecting 'bfc'. TreeConverter syntax_tree_visitor.cs 7409 </li><li> <a href="http://www.viva64.com/ru/w/V3080/">V3080</a> Possible null dereference. Consider inspecting 'bfc'. TreeConverter syntax_tree_visitor.cs 7411 </li><li> <a href="http://www.viva64.com/ru/w/V3080/">V3080</a> Possible null dereference. Consider inspecting 'bfc'. TreeConverter syntax_tree_visitor.cs 7413 </li><li> <a href="http://www.viva64.com/ru/w/V3080/">V3080</a> Possible null dereference. Consider inspecting 'bfc'. TreeConverter syntax_tree_visitor.cs 7415 </li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Access via null link: inattention </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3095/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The 'VisualEnvironmentCompiler.RemoteCompiler' object was used against it. </font><font style="vertical-align: inherit;">Check lines: 52, 54. CompilerController CompilerControllerPlugin.cs 52</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CompilerController_VisualPascalABCPlugin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... VisualEnvironmentCompiler.RemoteCompiler.InternalDebug.RunOnMono = CompilerInformation.cbRunMono.Checked; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VisualEnvironmentCompiler.RemoteCompiler != null) .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Check for possible equality of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable is </font><font style="vertical-align: inherit;">done after its use. </font><font style="vertical-align: inherit;">Corrected code:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CompilerController_VisualPascalABCPlugin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VisualEnvironmentCompiler.RemoteCompiler != null) { VisualEnvironmentCompiler.RemoteCompiler. InternalDebug.RunOnMono = CompilerInformation.cbRunMono.Checked; .... } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Similar errors in the code: </font></font><br><br><ul><li> <a href="http://www.viva64.com/ru/w/V3095/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The 'cun' object was used against it. </font><font style="vertical-align: inherit;">Check lines: 400, 401. Compiler PCUReader.cs 400</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3095/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The 'cnfn.ConnectedToType.element_type' it was verified against null. </font><font style="vertical-align: inherit;">Check lines: 2918, 2930. Compiler PCUReader.cs 2918</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3095/">V3095</a> The '_currentTreeNode' object was used before it was verified against null. Check lines: 590, 593. TreeConverter CapturedVariablesTreeBuilder.cs 590 </li><li> <a href="http://www.viva64.com/ru/w/V3095/">V3095</a> The 'Units' object was used before it was verified against null. Check lines: 3031, 3073. Compiler Compiler.cs 3031 </li><li> <a href="http://www.viva64.com/ru/w/V3095/">V3095</a> The 'frm' object was used before it was verified against null. Check lines: 2358, 2364. NETGenerator NETGenerator.cs 2358 </li><li> <a href="http://www.viva64.com/ru/w/V3095/">V3095</a> The 'InitalValue' object was used before it was verified against null. Check lines: 2915, 2918. NETGenerator NETGenerator.cs 2915 </li><li> <a href="http://www.viva64.com/ru/w/V3095/">V3095</a> The 'InitalValue' object was used before it was verified against null. Check lines: 2952, 2956. NETGenerator NETGenerator.cs 2952 </li><li> <a href="http://www.viva64.com/ru/w/V3095/">V3095</a> The 'InitalValue' object was used before it was verified against null. Check lines: 3005, 3009. NETGenerator NETGenerator.cs 3005 </li><li> <a href="http://www.viva64.com/ru/w/V3095/">V3095</a> The 'InitalValue' object was used before it was verified against null. Check lines: 3041, 3045. NETGenerator NETGenerator.cs 3041 </li><li> <a href="http://www.viva64.com/ru/w/V3095/">V3095</a> The 'InitalValue' object was used before it was verified against null. Check lines: 3103, 3107. NETGenerator NETGenerator.cs 3103 </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I cited only the first 10 of these errors from more than 40. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infinite recursion: x2 </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3110/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3110</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible infinite recursion inside 'SetRange' method. </font><font style="vertical-align: inherit;">TreeConverter SymbolInfoArrayList.cs 439 </font></font><br><br> <a href="http://www.viva64.com/ru/w/V3110/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3110</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible infinite recursion inside 'SetRange' method. </font><font style="vertical-align: inherit;">TreeConverter SymbolInfoArrayList.cs 444</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetRange</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index,SymbolInfo[] tnarr)</span></span></span><span class="hljs-function"> </span></span>{ SetRange(index,tnarr); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetRange</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index,SymbolInfoArrayList tnarl)</span></span></span><span class="hljs-function"> </span></span>{ SetRange(index,tnarl); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Immediately two methods that implement infinite recursion. </font><font style="vertical-align: inherit;">Both methods are similar and differ only in the type of the second argument. </font><font style="vertical-align: inherit;">Nowhere in the code are not used. </font><font style="vertical-align: inherit;">At least not yet used. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Similar errors in the code:</font></font><br><br><ul><li> <a href="http://www.viva64.com/ru/w/V3110/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3110</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible infinite recursion inside 'node_kind' property. </font><font style="vertical-align: inherit;">TreeConverter functions.cs 2528</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3110/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3110</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible infinite recursion inside 'node_location_kind' property. </font><font style="vertical-align: inherit;">TreeConverter functions.cs 2590</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3110/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3110</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible infinite recursion inside 'node_kind' property. </font><font style="vertical-align: inherit;">TreeConverter functions.cs 2693</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3110/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3110</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible infinite recursion inside 'node_location_kind' property. </font><font style="vertical-align: inherit;">TreeConverter functions.cs 2704</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3110/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3110</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possible infinite recursion inside 'Instance' property. </font><font style="vertical-align: inherit;">ParserTools LanguageInformation.cs 549</font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Careless implementation of the method Equals </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3115/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3115</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Passing 'null' to 'Equals' method should not result in 'NullReferenceException'. </font><font style="vertical-align: inherit;">ICSharpCode.SharpDevelop ServiceReferenceMapFile.cs 31</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object obj)</span></span></span><span class="hljs-function"> </span></span>{ var rhs = obj as ServiceReferenceMapFile; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FileName == rhs.FileName; <span class="hljs-comment"><span class="hljs-comment">// &lt;= }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The author of this code snippet rather carelessly reacted to the safety issues of his work. </font><font style="vertical-align: inherit;">At least one check for the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> equality of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rhs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable </font><font style="vertical-align: inherit;">after its initialization is </font><font style="vertical-align: inherit;">missing </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">And in order not to do extra work at all, a preliminary check on the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obj is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> necessary </font><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object obj)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obj == null || !(obj is ServiceReferenceMapFile)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; var rhs = obj as ServiceReferenceMapFile; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FileName == rhs.FileName; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Not enough checks </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3125/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The 'resources' object was used after it was verified against null. </font><font style="vertical-align: inherit;">Check lines: 215, 211. VisualPascalABCNET DesignerResourceService.cs 215</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> System.Resources.<span class="hljs-function"><span class="hljs-function">IResourceReader </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetResourceReader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(System.Globalization.CultureInfo info)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (resources != null &amp;&amp; resources.ContainsKey(info.Name)) { resourceStorage = resources[info.Name]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { resourceStorage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ResourceStorage(); resources[info.Name] = resourceStorage; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } .... }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code contains a check for the equality of the </font><i><font style="vertical-align: inherit;">resources</font></i><font style="vertical-align: inherit;"> variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but this is not enough, since the </font><i><font style="vertical-align: inherit;">else</font></i><font style="vertical-align: inherit;"> block </font><font style="vertical-align: inherit;">does not contain such a check. </font><font style="vertical-align: inherit;">Under certain circumstances, this will inevitably lead to access via a null link. </font><font style="vertical-align: inherit;">Code needs to be corrected:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> System.Resources.<span class="hljs-function"><span class="hljs-function">IResourceReader </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetResourceReader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(System.Globalization.CultureInfo info)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (resources != null) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (resources.ContainsKey(info.Name)) { resourceStorage = resources[info.Name]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { resourceStorage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ResourceStorage(); resources[info.Name] = resourceStorage; } } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Similar errors in the code: </font></font><br><br><ul><li> <a href="http://www.viva64.com/ru/w/V3125/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The 'this._grid' object was used after it was verified against null. </font><font style="vertical-align: inherit;">Check lines: 751, 746. VisualPascalABCNET TreeGridNode.cs 751</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3125/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The 'this._grid' object was used after it was verified against null. </font><font style="vertical-align: inherit;">Check lines: 774, 770. VisualPascalABCNET TreeGridNode.cs 774</font></font></li><li> <a href="http://www.viva64.com/ru/w/V3125/">V3125</a> The 'node.Parent' object was used after it was verified against null. Check lines: 369, 350. VisualPascalABCNET TreeGridView.cs 369 </li><li> <a href="http://www.viva64.com/ru/w/V3125/">V3125</a> The 'CurrentCodeFileDocument' object was used after it was verified against null. Check lines: 395, 384. VisualPascalABCNET WindowOperations.cs 395 </li><li> <a href="http://www.viva64.com/ru/w/V3125/">V3125</a> The 'value.main_function' object was used after it was verified against null. Check lines: 948, 942. LanguageConverter Visitor.cs 948 </li><li> <a href="http://www.viva64.com/ru/w/V3125/">V3125</a> The 'left.prim_val' object was used after it was verified against null. Check lines: 4711, 4699. VisualPascalABCNET ExpressionEvaluation.cs 4711 </li><li> <a href="http://www.viva64.com/ru/w/V3125/">V3125</a> The 'left.obj_val' object was used after it was verified against null. Check lines: 4849, 4822. VisualPascalABCNET ExpressionEvaluation.cs 4849 </li><li> <a href="http://www.viva64.com/ru/w/V3125/">V3125</a> The 'to' object was used after it was verified against null. Check lines: 335, 327. TreeConverter CapturedVariablesTreeBuilder.cs 335 </li><li> <a href="http://www.viva64.com/ru/w/V3125/">V3125</a> The 'dii_left' object was used after it was verified against null. Check lines: 256, 254. TreeConverter LambdaHelper.cs 256 </li><li> <a href="http://www.viva64.com/ru/w/V3125/">V3125</a> The 't' object was used after it was verified against null. Check lines: 23, 20. TreeConverter semantic_checks_for_sugar.cs 23 </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I cited only the first 10 similar errors from more than 80 (eighty!). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incorrect initialization order </font></font></b> <br><br> <a href="http://www.viva64.com/ru/w/V3128/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3128</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The 'dockPanel' field is used before it is initialized in constructor. </font><font style="vertical-align: inherit;">ICSharpCode.SharpDevelop SearchResultsPad.cs 49</font></font><br><br><pre> <code class="cpp hljs">.... DockPanel dockPanel; .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SearchResultsPad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... defaultToolbarItems = ToolBarService. CreateToolBarItems(dockPanel, ....); <span class="hljs-comment"><span class="hljs-comment">// &lt;= foreach (object toolBarItem in defaultToolbarItems) { toolBar.Items.Add(toolBarItem); } .... dockPanel = new DockPanel { Children = { toolBar, contentPlaceholder } }; .... }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dockPanel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> field </font><i><font style="vertical-align: inherit;">is</font></i><font style="vertical-align: inherit;"> first used in the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SearchResultsPad</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constructor </font><font style="vertical-align: inherit;">, and then initialized. </font><font style="vertical-align: inherit;">At the same time, even if the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateToolBarItems</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">or nested methods provides for the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> equality of the </font><font style="vertical-align: inherit;">first argument, the method will probably return </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null. </font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This, in turn, will lead to further errors when using the variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">defaultToolbarItems</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2>  Statistics </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I see the big picture as follows. </font><font style="vertical-align: inherit;">SonarC # and PVS-Studio analyzers solve different tasks. </font><font style="vertical-align: inherit;">SonarC # is designed to evaluate and control code quality. </font><font style="vertical-align: inherit;">Therefore, it reports both errors and "smells" of the code. </font><font style="vertical-align: inherit;">PVS-Studio is focused on finding errors or places in the code that may later lead to errors. </font><font style="vertical-align: inherit;">Of course, the messages issued by these analyzers overlap partially, but are calculated for different needs:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SonarC # - regular multivariate analysis of metrics and warnings, in order to control the quality of the code; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PVS-Studio allows you to start looking for errors at any time and thereby improve the quality of the code. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I will give a summary table of the results of the verification of the project PascalABC.NET (Blocker, Critical and Major warning levels are taken): </font></font><br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/7fc/9c4/2c7/7fc9c42c70243ce68d4f6520c0fcfe15.png" alt="Picture 6"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Once again I want to note that analyzers cannot be directly compared by the number of errors found and the number of false positives. SonarC # tries to issue a warning to a code that, although bad, does not contain an error. This is exactly what makes it possible to evaluate the quality of the code. In its turn, the PVS-Studio analyzer in this case prefers to keep silent or issue a warning with a minimum level of confidence. At the same time, he tries to identify as many errors as possible and is trained to detect a greater number of defects that lead to program malfunctions.</font></font><br><br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, as expected, when working with the PVS-Studio and SonarC # plug-ins for SonarQube, I did not have any problems. All functions and features of the tools are documented. After downloading the results to the SonarQube server, you get access to a variety of functionalities for assessing the quality of your software product. As for the actual search for errors by source code analyzers, both tools showed a decent result. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To download and analyze an online project on the </font></font><a href="https://sonarqube.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SonarQube</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> website, </font><font style="vertical-align: inherit;">you need a minimum of effort and time. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using the PVS-Studio plugin to integrate the results of its work into the SonarQube is also not difficult. The only restriction is that you will need the </font></font><a href="https://www.viva64.com/ru/order/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enterprise version.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analyzer. </font><font style="vertical-align: inherit;">If you do not need integration with SonarQube, you can use PVS-Studio as an independent tool. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download and try PVS-Studio: </font></font><a href="http://www.viva64.com/ru/pvs-studio/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.viva64.com/en/pvs-studio/</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> For questions regarding the acquisition of a commercial license of PVS-Studio, please </font></font><a href="http://www.viva64.com/ru/about-feedback/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contact</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> us in the mail. </font><font style="vertical-align: inherit;">You can also email us to get a temporary license for a comprehensive study of PVS-Studio if you want to remove the </font></font><a href="http://www.viva64.com/ru/m/0009/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">restrictions of the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> demo version.</font></font><br><br><div style="text-align:center;"> <a href="http://www.viva64.com/en/b/0492/"><img src="https://habrastorage.org/files/8d2/41b/5bf/8d241b5bf34747169141ed7c1997143b.png"></a> </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you want to share this article with an English-speaking audience, then please use the link to the translation: Sergey Khrenov. </font></font><a href="http://www.viva64.com/en/b/0492/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analysis of PascalABC.NET using SonarQube plugins: SonarC # and PVS-Studio</font></font></a> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Read the article and have a question?</font></font></b> <div class="spoiler_text">          .      : <a href="http://www.viva64.com/ru/a/0085/">      PVS-Studio,  2015</a> . ,   . </div></div></div><p>Source: <a href="https://habr.com/ru/post/325126/">https://habr.com/ru/post/325126/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325116/index.html">Git scaling (and some background history)</a></li>
<li><a href="../325118/index.html">Vertical centering of simple divs with data-</a></li>
<li><a href="../325120/index.html">Hello, Schulte</a></li>
<li><a href="../325122/index.html">Smart Farm with Cowboy Drones using the SAP Cloud Platform</a></li>
<li><a href="../325124/index.html">Forbidden changes in the code or continuation of the repair history of one crane</a></li>
<li><a href="../325128/index.html">Printing in a company: pennies that save millions</a></li>
<li><a href="../325130/index.html">All protocol PHP bot in 10 minutes, or how Microsoft Bot Framework and Azure Functions make life easier for us</a></li>
<li><a href="../325132/index.html">Terminal Server for 1C over RDP on linux: recommendations for configuration based on the experience of actual operation</a></li>
<li><a href="../325136/index.html">Colocation: how, why and why</a></li>
<li><a href="../325138/index.html">Protection from DDoS attacks from the point of view of a telecom operator. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>