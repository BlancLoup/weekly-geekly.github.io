<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Smart home (the very beginning) - Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is a continuation of the article: Smart Home (The Beginning) - Part 1 

 In the last article I wrote about what a smart home is and where to star...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Smart home (the very beginning) - Part 2</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/831/29b/f50/83129bf50e41b0d4a551a74a43a384c3.jpg" alt="image"><br>  This is a continuation of the article: <a href="http://habrahabr.ru/post/227869/">Smart Home (The Beginning) - Part 1</a> <br><br>  In the last article I wrote about what a smart home is and where to start when creating it.  Now I will try to describe the technical part: hardware and software.  Just in case, <b>let me</b> remind the dear reader that this is <b>not a HOW to</b> , but an overview material, so there will most likely not be any specific solutions and code-inserts for copy-paste.  There are a lot of technologies and methods for solving the engineering problem and it‚Äôs impossible to describe everything in my articles. <br><br>  All information is written with an emphasis on personal experience, no "sofa" conjectures. <br><a name="habracut"></a><br>  Now back to the topic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As mentioned earlier, the core of the system should be located in some place isolated from the residents, and what, actually, is this core from the hardware point of view?  Of course the server.  Yes, yes, the server is not Arduino, not RazBury, not a router with OpenWrt, namely a server.  Why?  Because productivity, and also because all Arduins and so forth products are created to train pupils / students in programming of microcontrollers and work with the periphery.  These devices are not originally designed to deploy a complete ready-made and stable solution.  More precisely, no, you can deploy, but at your own peril and risk.  In general, if I‚Äôd put it quite rudely, then this is a constructor for adults, such as Lego Mindstorms, only slightly more complicated.  In no case do I have anything against these devices, just everyone has their own tasks.  I do not know how anyone, but personally I would not have entrusted the control of the gas boiler to the designer Lego. <br><br>  But by the word ‚Äúserver‚Äù I mean not a rack like in a DataCenter, stuffed with blades, but some small server.  We need to control the house, and not to calculate the coagulation of proteins, right? <br><br>  The server may be a small mini-ITX computer with a dual-core processor type D525 and 2GB of RAM.  This solution costs about $ 200. <br><img src="https://habrastorage.org/getpro/habr/post_images/54a/dc3/ee2/54adc3ee2ad14bb759296fa4e603b062.jpg" alt="image"><br>  This is such a small beautiful decision.  If you want to deploy media storage on this server, then you can plug in an external disk with a volume of ~ 3TB via USB. <br><br>  If there is more money under the server, then you can take an HP microserver, like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/d2d/c87/163/d2dc87163e99a2dfd1253acba8ad194c.jpg" alt="image"><br>  <a href="http://www.citilink.ru/catalog/computers_and_notebooks/servers_and_net_equipments/servers/753329/">www.citilink.ru/catalog/computers_and_notebooks/servers_and_net_equipments/servers/753329</a> <br>  He has the potential to grow, but someone may not be satisfied with the dimensions. <br>  Price about $ 280 for a starter kit (dual-core processor, 2GB of RAM and one SATA disk on 250GB) <br><br>  There is no sense to put something more and more powerful.  this iron is enough with the head. <br>  If possible, look for hardware with USB 2.0 (even better: USB3). <br><br>  It will also be a plus if you use an SSD drive as the system disk.  This will give a good increase in the speed of loading the core of a smart home.  For example, the core of my smart home is loaded (with an SSD) for no longer than loading a regular household Wi-Fi router - turned it on and use it. <br><br>  To configure the server, a keyboard and a monitor will be needed temporarily (to deploy the OS, the rest of the settings will be made remotely). <br><br>  We must not forget about the network. <br>  As far as possible, up to all fixed network devices (computers, media players, network printers and cameras) it is better to lay a twisted pair in advance.  For switching, it is better to use switches (switches) with Gigabit Ethernet ports. <br>  To connect to the provider‚Äôs network, you can use any router with Wi-Fi, but it‚Äôs better not to connect anything to the internal ports except the above switch / -s. <br><br>  In general, try not to count on Wi-Fi, especially when it comes to transferring media data (video / sound) - there may be delays and failures. <br><br>  In general, the connection scheme should be approximately as follows: <br>  The cord received from the provider, you connect to the WAN port of your router, and connect your switch to the LAN port. <br>  In turn, you connect all other network devices to the switch. <br><br>  Why is that?  To eliminate the "fall" of the entire network, if, for example, your not quite successfully purchased router suddenly hangs.  When the router is restarted, all devices connected to it will lose connection, and if you watched video from the network storage connected to the router on the media player, then, as you understand, the video will be interrupted.  Enough is not enough. <br><br>  If your house is large, then it is possible that signal repeaters will be needed to fully cover the wireless network of the entire dwelling.  Do not expect that you will buy the most expensive Wi-Fi router and it will ‚Äúbreak all‚Äù your reinforced concrete partitions.  It is better to take the router "easier", and to him a couple / three repeaters. <br><br>  <b>Software</b> <br><br>  I recommend that the server be deployed as a Debian Linux system operating system without a graphics system.  Why him, and not, say, Ubuntu?  Well, first of all, Ubuntu is mainly set up by those who need the X-window system, and why should we have a headline-based graphics server?  Who and what will be looking at?  And secondly, Ubuntu, in fact, is Debian, only with all sorts of whistles / perdefies that you can deliver yourself (I hope so, because without these skills you can‚Äôt completely deploy Smart Home right).  But if you are used to something else (for example, the RedHat family, or Slackware), then do something that is closer and clearer to you.  In the end, you all set it up. <br><br>  From the software, I think to install Samba correctly (most household players with a network on board can work with this) and NFS (not Need Need Speed, but Network File System).  NFS is useful to you if you use MacOS or Linux at home on your computers / players.  They even seem to say that NFS loads the processor less than Samba, but personally it seems to me that it would hardly be possible to create a large load on the scale of a house. <br><br>  If you have a so-called.  Smart TVs, you may have to deploy UPnP and DNLA servers, because  most smart TVs do not understand Samba or NFS. <br><br>  To deploy the DNLA / UPnP bundle, I recommend turning your attention to the PMS ( <a href="https://code.google.com/p/ps3mediaserver/">PlayStation3 Media Server</a> ) project, which once grew out of a media server deployed on the PlayStation3 game cracked platform.  The project has grown and mutated in <a href="http://www.universalmediaserver.com/">UMS</a> (http://www.universalmediaserver.com/).  Installation is quite simple, it is better to read the latest installation information on the project website. <br><br>  I checked PMS and UMS with transcoding - everything worked without complaints.  Even when used as a media player Xbox360 console (it has a specific profile of work with UPnP): everything worked. <br><br>  There is one more UPnP server: <a href="https://plex.tv/">PlexMediaServer</a> (https://plex.tv/), but, to be honest, his work with transcoding on the Xbox360 could not be verified, since  I had already sold the prefix.  In general, the Plex is very powerful and functional, perhaps even to some, it will seem excessively functional, but it works on Smart-TVs and no one seems to complain. <br><br>  I myself do not use UPnP, because  My TVs are old, not Smart, and equipped with Dune players that work great with a video / music storage (by Samba) located in the core of a smart home, but just in case Plex still works and is always happy to serve some android client . <br><br>  If you like to download videos from torrents, then you can put Transmission, an application for downloading from torrent trackers, onto the core of a smart home.  Transmission can work without a graphic system and is controlled via a web-interface or using a Transmission-remote (application for remote download control).  It is installed from the repositories of linux distributions. <br><br>  In addition to the Media components, someone will certainly want the smart home to be voiced by something or accept and process voice commands.  For example, you say: ‚ÄúHut, what is the temperature on the street?‚Äù, And the system answers you with Millar‚Äôs ‚Äã‚Äãvoice: ‚ÄúUhhhhhhh!  On the street 25 degrees below zero.  Get me into the stove, warm your bones. " <br><img src="https://habrastorage.org/getpro/habr/post_images/8e6/678/899/8e667889975295c31c90ee83afa09c30.jpg" alt="image"><br><br>  So, given the concept of "Isolated and self-sufficient smart home" (which was discussed in the first part), all sorts of crafts based on Google Voice services or Yandex Voice API should be dismissed.  Make the system in a normal, non-hungry manner.  Of course, I understand that it‚Äôs hard to imagine the absence of the Internet in a house for residents of large regions, nor is it hard to imagine that Google may be unavailable, but ... until August 1945, the Japanese also couldn‚Äôt imagine that only one bomb could destroy whole city <br><br>  The guys from <a href="http://lizardpatrol.com/">Lizard Squad</a> showed the world that there are no perfect services: PlayStationNetwork by Sony and the Microsoft network lay for 4 days due to a massive DDos attack, and in some regions they were unavailable on the 5th day.  It is possible that there will be some Blizzard Division and Google / Yandex, because you do not need to trust online services.  Well, or if you still count on these services, then design your smart home so that, in the event of the destruction of the Global Network, the functionality of your system is not impaired. <br><br>  Whatever happens in the world, your smart home should "... work, work, and work" (from advertising batteries). <br><br>  The same applies to all services such as Openremote or Fibaro: type, configure your server from anywhere in the world, and it will pick up all the settings and immediately work as you need.  But how will you set up the same expensive Fibaro if the service will lie under DDos for a whole month?  How do you add a new dimer to your controller?  You use to configure it locally.  So all these services you just do not need.  Do yours, immediately and for sure.  So that nothing darkens your life in the midst of your beautiful home. <br><br>  Now another part of the smart home that you may need: <br><br>  <b>CCTV</b> <br><br>  If you are going to do video surveillance, I recommend using not analog cameras, but network (IP cameras) with power over Ethernet (PoE).  These cameras give a good picture (often HD / FullHD) and it is easier to build an archiving system with them. <br><br>  In addition to cameras, you may need a NVR (Network Video Recorder) - this is such a ‚Äúbox‚Äù that is responsible for receiving and saving images from cameras. <br><br>  In the question of organizing the NVR, just one more plus will be if you build the core of your smart home on a Linux server.  All NVR functionality can be deployed right on it.  But if the core is Arduino, Rasberi or similar controllers, then they will not pull the NVR functionality, because there simply isn‚Äôt enough performance. <br><br>  Those who lacked the imagination to figure out how to implement it, I can suggest the project ‚ÄúMoment Video Server‚Äù ( <a href="http://momentvideo.org/">http://momentvideo.org/</a> ).  This is not an advertisement. <br><br>  These people make a very intelligent and productive video server, incl.  and with NVR function.  The system is shareware and you can put on your server a version that supports a limited number of devices. <br><br>  Installation is simple: <br>  Pull down the installation archive: <br><pre><code class="bash hljs">wget http://momentvideo.org/dist/moment_14-04-29_linux32.tar.gz</code> </pre> <br>  or <br><pre> <code class="bash hljs">wget http://momentvideo.org/dist/moment_14-04-29_linux64.tar.gz</code> </pre>  (if you have a 64-bit OS) <br>  Unpack: <br><pre> <code class="bash hljs">tar -C /opt -xzf moment_14-04-29_linux32.tar.gz</code> </pre><br>  As a result, a directory will be created: <b>/ opt / moment</b> <br>  The configuration is done by editing the file <b>moment.conf</b> <br>  Read more about the settings on the authors site: <a href="http://momentvideo.org/doc.ru.html">http://momentvideo.org/doc.ru.html</a> <br><br>  The server is started by the command: <br><pre> <code class="bash hljs">/opt/moment/bin/moment</code> </pre><br><br>  By default, in the browser open <b>http: // ip-server: 8080 / moment /</b> <br>  and see the Moment server page. <br>  I played with this thing and still built something of my own. <br><br>  If you want to make not a NVR, but a motion recording system, then choose cameras that support MJPG (aka MotionJPEG), this task is very easy for them: by installing and properly configuring the Motion application from the linux distribution kits repository. <br><br>  When I built my video surveillance system, I introduced the concepts of ‚ÄúOperational archive‚Äù and ‚ÄúLong-term archive‚Äù. <br><br>  The online archive contains records for the current day - this is convenient if you want to quickly look at what is there and how, and the long-term archive is an archive with categories by year, month and day.  The long-term archive is synchronized with the cloud in the dead of night, and the real-time archive is written to disk and to the cloud in real time.  Operational archive in the cloud will be needed if the attackers penetrate the house and in addition to the values ‚Äã‚Äãwill carry / destroy the core of the smart home. <br><br>  In the office of the security officer, you simply go to your cloud and view all the recordings of the cameras until they are turned off. <br><br>  Another option: hidden network storage, which will be synchronized video-archives.  The most important thing is that this repository is hidden in a safe cache, so that attackers do not find it. <br><br>  UPS, of course, must hold not only the core of the smart home, but also the PoE system of your cameras. <br><br>  <b>Instead of conclusion</b> <br><br>  All of the above can be built on a dual-core Atom processor with 4 GB of RAM, moreover, I built it and use it in my house.  Make the core of a smart home with your own hands, without using solutions with limited functionality.  The most important thing: a clear plan, competently set engineering task and direct hands. <br><img src="https://habrastorage.org/getpro/habr/post_images/2d4/8de/664/2d48de664ab299eae0d5607b5a0712df.jpg" alt="image"><br><br>  Now that's it.  At first glance, for the very beginning and for the realization of the approximate scope of work, this information should suffice. <br><br>  Maybe I will remember something else, and if there is enough information, I will write the following article. <br><br>  Thank you all for your attention. <br>  Happy holidays to you, dear readers!  <b>Happiness to you and your loved ones, peace to your home!</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/13b/3c7/92f/13b3c792f9205ea8398eec83202d0419.jpg" alt="image"><br><br>  <b>PS</b> There was no time to read the text very carefully, so if there are blatant typing errors / misprints, report it and I will correct it. </div><p>Source: <a href="https://habr.com/ru/post/247105/">https://habr.com/ru/post/247105/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../247089/index.html">How to choose key aspects of life in order to invest time and energy in them</a></li>
<li><a href="../247091/index.html">What to expect in 2015: Trends in the data center</a></li>
<li><a href="../247095/index.html">Alex Schultz (part 3): an introduction to growth hacking</a></li>
<li><a href="../247101/index.html">Portaller - now with support for Pandora, Spotify, Rdio, Netflix and Amazon Video on all devices</a></li>
<li><a href="../247103/index.html">6 games in 6 weeks - Game 6</a></li>
<li><a href="../247109/index.html">There are no auto testers in the team - what to do?</a></li>
<li><a href="../247113/index.html">Happy New Year!</a></li>
<li><a href="../247115/index.html">As I nephew congratulated on his birthday</a></li>
<li><a href="../247117/index.html">BudgetApps - First All-Russian Open Financial Data Competition</a></li>
<li><a href="../247119/index.html">Top games and applications of 2014 in the Russian Windows Phone Store</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>