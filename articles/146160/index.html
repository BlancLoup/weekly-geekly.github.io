<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Making an IBM PC on FPGA</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think many who worked with the FPGA thought - and not to make your computer completely on it, with the x86 processor, peripherals, and so on? 8-bit ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Making an IBM PC on FPGA</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/1b3/0ea/6fb/1b30ea6fb95f575a56f7d94b5cb158b5.jpg" align="right">  I think many who worked with the FPGA thought - and not to make your computer completely on it, with the x86 processor, peripherals, and so on?  8-bit computers are often implemented in FPGA, but here is a whole PC ... <br><br>  In addition to the x86 processor, you need a BIOS with all the interrupts implemented (including access to the ‚Äúdisk‚Äù on the SD card), a BIOS of a VGA-compatible video card, all peripherals, a memory controller, a timer, and much more.  The task is much more complicated than it seems at first glance, but nevertheless, it is solved in the <a href="http://zet.aluzina.org/index.php/Zet_processor">ZetCPU</a> project. <br><br>  Of the restrictions, only the 16-bit mode at 12.5Mhz works, without a math coprocessor. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Iron </h1><img src="https://habrastorage.org/getpro/habr/post_images/a93/ad7/160/a93ad7160152f09c7aaa4ac07a183df5.jpg"><br>  To run, we need a debug board with FPGA.  I really liked the board <a href="http://www.terasic.com.tw/cgi-bin/page/archive.pl%3FLanguage%3DEnglish%26No%3D502">Terasic DE2-115</a> (on Altera Cyclone IV with 115 thousand. LE).  The student price is $ 299, less than the retail price of a single chip. <br><br>  The board has a lot of built-in hardware - 2 x 8 MB of SDRAM memory, 256KB of SRAM, 1 MB of flash memory, 2 PHY 1Gb Ethernet, VideoDAC for connecting to VGA, LEDs / switches / buttons, a connector for an SD card, and so on.  But this project uses far from everything (only SD card, Flash, SDRAM and VideoDAC). <br><br>  The project can also be launched on <a href="http://www.terasic.com.tw/cgi-bin/page/archive.pl%3FLanguage%3DEnglish%26CategoryNo%3D139%26No%3D593">DE0 Nano</a> with a student price of $ 59, but only text mode will work there. <br><br><h1>  Run </h1><br>  There are several obvious points in the installation that are not described in the <a href="http://zet.aluzina.org/index.php/Altera_DE1_Installation_guide">instructions</a> : <br><br><ul><li>  Download firmware DE2_115_ControlPanel.sof to the board </li><li>  Run the DE2 ControlPanel and fill the BIOS and boot floppy into flash memory according to the instructions. </li><li>  We write the hard disk image to the SD card using <a href="https://launchpad.net/win32-image-writer">win32-image-writer</a> , not WinImage - it breaks the boot image with large maps </li><li>  Compile the BIOS / VGA BIOS or take ready-made from the installation archive </li><li>  We compile our PC-shku written on Verilog in Quartus or we take ready kotku.sof and flash it into the board </li></ul><br><br>  Now you can connect a monitor to the board, a PS / 2 keyboard - and turn it on :-) <br>  You can add your instructions in the processor, your peripherals, see the implementation of any instructions in verilog-source ... <br><br><div class="spoiler">  <b class="spoiler_title">An example of the implementation of integer division</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">module</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zet_div_uu</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(clk, ena, z, d, q, s, div0, ovf)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">// // parameters // parameter z_width = 16; parameter d_width = z_width /2; // // inputs &amp; outputs // input clk; // system clock input ena; // clock enable input [z_width -1:0] z; // divident input [d_width -1:0] d; // divisor output [d_width -1:0] q; // quotient output [d_width -1:0] s; // remainder output div0; output ovf; reg [d_width-1:0] q; reg [d_width-1:0] s; reg div0; reg ovf; // // functions // function [z_width:0] gen_s; input [z_width:0] si; input [z_width:0] di; begin if(si[z_width]) gen_s = {si[z_width-1:0], 1'b0} + di; else gen_s = {si[z_width-1:0], 1'b0} - di; end endfunction function [d_width-1:0] gen_q; input [d_width-1:0] qi; input [z_width:0] si; begin gen_q = {qi[d_width-2:0], ~si[z_width]}; end endfunction function [d_width-1:0] assign_s; input [z_width:0] si; input [z_width:0] di; reg [z_width:0] tmp; begin if(si[z_width]) tmp = si + di; else tmp = si; assign_s = tmp[z_width-1:z_width-d_width]; end endfunction // // variables // reg [d_width-1:0] q_pipe [d_width-1:0]; reg [z_width:0] s_pipe [d_width:0]; reg [z_width:0] d_pipe [d_width:0]; reg [d_width:0] div0_pipe, ovf_pipe; // // perform parameter checks // // synopsys translate_off initial begin if(d_width !== z_width / 2) $display("div.v parameter error (d_width != z_width/2)."); end // synopsys translate_on integer n0, n1, n2, n3; // generate divisor (d) pipe always @(d) d_pipe[0] &lt;= {1'b0, d, {(z_width-d_width){1'b0}} }; always @(posedge clk) if(ena) for(n0=1; n0 &lt;= d_width; n0=n0+1) d_pipe[n0] &lt;= d_pipe[n0-1]; // generate internal remainder pipe always @(z) s_pipe[0] &lt;= z; always @(posedge clk) if(ena) for(n1=1; n1 &lt;= d_width; n1=n1+1) s_pipe[n1] &lt;= gen_s(s_pipe[n1-1], d_pipe[n1-1]); // generate quotient pipe always @(posedge clk) q_pipe[0] &lt;= 0; always @(posedge clk) if(ena) for(n2=1; n2 &lt; d_width; n2=n2+1) q_pipe[n2] &lt;= gen_q(q_pipe[n2-1], s_pipe[n2]); // flags (divide_by_zero, overflow) always @(z or d) begin ovf_pipe[0] &lt;= !(z[z_width-1:d_width] &lt; d); div0_pipe[0] &lt;= ~|d; end always @(posedge clk) if(ena) for(n3=1; n3 &lt;= d_width; n3=n3+1) begin ovf_pipe[n3] &lt;= ovf_pipe[n3-1]; div0_pipe[n3] &lt;= div0_pipe[n3-1]; end // assign outputs always @(posedge clk) if(ena) ovf &lt;= ovf_pipe[d_width]; always @(posedge clk) if(ena) div0 &lt;= div0_pipe[d_width]; always @(posedge clk) if(ena) q &lt;= gen_q(q_pipe[d_width-1], s_pipe[d_width]); always @(posedge clk) if(ena) s &lt;= assign_s(s_pipe[d_width], d_pipe[d_width]); endmodule</span></span></code> </pre> </div></div><br><br><h1>  Go to testing </h1><br>  I apologize in advance for the screen copies: <br><img src="https://habrastorage.org/getpro/habr/post_images/50d/9e0/e56/50d9e0e560ab333032eeb5509e4199a3.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e2/3e0/53d/8e23e053d3c68d01b7efb555e63b728b.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f1a/a9a/e96/f1aa9ae960f4d818d65a4a36e9b686f8.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f15/a3a/e98/f15a3ae98664ef1601a436ef3276d5d1.jpg"><br><br>  Next - programming.  The compilation and execution speed brings nostalgia ... <br><img src="https://habrastorage.org/getpro/habr/post_images/ba9/69f/65f/ba969f65fdf4cde4f2d0fd110f2ad952.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/130/d17/f90/130d17f907b2d4801541f8e2398a8fea.jpg"><br><br><h1>  Conclusion </h1>  I hope the article made you believe in the power of the FPGA and continue learning Verilog. <br>  And someone may now have a dream to make their PC-shku with blackjack :-) <br><br>  Questions / comments? </div><p>Source: <a href="https://habr.com/ru/post/146160/">https://habr.com/ru/post/146160/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146153/index.html">CX-01 - another mini PC</a></li>
<li><a href="../146155/index.html">The Flame virus was created by US and Israeli experts to sabotage the Iranian nuclear program.</a></li>
<li><a href="../146157/index.html">Fast creation of 3D images from ordinary photos - technology from Japan</a></li>
<li><a href="../146158/index.html">Dribbble Meetup ‚Ññ1 in Moscow</a></li>
<li><a href="../146159/index.html">Can the Microsoft Surface Tablet change mobile devices?</a></li>
<li><a href="../146164/index.html">How to read the signal from the analog inputs of Teensy ++ and display them on the screen</a></li>
<li><a href="../146165/index.html">Examination of higher education web pages</a></li>
<li><a href="../146166/index.html">Parallels patches the Linux kernel. Habrainterview with Stas Protasov</a></li>
<li><a href="../146167/index.html">Translation from any number system to any numbers of great length</a></li>
<li><a href="../146168/index.html">How to assemble a mini-PC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>