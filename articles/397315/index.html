<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic staircase lighting</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, dear readers, I would like to acquaint you with my version of the project of automatic illumination of the stairs based on the Arduino...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic staircase lighting</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, dear readers, I would like to acquaint you with my version of the project of automatic illumination of the stairs based on the Arduino Pro Mini controller.  Perhaps for someone this article will become the basis for their own projects, well, I will be pleased to read the strict criticism in the comments. <br><a name="habracut"></a><br>  <b>The purpose of the project: to</b> mount the staircase lighting on the second floor under the following conditions. <br><ol><li>  Automation works only in the dark. </li><li>  Each stair step is highlighted after turning on the previous one. </li><li>  Steps are highlighted from bottom to top and vice versa. </li><li>  There is a reserve of time completely illuminated stairs. </li></ol><br><h1>  <font color="blue">Preparation for installation</font> </h1><br>  As a controller, I used the familiar Arduino Pro Mini. <br><br>  First, about the stairs itself, the number of steps 11, width 550 mm.  A total of 6 meters of LED strip is required (ordered 2 pieces of 5 meters 5050 SMD), with an IP67 degree of protection (i.e., protection against dust and water) so that you can wipe off the dust and not worry about whether you are under stress or damage the tape. <br><br>  After connecting a 5 m LED strip, the current through it turned out to be only 2.5 A, that is, for a 6 m LED strip, a 36 W power supply unit is needed.  The choice stopped on the Chinese power supply 12 V 8.3 A 100 watts.  100, of course, a lot, but it took 12 V for another project, so I connected to it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a power supply of the controller itself, as well as sensors (5 V power supply), I used a simple low voltage circuit with the help of a voltage regulator L7805CV and two ceramic capacitors 0.1 ŒºF and 0.33 ŒºF. <br><br><img src="https://habrastorage.org/files/2b4/ff5/837/2b4ff58374214e32ac08154cf9899039.png" alt="image"><br><br>  As sensors detecting movement, he stopped on the HC-SR04 ultrasonic sensors, since they emit a narrow beam of ultrasonic pulses and you can adjust the operating distance.  Thus, it can be set to track the intersection of the pulse in the first and last stages.  Going into the details of the characteristics, method of connection, the principle of the sensor does not see the point in the Internet a lot of information about them. <br><br>  The question of measuring the illumination was solved, also, quite simply with the help of a voltage divider circuit, in which the Gl5516 photoresistor is used as a variable resistor. <br><br>  Next, we consider the question of the number of contacts used 11 digital for the stages, 4 for two sensors and one analog for measuring illumination.  A total of 15 digital, which does not give us the Arduino.  Without thinking, I used a 74S595N microcircuit, or rather a cascade of two shift registers to increase the number of Arduino digital outputs. <br><br>  After reading the literature and opinions of radio amateurs, he put a 0.1 ŒºF ceramic capacitor on the 12th leg of the STcp of the first register, ostensibly to minimize noise when applying a ‚Äúlatching‚Äù pulse.  When testing the cascade ‚Äúon the table‚Äù by me, it really works better with a capacitor, especially when the power supply to the chips is first applied. <br><br>  It‚Äôs one thing to connect a weak load to the Arduino, like an LED, and another to connect a piece of LED strip 500-550 mm long (the maximum current for the Arduino digital output is 40 mA).  The ULN2003A microcircuit (Darlington assembly) turned out to be more accessible to me; the maximum current through one output of which is 0.5 A. <br><br><img src="https://habrastorage.org/files/c98/0c7/53b/c980c753bd1a47818cd0b99c1a2a66e2.png" alt="image"><br><br>  I want to note that the Echo contact of the second sensor comes to the 13th Arduino contact, on which the LED of the controller itself is located. <br><br>  This was done specifically, for convenience, at the moment when the condition ‚Äúis it dark enough for the start of sensor polling?‚Äù Is satisfied, the LED on the 13th contact starts flashing. <br><br>  Plata painted in Sprint-Layout.  He emphasized that the chips and the controller were removed, soldered the SCS-14 and 16 panels, and also the socket on the PBS 2 √ó 12 2.54 board.  The only negative was to arch the legs of the 74S595N chips to the other side. <br><br><img src="https://habrastorage.org/files/082/fa6/ccc/082fa6ccc1b54e7bb1f736ff34d28d1e.png" alt="image"><br><br><h1>  <font color="blue">Drawing a sketch</font> </h1><br>  When compiling the sketch, only one Ultrasonic library was used (for working with the HC-SR04 sensors) and it was possible to do without it.  I had to tinker with bit operations, since it was necessary to load two bytes in a cascade of shift registers in a certain way (in the sketch itself I made intelligible explanations). <br><br><div class="spoiler">  <b class="spoiler_title">Sketch</b> <div class="spoiler_text"><code>// ***   V1*** <br> //  <br> #include "Ultrasonic.h" <br> <br> //  <br> #define Trig_1 10 //     . <br> #define Echo_1 11 <br> #define Trig_2 12 //     . <br> #define Echo_2 13 <br> #define Ds 8 // Ds/SDI    75HC595N_1. <br> #define STcp 7 // STcp/RCLK   75HC595_1, 2. <br> #define SHcp 6 // SHcp/SRCLK   75HC595_1, 2. <br> #define LDR A0 //    . <br> <br> Ultrasonic Sensor_1(Trig_1, Echo_1); //   . <br> Ultrasonic Sensor_2(Trig_2, Echo_2); //   . <br> <br> //  <br> const int Limit = 100; //       . <br> const float Min_Disrance = 50.0; /* ,     <br>   55 .*/ <br> <br> boolean Up_Sensor_Started = false; //      . <br> boolean Down_Sensor_Started = false; //      . <br> <br> const int Read_Delay = 50; //       . <br> <br> unsigned int leds = 0; //       . <br> const int N = 10; /*      . <br>    !   14- 2  .*/ <br> const int T_Ladder = 3000; //      . <br> const int T_Stair = 500; //      . <br> <br> void setup() <br> { <br> pinMode(Ds, OUTPUT); <br> pinMode(STcp, OUTPUT); <br> pinMode(SHcp, OUTPUT); <br> // Serial.begin(9600); //      9600 . <br> } <br> <br> void loop() <br> { <br> int LDR_Value = analogRead(LDR); //    . <br> // Serial.println(LDR_Value); //       0  1023. <br> if(LDR_Value &lt; Limit) //  "    ?". <br> { <br> Down_Sensor(); //     . <br> if(Down_Sensor_Started) //     . <br> //  ,  ... <br> { <br> Down_Sensor_Started = false; //      . <br> Up_Sensor_Started = false; <br> Turing_Upward(); //      . <br> } <br> else <br> //      ... <br> { <br> Up_Sensor(); //     ... <br> if(Up_Sensor_Started) //     . <br> //  ,  ... <br> { <br> Down_Sensor_Started = false; //      . <br> Up_Sensor_Started = false; <br> Turing_Downward(); //      . <br> } <br> } <br> delay(Read_Delay); //   . <br> } <br> } <br> <br> //     <br> void Up_Sensor() <br> { <br> if((Sensor_1.Ranging(CM) &lt; Min_Disrance) &amp;&amp; (Sensor_1.Ranging(CM) &gt; 0)) <br> //     ,    ... <br> { <br> Up_Sensor_Started = true; //    . <br> } <br> } <br> <br> //     <br> void Down_Sensor() <br> { <br> if((Sensor_2.Ranging(CM) &lt; Min_Disrance) &amp;&amp; (Sensor_2.Ranging(CM) &gt; 0)) <br> //     ,    ... <br> { <br> Down_Sensor_Started = true; //    . <br> } <br> } <br> <br> //      <br> void updateShiftRegister() <br> { <br> digitalWrite(STcp, LOW); //        . <br> byte First = lowByte(leds); /*       , <br>    shiftOut     8 .*/ <br> byte Second = highByte(leds); <br> shiftOut(Ds, SHcp, MSBFIRST, Second); //  1-      . <br> shiftOut(Ds, SHcp, MSBFIRST, First); //  2- . <br> digitalWrite(STcp, HIGH); //     . <br> } <br> <br> //      <br> void Turing_Upward() <br> { <br> for (int i = 0; i &lt;= N; i++) <br> { <br> bitSet(leds, i); //   N    1 ( HIGH). <br> updateShiftRegister(); //     . <br> delay(T_Stair); //    . <br> } <br> // Serial.println(leds, BIN); //    . <br> delay(T_Ladder); //   . <br> leds = 0; //  . <br> updateShiftRegister(); //  . <br> } <br> <br> //      <br> void Turing_Downward() <br> { <br> for (int i = N; i &gt;= 0; i--) <br> { <br> bitSet(leds, i); //   N    1 ( HIGH). <br> updateShiftRegister(); //     . <br> delay(T_Stair); //    . <br> } <br> delay(T_Ladder); //   . <br> leds = 0; //  . <br> updateShiftRegister(); //  . <br> } <br></code> <br></div></div><br><h1>  <font color="blue">Installation Features</font> </h1><br>  Now about the installation, to lay the LED strip, of course, it is better to create a profile specially for her, but its cost is quite high.  I took the cable channel 12 √ó 12, cut off the excess stationery with a red-hot stationery knife, the following happened. <br><br><img src="https://habrastorage.org/files/a79/534/4db/a795344db3a3418287447d13b7bafe2f.jpg" alt="image"><br><br>  To hide the sensors HC-SR04, I found for them the size of the box IEK 20 mm. <br><br><img src="https://habrastorage.org/files/9f4/1c8/c1e/9f41c8c1e54b4cf8890c1c499c01b634.jpg" alt="image"><br><br>  The installation of the panel was also not difficult, since the installation of screw terminal blocks was planned in advance on the board. <br><br><img src="https://habrastorage.org/files/63e/49d/0e4/63e49d0e4c6040b5bf7daa76a1606f39.jpg" alt="image"><br><br><h1>  <font color="blue">Total</font> </h1><br>  The resulting project has satisfied all the tasks, during the operation of the automation there were no failures, comments. <br><br>  The only thing, in my opinion, could be to make the shield more compact and completely close it from other hands. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/MdvFz4zxJVg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h1>  <font color="blue">Equipment</font> </h1><br><table><tbody><tr><td>  Arduino Pro Mini Atmega 328 5 V 16 MHz Controller </td><td>  one </td></tr><tr><td>  Ultrasonic sensor HC-SR04 </td><td>  2 </td></tr><tr><td>  Power supply 12 V 8.3 A 100 W </td><td>  one </td></tr><tr><td>  LED strip 5050 SMD 5 m IP65 </td><td>  2 </td></tr><tr><td>  Chip 74NS595N </td><td>  2 </td></tr><tr><td>  IC ULN2003A </td><td>  2 </td></tr><tr><td>  PBS 1 √ó 40 2.54 socket </td><td>  one </td></tr><tr><td>  MGSHV 0.75 wire </td><td></td></tr><tr><td>  PUNP cable 2 √ó 2.5 </td><td></td></tr><tr><td>  Cable telephone ShTLP-4 0.12 √ó 7 </td><td></td></tr><tr><td>  Single pole 1 A circuit breaker </td><td>  one </td></tr><tr><td>  Single-pole circuit breaker 10 A </td><td>  one </td></tr><tr><td>  Photoresistor Gl5516 </td><td>  one </td></tr><tr><td>  Voltage stabilizer L7805CV </td><td>  one </td></tr><tr><td>  0.33 uF ceramic capacitor </td><td>  one </td></tr><tr><td>  Ceramic condenser 0.1 microfarad </td><td>  2 </td></tr><tr><td>  10 kŒ© resistor </td><td>  one </td></tr><tr><td>  Socket for chip SCS-14 </td><td>  2 </td></tr><tr><td>  SCS-16 chip socket </td><td>  2 </td></tr><tr><td>  Distribution box IEK 20 mm </td><td>  2 </td></tr><tr><td>  Two-pin screw terminal </td><td>  13 </td></tr><tr><td>  Fiberglass 95 √ó 105 mm </td><td></td></tr><tr><td>  Textolite </td><td></td></tr><tr><td>  SRK terminal through passage </td><td>  12 </td></tr><tr><td>  Cable channel 12 √ó 12 √ó 2000 </td><td></td></tr><tr><td>  Cable channel 16 √ó 16 √ó 2000 </td><td></td></tr><tr><td>  Consumables (glue, glue Moment Crystal, solder, rosin, TAGS flux) </td><td></td></tr><tr><td>  Fasteners (bolts, nuts, screws, dowels, clamps) </td><td></td></tr></tbody></table><br>  Thanks for paying attention. </div><p>Source: <a href="https://habr.com/ru/post/397315/">https://habr.com/ru/post/397315/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../397305/index.html">As a Japanese farmer using deep learning and TensorFlow cucumbers sorted</a></li>
<li><a href="../397307/index.html">Lecture "Subtle complexities of space technology"</a></li>
<li><a href="../397309/index.html">Direct3D vs OpenGL: history of opposition</a></li>
<li><a href="../397311/index.html">The existence of cryovolcanoes in Ceres is confirmed</a></li>
<li><a href="../397313/index.html">Just add water. Small additive H‚ÇÇO increases the power of the engine and saves fuel</a></li>
<li><a href="../397317/index.html">Factory Refurbished: we buy electronics cheaply, and with a guarantee</a></li>
<li><a href="../397319/index.html">IoT Link: LoRa vs. UNB. Part 2: Business</a></li>
<li><a href="../397321/index.html">Sony Xperia XZ and Xperia X Compact officially presented</a></li>
<li><a href="../397327/index.html">WaveNet: computer-synthesized human-like speech</a></li>
<li><a href="../397329/index.html">Why skin in water shrinks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>