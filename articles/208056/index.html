<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Authentication in Rails applications using Devise. Part 1: Basic Setup</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I bring to your attention one of the best, in my opinion, gems for authentication in rails-applications. Unfortunately, there is very little Russian-l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Authentication in Rails applications using Devise. Part 1: Basic Setup</h1><div class="post__text post__text-html js-mediator-article">  I bring to your attention one of the best, in my opinion, gems for authentication in rails-applications.  Unfortunately, there is very little Russian-language information on this gem, including on the habr, so I want to highlight this topic.  The article, first of all, is designed for beginners and is a detailed tutorial on setting up authentication based on the mentioned heme.  In the first part, I will highlight the basic setup steps.  Further more about gem. <br><br>  <b>Devise</b> is a ruby ‚Äã‚Äãgem that provides authentication capabilities in rails applications.  Devise works in conjunction with the Warden gem, which in turn provides the mechanism for authentication in rack-based ruby ‚Äã‚Äãapplications.  The main features of Devise are described below: <br><ul><li>  based on Rack; </li><li>  is a complete Rails based MVC solution; </li><li>  Allows logging in on several models simultaneously; </li><li>  based on modularity: uses only what you really need. </li></ul><br>  So let's proceed to installing and configuring Devise for your rails application.  Further process for readability will be divided into separate steps. <br><a name="habracut"></a><br>  <i>Note</i> : I did all the installation and configuration for rails version 4.0.1. <br><br>  <b>Step 1.</b> Add a gem to the gemfile <br><pre><code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'devise'</span></span></code> </pre> <br>  Or with the indication of the exact version (the next version works stably with rails 4.0.1) <br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'devise'</span></span>, <span class="hljs-string"><span class="hljs-string">'3.2.2'</span></span></code> </pre><br>  Run the bundle to install new gems <br><pre> <code class="bash hljs">bundle install</code> </pre><br>  The following gems will be additionally installed as dependencies: <br>  <b>warden</b> - middleware software that provides authentication for Rack applications; <br>  <b>orm_adapter</b> - provides a single point of entry for using the basic functions of Ruby ORMs; <br>  <b>bcrypt-ruby</b> - provides a simple password wrapper.  It is based on the cryptographic hash function bcrypt (); <br>  <b>thread_safe</b> ‚Äî Provides thread-safe collections and utilities for Ruby <br>  <b>railties</b> are internal components of Rails, such as application loaders, plugins, generators, and rake tasks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Step 2.</b> So, the heme was downloaded, but still does not interact with our application.  Devise has in its arsenal convenient generators, one of which we now use.  Perform a Devise installation by running the following generator: <br><pre> <code class="bash hljs">rails generate devise:install</code> </pre><br>  This generator will install the initializer, which describes all the configuration settings Devise, necessary for work, as well as a file with the base locale (English).  Also, the installer will offer us a basic setup. <br><br>  <b>Step 3.</b> Make the basic setting of the heme after installation <br>  3.1.  Now we need to set the mailer (mail sender) settings for each of the execution environments.  For the development environment, add the following line to the <i>config / environments / development.rb</i> file: <br><pre> <code class="ruby hljs">config.action_mailer.default_url_options = { <span class="hljs-symbol"><span class="hljs-symbol">:host</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'localhost:3000'</span></span> }</code> </pre><br>  For the production environment it is necessary to replace the key value <i>: host</i> with the current one. <br><br>  3.2.  After the user logs in, confirms the account, or updates the password, Devise will look for a path for subsequent redirection.  By default, it will redirect to <b>user_root_path</b> , if it exists.  Otherwise, Devise will redirect to <b>root_path</b> .  Therefore, this path must be defined in the application.  Check your <i>config / routes.rb</i> routes <i>file</i> for a line like this: <br><pre> <code class="ruby hljs">root <span class="hljs-string"><span class="hljs-string">'home#index'</span></span></code> </pre><br>  I think you will agree with me that it is not very logical to redirect the user to the main page of the application after entering.  In this regard, let's set up redirection after successfully logging in to the user profile page.  To do this, add the following route in the <i>config / routes.rb</i> : <br><pre> <code class="ruby hljs">get <span class="hljs-string"><span class="hljs-string">'persons/profile'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">as:</span></span> <span class="hljs-string"><span class="hljs-string">'user_root'</span></span></code> </pre><br>  <i>Note</i> : <br>  1) You must first create a controller and action.  This can be done through the console using a convenient generator: <br><pre> <code class="bash hljs">rails generate controller persons profile</code> </pre><br>  2) As a result, the generator will create a <i>persons_controller</i> controller with one method (action) <i>profile</i> , as well as a view for this action. <br>  The list of routes can be obtained through the console.  Just enter the command: <br><pre> <code class="bash hljs">bundle <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> rake routes</code> </pre><br>  In our case, the next router should be available. <br><pre> <code class="bash hljs">user_root GET /persons/profile(.:format) persons<span class="hljs-comment"><span class="hljs-comment">#profile</span></span></code> </pre><br>  for which the user_root_path <b>helper</b> will be available <br><br>  There is also another way by which you can define your own redirections both after entering and after exiting.  To do this, you must override the existing devise-methods <b>after_sign_in_path_for</b> and <b>after_sign_out_path_for</b> in <i>ApplicationController</i> ( <i>app / controllers / application_controller.rb</i> ).  Personally, I liked this redirection option more: <br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">after_sign_in_path_for</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(resource)</span></span></span></span> current_user_path <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  After logging in, the user will be redirected to the page described by the <b>current_user_path</b> helper <br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">after_sign_out_path_for</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(resource_or_scope)</span></span></span></span> request.referrer <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  After logging out, the user will remain on the same page. <br><br>  3.3.  It is necessary to add notifications and warnings to the template. <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"notice"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">notice</span></span></span><span class="hljs-tag"> %&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alert"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alert</span></span></span><span class="hljs-tag"> %&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  3.4.  If you are deploying an application on <i>Heroku</i> using Rails version 3.2, then you need to add the following line in <i>config / application.rb</i> <br><pre> <code class="ruby hljs">config.assets.initialize_on_precompile = <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre><br>  3.5.  We can customize view files to fit our needs.  To do this, you need to copy them from gem to your application by running the following command: <br><pre> <code class="bash hljs">rails generate devise:views</code> </pre><br>  In the <i>app / views / devise directory</i> you will find all the <i>view</i> files used by the <i>gem</i> .  You can customize them as you wish, to the overall style of your application. <br><br>  <b>Step 4.</b> Now it's time to create a user model that will perform the authentication.  We will generate a user model, so let's call it <i>User</i> .  The model may also be called <i>admin</i> : <br><pre> <code class="bash hljs">rails generate devise User</code> </pre><br>  This generator will create a new model if it did not exist before and configure it with the default modules used.  Most likely, you will receive the following code in <i>app / models / user.rb</i> (the code is somewhat formatted): <br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> &lt; ActiveRecord::Base </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># Include default devise modules. Others available are: # :confirmable, :lockable, :timeoutable and :omniauthable devise :database_authenticatable, :registerable, :recoverable, :rememberable, :trackable, :validatable end</span></span></span></span></code> </pre><br>  Devise has in its arsenal 10 modules.  By default, you will have 6 modules connected.  You can edit this list.  The description of all available modules is given below: <br><br>  1. <b>Database Authenticatable</b> : provides the ability to log on to the system based on the password encrypted and stored in the database.  Login can be done by sending a POST request or using HTTP Basic Authentication. <br>  2. <b>Omniauthable</b> : adds support for Omniauth ( <a href="https://github.com/intridea/omniauth">https://github.com/intridea/omniauth</a> ). <br>  3. <b>Confirmable</b> : allows you to send an email with instructions to verify the account created during registration. <br>  4. <b>Recoverable</b> : allows you to recover your forgotten password.  Sends recovery instructions to email. <br>  5. <b>Registerable</b> : manages the registration of users, allows you to edit and delete accounts. <br>  6. <b>Rememberable</b> : allows you to remember users based on cookies.  Manages the creation and deletion of tokens. <br>  7. <b>Trackable</b> : keeps statistics of the number of entries, takes into account time and IT-addresses. <br>  8. <b>Timeoutable</b> : responsible for the duration of the user activity session in the system; <br>  9. <b>Validatable</b> : provides validation tools for e-mail and password.  The module can be easily configured, you can define your own validators. <br>  10. <b>Lockable</b> : locks the account after the number of failed authorization attempts specified in the settings.  Account can be unlocked via email or after a certain period of time. <br><br>  Also, the command that we executed above will create a database migration file and a route.  The migration file looks like this: <br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeviseCreateUsers</span></span></span><span class="hljs-class"> &lt; ActiveRecord::Migration </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">change</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">create_table</span></span></span><span class="hljs-class">(:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">users</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> |</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">| </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">## Database authenticatable t.string :email, :null =&gt; false, :default =&gt; '' t.string :encrypted_password, :null =&gt; false, :default =&gt; '' ## Recoverable t.string :reset_password_token t.datetime :reset_password_sent_at ## Rememberable t.datetime :remember_created_at ## Trackable t.integer :sign_in_count, :default =&gt; 0, :null =&gt; false t.datetime :current_sign_in_at t.datetime :last_sign_in_at t.string :current_sign_in_ip t.string :last_sign_in_ip ## Confirmable # t.string :confirmation_token # t.datetime :confirmed_at # t.datetime :confirmation_sent_at # t.string :unconfirmed_email # Only if using reconfirmable ## Lockable # t.integer :failed_attempts, :default =&gt; 0, :null =&gt; false # Only if lock strategy is :failed_attempts # t.string :unlock_token # Only if unlock strategy is :email or :both # t.datetime :locked_at t.timestamps end add_index :users, :email, :unique =&gt; true add_index :users, :reset_password_token, :unique =&gt; true # add_index :users, :confirmation_token, :unique =&gt; true # add_index :users, :unlock_token, :unique =&gt; true end end</span></span></span></span></code> </pre><br>  Here we see that a user table is being created (3rd line of code).  Since we called our model <i>User</i> , the table has the same name, but in the plural (according to the <i>ActiveRecord</i> naming convention).  The following describes the fields that will be added to the table during creation.  As we see from the code, only 6 Devise modules for work may require fields in the table. <br><br>  If you do not use any of the modules, do not forget to comment out the corresponding fields in the migration.  And, on the contrary, when you make some of the modules active, then also do not forget to uncomment the corresponding lines. <br><br>  The following route will be created in the <i>config / routes.rb file</i> : <br><pre> <code class="ruby hljs">devise_for <span class="hljs-symbol"><span class="hljs-symbol">:users</span></span></code> </pre><br>  Let me remind you that the list of existing routes can be viewed by command: <br><pre> <code class="bash hljs">bundle <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> rake routes</code> </pre><br><br>  <b>Step 5.</b> So, we figured out the modules, we connected them, we looked at the migration file.  Now you need to perform a migration that will create a user table with the required set of fields.  Run the following command: <br><pre> <code class="bash hljs">bundle <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> rake db:migrate</code> </pre><br><br>  <b>Step 6.</b> Next, be sure to restart the application for all changes to take effect.  If this is not done, then you can encounter various kinds of errors. <br>  Since my application is running on the <i>Unicorn</i> server, I restart it.  If you are testing your application under the <i>Webrick</i> server, then it is enough to stop it using the <i>CTRL + C</i> key combination and then restart it: <br><pre> <code class="bash hljs">rails server</code> </pre><br><br>  <b>Step 7.</b> Our module and our application are ready to work.  The next step is to add links to the template to enter and register.  This can be done as follows: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">user_signed_in</span></span></span><span class="hljs-tag">? %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>, <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">current_user.email</span></span></span><span class="hljs-tag"> %&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">link_to</span></span></span><span class="hljs-tag"> '', </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">destroy_user_session_path</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:method</span></span></span><span class="hljs-tag"> =&gt;</span></span> :delete %&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">else</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">link_to</span></span></span><span class="hljs-tag"> '', </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">new_user_session_path</span></span></span><span class="hljs-tag"> %&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">link_to</span></span></span><span class="hljs-tag"> '', </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">new_user_registration_path</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">end</span></span></span><span class="hljs-tag"> %&gt;</span></span></code> </pre><br>  If the user entered the site, then write him ‚ÄúHello, [user mail]‚Äù and next place the link to exit.  If the user has not yet logged into the site, then we have two ‚ÄúLogin‚Äù and ‚ÄúRegister‚Äù links nearby.  We use existing helpers as reference paths.  Let me remind you that the routes were established in the fourth step and they can see the list by the following command.  The helper consists of a prefix (the leftmost column + '_path') <br><pre> <code class="bash hljs">bundle <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> rake routes</code> </pre><br><br>  <b>Step 8. It's</b> time to start using Devise for its intended purpose - to restrict access to an unauthorized user to certain sections of the site.  Suppose we want to allow only an authorized user to execute an order.  To do this, we must add a filter to the appropriate controller: <br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OrdersController</span></span></span><span class="hljs-class"> &lt; ApplicationController </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">before_filter</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">authenticate_user!</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">except</span></span></span><span class="hljs-class"> =&gt; [:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">show</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">index</span></span></span><span class="hljs-class">] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">index</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># do something end def show # do something end def create # do something end end</span></span></span></span></code> </pre><br>  Here, in the code, the second parameter to the <b>before_filter</b> method is <b>that</b> we pass a list of controller methods that should not be filtered.  Thus, authorization is needed only to fulfill the order (access to the work of the <i>order</i> method).  If it is necessary to filter all controller methods, then the second parameter is not required.  Just write: <br><pre> <code class="ruby hljs">before_filter <span class="hljs-symbol"><span class="hljs-symbol">:authenticate_user!</span></span></code> </pre><br><br><h5>  List of useful helper methods </h5><br>  Devise contains useful helpers that can be used inside controllers and views.  Some of them cite below. <br>  <i>You can verify that a user is logged in with the following helper:</i> <br><pre> <code class="ruby hljs">user_signed_in?</code> </pre><br>  <i>With the help of the following helper, we will get the object of the user currently authorized on the site</i> <br><pre> <code class="ruby hljs">current_user</code> </pre><br>  <i>You can display the user's email as follows.</i> <br><pre> <code class="ruby hljs">current_user.email</code> </pre><br>  <i>Access to the current session can be obtained as follows:</i> <br><pre> <code class="ruby hljs">user_session</code> </pre><br><br>  At this end, the first part, and in the next part I plan to write about other equally important and no less interesting settings of this wonderful gem for authentication. <br><br><h6>  Bibliography: </h6><br>  The main source of material used was official gem documentation - <a href="https://github.com/plataformatec/devise">github.com/plataformatec/devise</a> , supplemented with its own customization experience. </div><p>Source: <a href="https://habr.com/ru/post/208056/">https://habr.com/ru/post/208056/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208042/index.html">3d printers. Review of achievements for 2013</a></li>
<li><a href="../208044/index.html">Computer game "Noosphere" - suggestions for the scenario for the first levels</a></li>
<li><a href="../208048/index.html">Imperceptible difficulties of rocket technology</a></li>
<li><a href="../208050/index.html">COOLRF: recent history. Part one</a></li>
<li><a href="../208052/index.html">We collect the Shark under iOS and OSX</a></li>
<li><a href="../208058/index.html">Video surveillance on the Raspberry Pi</a></li>
<li><a href="../208060/index.html">The true causes of blocking sites. Open Data Survey</a></li>
<li><a href="../208066/index.html">Another Enums implementation for Python</a></li>
<li><a href="../208068/index.html">The device is minimalistic landing pages</a></li>
<li><a href="../208070/index.html">A brief conference guide for game developers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>