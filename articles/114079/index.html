<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I implemented Zimbra</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all! 

 After returning to the previous place of work, it became necessary to rake out the own shoals of 2 years old multiplied (exactly m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I implemented Zimbra</h1><div class="post__text post__text-html js-mediator-article">  Good day to all! <br><br>  After returning to the previous place of work, it became necessary to rake out the own shoals of 2 years old multiplied (exactly multiplied) by the shoals of Razolby-outsourcing LLC (the name of the organization, as you correctly understand, is changed).  One of these jambs was the Exim mail server, from which it was not enough that spam flowed out of the tub, as well as the crookedly configured antispam by the incoming admin of Razdolbay Outsourcing somewhere ‚Äúlost‚Äù the necessary letters, and as a nice bonus in imap` from time to time, the necessary letters were periodically lost.  In general, the best solution was rm -rf /.  That is what I did and implemented Zimbra and now I want to tell how it did it in such a way that it worked (primarily in the logic of the company) becoming the second workflow tool, although earlier the electronic was separate from several people. <br><br>  And so, they drove to fight with spam, sabbathing sloppiness, reluctance to work, the stupidity of users and even a whole bunch! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h5>  1. We put and win spam </h5><br><br>  I will not describe the installation process, there is nothing special about installing the 5th debian, there is no zimbra installation script.  There is a difficulty in the other.  Zimbra is very sensitive to the hostname, so if you have more than one interface - be sure to bring your hosts on the machine where you put it to this form: <br><br> <code># cat /etc/hosts <br> 127.0.0.1 localhost.localdomain localhost <br> aaa.aaa.aaa.aaa zimbra.mydomain.ru zimbra <br> xxx.xxx.xxx.xxx zimbra.mydomain.ru zimbra <br></code> <br>  respectively for gray and white ip.  Of course, you can humanly configure the DNS, but I have to clean up the order with DNS servers of which as many as 3 are a matter of future periods, so let's leave it for now.  Who has similar problems - keep in mind.  But Zimbra is smart, so all that she does not like - you will know about it right away. <br><br>  I won the spam without straining at all, just transferred the mail to the VDS, which the site is spinning on and turned on greylisting.  Let them have wider channels, let the spam take the server on the side.  Fortunately, sendmail is on the VDS, so I did <a href="http://wiki.zimbra.com/wiki/Split_Domain_with_a_Sendmail_Primary">as I wrote in the wiki by</a> preconfiguring it as the <a href="http://wiki.zimbra.com/wiki/Split_Domain">secondary system</a> . <br><br>  In short, I will explain: MX records on the mail.mydomain.ru host, on it sendmail with greylisting.  There we accept mail to user@mydomain.ru type addresses, which are forwarded to user@zimbra.mydomain.ru type addresses.  And the zimbra server, respectively, sends via relay and replaces user@zimbra.mysite.ru to user@mysite.ru at the sending stage.  In general, I don‚Äôt know deeply postfix, so I suspect that there‚Äôs not such tricks you can do. <br><br>  In addition to defeating spam, there is another effective plus - a very serious reduction in the load on the Zimbra server, which is several times less productive than sendmail.  In other words, sendmail + milter greylist doesn‚Äôt even feel like 20,000 spam emails per day, 95% of which will be cut off, and it will already be a kind of unnecessary load to Zimbre, I immediately warn you, it is VERY gluttonous to resources, so it makes sense to think again. <br><br><h5>  2. We organize infrastructure </h5><br><br>  Then the most interesting part of the work went - work with users.  It was very hard for me to explain to managers the new "routing" of mail, how a mail alias differs from mailbox, why I can make it so that a letter that is sent to sales@mydomain.ru comes to all managers and the director of sales.  And why no one can remove it.  I will just give you advice - do not waste time on it.  Do it all.  In any case, it‚Äôs not for them to rake, your task is for them to get the mail, and how it will come to them is not their concern.  Just be guided in the creation of infrastruktruta following principles: <br><br><ul><li>  No shared IMAP mailboxes.  One user - one mailbox.  The rest is aliases. </li><li>  Minimize the installation of mail clients.  The average company employee does not need an email client.  All in a web interface. </li><li>  The signature is a ‚Äúpersonal‚Äù box, on the business card is the department's box (which in turn is an alias). </li><li>  A good idea to do a mail collector on a primary server.  Stupidly and cynically copy all incoming mail (or not all) because sometimes it makes sense, such an infrastructure is more than convenient for this. </li></ul><br><br>  In general, this is quite a chore to create users, you can write scripts and import, you can still somehow, in my case 40 entries at the first stage and stretching for another month I decided not to bother.  But who will implement - keep in mind that there (in zimbra) there is a regular means of import. <br><br><h5>  3. Implement </h5><br><br>  Here I was waiting for the first surprise.  It seemed to me that I wrote a normal instruction in which I registered what to do inside and out.  But in the end, after reading it, there were questions like ‚ÄúThank you, but what should we do?‚Äù.  Fortunately, I quickly realized that this would not work and rewrote it.  Remember: the user needs a shortcut on the desktop.  1 out of 5 only knows what the address bar is and why it is needed, the remaining 4, at best, type zimbra.mynetwork.local into the Yandex address bar.  But the very idea of ‚Äã‚Äãissuing instructions was correct, those who mastered it in the 3rd version did not ask any more questions. <br><br>  I quote a text: <br><br> <code><a href="http://192.168.xxx.yyy/"></a> <a href="http://zimbra.mynetwork.local/"></a> <a href="http://zimbra.mydomain.ru/"></a>     <br> <br>   <br> <br> -     <br>       (   ),      . <br> <br>            : <br> 192.168.xxx.yyy  zimbra.mynetwork.local <br> <br>      <br> <br>     (     )     zimbra.mydomain.ru <br> <br>    /? <br> <br>  ():  <br> <br> : -- *      ,  -  <br> <br>     /    ? <br> <br>        .                   ¬´¬ª ,          . <br>  dir@mydomain.ru ‚Üí .@mydomain.ru. <br>    ‚Äî    ,  ,   . <br> <br>            i.ivanov@mydomain.ru <br>        ,      . <br> <br>  /: .@mydomain.ru //         ! <br> <br>      ?   .  ? <br> <br>          ‚Äî    .          sales@mydomain.ru  ¬´ ¬ª   . <br> <br>    i.ivanov@zimbra.mydomain.ru ?      ? <br> <br>      ,       <br>        . <br> <br>     () ? <br>   !    ‚Äî  . <br> <br></code> <br><br>  In brief, I will explain about the "local mailbox".  In fact, no, it is not local, but I no less brazenly and cynically ruled all third-party SMTP firewall, except sendmail-server.  Although in the DNS `s domain I have MX records on zimbra.mydomain.ru.  Simply, this is the most optimal solution in terms of creating problems for a likely spammer with minimal effort on my part. <br><br>  In general, this can put an end to the post, but I want to separately highlight the following 2 points. <br><br><h5>  4. The human factor </h5><br><br>  All employees were divided into 2 unequal groups - allies and Sabotage.  Those who "do not care", you know that little different from the saboteurs.  It is because of them that something is not working.  Since the introduction of a Web-Based ERP system, which was administratively installed, failed miserably at this enterprise, it became clear that I couldn‚Äôt push anything, it would be the first step to the file.  And I don‚Äôt recommend to everyone else, I‚Äôll stop working as soon as possible. <br><br>  Among the first saboteurs was the head of sales.  He said: ‚ÄúMake me one box at all as it was!‚Äù.  I tried to explain to him about the advantages of the approach proposed by me, but he did not understand me (despite the fact that he has a technical education), then I said: "Let's agree, you will have a walking post, but you will do what I say, if she does not walk, I will do what you say goes?  My concern is that the mail reached your eagles, and then your business is with her and what‚Äôs next. ‚ÄùHe waved his hand, after a week all questions disappeared by themselves.  Moral: do not try to convince the "kettle". <br><br>  The next step was the fight against mashrudernichestvo.  Just do not think that I have something against mail.ru I have, I even have the mailbox I use there, but this is personal mail.  It is very stupid when the manager gives an address like svetik_k0783@mail.ru (any coincidence is a coincidence!) In business correspondence, as well as this is actually personal mail.  In the corporate standard, I am obliged to be able to access the employee‚Äôs mail in case of emergency (for example, he went to the hospital for a couple of months, and in his mailbox is the correspondence going to complete the contract for a couple million rubles).  Actually about the fight, I have a transparent squid, which as is known does not transparently proxies HTTPS, and some employees have google mail.  I closed the https via NAT and did not open the Google subnets, but their authorization is strictly https.  Those who have boxes made noises on Google by themselves, I explained that Google is using secure authentication, which does not work well through a proxy, and I‚Äôm sending you a proxy only through a letter signed by the director, in which you specify a good reason why you need google-mail with a normally functioning local.  And for those who have mail.ru said that mail.ru will also transfer 100% to secure authentication, so if your business correspondence did not open one fine morning, you were warned.  The objections like ‚ÄúAnd I have all the clients in mail.ru‚Äù were very sluggish because I immediately repeated that I didn‚Äôt close it to you, it works while it works, but when it falls off, you were warned long before the hour. <br><br>  Fighting sloppiness was using a cunning trick.  What is sloppiness?  In the banal "I forgot to check mail a couple of days."  Why watch the mail storekeeper, for example?  This will be discussed further.  As in any enterprise, there is a file server on which "from the years" the place ended.  I cut all the ‚Äúprivate‚Äù folders, leaving only the department folders and made a large file storage facility, but warned you don‚Äôt add confidential documents here, everyone has access here.  And I showed how to send files in Zimbra and taught that you sent the file to Vasya, so call him and say, ‚ÄúVasya, I threw the file to Zimbra, check your mail!‚Äù In time, you will have to call less often.  People liked it because as an alternative to private file transfer there was only a self-written messenger that the outsourcing company implemented, this messenger used a direct computer-to-computer connection and it was possible to transfer only if the person is in the workplace.  Therefore, I suggested that here you can send and not worry, it will come in any case. <br><br>  As a result, after a month the flight returned to normal completely, people really began to use it.  The global address book has become a very weighty argument ‚Äúfor‚Äù, the simple and friendly interface of Zimbra was no less helpful, but from the point of view of employees who go on business trips, this generally became the solution to the whole problem. <br><br>  And lastly ... <br><br><h5>  5. Well, where is the flash drive ... </h5><br><br>  Before the crisis, there was such a character who, even during the first coming, made me hack a flash drive.  His name is "information security specialist."  And I liked this topic because the number of viruses has become an order of magnitude smaller and I don‚Äôt have a special desire to open them back.  And in zimbre, you can upload documents to the portfolio.  Therefore, I told all my friends that we need flash drives - you will not get them.  There is a briefcase in Zimbre, you have uploaded the document and work with it at home if you really need it.  The question as in the case of the mail.ru has disappeared by itself, and I am in the black, I see what is happening in my household, who is sharing what with what.  Of course, if you need to transfer a lot of files back and forth, I go to my colleagues for a meeting, but believe me, this is not so and often, and I also have a solution for ubunt for these purposes, but this is possible next time. <br><br>  In conclusion, I would like to say that if you have not yet introduced zimbra, and at the same time you have a need for something like that - do not hesitate to bet.  3 months the flight is normal, even survived one update.  I didn‚Äôt play with it on any virtual machines, everything worked right away in the battle mode, which hints that if you have experience in administering Linux and mail servers, everything will turn out almost immediately.  Yes, even if it becomes a discovery for you that the SMTP and IMAP server is, as in the well-known joke about the history of the Communist Party of the Soviet Union, ‚Äútwo different people in general!‚Äù - no big deal, you will succeed! <br><br>  Update 1: I add, at the <s>request of viewers, to the</s> proposal of habriuser mister_fog, a couple of links on this topic.  I think that it will not be superfluous for those who, like some who have unsubscribed, "now decide to switch to Zimbra." <br>  <a href="http://www.ossportal.ru/technologies/zimbra/blogs">Materials tagged with Zimbra on ossportal.ru</a> <br>  <a href="http://www.pcweek.ru/foss/article/detail.php%3FID%3D128561">Switch to open source software.</a>  <a href="http://www.pcweek.ru/foss/article/detail.php%3FID%3D128561">Replace Exchange in 10 days</a> <br><br>  Update 2: due to the abundance of comments on the topic zimbra.mynetwork.local vs zimbra.mydomain.ru I want to ask you not to invent spherical horses in a vacuum in the form of the fact that this is a problem for users.  I absolutely responsibly declare that there is no problem at all and my users think the same way, otherwise I would have known about it a long time ago.  For the user, it will be just to update the bookmark in the browser.  For me, this is a problem until hands reach fights with DNS.  When my hands reach, I will make zimbra.mydomain.ru rezolvitsya to the "gray" address if the person is inside the LAN.  And in order to make the transition less difficult for those who went to the old addresses, I‚Äôll hang the Web server with 1 page with an automatic redirect to JS, which in 2 minutes will throw the user to the new address, and before that he will read what needs to be updated. moreover I will make the same JS button for adding a new address to the bookmarks. </div><p>Source: <a href="https://habr.com/ru/post/114079/">https://habr.com/ru/post/114079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../114067/index.html">Tip: Using ReSharper with Microsoft CodeContracts</a></li>
<li><a href="../114071/index.html">We create the structure of personal documents of users in the enterprise in Samba</a></li>
<li><a href="../114073/index.html">Clodo Downtime and Strange Support</a></li>
<li><a href="../114075/index.html">New types of files in Google Docs</a></li>
<li><a href="../114078/index.html">Collect data or teach Doctrine to do multiple insert</a></li>
<li><a href="../114080/index.html">Canvas Indicator - Alternative for AjaxLoad.gif</a></li>
<li><a href="../114082/index.html">TOP'i here</a></li>
<li><a href="../114084/index.html">Experience GTD practice on Win / iOS / Android simultaneously</a></li>
<li><a href="../114085/index.html">Google introduced the importer of bookmarks from Delicious</a></li>
<li><a href="../114086/index.html">Ubuntu 10.04.2 released</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>