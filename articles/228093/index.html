<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Beeline TV via Mikrotik in the province</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, building channels IPVPN, VPLAN and much more is possible not only for companies on expensive equipment. Thanks to the functionality of modern l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Beeline TV via Mikrotik in the province</h1><div class="post__text post__text-html js-mediator-article">  Today, building channels IPVPN, VPLAN and much more is possible not only for companies on expensive equipment.  Thanks to the functionality of modern low-cost routers, you can quickly and easily build or move an existing network infrastructure.  And the main thing to do it cheaply, compactly and quickly for both small companies and for their own needs.  Under the cut is a live example of the assembly and testing of the L2 channel between two providers in different cities for Beeline TV. <br><a name="habracut"></a><br>  Interactive television with all the functions of recording, pause and rewind with a huge film library, coupled with a hard disk prefix - this is all that can be difficult to break.  And not all but the more provincial towns there is Beeline TV.  Let's try to build a L2 channel between two providers and test the Beeline TV service with all the subtleties. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/93f/350/3fc/93f3503fc9ee42a19e907e56d5aba3b7.jpg"><br><br>  To solve this problem there is an Internet channel from Beeline.  As well as a stable Internet channel from the provider in another city.  The bandwidth of at least 4 Mbit for viewing SD channels and about 10 Mbit for channels in HD quality.  Immediately, I note if you record channels for several pieces, then the bandwidth should be several times larger.  But this is not a prerequisite.  For a permanent scheme, a prerequisite is the presence of external static ip addresses on both channels. The Cisco 800 series is resting.  Cope with the task of the two cheapest router Mikrotik.  For example RouterBOARD 951-2n.  We will use EoIP functionality - Ethernet over IP in Mikrotik.  The lack of degradation of the service is determined by the absence of high jitter and losses between the two providers, as at the transport level in the home network of Beeline UDP.  In the GRE ip tunnel. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A bit of theory.  On the multicast backbone, the traffic works through PIM - multicasting independent of the protocol, and in the Beeline home network IGMP - multicast multicast protocol is used.  As with other competitors.  Of course, we will not see anything through VLC, since the service itself has protection.  Therefore, a method was chosen to transfer the ethernet infrastructure to the CPE from another provider from which we will connect the prefix.  The type of connection of the terminal provider can be any, since IP is used as a transport. <br><br><h4>  The first microtic is connected and tuned to Beeline. </h4><br>  Configuring the Beeline L2TP session for a microtic is described for example here: <a href="http://routerz.ru/wp-content/uploads/2014/03/%25D0%2598%25D0%25BD%25D1%2581%25D1%2582%25D1%2580%25D1%2583%25D0%25BA%25D1%2586%25D0%25B8%25D1%258F-%25D0%25BF%25D0%25BE-%25D0%25BA%25D0%25BE%25D0%25BD%25D1%2584%25D0%25B8%25D0%25B3%25D1%2583%25D1%2580%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258E-Mikrotik-RouterOS-%25D0%25B4%25D0%25BB%25D1%258F-%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D1%258B-%25D0%25B2-%25D1%2581%25D0%25B5%25D1%2582%25D0%25B8-%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B5%25D1%2580%25D0%25BD%25D0%25B5%25D1%2582-%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25B9%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B0-%25D0%259A%25D0%25BE%25D1%2580%25D0%25B1%25D0%25B8%25D0%25BD%25D0%25B0-%25D0%25A2%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BA%25D0%25BE%25D0%25BC-%25D0%2591%25D0%25B8%25D0%25BB%25D0%25B0%25D0%25B9%25D0%25BD-07.07.2011.pdf">routerz.ru/wp-content/uploads/2014/03/Instruction-configuring-Mikrotik-RouterOS-for- work-innetwork-internet- provider- Corbina-Telecom- Beeline 07.07.2011.pdf</a> <br>  Consider directly EoIP.  The cable from the access switch Beeline is inserted into the first port of Mikrotik ether1-gateway-Beeline. <br><br><pre><code class="bash hljs">[Bee@MikroTik] &gt; interface eoip add name=eoip-tunnel1 remote-address=xxxx disabled=no tunnel-id=0 [Bee@MikroTik] &gt; interface bridge add name=bridge_EoIP disabled=no protocol-mode=none [Bee@MikroTik] &gt; interface bridge port add bridge=bridge_EoIP interface=ether1-gateway-Beeline [Bee@MikroTik] &gt; interface bridge port add interface=eoip-tunnel1 bridge=bridge_EoIP</code> </pre> <br><br><ul><li>  Here, in the first line, the tunnel itself is created, in which the static ip address of the remote router is written: xxxx The tunnel id is also set here, which should be equal to the tunnel id at the other end. </li></ul><ul><li>  In the second line we create a new bridge interface on which we turn off RSTP, otherwise the port on the access switch will be blocked for the loop from Beeline.  I also want to note the new bridge is needed to isolate local_bridge in which by default DHCP distributes addresses to our LAN.  And for the left DHCP beeline also blocks the port on the switch.  Verified </li></ul><ul><li>  In the third and fourth lines we add the ethernet interface into which the cable from the Beeline switch and the EoIP tunnel interface are inserted. </li></ul><br><br><h4>  The second microtic is connected and configured to another provider. </h4><br>  The settings of the Internet channel of the second microtic will be omitted since they can be arbitrary depending on the type of connection.  Here with EoIP everything is the same. <ul><li>  In the first line we create a tunnel in which we write the static ip of the interface of the Beeline session: xxxx </li></ul><ul><li>  In the second line create a new bridge.  Disable RSTP. </li></ul><ul><li>  The third and fourth lines add the EoIP tunnel interface to the bridge and the ethernet interface to which our console is inserted: </li></ul><br><pre> <code class="bash hljs">[ISP@MikroTik] &gt; interface eoip add name=eoip-tunnel1 remote-address=xxxx disabled=no tunnel-id=0 [ISP@MikroTik] &gt; interface bridge add name=bridge_EoIP disabled=no protocol-mode=none [ISP@MikroTik] &gt; interface bridge port add bridge=bridge_EoIP interface=ether1-gateway-ISP [ISP@MikroTik] &gt; interface bridge port add interface=eoip-tunnel1 bridge=bridge_EoIP</code> </pre><br><br>  Summarizing this small test, I note that the degradation of the service is not noticed!  During the first 3-5 seconds when the channel was switched, Unicast flew instantly and after it was signed to the group, the multicast was also successfully loaded.  When watching HD channels, everything was also perfect.  I want to note that EoIP was configured in different cities whose geography was determined by one region. <br><br><blockquote>  Conclusion: in practice, it was possible to realize the work of one of the Internet services through EoIP on microtic. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/228093/">https://habr.com/ru/post/228093/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../228071/index.html">Robotics direction in summer programming school from Yandex and ABBYY</a></li>
<li><a href="../228077/index.html">42 yoctonewton</a></li>
<li><a href="../228079/index.html">Function Pointer - forgotten implementation of the Singleton pattern</a></li>
<li><a href="../228083/index.html">LED controller for aircraft model</a></li>
<li><a href="../228085/index.html">How I screwed the speedometer to the tanks</a></li>
<li><a href="../228095/index.html">Zabbix 2.2: Monitoring the temperature of the Windows processor of the machine</a></li>
<li><a href="../228099/index.html">Inventing a bike or finding a missing ID value in a MySQL table</a></li>
<li><a href="../228101/index.html">Problems and prospects of ensuring the safety of civil aviation</a></li>
<li><a href="../228103/index.html">Web Application Firewall (ModSecurity) in action</a></li>
<li><a href="../228105/index.html">Upshifting for a programmer in Thailand</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>