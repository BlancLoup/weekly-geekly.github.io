<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Laboratory penetration testing "Test lab v.7" eyes hackers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Review article on the results of participation in the free test lab "Test lab v.7" codenamed "Achilles Heel". The article contains information about t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Laboratory penetration testing "Test lab v.7" eyes hackers</h1><div class="post__text post__text-html js-mediator-article">  Review article on the results of participation in the free test lab "Test lab v.7" codenamed "Achilles Heel".  The article contains information about the work on the preparation of the laboratory, partial passage, as well as comments of the winners. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/829/4ae/cf6/8294aecf6216481898ec79567b50f259.png"></div><br><br><h5>  A couple of words about the lab </h5><br>  ‚ÄúTest lab v.7‚Äù is a corporate network of a virtual company ‚ÄúSecureSoft LLC‚Äù based on Windows and Linux.  A virtual company specializes in software development and has some security holes.  The participants are invited, using the found vulnerabilities, to penetrate the network and get access to all the nodes of ‚ÄúSecureSoft LLC‚Äù, each of which contains a secret token (there are only 10). <br><a name="habracut"></a><br><h5>  Chronology of events </h5><br>  The laboratory was launched on 01.05.2015 at 22:00 Moscow time and is available to this day.  At the time of launch, about 1,200 participants from different countries were registered.  For the convenience of communication and problem solving a forum was prepared in Russian and English.  The actions of the participants could be observed on the Cyberattack world map. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first to make a successful attack on all the nodes of the laboratory was Omar Ganiev (Beched).  After 6 days of intense attack, Omar picked up the last token, thus becoming the test lab champion for the third time in a row. <br><blockquote>  In this laboratory, as in the previous ones, I grumbled that I had to beat a lot or guess a lot, but I still made the useful things for myself =).  One of the most non-trivial tasks was the exploitation of vulnerabilities on the terminal server, where it was necessary to conduct DLL-hijacking around the MSE antivirus.  Also, despite the distracting false paths, the task of the forum was highlighted, in which it was necessary to exploit vulnerabilities with the hands, and in which the fuzzing dictionaries by default in Burp Suite were let down.  Other tasks are useful for practicing standard skills and the ability to compare different finds.  Thanks to the organizers for the training ground! <br><br>  <i>Omar Ganiev (Beched), <a href="http://incsecurity.ru/">incsecurity.ru</a></i> </blockquote>  After Omar, after some time, the participants of MERRON, DarkCat and AV1ct0r managed to collect all the tokens.  Despite the fact that the laboratory is considered to have been passed, it does not lose the essence, namely, to give everyone the opportunity to consolidate the skills of practical pentest, as well as get new ones.  Given the complexity of the tasks, we have prepared a partial passage of the laboratory. <br><br><h5>  Write-up </h5><br>  <b>Attention.</b>  The section contains instructions on the passage of the laboratory. <br>  A feature of all the ‚ÄúTest labs‚Äù laboratories is the proximity to the real working conditions of the corporate network and the modeling of vectors and attack scenarios encountered in real life.  This write-up describes the first tasks of the laboratory and the direction for the passage of the following.  Before we complete the tasks, we need to register on the laboratory's website and configure settings in the distribution kit, which we will use to perform the pentest of the virtual network.  It is recommended to use the Kali Linux distribution.  This is a specialized distribution kit created for information security specialists and containing a large number of penetration testing tools.  After passing the registration and connecting via VPN to the laboratory, the following information is available to us: <br><div class="spoiler">  <b class="spoiler_title">Initial information</b> <div class="spoiler_text"><ol><li>  Testing company network: SecureSoft LLC. </li><li>  Server's IP address: 192.168.101.5 </li><li>  Network map <br><img src="https://habrastorage.org/files/61e/569/793/61e569793a0342f68b1820c615c5fd1b.png"></li></ol><br></div></div><br>  In the context of laboratories, penetration testing occurs in GrayBox mode ‚Äî when partial information about the infrastructure under attack is known.  In this case, we have a network map with nodes marked on it and their roles. <br><br>  The first thing you need to do penetration testing is gathering information.  We use the popular port scanning utility - nmap.  After that, we manually check the received information, namely, we check the responses from the connection to the open ports using telnet and look at the generated code of the html pages. <br><div class="spoiler">  <b class="spoiler_title">Collection of information</b> <div class="spoiler_text">  Running the "nmap 192.168.101.5" utility produced the following information: <br><img src="https://habrastorage.org/files/dc8/ed9/6c6/dc8ed96c6173407a956987ca564ed095.png"><br>  Open port 22 provides SSH access.  For now, remember this. <br>  The open 25 port of the mail server says that we can try to perform password matching (BruteForce) at a high enough speed (unlike web-bruteforce), Hydra is well suited for bruteforce-attacks.  Checking the website on port 80 provided us with information on the account login rule used.  In the source code of the web page, you can find the e-mail of one of the company's employees. <br><img src="https://habrastorage.org/files/457/a18/cd2/457a18cd22e74f17a8b7378002fffbe3.png"><br></div></div><div class="spoiler">  <b class="spoiler_title">We use this information to attack</b> <div class="spoiler_text">  After checking the website on port 8100, we see that this is the web interface to the mail server on port 25.  We will use this information later, but for now let's execute the selection of the password for the detected account. <br><br><img src="https://habrastorage.org/files/53d/868/e9b/53d868e9b9ca4abcacb231b922274c58.png"><br><br>  The found login and password provides access to the SecureSoft LLC angela.allard employee‚Äôs mail via the web interface. <br>  Looking through the mail angela.allard, we find a list of employees of the company SecureSoft LLC. <br><br><img src="https://habrastorage.org/files/4c3/3b8/9e0/4c33b89e0b8f4b899e8a647da0904312.png"><br><br>  Now we have at our disposal a large list of company employees, which we will bring to the logic of forming account logins &lt;name&gt;. &lt;Surname&gt;. <br>  The resulting list is fed Hydra and ... And wait a bit.  After some time, we get the password from the pauline.newman account.  For the attack of Bruteforce (selection of passwords) a dictionary was used, consisting of popular passwords of 2014, found through a google request (it took 5 minutes to prepare the dictionary). <br><br><img src="https://habrastorage.org/files/020/9e3/f6a/0209e3f6a6c44b0991dac8ab4ce4a041.png"><br><br>  The post of the second employee provided us with more interesting information.  First, we received the coveted token from the Mail task, and second, we received additional information for the passage of the laboratory. <br><br><img src="https://habrastorage.org/files/514/da8/991/514da89917dd4cba8ef75466a257d58d.png"><br></div></div><div class="spoiler">  <b class="spoiler_title">Implement an additional attack vector</b> <div class="spoiler_text">  As in the real penetration testing, the attacker collects information about the attacked system in any possible and accessible places. <br><br>  The most interesting may be resources for IT / IB staff - there may be extremely critical information that will help access the entire network.  An interesting resource is marked on the provided scheme - Admin Tools.  Using the nmap utility, scan the port range 1‚Äì10,000 of the resource that interests us. <br>  . <br><img src="https://habrastorage.org/files/e32/47d/e09/e3247de090fa4426b576993d0f78cfd9.png"><br><br>  We see that some application is hanging on a non-standard port 3121.  Empirically, we determine that the Admin Tools website is running there. <br><br><img src="https://habrastorage.org/files/df7/e4f/10a/df7e4f10a152452fbdbc229b48ed5702.png"><br><br>  The functionality of this site turned out to be inoperative.  It contained utilities that facilitate the work of the system administrator.  The tool tip to the submission form was found indicating that the SSH key was loaded, suggesting that the file could be located on this server.  After studying the site structure and html-code, nothing useful was found, so it was decided to scan the site directories with the dirb utility. <br><br><img src="https://habrastorage.org/files/432/972/56b/43297256bd6248e5beb04fedadd7b81c.png"><br><br>  A .bash_history file was found.  This file contains the history of commands that were executed in the console, for example, via SSH.  In this file, the name of the SSH private key was found - ssh_key.priv, which was immediately downloaded from the site. <br><br><img src="https://habrastorage.org/files/5f5/061/6c4/5f50616c42904198b08afac3266097ff.png"><br><br>  Now we have data for access to the internal network of the company SecureSoft LLC through port 22 using ssh.  Also, in the ssh_key.priv file you can find the token to the Admin Tools task. <br></div></div>  This is the introductory part of the laboratory, I hope it will help you understand the logic of the tasks and solve the remaining tasks on your own. <br><br><h5>  Cyberattack world map </h5><br><img src="https://habrastorage.org/files/35a/e33/f97/35ae33f9784b4b64b0d427c094382d22.png"><br><br>  Especially for the launch of the 7th laboratory, a global attack map was implemented.  Visualization of the attacks allowed to see the geography of the participants.  According to the data at the time of this writing, specialists from 63 countries and 194 cities took part in the laboratory.  The largest number of participants was from Russia (322 IP), followed by the United States (64 IP) and closes the top three Ukraine (37 IP).  Moscow is in the lead in the rating of unique IP by cities (242 addresses), Kiev is in second place (25 addresses) and Petrozavodsk is in third place (18 addresses). <br><br>  Full list of participating countries: Algeria, Andorra, Armenia, Australia, Austria, Belarus, Belgium, Bosnia and Herzegovina, Brazil, Bulgaria, Canada, Chile, China, Croatia, Cyprus, Czech Republic, Denmark, Egypt, Estonia, Finland, France, Georgia, Germany, Greece, Hong Kong (SAR), Hungary, India, Israel, Israel, Israel, Japan, Kazakhstan, Korea, Korea, Lithuania, Mexico, Moldova, Norway, Pakistan , Panama, Philippines, Poland, Portugal, Romania, Russia, Slovenia, Spain, Sweden, Syria, United Kingdom, United States, Uzbekistan, Zambia. <br><br><h5>  On the other side of the barricades.  Organizer Comments </h5><br>  Work on the laboratory, as we have already done, is carried out in several stages: <br>  1. Proposal and discussion of ideas for assignments. <br>  2. Implementation of the bench version of the task, verification. <br>  3. "Finishing" to the final version. <br>  4. Combining into a common scenario. <br><br>  In order to avoid problems during the launch of the laboratory, in the implementation of tasks are always taken into account: <br>  - the fact of simultaneous execution of the task by more than one participant; <br>  - not all participants are ‚Äúwhite and fluffy‚Äù.  It is necessary to exclude the possibility of vandalism or attempts to impede access to other participants. <br><br>  In some cases, when the task requires complete control over the system, but it is so interesting that you want to include it in the laboratory, you have to make some compromise.  Then we try to minimize the risks.  For example, to provide for a script to restrict access for the minimum number of participants simultaneously. <br><br>  Of course, it is very interesting to watch attacks in real time, being ‚Äúon the other side‚Äù.  In this laboratory, we did not use any intrusion detection systems, so the participants did not have any limitations in this regard.  But, based on observations, the presence of such a system would reflect most of the attacks.  Perhaps in the next lab we will include IDS / IPS bypass tasks. <br><br>  Most port scans, brute force, directory scans, etc.  it was made publicly available with the default settings: the nmap scripting engine and the DirBuster in the User-Agent, for example.  On one of the tasks, we left two options for passing, but the second allowed us to prevent others - so we decided to see which option the participants would prefer.  Unfortunately, as it was supposed, vandalism began after some time :) <br><br>  At first, we decided to play along and imitate the presence of the administrator, who is trying to figure out what is happening and close the holes.  For about an hour, the connections to the shelters were interrupted, deleted them and in every way interfered, but not closing the very possibility of exploitation.  Then, nevertheless, the alternative option had to be closed, because some unscrupulous participants constantly tried to remove the token itself, making it difficult for others to complete this task - apparently, this exercise gave them more pleasure than going through the lab itself. <br><br><h5>  Comments of participants </h5><br><blockquote>  Thank you very much for creating the laboratory.  All the tasks were interesting, although the decision of some was not obvious.  Most liked the task "ssh": it was very exciting to try to understand what was the vulnerability.  As a result, the laboratory is a great opportunity to get new knowledge and put into practice the existing ones. <br>  <i>MERRON</i> </blockquote><br><blockquote>  About the laboratory I can say that it was very interesting, some tasks were very difficult.  Since I love the web most of all, I would like to mention the task called ‚Äúforum‚Äù, a rather interesting idea, and a very cool implementation) I want to wish good luck and development to the whole team, well, thank you very much for the laboratory, I will wait for the following laboratories. <br>  <i>Darkcat</i> </blockquote><br>  I hope the collective work of the authors of the article was not in vain and it turned out to be useful.  I will be glad to consider all the wishes and comments in the drug.  Have a nice day, everyone! <br><br><h5>  References: </h5>  <a href="https://lab.pentestit.ru/pentestlabs/3">Laboratory "Test lab v.7"</a> |  <a href="http://forum.pentestit.ru/">Discussion</a> |  <a href="https://lab.pentestit.ru/map">Attack Map</a> |  <a href="https://www.pentestit.ru/hall-of-fame">Hall of Fame</a> </div><p>Source: <a href="https://habr.com/ru/post/257675/">https://habr.com/ru/post/257675/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../257665/index.html">Classic notes for the new Opera</a></li>
<li><a href="../257667/index.html">IEnumerable interface in C # and LSP</a></li>
<li><a href="../257669/index.html">Redesign and promotion. Chicken and Egg Challenge</a></li>
<li><a href="../257671/index.html">Deploy web application with Fabric</a></li>
<li><a href="../257673/index.html">How 3CX solves security problems (part 2)</a></li>
<li><a href="../257677/index.html">Low Blood Application Architecture</a></li>
<li><a href="../257679/index.html">Analysis of CPL malware, part 1</a></li>
<li><a href="../257681/index.html">Trojan-Downloader.Win32.Cabby.cemx - Part Two - Functional</a></li>
<li><a href="../257683/index.html">Likbez - how to become a programmer</a></li>
<li><a href="../257685/index.html">Product design digest, April 2015</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>