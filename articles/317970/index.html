<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How not to write too much</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All programmers are faced with a boiler-plate code. Especially Android programmers. To write a template code is a thankless task and, I am sure that t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How not to write too much</h1><div class="post__text post__text-html js-mediator-article"><p><img align="left" src="http://jeta.brooth.org/static/images/jeta.png">  All programmers are faced with a <em>boiler-plate</em> code.  Especially Android programmers.  To write a template code is a thankless task and, I am sure that there is no programmer who would enjoy it.  One day, I started looking for solutions.  Despite the fact that the idea is quite simple: to generate the template code in a separate class and later to call this code in runtime, there were no ready solutions, and I set to work.  The first version was implemented as one of the sub-modules of one of the working projects.  More than two years I was pleased with this decision.  It really worked and worked exactly the way I expected it.  As time went on, the module was supplemented with new functions, refactored, optimized.  In general, <a href="https://en.wikipedia.org/wiki/Proof_of_concept">PoC</a> could be called successful, and I decided to share the project with the community. </p><a name="habracut"></a><br><p> After 8 months of programming in the evenings, I'm on Habr√© with my first fast in my life.  So, <a href="http://jeta.brooth.org/">Jeta</a> is a framework for generating source code built on <code>javax.annotation.processing</code> .  <em>Open-Source</em> , <em>Apache 2.0</em> , source code on GitHub, artifacts on jCenter, tutorials, samples, unit-tests, in general, everything is as it should be. </p><br><p>  For clarity, let's consider a simple example.  The library includes annotation <code>@Log</code> .  It makes it easier to declare named loggers inside a class. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LogSample</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Log</span></span> Logger logger; }</code> </pre> <br><p>  So, for this class, Jeta will generate a <code>LogSample_Metacode</code> class with the <code>applyLogger</code> method: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LogSample_Metacode</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LogMetacode</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LogSample</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applyLogger</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(LogSample master, NamedLoggerProvider provider)</span></span></span><span class="hljs-function"> </span></span>{ master.logger = (Logger) provider.getLogger(‚ÄúLogSample‚Äù); } }</code> </pre> <br><p>  From the example it can be seen that the <code>@Log</code> annotation generates code that assigns a logger with the name ‚ÄúLogSample‚Äù to the annotated field.  It remains to implement <code>NamedLoggerProvider</code> which will deliver loggers from the library that is used in your project. </p><br><p>  In addition to the implicit naming of the loggers, which, as can be seen from the example, is taken from the class name, you can specify a specific value through the annotation parameter, such as <code>@Log(‚ÄúREST‚Äù)</code> . </p><br><p>  This technique eliminates copy-paste strings like: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Logger logger = LoggerFactory.getLogger(LogSample.class);</code> </pre> <br><p>  which in turn saves the project from loggers with the names of "neighbors", since programmers often forget to replace the class passed as a parameter. </p><br><p>  Of course, this is a fairly simple example.  Nevertheless, it shows the main idea of ‚Äã‚Äãthe framework - less code, more stability. </p><br><p>  Despite the fact that the main goal of Jeta is to get rid of the template code, at the reception shown above, many useful functions are implemented, such as <a href="http://jeta.brooth.org/guide/inject.html">Dependency Injection</a> , <a href="http://jeta.brooth.org/guide/event-bus.html">Event Bus</a> , <a href="http://jeta.brooth.org/guide/validator.html">Validators</a> , etc. It should be noted that all of them are written according to the principles of the framework - without <em>Java Reflection</em> and, if possible, all errors are at the compilation stage. </p><br><p>  In this article, we also will not get rid of the fictional <em>boiler-plate</em> case.  Instead, we write something useful, namely <em>Data Binding</em> (hereinafter referred to as DB).  Although, there is no fundamental difference, and this article can be used as a guide for solving problems associated with getting rid of the template code. </p><br><h3 id="data-binding">  Data Binding. </h3><br><p>  Android programmers may already be familiar with this term.  Not so long ago, Google released the <a href="https://developer.android.com/topic/libraries/data-binding/index.html">Data Binding Library</a> .  For those of you who are not familiar with this pattern, I am sure that it will not be difficult to understand its concept from the examples in this article.  I also bring two spoilers with a few guided tours of Android and Data-Binding, respectively. </p><br><div class="spoiler">  <b class="spoiler_title">Android</b> <div class="spoiler_text"><p>  The screen, in the context of Android programming, is called <em>Activity</em> .  This is a Java class inherited from <code>android.app.Activity</code> .  For each activation, there is an <em>XML</em> file with markup called <em>Layout</em> .  Here is an example of the Activity from the ‚ÄúHello, World‚Äù application: </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/text1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); TextView text1 = (TextView) findViewById(R.id.text1); text1.setText(<span class="hljs-string"><span class="hljs-string">"Hello World!"</span></span>); } }</code> </pre> <br><p>  The string <code>setContentView(R.layout.activity_main)</code> links the activations and the layout through the <code>R</code> file, which is automatically generated.  So, for our layout, the <code>activity_main.xml</code> , R-file will contain an internal <em>layout</em> class with an <em>activity_main</em> field and some unique numeric value.  For <em>TextView</em> , to which we assigned <code>id = text1</code> , this will be the internal <code>id</code> class and the <code>text1</code> field, respectively. </p></div></div><br><div class="spoiler">  <b class="spoiler_title">Data binding</b> <div class="spoiler_text"><p>  Data-binding allows you to write <em>DSL</em> expressions inside an <em>XML</em> file.  Here is an example from the official site <a href="https://developer.android.com/topic/libraries/data-binding/index.html">developer.android.com</a> : </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"user"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.example.User"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{user.firstName}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{user.lastName}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  So, at the right moment, we associate the user object ( <code>com.example.User</code> ) with the layout and data-binding automatically puts values ‚Äã‚Äãinto the corresponding components.  So, the first <code>TextView</code> display the user's name, and the second his last name. </p></div></div><br><p>  In this article we will write our Data-Binding, however, so far without preference, but at the end you will find a small interactive. </p><br><p>  Before we begin, a couple of comments on Jeta. </p><br><ol><li><p>  All functions specific to android are moved to a separate library - <a href="http://jeta.brooth.org/guide/androjeta/overview.html">Androjeta</a> .  It expands Jeta, which means everything that is available in Jeta, i.e.  for any Java project is also available in Androjeta. </p><br></li><li>  In the terminology of the framework, the generated class is called <em>Metacode</em> .  The class for which the meta code is generated is called <em>Master</em> .  There is also a <em>Controller</em> that applies meta-code to the master, and <em>Metasitory</em> is a repository of links to all <em>Metacode</em> classes.  With the help of <em>Metasitory</em> controllers find the desired meta-code. </li></ol><br><h3 id="1-databinding-proekt">  1. <code>DataBinding</code> project </h3><br><p>  First of all, we will create the most common Android project with one activation and <code>User</code> pojo-class.  Our task is to write the user's first and last name to the corresponding UI components via <em>DB</em> by the end of the article.  For clarity, I will provide screenshots with the structure of the project. </p><br><p><img src="https://i.gyazo.com/57cd4a549be62a2a02b90ec95fce5ae4.png" alt="project"></p><br><h3 id="2-common-modul">  2. <code>common</code> module </h3><br><p>  Since the code generation occurs at the compilation stage, and all related classes are run in a separate environment, we need a module that will be available both in runtime and during code generation.  I note that this is a regular Java module that will contain two files - the <code>DataBind</code> annotation and the <code>DataBind</code> Metacode interface. </p><br><p><img src="https://i.gyazo.com/e13048bb58d052ef16fea8d7f7939dd1.png" alt="common module"></p><br><h3 id="3-apt-modul">  3. <code>apt</code> module </h3><br><p>  <em>The apt</em> module contains the classes necessary for code-generation.  As already mentioned, this module depends on <em>common</em> and will be available only at the compilation stage.  Like <em>common</em> , this is a regular Java module that will contain a single file - <code>DataBindProcessor</code> .  It is in this class that we will process the <code>DataBind</code> annotation, parse the <em>XML</em> layout and generate the corresponding meta code.  Note that the <em>apt</em> module also depends on <code>org.brooth.androjeta:androjeta-apt:+:noapt</code> , thus gaining access to the framework classes. </p><br><p><img src="https://i.gyazo.com/c669e2da3ec3fdf313a59132c53f1e62.png" alt="apt module"></p><br><h3 id="4-podgotavlivaem-app">  4. Prepare the <code>app</code> </h3><br><p>  Before proceeding directly to the generation of meta-code, we must first prepare our application.  First, we will change our layout: </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:androjeta</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.jeta.brooth.org/androjeta"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/firstName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">androjeta:setText</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"master.user.firstName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/lastName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">androjeta:setText</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"master.user.lastName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  A small explanation: we declared our <em>namespace</em> with the prefix ‚Äúandrojeta‚Äù and added two <code>TextView</code> attributes <code>androjeta:setText</code> with <em>DB</em> expressions.  So we can find and process these expressions in the <code>DataBindProcessor</code> by generating the corresponding meta code. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.brooth.androjeta.samples.databinding; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-meta"><span class="hljs-meta">@DataBind</span></span>(layout = <span class="hljs-string"><span class="hljs-string">"activity_main"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> User user = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"John"</span></span>, <span class="hljs-string"><span class="hljs-string">"Smith"</span></span>); <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); MetaHelper.applyDataBinding(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> <br><p>  Two things are important here.  First of all, we added the <code>@DataBind</code> annotation to the <code>@DataBind</code> , which we previously created in the <em>common</em> module.  Thus, at the generation stage, Jeta will find this class and pass it to the <code>DataBindProcessor</code> .  Second, after we set up the layout, we call <code>MetaHelper.applyDataBind(this)</code> .  With the help of such static methods it is easier to access the meta-code.  Let's create this class. </p><br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.brooth.androjeta.samples.databinding; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.jeta.metasitory.MapMetasitory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.jeta.metasitory.Metasitory; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MetaHelper</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MetaHelper instance = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MetaHelper(<span class="hljs-string"><span class="hljs-string">"org.brooth.androjeta.samples"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Metasitory metasitory; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MetaHelper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String metaPackage)</span></span></span><span class="hljs-function"> </span></span>{ metasitory = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MapMetasitory(metaPackage); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applyDataBinding</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object master)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataBindController&lt;&gt;(instance.metasitory, master).apply(); } }</code> </pre> <br><p>  <em>MetaHelper</em> is an optional class.  This is a way of organizing access to the meta-code.  It serves solely as a convenience.  More information about this class can be found on <a href="http://jeta.brooth.org/guide/meta-helper.html">this page</a> .  Immediately it is important to us that the <code>applyDataBinding</code> method passes the work to <code>DataBindController</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.brooth.androjeta.samples.databinding; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.jeta.MasterController; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.jeta.metasitory.Metasitory; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataBindController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">M</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MasterController</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">M</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataBindMetacode</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">M</span></span></span><span class="hljs-class">&gt;&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DataBindController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Metasitory metasitory, M master)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(metasitory, master, DataBind.class); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">apply</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(DataBindMetacode&lt;M&gt; metacode : metacodes) metacode.apply(master); } }</code> </pre> <br><p>  Let me remind you that controllers are classes that apply meta code to wizards.  More information can be found on <a href="http://jeta.brooth.org/guide/meta-helper.html">this page</a> . </p><br><p>  In the last step, we need to add the <code>DataBindProcessor</code> to the list of processors that Jeta calls to generate meta-code.  To do this, in the root package of the app module ( <code>app/src/main/java</code> ) we will create a file <code>jeta.properties</code> with the contents: </p><br><pre> <code class="hljs scala">processors.add = org.brooth.androjeta.samples.databinding.apt.<span class="hljs-type"><span class="hljs-type">DataBindProcessor</span></span> metasitory.<span class="hljs-keyword"><span class="hljs-keyword">package</span></span> = org.brooth.androjeta.samples application.<span class="hljs-keyword"><span class="hljs-keyword">package</span></span> = org.brooth.androjeta.samples.databinding</code> </pre> <br><p>  More information about this file and the available settings you can find on <a href="http://jeta.brooth.org/guide/config.html">this page</a> . </p><br><h3 id="5-databindprocessor">  5. DataBindProcessor </h3><br><p>  I think it would be unnecessary to comment on every step of the processor, since  nothing innovative they contain.  It is enough to describe the main points: we are passing through the <em>SAX</em> parser over the <em>XML</em> layout, find the <em>DB</em> expressions and generate the corresponding Java code. </p><br><p>  It should be noted that Jeta uses <a href="https://github.com/square/javapoet">JavaPoet</a> - <a href="http://square.github.io/">Square's</a> excellent library for generating Java code.  I recommend to go through the <em>README</em> , if you are thinking of writing your processor.  Below is the source code of <code>DataBindProcessor</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.brooth.androjeta.samples.databinding.apt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.squareup.javapoet.ClassName; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.squareup.javapoet.MethodSpec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.squareup.javapoet.ParameterizedTypeName; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.squareup.javapoet.TypeSpec; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.androjeta.samples.databinding.DataBind; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.androjeta.samples.databinding.DataBindMetacode; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.jeta.apt.ProcessingContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.jeta.apt.ProcessingException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.jeta.apt.RoundContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.brooth.jeta.apt.processors.AbstractProcessor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.xml.sax.Attributes; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.xml.sax.SAXException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.xml.sax.helpers.DefaultHandler; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileNotFoundException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.lang.model.element.Modifier; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.lang.model.element.TypeElement; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.xml.parsers.SAXParser; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.xml.parsers.SAXParserFactory; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataBindProcessor</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractProcessor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String XMLNS_PREFIX = <span class="hljs-string"><span class="hljs-string">"xmlns:"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String ANDROID_NAMESPACE = <span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String ANDROJETA_NAMESPACE = <span class="hljs-string"><span class="hljs-string">"http://schemas.jeta.brooth.org/androjeta"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ClassName textViewClassname; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ClassName rCLassName; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String layoutsPath; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String androidPrefix; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String androjetaPrefix; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String componentId; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String componentExpression; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DataBindProcessor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(DataBind.class); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ProcessingContext processingContext)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.init(processingContext); layoutsPath = processingContext.processingEnv().getOptions().get(<span class="hljs-string"><span class="hljs-string">"layoutsPath"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (layoutsPath == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProcessingException(<span class="hljs-string"><span class="hljs-string">"'layoutsPath' not defined"</span></span>); String appPackage = processingContext.processingProperties().getProperty(<span class="hljs-string"><span class="hljs-string">"application.package"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (appPackage == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProcessingException(<span class="hljs-string"><span class="hljs-string">"'application.package' not defined"</span></span>); textViewClassname = ClassName.bestGuess(<span class="hljs-string"><span class="hljs-string">"android.widget.TextView"</span></span>); rCLassName = ClassName.bestGuess(appPackage + <span class="hljs-string"><span class="hljs-string">".R"</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TypeSpec.Builder builder, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> RoundContext roundContext)</span></span></span><span class="hljs-function"> </span></span>{ TypeElement element = roundContext.metacodeContext().masterElement(); ClassName masterClassName = ClassName.get(element); builder.addSuperinterface(ParameterizedTypeName.get( ClassName.get(DataBindMetacode.class), masterClassName)); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> MethodSpec.Builder methodBuilder = MethodSpec. methodBuilder(<span class="hljs-string"><span class="hljs-string">"apply"</span></span>) .addAnnotation(Override.class) .addModifiers(Modifier.PUBLIC) .returns(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>.class) .addParameter(masterClassName, <span class="hljs-string"><span class="hljs-string">"master"</span></span>); String layoutName = element.getAnnotation(DataBind.class).layout(); String layoutPath = layoutsPath + File.separator + layoutName + <span class="hljs-string"><span class="hljs-string">".xml"</span></span>; File layoutFile = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(layoutPath); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!layoutFile.exists()) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProcessingException(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileNotFoundException(layoutPath)); androidPrefix = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; androjetaPrefix = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { SAXParserFactory factory = SAXParserFactory.newInstance(); SAXParser saxParser = factory.newSAXParser(); saxParser.parse(layoutFile, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultHandler() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startElement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String uri, String localName, String qName, Attributes attributes)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SAXException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; attributes.getLength(); i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (androidPrefix == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; attributes.getQName(i).startsWith(XMLNS_PREFIX) &amp;&amp; attributes.getValue(i).equals(ANDROID_NAMESPACE)) { androidPrefix = attributes.getQName(i).substring(XMLNS_PREFIX.length()); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (androjetaPrefix == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; attributes.getQName(i).startsWith(XMLNS_PREFIX) &amp;&amp; attributes.getValue(i).equals(ANDROJETA_NAMESPACE)) { androjetaPrefix = attributes.getQName(i).substring(XMLNS_PREFIX.length()); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (componentId == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; androidPrefix != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; attributes.getQName(i).equals(androidPrefix + <span class="hljs-string"><span class="hljs-string">":id"</span></span>)) { componentId = attributes.getValue(i).substring(<span class="hljs-string"><span class="hljs-string">"@+id/"</span></span>.length()); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (componentExpression == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; androjetaPrefix != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; attributes.getQName(i).equals(androjetaPrefix + <span class="hljs-string"><span class="hljs-string">":setText"</span></span>)) { componentExpression = attributes.getValue(i); } } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endElement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String uri, String localName, String qName)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SAXException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (componentExpression == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (componentId == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProcessingException(<span class="hljs-string"><span class="hljs-string">"Failed to process expression '"</span></span> + componentExpression + <span class="hljs-string"><span class="hljs-string">"', component has no id"</span></span>); methodBuilder.addStatement(<span class="hljs-string"><span class="hljs-string">"(($T) master.findViewById($T.id.$L))\n\t.setText($L)"</span></span>, textViewClassname, rCLassName, componentId, componentExpression); componentId = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; componentExpression = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } } ); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProcessingException(e); } builder.addMethod(methodBuilder.build()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> </pre> <br><h3 id="6-ispolzovanie">  6. Usage </h3><br><p>  First, make sure everything works.  To do this, execute the following command in the project directory: </p><br><pre> <code class="bash hljs">./gradlew assemble</code> </pre> <br><p>  If there are no errors in the output, and you see the entry: </p><br><pre> <code class="bash hljs">Note: Metacode built <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Xms</code> </pre> <br><p>  then everything is OK, and along the path <code>/app/build/generated/source/apt/</code> we will be able to see the generated code: </p><br><p><img src="https://i.gyazo.com/c66234cabfef512a8f8f0b36f3179cf2.png" alt="metacode"></p><br><p>  As you can see, the meta code is formatted and readable, therefore, it is easy to debug.  Also, an important advantage is that all possible errors are found at the compilation stage.  So, if you add <code>@DataBind</code> to an Activity that does not have a <code>user</code> field, pass an incorrect name of the layout into the parameters, or make a mistake in the <em>DB</em> expression, the generated code will not compile and the project will not build. </p><br><p>  At this stage, you can start the application, and, as expected, you will see data on the user <em>user</em> on the screen. </p><br><h3 id="7-zaklyuchenie-">  7. Conclusion. </h3><br><p>  I ask you to take this example as a <em>Proof-Of-Concept</em> , and not as a ready-made solution.  In addition, his task is to demonstrate the work of the framework, and not the fact that <em>Jeta-DB</em> will go live. </p><br><p>  Actually, the promised interactive.  Write in the comments what you would like to see in the <em>Data-Binding</em> .  Perhaps you lack some capabilities in the implementation from Google.  Perhaps you want to get rid of some other <em>boiler-plate</em> case.  Also, I will be grateful for any other comments or suggestions.  I, in turn, will try to choose the most interesting and implement in future versions. </p><br><p>  Thank you for reading to the end. <br>  Happy code-generate!  :) </p><br><p>  ¬ª <a href="http://jeta.brooth.org/">Official site</a> <br>  " <a href="https://github.com/brooth/androjeta-samples/tree/master/data-binding">GitHub Sample Source Code</a> <br>  <a href="https://github.com/brooth/jeta">Jeta on github</a> <br>  ¬ª <a href="https://github.com/brooth/androjeta">Androjeta on github</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/317970/">https://habr.com/ru/post/317970/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317958/index.html">Portable RWLock for Windows</a></li>
<li><a href="../317962/index.html">Business ONE: ERP for small business exists. And he too</a></li>
<li><a href="../317964/index.html">What do mobile QA and octopus have in common?</a></li>
<li><a href="../317966/index.html">UniFi Mesh - less compromise</a></li>
<li><a href="../317968/index.html">How to sell if your product group is not on Yandex.Market?</a></li>
<li><a href="../317972/index.html">HolyJS Moscow: Expansion Time</a></li>
<li><a href="../317974/index.html">Journalist - we conduct text online broadcasts via Telegram</a></li>
<li><a href="../317976/index.html">Features of the development of mobile MMO RTS. Part 1</a></li>
<li><a href="../317978/index.html">Playing by the rules</a></li>
<li><a href="../317980/index.html">Optimize single query with GROUP BY to PostgreSQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>