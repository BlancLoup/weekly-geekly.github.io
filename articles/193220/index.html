<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>I will build my mail server with Postfix and Dovecot</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As part of the program for the unification of installed server systems, the task was to redesign the mail server. Thoughtful study of manuals and manu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>I will build my mail server with Postfix and Dovecot</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/737/fed/568/737fed56859bb5e08fa33ace3e0a4bf0.png" alt="image"><br><br>  As part of the program for the unification of installed server systems, the task was to redesign the mail server.  Thoughtful study of manuals and manuals showed a rather curious fact - nowhere was definitely found a reliable guide or the best practice similarity to deploying a mailer. <br><br>  The manual is step-by-step, based on the internal documentation of the company and raises obvious questions.  Gurus can not waste time, know-how is not here - the manual is a hodgepodge and is published only because all the found guidelines for deploying a mailer resembled a picture of how to draw an owl. <br><a name="habracut"></a><br>  For those who do not want to collect everything manually, the best option would probably be the <a href="http://www.iredmail.org/">iRedMail</a> package.  Excellent build Postfix, Dovecot, Apache, MySQL / PostgreSQL, Policyd, Amavis, Fail2ban, Roundcube and even Awstats.  It is easy to install, it works stably, there is a beautiful admin panel (free) and a very beautiful admin panel (paid), which is no match for PostfixAdmin.  Fans of manual labor can continue reading. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The old server worked under Gentoo and carried a thermonuclear charge from Postfix + VDA with Courier and a buggy implemented SASL, which decided to connect to mysql only during the first authentication.  The rework plan was to migrate to our internal standard, CentOS.  The role of MTA and MDA is assigned to a bunch of Postfix and Dovecot, and as auxiliary artillery: Amavis + SpamAssassin + ClamAV + Postgrey + Fail2Ban.  Letters are stored in files, and accounts and domains - in MySQL.  The server spins several mail domains and there is support for virtual quotas. <br><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4df/266/3bc/4df2663bc0e864df1a00d77353e4dbcf.png" alt="image"><br><br>  <b>[*] We</b> connect additional repositories.  I had enough <b>epel, rpmforge, centalt and remi</b> .  Not all of them are needed permanently enabled, and you can install the yum-priorities plugin;  Well, or if you are too lazy to understand, then turn on and off their hands.  Further I will say what repository is installed from. <br><br>  <b>[*]</b> Working with <b>SELinux</b> is worthy of a separate material, therefore, in this article, we assume that selinux is permissive or disabled. <br><br>  <b>[*]</b> Do not forget about <b>ntp</b> : <br><pre><code class="bash hljs">yum install ntp ntpdate &lt; ntp &gt; chkconfig ntpd on &amp;&amp; /etc/init.d/ntpd start</code> </pre> <br>  This will avoid the possible Dovecot "Time has moved backwards" problem.  You can also change the switch to -L in <i>/ etc / sysconfig / ntpd</i> so that ntpd does not listen to the network. <br><br>  <b>[*]</b> At the end of the preparatory stage, we put utilities that will facilitate our testing and further work: <br><pre> <code class="bash hljs">yum install wget mlocate <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span>-utils telnet mailx sharutils</code> </pre><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a02/ee4/6c0/a02ee46c0147a168d556e458c60839dd.png" alt="image"><br><br>  For our database we use <b>MySQL 5.5 from Remi</b> .  It is possible and mariadb, of course, but as long as MySQL is still alive, the above assembly suits me completely.  The version is important because  When Postfix is ‚Äã‚Äãupdated to 2.10, it will want a new version and if you put 5.1 from the base, then the update of the postfix from CentALT will pull MariaDB along.  Who likes PgSQL more - please put it.  Deployment will not be any different, even postfix configuration files can be taken unchanged.  Only the configuration of the postgresql itself and the creation of the database will differ <br><br>  The ‚Äúout of the box‚Äù option is suitable for launching (the slightly expanded my.cnf is presented in the repository below).  Create a <b>postfix</b> user with the same name base and all rights to it. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USER</span></span> postfix@localhost <span class="hljs-keyword"><span class="hljs-keyword">IDENTIFIED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-string"><span class="hljs-string">'mypassword'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span> postfix; <span class="hljs-keyword"><span class="hljs-keyword">GRANT</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">PRIVILEGES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> postfix.* <span class="hljs-keyword"><span class="hljs-keyword">TO</span></span> postfix;</code> </pre><br><br>  Antivirus works for me <b>ClamAV</b> .  It is worth noting that the latest version is on CentALT, however, it does not want to be downloaded from there point-blank, dying on trying to download 50 megabytes of clamav-db.  Therefore, we put fewer versions of <b>EPEL</b> for a few minor versions; the weather will not do that.  Clam will work on our socket, so in <i>/etc/clamd.conf we</i> comment on the lines: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#TCPSocket 3310 #TCPAddr 127.0.0.1</span></span></code> </pre><br>  The anti-virus database update is automatically connected, the <b>freshclam</b> utility is responsible for it.  We check that the corresponding file is in <i>cron.daily</i> and run the anti-virus service <br><pre> <code class="bash hljs">freshclam chkconfig clamd on &amp;&amp; /etc/init.d/clamd start</code> </pre><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3db/e40/621/3dbe40621caec7809d9f0c4c363627a5.png" alt="image"><br><br>  To deploy or not to deploy a web interface is a personal matter.  I needed it to control the migration process.  You may need it to create the base structure and administer domains, mailboxes, aliases, etc.  For the latter tasks, most manuals actively offer <b>PostfixAdmin</b> , but I categorically dislike it.  As well as I would recommend to adhere to the principle of separation, according to which the mail server should deal with mail processing, the web server to keep web applications, and the DB server to work with databases. <br><br>  For those who do not want to deploy the web subsystem, I attach a SQL database dump for the mail server for all occasions.  Even with some unused features: <a href="">mysql_dump.sql on github</a> . <br><br>  If PostfixAdmin is required, put <b>nginx / apache + php</b> and <b>PostfixAdmin</b> itself.  And note that <font color="darkred">it will not be possible to deploy it over the above dump</font> - some ‚Äúextra‚Äù tables have been removed from the structure.  Nuances of PostfixAdmin settings a bit.  Edit the <i>config.inc.php</i> , paying attention to the following parameters: <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">##       ,   dovecot $CONF['encrypt'] = 'md5crypt'; $CONF['transport_default'] = 'virtual'; $CONF['emailcheck_resolve_domain']='NO'; ##    dovecot,   $CONF['create_mailbox_subdirs_prefix']=''; ##  ,        maildir,      dict $CONF['new_quota_table'] = 'yes';</span></span></code> </pre><br>  After that, you can go to <a href="http://domain.tld/postfixadmin/setup.php">domain.tld / postfixadmin / setup.php</a> , generate a password and create a super administrator account.  Now the generated hash should be entered into the config.inc.php file and its status should be changed: <br><pre> <code class="php hljs">$CONF[<span class="hljs-string"><span class="hljs-string">'configured'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; $CONF[<span class="hljs-string"><span class="hljs-string">'setup_password'</span></span>] = <span class="hljs-string"><span class="hljs-string">'t8h9i9s2i7s7m2y4l9o8g9i4n:a0n9d5p2a5s2s9w5o4r7d'</span></span>;</code> </pre><br>  <b>[!]</b> Postfixadmin itself creates the base structure in both mysql and postgresql when running setup.php.  If you intend to use it, the installation should be carried out on an empty base. <br><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/761/c6e/aaa/761c6eaaa5c859582ffcf291b63cfd34.png" alt="image"><br><br>  Let's check that the entire default structure has been created in the postfix database and proceed to install the MTA and MDA.  <b>Postfix is</b> already bundled with CentOS, but not the newest.  Update it from <b>CentALT</b> and <b>install</b> Dovecot from there. <br><pre> <code class="bash hljs">yum update postfix yum install dovecot dovecot-mysql</code> </pre><br><br>  All major ship systems will operate on files in <i>/ var / vmail</i> under a separate user: <br><pre> <code class="bash hljs">groupadd -g 1000 vmail useradd -d /var/vmail/ -g 1000 -u 1000 vmail chown vmail:vmail /var/vmail</code> </pre><br><br>  Make a self-signed SSL <br><pre> <code class="bash hljs">mkdir /etc/postfix/certs openssl req -new -x509 -days 3650 -nodes -out /etc/postfix/certs/cert.pem -keyout /etc/postfix/certs/key.pem</code> </pre><br><br>  The nastiest build stage is to convince Postfix to work with the database: <br><pre> <code class="bash hljs">mkdir /etc/postfix/mysql</code> </pre><br>  In this directory we create files with the following content: <br><div class="spoiler">  <b class="spoiler_title">Postfix mysql configuration</b> <div class="spoiler_text">  <b>relay_domains.cf</b> <br><pre> <code class="bash hljs">hosts = localhost user = postfix password = mypassword dbname = postfix query = SELECT domain FROM domain WHERE domain=<span class="hljs-string"><span class="hljs-string">'%s'</span></span> and backupmx = <span class="hljs-string"><span class="hljs-string">'1'</span></span></code> </pre><br><br>  <b>virtual_alias_domain_maps.cf</b> <br><pre> <code class="bash hljs">hosts = localhost user = postfix password = mypassword dbname = postfix query = SELECT goto FROM <span class="hljs-built_in"><span class="hljs-built_in">alias</span></span>,alias_domain WHERE alias_domain.alias_domain = <span class="hljs-string"><span class="hljs-string">'%d'</span></span> and alias.address = CONCAT(<span class="hljs-string"><span class="hljs-string">'%u'</span></span>, <span class="hljs-string"><span class="hljs-string">'@'</span></span>, alias_domain.target_domain) AND alias.active = 1</code> </pre><br><br>  <b>virtual_alias_maps.cf</b> <br><pre> <code class="bash hljs">hosts = localhost user = postfix password = mypassword dbname = postfix query = SELECT goto FROM <span class="hljs-built_in"><span class="hljs-built_in">alias</span></span> WHERE address=<span class="hljs-string"><span class="hljs-string">'%s'</span></span> AND active = <span class="hljs-string"><span class="hljs-string">'1'</span></span></code> </pre><br><br>  <b>virtual_mailbox_domains.cf</b> <br><pre> <code class="bash hljs">hosts = localhost user = postfix password = mypassword dbname = postfix query = SELECT domain FROM domain WHERE domain=<span class="hljs-string"><span class="hljs-string">'%s'</span></span> AND backupmx = <span class="hljs-string"><span class="hljs-string">'0'</span></span> AND active = <span class="hljs-string"><span class="hljs-string">'1'</span></span></code> </pre><br><br>  <b>virtual_mailbox_maps.cf</b> <br><pre> <code class="bash hljs">hosts = localhost user = postfix password = mypassword dbname = postfix query = SELECT maildir FROM mailbox WHERE username=<span class="hljs-string"><span class="hljs-string">'%s'</span></span> AND active = <span class="hljs-string"><span class="hljs-string">'1'</span></span></code> </pre><br></div></div><br><br>  We edit the <i>/etc/postfix/main.cf</i> file, teaching Postfix <i>how</i> to work with the database using the newly created files: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ============================================================ # MySQL mappings # ============================================================ relay_domains = mysql:/etc/postfix/mysql/relay_domains.cf virtual_alias_maps = mysql:/etc/postfix/mysql/virtual_alias_maps.cf, mysql:/etc/postfix/mysql/virtual_alias_domain_maps.cf virtual_mailbox_domains = mysql:/etc/postfix/mysql/virtual_mailbox_domains.cf virtual_mailbox_maps = mysql:/etc/postfix/mysql/virtual_mailbox_maps.cf</span></span></code> </pre><br><br>  A good mail server lets its own and authorizes others.  In order for the authentication to work correctly, we will launch <b>Submission</b> , raising the SMTP service to an additional 587 port.  Smartphones when creating new accounts when entering an smtp server with authentication by default offer port 587;  you do not want to explain to customers that it is not enough to enter mail.domain.tld, but also it is necessary to prescribe some ports.  In general, in <i>/etc/postfix/master.cf we</i> edit the section responsible for the submission: <br><pre> <code class="bash hljs">submission inet n - n - - smtpd -o syslog_name=postfix/submission -o smtpd_tls_wrappermode=no -o smtpd_tls_security_level=encrypt -o smtpd_sasl_auth_enable=yes -o smtpd_recipient_restrictions=permit_mynetworks,permit_sasl_authenticated,reject -o smtpd_relay_restrictions=permit_mynetworks,permit_sasl_authenticated,defer_unauth_destination -o milter_macro_daemon_name=ORIGINATING</code> </pre><br>  <b>[!]</b> Be sure to pay attention to the spaces before the <b>-o</b> keys - without them the config will not be valid. <br><br>  As long as we set aside master.cf, we will return to it later, and continue with <i>/etc/postfix/main.cf</i> <br><pre> <code class="bash hljs">soft_bounce = no myhostname = mail.domain.tld mydomain = domain.tld myorigin = <span class="hljs-variable"><span class="hljs-variable">$myhostname</span></span> <span class="hljs-comment"><span class="hljs-comment">#  $myhostname  $mydomain    #    do not list domain in BOTH mydestination and virtual_mailbox_domains mydestination = localhost.$mydomain, localhost ##    ##         ##            mynetworks = 192.168.0.0/16, 127.0.0.0/8 ##  nis:/      ## dict_nis_init: NIS domain name not set - NIS lookups disabled alias_maps = hash:/etc/aliases smtpd_banner = $myhostname ESMTP $mail_name debug_peer_level = 2 debug_peer_list = 127.0.0.1</span></span></code> </pre><br><br>  These were default string changes.  And now add some sections of our settings.  Check for duplicates by removing them from the native configuration, if they are there.  I suggest <i>entering</i> your settings in structured blocks at the bottom of the <i>/etc/postfix/main.cf</i> file: <br><div class="spoiler">  <b class="spoiler_title">Another configuration sheet</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ============================================================ # RESTRICTIONS # # Uncomment reject_rbl_client if necessary # More information at: http://help.ubuntu.ru/wiki/____smtp_ # ============================================================ smtpd_discard_ehlo_keywords = etrn, silent-discard smtpd_forbidden_commands = CONNECT GET POST broken_sasl_auth_clients = yes smtpd_delay_reject = yes smtpd_helo_required = yes disable_vrfy_command = yes smtpd_helo_restrictions = permit_mynetworks, permit_sasl_authenticated, reject_non_fqdn_helo_hostname, reject_invalid_helo_hostname smtpd_data_restrictions = permit_mynetworks, permit_sasl_authenticated, reject_unauth_pipelining, reject_multi_recipient_bounce, smtpd_sender_restrictions = permit_mynetworks, permit_sasl_authenticated, reject_non_fqdn_sender, reject_unknown_sender_domain smtpd_recipient_restrictions = reject_non_fqdn_recipient, reject_unknown_recipient_domain, reject_multi_recipient_bounce, permit_mynetworks, permit_sasl_authenticated, reject_unauth_destination, check_policy_service unix:/var/spool/postfix/postgrey/socket, #reject_rbl_client zen.spamhaus.org, #reject_rbl_client bl.spamcop.net, #reject_rbl_client dnsbl.sorbs.net, reject_invalid_hostname # ============================================================ # TLS # ============================================================ smtp_tls_security_level = may smtpd_tls_security_level = may smtpd_tls_loglevel = 1 smtpd_tls_received_header = yes smtpd_tls_session_cache_timeout = 3600s smtp_tls_session_cache_database = btree:$data_directory/smtp_tls_session_cache smtpd_tls_key_file = /etc/postfix/certs/key.pem smtpd_tls_cert_file = /etc/postfix/certs/cert.pem tls_random_source = dev:/dev/urandom # ============================================================ # LIMITS # ============================================================ message_size_limit = 51200000 smtpd_soft_error_limit = 10 smtpd_hard_error_limit = 15 smtpd_error_sleep_time = 20 anvil_rate_time_unit = 60s smtpd_client_connection_count_limit = 20 smtpd_client_connection_rate_limit = 30 smtpd_client_message_rate_limit = 30 smtpd_client_event_limit_exceptions = 127.0.0.1/8 smtpd_client_connection_limit_exceptions = 127.0.0.1/8 # ============================================================ # QUEUE # ============================================================ maximal_queue_lifetime = 1d bounce_queue_lifetime = 1d</span></span></code> </pre><br></div></div><br>  <b>[!]</b> To use or not to use blacklists is your choice.  I commented out the relevant directives <b>reject_rbl_client</b> , so as not to produce holivary.  Greylisting is often enough, and Spamhaus and others like him profess an ambiguous policy, but in practice it turned out that the ‚Äúhonest guys‚Äù didn‚Äôt enter black lists and we didn‚Äôt have any false positives.  Lucky, I guess.  Therefore, it is a matter of taste to include RBL directives or not.  Consider that I indicated them for informational purposes. <br>  <b>[!]</b> Parameters are divided into groups - carefully review them and adjust to your own needs.  Worse, there is no option than blindly slapping someone else's config without edits. <br>  <b>[!]</b> <a href="https://habrahabr.ru/users/malamut/" class="user_link">Malamut</a> rightly observed that the option `permit_mynetworks` is highly dubious and dangerous.  It would be much better to remove it and only allow authenticated users to send correspondence. <br>  <b>[!]</b> We‚Äôll go back to the main.cf file by adding <b>postgrey</b> , <b>amavis</b> and <b>dovecot to</b> it, but for now let's move on to MDA <br><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/504/87f/4a3/50487f4a33935b0e6a9731f82250aab5.png" alt="image"><br><br>  What it is: <br><ul><li>  This is our Mail Delivery Agent, local transport. </li><li>  Own SASL through which Postfix will work </li><li>  Work with quotas </li><li>  Providing the user with imap and pop3 </li></ul><br><br>  A couple of changes in <i>/etc/dovecot/dovecot.conf</i> : <br><pre> <code class="bash hljs">protocols = imap pop3 login_greeting = Hello there.</code> </pre><br>  The rest of the configuration file is conveniently divided into components and well documented: <br><div class="spoiler">  <b class="spoiler_title">10-auth.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs">disable_plaintext_auth = no auth_realms = domain.tld domain2.tld auth_default_realm = domain.tld auth_mechanisms = plain login <span class="hljs-comment"><span class="hljs-comment">## [!]  auth-system.conf.ext,   ##  dovecot    pam #!include auth-system.conf.ext</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">10-logging.conf</b> <div class="spoiler_text">  Separate listing will not be - optionally turn on the necessary options. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">10-mail.conf</b> <div class="spoiler_text">  mail_location = maildir: / var / vmail /% d /% n <br>  mail_uid = 1000 <br>  mail_gid = 1000 <br>  mail_plugins = quota <br></div></div><br><div class="spoiler">  <b class="spoiler_title">10-master.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  imap  imaps service imap-login { inet_listener imap { port = 143 } inet_listener imaps { port = 993 ssl = yes } } #  pop3  pop3s service pop3-login { inet_listener pop3 { port = 110 } inet_listener pop3s { port = 995 ssl = yes } } #  SASL,    postfix service auth { unix_listener auth-userdb { mode = 0600 user = vmail group = vmail } unix_listener /var/spool/postfix/private/auth { mode = 0666 user=postfix group=postfix } }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">10-ssl.conf</b> <div class="spoiler_text">  ssl = yes <br>  ssl_cert = &lt;/etc/postfix/certs/cert.pem <br>  ssl_key = &lt;/etc/postfix/certs/key.pem <br></div></div><br><div class="spoiler">  <b class="spoiler_title">15-lda.conf</b> <div class="spoiler_text">  quota_full_tempfail = no <br>  lda_mailbox_autocreate = yes <br>  lda_mailbox_autosubscribe = yes <br>  protocol lda { <br>  mail_plugins = $ mail_plugins autocreate <br>  } <br></div></div><br><div class="spoiler">  <b class="spoiler_title">20-imap.conf</b> <div class="spoiler_text">  protocol imap { <br>  mail_plugins = $ mail_plugins autocreate quota imap_quota <br>  } <br></div></div><br><div class="spoiler">  <b class="spoiler_title">90-plugin.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     . #          plugin { autocreate = Trash autocreate2 = sent-mail autocreate3 = drafts autosubscribe = Trash autosubscribe2 = sent-mail autosubscribe3 = drafts }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">90-quota.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#       . plugin { quota_rule = *:storage=200M quota_rule2 = Trash:storage=+10M } plugin { quota_warning = storage=90%% quota-warning 90 %u } # ,      chmod #    quota-warning.sh      dovecot-lda service quota-warning { executable = script /usr/local/bin/quota-warning.sh user = vmail unix_listener quota-warning { user = vmail } } #    - maildir #      dict, fs  dirsize #    http://wiki2.dovecot.org/Quota plugin { quota = maildir:User quota }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">auth-sql.conf.ext</b> <div class="spoiler_text">  passdb { <br>  driver = sql <br>  args = /etc/dovecot/dovecot-sql.conf.ext <br>  } <br>  userdb { <br>  driver = sql <br>  args = /etc/dovecot/dovecot-sql.conf.ext <br>  } <br></div></div><br><br>  Create <i>/etc/dovecot/dovecot-sql.conf.ext</i> : <br><div class="spoiler">  <b class="spoiler_title">dovecot-sql.conf.ext</b> <div class="spoiler_text">  driver = mysql <br>  connect = host = localhost dbname = postfix user = postfix password = mypassword <br>  default_pass_scheme = MD5-CRYPT <br>  user_query = SELECT '/ var / vmail /% d /% n' as home, 'maildir: / var / vmail /% d /% n'as mail, 1000 AS uid, 1000 AS gid, concat (' *: bytes = ', quota) AS quota_rule FROM mailbox WHERE username ='% u 'AND active =' 1 ' <br>  password_query = select username as user, password, '/ var / vmail /% d /% n' as userdb_home, 'maildir: / var / vmail /% d /% n' as userdb_mail, 1000 as userdb_uid, 1000 as userdb_gid, concat ('*: bytes =', quota) AS userdb_quota_rule FROM mailbox WHER <br>  E username = '% u' AND active = '1' <br></div></div><br><br>  Now we will be friends with <b>Postfix</b> with <b>Dovecot</b> .  Add two sections to <i>/etc/postfix/main.cf</i> : <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ============================================================ # SASL # ============================================================ smtpd_sasl_auth_enable = yes smtpd_sasl_security_options = noanonymous smtpd_sasl_type = dovecot smtpd_sasl_path = private/auth # ============================================================ # VIRTUAL # ============================================================ virtual_mailbox_base = /var/vmail virtual_minimum_uid = 1000 virtual_uid_maps = static:1000 virtual_gid_maps = static:1000 virtual_transport = dovecot dovecot_destination_recipient_limit = 1</span></span></code> </pre><br><br>  And put <b>Postfix</b> in front of the fact that dovecot handles mail delivery.  In <i>/etc/postfix/master.cf</i> : <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ==================================================================== # DOVECOT # ==================================================================== dovecot unix - nn - - pipe flags=DRhu user=vmail:vmail argv=/usr/libexec/dovecot/deliver -f ${sender} -d ${recipient}</span></span></code> </pre><br><br>  Next, you need to check that the / qur /usal/local/bin/quota-warning.sh warning script is correctly executed.  In my case, the CentOS path was incorrect and I had to manually edit it.  In any case, by the way, correct it manually by editing the sender's address, which is specified by default as <i>postmaster@domain.tld</i> .  Find the desired binary <br><pre> <code class="bash hljs">updatedb locate dovecot-lda chmod 755 /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/quota-warning.sh</code> </pre><br>  And fix the path in the <i>/usr/local/bin/quota-warning.sh</i> itself, if desired, adding more meaningful headers to the script. <br><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/25f/da7/b83/25fda7b83dd5ceaf2d2887ac8db15712.png" alt="image"><br><br>  Since <b>Amavis</b> , which is a layer between mail agents and anti-virus and anti-spam systems, will work with us, you do not need to start spamd separately - it works as a module, loaded if necessary.  To keep SA updated, the native <b>sa-update</b> utility is used.  Make sure that in <i>etc / cron.d</i> there is a <b>sa-update</b> file with the scheduled launch of the update. <br><br>  <b>[!]</b> Install <b>spamassassin 3.3.2</b> from <b>rpmforge-extras</b> , as  Version 3.3.1 stuck in from EPEL has a congenital defect in sa-update.  The latest version <u><b>3.3.2 is</b></u> already spared from this problem and is updated correctly. <br><pre> <code class="bash hljs">yum install spamassassin amavisd-new</code> </pre><br>  <i>Adjust</i> slightly <i>/etc/mail/spamassassin/local.cf</i> <br><div class="spoiler">  <b class="spoiler_title">local.cf</b> <div class="spoiler_text"><pre> <code class="bash hljs">required_hits 6 report_safe 0 rewrite_header Subject ***SPAM*** <span class="hljs-comment"><span class="hljs-comment"># # WEIRD STUFF # score FORGED_MUA_OUTLOOK 2.199 2.199 0.963 1.116 score FH_DATE_PAST_20XX 0.0 score DOS_OE_TO_MX_IMAGE 0.0 score DOS_OE_TO_MX 0.0 score DOS_OUTLOOK_TO_MX 0.0 score TO_NO_BRKTS_DIRECT 0.0 score HELO_LOCALHOST 0.0 score FSL_RU_URL 0.0 score FROM_MISSP_EH_MATCH 1.0 score TVD_RCVD_SINGLE 1.0 score TO_IN_SUBJ 1.0 # # TUNING # score SUBJ_FULL_OF_8BITS 0.00 score HTML_COMMENT_8BITS 0.01 score HEADER_8BITS 0.00 score TO_NO_USER 0.01 score FORGED_MUA_OUTLOOK 0.5 score X_AUTH_WARNING 0.01 score SUBJ_HAS_UNIQ_ID 9.99 score HTTP_USERNAME_USED 9.99 score FORGED_YAHOO_RCVD 9.99 score FORGED_JUNO_RCVD 16 score UNWANTED_LANGUAGE_BODY 1.02 score MLM 5.55 score RCVD_NUMERIC_HELO 4.95 # # WHITE/BLACK LISTS # whitelist_from root@localhost whitelist_from *@example.com blacklist_from *@outblaze.com auto_whitelist_path /etc/mail/spamassassin/auto-whitelist auto_whitelist_file_mode 0666</span></span></code> </pre><br></div></div><br><br>  But the <b>Amavis</b> ' a configuration file is the exact opposite of the Dovecot configs that I praised.  It is a regular perl script, which is also poorly formatted.  I make the changes simply - I rename the file to .pl and edit with syntax highlighting;  it makes life a little easier. <br><div class="spoiler">  <b class="spoiler_title">amavisd.conf</b> <div class="spoiler_text"><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#   amavisd #      /etc/postfix/master.cf $max_servers = 4; #    $mydomain = 'domain.tld'; #    @mynetworks = qw( 127.0.0.0/8 [::1] [FE80::]/10 [FEC0::]/10 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16 ); #   2.6.4  .      # Open relay? Nonlocal recips but not originating @client_ipaddr_policy = map { $_ =&gt; 'MYNETS' } @mynetworks; #     spamassassin $sa_tag_level_deflt = 2.0; $sa_tag2_level_deflt = 5.2; $sa_kill_level_deflt = 6.5; $sa_dsn_cutoff_level = 10; #           $virus_admin = "virusalert\@$mydomain"; $mailfrom_notify_admin = "virusalert\@$mydomain"; $mailfrom_notify_recip = "virusalert\@$mydomain"; $mailfrom_notify_spamadmin = "abuse\@$mydomain"; #      $myhostname = 'mail.domain.tld'; #     $final_virus_destiny = D_DISCARD; $final_banned_destiny = D_BOUNCE; $final_spam_destiny = D_DISCARD; $final_bad_header_destiny = D_PASS; #    ,     # ,      $virus_quarantine_to = "virus-quarantine\@$mydomain"; $spam_quarantine_to = "spamtrap\@$mydomain"; #   -        #   @whitelist_sender_maps = ( new_RE( qr'.*@example\.com$'i, qr'user@test\.org$'i, )); #   @av_scanners   @av_scanners = ( ['ClamAV-clamd', \&amp;ask_daemon, ["CONTSCAN {}\n", "/var/run/clamav/clamd.sock"], qr/\bOK$/m, qr/\bFOUND$/m, qr/^.*?: (?!Infected Archive)(.*) FOUND$/m ], ); ); #    @av_scanners_backup = ( ['ClamAV-clamscan', 'clamscan', "--stdout --no-summary -r --tempdir=$TEMPBASE {}", [0], qr/:.*\sFOUND$/m, qr/^.*?: (?!Infected Archive)(.*) FOUND$/m ], );</span></span></code> </pre><br></div></div><br>  Now let <b>Postfix</b> <b>tell you</b> that it will now use <b>Amavis</b> to check for mail.  We <i>enter the</i> appropriate block in <i>/etc/postfix/master.cf</i> <br><div class="spoiler">  <b class="spoiler_title">master.cf</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ==================================================================== # AMAVIS # ==================================================================== amavisfeed unix - - n - 4 lmtp -o lmtp_data_done_timeout=1200 -o lmtp_send_xforward_command=yes -o disable_dns_lookups=yes -o max_use=20 127.0.0.1:10025 inet n - n - - smtpd -o content_filter= -o smtpd_delay_reject=no -o smtpd_client_restrictions=permit_mynetworks,reject -o smtpd_helo_restrictions= -o smtpd_sender_restrictions= -o smtpd_recipient_restrictions=permit_mynetworks,reject -o smtpd_data_restrictions=reject_unauth_pipelining -o smtpd_end_of_data_restrictions= -o smtpd_restriction_classes= -o mynetworks=127.0.0.0/8,192.168.0.0/16 -o smtpd_error_sleep_time=0 -o smtpd_soft_error_limit=1001 -o smtpd_hard_error_limit=1000 -o smtpd_client_connection_count_limit=0 -o smtpd_client_connection_rate_limit=0 -o receive_override_options=no_header_body_checks,no_unknown_recipient_checks,no_milters,no_address_mappings -o local_header_rewrite_clients= -o smtpd_milters= -o local_recipient_maps= -o relay_recipient_maps=</span></span></code> </pre><br></div></div><br>  and add to <i>/etc/postfix/main.cf</i> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ============================================================ # AMAVIS # ============================================================ content_filter=amavisfeed:[127.0.0.1]:10024</span></span></code> </pre><br>  Develop services: <br><pre> <code class="bash hljs">chkconfig amavisd on &amp;&amp; /etc/init.d/amavisd start /etc/init.d/postfix restart telnet 127.0.0.1 10024 <span class="hljs-comment"><span class="hljs-comment"># 220 [127.0.0.1] ESMTP amavisd-new service ready</span></span></code> </pre><br><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3fc/43e/b62/3fc43eb6287cd711d58dc65c8cf590d7.png" alt="image"><br><br>  Greylist's efficiency has been written more than once, so just silently <br><pre> <code class="bash hljs">yum install postgrey</code> </pre><br><br>  No additional configuration is required - we register it in <i>/etc/postfix/main.cf</i> <br><pre> <code class="bash hljs">smtpd_recipient_restrictions = ... reject_unauth_destination, check_policy_service unix:/var/spool/postfix/postgrey/socket, ...</code> </pre><br>  <b>[!]</b> The check_policy_service directive must <i>always</i> follow reject_unauth_destination. <br>  If there is a need to exclude any servers from the scan, we edit <i>/etc/postfix/postgrey_whitelist_clients.local</i> , and to exclude specific email addresses on the local server from the check, we edit the <i>postgrey_whitelist_recipients</i> .  Comprehensive information is available on the wiki: <a href="http://wiki.centos.org/HowTos/postgrey">wiki.centos.org/HowTos/postgrey</a> <br><br>  About <b>Fail2ban</b> conversation separate.  To demonstrate its effectiveness, I‚Äôll show a picture with mail server statistics before and after installing the utility.  The red line on the chart - unauthorized swotting in search of an open relay.  Letters, of course, are cut off, and the load is not created much, but why listen to this garbage at all.  Therefore, installing fail2ban with three rules significantly improves the appearance of the graph: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f53/05e/3a0/f5305e3a086d4dd62f10cf6ba61edc83.png"></div><br><br><pre> <code class="bash hljs">yum install fail2ban</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Rules for the mail server /etc/fail2ban/jail.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#      # ,   #    ## ## ,       ## [ssh-iptables] enabled = true filter = sshd action = iptables[name=SSH, port=ssh, protocol=tcp] logpath = /var/log/secure maxretry = 5 [postfix-banhammer] enabled = true filter = postfix action = iptables-multiport-tcp[name=PFIX, port="smtp,smtps", protocol=tcp] logpath = /var/log/maillog maxretry = 3 bantime = 7200 [dovecot-banhammer] enabled = true filter = dovecot action = iptables-multiport-tcp[name=DCOT, port="pop3,pop3s,imap,imaps", protocol=tcp] logpath = /var/log/maillog findtime = 300 maxretry = 10 bantime = 1800 [sasl-banhammer] enabled = true filter = sasl action = iptables-multiport-tcp[name=SASL, port="smtp,smtps", protocol=tcp] logpath = /var/log/maillog findtime = 300 maxretry = 10 bantime = 1800</span></span></code> </pre><br></div></div><br>  If SSH is open only to the internal network, then the first rule can be removed.  And yet, no additional gestures - the rules work out of the box.  Thank you <a href="https://habrahabr.ru/users/urbain/" class="user_link">urbain</a> for reminding you about smtp brute force protection. <br><pre> <code class="bash hljs">chkconfig fail2ban on &amp;&amp; /etc/init.d/fail2ban start</code> </pre><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ed/c84/2e3/1edc842e3ad0091dedf80b3bd3159cd8.png" alt="image"><br><br>  Since we connected the <i>autocreate</i> plugin in <i>Dovecot</i> , to create domains and mailboxes, it is enough to get them into the database via Postfixadmin or by doing INSERT INTO in the console.  At the first authentication or the first letter received, the directory structure will be created automatically. <br><br><div class="spoiler">  <b class="spoiler_title">Test pop3, imap, smtp in different poses</b> <div class="spoiler_text"><ol><li>  <b>We test POP3 login</b> <br><pre> <code class="bash hljs">telnet 127.0.0.1 110 user <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> pass testpassword UIDL</code> </pre><br></li><li>  <b>We test login IMAP</b> <br><pre> <code class="bash hljs">telnet 127.0.0.1 143 1 LOGIN <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> testpassword 1 SELECT INBOX</code> </pre><br></li><li> <b> SMTP  </b> <br><pre> <code class="bash hljs">telnet 127.0.0.1 25 <span class="hljs-comment"><span class="hljs-comment">#220 mail.domain.tld ESMTP Postfix helo darling #250 mail.domain.tld MAIL FROM: root@localhost #250 2.1.0 Ok RCPT TO: test@example.com #250 2.1.5 Ok DATA #354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt; this is text message . #250 2.0.0 Ok: queued as E3BA1A15FA quit #221 2.0.0 Bye</span></span></code> </pre><br></li><li> <b> SMTP c   SSL</b> <br>    base64    ,     AUTH LOGIN.     334    base64. <br><pre> <code class="bash hljs">telnet 127.0.0.1 25 <span class="hljs-comment"><span class="hljs-comment">#220 mail.domain.tld ESMTP Postfix ehlo darling #250-mail2.dautkom.lv #250-PIPELINING #250-SIZE 51200000 #250-STARTTLS #250-AUTH PLAIN LOGIN #250-AUTH=PLAIN LOGIN #250-ENHANCEDSTATUSCODES #250-8BITMIME #250 DSN AUTH LOGIN #334 VXNlcm5hbWU6 dGVzdA== #334 UGFzc3dvcmQ6 dGVzdHBhc3N3b3Jk #235 2.7.0 Authentication successful</span></span></code> </pre><br></li><li> <b> SMTP c SSL</b> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#   credentials perl -MMIME::Base64 -e 'print encode_base64("\000test\@example.com\000testpassword")' #   # AHRlc3RAZXhhbXBsZS5jb20AdGVzdHBhc3N3b3Jk openssl s_client -starttls smtp -connect 127.0.0.1:587 -crlf -ign_eof #   #     EHLO darling #250-mail.example.com #250-PIPELINING #250-SIZE 51200000 #250-ENHANCEDSTATUSCODES #250-8BITMIME #250 DSN AUTH PLAIN AHRlc3RAZXhhbXBsZS5jb20AdGVzdHBhc3N3b3Jk #235 2.7.0 Authentication successful</span></span></code> </pre><br></li></ol><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test anti-virus protection</font></font></b> <div class="spoiler_text"><ol><li>    amavis    . , .     ,   .       : <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /usr/share/doc/amavisd-new-2.8.0/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>-messages perl -pe <span class="hljs-string"><span class="hljs-string">'s/./chr(ord($&amp;)^255)/sge'</span></span> &lt;sample.tar.gz.compl | zcat | tar xvf -</code> </pre><br><br></li><li>       : <br><pre> <code class="bash hljs">sendmail -i your-address@example.com &lt; sample-virus-simple.txt sendmail -i your-address@example.com &lt; sample-spam-GTUBE-junk.txt</code> </pre><br>        (  /var/log/maillog).    ,   <b>verbose</b>  <i>/etc/dovecot/conf.d/10-logging.conf</i>  <b>log-level</b>  <i>/etc/amavisd/amavisd.conf</i> . <br></li></ol><br></div></div><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ad3/a76/d6d/ad3a76d6d0cafba93cbc243c5cd24791.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you can turn off the computer's power, you</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can start working with the mail server, create domains, users, aliases, etc. </font><font style="vertical-align: inherit;">Finally, some general points and recommendations:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I use git to work with configuration files, turning the / etc directory into a repository. </font><font style="vertical-align: inherit;">This approach allows you to conveniently fiddle with configs between the technical department staff and step by step to control the configuration process. </font><font style="vertical-align: inherit;">In working with such a complex system as a mail server, this practice can make life much easier.</font></font></li><li>       c courier  dovecot.  ,  .   <a href="http://wiki2.dovecot.org/Migration/Courier">wiki2.dovecot.org/Migration/Courier</a>     .        POP3  UIDL               ,  .    ,          . <br>              <br><pre> <code class="bash hljs">find . -name <span class="hljs-string"><span class="hljs-string">"courier*"</span></span> -delete</code> </pre></li><li>    iptables ‚Äî          . </li><li>     CentOS  rsyslog    ,      syslog-ng  EPEL. ,    syslog-ng      ‚Äî        . </li><li>  vacation ,   dovecot    Sieve  ¬´¬ª .   ‚Äî   ¬´ ¬ª.     . </li></ol><br><br> <font color="darkred">       <a href=""> </a></font> ,             ,  .      ,       .                     .     ,   . , -  . <br><br>   ,  <i>   </i> .      ,      ,    .      ;     ,    ;        .. <br><br>              .         ¬´¬ª     ,      .     ‚Ä¶ ‚Ä¶   ,        . </div><p>Source: <a href="https://habr.com/ru/post/193220/">https://habr.com/ru/post/193220/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../193204/index.html">PrivatBank accused Ukrainian programmer of hacking his Android application</a></li>
<li><a href="../193206/index.html">Autumn acceleration for web studios from NetCat</a></li>
<li><a href="../193208/index.html">Kickstarter became available to Canadians</a></li>
<li><a href="../193210/index.html">Google refused to remove The Pirate Bay homepage</a></li>
<li><a href="../193212/index.html">Integration of Java and 1C through the .Net framework on the example of Apache PDFBox</a></li>
<li><a href="../193222/index.html">Discussion of the project TZ open data portal</a></li>
<li><a href="../193224/index.html">Column ‚ÄúOthers‚Äù: about budget smartphones and local brands. Afterword</a></li>
<li><a href="../193226/index.html">Yandex added the ability to pay for a mobile phone directly through a search service.</a></li>
<li><a href="../193228/index.html">Installing FreeBSD 9.1 with root partition encryption</a></li>
<li><a href="../193230/index.html">Where are all the laptops on Android?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>