<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We pump Angular NGSW with the help of custom logic in the Service Worker</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Using Angular to create progressive web applications (PWA) 

 Angular is a great choice for developing PWA. Service Worker support has been included i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We pump Angular NGSW with the help of custom logic in the Service Worker</h1><div class="post__text post__text-html js-mediator-article"><h3>  Using Angular to create progressive web applications (PWA) </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hy/hl/z_/hyhlz_1h3txqguetqh3d0e1zcl0.png"></div><br>  Angular is a great choice for developing PWA.  Service Worker support has been included in Angular CLI since version 1.7.0 <a href="http://jakubcodes.pl/2018/02/22/building-progressive-web-app-using-angular-cli-5-minutes/">for a quick start on developing a PWA application</a> .  The Service Worker can be configured in the Angular application using the json configuration file, which provides many options and functions.  Although it sounds great, there is one big disadvantage to using the Angular Service Worker ‚Äî its logic cannot be extended in a standard way. <br><a name="habracut"></a><br><h3>  Why would you need to expand the capabilities of NGSW? </h3><br>  In my case, I needed to register a custom click notification event listener that would handle the click action of the push notification.  I have to admit that the Angular Service Worker does an excellent job with receiving and displaying push notifications - this part is processed by the ngsw-worker.js file without any effort from the developer.  And at first, it seemed that the only way to provide the work logic I needed was to make changes to the code of the generated ngsw-worker.js file when building the application.  But I understood that this method is bad - it needs to be maintained and checked every time you make any changes to the ngsw configuration file.  Fortunately, it turned out that the problem is easily solved by entering two additional files. <br><br><h3>  Decision </h3><br>  Let's start by creating two additional js files in the <i>/ src</i> folder. <br><br>  <b>sw-custom.js is the file containing the event listener:</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; self.addEventListener(<span class="hljs-string"><span class="hljs-string">'notificationclick'</span></span>, (event) =&gt; { event.notification.close(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'notification details: '</span></span>, event.notification); }); }());</code> </pre> <br>  <b>sw-master.js is a file that combines NGSW with our own logic:</b> <br><br><pre> <code class="javascript hljs">importScripts(<span class="hljs-string"><span class="hljs-string">'./ngsw-worker.js'</span></span>); importScripts(<span class="hljs-string"><span class="hljs-string">'./sw-custom.js'</span></span>);</code> </pre><br><h3>  Registration of assets </h3><br>  Having created new script files, we need to make sure that Angular takes them into account at build time.  From a technical point of view, these are assets that are similar to the favicon.ico file created by Angular CLI when creating a project.  We can register our additional resources in the angular.json file (.angular-cli.json for older Angular versions): <br><br><pre> <code class="javascript hljs">{ ..., <span class="hljs-string"><span class="hljs-string">"assets"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"src/favicon.ico"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/assets"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/manifest.json"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/sw-master.js"</span></span>, <span class="hljs-string"><span class="hljs-string">"src/sw-reminders.js"</span></span> ], ... }</code> </pre><br><h3>  Re-register Service Worker script </h3><br>  The last step is to change the entry point to the Service Worker, which Angular registered during application startup.  To do this, we need to change the ServiceWorkerModule.register entry in app.module.ts as follows: <br><br><pre> <code class="javascript hljs">ServiceWorkerModule.register(<span class="hljs-string"><span class="hljs-string">'/sw-master.js'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">enabled</span></span>: environment.production })</code> </pre><br><h3>  We summarize </h3><br>  That's all, after the production assembly of the application, our new script files will be copied to the <i>/ dist</i> folder and used by the application when registering the ServiceWorker.  If you want to see more, you can also look at my GitHub profile, where I posted <a href="https://github.com/jakubkaczmarek/reminders-demo/">an example of an Angular application with ServiceWorker</a> , supplemented by custom logic. </div><p>Source: <a href="https://habr.com/ru/post/435718/">https://habr.com/ru/post/435718/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435704/index.html">Architectural solutions for mobile games. Part 2: Command and their queues</a></li>
<li><a href="../435706/index.html">Use rcm to deploy the configuration to any folder</a></li>
<li><a href="../435708/index.html">Faial: a meeting place in the Atlantic</a></li>
<li><a href="../435712/index.html">Procter & Gamble has released a ‚Äúrejuvenating‚Äù skin printer</a></li>
<li><a href="../435714/index.html">Ukrainian developers have been given access to files from all Ring camcorders in the world.</a></li>
<li><a href="../435720/index.html">Adblock Radio Development</a></li>
<li><a href="../435722/index.html">NB-IoT, Narrow Band Internet of Things. Power saving modes and control commands</a></li>
<li><a href="../435724/index.html">Holding back the imperatives</a></li>
<li><a href="../435728/index.html">[Friday] Tale about how IT-sale of firewood tried to sell, or Baxtage of one tender</a></li>
<li><a href="../435730/index.html">Shell cracked</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>