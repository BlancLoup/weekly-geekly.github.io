<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Factory Method" in the development for Android. The best way to handle pushes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I would like to talk about one of the classic design patterns in Android development: the fabric method (Fabric method). We will study...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Factory Method" in the development for Android. The best way to handle pushes</h1><div class="post__text post__text-html js-mediator-article"><p>  In this article I would like to talk about one of the classic design patterns in Android development: the fabric method (Fabric method).  We will study it on the example of working with Firebase Cloud Messaging (hereinafter referred to as FCM).  The goal is to convey to beginner developers, who have not yet fully mastered the full benefits of OOP, the importance of using <a href="https://ru.wikipedia.org/wiki/Design_Patterns">object-oriented design techniques</a> , as we did in <a href="https://livetyping.com/ru/">Live Typing</a> </p><br><p><img src="https://habrastorage.org/web/ffa/618/604/ffa6186040714c0f9ea518a2f0512635.jpg" alt="image"></p><a name="habracut"></a><br><h2 id="pochemu-na-primere-fcm">  Why on example FCM? </h2><br><p>  FCM is one of the ready messaging services (the so-called push), which operates according to the publisher-subscriber model.  If you once again receive a notification on your device about a new message (news / discount / new product and many other things), then it is likely that this functionality is implemented through FCM or its equivalent.  At the moment, FCM is positioned by Google as a reference solution.  Therefore, the article is written on the basis that the reader is either already familiar with this service, or he will most likely be left with the opportunity to meet him. </p><br><h2 id="a-pochemu-imenno-pro-push-soobscheniya">  And why exactly about push-messages? </h2><br><p>  Writing a push message in an application using the <a href="https://goo.gl/bBLqR4">factory method</a> is a great excuse to deal with this template once and for all.  When designing UI objects or business logic objects, it is excusable for a beginner to make a mistake: do not envisage expanding the number of objects and / or not laying the possibility to easily change the logic of each of them.  But, as experience shows, handling of pushes is often complicated and expands throughout the entire project development period.  Imagine if you had to write VKontakte application.  The user receives a bunch of different notifications for pushing, which look differently and by pressing open different screens.  And if the module responsible for handling push notifications was initially designed incorrectly, then each new push is hello, new if else, hello, regression testing and you, new bugs, also hello. </p><br><h2 id="primer-proekta-s-ispolzovaniem-fcm">  Sample project using FCM </h2><br><h3 id="ideya">  Idea </h3><br><p>  Imagine a startup whose idea is to establish communication between kindergarten teachers and parents of children who attend this kindergarten.  A single application for teachers and parents is not suitable, because through the teacher application the content is created, and through the parent application it is consumed.  We take into account the third type of service users - the kindergarten administration.  They do not need a mobile application due to the fact that the main part of their working day is at their desk, but they need a convenient way to inform parents and caregivers about important news. </p><br><p>  Total: </p><br><ul><li>  mobile application for parents (the "parent"); </li><li>  mobile application for educators (hereinafter referred to as "teacher"); </li><li>  web application for the administration of the kindergarten (hereinafter the "admin"); </li></ul><br><h3 id="struktura-android-proekta">  The structure of the Android project </h3><br><p>  The project in Android Studio will have the following structure </p><br><p><img src="https://habrastorage.org/web/928/cc6/a51/928cc6a514d346f9a7dd19db82848c41.jpg" alt="image"></p><br><p>  The <em>core</em> module is common for two applications.  It contains the <em>parent</em> and <em>teacher</em> modules ‚Äî the modules of the parent and teacher applications, respectively. </p><br><p>  Tasks at the stage of connecting push notifications - show the notification to the user when the data on the server changes, regardless of whether the application is open to the user or not. <br>  For teacher and parent applications come different types of push.  Therefore, notifications can have different icons, and by clicking on the notification, different screens open. </p><br><h3 id="primery-notifikaciy">  Examples of notifications </h3><br><p>  For teacher applications: </p><br><ul><li>  a new student was added to the group (after adding a child in the admin panel); </li><li>  birthday of one of the children in the group. </li></ul><br><p>  For parent application: </p><br><ul><li>  the child received an assessment (after adding an assessment in the teacher's application); </li><li>  do not forget to take the child on a short day (push is initiated from the admin); </li></ul><br><h3 id="obrabotka-pushey">  Push processing </h3><br><p>  After all the preparatory work on the connection and setting up the work of FCM in the Android project, the processing of push notifications is reduced to the implementation of one class, the successor of <em>FirebaseMessagingService.</em> </p><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyFirebaseMessagingService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirebaseMessagingService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onMessageReceived</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RemoteMessage remoteMessage)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onMessageReceived(remoteMessage); } }</code> </pre> <br><p>  The FCM connection and setup is well written here: </p><br><p>  ‚Üí <a href="https://firebase.google.com/docs/cloud-messaging/android/client">Official documentation on connecting FCM to Android project</a> <br>  ‚Üí <a href="https://github.com/firebase/quickstart-android/tree/master/messaging">Repository with an example on the Firebase account</a> </p><br><p>  The <em>onMessageReceived ()</em> method accepts an object of the <em>RemoteMessage</em> class, which contains everything that the server sent: text and message header, Custom data Map, push notification time, and other data. </p><br><p>  There is one important condition.  If push was sent with text and a header for notification, then when the application is minimized or not started, the onMessageReceived () method will not work.  In this case, the firebase-messaging library will configure the notification itself from the parameters received on push and show it in the status bar.  The developer cannot influence this process.  But if you transfer all the necessary data (including the text and the title for notification) through the data object, then all messages will be processed by the <em>MyFirebaseMessagingService</em> class.  The code examples below imply the exact use of FCM.  All event information is passed in the data object. </p><br><p>  ‚Üí <a href="https://firebase.google.com/docs/cloud-messaging/concept-options">Learn more about the types of Firebase messages</a> </p><br><h3 id="problema">  Problem </h3><br><p>  So, if we didn't know anything about the design patterns, then the implementation of the task for the teacher's application would look something like this: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TeacherFirebaseMessagingService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirebaseMessagingService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_PUSH_TYPE = <span class="hljs-string"><span class="hljs-string">"type"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_PUSH_TITLE = <span class="hljs-string"><span class="hljs-string">"title"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_PUSH_CONTENT = <span class="hljs-string"><span class="hljs-string">"content"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TYPE_NEW_CHILD = <span class="hljs-string"><span class="hljs-string">"add_child"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TYPE_BIRTHDAY = <span class="hljs-string"><span class="hljs-string">"birthday"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String EMPTY_STRING = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> DEFAULT_NOTIFICATION_ID = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onMessageReceived</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RemoteMessage remoteMessage)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onMessageReceived(remoteMessage); Map&lt;String, String&gt; data = remoteMessage.getData(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.containsKey(KEY_PUSH_TYPE)) { NotificationCompat.Builder notificationBuilder; String notificationTitle = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.containsKey(KEY_PUSH_TITLE)) { notificationTitle = data.get(KEY_PUSH_TITLE); } String notificationContent = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.containsKey(KEY_PUSH_CONTENT)) { notificationContent = data.get(KEY_PUSH_CONTENT); } NotificationCompat.Builder builder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotificationCompat.Builder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); String pushType = data.get(KEY_PUSH_TYPE); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pushType.equals(TYPE_NEW_CHILD)) { builder.setSmallIcon(R.drawable.ic_add_child) .setContentTitle(notificationTitle != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ? notificationTitle : EMPTY_STRING) .setContentText(notificationContent != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ? notificationContent : EMPTY_STRING); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pushType.equals(TYPE_BIRTHDAY)) { <span class="hljs-comment"><span class="hljs-comment">// notificationBuilder = .... //         } NotificationManager notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE); notificationManager.notify(DEFAULT_NOTIFICATION_ID, builder.build()); } }</span></span></code> </pre><br><p>  The keys to get the title and content from the remoteMessage data are: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_TITLE = <span class="hljs-string"><span class="hljs-string">"title"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_CONTENT = <span class="hljs-string"><span class="hljs-string">"content"</span></span>;</code> </pre> <br><p>  Types of push for teacher applications: </p><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TYPE_NEW_CHILD = <span class="hljs-string"><span class="hljs-string">"add_child"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TYPE_BIRTHDAY = <span class="hljs-string"><span class="hljs-string">"birthday"</span></span>;</code> </pre> <br><p>  Of course, for each type of notification, you can make your own private method that would return an object of class <em>NotificationCompat.Builder.</em>  But if we recall the VK application with its large number of different notifications and a variety of actions when you click on them, the flaws in this class design are obvious: </p><br><ul><li>  In the example, there is no work with <em>PendingIntent</em> to implement the opening of different application screens by clicking on the notification.  Adding this functionality leads to an increase in code in the class. </li><li>  With each push of a separate type comes additional information inherent only to him.  It also needs to be extracted from <em>data</em> , processed and transferred to the application during the transition by pressing.  This code will be different for each type of notification, which will also significantly increase the size of our class. </li></ul><br><p>  With such an approach, a <em>TeacherFirebaseMessagingReceiver</em> class <em>object</em> in a matter of hours of development becomes a huge unruly <a href="https://en.wikipedia.org/wiki/God_object">god object</a> .  And the support of its code runs the risk of becoming a clot of pain even before the first release of the application.  And the most interesting thing is that something like that will have to be done in the parent application. </p><br><h3 id="reshenie">  Decision </h3><br><p>  Now about the implementation of this functionality in a more elegant way using the ‚ÄúFactory Method‚Äù pattern. </p><br><p>  The base class that is in the <em>core</em> module: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CoreFirebaseMessagingService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirebaseMessagingService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onMessageReceived</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RemoteMessage remoteMessage)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onMessageReceived(remoteMessage); } }</code> </pre> <br><p>  <em>CoreFirebaseMessagingService subclasses</em> will be registered in the manifests of the two application modules. </p><br><p>  Now let's design the <em>CoreNotification</em> object.  It will contain the implementation of the appearance of the notification in the status bar, depending on what type of push came. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CoreNotification</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_FROM_PUSH = <span class="hljs-string"><span class="hljs-string">"CoreNotification.FromNotification"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_TITLE = <span class="hljs-string"><span class="hljs-string">"title"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_CONTENT = <span class="hljs-string"><span class="hljs-string">"body"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String STRING_EMPTY = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> RemoteMessage remoteMessage; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CoreNotification</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RemoteMessage remoteMessage)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.remoteMessage = remoteMessage; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTitleFromMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Map&lt;String, String&gt; data = remoteMessage.getData(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.containsKey(KEY_TITLE)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.get(KEY_TITLE); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STRING_EMPTY; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getContentFromMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Map&lt;String, String&gt; data = remoteMessage.getData(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.containsKey(KEY_CONTENT)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.get(KEY_CONTENT); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STRING_EMPTY; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getTitleFromMessage(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getContent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getContentFromMessage(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> PendingIntent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configurePendingIntent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-meta"><span class="hljs-meta">@DrawableRes</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">largeIcon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNotificationTag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br><p>  The object takes in the constructor and stores the received <em>RemoteMessage</em> . <br>  All abstract methods will be overridden for specific notifications.  <em>STRING_EMPTY</em> may be needed in implementations, so we make it <em>protected</em> . </p><br><p>  If you follow the aforementioned book <a href="https://ru.wikipedia.org/wiki/Design_Patterns">, Object-Oriented Design Techniques.</a>  <a href="https://ru.wikipedia.org/wiki/Design_Patterns">Design Patterns ‚Äù</a> or, in my opinion, a very easy-to-understand book for Java developers <a href="https://www.ozon.ru/context/detail/id/20216992/">Design Patterns</a> , then <em>CoreNotification</em> should be an interface, not a class.  This approach is more flexible.  But then we would have to write code to get the <em>title</em> and <em>content</em> for each notification in all implementations of this interface.  Therefore, it was decided to avoid duplicating the code through an abstract class that contains the <em>getTitleFromMessage ()</em> and <em>getContentFromMessage ()</em> methods.  After all, these values ‚Äã‚Äãfor each push are extracted the same way (the <em>title</em> and <em>content</em> fields in <em>RemoteMessage.getData ()</em> will always be present, this is how the backend is implemented).  Just in case, these methods are left <em>protected</em> if the <em>title</em> and <em>content</em> for any notification will need to be obtained in another way. </p><br><p>  Next, we design the abstract class <em>CoreNotificationCreator</em> .  An object of this class will create and display notifications in the status bar.  He will work with the heirs of the <em>CoreNotification</em> class. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CoreNotificationCreator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_NOTIFICATION_TAG = <span class="hljs-string"><span class="hljs-string">"CoreNotificationCreator.TagKey"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String DEFAULT_TAG = <span class="hljs-string"><span class="hljs-string">"CoreNotificationCreator.DefaultTag"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_TYPE = <span class="hljs-string"><span class="hljs-string">"type"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> NotificationManager notificationManager; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CoreNotificationCreator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ notificationManager = ((NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showNotification</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, RemoteMessage remoteMessage)</span></span></span><span class="hljs-function"> </span></span>{ String notificationType = getNotificationType(remoteMessage); CoreNotification notification = factoryMethod(notificationType, remoteMessage); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (notification != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { NotificationCompat.Builder builder = builderFromPushNotification(context, notification); notify(builder); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNotificationType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RemoteMessage remoteMessage)</span></span></span><span class="hljs-function"> </span></span>{ Map&lt;String, String&gt; data = remoteMessage.getData(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.containsKey(KEY_TYPE)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.get(KEY_TYPE); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Nullable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> CoreNotification </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">factoryMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String messageType, RemoteMessage remoteMessage)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> DEFAULT_NOTIFICATION_ID = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-meta"><span class="hljs-meta">@DrawableRes</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> SMALL_ICON_RES_ID = R.drawable.ic_notification_small; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> NotificationCompat.<span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">builderFromPushNotification</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, CoreNotification notification)</span></span></span><span class="hljs-function"> </span></span>{ Bitmap largeIcon = BitmapFactory.decodeResource(context.getResources(), notification.largeIcon()); NotificationCompat.Builder builder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotificationCompat.Builder(context) .setSmallIcon(SMALL_ICON_RES_ID) .setAutoCancel(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) .setDefaults(NotificationCompat.DEFAULT_ALL) .setContentTitle(notification.getTitle()) .setContentText(notification.getContent()) .setLargeIcon(largeIcon); builder.getExtras().putString(KEY_NOTIFICATION_TAG, notification.getNotificationTag()); builder.setContentIntent(notification.configurePendingIntent(context)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> builder; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">notify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull NotificationCompat.Builder builder)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String notificationTag = getNotificationTag(builder); notificationManager.cancel(notificationTag, DEFAULT_NOTIFICATION_ID); notificationManager.notify(notificationTag, DEFAULT_NOTIFICATION_ID, builder.build()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNotificationTag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(NotificationCompat.Builder builder)</span></span></span><span class="hljs-function"> </span></span>{ Bundle extras = builder.getExtras(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (extras.containsKey(KEY_NOTIFICATION_TAG)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> extras.getString(KEY_NOTIFICATION_TAG); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DEFAULT_TAG; } } }</code> </pre> <br><p>  The <em>showNotification ()</em> method is the only <em>public</em> method.  We will call him when we receive new push to display notifications.  All other methods are an internal implementation of creating and displaying notifications. </p><br><p>  <a href="https://developer.android.com/guide/topics/ui/notifiers/notifications.html">Creating notifications in Android</a> </p><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showNotification</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, RemoteMessage remoteMessage)</span></span></span><span class="hljs-function"> </span></span>{ String notificationType = getNotificationType(remoteMessage); CoreNotification notification = factoryMethod(notificationType, remoteMessage); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (notification != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { NotificationCompat.Builder builder = builderFromPushNotification(context, notification); notify(builder); } }</code> </pre> <br><p>  In turn, <em>showNotification ()</em> defines the type of push that is contained in the <em>remoteMessage</em> data.  And then the push type and the remoteMessage object are passed to the <strong>factory method</strong> , which will create for us the necessary object of the <em>CoreNotification</em> class. </p><br><p>  <em>factoryMethod ()</em> <em>@Nullable</em> because a <em>push</em> type may come that the application knows nothing about.  In theory.  Insurance. </p><br><p>  So, the implementation of one class for two applications that works with push is ready.  The point remains: to implement for each application its specific NotificationCreator. </p><br><p>  Example from the teacher's application </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TeacherNotificationCreator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CoreNotificationCreator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TeacherNotificationCreator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(context); } <span class="hljs-meta"><span class="hljs-meta">@Nullable</span></span> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> CoreNotification </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">factoryMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String messageType, RemoteMessage remoteMessage)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (messageType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> NewChildNotification.TYPE: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NewChildNotification(remoteMessage); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> BirthdayNotification.TYPE: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BirthdayNotification(remoteMessage); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } }</code> </pre> <br><p>  In the factory method, the <em>messageType</em> variable determines which <em>CoreNotification</em> subclass will be returned. </p><br><p>  For example, for a teacher's application one of the types of notifications could be implemented as follows: </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewChildNotification</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CoreNotification</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TYPE = <span class="hljs-string"><span class="hljs-string">"add_child"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_CHILD_NAME = <span class="hljs-string"><span class="hljs-string">"child_name"</span></span>; NewChildNotification(RemoteMessage remoteMessage) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(remoteMessage); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> PendingIntent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configurePendingIntent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ Intent intent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(context, MainActivity.class) .setPackage(context.getApplicationContext().getPackageName()) .setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP | Intent.FLAG_ACTIVITY_CLEAR_TOP); intent.putExtra(CoreNotification.KEY_FROM_PUSH, getAddChildInfo()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> PendingIntent.getActivity(context, <span class="hljs-number"><span class="hljs-number">1</span></span>, intent, PendingIntent.FLAG_UPDATE_CURRENT); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">largeIcon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> R.drawable.ic_add_child; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNotificationTag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getClass().getName() + getChildName(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getChildName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Map&lt;String, String&gt; data = remoteMessage.getData(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.containsKey(KEY_CHILD_NAME)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.get(KEY_CHILD_NAME); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STRING_EMPTY; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAddChildInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"New child "</span></span> + getChildName() + <span class="hljs-string"><span class="hljs-string">" was added to your group"</span></span>; } }</code> </pre> <br><p>  The <em>configurePendingIntent ()</em> method is put into the implementation of a specific notification so that it remains possible to open different screens with parameters of a specific push message. </p><br><p>  Absolutely similar approach in the parent application: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ParentNotificationCreator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CoreNotificationCreator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ParentNotificationCreator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(context); } <span class="hljs-meta"><span class="hljs-meta">@Nullable</span></span> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> CoreNotification </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">factoryMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String messageType, RemoteMessage remoteMessage)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (messageType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> PickUpNotification.TYPE: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PickUpNotification(remoteMessage); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GradeNotification.TYPE: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GradeNotification(remoteMessage); <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } } }</code> </pre> <br><p>  Similar to the teacher application, unique notifications are created for the parent application with its implementation and its unique type. </p><br><p>  In <a href="https://github.com/alexeenkoff/android-fabric-method">this repository</a> you will find the source code of the project.  If you want to build it, you will need to create your own Firebase project.  The process is simple and free, and Android Studio simplifies it in many ways: <strong>Tools ‚Üí Firebase ‚Üí Cloud Messaging</strong> ‚Äî conveniently generating the necessary dependencies in Gradle scripts and setting up a firebase project from the studio.  And once again the <a href="https://firebase.google.com/docs/cloud-messaging/android/client">official step-by-step instructions</a> for adding FCM to the Android project </p><br><h2 id="chto-my-v-itoge-poluchili">  What we got in the end </h2><br><p>  When new push notifications are added to a specific application, the implementation of the heir of the abstract <em>CoreNotificationCreator</em> (in two lines) + is changed + a new class is created that implements the abstract <em>CoreNotification</em> .  In this case, the logic of forming and displaying existing notifications does not change.  The likelihood of implementing a new subclass of <em>CoreNotification</em> so that it somehow affects the work of the rest of the working functionality, tends to zero.  And each <em>CoreNotification</em> subclass independently decides: </p><br><ul><li>  what <em>largeIcon to</em> use for notification; </li><li>  what <em>intent</em> to open which activity; </li><li>  by overriding <em>getNotificationTag (),</em> it is possible to decide whether the notifications will replace each other or will be created for each notification of this class separately. </li></ul><br><p>  And the most valuable, in my opinion, is that if a customer wants to develop a new application for, for example, a kindergarten administrator, the implementation of push will not affect the work of the entire system of push notifications for him and reduces to inheritance and redefinition following the example of several classes. </p><br><h2 id="esche-raz-o-literature">  Once again about literature </h2><br><p>  A more detailed understanding of the ‚ÄúFactory Method‚Äù pattern and other classic design patterns will be given to you by the literature that has become ‚Äúdesktop‚Äù for the Android development department in <a href="https://livetyping.com/ru/">our company.</a> </p><br><ul><li>  Very understandable book <a href="https://www.ozon.ru/context/detail/id/20216992/">"Design Patterns"</a> .  Acquaintance with the topic of classical techniques in the PLO and with the factory method in particular.  I advise you to start with it, especially Android developers, because all the examples in Java </li><li>  <a href="https://ru.wikipedia.org/wiki/Design_Patterns">"Object-oriented design techniques. Design patterns"</a> .  Classic work.  No water only <del>  hardcore </del>  sober concise description of the pattern and an example implementation in C ++. </li></ul><br><h2 id="postskriptum">  P.S </h2><br><p>  To write at the end of an article about the usefulness of classical design patterns in a programmer‚Äôs work would be extremely trite.  I would even say went.  Surely on Habr√© this utility has already been proved dozens of times.  But I hope that the application example in the development for a specific platform will be useful for Android-juniors in this difficult, but exciting business. </p><br><p>  The choice of a specific design pattern for the implementation of a specific task is a topic for heated discussion.  So welcome to the comments.  Bye everyone! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/332006/">https://habr.com/ru/post/332006/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331994/index.html">Ruining people not beer</a></li>
<li><a href="../331996/index.html">Rasking through the parts of a particularly hardy iron bullion S line, where 768 GB of RAM</a></li>
<li><a href="../331998/index.html">Using Python and Excel to process and analyze data. Part 2: libraries for working with data</a></li>
<li><a href="../332000/index.html">Autoencoders in Keras, Part 5: GAN (Generative Adversarial Networks) and tensorflow</a></li>
<li><a href="../332004/index.html">Savings on matches or data recovery from the grating HDD Seagate ST3000NC002-1DY166</a></li>
<li><a href="../332008/index.html">Retrospective. 10 years of Yota and 10 interesting facts about the company</a></li>
<li><a href="../332012/index.html">NetApp HCI is the new generation hyperconvergent system for working with data</a></li>
<li><a href="../332016/index.html">‚ÄúIt is important to prioritize‚Äù: about testing at Sberbank Technologies</a></li>
<li><a href="../332018/index.html">How we unify analytic work in CUSTIS</a></li>
<li><a href="../332020/index.html">JavaScript: Many Faces Functions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>