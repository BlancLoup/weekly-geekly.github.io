<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Solving the picture from the Intel company Twitter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is a horror story with an incredible number of underscores, lambdas and an extremely rare __import__ function: 



 What kind of beast and what ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Solving the picture from the Intel company Twitter</h1><div class="post__text post__text-html js-mediator-article">  There is a horror story with an incredible number of underscores, lambdas and an extremely rare __import__ function: <br><br><img src="https://habrastorage.org/files/8b9/272/b21/8b9272b21bed4e24bbf3874b3520fae9.png"><br><br>  What kind of beast and what does he do? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Of course, we can, like normal people, retype the code into the interpreter and see what happens.  But since the time is long past midnight, it's more interesting to deal with your hands. <br><a name="habracut"></a><br>  The code will still have to be rewritten.  If you are afraid of succumbing to the temptation to launch - write better on a piece of paper. <br><br>  So, to begin with, we will try to display all this without devilish tilting, while we will try (as far as possible) to make the text readable: <br><br><pre><code class="python hljs">getattr( __import__(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>.__class__.__name__[<span class="hljs-number"><span class="hljs-number">1</span></span>] + [].__class__.__name__[<span class="hljs-number"><span class="hljs-number">2</span></span>]), ().__class__.__eq__.__class__.__name__[:<span class="hljs-number"><span class="hljs-number">2</span></span>] + ().__iter__().__class__.__name__[<span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>] ) ( <span class="hljs-number"><span class="hljs-number">1</span></span>, ( <span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> _, __: _(_, __) )( <span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> _, __: chr(__ % <span class="hljs-number"><span class="hljs-number">256</span></span>) + _(_, __ // <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">882504235958091178581291885595786461602115</span></span> ) )</code> </pre> <br>  We are far from PEP8, and it‚Äôs not worth sending a review to the code yet, but it‚Äôs already much better. <br><br>  There is a getattr, so the first brackets "return" the function to us, and the second will be a list of arguments. <br>  The first argument getattr takes an object, the second an expected attribute.  Let's start with the object. <br><br>  In fact, the __import__ function is what the familiar ‚Äúfrom X import Y as Z‚Äù turns into.  The function is very rare and you will not meet its use in a ‚Äúcombat‚Äù situation at every corner.  You can learn more about its device in the <a href="https://docs.python.org/2/library/functions.html">documentation</a> , but to speed up the process, we will declare that in our case this function is similar to the expression: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>.__class__.__name__[<span class="hljs-number"><span class="hljs-number">1</span></span>] + [].__class__.__name__[<span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ().__class__.__eq__.__class__.__name__[:<span class="hljs-number"><span class="hljs-number">2</span></span>] + ().__iter__().__class__.__name__[<span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>])</code> </pre><br>  The first part is simple - we go up the stairs.  For the needs of True and False in python there is a special type of ‚Äúbool‚Äù, and this is what the __class __.__ name__ chain will give us back.  Take the first element, it will be the letter "o". <br>  The search for the second letter is not much harder - [] is a list, the list is ‚Äúlist‚Äù, ‚Äúlist‚Äù [2] is ‚Äús‚Äù. <br>  The first part of the mini-puzzle is successfully solved: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ().__class__.__eq__.__class__.__name__[:<span class="hljs-number"><span class="hljs-number">2</span></span>] + ().__iter__().__class__.__name__[<span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>])</code> </pre><br>  We deal with the second part.  "()" is a tuple, i.e.  tuple, __eq__ is the "magic" wrapper for the comparison operator "==".  Here we first come to a known substance, if we think that "== .__ class__" is some kind of "function".  In reality, this is a wrapper_descriptor that no one would have noticed in another case, but here it is very important.  Unfortunately, I am not privy to the secret of class naming for embedded magic methods, so we hope for its disclosure in the comments.  Take the ‚Äúwrapper_descriptor‚Äù [: 2] cut, get ‚Äúwr‚Äù. <br><br>  Then you can not understand, because the module "os" has only one method, starting with "wr" and this, obviously, write. <br>  You can do the analysis of the second part of this word on your own, nothing complicated. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> write</code> </pre><br>  As we found out earlier, now we have to call the write function with not very clear arguments. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> write write(<span class="hljs-number"><span class="hljs-number">1</span></span>, ( <span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> _, __: _(_, __) ) ( <span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> _, __: chr(__ % <span class="hljs-number"><span class="hljs-number">256</span></span>) + _(_, __ // <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">882504235958091178581291885595786461602115</span></span> ) )</code> </pre><br>  The first argument should go to the descriptor in which we are going to write.  In our case, this is 1, and this is ... stdout!  Simply put, our os.write will work like print. <br><br>  Then the following happens: the first anonymous function is wrapped in parentheses, which means it is called here. <br><br>  To better understand what she is doing, we will write it down as an ordinary method, after thinking a little about the contents. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> _, __: _(_, __)</code> </pre><br>  We take two arguments, then the __call__ method is called first.  It is logical to assume that the first argument is a function, then: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function_one</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inner, argument)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> inner(inner, argument)</code> </pre><br>  Nothing happens except for ‚Äúforwarding‚Äù the arguments to the function passed to us by the first parameter.  What is this feature? <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> _, __: chr(__ % <span class="hljs-number"><span class="hljs-number">256</span></span>) + _(_, __ // <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>,</code> </pre><br>  We see the chr method, therefore, we convert the number to a symbol.  Let's rewrite humanly: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function_two</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inner, ordC)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ordC: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> chr(ordC % <span class="hljs-number"><span class="hljs-number">256</span></span>) + inner(inner, ordC // <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span></code> </pre><br>  Carefully looking at these things, we realize that the following happens: we take a number, divide it with the remainder by 256, save the remainder as a symbol, and recursively pass the partial until the number is less than 256 (i.e. // 256 == 0).  Not so cunning. <br><br>  The huge number we give is written above.  Since we have dealt with everything, let's try to put it all together and write something similar on a human python. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> write <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">recursive_print</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(number)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> number: write(<span class="hljs-number"><span class="hljs-number">1</span></span>, chr(number % <span class="hljs-number"><span class="hljs-number">256</span></span>)) recursive_print(number // <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> recursive_print(<span class="hljs-number"><span class="hljs-number">882504235958091178581291885595786461602115</span></span>)</code> </pre><br>  And although in Russia another day is set aside for mother's day, this advice is worth following. </div><p>Source: <a href="https://habr.com/ru/post/257757/">https://habr.com/ru/post/257757/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../257745/index.html">This is not forgotten - Oracle Database In-Memory</a></li>
<li><a href="../257747/index.html">Super-fast start with Arduino: you take and do</a></li>
<li><a href="../257749/index.html">PhoneGap for iOS and Android application development infrastructure</a></li>
<li><a href="../257751/index.html">Is it possible to combine unit tests and memory profiling?</a></li>
<li><a href="../257753/index.html">Forward to victory: PHDays V competition program published</a></li>
<li><a href="../257761/index.html">SAP HANA Cloud Platform: Download and Store Data</a></li>
<li><a href="../257763/index.html">Generating a QR code in the format of a machine embroidery file Tajima DST</a></li>
<li><a href="../257767/index.html">Referrer spam in google analytics and how to deal with it</a></li>
<li><a href="../257769/index.html">Online voting is one step closer thanks to a breakthrough in security technology</a></li>
<li><a href="../257771/index.html">Airbnb-flavored Aviasales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>