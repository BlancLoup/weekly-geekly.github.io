<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>[Crowd mower] - a lawn mower that anyone can control via the Internet</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Do you have a moment? Could you mow my lawn? 
 A brief history of development on the knee of a lawnmower robot. You can manage it from anywhere in the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>[Crowd mower] - a lawn mower that anyone can control via the Internet</h1><div class="post__text post__text-html js-mediator-article"><h2>  Do you have a moment?  Could you mow my lawn? </h2><br>  A brief history of development on the knee of a lawnmower robot.  You can manage it from anywhere in the world via the Internet.  Dreamed of feeling like an operator of a rover or a lunar rover?  Just need to go to the site <a href="http://mowmylawn.ru/">mowmylawn.ru</a> and you can control the lawn mower in my yard! <br><br><img src="https://habrastorage.org/files/dca/b92/ad1/dcab92ad1e5f47e5885ed6b7249b087b.jpg"><br><a name="habracut"></a><br><br><h2>  Prehistory </h2><br>  The whole story of lawn mowers began in the summer of 2015, <a href="https://geektimes.ru/post/261248/">my first post on the GT</a> was just about my experience in implementing a mower from what was in the garage. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Tv</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/_a-vWxjX6v4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/FPe58BjsxsI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  After that, <a href="https://geektimes.ru/company/robogazon/blog/262370/">representatives of the company Robomow offered to use</a> their platform for further development.  This is very convenient, because all questions on hardware and mechanics require special skills and take a very long time. <br><br>  I really wanted to organize a competition for <a href="https://geektimes.ru/company/robogazon/blog/261930/">lawn mowers</a> .  As it turned out, this is not an easy matter.  More than 15 teams were registered, but in the end only three participants showed the progress of the work. <br><br><div class="spoiler">  <b class="spoiler_title">Roman Sakovich, Minsk (Belarus), 'Belmower'</b> <div class="spoiler_text">  Chassis: three-wheeled robot.  Two driving wheels, one free. <br><br>  Electronics: Two boards.  Raspberrry Pi - as a top-level control system.  Its tasks include route planning, trajectory construction, and so on.  Nucleo stm32 - as an executive system of the lower level.  Its tasks include navigation, sensor polling, motor control, etc. <br><br>  Navigation: A system for the integration of data RTK, odometers and ins.  This is a proprietary system. <br><br>  Sensors: GPS / GLONASS navigation receivers.  Encoder motors for odometry.  Inertial navigation system.  Ultrasonic sensors. <br><img src="https://habrastorage.org/files/826/b98/f62/826b98f62d7f47ceaa764fd8b27fd800.jpg"><br><img src="https://habrastorage.org/files/40b/f88/52a/40bf8852aec7489b8a314958e9794768.jpg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Feofanov I.A., Tver</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/203/591/4fd/2035914fd5aa4740a74d674d4c952e38.JPG"><br><br>  Unfortunately, I must inform you that our team will most likely not be able to take part in the competition.  The fact is that during the first field tests in the design of our robot, certain shortcomings were identified, which will take some time to correct.  We are not going to suspend the work on the project, but against the background of the upcoming session, we can hardly even present the minimum version of the robot by the target date (let alone the use of machine learning, which was to become our strong advantage). <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Nikolay Mironnikov, Novosibirsk</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b78/29d/e4e/b7829de4e601482e9e61719c86414a3f.jpg"><br></div></div><br><br>  All efforts to hold the contest in Skolkovo were in vain.  In the end, it turned out that there is no free lawn for the robotics competition in Skolkovo.  All possible sponsors do not want to get involved in a new competition with unclear prospects.  I did not even get an answer to the letters to the municipal organizations.  As a result, we had a vague perspective to organize a competition for 4 participants from different cities.  Although the competition turned out to be international, it was still more expedient to cancel it, as it is not a pity. <br><br><h2>  RoboKosilka 2016. ROS &amp; FUN </h2><br>  I master ROS and write a robotic mower launcher, I use Kinect and SLAM, only on visual odometry the robot builds a map and paves the route.  Kinect does not work well in sunny weather.  With ROS you will do ‚ÄúHello World!‚Äù In one evening, and then darkness.  I never found a normal guide for a beginner how to make a robot, and not just write in topics.  Has anyone wondered why there is not a single point in the RF <a href="http://www.ros.org/is-ros-for-me/">on the map of the ROS community</a> ?  I opened <a href="https://vk.com/robotoperating">a VK group</a> . <br><img src="https://habrastorage.org/files/aaf/2e6/7b0/aaf2e67b0baa4e3ba3a3d65ac7b7bd37.jpg"><br><br>  In his spare time he screwed two servo drives, an ultrasonic sensor, and an Arduino to his workhorse.  A simple test of driving around a birch and stopping!  And then the abyss, this thing is dangerous just to let on your site!  You can't even kick her like robots, you know how. <br><iframe width="560" height="315" src="https://www.youtube.com/embed/u4QAbadOLHg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  It turns out robots - things are quite boring in the understanding of most people, especially service robots.  Yes, I know about the great friendship between vacuum cleaning robots and robots.  I know about super creations from Boston Dynamics, Darpa and the Russian combat robot avatar, it‚Äôs more like robots than a box in which some algorithm interacts with the real world. <br><br>  In the sense of my daughter, robots are at least transformers, and not the eruda that I spend time on.  I made a difficult decision and ‚Äútemporarily‚Äù made a robot on a bluetooth-controlled robot. <br><br><img src="https://habrastorage.org/files/8b4/314/aec/8b4314aecf1f4a13a983d6a52e8d8427.jpg"><br><br>  Management works the same as the <a href="https://geektimes.ru/company/robogazon/blog/268484/">snow blower</a> .  It turned out to be fun!  Especially for dad. <br><iframe width="560" height="315" src="https://www.youtube.com/embed/oQ6v5Jd4uQY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><div class="spoiler">  <b class="spoiler_title">Video with a snow blower</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/0u_1g_D57QY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OxPDwe7y-F4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br><br>  Further more!  I was interested in the idea of ‚Äã‚Äãimplementing control not on bluetooth, but via the Internet, with telemetry.  Bored, fresh and beaten up idea! <br><br>  And what if you give an opportunity to any Internet user to control my lawn mower?  Do you know such ideas that are then hard to get out of your head?  It was just like that ... <b>Challenge accepted!</b> <br><br><h2>  Crow mower </h2><br><br><h3>  Iron </h3><br><br><img src="https://habrastorage.org/files/242/4c5/4f7/2424c54f7ebe46febdfc58a66aaa005d.jpg"><br><br>  Raspberry pi, USB hub, wifi adapter, webcam are neatly added to the magic box. <br>  From the interesting moments on the gland.  I did not have a driver with the necessary characteristics for the engines.  Usually, H-bridge for field-effect transistors or (hardcore) for a relay is used as a driver.  I choose a tougher option, because the relays were available. <br><br><img src="https://habrastorage.org/files/8ab/53d/b87/8ab53db87cd64b3fae2a87bb50b348e0.jpg"><br><br>  The usual connection scheme implies 4 keys for each engine, i.e.  8 to 2 running engines. <br><br><img src="https://habrastorage.org/files/8db/37a/3d7/8db37a3d7b9b4c97be8ccad3cf52d197.jpg"><br><br>  Given that you can also use the normally open state of the relay, as well as the fact that there is no need to set the motors in motion separately, you can get by with just 5 relays for two running motors. <br><br>  In addition to the robot itself, a camera is installed on the house, which with a frequency of 3 frames / sec.  Uploads an overview photo of the site to the ftp server on the Internet for better orientation.  But afterwards I simply replaced it with a solution from ivideon. <br><br><h3>  Program </h3><br>  As before, the Arduino receives a single-character message over the serial port that indicates the desired action.  Also for testing and debugging, the codes received from raspberry are sent via bluetooth, you can connect the phone in terminal mode and receive data from the server also on the phone. <br><br><div class="spoiler">  <b class="spoiler_title">Sketch Arduino</b> <div class="spoiler_text"><pre><code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">int</span></span> m1=<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> m1b=<span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> m2=<span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> m2b=<span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> mk=<span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> pis=<span class="hljs-number"><span class="hljs-number">7</span></span>; <span class="hljs-type"><span class="hljs-type">char</span></span> a,b; <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">9600</span></span>); Serial1.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">9600</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!<span class="hljs-type"><span class="hljs-type">Serial</span></span>) { ; // wait <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">serial</span></span> port <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span>. Needed <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Leonardo <span class="hljs-keyword"><span class="hljs-keyword">only</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!Serial1) { ; // wait <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">serial</span></span> port <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span>. Needed <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Leonardo <span class="hljs-keyword"><span class="hljs-keyword">only</span></span> } <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("Start"); pinMode(statpin, OUTPUT); pinMode(m1, OUTPUT); pinMode(m1b, OUTPUT); pinMode(m2, OUTPUT); pinMode(m2b, OUTPUT); pinMode(mk, OUTPUT); pinMode(pis, OUTPUT); analogWrite(pis, <span class="hljs-number"><span class="hljs-number">1000</span></span>); delay(<span class="hljs-number"><span class="hljs-number">100</span></span>); analogWrite(pis, <span class="hljs-number"><span class="hljs-number">700</span></span>); delay(<span class="hljs-number"><span class="hljs-number">200</span></span>); analogWrite(pis, <span class="hljs-number"><span class="hljs-number">300</span></span>); delay(<span class="hljs-number"><span class="hljs-number">300</span></span>); analogWrite(pis, <span class="hljs-number"><span class="hljs-number">1000</span></span>); delay(<span class="hljs-number"><span class="hljs-number">100</span></span>); analogWrite(pis, <span class="hljs-number"><span class="hljs-number">100</span></span>); digitalWrite(pis, HIGH); digitalWrite(statpin, LOW); digitalWrite(m1, LOW); digitalWrite(m1b, LOW); digitalWrite(m2, LOW); digitalWrite(m2b, LOW); digitalWrite(mk, LOW); digitalWrite(pis, HIGH); } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>() // run <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-type"><span class="hljs-type">Serial</span></span>.available()){ a=<span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>(); Serial1.println(a); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a==<span class="hljs-string"><span class="hljs-string">'B'</span></span>){ digitalWrite(m1, HIGH); digitalWrite(m1b, LOW); digitalWrite(m2, HIGH); digitalWrite(m2b, LOW); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a==<span class="hljs-string"><span class="hljs-string">'F'</span></span>){ digitalWrite(m1, HIGH); digitalWrite(m1b, HIGH); digitalWrite(m2, HIGH); digitalWrite(m2b, HIGH); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a==<span class="hljs-string"><span class="hljs-string">'R'</span></span>){ digitalWrite(m1, HIGH); digitalWrite(m1b, LOW); digitalWrite(m2, HIGH); digitalWrite(m2b, HIGH); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a==<span class="hljs-string"><span class="hljs-string">'L'</span></span>){ digitalWrite(m1, HIGH); digitalWrite(m1b, HIGH); digitalWrite(m2, HIGH); digitalWrite(m2b, LOW); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a==<span class="hljs-string"><span class="hljs-string">'S'</span></span>){ digitalWrite(m1, LOW); digitalWrite(m1b, LOW); digitalWrite(m2, LOW); digitalWrite(m2b, LOW); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a==<span class="hljs-string"><span class="hljs-string">'W'</span></span>){ digitalWrite(mk, HIGH); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a==<span class="hljs-string"><span class="hljs-string">'w'</span></span>){ digitalWrite(mk, LOW); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a==<span class="hljs-string"><span class="hljs-string">'V'</span></span>){ digitalWrite(pis, LOW); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a==<span class="hljs-string"><span class="hljs-string">'v'</span></span>){ digitalWrite(pis, <span class="hljs-number"><span class="hljs-number">700</span></span>); } }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ } }</code> </pre> <br></div></div><br><br>  Two python scripts work on raspberry.  One of the scripts with the help of opencv captures video from a webcam installed on the rover and uploads it via ftp to the server.  Also, with some probability, the photo along with the random message from the list is loaded into the <a href="https://twitter.com/robogazon">twitter account</a> . <br><br><div class="spoiler">  <b class="spoiler_title">First script</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pygame <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pygame.camera <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pygame.locals <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> twython <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Twython <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ftplib pygame.init() pygame.camera.init() cam = pygame.camera.Camera(<span class="hljs-string"><span class="hljs-string">"/dev/video0"</span></span>,(<span class="hljs-number"><span class="hljs-number">550</span></span>,<span class="hljs-number"><span class="hljs-number">400</span></span>)) cam.start() CONSUMER_KEY = <span class="hljs-string"><span class="hljs-string">'-------MBZDT1PwibFeIcSp'</span></span> CONSUMER_SECRET = <span class="hljs-string"><span class="hljs-string">'-----------------1ZGHgBRz6aEr4YhUVuO84CuEV'</span></span> ACCESS_KEY = <span class="hljs-string"><span class="hljs-string">'-----------------4MCjSkny9Y6rJj5I32ulXctISQF'</span></span> ACCESS_SECRET = <span class="hljs-string"><span class="hljs-string">'------------------------cDadRY3He5Kv6CXVuqy2Dh'</span></span> api = Twython(CONSUMER_KEY,CONSUMER_SECRET,ACCESS_KEY,ACCESS_SECRET) api.verify_credentials() host = <span class="hljs-string"><span class="hljs-string">"-.--.---.196"</span></span> ftp_user = <span class="hljs-string"><span class="hljs-string">"ftp_user"</span></span> ftp_password = <span class="hljs-string"><span class="hljs-string">"ftp_password"</span></span> con = ftplib.FTP(host, ftp_user, ftp_password) con.cwd(<span class="hljs-string"><span class="hljs-string">"/mowmylawn.ru/webcam"</span></span>) a={<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-string"><span class="hljs-string">' !   !'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-string"><span class="hljs-string">'  .   !'</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-string"><span class="hljs-string">'     ...    '</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>:<span class="hljs-string"><span class="hljs-string">'      ?'</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>:<span class="hljs-string"><span class="hljs-string">',   !'</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-string"><span class="hljs-string">'  ,        :)) !'</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>:<span class="hljs-string"><span class="hljs-string">', ... !'</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-string"><span class="hljs-string">' ,     .'</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>:<span class="hljs-string"><span class="hljs-string">'  :  -  '</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span>:<span class="hljs-string"><span class="hljs-string">'  ‚Äî  ,    ...'</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-string"><span class="hljs-string">'    :    ?'</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>:<span class="hljs-string"><span class="hljs-string">'  '</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>:<span class="hljs-string"><span class="hljs-string">'-,   '</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-string"><span class="hljs-string">' -  ,         .'</span></span>,<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-string"><span class="hljs-string">'‚Äî     ! ‚Äî ,    !'</span></span>,<span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-string"><span class="hljs-string">',   ! ...:(((!'</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-string"><span class="hljs-string">'  ? robogazon.ru'</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>:<span class="hljs-string"><span class="hljs-string">' ,    !'</span></span>} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">twit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> image = cam.get_image() pygame.image.save(image,<span class="hljs-string"><span class="hljs-string">'webcam.jpg'</span></span>) photo = open(<span class="hljs-string"><span class="hljs-string">'webcam.jpg'</span></span>,<span class="hljs-string"><span class="hljs-string">'rb'</span></span>) b = random() * (len(a)<span class="hljs-number"><span class="hljs-number">-1</span></span>) b = int(round(b,<span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-comment"><span class="hljs-comment">#api.upload_media(media=photo) #api.update_status(status=a[b]) api.update_status_with_media(media=photo, status=a[b]) def ftpimg(): image = cam.get_image() pygame.image.save(image,'webcam.jpg') photo = open('webcam.jpg','rb') send = con.storbinary("STOR "+ 'webcam.jpg', photo) while 1 : ftpimg() b = random() * (500) b = int(round(b,0)) if b==107: twit() con.close</span></span></code> </pre><br></div></div><br><br>  The second http script receives the current command for the action on the server and sends this command by serial to arduino. <br><ul><li>  "S" - stop </li><li>  "F" - forward </li><li>  "B" - back </li><li>  "L" - left </li><li>  ‚ÄúR‚Äù - right </li><li>  ‚ÄúW‚Äù - enable mowing engines </li><li>  ‚ÄúW‚Äù - turn mowing engines off </li><li>  "V" - turn on the signal </li><li>  "V" - turn off the signal </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Second script</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> serial,time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib3 http = urllib3.PoolManager() ser = serial.Serial(<span class="hljs-string"><span class="hljs-string">"/dev/ttyUSB0"</span></span>,<span class="hljs-number"><span class="hljs-number">9600</span></span>) ser.writelines(<span class="hljs-string"><span class="hljs-string">"S"</span></span>); olddata=<span class="hljs-number"><span class="hljs-number">0</span></span> countolddata=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> : r = http.request(<span class="hljs-string"><span class="hljs-string">'GET'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://mowmylawn.ru/1.php'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> r.data!=olddata: olddata=r.data countolddata=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: countolddata+=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> countolddata&gt;<span class="hljs-number"><span class="hljs-number">20</span></span>: ser.writelines(<span class="hljs-string"><span class="hljs-string">"S"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: ser.writelines(r.data) ser.close() con.close</code> </pre><br></div></div><br><br><h3>  Web service </h3><br>  On the bootstrap I covered the page.  The page has two .jpg files that are updated as they are downloaded.  There are a lot of factors influencing delays in control and telemetry, this is your connection speed, and the channel on the server, and the channel in my home. <br><br><div class="spoiler">  <b class="spoiler_title">Update code .jpg</b> <div class="spoiler_text"><pre> <code class="javascript hljs">&lt;script&gt; setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> im1=<span class="hljs-string"><span class="hljs-string">'http://mowmylawn.ru/webcam/webcam.jpg?s='</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> im2=<span class="hljs-string"><span class="hljs-string">'http://kosmos-podolsk.ru/webc1.jpg?s='</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tmpImg = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image() ; tmpImg.src = im1 ; tmpImg.onload = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#w1dd"</span></span>).attr(<span class="hljs-string"><span class="hljs-string">'src'</span></span>,im1 ); } ; tmpImg.src = im2 ; tmpImg.onload = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#w2dd"</span></span>).attr(<span class="hljs-string"><span class="hljs-string">'src'</span></span>,im2 ); } ; }, <span class="hljs-number"><span class="hljs-number">200</span></span>); <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br></div></div><br><br>  The maximum update rate that I managed to achieve: <br><ul><li>  rover camera 4 Hz; </li><li>  camera on the house 3 Hz. </li></ul><br>  The Mysql database consists of 2 tables, one key / value pair is stored in the first one, this is the command for the robot.  The second table is users. <br>  When you queue up on the site - ajax get request is sent to add a user, a record is recorded in the database with the timestamp mark, your ip and the generated key for management. <br><br>  Only one person can drive the mower at a time (except for me) - this is the user with the smallest timestamp.  When it is your turn and you start to control the mower - put the timestamp of the start of control into the base, each control is 60 seconds. <br><br><img src="https://habrastorage.org/files/a92/7ad/47c/a927ad47c8b34bac8a5bfb9e14d4c0cc.jpg"><br><br>  Every time when you hover on the control buttons, an ajax get request is sent with the command and your key to control, while checking the difference between the current time and the time when you started the ‚Äúgame‚Äù, if the difference is more than 60 seconds, the game ends for you, your recording removed from the base and you can stand in line again, the ‚Äúgame‚Äù moves to the next player. <br><br><h2>  Promo video </h2><br><iframe width="560" height="315" src="https://www.youtube.com/embed/kT3NA7z8Ju4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><div class="spoiler">  <b class="spoiler_title">Then I think it is necessary to remove it in English ... and then Ostap suffered.</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/PcCixd2h2ZU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/45hP0N1Qipo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zstGDgOpIl0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tsG5JcE_ZR8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Xl5Kj5gtFjg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/2HEdHothF3g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br><br>  My first post on <a href="https://redd.it/531lul">reddit</a> .  Try management <a href="http://mowmylawn.ru/">mowmylawn.ru</a> .  In the case of a large queue or habraeffekt - please understand and forgive. <br><br>  PS: On the forget that you can take part <a href="https://geektimes.ru/post/279986/">in a joint project to develop a fitness tracker for shock sports KickBrick</a> .  <b>The team is waiting for you!</b> <br><br>  UPD: I had three problems, two already solved. <br>  1) With too active maneuvers, the power cable for the ~ 27V running engines was disconnected and one of the engines did not move forward. <br>  2) Apparently, the wi-fi adapter burned out due to the same wire <br>  3) A large number of users with GT and reddit first led to a queue of more than 1000 users, then the server crashed.  Optimization is our everything! <br><br>  UPD: I had to replace the arduino and clean the queue.  You can try. <br><br>  UPD: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/QAvglRWCips" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/VJQVbSVczp8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/397391/">https://habr.com/ru/post/397391/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../397381/index.html">A small overview of the Saleae Logic Pro 8 and DreamSourceLab DSLogic Pro logic analyzers</a></li>
<li><a href="../397383/index.html">Fila found</a></li>
<li><a href="../397385/index.html">Testing multimeters as well as measurement errors</a></li>
<li><a href="../397387/index.html">Human blood laser</a></li>
<li><a href="../397389/index.html">VimpelCom Ltd. officially confirmed the resignation of Beeline CEO Mikhail Slobodin</a></li>
<li><a href="../397393/index.html">Goodbye Roaming - Hello, –°wSim</a></li>
<li><a href="../397397/index.html">Physics at the limit of the universe</a></li>
<li><a href="../397399/index.html">MIT terahertz scanner reads closed books and sealed letters</a></li>
<li><a href="../397401/index.html">How the Cardberry loyalty card aggregator works</a></li>
<li><a href="../397403/index.html">SLO: film camera, fully printed on a 3D printer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>