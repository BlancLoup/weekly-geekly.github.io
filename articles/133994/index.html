<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a PostgreSQL Load Tester</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The idea of ‚Äã‚Äãthis project (namely ‚Äúproject‚Äù) arose spontaneously. The company uses memory-DB TimesTen, contains one big table with data, more than 15...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a PostgreSQL Load Tester</h1><div class="post__text post__text-html js-mediator-article">  The idea of ‚Äã‚Äãthis project (namely ‚Äúproject‚Äù) arose spontaneously.  The company uses memory-DB TimesTen, contains one big table with data, more than 150 million records, and a volume of about 15 gigs.  TimesTen always worked properly, the answer for any request received in milliseconds, it suited everyone.  One day, the T10 began to respond to requests for a very long time, the response time increased to 3-5 seconds.  TechPod course began to work on finding a problem, but at the same time we wondered why T10 was used at all, why can't the database be transferred to a regular Oracle or Postgres RDBMS? <a name="habracut"></a>  It was necessary to find out to conduct the appropriate tests.  As a result, having rummaged a little on the Internet, the necessary free software for testing was not found.  As a result, a small console utility was written on the ‚Äúknees‚Äù day that would measure the response time from the DBMS for different types of queries, collect statistics, and in addition it would also be multi-threaded so that the load tests were the most objective. <br><br>  The Postgres DBMS was selected for testing, a table with the appropriate structure was created in the database, and the optimal indices were built: <br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">"public"</span></span>.<span class="hljs-string"><span class="hljs-string">"numbers"</span></span> ( <span class="hljs-string"><span class="hljs-string">"contract"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">"account"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">"number"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">"system_id"</span></span> int2 <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">"region_id"</span></span> int2 <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">"storage_id"</span></span> int2 <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> <span class="hljs-string"><span class="hljs-string">"ix_contract"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"public"</span></span>.<span class="hljs-string"><span class="hljs-string">"numbers"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> btree (<span class="hljs-string"><span class="hljs-string">"contract"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNIQUE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> <span class="hljs-string"><span class="hljs-string">"ix_number"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"public"</span></span>.<span class="hljs-string"><span class="hljs-string">"numbers"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> btree (<span class="hljs-string"><span class="hljs-string">"number"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> <span class="hljs-string"><span class="hljs-string">"ix_account"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"public"</span></span>.<span class="hljs-string"><span class="hljs-string">"numbers"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> btree (<span class="hljs-string"><span class="hljs-string">"account"</span></span>);</code> </pre> <br><br>  The filling of the table was done through a procedure (the time to fill out 100 million records was 7 hours): <br><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> <span class="hljs-string"><span class="hljs-string">"public"</span></span>.<span class="hljs-string"><span class="hljs-string">"fill"</span></span>(_count <span class="hljs-built_in"><span class="hljs-built_in">int8</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RETURNS</span></span> <span class="hljs-string"><span class="hljs-string">"pg_catalog"</span></span>.<span class="hljs-string"><span class="hljs-string">"int8"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">BODY</span></span>$<span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> i <span class="hljs-built_in"><span class="hljs-built_in">int8</span></span>; j int2; _number_start int8; _pa_start int8; _pa int8; _countract int8; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> _number_start:=<span class="hljs-number"><span class="hljs-number">70000000000</span></span>; _pa_start:=1000000000000; FOR i IN 0.._count BY 5 LOOP <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(contract,<span class="hljs-keyword"><span class="hljs-keyword">account</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">number</span></span>,system_id,region_id,storage_id) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000000</span></span>+<span class="hljs-number"><span class="hljs-number">100000000000</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000</span></span>+_pa_start),_number_start+<span class="hljs-number"><span class="hljs-number">0</span></span>+i,<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">101</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">5</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)), (<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000000</span></span>+<span class="hljs-number"><span class="hljs-number">100000000000</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000</span></span>+_pa_start),_number_start+<span class="hljs-number"><span class="hljs-number">1</span></span>+i,<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">101</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">5</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)), (<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000000</span></span>+<span class="hljs-number"><span class="hljs-number">100000000000</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000</span></span>+_pa_start),_number_start+<span class="hljs-number"><span class="hljs-number">2</span></span>+i,<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">101</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">5</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)), (<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000000</span></span>+<span class="hljs-number"><span class="hljs-number">100000000000</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000</span></span>+_pa_start),_number_start+<span class="hljs-number"><span class="hljs-number">3</span></span>+i,<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">101</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">5</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)), (<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000000</span></span>+<span class="hljs-number"><span class="hljs-number">100000000000</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">100000000</span></span>+_pa_start),_number_start+<span class="hljs-number"><span class="hljs-number">4</span></span>+i,<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">101</span></span>),<span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(random()*<span class="hljs-number"><span class="hljs-number">5</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span>; RETURN 1; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; $BODY$ LANGUAGE 'plpgsql' VOLATILE COST 100 ;</code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In parallel, a console application was created to emulate the load on the DBMS with various types of queries.  To connect to PostgreSQL, the <a href="http://npgsql.projects.postgresql.org/">npgsql</a> project was used. <br>  The text of the main C # program: <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Npgsql; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Threading; namespace sqlPerformer { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Program { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-keyword"><span class="hljs-keyword">Configuration</span></span> c; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static string config_file = "config.xml"; //<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static config config = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> config(); <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static Performance performance = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Performance(); <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static List&lt;Thread&gt; threads = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;Thread&gt;(); static <span class="hljs-type"><span class="hljs-type">void</span></span> Main(string[] args) { //saveConfig(); Console.WindowWidth = <span class="hljs-number"><span class="hljs-number">120</span></span>; loadConfig(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= Program.c.threads; i++) { Thread thread = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Thread(Program.thread); thread.<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>(i); threads.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(thread); } //Program.thread(); Console.ReadLine(); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> thread(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> thread_id) { NpgsqlConnection cn = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> NpgsqlConnection(); cn.ConnectionString = string.Format("Server={0}; Port={1}; Database={2}; User Id={3}; Password={4};", Program.c.host, Program.c.port, Program.c.<span class="hljs-keyword"><span class="hljs-keyword">database</span></span>, Program.c.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>, Program.c.<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>); cn.<span class="hljs-keyword"><span class="hljs-keyword">Open</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= Program.c.count; i++) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (query q <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Program.c.queries.query) { NpgsqlCommand cm = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> NpgsqlCommand(); cm.<span class="hljs-keyword"><span class="hljs-keyword">Connection</span></span> = cn; cm.CommandText = q.text; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!q.status) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (parameter p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> q.parameters.parameter) { NpgsqlTypes.NpgsqlDbType _temp_type = NpgsqlTypes.NpgsqlDbType.Integer; <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> _val = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; switch (p.GetType().Name) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> "bigint": _temp_type = NpgsqlTypes.NpgsqlDbType.Bigint; _val = Program.getRandomInt64(((<span class="hljs-type"><span class="hljs-type">bigint</span></span>)p).min, ((<span class="hljs-type"><span class="hljs-type">bigint</span></span>)p).max); break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> "integer": _temp_type = NpgsqlTypes.NpgsqlDbType.Integer; _val = Program.getRandomInt32(((<span class="hljs-type"><span class="hljs-type">integer</span></span>)p).min, ((<span class="hljs-type"><span class="hljs-type">integer</span></span>)p).max); break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> "date": _temp_type = NpgsqlTypes.NpgsqlDbType.Timestamp; _val = Program.getRandomDate(((<span class="hljs-type"><span class="hljs-type">date</span></span>)p).min, ((<span class="hljs-type"><span class="hljs-type">date</span></span>)p).max); break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> "string_line": _temp_type = NpgsqlTypes.NpgsqlDbType.Varchar; _val = Program.getRandomStringLine(((string_line)p).chars, ((string_line)p).max, ((string_line)p).max); break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> "text": _temp_type = NpgsqlTypes.NpgsqlDbType.Text; _val = Program.getRandomText(((<span class="hljs-type"><span class="hljs-type">text</span></span>)p).words, ((<span class="hljs-type"><span class="hljs-type">text</span></span>)p).max, ((<span class="hljs-type"><span class="hljs-type">text</span></span>)p).max); break; } cm.Parameters.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(p.id, _temp_type); cm.Parameters[p.id].<span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> = _val; } Program.delay(); <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (Program.performance) { Program.performance.<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>(q.id, thread_id.ToString()); } cm.ExecuteNonQuery(); <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (Program.performance) { Program.performance.stop(); } } } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static long getRandomInt64(long min, long max) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Convert.ToInt64(Math.Round((<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Random(unchecked((<span class="hljs-type"><span class="hljs-type">int</span></span>)(DateTime.Now.Ticks)))).NextDouble() * (max - min) + min)); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">int</span></span> getRandomInt32(<span class="hljs-type"><span class="hljs-type">int</span></span> min, <span class="hljs-type"><span class="hljs-type">int</span></span> max) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Convert.ToInt32(Math.Round((<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Random(unchecked((<span class="hljs-type"><span class="hljs-type">int</span></span>)(DateTime.Now.Ticks)))).NextDouble() * (max - min) + min)); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static DateTime getRandomDate(DateTime min, DateTime max) { long stamp_min = min.Ticks; long stamp_max = max.Ticks; long stamp_new = Program.getRandomInt64(stamp_min, stamp_max); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> DateTime(stamp_new)); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static string getRandomStringLine(string chars, <span class="hljs-type"><span class="hljs-type">int</span></span> min, <span class="hljs-type"><span class="hljs-type">int</span></span> max) { string retval = ""; Random r = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Random(unchecked((<span class="hljs-type"><span class="hljs-type">int</span></span>)(DateTime.Now.Ticks))); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= r.Next(min, max); i++) retval += chars[r.Next(<span class="hljs-number"><span class="hljs-number">0</span></span>, chars.Length - <span class="hljs-number"><span class="hljs-number">1</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> retval; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static string getRandomText(List&lt;string&gt; words, <span class="hljs-type"><span class="hljs-type">int</span></span> min, <span class="hljs-type"><span class="hljs-type">int</span></span> max) { string retval = ""; Random r = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Random(unchecked((<span class="hljs-type"><span class="hljs-type">int</span></span>)(DateTime.Now.Ticks))); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt;= r.Next(min, max); i++) retval += " " + words[r.Next(<span class="hljs-number"><span class="hljs-number">0</span></span>, words.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> retval.Trim(); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> delay() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Program.c.delay.status) <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Threading.Thread.Sleep(Program.getRandomInt32(Program.c.delay.min, Program.c.delay.max)); } static <span class="hljs-type"><span class="hljs-type">void</span></span> saveConfig() { Program.c = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Configuration</span></span>("localhost", <span class="hljs-number"><span class="hljs-number">5432</span></span>, "postgres", "postgres"); query q = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> query("SELECT * FROM \"<span class="hljs-built_in"><span class="hljs-built_in">public</span></span>\".\"<span class="hljs-keyword"><span class="hljs-keyword">table</span></span>\"(?)"); q.parameters.parameter.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">bigint</span></span>(<span class="hljs-number"><span class="hljs-number">100000000</span></span>, <span class="hljs-number"><span class="hljs-number">200000000</span></span>)); c.queries.query.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(q); <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlSerializer xs = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlSerializer(c.GetType()); StreamWriter writer = File.CreateText(Program.config_file); xs.Serialize(writer, c); writer.Flush(); writer.<span class="hljs-keyword"><span class="hljs-keyword">Close</span></span>(); } static <span class="hljs-type"><span class="hljs-type">void</span></span> loadConfig() { <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlSerializer xs = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlSerializer( typeof(<span class="hljs-keyword"><span class="hljs-keyword">Configuration</span></span>)); StreamReader reader = File.OpenText(Program.config_file); Program.c = (<span class="hljs-keyword"><span class="hljs-keyword">Configuration</span></span>)xs.Deserialize(reader); reader.<span class="hljs-keyword"><span class="hljs-keyword">Close</span></span>(); } } }</code> </pre><br><br>  The XML format was used for the settings (more precisely, the serialization of the configuration object in XML) <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization; namespace sqlPerformer { [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Configuration</span></span> { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string host = "localhost"; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> port = <span class="hljs-number"><span class="hljs-number">5432</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = "postgres"; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> = "postgres"; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = "postgres"; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> queries queries = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> queries(); [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> delay delay = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> delay(); [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> threads = <span class="hljs-number"><span class="hljs-number">1</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> count = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Configuration</span></span>() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Configuration</span></span>(string host, <span class="hljs-type"><span class="hljs-type">int</span></span> port, string <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>, string <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>) { this.host = host; this.port = port; this.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>; this.<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>; } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> queries { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> List&lt;query&gt; query = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;query&gt;(); <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> queries() { } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> query { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlAttribute()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> status = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlAttribute()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string id = ""; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string <span class="hljs-type"><span class="hljs-type">text</span></span> = ""; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> parameters parameters = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> parameters(); <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> query() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> query(string <span class="hljs-type"><span class="hljs-type">text</span></span>) { this.text = <span class="hljs-type"><span class="hljs-type">text</span></span>; } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> parameters { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> List&lt;parameter&gt; parameter = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;parameter&gt;(); <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> parameters() { } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlInclude(typeof(<span class="hljs-type"><span class="hljs-type">bigint</span></span>))] [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlInclude(typeof(<span class="hljs-type"><span class="hljs-type">integer</span></span>))] [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlInclude(typeof(string_line))] [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlInclude(typeof(<span class="hljs-type"><span class="hljs-type">text</span></span>))] [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlInclude(typeof(<span class="hljs-type"><span class="hljs-type">date</span></span>))] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> abstract <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> parameter { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlAttribute()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string id = ""; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> parameter() { } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-type"><span class="hljs-type">bigint</span></span> : parameter { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> long min = <span class="hljs-number"><span class="hljs-number">0</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> long max = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bigint</span></span>() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bigint</span></span>(long min, long max) { this.min = min; this.max = max; } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-type"><span class="hljs-type">integer</span></span> : parameter { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> min = <span class="hljs-number"><span class="hljs-number">0</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> max = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">integer</span></span>() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">integer</span></span>(<span class="hljs-type"><span class="hljs-type">int</span></span> min, <span class="hljs-type"><span class="hljs-type">int</span></span> max) { this.min = min; this.max = max; } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-type"><span class="hljs-type">date</span></span> : parameter { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> DateTime min = DateTime.Now; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> DateTime max = DateTime.Now; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">date</span></span>() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">date</span></span>(DateTime min, DateTime max) { this.min = min; this.max = max; } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> string_line : parameter { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string chars = "qwertyuiopasdfghjklzxcvbnm"; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> min = <span class="hljs-number"><span class="hljs-number">2</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> max = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string_line() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> string_line(string chars, <span class="hljs-type"><span class="hljs-type">int</span></span> min, <span class="hljs-type"><span class="hljs-type">int</span></span> max) { this.chars = chars; this.min = min; this.max = max; } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span> : parameter { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> List&lt;string&gt; words = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;string&gt;() { "word1", "word2" }; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> min = <span class="hljs-number"><span class="hljs-number">2</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> max = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> text() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> text(List&lt;string&gt; words, <span class="hljs-type"><span class="hljs-type">int</span></span> min, <span class="hljs-type"><span class="hljs-type">int</span></span> max) { this.words = words; this.min = min; this.max = max; } } [<span class="hljs-keyword"><span class="hljs-keyword">Serializable</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> delay { [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlAttribute()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> status = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> min = <span class="hljs-number"><span class="hljs-number">10</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Xml.Serialization.XmlElement()] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> max = <span class="hljs-number"><span class="hljs-number">100</span></span>; } }</code> </pre><br><br>  For performance measurement the class ‚ÄúPerformance‚Äù was created: <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Diagnostics; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">sqlPerformer</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Performance</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Stopwatch sw = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Stopwatch(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, stat&gt; stat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, stat&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> current_id = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> thread_id</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sw.Reset(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current_id = thread_id + <span class="hljs-string"><span class="hljs-string">"-"</span></span> + id; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stat.ContainsKey(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current_id)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stat.Add(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current_id, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> stat()); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sw.Start(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sw.Stop(); addTick(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stat[<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current_id].<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sw.ElapsedTicks); Console.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (KeyValuePair&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, stat&gt; k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stat) Console.WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0}\tCount: {1}\tAverage: {2:#0.00}\tMin: {3:#0.00}\tMax: {4:#0.00}\tTotal: {5:#}"</span></span> , k.Key , k.Value.count , k.Value.timeAvg , k.Value.timeMin , k.Value.timeMax , k.Value.timeTotal )); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">stat</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Int64 count = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> timeTotal = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> timeLast = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> timeMin = <span class="hljs-number"><span class="hljs-number">9999999</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> timeMax = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> timeAvg = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stat</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ticks</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.count++; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeLast = ticks / <span class="hljs-number"><span class="hljs-number">10000000.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeTotal += <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeLast; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeAvg = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeTotal / <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.count; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeMin = Math.Min(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeLast, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeMin); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeMax = Math.Max(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeLast, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeMax); } } }</code> </pre><br><br>  As a test site, a workstation with 2 gigs of RAM, Core2Duo process and a brake screw was used.  The results were surprising, on 50 threads the average response was around 8-10, up to a maximum of 30 milliseconds, but the disk is heavily loaded.  It is clear that on serious equipment these values ‚Äã‚Äãwill be much lower.  But I was pleased with something else - when working with a large table, the DBMS responds fairly adequately. <br>  In principle, nothing prevents you from using this program for load testing any database, with any data set and any number of tables. </div><p>Source: <a href="https://habr.com/ru/post/133994/">https://habr.com/ru/post/133994/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../133989/index.html">System of settings and change of versions of programs: evolution of viable forms</a></li>
<li><a href="../133990/index.html">OpenOffice COM Automation: Reading Clipboard Content</a></li>
<li><a href="../133991/index.html">US court rejected Apple‚Äôs claim against Samsung</a></li>
<li><a href="../133992/index.html">Droider Show # 18. "Apple" is not passed!</a></li>
<li><a href="../133993/index.html">Filling Bitrix through internal integration mechanisms with 1C without 1C</a></li>
<li><a href="../133996/index.html">And again about sorting: choose the best algorithm</a></li>
<li><a href="../133997/index.html">TES 5: Skyrim song bard</a></li>
<li><a href="../133998/index.html">Work with binary data using typed arrays</a></li>
<li><a href="../133999/index.html">Wanted.VC Digest # 24</a></li>
<li><a href="../134000/index.html">Tablets in the office: a change of mood in the headquarters of the CIO</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>