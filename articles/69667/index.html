<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple homemade data backup (Python + DropBox)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I did not make backups for a long time. It was lazy, and the data I have not lost for several years. But recently I thought about it and decided to do...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple homemade data backup (Python + DropBox)</h1><div class="post__text post__text-html js-mediator-article">  I did not make backups for a long time.  It was lazy, and the data I have not lost for several years.  But recently I thought about it and decided to do something that would back up what I didn‚Äôt really want to lose.  Just to be bored and practice a little. <br><a name="habracut"></a><br>  First you need to decide where to store copies of files.  In my opinion DropBox is a very good choice - it is a service for synchronizing data on different computers.  Free give 2 GB, plus a program that displays the selected local folder on their online storage.  I added a file to this special folder - it was added to all computers that have a special program configured on the same account.  Plus access via the web interface.  For backup, it is very convenient - no need to be confused as to copy files to FTP, but simply copy them into a special folder.  All work on filling / synchronization will make DropBox client. <br><br>  Next you need to actually copy the necessary files.  For this, a tiny python script was written, backup.py.  This script creates a text list of the files to be copied and transfers it to WinRar, which creates an archive with the specified name. <br><br>  At first, I wanted to completely instruct WinRar to create a backup, writing some code in batch files, but unfortunately it cannot skip specified folders (files only).  So I had to write an intermediate script that creates a list of files.  Well and good, so even more fun. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The script has a single parameter - the name of the output archive file with the copied files. <br><br>  Algorithm of the script: <br><ol><li>  Reads the file <b>tobackup.lst</b> from the current folder - it contains a list of folders that need to be copied.  Each line is a separate folder.  For example: <br>  d: \ projects <br>  d: \ www </li><li>  Reads a list of folders to exclude from the backup.  This is an optional <b>igonre.lst</b> file in the current folder.  This is either the full path (d: \ projects \ old) or just the folder name (.svn).  For example: <br>  .svn <br>  d: \ projects \ old </li><li>  Creates a text list of files for copying <b>list.lst</b> (in the current folder).  After that, it adds an <b>extra.lst</b> file (from the current folder) to the end of the list file.  It contains a list of files, not folders, to be included.  For example, we want to save php settings, but from the entire d: \ programs \ php folder we need only one php.ini file.  Therefore, instead of adding a folder with php, we add only one php.ini file to extra.lst. </li><li>  Causes the archiver, which creates an archive with files from the list.  Archiver parameters - save the full path of the files (along with the disk) and create an archive without compression. </li></ol><br>  As a result, after the script works, we will have an archive with the specified folders. <br><br>  I knowingly indicated that the script takes files from the current folder.  Thanks to this, it is very easy to make different ‚Äúprofiles‚Äù - just create a new folder, create a tobackup.lst file there, optionally ignore.lst and extra.lst, and the new profile is ready!  For convenience, you can make a batch file, which will call backup.py and give it the name of the archive file that should work. <br><br>  Now, for example, I have two profile folders, projects (for backup of current projects) and other (for backup of program settings).  The script itself is in the core folder (on the same level as the profile folders), along with WinRar. <br><br>  Core folder: <br>  Rar.exe <br>  WinRAR.exe <br>  rarreg.key <br>  backup.py <br><br>  Project folder: <br>  tobackup.lst: <br>  d: \ projects <br>  d: \ svn <br><br>  ignore.lst: <br>  .svn <br>  d: \ projects \ old <br><br>  backup.bat: <br>  .. \ core \ backup.py "d: \ dropbox \ my dropbox \ backup \ dev.rar" <br><br>  The batch file backup.bat calls the script, passes it the name of the resulting archive file, which will be created in the folder associated with DropBox.  The script takes the list files from the current folder (projects in this case).  One run of the batch file - the new backup is ready, and DropBox loads it to the server. <br><br>  It remains to fasten the launch on a schedule, but I will be satisfied with a manual launch several times a month. <br><br>  backup.py: <br><blockquote><code><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> <font color="black">Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><font color="#696969"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] # Only mandatory file is RootFoldersFile, check that it exists <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><font color="#696969"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) # Archiver file also should exist <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><font color="#696969"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) # Read root folders from file rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><font color="#696969"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] # Read list of folders that need to be igonred (if specified) ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><font color="#696969"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] # Open filelist file for writing list of files out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> <li></li><li> <code><font color="black"><a href="http://s-c.me/3110/s"></a> <a href="http://s-c.me/3110/h"></a> Copy Source | Copy HTML <font color="#0000ff">import</font> subprocess <font color="#0000ff">import</font> sys <font color="#0000ff">import</font> <b>os</b> .path <font color="#0000ff">import</font> os <font color="#0000ff">if</font> __name__ == <font color="#008000">"__main__"</font> : <font color="#0000ff">if</font> ( <b>len</b> ( <b>sys</b> .argv) &lt; <font color="#008000">2</font> ): <font color="#0000ff">print</font> ( <font color="#008000">"Usage: backup.py &lt;output archive file&gt;"</font> ) <font color="#0000ff">print</font> ( <font color="#008000">"Eg: \"backup.py d:\\dropbox\\my dropbox\\backup.rar\""</font> ) exit( <font color="#008000">1</font> ) scriptFolder = <b>os</b> .path.dirname( <b>sys</b> .argv[ <font color="#008000">0</font> ]) ArchiverFile = scriptFolder + <font color="#008000">"\\winrar.exe"</font> RootFoldersFile = <font color="#008000">"tobackup.lst"</font> IgnoreFoldersFile = <font color="#008000">"ignore.lst"</font> ExtraFile = <font color="#008000">"extra.lst"</font> FilelistFile = <font color="#008000">"list.lst"</font> OutputArchive = <b>sys</b> .argv[ <font color="#008000">1</font> ] <font color="#696969"># Only mandatory file is RootFoldersFile, check that it exists</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(RootFoldersFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % RootFoldersFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Archiver file also should exist</font> <font color="#0000ff">if</font> ( <font color="#0000ff">not</font> <b>os</b> .path.isfile(ArchiverFile)): <font color="#0000ff">print</font> ( <font color="#008000">"%s doesn't exist"</font> % ArchiverFile) exit( <font color="#008000">1</font> ) <font color="#696969"># Read root folders from file</font> rootFolders = [i.strip() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (RootFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Read list of folders that need to be igonred (if specified)</font> ignoreList = [] <font color="#0000ff">if</font> ( <b>os</b> .path.isfile(IgnoreFoldersFile)): ignoreList = [i.strip().lower() <font color="#0000ff">for</font> i <font color="#0000ff">in</font> <b>open</b> (IgnoreFoldersFile, <font color="#008000">"r"</font> ).readlines()] <font color="#696969"># Open filelist file for writing list of files</font> out = <b>open</b> (FilelistFile, <font color="#008000">"w"</font> ) filesCount = <font color="#008000">0</font> <font color="#0000ff">for</font> rootFolder <font color="#0000ff">in</font> rootFolders: <font color="#0000ff">for</font> root, dirs, files <font color="#0000ff">in</font> <b>os</b> .walk(rootFolder): <font color="#0000ff">for</font> file <font color="#0000ff">in</font> files: out.write(root + <font color="#008000">"\\" + file + "</font> \n <font color="#008000">")</font> &lt;br/&gt; <font color="#008000">filesCount += 1</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">for dir in dirs:</font> &lt;br/&gt; <font color="#008000"># Skip ignored folders</font> &lt;br/&gt; <font color="#008000">if (dir.lower() in ignoreList or ("</font> %s\%s <font color="#008000">" % (root, dir)).lower() in ignoreList):</font> &lt;br/&gt; <font color="#008000">dirs.remove(dir)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Append some files from extra files list</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(ExtraFile)):</font> &lt;br/&gt; <font color="#008000">out.writelines(open(ExtraFile, "</font> r <font color="#008000">").readlines())</font> &lt;br/&gt; <font color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> &lt;br/&gt; <font color="#008000">out.close()</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000">print("</font> Added %d <b>file</b> (s) <font color="#008000">" % (filesCount))</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Delete old archive if exists</font> &lt;br/&gt; <font color="#008000">if (os.path.isfile(OutputArchive)):</font> &lt;br/&gt; <font color="#008000">os.unlink(OutputArchive)</font> &lt;br/&gt;&lt;br/&gt; <font color="#008000"># Call archiver (winrar)</font> &lt;br/&gt; <font color="#008000">subprocess.call(ArchiverFile + "</font> a -m0 -ep3 \ <font color="#008000">""</font> + OutputArchive + <font color="#008000">"\" @list.lst"</font> ) <b>os</b> .unlink(FilelistFile) <font color="#0000ff">print</font> ( <font color="#008000">"Done"</font> )</font></code> </li> </ol></blockquote><br><br>  <b>UPD.</b>  New version <a href="http://race1.habrahabr.ru/blog/69856/">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/69667/">https://habr.com/ru/post/69667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../69660/index.html">Top 5 Web Trends 2009: No.4 Mobile Internet and Augmented Reality</a></li>
<li><a href="../69661/index.html">Mac OS plist files</a></li>
<li><a href="../69663/index.html">Waited for Hammerfall</a></li>
<li><a href="../69665/index.html">The stages of design of radio frequencies (wi-fi, wi-max, RRL) or radio access is difficult;)</a></li>
<li><a href="../69666/index.html">Software Configuration Management // Metrics and Documentation</a></li>
<li><a href="../69668/index.html">Touch of Happiness Review - ASUS EeePC T91</a></li>
<li><a href="../69670/index.html">Bing launches visual search</a></li>
<li><a href="../69672/index.html">Scala: Caching Method Execution Results</a></li>
<li><a href="../69676/index.html">When Windows 7 wakes up by itself</a></li>
<li><a href="../69677/index.html">Video version of Zisser‚Äôs lecture as part of the IT entrepreneurship course</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>