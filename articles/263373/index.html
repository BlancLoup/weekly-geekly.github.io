<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Build your tab on the ribbon (Ribbon) AutoCad means. Net (C #)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this publication, we will look at an example of software building your own tab on a tape, as well as several problematic issues related to tape. 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Build your tab on the ribbon (Ribbon) AutoCad means. Net (C #)</h1><div class="post__text post__text-html js-mediator-article">  In this publication, we will look at an example of software building your own tab on a tape, as well as several problematic issues related to tape. <br><br>  Recently, the innovation under the name Ribbon has become very popular.  Autodesk did not lag behind life and, starting from the 2009 auto-cascade, also began to use tape. <br><br>  We will look at an example of creating a tab on a ribbon for the 2010 auto-cad and consider several related "problem" issues.  Why for him?  Yes, because in 2009 the tape was still ‚Äúraw‚Äù (but you can do it there too), and because for the subsequent auto-cad (2011-2013) code will be similar. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are several options to add your tab to the tape: <br><ul><li>  Create an API file (cui) with your tape and load it.  In my opinion the worst and most problematic option.  IMHO </li><li>  create a tab on the tape programmatically - this option and consider </li><li>  create a tab using technology WPF - I did not understand </li></ul><br>  <b>Note</b> : I will not delve into every detail and describe everything ‚Äúbeautifully‚Äù - the example is not complicated.  Yes, and I can not express so beautifully. <br><br>  The example is considered taking into account that you know how to write (at least the simplest) plug-ins for auto-cad tools using .net.  For work, I use Microsoft Visual Studio 2010. <br><a name="habracut"></a><br>  So let's get started: <br>  1. Open VS2010 and create a new project: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/755/871/c5d/755871c5d68e9c036036b7309ddcba05.png"><br><br>  2. Next, connect links to our project: <br><ul><li>  Project -&gt; Add link -&gt; Overview tab -&gt; from the folder with AutoCAD 2010, select the files: <b>acdbmgd.dll</b> , <b>acmgd.dll</b> , <b>AdWindows.dll</b> .  Do not forget in the properties of these files to set the value to <b>false</b> for the <b>Copy locally</b> parameter; </li><li>  Project -&gt; Add link -&gt; ‚ÄúNET‚Äù tab -&gt; add links to the following libraries: <b>PresentationCore</b> , <b>PresentationFramework</b> , <b>WindowsBase</b> . </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/7e3/4f4/b2d/7e34f4b2dcd2b197a234b4f66d6930e0.png"><br><br>  3. Now we will consider what the tape consists of by the example of this image: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/995/20a/26e/99520a26ed50104b3ec73bf37abcd477.jpg"><br><br>  Here, in principle, nothing to describe. <br><br>  4. Add two 16x16 and 32x32 icons to our project in .png format.  As I am lazy, I used the same picture as the first available on the Internet. <br><br>  The main thing for these files is to set the <b>Resource</b> value for the <b>Action at build</b> parameter: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26b/56e/cf3/26b56ecf31d911d71979511c033ea98e.png"><br><br>  5. Go to the code.  Open the Class1.cs file (or you can create your own), delete the Class1 class, and create your own class inherited from <b>IExtensionApplication</b> .  Let's call it <b>ExampleRibbon</b> . <br><br>  Further, I wanted to somehow describe all the actions step by step, but I decided that it would be more convenient and more understandable to bring all the code with explanations right away: <br><div class="spoiler">  <b class="spoiler_title">All main project code</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-comment"><span class="hljs-comment">// Acad using Autodesk.AutoCAD.Runtime; using Autodesk.AutoCAD.ApplicationServices; using Autodesk.Windows; using acadApp = Autodesk.AutoCAD.ApplicationServices.Application; namespace ACadRibbon { public class ExampleRibbon : IExtensionApplication { //    public void Initialize() { /*      : *    ,    *   , ..  ()  *    */ //Autodesk.Windows.ComponentManager.ItemInitialized += new EventHandler(ComponentManager_ItemInitialized); // ..     NETLOAD,       BuildRibbonTab(); } //     public void Terminate() { //        } /*   *      . *    ,  ""   , * ,      */ void ComponentManager_ItemInitialized(object sender, Autodesk.Windows.RibbonItemEventArgs e) { // ,    if (Autodesk.Windows.ComponentManager.Ribbon != null) { //    BuildRibbonTab(); //    ,     Autodesk.Windows.ComponentManager.ItemInitialized -= new EventHandlerRibbonItemEventArgs&gt;(ComponentManager_ItemInitialized); } } //   void BuildRibbonTab() { //      if (!isLoaded()) { //   CreateRibbonTab(); //       acadApp.SystemVariableChanged += new SystemVariableChangedEventHandler(acadApp_SystemVariableChanged); } } //  ""  bool isLoaded() { bool _loaded = false; RibbonControl ribCntrl = Autodesk.Windows.ComponentManager.Ribbon; //      foreach (RibbonTab tab in ribCntrl.Tabs) { //        ,     if (tab.Id.Equals("RibbonExample_ID") &amp; tab.Title.Equals("RibbonExample")) { _loaded = true; break; } else _loaded = false; } return _loaded; } /*      *      */ void RemoveRibbonTab() { try { RibbonControl ribCntrl = Autodesk.Windows.ComponentManager.Ribbon; //      foreach (RibbonTab tab in ribCntrl.Tabs) { if (tab.Id.Equals("RibbonExample_ID") &amp; tab.Title.Equals("RibbonExample")) { //        ,     ribCntrl.Tabs.Remove(tab); //    acadApp.SystemVariableChanged -= new SystemVariableChangedEventHandler(acadApp_SystemVariableChanged); //   break; } } } catch (Autodesk.AutoCAD.Runtime.Exception ex) { Autodesk.AutoCAD.ApplicationServices.Application. DocumentManager.MdiActiveDocument.Editor.WriteMessage(ex.Message); } } /*      *      WSCURRENT (  ), *     ""     */ void acadApp_SystemVariableChanged(object sender, SystemVariableChangedEventArgs e) { if (e.Name.Equals("WSCURRENT")) BuildRibbonTab(); } //    void CreateRibbonTab() { try { //     RibbonControl ribCntrl = Autodesk.Windows.ComponentManager.Ribbon; //    RibbonTab ribTab = new RibbonTab(); ribTab.Title = "RibbonExample"; //   ribTab.Id = "RibbonExample_ID"; //   ribCntrl.Tabs.Add(ribTab); //     //      ( ) addExampleContent(ribTab); //    ( ,  ) //ribTab.IsActive = true; //   (   ,  ) ribCntrl.UpdateLayout(); } catch (System.Exception ex) { Autodesk.AutoCAD.ApplicationServices.Application. DocumentManager.MdiActiveDocument.Editor.WriteMessage(ex.Message); } } //       void addExampleContent(RibbonTab ribTab) { try { //  panel source RibbonPanelSource ribSourcePanel = new RibbonPanelSource(); ribSourcePanel.Title = "RibbonExample"; //    RibbonPanel ribPanel = new RibbonPanel(); ribPanel.Source = ribSourcePanel; ribTab.Panels.Add(ribPanel); //   tooltip ( ) RibbonToolTip tt; //  split button RibbonSplitButton risSplitBtn = new RibbonSplitButton(); /*  RibbonSplitButton    *  Text,        *   . */ risSplitBtn.Text = "RibbonSplitButton"; //   risSplitBtn.Orientation = System.Windows.Controls.Orientation.Vertical; //   risSplitBtn.Size = RibbonItemSize.Large; //   risSplitBtn.ShowImage = true; //   risSplitBtn.ShowText = true; //   risSplitBtn.ListButtonStyle = Autodesk.Private.Windows.RibbonListButtonStyle.SplitButton; risSplitBtn.ResizeStyle = RibbonItemResizeStyles.NoResize; risSplitBtn.ListStyle = RibbonSplitButtonListStyle.List; /*        *   ,   RibbonSplitButton */ #region - ‚Ññ1 //     tt = new RibbonToolTip(); //    (    ) tt.IsHelpEnabled = false; //   RibbonButton ribBtn = new RibbonButton(); /*   CommandParameter ( ) *    Command ( )  *    */ ribBtn.CommandParameter = tt.Command = "_Line"; //   ribBtn.Name = "ExampleButton1"; //     ribBtn.Text = tt.Title = "- ‚Ññ1"; //   ()   (.) ribBtn.CommandHandler = new RibbonCommandHandler(); //   ribBtn.Orientation = System.Windows.Controls.Orientation.Horizontal; //   ribBtn.Size = RibbonItemSize.Large; /* ..    Large,   *       (.) */ ribBtn.LargeImage = LoadImage("icon_32"); //   ribBtn.ShowImage = true; //   ribBtn.ShowText = true; //     tt.Content = "  ‚Ññ1.      "; //     ribBtn.ToolTip = tt; //    RibbonSplitButton risSplitBtn.Items.Add(ribBtn); #endregion //     risSplitBtn.Current = ribBtn; //         #region - ‚Ññ2 tt = new RibbonToolTip(); tt.IsHelpEnabled = false; ribBtn = new RibbonButton(); ribBtn.CommandParameter = tt.Command = "_Pline"; ribBtn.Name = "ExampleButton2"; ribBtn.Text = tt.Title = "- ‚Ññ2"; ribBtn.CommandHandler = new RibbonCommandHandler(); ribBtn.Orientation = System.Windows.Controls.Orientation.Horizontal; ribBtn.Size = RibbonItemSize.Large; ribBtn.LargeImage = LoadImage("icon_32"); ribBtn.ShowImage = true; ribBtn.ShowText = true; tt.Content = "  ‚Ññ2.      "; ribBtn.ToolTip = tt; risSplitBtn.Items.Add(ribBtn); #endregion //  RibbonSplitButton    ribSourcePanel.Items.Add(risSplitBtn); //    RibbonRowPanel ribRowPanel = new RibbonRowPanel(); //       . //      ( ) #region - ‚Ññ3 tt = new RibbonToolTip(); tt.IsHelpEnabled = false; ribBtn = new RibbonButton(); ribBtn.CommandParameter = tt.Command = "_Circle"; ribBtn.Name = "ExampleButton3"; ribBtn.Text = tt.Title = "- ‚Ññ3"; ribBtn.CommandHandler = new RibbonCommandHandler(); ribBtn.Orientation = System.Windows.Controls.Orientation.Vertical; ribBtn.Size = RibbonItemSize.Standard; ribBtn.Image = LoadImage("icon_16"); ribBtn.ShowImage = true; ribBtn.ShowText = false; tt.Content = "  ‚Ññ3.      "; ribBtn.ToolTip = tt; ribRowPanel.Items.Add(ribBtn); #endregion //      ribSourcePanel.Items.Add(ribRowPanel); } catch (System.Exception ex) { Autodesk.AutoCAD.ApplicationServices.Application. DocumentManager.MdiActiveDocument.Editor.WriteMessage(ex.Message); } } //     //       System.Windows.Media.Imaging.BitmapImage LoadImage(string ImageName) { return new System.Windows.Media.Imaging.BitmapImage( new Uri("pack://application:,,,/ACadRibbon;component/" + ImageName + ".png")); } /*    *          */ class RibbonCommandHandler : System.Windows.Input.ICommand { public bool CanExecute(object parameter) { return true; } public event EventHandler CanExecuteChanged; public void Execute(object parameter) { Document doc = acadApp.DocumentManager.MdiActiveDocument; if (parameter is RibbonButton) { //   ,   CommandParameter  //      SendStringToExecute RibbonButton button = parameter as RibbonButton; acadApp.DocumentManager.MdiActiveDocument.SendStringToExecute( button.CommandParameter + " ", true, false, true); } } } } }</span></span></code> </pre> <br></div></div><br>  6. All - the code is ready.  Compile it (Build -&gt; Build solution), open AutoCAD 2010, execute the <b>NETLOAD</b> command and select our plugin ... \ ACadRibbon \ ACadRibbon \ bin \ Debug \ ACadRibbon.dll. <br><br>  And immediately after the download, we will see that we have added a new tab on the ribbon: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf5/452/173/bf5452173543c77f414711653b356b8b.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ee/dd2/3e8/1eedd23e861995fb32b41b08d61e3269.png"><br><br>  This option is actively used in my <a href="http://modplus.org/">ModPlus</a> plugin and has not yet caused any complaints. <br><br>  I hope an example will be useful! </div><p>Source: <a href="https://habr.com/ru/post/263373/">https://habr.com/ru/post/263373/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263363/index.html">Add a hamburger to the Windows 10 application menu</a></li>
<li><a href="../263365/index.html">Porting Unity Editor to Linux: Things You Should Wanna Do in advance</a></li>
<li><a href="../263367/index.html">Cryptocurrency - how to create it?</a></li>
<li><a href="../263369/index.html">Integration of PVS-Studio with the IncrediBuild distributed assembly system</a></li>
<li><a href="../263371/index.html">Refactoring: highlight the method when it makes sense</a></li>
<li><a href="../263375/index.html">Why is it not easy to show all colors in a one-dimensional space, and how many times it can be done</a></li>
<li><a href="../263377/index.html">How software and hardware are used on computers in Russian companies</a></li>
<li><a href="../263379/index.html">Snipper - a little programmer assistant</a></li>
<li><a href="../263381/index.html">Registration for MBLTdev 15 - international conference of mobile developers has begun</a></li>
<li><a href="../263387/index.html">Research interstitial ads on Google+ with advertisements</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>