<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Plugin system on ASP.NET. Or a site with plugins, mademoiselles and preference</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instead of the preface 
 This material is solely the result of the work of collecting information online and creating a site that works on the basis o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Plugin system on ASP.NET. Or a site with plugins, mademoiselles and preference</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/94b/1a1/5cb/94b1a15cbb76b3b6eb117f9fb9c961e3.png" alt="image"><br><br><h4>  Instead of the preface </h4><br>  This material is solely the result of the work of collecting information online and creating a site that works on the basis of plug-ins.  Here I will try to describe the idea of ‚Äã‚Äãhow such a system works and the main components necessary for its work. <br>  This article does not claim originality, and the described system is not the only correct and beautiful.  But if you, dear $ habrauser $, I wonder how to create such a system, you are welcome under the cat <br><a name="habracut"></a><br><br><h4>  Problematics and problem statement </h4><br>  At the moment I am conducting a fairly large project, divided into four large parts.  Each of these parts is divided into at least 2 small tasks.  While the system had 2 parts, the support was not stressful and the implementation of changes did not cause any problems.  But over time, the system has grown to gigantic proportions and such a simple task as maintaining the code has become quite difficult.  Therefore, I came to the conclusion that the whole zoo should be split into pieces.  The project is an ASP.NET MVC site on the intranet on which employees work.  Over time, five to seven views and two to three controllers grew into a huge pile that became difficult to maintain. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Finding a solution </h5><br>  For a start, I started looking for standard solutions to the problem of splitting a project into parts.  Immediately came up with the thought of areas (Areas).  But this option was discarded immediately, because in fact it was just crushing the project into even smaller elements, which did not solve the problem.  All the ‚Äústandard‚Äù methods of solution were also considered, but even there I did not find anything that satisfied me. <br>  The basic idea was simple.  Each system component must be a plugin with a simple way to connect to a working system, consisting of as few files as possible.  Creating and connecting a new plug-in should not affect the root application.  And the plug-in connection itself should not be more difficult than a couple of mouse clicks. <br><br><h5>  Approach one </h5><br>  During the long googling and searches on the Internet, a description of the plug-in system was found.  The author provided the source of the project, which was downloaded immediately.  The project is beautiful, and even performs everything that I want to see in the finished solution.  Launched, looked.  Indeed, plug-ins presented as separate projects are compiled and ‚Äúautomatically connected‚Äù (here I wrote in quotes for a reason. Then I will write why) to the site.  I was already ready to jump for joy, but ... Here it was BUT, which I did not expect.  After looking at the parameters of the plug-in projects, I found the build parameters.  They were written post-build parameters that were used to copy the class library and areas (Areas) in the folder with the site.  It was a big upset.  Not at all like a ‚Äúconvenient plug-in system.‚Äù  Therefore, I continued to search.  And, oddly enough, this search was a success. <br><br><h5>  Approach number two </h5><br>  So, on one of the forums I found a description of a very interesting system.  I will not paint for a long time all the way, so I will immediately say that I found exactly what I was looking for.  The system works on the basis of pre-compiled plugins with built-in views.  Connecting a new plug-in is done by copying the dll's to the plug-in folder and restarting the application.  I took this system as a basis for work. <br><br><h4>  Beginning of work </h4><br>  To begin, open Visual Studio and create a new Web Application MVC 4 project (in fact, the MVC version does not play a huge role).  But we will not rush into writing code.  We will create the necessary basic components.  Therefore, we will add a project of type Class Library to the solution and name it Infrastructure. <br>  First you need to create a plug-in interface that all plug-ins must implement. <br>  The code is simple and I will not write about it. <br><div class="spoiler">  <b class="spoiler_title">IModule</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">EkzoPlugin.Infrastructure</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IModule</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> ,      </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> string Title { get; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">    </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> string Name { get; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">   </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> Version Version { get; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  ,     </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> string EntryControllerName { get; } } }</span></span></code> </pre> <br></div></div><br>  Now we will create another project of type Class Library, call it PluginManager.  In this project there will be all the necessary classes responsible for connecting to the base project. <br>  Create a class file and write the following code: <br><div class="spoiler">  <b class="spoiler_title">Pluginmanager</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">EkzoPlugin.PluginManager</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PluginManager</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PluginManager</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Modules = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;IModule, Assembly&gt;(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> PluginManager _current; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> PluginManager Current { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _current ?? (_current = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PluginManager()); } } <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> Dictionary&lt;IModule, Assembly&gt; Modules { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//    public IEnumerable&lt;IModule&gt; GetModules() { return Modules.Select(m =&gt; m.Key).ToList(); } //    public IModule GetModule(string name) { return GetModules().Where(m =&gt; m.Name == name).FirstOrDefault(); } } }</span></span></code> </pre><br></div></div><br>  This class implements the plugin manager, which will store the list of loaded plugins and manipulate them. <br><br>  Now create a new class file and name it PreApplicationInit.  This is where the magic will be created, which will allow you to automatically connect plug-ins when launching applications.  The PreApplicationStartMethod attribute is responsible for ‚Äúmagic‚Äù (you can read about it <a href="http://msdn.microsoft.com/en-us/library/system.web.preapplicationstartmethodattribute(v%3Dvs.100).aspx">here</a> ).  In short, the method specified when it is declared will be executed before the start of the web application.  Even earlier than Application_Start.  This will allow us to download our plugins before the application starts. <br><div class="spoiler">  <b class="spoiler_title">PreApplicationInit</b> <div class="spoiler_text"><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">assembly: PreApplicationStartMethod(typeof(EkzoPlugin.PluginManager.PreApplicationInit), </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"InitializePlugins"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">EkzoPlugin.PluginManager</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PreApplicationInit</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PreApplicationInit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      string pluginsPath = HostingEnvironment.MapPath("~/plugins"); //    ,     string pluginsTempPath = HostingEnvironment.MapPath("~/plugins/temp"); //    ,   if (pluginsPath == null || pluginsTempPath == null) throw new DirectoryNotFoundException("plugins"); PluginFolder = new DirectoryInfo(pluginsPath); TempPluginFolder = new DirectoryInfo(pluginsTempPath); } /// &lt;summary&gt; ///        /// &lt;/summary&gt; /// &lt;remarks&gt; ///          /// &lt;/remarks&gt; private static readonly DirectoryInfo PluginFolder; /// &lt;summary&gt; ///       ///    ,        /// &lt;/summary&gt; private static readonly DirectoryInfo TempPluginFolder; /// &lt;summary&gt; /// Initialize method that registers all plugins /// &lt;/summary&gt; public static void InitializePlugins() { Directory.CreateDirectory(TempPluginFolder.FullName); //     foreach (var f in TempPluginFolder.GetFiles("*.dll", SearchOption.AllDirectories)) { try { f.Delete(); } catch (Exception) { } } //  foreach (var plug in PluginFolder.GetFiles("*.dll", SearchOption.AllDirectories)) { try { var di = Directory.CreateDirectory(TempPluginFolder.FullName); File.Copy(plug.FullName, Path.Combine(di.FullName, plug.Name), true); } catch (Exception) { } } // *     'Load' //      'probing'   web.config // : &lt;probing privatePath="plugins/temp" /&gt; var assemblies = TempPluginFolder.GetFiles("*.dll", SearchOption.AllDirectories) .Select(x =&gt; AssemblyName.GetAssemblyName(x.FullName)) .Select(x =&gt; Assembly.Load(x.FullName)); foreach (var assembly in assemblies) { Type type = assembly.GetTypes().Where(t =&gt; t.GetInterface(typeof(IModule).Name) != null).FirstOrDefault(); if (type != null) { //      BuildManager.AddReferencedAssembly(assembly); //       var module = (IModule)Activator.CreateInstance(type); PluginManager.Current.Modules.Add(module, assembly); } } } } }</span></span></code> </pre><br></div></div><br>  This is almost all that is needed to organize the work of the plug-in system.  Now <a href="https://github.com/csteeg/BoC/tree/master/Src/Commons.Web.PrecompiledViews">download the</a> library that will provide work with the built-in views, and add a link to it to the project. <br>  It remains to create the code required for registering plugins. <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">EkzoPlugin.PluginManager</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PluginBootstrapper</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> asmbl <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> PluginManager.Current.Modules.Values) { BoC.Web.Mvc.PrecompiledViews.ApplicationPartRegistry.Register(asmbl); } } } }</code> </pre><br></div></div><br>  This module downloads and registers precompiled resources.  This needs to be done so that the requests that come to the server are correctly routed to the precompiled views. <br><br>  Now you can go to our base system and configure it to work with plugins.  First we will open the web.config file and add the following line to the runtime section <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">runtime</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">assemblyBinding</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:asm.v1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">probing</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">privatePath</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"plugins/temp"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  Without this setting, plugins will not work. <br><br>  Now add to the project links to previously created EkzoPlugin.PluginManager project. <br>  Now open Global.asax and add just two lines.  First we connect the namespace EkzoPlugin.PluginManager <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> EkzoPlugin.PluginManager;</code> </pre><br>  And add the second one in the first line to Applicaton_Start () <br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ApplicationStart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { PluginBootstrapper.Initialize();</code> </pre><br>  Here I will explain a little.  Remember the PreApplicationInit attribute?  So, before ApplicationStart got control, modules were initialized and loaded into the plugin manager.  And when the ApplicationStart procedure got control, we perform the registration of loaded modules so that the program knows how to handle the routes to the plugins. <br>  That's all.  Our basic application is ready.  It can work with plugins located in the plugins folder. <br><br><h4>  Writing a plugin </h4><br>  Let's now write a simple plugin to demonstrate the work.  I just want to make a reservation that all plugins should have a common namespace with the base project and be located in the Plugin namespace (in fact, this is not a hard limitation, but I advise you to stick to it in order to avoid trouble).  This is the price to pay. <br>  We take the Web Application MVC project as a basis.  Create an empty project. <br>  Add a new Controllers folder and add a new controller.  Let's call it SampleMvcController. <br>  By default, Visual Studio creates a controller with a single Index () action.  Since we make a simple plugin for example, we will not change it, but simply add a presentation for it. <br>  After adding the view, open it and write something that will identify our plugin. <br>  For example: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span>Sample Mvc Plugin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Now open the Visual Studio Add-ons Manager and install the RazorGenerator.  This extension allows you to add views to the compiled dll file. <br>  After installation, select the index.cshtml view in solution explorer and set the following values ‚Äã‚Äãin the properties window: <br>  Build Action: EmbeddedResource <br>  Custom Tool: RazorGenerator <br>  These settings indicate that the representation is included in the resources of the compiled library. <br>  We are almost done.  We need to do all two simple steps to make our plugin work. <br>  First of all, we need to add a link to the EkzoPlugin.Infrastructure project created earlier, which contains the interface of the plug-in, which we are implementing. <br>  Add a class to the plugin project and name it SampleMVCModule.cs <br><div class="spoiler">  <b class="spoiler_title">SampleMVCModule</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> EkzoPlugin.Infrastructure; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">EkzoPlugin.Plugins.SampleMVC</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SampleMVCModule</span></span> : <span class="hljs-title"><span class="hljs-title">IModule</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Title { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"SampleMVCPlugin"</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Assembly.GetAssembly(GetType()).GetName().Name; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Version Version { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Version(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> EntryControllerName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"SampleMVC"</span></span>; } } } }</code> </pre><br></div></div><br>  That's all.  Plugin ready.  Just isn't it? <br>  Now we will compile the solution and copy the library resulting from the plugin assembly into the plugins folder of the base site. <br>  Add the following lines to the base site _Layout.cshtml file <br><pre> <code class="cs hljs">@<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> EkzoPlugin.Infrastructure @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> EkzoPlugin.PluginManager @{ IEnumerable&lt;IModule&gt; modules = PluginManager.Current.GetModules(); Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, IModule&gt; getModule = name =&gt; PluginManager.Current.GetModule(name); } &lt;html ...... &lt;head&gt;....&lt;/head&gt; &lt;body&gt; &lt;ul id=<span class="hljs-string"><span class="hljs-string">"pluginsNavigation"</span></span>&gt; &lt;li <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"MenuItem"</span></span>&gt;@Html.ActionLink(<span class="hljs-string"><span class="hljs-string">"Home"</span></span>,<span class="hljs-string"><span class="hljs-string">"Index"</span></span>,<span class="hljs-string"><span class="hljs-string">"Home"</span></span>,<span class="hljs-literal"><span class="hljs-literal">null</span></span>,<span class="hljs-literal"><span class="hljs-literal">null</span></span>)&lt;/li&gt; @<span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (IModule module <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> modules) { &lt;li <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"MenuItem"</span></span>&gt;@Html.ActionLink(module.Title, <span class="hljs-string"><span class="hljs-string">"Index"</span></span>, module.EntryControllerName)&lt;/li&gt; } &lt;/ul&gt; ... &lt;/body&gt; &lt;/html&gt;</code> </pre><br>  Thus we will add links to the loaded modules. <br><br><h4>  Instead of conclusion </h4><br>  Here is a plug-in site on ASP.NET MVC.  Not everything is perfect, not everything is beautiful, I agree.  But it performs its main task.  I want to note that when working with a real project, it will be very convenient to set up commands for post-compiling plug-in projects that will upload the result to the plug-ins folder of the base site. <br>  I also want to note that each module can be developed and tested as a separate site, and after compiling it into a ready-made module, it is simply connected to the project. <br>  There is a small subtlety of working with scripts and links to third-party libraries.  First, the plugin will use scripts located in the folders of the base site.  That is, if you add a script at the development stage of the plugin, do not forget to put it in the appropriate base class directory (this is also relevant for styles, images, etc.). <br>  Secondly, the connected third-party library should be placed in the bin folder of the base site.  Otherwise, you will get an error stating that the necessary assembly could not be found. <br>  Thirdly, your plugin will work with the web.config file of the base site.  Thus, if the plugin uses the connection string or another section that is read from the configuration file, you need to manually transfer it. <br><br>  I hope that this article will be interesting to someone. <br><br>  Project on GitHub - <a href="https://github.com/EkzoMan/EkzoPluginsSystem">link</a> <br>  Project with MetroUI template - <a href="https://github.com/EkzoMan/EkzoPluginsSystem/tree/MetroLayout">link</a> </div><p>Source: <a href="https://habr.com/ru/post/202776/">https://habr.com/ru/post/202776/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202766/index.html">Game Life on LiveScript in 30 lines</a></li>
<li><a href="../202768/index.html">Monitoring the quality of service. Best practics</a></li>
<li><a href="../202770/index.html">LG Smart TVs Spying on Users</a></li>
<li><a href="../202772/index.html">Elektron Octatrack - details</a></li>
<li><a href="../202774/index.html">There is a possibility of glitches in Chrome / Chromium 31, Opera 18: selectors like nth-last-child can work incorrectly</a></li>
<li><a href="../202778/index.html">New Hackathons and Tizen Training! And something about the past ...</a></li>
<li><a href="../202780/index.html">We make a prefix - Geiger counter to the iPhone in 2 hours</a></li>
<li><a href="../202782/index.html">Integrating wysiwyg editor with Django. Overview</a></li>
<li><a href="../202784/index.html">XSS'im iOS devices on the example of software from Facebook, Google, VKontakte</a></li>
<li><a href="../202786/index.html">My.com. Take off? Will not take off?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>