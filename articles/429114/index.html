<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to pass cyber tests on the "Checkpoint" part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone, I am Nikita Curtin, curator of the Israeli High School of IT and Security HackerU . 

 And I continue to talk about cyber tests from t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to pass cyber tests on the "Checkpoint" part 2</h1><div class="post__text post__text-html js-mediator-article">  Hello everyone, I am Nikita Curtin, curator of the Israeli High School of IT and Security <a href="https://hackeru.pro/">HackerU</a> . <br><br>  And I continue to talk about cyber tests from the leading Israeli company in the field of information security Checkpoint.  In the previous <a href="https://habr.com/company/vyshtech/blog/429112/">post</a> I described how I passed four tests, and in this I want to tell you about the following three, which I managed to pass. <br><br>  For those who missed the first post I will tell, <a href="https://www.checkpoint.com/">Checkpoint</a> this summer, has published a series of cyber tests. <br>  Challenge officially ended by the end of September 2018. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Tasks were divided into six categories: <br><br>  ‚Ä¢ Logic <br>  ‚Ä¢ Web <br>  ‚Ä¢ Programming <br>  ‚Ä¢ Networking <br>  ‚Ä¢ Reversing <br>  ‚Ä¢ Surprise <br><br>  Two tasks for each direction.  As I already <a href="https://habr.com/company/vyshtech/blog/429112/">wrote</a> , Checkpoint has already managed to gain respect and interest on my part, so I decided to accept these challenges.  However, in view of employment, I was able to allow myself to take on only 8 of 12 tasks (from four different categories).  And I managed to solve 7 of them. <br><br>  So: <br><br>  <b><u>Challenge: "Puzzle"</u></b> <b><br></b> <br>  Description: <br><br>  <i>We finally found you!</i> <i><br><a name="habracut"></a></i>  <i>We need to assemble this puzzle, and as the prophecy says, only you are capable of it.</i> <i><br><br></i>  <i>The puzzle is very fancy.</i>  <i>It consists of a board with 10 columns and 10 rows.</i>  <i>Total - 100 parts.</i>  <i>And each of them - carries a mystery!</i>  <i>Details consist of four parts: upper, lower, right and left.</i>  <i>Each share is a number.</i>  <i>For example:</i> <br><br><img src="https://habrastorage.org/webt/ro/fp/zi/rofpzimgq7f1k4e6xf1mmq2gal8.png" alt="image"><br><br>  Over - 12, on the right - 3, below - 4 and on the left - 5. <br><br>  In order for the puzzle to take shape, all the details must be placed on the board in such a way that each share is adjacent to an equal in value. <br><br>  In addition, the share that does not adjoin to anything, but is part of the board's border, must be with a value of 0. The remaining shares may not have a zero value.  Here is a true example of 4 parts: <br><br><img src="https://habrastorage.org/webt/4l/f-/f3/4lf-f3xngozatodkmrhrchr1dq8.png" alt="image"><br><br>  At the top of the board, all shares forming the boundary are zero. <br><br>  Consider the top left part.  Its right share is equal to 9, and the share adjacent to it (the left share of the upper right part) is also equal to 9. <br><br>  Unfortunately, all our items are shuffled.  They are in the following format: <br>  Cube id [share];  cube id, [share];‚Ä¶ cube id, [share] <br><br>  Where id of the cube are numbers from 0 to 99, and the shares consist of numbers arranged in order: upper, right, lower, left. <br><br>  For example, look at the following shuffled board: <br><br><img src="https://habrastorage.org/webt/7r/ch/b5/7rchb5mvhqkjofnwbfgpfyhqkjg.png" alt="image"><br><br>  Here is the line describing this board: <br><br><img src="https://habrastorage.org/webt/-v/5m/bb/-v5mbb_yeajj5bowqfmsfo2opkc.png" alt="image"><br><br>  We need you to complete the puzzle! <br><br>  Write us a line that looks exactly like this: <br><br>  Id of the cube, how many times it needs to be rotated clockwise;  cube id, how many times it should be rotated clockwise; ... cube id, how many times it should be rotated clockwise <br><br>  The line with the solution of this board will look like this: <br><br><img src="https://habrastorage.org/webt/nu/bq/9u/nubq9upcq28iwqlynf_kbhga21a.png" alt="image"><br><br>  The above line corresponds to the following (solved) puzzle: <br><br><img src="https://habrastorage.org/webt/bl/hy/yg/blhyygeg8jqanyckdq8fuyb7tqe.png" alt="image"><br><br>  Consider the top left part.  In the line it corresponds to the designation "2,2".  As we take the cube number 2 from the input: <br><br><img src="https://habrastorage.org/webt/v1/rg/ex/v1rgexuqg2ti5d3a12yhosilp40.png" alt="image"><br><br>  But we twist it clockwise twice and get [0,19,5,0]. <br><br>  Now consider the upper middle part.  In the line it corresponds to the designation "1.0".  Therefore, we take the cube number 1 from the input: <br><br><img src="https://habrastorage.org/webt/hs/c1/jh/hsc1jhahrebqbixtaao4yhjase8.png" alt="image"><br><br>  And we don‚Äôt twist it at all (yes, spin 0 times) - it means that it is already in the correct position. <br><br>  Got it? <br>  Now help us to complete the puzzle! <br><br>  It looks like this: <br><br><img src="https://habrastorage.org/webt/8d/af/-e/8daf-en3ff-p2oynyeub5scofmm.png" alt="image"><br><br>  Good luck! <br><br>  Theoretically, this problem can be solved in many different ways.  Find your own and share it.  I reflected on several options and finally came to the following conclusions: <br><br>  The first.  At any given time, I just need to define one cube.  For each cube, I will surely always know two sides: the top and the left.  At the beginning it is 0 and 0. The next cube at the top will also have 0, and on the left, the number corresponding to the number of the right fraction of the previous cube. <br>  The second.  Because of the huge number of different variations between cubes, I should try to make as few steps as possible and get rid of senseless checking at the first negative result. <br><br>  Third.  To work with different cubes, I always need to remember their initial position (id), the number of turns from the starting point and, apparently, the numbers of the sides (top, right, bottom, left). <br><br>  Fourth.  The initial input is a string.  And the output is also a string (and not the current position). <br><br>  Based on all this, I have developed the following strategy for myself: <br><br>  To move linearly - from left to right until, until I rest in the right corner.  Next, go down to the line and start from the bottom left of the cube, which is above. <br>  Compliance should be checked after each rotation.  So if 4 turns have already been made and there is still no match for this cube, I take the next one.  Each checked cube can potentially be checked with all the other details, for this I can recursively repeat the initialization of each of them with a full set of all other cubes. <br>  To keep track of all the manipulations with the original data, I chose an object-oriented programming method, in which a cube is an object having an id, a number of rotations, and four sides: top, right, bottom, and left. <br><br>  Instead of copying the original state and avoiding false counts after multiple rotations, I always increased the count by one.  But when I checked the final number of rotations, I used modulo (remainder of division) by 4. <br><br>  For example, if one rotation is necessary (from [1,2,3,4] to [4,1,2,3]), but first three rotations were mistakenly made (at present [2,3,4,1] ), next time you need 2 (from the current [2,3,4,1] to the required [4,1,2,3]).  3 plus 2 equals 5. And 5% 4 = 1, and this is what you need. <br>  I always need to keep track of used cubes and prevent repeated checks.  For this, I use the table of cubes id.  And if the compared cube matches, I remove it from the list. <br><br>  I selected the following data structures: <br><br>  HashMap - to bind id (initial position) and a cube built from the input string. <br>  Stack - to check the associated id cubes. <br>  Array - for temporary testing of the result. <br><br>  Object code cube: <br><br><img src="https://habrastorage.org/webt/o0/pu/c5/o0puc5wh56pmarkairhvwzlr8ns.png" alt="image"><br><br>  String manipulation functions: <br><br><img src="https://habrastorage.org/webt/q5/nv/5-/q5nv5-vut-eopwx1mp4ikwtnrys.png" alt="image"><br><br>  The logic of the decision to find matching cubes: <br><br><img src="https://habrastorage.org/webt/qg/tw/gf/qgtwgfmyr3rvrxh-6qu_ukehsws.png" alt="image"><br><br>  Result: <br><br><img src="https://habrastorage.org/webt/6v/cx/lu/6vcxlu5y7wxynptwm9l9rpgo8gi.png" alt="image"><br><br>  <b><u>Challenge: Ping Pong</u></b> <b><br></b> <br>  Description: <br><br>  <i>I bet you're not fast enough to beat me.</i> <i><br></i>  <i>Here is where I am:</i> <i><br></i>  <i>nc 35.157.111.68 10158</i> <br><br>  By running this command, you get: <br><br><img src="https://habrastorage.org/webt/9r/qi/jg/9rqijgzy-rkju8jkn8crf0tcidw.png" alt="image"><br><br><br>  At first glance, it seems that this is a task to work with streams. <br><br>  However, after receiving the first data, it seems that it falls into the Timeout, and then it will completely disappear. <br><br>  When the data ends, a new row delimiter appears. <br><br>  I recreated the stream using Python code. <br>  It seemed to work, so I added an iterative code that repeats the ping-pong algorithm, and I will wait until the flag appears. <br><br><img src="https://habrastorage.org/webt/ae/ew/qv/aeewqvyipvulo3sra043qr8-_8q.png" alt="image"><br><br>  After a huge number of such ping-pong repassings (perhaps more than a thousand) between the client and the server, I finally achieve the goal. <br><br><img src="https://habrastorage.org/webt/gr/zc/l2/grzcl2pqb9tvvi8xy3hpgnygsxe.png" alt="image"><br><br>  <b><u>Challenge: "Protocol"</u></b> <b><br></b> <br>  Description: <br><br>  <i>Hi!</i> <i><br></i>  <i>We need to extract the secret data from a special server.</i>  <i>We don‚Äôt know much about him, but we managed to intercept traffic that communicates with this server.</i> <i><br></i>  <i>We also know that the path to this secret file is: /usr/PRivAtE.txt</i> <i><br><br></i>  <i>You can find the sniff file here (link to file).</i> <i><br><br></i>  <i>Please tell us what the secret is!</i> <i><br></i>  <i>Good luck!</i> <br><br>  I downloaded the file and opened it using Wireshark <br><br><img src="https://habrastorage.org/webt/xr/8w/kd/xr8wkdeumagcre2pxg8wfqp1q9k.png" alt="image"><br><br>  And checked the registered negotiations <br><br><img src="https://habrastorage.org/webt/no/-i/sf/no-isflaw80tnfvyp3z_58taope.png" alt="image"><br><br>  It allowed me to figure out what was going on. <br><br><img src="https://habrastorage.org/webt/tv/0i/rj/tv0irjs-zhopvvhzuv7a6sp9qec.png" alt="image"><br><br>  I noticed that there were negotiations between IP 35.157.111.68 through port 20120 and SSH port 22. I should check this port 20120, I decided, and then go to SSH (later I realized that this was not necessary). <br><br>  I used the nc command to check this IP and port, and received the answer: ‚Äú0 8 Welcome‚Äù <br><br><img src="https://habrastorage.org/webt/s8/hj/yu/s8hjyugnf-e3vforoayk909qjs4.png" alt="image"><br><br>  I wasn‚Äôt sure what input he was expecting, so I went back to Wireshark to see if there might still be some clues left. <br><br>  I filtered all data packets for 35.157.111.68 on port 20120 and found an easy-to-read conversation: <br><br><img src="https://habrastorage.org/webt/5a/of/h6/5aofh6wwnwynvbaxqo7paa2anye.png" alt="image"><br><br><img src="https://habrastorage.org/webt/bj/6e/it/bj6eitbpapmcuq17kx-789byrdg.png" alt="image"><br><br><img src="https://habrastorage.org/webt/ce/_m/wd/ce_mwdfqchntjklrjyfltfweori.png" alt="image"><br><br><img src="https://habrastorage.org/webt/rp/ha/5l/rpha5lsw4gnlnxxg2ytce4aky80.png" alt="image"><br><br><img src="https://habrastorage.org/webt/so/7f/fd/so7ffdopvikuaub4fdmhcoypcho.png" alt="image"><br><br>  I recreated all this using the nc command line: <br><br><img src="https://habrastorage.org/webt/zn/sj/yz/znsjyzaxr8obutbvgay1fbst0ec.png" alt="image"><br><br>  I noticed that the answer to my ‚Äú2 3 XOR‚Äù request was different from the one in the file. <br>  I repeated the whole procedure over and over again to see if the answer changes every time. <br><br><img src="https://habrastorage.org/webt/tu/wb/j7/tuwbj7ppkxqaomac-dekjdywm8k.png" alt="image"><br><br><img src="https://habrastorage.org/webt/c3/pt/n0/c3ptn0h7u_ntwctqfqvasooo51a.png" alt="image"><br>  As I thought, the 4 values ‚Äã‚Äãeach time were different, as were the final data. <br>  It seems that the four values ‚Äã‚Äãobtained are the key to decipher the final data. <br>  I also noticed that the numbers in front of each data packet are not random. <br><br>  It looks like this. <br><br>  The first number indicates the order: 0 -&gt; first, 1 -&gt; second, 2 -&gt; third, etc ... <br>  The second number means the length of the phrase 8 -&gt; ‚ÄúWelcome‚Äù, 5 -&gt; ‚ÄúHello‚Äù -&gt;, etc ... <br><br>  I wondered if this was the key to decoding.  Since the final data is a continuous block line of 4 HEX values ‚Äã‚Äãand the XOR key is also 4 HEX values.  Perhaps I can iterate over each one and divide it into separate bytes, after which they will be copied with bytes from the key. <br><br>  And I tried to perform the decryption: <br><br><img src="https://habrastorage.org/webt/6q/8m/sw/6q8mswd1apewxuy7s4rz1ayjpbu.png" alt="image"><br><br>  Everything turned out, but there was no flag in the received data. <br><br><img src="https://habrastorage.org/webt/0e/u4/j8/0eu4j8jbruzcinckrm517qw7phy.png" alt="image"><br><br>  I reread the rules and remembered that the path to this secret file is: /usr/PRivAtE.txt <br><br>  I repeated the procedure again, but this time I requested the path "/usr/PRivAtE.txt" <br><br><img src="https://habrastorage.org/webt/pn/ro/_o/pnro_ouggelhgvcznucpayydnjo.png" alt="image"><br><br>  I tried to decrypt the final data again: <br><br><img src="https://habrastorage.org/webt/mt/-v/87/mt-v87khiqcfyrzm_1smjmjqjdy.png" alt="image"><br><br>  And the flag was in my hands: <br><br><img src="https://habrastorage.org/webt/y5/rv/pu/y5rvpujdvbipy4tpbdz91jmffiw.png" alt="image"><br><br>  Did you succeed?  Write your ideas and options, I will be glad to comment. </div><p>Source: <a href="https://habr.com/ru/post/429114/">https://habr.com/ru/post/429114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../429104/index.html">High kind data</a></li>
<li><a href="../429106/index.html">Infrastructure IC</a></li>
<li><a href="../429108/index.html">Google: removing "pirated" links from the issue will not solve the problem of illegal content</a></li>
<li><a href="../429110/index.html">CSS tips that you can hardly find in tutorials</a></li>
<li><a href="../429112/index.html">How to pass cyber tests on "Checkpoint"</a></li>
<li><a href="../429116/index.html">Creating responsive images</a></li>
<li><a href="../429120/index.html">Java Challengers # 3: Polymorphism and Inheritance</a></li>
<li><a href="../429122/index.html">NetApp Nearest Future</a></li>
<li><a href="../429124/index.html">Atypical organization of videoconferencing in a large chemical company</a></li>
<li><a href="../429126/index.html">On a visit to father</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>