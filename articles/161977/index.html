<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Box2d and libgdx</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon. 

 Not so long ago I began to study the work of Libgdx and found that there are not so many articles on this framework in Russian. Of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Box2d and libgdx</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon. <br><br>  Not so long ago I began to study the work of Libgdx and found that there are not so many articles on this framework in Russian.  Of course, I met articles in Russian, but they were only translations of offs.  manuals.  There were truth and articles where the developers tried to talk about their creations.  But in one article, not to embrace everything, as a result, in such articles it was all ponamesh. <br><br>  I set out to gradually write articles about various aspects / parts of LibGDX so that in the end, anyone could make a more or less workable version of their own toy.  In this article I would like to tell you about Box2D, which is present in LibGDX. <br><img src="https://habrastorage.org/getpro/habr/post_images/51f/7ba/872/51f7ba872f4d4ef34889e41c691f0a94.jpg" alt="image"><br><a name="habracut"></a><br>  Box2D is a real-time physics engine and is designed to work with two-dimensional physical objects.  If you are developing a game with a side view / platformer, then this is the perfect solution. <br>  All required classes are in the <b>com.badlogic.gdx.physics.box2d</b> package. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I took the architecture as the basis, which I described in <a href="http://suvitruf.ru/2012/10/20/2307/">one</a> of my articles.  The MVC pattern is used. <br><br><h4>  Gamescreen </h4><br>  <b>GameScreen</b> implements <b>Screen, InputProcessor</b> , which allows it to handle all user actions: clicks, etc. <br><br>  It creates the necessary classes: MyWorld, WorldController, WorldRenderer. <br>  The article, which took as a basis instead of MyWorld, uses World.  I had to change it in order not to conflict with the class of the same name from the Box2D package. <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">show</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  ,        ,      MyWorld.CAMERA_WIDTH = MyWorld.CAMERA_HEIGHT* Gdx.graphics.getWidth()/Gdx.graphics.getHeight(); world = new MyWorld(); renderer = new WorldRenderer(world, MyWorld.CAMERA_WIDTH, MyWorld.CAMERA_HEIGHT,true); controller = new WorldController(world); Gdx.input.setInputProcessor(this); //     }</span></span></code> </pre> <br><br>  Naturally, it is necessary to override all the processing methods: touchDown, touchUp and others. <br><br>  As an example, redefine touchDown, touchUp so that our character can move left, right and jump. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ChangeNavigation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y)</span></span></span></span>{ controller.resetWay(); <span class="hljs-comment"><span class="hljs-comment">//   ,  ,     () if(height-y &gt; world.getPlayer().getPosition().y * renderer.ppuY) controller.upPressed(); //   ,  ,     if ( x&lt; world.getPlayer().getPosition().x * renderer.ppuX) controller.leftPressed(); //   ,  ,     if (x&gt; (world.getPlayer().getPosition().x )* renderer.ppuX) controller.rightPressed(); } @Override public boolean touchDown(int x, int y, int pointer, int button) { if (!Gdx.app.getType().equals(ApplicationType.Android)) return false; ChangeNavigation(x,y); return true; } @Override public boolean touchUp(int x, int y, int pointer, int button) { if (!Gdx.app.getType().equals(ApplicationType.Android)) return false; controller.resetWay(); return true; } @Override public boolean touchDragged(int x, int y, int pointer) { ChangeNavigation(x,y); return false; }</span></span></code> </pre><br><br>  In <b>GameScreen</b> , the user actions are processed and the controller is signaled.  The key method here is <code>render()</code> , which fires after a certain amount of time and processes the logic and draws objects. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> delta)</span></span></span><span class="hljs-function"> </span></span>{ Gdx.gl.glClearColor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">232F</span></span>/<span class="hljs-number"><span class="hljs-number">255</span></span>); Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT); controller.update(delta); renderer.render(delta); }</code> </pre><br><br><h4>  Myworld </h4><br><br>  <b>MyWorld</b> will be just a container of objects.  It will also contain a link to a copy of the World class from the package.  It is necessary to define objects. <br><br><pre> <code class="java hljs">World world; <span class="hljs-comment"><span class="hljs-comment">// Player player; //  Array&lt;MovingPlatform&gt; platforms = new Array&lt;MovingPlatform&gt;(); // public MovingPlatform groundedPlatform = null;</span></span></code> </pre><br><br>  Well, create objects: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyWorld</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ width = <span class="hljs-number"><span class="hljs-number">30</span></span>; height = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   ,    () world = new World(new Vector2(0, -20), true); createWorld(); } private void createWorld(){ BodyDef def = new BodyDef(); def.type = BodyType.DynamicBody; Body boxP = world.createBody(def); player = new Player(boxP); player.getBody().setTransform(3.0f, 4.0f, 0); player.getBody().setFixedRotation(true); Body box = createBox(BodyType.StaticBody, 1, 1, 0); for(int i = 0; i &lt; 10; i++) { box = createBox(BodyType.DynamicBody, (float)Math.random(), (float)Math.random(), 13); box.setTransform((float)Math.random() * 10f - (float)Math.random() * 10f, (float)Math.random() * 10 + 6, 0); } platforms.add(new MovingPlatform(world, 3F, 3, 1,0.25F, 2, 0, 2)); for(int i=1;i&lt;width; ++i){ Body boxGround = createBox(BodyType.StaticBody, 1F, 1F, 0); boxGround.setTransform(i,0,0); } } private Body createBox(BodyType type, float width, float height, float density) { BodyDef def = new BodyDef(); def.type = type; Body box = world.createBody(def); PolygonShape poly = new PolygonShape(); poly.setAsBox(width, height); box.createFixture(poly, density); poly.dispose(); return box; }</span></span></code> </pre><br><br>  <code>BodyDef</code> is a body definition that contains all data about a solid body.  You can reuse this definition for various objects. <br><br>  <code>BodyType</code> - body type.  It can be one of three possible: <br>  static - zero mass, zero speed, can only be moved by software; <br>  kinematic - zero mass, non-zero speed, can be shifted; <br>  dynamic - positive mass, non-zero speed, can be shifted. <br><br>  static should be used for objects that do not need to move.  As an example: the floor walls. <br><br>  <code>Body</code> , in fact, the body itself. <br>  <code>Body</code> objects can be moved, rotated using the <code>setTransform()</code> method. <br><br><h4>  Player </h4><br>  Player class is a character: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Player</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> MAX_VELOCITY = <span class="hljs-number"><span class="hljs-number">3f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> SPEED = <span class="hljs-number"><span class="hljs-number">5f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> SIZE = <span class="hljs-number"><span class="hljs-number">0.8f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Fixture playerPhysicsFixture; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Fixture playerSensorFixture; Body box; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Player</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Body b)</span></span></span></span>{ box = b; PolygonShape poly = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PolygonShape(); poly.setAsBox(<span class="hljs-number"><span class="hljs-number">0.4f</span></span>, <span class="hljs-number"><span class="hljs-number">0.4f</span></span>); playerPhysicsFixture = box.createFixture(poly, <span class="hljs-number"><span class="hljs-number">3</span></span>); poly.dispose(); CircleShape circle = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CircleShape(); circle.setRadius(<span class="hljs-number"><span class="hljs-number">0.41f</span></span>); circle.setPosition(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0f</span></span>)); playerSensorFixture = box.createFixture(circle, <span class="hljs-number"><span class="hljs-number">1</span></span>); setFriction(<span class="hljs-number"><span class="hljs-number">10F</span></span>); circle.dispose(); box.setBullet(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Body </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBody</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> box; } <span class="hljs-comment"><span class="hljs-comment">//    public void setFriction(float f){ playerSensorFixture.setFriction(f); playerPhysicsFixture.setFriction(f); } public Vector2 getPosition(){ return box.getPosition(); } public Vector2 getVelocity() { return velocity; } Vector2 velocity = new Vector2(); public void update(float delta) { Vector2 vel = box.getLinearVelocity(); velocity.y = vel.y; box.setLinearVelocity(velocity); if(isJump) {box.applyLinearImpulse(0, 8, box.getPosition().x, box.getPosition().y); isJump = false;} } boolean isJump = false; public void jump(){ isJump = true; } public void resetVelocity(){ getVelocity().x =0; getVelocity().y =0; } }</span></span></code> </pre><br><br>  In this example, I showed that in Box2D you can create objects from kinematic pairs.  In this case, the player consists of a glued rectangle and a circle. <br><br>  To move objects in principle, you can in different ways, until the explicit change of position.  But in Box2D there are two special methods for this: <br>  <code>applyLinearImpulse()</code> - set the momentum to the object.  As in the real world, if you push an object, then according to the impulse, the body will move until the friction suppresses the impulse. <br>  <code>setLinearVelocity()</code> - set the speed of movement.  Unlike the impulse, the speed will be constant until you change it. <br><br>  I personally use <code>setLinearVelocity()</code> to move along the X axis.  While you keep your finger on the wheelbarrow, the character will move, when you release, the character will stop.  If you use <code>applyLinearImpulse()</code> to move horizontally, the character will still move some time after you remove your finger from the screen. <br>  In principle, you can sometimes <code>applyLinearImpulse()</code> for left / right movement.  As an example, if the character moves on a slippery surface (ice, as an example). <br><br> <code>box.setBullet(true);</code>  indicates that the body should be treated like a bullet when it detects collisions. <br><br><h4>  Movingplatform </h4><br>  <code>MovingPlatform</code> is a moving platform. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MovingPlatform</span></span></span><span class="hljs-class"> </span></span>{ Body platform; Vector2 pos = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(); Vector2 dir = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(); Vector2 vel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> maxDist = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> width; <span class="hljs-comment"><span class="hljs-comment">//Vector2 l = new Vector2(); public MovingPlatform(World world, float x, float y, float width, float height, float dx, float dy, float maxDist) { platform = createBox(world, BodyType.KinematicBody, width, height, 1); this.width = width; pos.x = x; pos.y = y; dir.x = dx; dir.y = dy; vel.x = dx; vel.y = dy; this.maxDist = maxDist; platform.setTransform(pos, 0); platform.getFixtureList().get(0).setUserData("p"); platform.setUserData(this); } public void resume(){ dir.x= vel.x; dir.y = vel.y; } public void pause(){ vel.x = dir.x; vel.y = dir.y; dir.x = 0; dir.y = 0; platform.setLinearVelocity(dir); } public void update(float deltaTime) { if(dir.x &lt; 0 &amp;&amp; platform .getPosition().x &lt; pos.x-maxDist) { platform .getPosition().x =pos.x; dir.mul(-1); } if(dir.x &gt; 0 &amp;&amp; platform .getPosition().x&gt; pos.x+maxDist) { platform .getPosition().x =pos.x+maxDist; dir.mul(-1); } platform.setLinearVelocity(dir); } private Body createBox(World world,BodyType type, float width, float height, float density) { BodyDef def = new BodyDef(); def.type = type; Body box = world.createBody(def); PolygonShape poly = new PolygonShape(); poly.setAsBox(width/2, height/2); Fixture f = box.createFixture(poly, density); poly.dispose(); return box; } }</span></span></code> </pre><br>  The platform will move a certain distance from its original position. <br><br><h4>  Worldcontroller </h4><br>  In <code>WorldController</code> , the logic is updated in response to user actions in the <code>update()</code> method. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> grounded ; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> delta)</span></span></span><span class="hljs-function"> </span></span>{ Array&lt;MovingPlatform&gt; platforms = world.getPlatforms(); <span class="hljs-comment"><span class="hljs-comment">//   for(int i = 0; i &lt; platforms.size; i++) { MovingPlatform platform = platforms.get(i); platform.update(Math.max(1/60.0f, delta)); } grounded = isPlayerGrounded(Gdx.graphics.getDeltaTime()); //  processInput(); //   world.getPlayer().update(delta); }</span></span></code> </pre><br><br>  To process user clicks and specify a new direction of movement is necessary. <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">//            private void processInput() { Player player = world.getPlayer(); //    if (keys.get(Keys.LEFT)) player.getVelocity().x =- Player.SPEED; //    if (keys.get(Keys.RIGHT)) player.getVelocity().x = Player.SPEED; //   if (keys.get(Keys.UP)) //    if(grounded) // player.jump(); //    if(!grounded) //  world.getPlayer().setFriction(0f); //   else{ if(keys.get(Keys.RIGHT) || keys.get(Keys.LEFT)) world.getPlayer().setFriction(0.2f); else world.getPlayer().setFriction(100f); } }</span></span></code> </pre><br><br>  It remains only to write a method to check whether the character is on the ground.  To do this, you must obtain a list of all the contacts of objects.  Among them, choose character contacts.  If among the contacts there is an object that is below the character, therefore it is on a hard surface. <br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isPlayerGrounded</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime)</span></span></span><span class="hljs-function"> </span></span>{ world.groundedPlatform = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; List&lt;Contact&gt; contactList = world.getWorld().getContactList(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; contactList.size(); i++) { Contact contact = contactList.get(i); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(contact.isTouching() &amp;&amp; (contact.getFixtureA() == world.getPlayer().playerSensorFixture || contact.getFixtureB() == world.getPlayer().playerSensorFixture)) { Vector2 pos = world.getPlayer().getPosition(); WorldManifold manifold = contact.getWorldManifold(); <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> below = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; manifold.getNumberOfContactPoints(); j++) { below &amp;= (manifold.getPoints()[j].y &lt; pos.y - <span class="hljs-number"><span class="hljs-number">0.4f</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(below) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(contact.getFixtureA().getUserData() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; contact.getFixtureA().getUserData().equals(<span class="hljs-string"><span class="hljs-string">"p"</span></span>)) { world.groundedPlatform = (MovingPlatform)contact.getFixtureA().getBody().getUserData(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(contact.getFixtureB().getUserData() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; contact.getFixtureB().getUserData().equals(<span class="hljs-string"><span class="hljs-string">"p"</span></span>)) { world.groundedPlatform = (MovingPlatform)contact.getFixtureB().getBody().getUserData(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> </pre><br><br>  Depending on where the character is, the friction force changes.  With zero friction, the character will not move with the platform, but will remain in place, as if to slide. <br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/ppcxpgpXqO0%3Ffeature%3Doembed&amp;xid=25657,15700022,15700043,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhj1hogEPdEW8uS57x7DUZ1iWs98Zg" frameborder="0" allowfullscreen=""></iframe><br><br>  It is logical to assume that it is necessary to expose more friction.  I watched foreign manuals ... This method does not always work. <br><br>  You can then go the other way: to change the friction force is not the character, and the contact.  That is, in the isPlayerGrounded method, write something like: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!keys.get(Keys.LEFT) &amp;&amp; !keys.get(Keys.RIGHT)) contact.setFriction(<span class="hljs-number"><span class="hljs-number">200F</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> contact.setFriction(<span class="hljs-number"><span class="hljs-number">0F</span></span>);</code> </pre><br>  Then, in case the character just stands, he will move along with the platform due to a lot of friction.  If the character needs to move, then reduce friction. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/50_scK0gdPY%3Ffeature%3Doembed&amp;xid=25657,15700022,15700043,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhh7o4qwzDRIttotOqZmHFkmdeKSAw" frameborder="0" allowfullscreen=""></iframe><br><br>  Actually everything.  Our character can move left and right, as well as jump.  It can also move randomly generated blocks. <br><br>  It is necessary now only to render objects. <br><br><h4>  World renderer </h4><br>  In the <code>WorldRenderer</code> class, <code>WorldRenderer</code> are <code>WorldRenderer</code> . <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WorldRenderer</span></span></span><span class="hljs-class"> </span></span>{ Box2DDebugRenderer renderer; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> CAMERA_WIDTH = <span class="hljs-number"><span class="hljs-number">10f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> CAMERA_HEIGHT = <span class="hljs-number"><span class="hljs-number">15f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ppuX; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ppuY; MyWorld world; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> OrthographicCamera cam; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WorldRenderer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MyWorld world, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> w, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> h, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> debug)</span></span></span><span class="hljs-function"> </span></span>{ renderer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box2DDebugRenderer(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.world = world; CAMERA_WIDTH = w; CAMERA_HEIGHT = h; ppuX = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)Gdx.graphics.getWidth() / CAMERA_WIDTH; ppuY = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)Gdx.graphics.getHeight() / CAMERA_HEIGHT; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.cam = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrthographicCamera(CAMERA_WIDTH, CAMERA_HEIGHT); SetCamera(CAMERA_WIDTH / <span class="hljs-number"><span class="hljs-number">2f</span></span>, CAMERA_HEIGHT / <span class="hljs-number"><span class="hljs-number">2f</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetCamera</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.cam.position.set(x, y,<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.cam.update(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispose</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ world.dispose(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> delta)</span></span></span><span class="hljs-function"> </span></span>{ renderer.render(world.getWorld(), cam.combined); world.getWorld().step(delta, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>); } }</code> </pre><br><br>  The rendering itself in the <code>render()</code> method takes place.  This example is used to draw a Box2DDebugRenderer in debug mode to display the borders of objects.  In the final version of your application in the <code>render()</code> method, you need to display any sprites for all objects. <br><br> <code>world.getWorld().step(delta, 4, 4);</code>  indicates the frequency with which to update physics.  In most cases, I think, there is no need to update physics more often than drawing takes place. <br>  PS I just started to study Box2D myself, so I will be glad to any tips and criticism. </div><p>Source: <a href="https://habr.com/ru/post/161977/">https://habr.com/ru/post/161977/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161967/index.html">The study of the attitude of popular programming languages ‚Äã‚Äãto random errors</a></li>
<li><a href="../161969/index.html">Inventarium.mobi - we pumped your feedback forms!</a></li>
<li><a href="../161971/index.html">Instant removal of special offers with kindle paperwhite</a></li>
<li><a href="../161973/index.html">The long-awaited revolutionary release of QEMU 1.3 has been released.</a></li>
<li><a href="../161975/index.html">How to draw Zelenograd</a></li>
<li><a href="../161979/index.html">One Div: icons on CSS</a></li>
<li><a href="../161981/index.html">Promotion of mobile applications</a></li>
<li><a href="../161987/index.html">Standard PHP Library (SPL) - Part 1: Data Structures</a></li>
<li><a href="../161989/index.html">Perl6 - I / O Modules</a></li>
<li><a href="../161991/index.html">Weather Station Thunder-2M (Anemometer)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>