<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implement Bootstrap 3 Datepicker in SonataAdminBundle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this little article I will talk about how to connect a convenient datepicker to the symfony admin panel . By default, the datepicker in SonataAdmin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implement Bootstrap 3 Datepicker in SonataAdminBundle</h1><div class="post__text post__text-html js-mediator-article">  In this little article I will talk about how to connect a <a href="http://eonasdan.github.io/bootstrap-datetimepicker/">convenient datepicker</a> to the symfony admin <a href="http://eonasdan.github.io/bootstrap-datetimepicker/">panel</a> .  By default, the datepicker in SonataAdminBundle looks like this: <br><br><img src="https://habrastorage.org/files/ec7/a9e/a62/ec7a9ea6241c45838293d84e9fd28a05.png"><br><br>  And we will turn it into comfortable and beautiful controls: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/a04/8a0/af2/a048a0af2b0348c3bf817cdf678911a2.png"><br><br>  Those who are still suffering with an uncomfortable datepicker, welcome under cat. <br><br>  <i>If you do not need timing, then you can use a ready-made <a href="https://sonata-project.org/bundles/core/master/doc/reference/form_types.html">solution</a> , thanks <a href="http://habrahabr.ru/users/dmkuznetsov/" class="user_link">dmkuznetsov</a></i> <br><a name="habracut"></a><br>  I will not talk about how to install SonataAdminBundle, you can read about this in <a href="http://habrahabr.ru/post/136659/">this article</a> .  I assume that you have already installed the application and admin panel.  Well, let's get started. <br><br><h4>  Datetime field type </h4><br>  The first thing to start with is creating a new form field as <a href="http://symfony.com/doc/2.7/cookbook/form/create_custom_field_type.html">described in the documentation</a> .  You need to create it in the namespace <i>&lt;vendor_name&gt; \ &lt;bundle_name&gt; \ Form \ Type \,</i> otherwise <a href="https://insight.sensiolabs.com/">SensioLabsInsight</a> will swear when testing. <br><br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>\<span class="hljs-title"><span class="hljs-title">Field</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">AbstractType</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">FormView</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">FormInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">FormBuilderInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">OptionsResolver</span></span>\<span class="hljs-title"><span class="hljs-title">OptionsResolver</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">DataTransformerInterface</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Symfony &gt;=2.8 //use Symfony\Component\Form\Extension\Core\Type\TextType; class DateTime extends AbstractType implements DataTransformerInterface { public function buildForm(FormBuilderInterface $builder, array $options) { //           \DateTime $builder-&gt;addModelTransformer($this); } public function transform($value) { return $value; //    DataTransformerInterface } public function reverseTransform($value) { //     \DateTime return $value instanceof \DateTime ? $value : new \DateTime($value); } public function buildView(FormView $view, FormInterface $form, array $options) { //       if ($form-&gt;getData() instanceof \DateTime) { $view-&gt;vars['value'] = $form-&gt;getData()-&gt;format('Ymd H:i'); } // css   bootstrap  $view-&gt;vars['attr']['class'] = 'form-control'; } public function configureOptions(OptionsResolver $resolver) { //   data_class   DataTransformer $resolver-&gt;setDefaults([ 'data_class' =&gt; \DateTime::class ]); } public function getParent() { // Symfony &gt;=2.8 //return TextType::class; // Symfony &lt;2.8 return 'text'; } public function getName() { return 'datetime'; //     datetime } }</span></span></code> </pre> <br>  I did not transfer the standard <a href="http://symfony.com/doc/2.7/reference/forms/types/datetime.html">datetime options</a> to the new class as unnecessary, but you can do it if you need it.  In the <a href="https://habr.com/ru/post/272513/">Time Field Type</a> section, I will describe how to do this using the example of the <a href="http://symfony.com/doc/2.7/reference/forms/types/time.html">with_seconds</a> option. <br><br>  The next item on our program will be the creation of a common form template (themes for forms).  In it, we inherit from the Sonata theme and redefine the date pattern.  The template is saved in the file <i>Resources / views / Form / fields.html.twig</i> .  You can choose another way, but I‚Äôm so used to it. <br><br><pre> <code class="html hljs xml">{% extends 'SonataAdminBundle:Form:form_admin_fields.html.twig' %} {% block datetime_widget %} {% spaceless %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group date form-field-datetime"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> {{ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">block</span></span></span><span class="hljs-tag">('</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">widget_attributes</span></span></span><span class="hljs-tag">') }} {% </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">is</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">empty</span></span></span><span class="hljs-tag"> %}</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ value }}"</span></span></span><span class="hljs-tag"> {% </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">endif</span></span></span><span class="hljs-tag"> %}/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group-addon"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"glyphicon glyphicon-calendar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endspaceless %} {% endblock datetime_widget %}</code> </pre><br>  We will need the <b>form-field-datetime</b> class later to hang JavaScript.  Now we‚Äôll indicate to Sonata that it needs to use a different theme for the forms by <i>setting the</i> following lines in the config <i>app / config / config.yml</i> : <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">sonata_doctrine_orm_admin</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">templates</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">form</span></span>: <span class="hljs-selector-attr"><span class="hljs-selector-attr">[ AcmeDemoBundle:Form:fields.html.twig ]</span></span></code> </pre><br>  Do not forget to create a service for a new form field: <br><br><pre> <code class="hljs tex"> acme.demo.form.type.datetime: class: Acme<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Bundle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DemoBundle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Type</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Field</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DateTime</span></span></span></span> public: false</code> </pre><br>  We do not create a label for the service as described <a href="http://symfony.com/doc/2.7/cookbook/form/create_custom_field_type.html">here</a> because we do not create a new field and we will overload the old one.  For the same reason, we do not need it in public access.  Now let's rewrite the standard form fields.  Create a compiler for the DI container: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Compiler</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Compiler</span></span>\<span class="hljs-title"><span class="hljs-title">CompilerPassInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerBuilder</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FormTypePass</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CompilerPassInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerBuilder $container)</span></span></span><span class="hljs-function"> </span></span>{ $container-&gt;setAlias(<span class="hljs-string"><span class="hljs-string">'form.type.datetime'</span></span>, <span class="hljs-string"><span class="hljs-string">'acme.demo.form.type.datetime'</span></span>); } }</code> </pre><br>  Here we indicate that <b>form.type.datetime</b> is an alias for our newly created acme.demo.form.type.datetime <b>series</b> .  Thus, when in the forms we will create a <b>datetime</b> type field, our service will be used.  So we change the control without changing the project code.  Now connect the compiler to the bundle: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span> <span class="hljs-title"><span class="hljs-title">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpKernel</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerBuilder</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">BundleDemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">Compiler</span></span>\<span class="hljs-title"><span class="hljs-title">FormTypePass</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AcmeDemoBundle</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bundle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerBuilder $container)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::build($container); $container-&gt;addCompilerPass(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FormTypePass()); } }</code> </pre><br>  Now datepicker already has a beautiful and convenient form, it remains only to hang JavaScript to open a drop-down box with a choice of date. <br><br><img src="https://habrastorage.org/files/887/619/5b1/8876195b10b440feadb2c6372aff846b.png"><br><br>  We will install <a href="http://eonasdan.github.io/bootstrap-datetimepicker/">Bootstrap 3 Datepicker</a> which is on <a href="https://packagist.org/packages/eonasdan/bootstrap-datetimepicker">packagist.org</a> , for which many thanks to them.  Let's write the dependency in composer.json: <br><br><pre> <code class="hljs objectivec">{ <span class="hljs-string"><span class="hljs-string">"require"</span></span>: { ‚Ä¶ <span class="hljs-string"><span class="hljs-string">"eonasdan/bootstrap-datetimepicker"</span></span>: <span class="hljs-string"><span class="hljs-string">"~4.17.37"</span></span>, ‚Ä¶ } }</code> </pre><br>  With this package installation it is more convenient to connect it via <b>assetic,</b> which we will do.  Register the following lines in <i>app / config / config.yml</i> : <br><br><pre> <code class="hljs pgsql">assetic: assets: <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>-js: inputs: - <span class="hljs-string"><span class="hljs-string">'%kernel.root_dir%/../vendor/eonasdan/bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js'</span></span> - <span class="hljs-string"><span class="hljs-string">'@AcmeDemoBundle/Resources/public/js/admin.js'</span></span> output: js/<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>.js sonata_admin: templates: layout: AcmeDemoBundle:<span class="hljs-keyword"><span class="hljs-keyword">Admin</span></span>:standard_layout.html.twig</code> </pre><br>  We have defined the <i>js / admin.js file</i> in which our datepicker will build and the JavaScript code that initializes it and hangs it on the appropriate form fields.  This file will be located at <i>web / js / admin.js</i> .  We also redefined the Sonata layout in order to enable our JavaScript.  Let's do this and deal with: <br><br><pre> <code class="html hljs xml">{% extends 'SonataAdminBundle::standard_layout.html.twig' %} {% block javascripts %} {{ parent() }} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ asset('js/admin.js') }}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> {% endblock %}</code> </pre><br>  Now we will create the file <i>Resources / public / js / admin.js</i> in which we will bind our form fields with JavaScript. <br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ $(<span class="hljs-string"><span class="hljs-string">'.form-field-datetime'</span></span>).datetimepicker({ <span class="hljs-attr"><span class="hljs-attr">format</span></span>: <span class="hljs-string"><span class="hljs-string">'YYYY-MM-DD HH:mm'</span></span>, <span class="hljs-attr"><span class="hljs-attr">locale</span></span>: <span class="hljs-string"><span class="hljs-string">'ru'</span></span> }); });</code> </pre><br>  That's all.  Perform assembly assetic and enjoy life: <br><br><pre> <code class="bash hljs">app/console assetic:dump web --no-debug</code> </pre><br><a name="field-date"></a><h4>  Date field type </h4><br>  By analogy, we create a date field with a few differences.  Class for the form field: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>\<span class="hljs-title"><span class="hljs-title">Field</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">AbstractType</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">FormView</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">FormInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">FormBuilderInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">OptionsResolver</span></span>\<span class="hljs-title"><span class="hljs-title">OptionsResolver</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">DataTransformerInterface</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Symfony &gt;=2.8 //use Symfony\Component\Form\Extension\Core\Type\TextType; class Date extends AbstractType implements DataTransformerInterface { public function buildForm(FormBuilderInterface $builder, array $options) { $builder-&gt;addModelTransformer($this); } public function transform($value) { return $value; } public function reverseTransform($value) { return $value instanceof \DateTime ? $value : new \DateTime($value); } public function buildView(FormView $view, FormInterface $form, array $options) { if ($form-&gt;getData() instanceof \DateTime) { $view-&gt;vars['value'] = $form-&gt;getData()-&gt;format('Ym-d'); } $view-&gt;vars['attr']['class'] = 'form-control'; } public function configureOptions(OptionsResolver $resolver) { $resolver-&gt;setDefaults([ 'data_class' =&gt; \DateTime::class ]); } public function getParent() { // Symfony &gt;=2.8 //return TextType::class; // Symfony &lt;2.8 return 'text'; } public function getName() { return 'date'; } }</span></span></code> </pre><br>  Template: <br><br><pre> <code class="html hljs xml">{% block date_widget %} {% spaceless %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group date form-field-date"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> {{ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">block</span></span></span><span class="hljs-tag">('</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">widget_attributes</span></span></span><span class="hljs-tag">') }} {% </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">is</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">empty</span></span></span><span class="hljs-tag"> %}</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ value }}"</span></span></span><span class="hljs-tag"> {% </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">endif</span></span></span><span class="hljs-tag"> %}/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group-addon"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"glyphicon glyphicon-calendar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endspaceless %} {% endblock date_widget %}</code> </pre><br>  Service: <br><br><pre> <code class="hljs pgsql"> acme.demo.form.<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>.date: <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>: Acme\Bundle\DemoBundle\Form\<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>\Field\<span class="hljs-type"><span class="hljs-type">Date</span></span> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> </pre><br>  Add a nickname: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// .. class FormTypePass implements CompilerPassInterface { public function process(ContainerBuilder $container) { // .. $container-&gt;setAlias('form.type.date', 'acme.demo.form.type.date'); } }</span></span></code> </pre><br>  Well, JavaScript: <br><br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// .. $('.form-field-date').datetimepicker({ format: 'YYYY-MM-DD', locale: 'ru' }); });</span></span></code> </pre><br><a name="field-time"></a><h4>  Field type time </h4><br>  By analogy with the previous, but with a few differences.  In our project video clips are published and it is necessary to indicate their duration in the admin panel.  To do this, we use the time field and set the <a href="http://symfony.com/doc/2.7/reference/forms/types/time.html">with_seconds</a> option to <i>true</i> .  In the new form field it was necessary to retain this functionality. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">Bundle</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>\<span class="hljs-title"><span class="hljs-title">Field</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">AbstractType</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">FormView</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">FormInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">FormBuilderInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">OptionsResolver</span></span>\<span class="hljs-title"><span class="hljs-title">OptionsResolver</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Form</span></span>\<span class="hljs-title"><span class="hljs-title">DataTransformerInterface</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Symfony &gt;=2.8 //use Symfony\Component\Form\Extension\Core\Type\TextType; class Time extends AbstractType implements DataTransformerInterface { public function buildForm(FormBuilderInterface $builder, array $options) { $builder-&gt;addModelTransformer($this); } public function transform($value) { return $value; } public function reverseTransform($value) { return $value instanceof \DateTime ? $value : new \DateTime($value); } public function buildView(FormView $view, FormInterface $form, array $options) { if ($form-&gt;getData() instanceof \DateTime) { //     $view-&gt;vars['value'] = $form-&gt;getData()-&gt;format($options['with_seconds'] ? 'H:i:s' : 'H:i'); } $view-&gt;vars['attr']['class'] = 'form-control'; //     $view-&gt;vars['with_seconds'] = $options['with_seconds']; } public function configureOptions(OptionsResolver $resolver) { $resolver-&gt;setDefaults([ 'data_class' =&gt; \DateTime::class, 'with_seconds' =&gt; false //     ]); } public function getParent() { // Symfony &gt;=2.8 //return TextType::class; // Symfony &lt;2.8 return 'text'; } public function getName() { return 'time'; } }</span></span></code> </pre><br>  Template: <br><br><pre> <code class="html hljs xml">{% block time_widget %} {% spaceless %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group date form-field-time"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-with-seconds</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ with_seconds == true ? 1 : 0 }}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> {{ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">block</span></span></span><span class="hljs-tag">('</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">widget_attributes</span></span></span><span class="hljs-tag">') }} {% </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">is</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">not</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">empty</span></span></span><span class="hljs-tag"> %}</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ value }}"</span></span></span><span class="hljs-tag"> {% </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">endif</span></span></span><span class="hljs-tag"> %}/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group-addon"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"glyphicon glyphicon-time"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endspaceless %} {% endblock time_widget %}</code> </pre><br>  Service: <br><br><pre> <code class="hljs pgsql"> acme.demo.form.<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>.time: <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>: Acme\Bundle\DemoBundle\Form\<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>\Field\<span class="hljs-type"><span class="hljs-type">Time</span></span> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> </pre><br>  Add a nickname: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// .. class FormTypePass implements CompilerPassInterface { public function process(ContainerBuilder $container) { // .. $container-&gt;setAlias('form.type.time', 'acme.demo.form.type.time'); } }</span></span></code> </pre><br>  JavaScript will be a little different: <br><br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// .. $('.form-field-time') .each(function () { var el = $(this), options = {locale: 'ru'}; if (el.data('with-seconds') == 1) { options.format = 'HH:mm:ss'; } else { options.format = 'HH:mm'; } el.datetimepicker(options); });</span></span></code> </pre><br><h4>  Conclusion </h4><br>  In the place of detention I will say that there is a very interesting <a href="https://weareoutman.github.io/clockpicker/">ClockPicker</a> library for timing.  If it interests you, then you can easily connect it in my examples. </div><p>Source: <a href="https://habr.com/ru/post/272513/">https://habr.com/ru/post/272513/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272495/index.html">PHP Digest number 75 - interesting news, materials and tools (November 22 - December 6, 2015)</a></li>
<li><a href="../272497/index.html">Disposable without borders</a></li>
<li><a href="../272505/index.html">How do I use SVG sprites</a></li>
<li><a href="../272507/index.html">JavaScript encryption using the pidCrypt library</a></li>
<li><a href="../272509/index.html">Randomness in PHP7 - Will I get lucky?</a></li>
<li><a href="../272517/index.html">Presentation of the e-government portal in Kiev</a></li>
<li><a href="../272519/index.html">Simple Blender. Part 1</a></li>
<li><a href="../272521/index.html">Detailing, reflections and post effects in GTA V</a></li>
<li><a href="../272523/index.html">Editing a Raspberry Pi image with qemu-user-static (Ubuntu 14.04)</a></li>
<li><a href="../272525/index.html">Speed ‚Äã‚Äãchase: 4 ways to reduce delays when trading on the stock exchange</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>