<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Multichannel site upgrade. How to make your life easier</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Modernization of any site is like swimming in unfamiliar waters - you never know what kind of underwater reefs you come across. And what if your site ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Multichannel site upgrade. How to make your life easier</h1><div class="post__text post__text-html js-mediator-article">  Modernization of any site is like swimming in unfamiliar waters - you never know what kind of underwater reefs you come across.  And what if your site is a big, tangled system consisting of multiple channels, each of which is also built on its own technology stack?  You can not only choose the wrong course, but also drown, trying to understand all the features of the functioning of the customers site. <br><br>  In today's article, we would like to share the experience of successful modernization with the help of <b>Adobe Experience Manager</b> and tell you how to apply this solution to a multi-channel site. <br><br><img src="https://habrastorage.org/files/819/72f/a5f/81972fa5ff554c48ae33b4095f2dd4ca.jpg"><br>  Read more <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Lyrical digression about the Adobe Experience Manager: what it is and why you need it</b> <div class="spoiler_text">  <b>Adobe Experience Manager</b> , previously hiding under the names CQ5, Day CQ5 and Adobe CQ5, is a web content management system designed to create, edit, manage and optimize websites through various digital channels.  AEM is platform independent and runs on a Java server.  Allows you to create any number of web pages / sites through the use of reusable components and templates. </div></div><br><br>  Modernization is not the most modern, but fairly simple site - an interesting task, but, as they say, without the "highlight".  Another thing is when a customer's site represents more than fifty different businesses, each of which uses its own set of technologies (hybris, .NET, Java, etc.).  Combining all of the above in one perfectly working system and qualitatively update each channel of the site is a kind of challenge, but nothing is impossible. <br><br>  In addition to the above points, I would like to note the fact that each channel of the site we are updating lived its own life.  Such "independence" led to the fact that making even the simplest changes required the participation of developers.  A simple update, such as simultaneously loading a new logo for all channels, became quite a complicated procedure in terms of coordinating builds and deployments at the time of testing.  The difficulty of adding new businesses and supporting existing ones, as well as the lack of support for mobile devices and tablets (which is quite critical nowadays) and problems with localization caused the customer to contact us to optimize the site. <br><br><h3>  Why Adobe Experience Manager? </h3><br>  This solution has the features that are ideally suited for optimizing a multi-channel site.  First of all, this is a high level of reuse of basic components and sections (both the back-end and the front-end), which in our case is extremely important, since they can be optimized for new channels, refining the missing functionality, and thereby reducing the time and effort.  The second point is the support of internationalization and localization out of the box, which greatly simplifies development, because customers have plans to expand their business to other countries.  AEM is also a content management and experience management system that has great flexibility in managing what we see on the site.  Among other things, this is content editing: the ability to split functionality into modules and manage them without involving programmers and writing code, creating back-end logic using OSGi technology, scaling and personalizing content. <br><br><h3>  Modernization: what was used, what was done and why </h3><br>  As is already clear from the text above, we took the Adobe Experience Manager technology as a basis due to its capabilities and convenience for administrators.  Of course, the use of this technology alone was not enough.  Based on Bootstrap, we reworked the static site template, adding the back-end part and business logic (adaptive layout appeared, including for mobile devices, HTML 5 was used, in general, all the buns inherent in modern sites were added).  We also improved the functionality and optimized performance for different types of devices, added additional architectural solutions for the scalability of the application through the addition of cloud services. <br><br>  Since many of the customer‚Äôs business lines are similar, it was decided to create components for reuse.  Why every time to develop a new component for another channel, if in fact it is the same, just configured differently (different text or method of sending data to the service)?  For various business cases, we set up basic and specific options for components, which simplified their use in similar cases.  Thanks to this solution, the addition of new functionality and the integration of the service have become much more transparent.  Of course, small updates on the back-end are necessary to teach the service to understand the new field, but the front-end itself has become much easier.  Now, in order to add new functionality, you need to go through the editor, perform the necessary manipulations on the configuration of the component depending on its purpose and the results of smoke testing, and publish the page. <br><br>  The difficulty was not only to create reusable components, but also to develop a framework that allows you to add all these components to a page and implement a certain logic of interaction between them.  For example, on one of the site‚Äôs channels we needed to set up the following logic: when choosing different types of residential property, the user should be asked certain types of questions.  That is, if the user chooses that he lives in an apartment building, the question should be asked on which floor he lives.  Therefore, if he lives in a private house, then such a question is irrelevant to him. <br><br>  For high-quality data processing, we needed to perform integration between the components, including setting up checking answers: for example, if the user chose that he was born in 1985, he cannot own the property for more than 40 years. <br><br>  How did we do it?  To implement this functionality, the interaction between components and save and send to the service, we integrated the capabilities of Adobe Experience Manager and Angular.js.  For example, to control the display logic of each component used in the AEM, there is a field in the configuration called visibility.  This field determines whether the component will be visible to users or not.  We have to admit that the field is not the most convenient to use, but thanks to it you can use not pure JavaScript to write some functions, but integrate the component into the Angular eco-system.  An example here is the expression user.answers.dateOfBirth&gt; 01-01-1970, which performs validation by date of birth, which is substituted into the ng-if directive that wraps the specified component.  Due to the presence of two-way binding in Angular, making changes to any field does not go unnoticed, since they are all integrated into a single whole.  After making changes, a recalculation occurs, whether we should now show this field or not. <br><br><h3>  What else interesting was used? </h3><br>  Another interesting solution that we have applied is to separate the data storage scheme on the front-end from the sending scheme on the back-end.  Since the customer‚Äôs site largely consists of forms to fill out, we made sure that the user's responses are stored in local storage (HTML5 functionality) in JSON format.  Next, there is a separation of data intended for the front-end and back-end, and sending the latter to the AEM for subsequent transformation.  The conversion of incoming data into the service scheme occurs at the level of integration of the front-end part with REST services, which are engaged in the search for suitable services for site users.  In the same way, we perform data conversion in the opposite direction: if the user is logged in and wants to select something from the already filled data, then the data provided by the REST service is transformed into the data format used on the front-end.  To achieve this, we each integration with the service (for example, sending data to a service that searches for the most suitable products in the database), described in the appropriate format and stored in the AEM repository as structural nodes. <br><br><div class="spoiler">  <b class="spoiler_title">Description of the transformation in the form of nodes in the repository</b> <div class="spoiler_text">  We take the output JSON, which will be used to send to the service, and describe it in the same format in which the outgoing JSON should be, i.e.  The node structure in the repository repeats the structure of the JSON document.  Each node can simply be using one of the values ‚Äã‚Äãfrom the incoming JSON.  In the case of some more complex logic, we can use server-side JS to transform input JSON into output.  For example, we know that in the JS-file, which is located under the node, there is a function transform, which should return the output data.  If the required field is not empty and defined, then we return it.  If it is empty, then we return a predetermined value - one.  This is an example of a simple data conversion from one format to another using JavaScript.  Execution of scripts that lie in the repository and describe the transformation of input data on the weekend, is performed by the Jh-engine Rhino, completely written in Java. </div></div><br><br><h3>  Personalization options </h3><br>  AEM is good because it provides excellent opportunities for personalizing content.  In our case, we used the module that comes out of the box with the framework, optimized it for ourselves, creating additional user segments to the existing ones.  What was the result?  The main page of the channel has become personalized, has a greeting and displays the history of user requests.  In case the user leaves the account, the page will still remember the username, but will offer to login.  If the user insists that the system is wrong, and it is not at all he / she, they will be asked to use the site as an anonymous user, and in this case completely different content will be shown.  In principle, all types of users can be configured with different content, up to the deletion of the greeting and its replacement with some other component.  To do this, you need to create a new component, and the site administrators to configure it, that is, select rules from a previously available set, in which case this component should be displayed. <br><br><h3>  However, not everything is as simple as it looks ... </h3><br>  We developed the first channel of the site about a year before the first live release.  Five teams of ten people worked at the peak, who wrote directly the framework for integration with services and for building component architecture, integration between them, for transforming services, etc.  plus engaged in non-functional services and site performance optimization.  The second channel managed to be renewed in about six months, and the secondary use of the components was about 60-70%, which is a lot. <br><br>  Now the project has three teams of ten people each, which are finalizing the functionality in accordance with business requirements, updates, suggestions for improving components, and also working on architectural problems arising in the course of creating new components. <br><br>  The site architecture itself is a passive clustering, and at the moment we have three application servers that serve to process user requests.  However, everything is built in such a way that in case of any performance problems, we can easily and quickly start scaling the system quickly and easily.  Using deployment scripts, through Vagrant / Docker and Amazon Cloud, we can raise a virtual machine, install AEM and deploy the latest sources of our site on it, adding it to the entire eco-system of the application. <br><br>  As for performance, especially on mobile devices, since we used Angular, it was easy to go into an unproductive application with a large processor consumption on the client.  In this case, we were helped by the optimization of the HTML structure, the use of one-way binding to reduce the number of watcher functions on Angular, and the correspondence of some Angular directives. <br><br>  To optimize the performance of the site itself, a high level of data caching is used.  Most of the content that users see is static information provided by the web server - we have significantly reduced the number of calls to the application server.  This is due to the best practices of working with AEM, since in most projects there is a dispatcher, which serves to cache static information.  Ideally, a request to the application server should only reach if the data on the server or site has changed or a new code has been rolled into it. <br><br>  We also made a lot of improvements to achieve high Google page score statistics.  To maximize the use of the browser cache, we optimized the number of requests to the site through the concatenation of JS, CSS, etc., combining images into sprites, SVG-approaches, fingerprinting-functionality.  This, of course, is not something supernatural, but you should not forget about it either. <br><br>
<h3>  Customers need your help anyway. </h3><br>  Despite all the advantages of AEM, customers in any case need your help in developing components that are necessary specifically for a particular area, or describing some exotic scenarios like adding a new user segment, etc. <br>  Of course, technically there is still a field for development: you can infinitely simplify JavaScript, create new high-level functions that customers can use in the future, and much more. <br><br>  We are still awaiting the development of new components for other channels of the site, the solution of architectural problems, the redesign of components and other interesting problems.  However, thanks to the existing experience with the AEM, updating the remaining channels is a matter of time.  And the more pleasant it is to realize that thanks to this solution we give quite a lot of flexibility to our customers - based on what we have already done, they can, like from bricks, build new businesses.  And this is great. </div><p>Source: <a href="https://habr.com/ru/post/277041/">https://habr.com/ru/post/277041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277029/index.html">Log server Elasticsearch + Logstash + Kibana4 + Beats (windows / linux). Installation and Setup</a></li>
<li><a href="../277031/index.html">MyHTML - HTML parser on the "bare" C with POSIX Threads support</a></li>
<li><a href="../277033/index.html">Generators in ES6 and asynchronous code in a new way</a></li>
<li><a href="../277035/index.html">Initial Setup of Extreme Networks Wireless Controllers</a></li>
<li><a href="../277037/index.html">Ultima 2C is a free ERP II class solution based on Ultima Businessware platform.</a></li>
<li><a href="../277043/index.html">Ariadna. Why do I need another geocoder for OSM?</a></li>
<li><a href="../277045/index.html">Announcement WordPress Meetup # 2</a></li>
<li><a href="../277047/index.html">Application developers do not care about user safety, which leads to data leakage (with java-code examples)</a></li>
<li><a href="../277049/index.html">Test the training of visual attention</a></li>
<li><a href="../277051/index.html">Report from Tarantool Meetup January 28</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>