<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A small performance comparison of the UWP / WinRT API of language projections</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my opinion, an unusual situation has developed in the development of UWP / WinRT applications: the company promotes the use of the native SDK from ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A small performance comparison of the UWP / WinRT API of language projections</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/9d1/29a/cbb/9d129acbb6a8403fb65dbc5f8748d109.png" alt="WinRT Language projections"><br><br>  In my opinion, an unusual situation has developed in the development of UWP / WinRT applications: the company promotes the use of the native SDK from a managed environment.  I wondered how effective this approach is.  And for the answer, I decided to write several applications that solve one and the same task, relying on the tools provided by the UWP / WinRT API. <br>  For the results of my little test, welcome under cat. <br><a name="habracut"></a><br><h4>  Formulation of the problem </h4><br>  The algorithm of each application included the following steps: <br><ol><li>  The executable environment calls the Main () function (don't be surprised, this function always exists in WinRT / UWP applications) </li><li>  The CoreApplication.Run (...) method is passed the IFrameworkViewSource implementation, which returns the IFrameworkView interface in the CreateView () method. </li><li>  After a few initialization steps, the IFrameworkView.Run () method is called, which activates the main application window, starts the event handling by the dispatcher and creates a thread / task to perform the calculations. </li></ol><br>  To more accurately measure the required time to perform calculations, applications were launched without a debugger.  The values ‚Äã‚Äãof the result and the elapsed time were entered into the fields of the local settings of the Result and Time applications, respectively. <br>  The sequence of measuring the time required to perform all the calculations was as follows: <br><ol><li>  Variable initialization </li><li>  Timer start / start time variable initialization </li><li>  Multiple conversion: input -&gt; SHA256 hash -&gt; Base64 string -&gt; input </li><li>  Stop timer / elapsed time calculation </li><li>  Write values ‚Äã‚Äãto local settings </li></ol>  To read the stored values, applications were launched in debug mode, and the data was output to the console. <br><br>  A total of five application test projects were created, three of which used the UWP / WinRT API in their work, while the other two relied on their own implementation of SHA256 and Base64. <br>  General list of applications: <br><ul><li>  CPP (C ++).  Sichnye implementations of algorithms were taken from <a href="https://github.com/B-Con/crypto-algorithms">github.com/B-Con/crypto-algorithms</a> . </li><li>  CPPCX (C ++ CX).  Uses the CryptographicBuffer API provided by UWP / WinRT. </li><li>  CPPWRL (C ++).  It also uses the CryptographicBuffer API, but calls are made in the COM style. </li><li>  CS (C #).  Taken implementation from <a href="">github.com/yuriks/SHA2-Csharp/blob/master/Sha256.cs</a> . </li><li>  CSWinRT (C #).  API CryptographicBuffer is used. </li></ul>  Projects written in C #, in addition to normal execution, were also tested in compile mode using .NET Native. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Test results </h4><br>  Testing was conducted in two modes of compilation and execution: ARM and x86. <br>  Below are the runtime diagrams (values ‚Äã‚Äãare in milliseconds). <br><br><img src="https://habrastorage.org/files/6f2/a6a/c19/6f2a6ac192ec4ed6a53743040efcd9fd.png" alt="ARM"><br><br><img src="https://habrastorage.org/files/db0/8f6/db8/db08f6db84f64d06b64ae2bbe2696ce3.png" alt="x86"><br><br>  Such a significant difference surprised me a little.  To figure it out, I decided to profile applications using the UWP / WinRT API. <br>  If you put all the screenshots in a table then you can get the following: <br><table><tbody><tr><td><img src="https://habrastorage.org/files/0c0/bc9/237/0c0bc92373514198a681597a464a93b0.png"></td><td><img src="https://habrastorage.org/files/eb0/247/918/eb02479181fe41dc9fbc829d05ed40ad.png"></td></tr><tr><td><img src="https://habrastorage.org/files/fd7/51f/8d9/fd751f8d9add4550846ffbe3cf49b707.png"></td><td><img src="https://habrastorage.org/files/a5a/da6/2f0/a5ada62f065a494398016a551d74683e.png"></td></tr></tbody></table><br>  It is easy to see the reason for such a big difference: in a project written in pure C ++ using WRL, the running time of the code from the CryptoWinRT.dll library reaches 90 percent, and in a C # project compiled using .NET Native, this value is only 15 percent .  So it turns out that most of the time, projects written in C # work in idle. <br><br><h4>  Conclusion </h4><br>  Of course, it is clear that the remote method of using the UWP / WinRT API is chosen.  Most likely in life such code will never occur at all.  But the fact remains that, under certain circumstances, your code can work very slowly only because of the overhead incurred as a result of using the language projection.  It may be the best solution in this case will be an alternative implementation that performs similar tasks, but without using the system API. <br><br>  Source code for all projects is available at <a href="https://github.com/altk/sha256comparison">https://github.com/altk/sha256comparison</a> </div><p>Source: <a href="https://habr.com/ru/post/280722/">https://habr.com/ru/post/280722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../280708/index.html">IBM's cognitive service recognizes a photo and tells what is shown in the pictures.</a></li>
<li><a href="../280710/index.html">Automate Personnel Changes on PowerShell</a></li>
<li><a href="../280712/index.html">Bank payment infrastructure protection</a></li>
<li><a href="../280718/index.html">Branded DNS or white labeling on Amazon Route 53</a></li>
<li><a href="../280720/index.html">Sync in online games</a></li>
<li><a href="../280724/index.html">Databoom control panel. Database management</a></li>
<li><a href="../280726/index.html">Half an hour before the final - Vivaldi 1.0.435.26</a></li>
<li><a href="../280732/index.html">Hangfire - Task Scheduler for .NET</a></li>
<li><a href="../280734/index.html">Opinion: Why you should learn and use Clojure</a></li>
<li><a href="../280736/index.html">Atmel optimized parametric microcontroller search for mobile phones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>