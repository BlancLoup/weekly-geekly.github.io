<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We program Windows 7: Taskbar. Part 2 - ThumbButtons</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I talked about how in Windows 7 you can display the progress of an operation right in the Windows taskbar. This time we will continue to tal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We program Windows 7: Taskbar. Part 2 - ThumbButtons</h1><div class="post__text post__text-html js-mediator-article">  Recently, I talked about how in Windows 7 you can display the progress of an operation right in the Windows taskbar.  This time we will continue to talk about the possibilities of Windows 7 for the programmer and consider the possibility of adding your own control buttons in the preview window. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.2ThumbButtons_97CC/image_3ea21273-cb69-4c88-8c8f-f80ab5f7625b.png"></div><a name="habracut"></a><br><br>  You could already notice similar functionality when using Windows 7. For example, similar buttons exist for Windows Media Player.  They allow you to switch tracks, as well as stop playback.  All these buttons can create no more than seven. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Undoubtedly, such functionality can be useful not only for Media Player, but also for our applications.  Let's see how you can implement this in our application. <br><br>  As I said, for all the system functions of Windows 7 there is a wrapper on .NET called the .NET Interop Sample Library.  We used the services of this library when we ran the status bar progress bar.  Now we will also use this library. <br><br>  Creation of our buttons should occur at the moment of handling the WM_TaskbarButtonCreated event.  Therefore, it is necessary to override the WndProc method in the form and handle the moments when this event occurs. <br><br> <code>protected override void WndProc(ref Message m) <br> { <br> if (m.Msg == Windows7Taskbar.TaskbarButtonCreatedMessage) <br> { <br> // initialize buttons <br> } <br> base.WndProc(ref m); <br> } <br></code> <br><br>  To initialize the buttons, you need a ThumbButtonManager object.  This object controls the behavior and display of these buttons.  This object can be created using the CreateThumbButtonManager extension method.  After that, you need to use the CreateThumbButton method and create a button object.  After all the buttons are created, you need to add them to the taskbar using the AddThumbButtons method. <br><br> <code>protected override void WndProc(ref Message m) <br> { <br> if (m.Msg == Windows7Taskbar.TaskbarButtonCreatedMessage) <br> { <br> InitializeThumbButtons(); <br> } <br> base.WndProc(ref m); <br> } <br> <br> protected void InitializeThumbButtons() <br> { <br> ThumbButtonManager thumbButtonManager = <br> WindowsFormsExtensions.CreateThumbButtonManager(this); <br> var decreaseThumbButton = thumbButtonManager.CreateThumbButton(1, <br> Icons.Navigation_First_2, "To reduce the progress"); <br> decreaseThumbButton.Clicked += delegate <br> { <br> // .. <br> }; <br> thumbButtonManager.AddThumbButtons(decreaseThumbButton); <br> } <br></code> <br><br>  Now, when you start the application, you can see that there is one control button.  However, if we try to click on it, we will see that the event handler does not work.  In order for the handler to start working, it is necessary in the WndProc method to explicitly pass the ability to the ThumbButtonManager object to handle events. <br><br>  As a result, we get the following simple code. <br><br> <code>private ThumbButtonManager _thumbButtonManager; <br> protected override void WndProc(ref Message m) <br> <br> { <br> if (m.Msg == Windows7Taskbar.TaskbarButtonCreatedMessage) <br> { <br> InitializeThumbButtons(); <br> } <br> <br> if (_thumbButtonManager != null) <br> _thumbButtonManager.DispatchMessage(ref m); <br> <br> base.WndProc(ref m); <br> } <br> <br> protected void InitializeThumbButtons() <br> { <br> if (_thumbButtonManager == null) <br> { <br> _thumbButtonManager = WindowsFormsExtensions.CreateThumbButtonManager(this); <br> } <br> <br> var decreaseThumbButton = _thumbButtonManager.CreateThumbButton(1, Icons.Navigation_First_2, "To reduce the progress"); <br> <br> decreaseThumbButton.Clicked += delegate <br> { <br> Progress.Text = (float.Parse(Progress.Text) - 10).ToString(); <br> WindowsFormsExtensions.SetTaskbarProgress(this, float.Parse(Progress.Text)); <br> }; <br> // other buttons <br> <br> _thumbButtonManager.AddThumbButtons(decreaseThumbButton, normalStateThumbButton, indeterminateStateThumbButton, pauseStateThumbButton, errorStateThumbButton, increaseThumbButton); <br> }</code> <br> <br>  This app contains buttons for managing progress (as in the past case) and contains 6 buttons. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.2ThumbButtons_97CC/image_34d9c6e5-ec7c-41da-8e87-3066dd1b55d4.png"></div><br><br>  Good luck in developing your applications for Windows 7! <br><br>  Demo application: <br>  <a href="http%253A%252F%252Fblogs.gotdotnet.ru%252Fpersonal%252Fsergun%252Fcontent%252Fbinary%252FWindowsLiveWriter%252FWindows7Taskbar.2ThumbButtons_97CC%252FThumbButtons.zip">ThumbButtons.zip</a> </div><p>Source: <a href="https://habr.com/ru/post/59946/">https://habr.com/ru/post/59946/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../59935/index.html">Does microblogging replace traditional blogging?</a></li>
<li><a href="../59937/index.html">Error in displaying blog readers</a></li>
<li><a href="../59938/index.html">Marketers, be simple!</a></li>
<li><a href="../59941/index.html">Questions for Google Chrome developers</a></li>
<li><a href="../59942/index.html">Denmark</a></li>
<li><a href="../59949/index.html">Nigma indexes in a new way</a></li>
<li><a href="../59951/index.html">Stanford iPhone Programming Course</a></li>
<li><a href="../59952/index.html">Adium 1.3.4</a></li>
<li><a href="../59954/index.html">External HDD Iomega eGo</a></li>
<li><a href="../59956/index.html">Twitter will never advertise</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>