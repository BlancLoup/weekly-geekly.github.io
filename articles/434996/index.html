<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I shared the location through the VC API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently I decided to try to implement the idea of ‚Äã‚Äãhow to share a location via the VKontakte API with friends in a mode close to real time. The outp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I shared the location through the VC API</h1><div class="post__text post__text-html js-mediator-article">  Recently I decided to try to implement the idea of ‚Äã‚Äãhow to share a location via the VKontakte API with friends in a mode close to real time.  The output was a cross-platform Qt-application for iOS / Android, a web application for VKontakte and a couple of pull requests for the VK API.  In this article, I would like to share some unobvious moments of implementation that may be interesting to someone.  So, I ask those interested under the cat. <br><a name="habracut"></a><br><h3>  Why do I need it at all </h3><br>  Sooner or later, children grow up.  Banal truth.  So my ten-year-old daughter one day said: ‚ÄúDad, don't take me by car anymore, I want to go to school on my own!‚Äù.  Well, I considered the demand to be fair, asked for a two-week reprieve and began preparation. <br><br>  Since I have some experience in writing apps, and the daughter is constantly carrying in the pocket of the iPhone SE, then as a preparation, it was decided to quickly write an application that would show where the daughter is at this particular moment.  Yes, I know that now there are quite a few such applications (even Google Maps recently had similar functionality), and it was possible to use some kind of ready-made solution, but it was interesting for me to write something of my own. <br><br><h3>  Why VKontakte? </h3><br>  Since I would not like to deal with the processing and storage of other people's (in the potentially possible future) personal data on my equipment with all the ‚Äúcharms‚Äù that follow from this, I wondered how to do without my own server part.  And then it dawned on me - after all, there is such a monster as VKontakte!  It is fashionable, powerful and with its developed API, and most importantly - all our children have been sitting together for a long time and in a tight place (I can‚Äôt say I like it, but it‚Äôs a reality).  But damn it, Holmes, how do I stuff location data into it so that, firstly, they don‚Äôt show where they don‚Äôt need, and secondly, you can regulate access to this data so that bad pedobirs do didn't get it? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Notes came to the rescue.  Yes, the very Wikited notes that were once (rumored) very popular, and are now in the pen, for the most part have ceased to shine in the tapes and have moved to a separate section of the site that you cannot get to on the lame goat.  You can place arbitrary text data in them, but the main thing is that you can assign access lists in which people and groups are listed who can see and comment on this note. <br><br>  The general scheme of the application in my eyes began to look like this: <br><br><ul><li>  Create a list of friends with whom you want to share location data (I called it "Trusted Friends"); </li><li>  We create a note with a specific name, give the rights to view it to the above list, write down the location data there and update it periodically; </li><li>  We regularly go over the list of trusted friends, checking whether they have a note with this specific name, if it does, we try to extract friend‚Äôs location data from its contents, and if we succeed, then show it on the map; </li><li>  ??? </li><li>  PROFIT! </li></ul><br>  So, the idea is there, the case for small is to implement it. <br><br><h3>  iOS </h3><br>  Since the daughter uses the iPhone, it was logical to start the implementation with the iOS version.  With an eye to cross-platform, Qt was chosen as the framework, because I‚Äôve been familiar with it for quite some time, and the good old Open Street Map, for which Qt Location has a plugin, was chosen as the map engine.  Since the application was originally created as an open source, Qt‚Äôs licensing restrictions did not frighten me. <br><br>  The GUI was written in QML, I connected and used the standard <a href="https://github.com/VKCOM/vk-ios-sdk">VK iOS SDK</a> to work with VK, it is written in Objective C, so its integration did not cause any problems.  Work in the background on iOS is implemented through the Significant Change Location Service.  To reduce power consumption, the application monitors the activity of movements, and if it understands that a person is sitting for about a long time in about one place (say, came to school or office), then it lowers the required accuracy of geo-location determination, forcing the OS to switch to less energy-intensive ways to determine it ( usually on cell towers).  If the application understands that the person has begun to move actively, the accuracy rises again. <br><br>  The full set of iOS sources is available on <a href="https://github.com/vkgeo/vkgeo-ios">GitHub</a> .  Here are a couple of unobvious moments that I encountered during the implementation process: <br><br>  <b>Overriding NSApplicationDelegate Methods in a Qt Application</b> <br><br>  The iOS SDK from VKontakte requires adding calls to some of its functions in the application: didFinishLaunchingWithOptions: and application: openURL: options: methods.  Prior to some version of Qt (in my opinion, before 5.11) it was enough to create a category for QIOSApplicationDelegate something like this: <br><br><pre><code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QIOSApplicationDelegate</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIResponder</span></span></span><span class="hljs-class"> &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIApplicationDelegate</span></span></span><span class="hljs-class">&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QIOSApplicationDelegate</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QIOSApplicationDelegateVKGeoCategory</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implementation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QIOSApplicationDelegate</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QIOSApplicationDelegateVKGeoCategory</span></span></span><span class="hljs-class">) - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BOOL</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">application</span></span></span><span class="hljs-class">:(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIApplication</span></span></span><span class="hljs-class"> *)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">application</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">didFinishLaunchingWithOptions</span></span></span><span class="hljs-class">:(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSDictionary</span></span></span><span class="hljs-class"> *)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">launchOptions</span></span></span><span class="hljs-class"> </span></span>{ [...] } - (<span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span>)application:(<span class="hljs-built_in"><span class="hljs-built_in">UIApplication</span></span> *)application openURL:(<span class="hljs-built_in"><span class="hljs-built_in">NSURL</span></span> *)url options:(<span class="hljs-built_in"><span class="hljs-built_in">NSDictionary</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">UIApplicationOpenURLOptionsKey</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>&gt; *)options { [...] } <span class="hljs-keyword"><span class="hljs-keyword">@end</span></span></code> </pre> <br>  But in recent versions of Qt, QIOSApplicationDelegate already has an application: openURL: options :, so the option with categories is no longer rolling.  I had to make a successor from QIOSApplicationDelegate and assign a delegate via setDelegate: <br><br><pre> <code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VKGeoApplicationDelegate</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QIOSApplicationDelegate</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implementation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VKGeoApplicationDelegate</span></span></span><span class="hljs-class"> - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BOOL</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">application</span></span></span><span class="hljs-class">:(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIApplication</span></span></span><span class="hljs-class"> *)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">application</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">openURL</span></span></span><span class="hljs-class">:(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSURL</span></span></span><span class="hljs-class"> *)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">url</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">options</span></span></span><span class="hljs-class">:(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSDictionary</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIApplicationOpenURLOptionsKey</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">&gt; *)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">options</span></span></span><span class="hljs-class"> </span></span>{ [...] } <span class="hljs-keyword"><span class="hljs-keyword">@end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> InitializeVKGeoApplicationDelegate() { [[<span class="hljs-built_in"><span class="hljs-built_in">UIApplication</span></span> sharedApplication] setDelegate:[[VKGeoApplicationDelegate alloc] init]]; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> main(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> argc, <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *argv[]) { [...] InitializeVKGeoApplicationDelegate(); [...] }</code> </pre><br>  <b>Error handling from VKRequest</b> <br><br>  Faced with the fact that VKRequest returned an empty (empty) NSError on error.  I made a patch, which patches someone's previous patch and <a href="https://github.com/VKCOM/vk-ios-sdk/pull/535">pull request</a> this patch, but it still hangs in the unexamined. <br><br><h3>  Android </h3><br>  The next was a version for Android.  The GUI code was almost completely reused from iOS, the <a href="https://github.com/VKCOM/vk-android-sdk">VK Android SDK</a> was also used to interact with the VC, which interacts via the JNI, the background work is implemented in accordance with Google's precepts for such applications - namely, Foreground Service.  Of course, the energy-saving logic is also implemented, similar to that used in iOS. <br><br>  The full set of source code for the Android version is again available on <a href="https://github.com/vkgeo/vkgeo-android">GitHub</a> , and here are a couple of unobvious moments that I encountered in the process of implementing this version: <br><br>  <b>How to create an Android service on Qt</b> <br><br>  To create a service in Qt 5.10, a QAndroidService class appeared, which should be used instead of QGuiApplication.  You can build separate .so for activity and for service, or you can use one .so for everything, and in order for the code to understand in which mode it works, you can specify this mode via the command line key, like this: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".VKGeoService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.app.arguments"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"-service"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *argv[])</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (argc == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-function"><span class="hljs-function">QGuiApplication </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">app</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(argc, argv)</span></span></span></span>; [...] } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (argc == <span class="hljs-number"><span class="hljs-number">2</span></span> &amp;&amp; QString(argv[<span class="hljs-number"><span class="hljs-number">1</span></span>]) == <span class="hljs-string"><span class="hljs-string">"-service"</span></span>) { QAndroidService app(argc, argv); [...] } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } }</code> </pre><br>  <b>Strange "hanging" activity in onDestroy ()</b> <br><br>  In the process of implementing the service, a funny problem emerged - QtActivity ‚Äúhung out‚Äù somewhere in the depths of its onDestroy () subject to the availability of a working foreground service.  Apparently, Qt does not expect that after the activity is completed, something else may remain from the application.  The problem was solved by separating activity and service across various processes through the use of android: process in the manifest: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".VKGeoService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:process</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">":VKGeoService"</span></span></span><span class="hljs-tag">&gt;</span></span> [...] <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  and nailing the process in which the activity works in the overridden onDestroy (): <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDestroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ [...] <span class="hljs-comment"><span class="hljs-comment">/* * This call hangs when foreground service is running, * so we just kill activity process instead (service * is running in a different process). * * super.onDestroy(); */</span></span> Process.killProcess(Process.myPid()); }</code> </pre><br>  Yes, lint constantly swears at this, but how to deal with it differently is not obvious to me yet, but my hands do not reach QTBUG with PoC on this topic yet. <br><br>  <b>Failure to call errorBlock when canceling VKBatchRequest</b> <br><br>  I widely use batch requests to ease the load on VKontakte servers, and it was under Android (everything works fine under iOS) I had a problem - if VKBatchRequest errorBlock was canceled, there were no calls for canceled requests.  I fixed this problem in the local version of the library, made the corresponding patch and <a href="https://github.com/VKCOM/vk-android-sdk/pull/377">pull request for</a> this patch, but again, it still hangs in unexamined. <br><br><h3>  Conclusion </h3><br>  The iOS version of Apple has easily placed on the App Store, and it is available there to this day, the Android version lived on Google Play for a while until the Google Play Policy was tightened (it was prescribed that geo-location tracking applications must be explicitly intended for either family or corporate use), after which my application was safely blocked there.  On my appeal attempt, a Google employee in charge (or maybe it was a bot, now it‚Äôs not so obvious who answers your questions) relentlessly stated that ‚Äúwell, this application CAN BE USED NOT ONLY for family or corporate tracking‚Äù , to which I could not find, to argue - indeed, with a hammer, you can not only hammer in nails, but also pierce heads ... I posted the Android version in Yandex.Store and Amazon Appstore and in the form of an APK on the project website. <br><br>  I would be glad if this application is useful to someone as a visual aid for clarifying some unobvious moments when writing a Qt application for iOS / Android, especially related to the implementation of Android service on Qt (this functionality is relatively new, examples of implementation, I know, not so much).  Also I will be glad to answer questions in the comments, if any. </div><p>Source: <a href="https://habr.com/ru/post/434996/">https://habr.com/ru/post/434996/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../434984/index.html">What I hate for Eloquent ORM</a></li>
<li><a href="../434986/index.html">Basic C ++ Standard Library Concepts</a></li>
<li><a href="../434990/index.html">Using the Cisco 800 Series (for example Cisco 857) as a home router</a></li>
<li><a href="../434992/index.html">IDA Pro Upgrade. Debugger for Sega Mega Drive (part 1)</a></li>
<li><a href="../434994/index.html">Android: Creating Dynamic Product Flavors and Signing Configs</a></li>
<li><a href="../435000/index.html">The concept of the interaction of advertising channels and its application in practice</a></li>
<li><a href="../435002/index.html">IDA Pro Upgrade. Debugger for Sega Mega Drive (part 2)</a></li>
<li><a href="../435006/index.html">Where and how do nuclear reactors do</a></li>
<li><a href="../435008/index.html">Preliminary data on the production and sale of Tesla electric vehicles for the 4th quarter and for the 2018th year</a></li>
<li><a href="../435010/index.html">Digital Lyrics: Mega-compilation of songs and clips about programming and programmers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>