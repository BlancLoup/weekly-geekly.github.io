<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The evolution of means of delivery, or reflections on Docker, deb, jar, etc.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Somehow, at one point, I decided to write an article about the delivery of containers in the form of docker containers and deb-packages, but when I st...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The evolution of means of delivery, or reflections on Docker, deb, jar, etc.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/qw/2q/om/qw2qompuzuhjjxjf2cxycsx4q2u.jpeg"><br><br>  Somehow, at one point, I decided to write an article about the delivery of containers in the form of docker containers and deb-packages, but when I started, for some reason, I suffered the first personal computers and even calculators in the distant times.  In general, instead of dry comparisons of the docker and the deb, we got here such reflections on the topic of evolution, which I submit to your judgment. <br><a name="habracut"></a><br>  Any product, whatever it may be, must somehow get to the product servers, must be configured and running.  That's what this article will be about. <br><br>  I will reflect in a historical context, ‚Äúwhat I see - I sing about‚Äù, what I saw when I started writing code and what I observe now, what we are using at the moment and why.  The article does not claim to be a full-fledged study, some points are missed, this is my personal view of what was and is now. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, in the good old days ... the earliest delivery method that I found were tape cassettes.  I had a computer BK-0010.01 ... <br><br><h2>  The era of calculators </h2><br>  No, there was an even earlier moment, there was another calculator <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25B0_%25D0%259C%25D0%259A-61">MK-61</a> and <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25B0_%25D0%259C%25D0%259A-52">MK-52</a> . <br><br><img src="https://habrastorage.org/webt/ve/iz/aa/veizaapgi5rwfkezhjkcyw4qow4.jpeg" align="left">  So, when I had the <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25B0_%25D0%259C%25D0%259A-61">MK-61</a> , then the method of transferring the program was a regular piece of paper in the box on which the program was recorded, which, if necessary, was manually recorded in the calculator.  If you want to play (yes, yes, even on this antediluvic calculator there were games) - you sit down and enter the program into the calculator.  Naturally, when you turn off the calculator, the program went into oblivion.  In addition to the calculator codes written on paper, the programs were published in the magazines ‚ÄúRadio‚Äù and ‚ÄúTechnique of Youth‚Äù, as well as published in the books of that time. <br><br>  The next modification was the <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25B0_%25D0%259C%25D0%259A-52">MK-52</a> calculator, it already had some sort of non-volatile data storage.  Now it was not necessary to drive a game or program manually, but, having done some magic passes with the buttons, it loaded itself. <br><br>  The size of the largest program in the calculator was 105 steps, and the size of the permanent memory in the MK-52 was 512 steps. <br><br>  By the way, if there are fans of these calculators, who reads this article - in the process of writing the article, I found both a calculator emulator for android, and programs for it.  Forward to the past! <br><br><ul><li>  <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.cax.pmk.ext">Emulator MK-61 for Android</a> </li><li>  <a href="https://xvadim.github.io/xbasoft/pmk/pmk.html">Catalog of programs for MK-61</a> </li></ul><br><blockquote>  <b>A small digression about MK-52</b> <i>(from wikipedia)</i> <br><br>  MK-52 flew into space aboard the Soyuz TM-7.  It was supposed to be used to calculate the landing trajectory in case the on-board computer fails. <br><br>  MK-52 with the block of memory expansion "Electronics-Astro" since 1988 was supplied to the ships of the Navy as part of the navigator's computing kit. </blockquote><br><br><h2>  First personal computers </h2><br><br><img src="https://habrastorage.org/webt/vg/5-/fj/vg5-fjiyjylbwuc3b7ldjh-dwgi.jpeg" align="left">  Let's return to the times of <a href="https://ru.wikipedia.org/wiki/%25D0%2591%25D0%259A_(%25D1%2581%25D0%25B5%25D0%25BC%25D0%25B5%25D0%25B9%25D1%2581%25D1%2582%25D0%25B2%25D0%25BE_%25D0%25BA%25D0%25BE%25D0%25BC%25D0%25BF%25D1%258C%25D1%258E%25D1%2582%25D0%25B5%25D1%2580%25D0%25BE%25D0%25B2)">BK-0010</a> .  It is clear that there was more memory there, and it was not at all an option to drive the code from the paper (although at first I did just that because there was simply no other carrier).  Audio cassettes for tape recorders become the main means of storing and delivering software. <br><br><br clear="all"><br clear="all"><img src="https://habrastorage.org/webt/un/dx/vi/undxvicotyb3ghussyo4l08ykry.jpeg" align="right">  Storage on the tape was usually in the form of one or two binary files, everything else was contained inside.  Reliability was very nasty, I had to keep 2-3 copies of the program.  Loading time was also not happy, enthusiasts experimented with different frequency coding to overcome these shortcomings.  I myself at that time had not yet been engaged in the professional development of software (not counting simple programs in BASIC), so I will not tell you in detail how everything was arranged inside.  The mere fact of having only RAM on a computer for the most part determined the simplicity of the data storage scheme. <br><br><h2>  The emergence of reliable and large storage media </h2><br>  Floppy disks appear later, the copying process is simplified, and reliability grows. <br>  But the situation changes dramatically, only when there are sufficiently large local storage in the form of HDD. <br><br>  The type of delivery changes fundamentally: installer programs appear that control the system configuration process, as well as sweep after deletion, because the programs are not simply read into memory, but are already copied into the local storage, from which you need to be able to clean up the unnecessary if necessary. <br><br>  In parallel, the complexity of the supplied software increases. <br>  The number of files in the delivery increases from one to hundreds and thousands, conflicts of library versions and other joys begin when different programs use the same data. <br><br><img src="https://habrastorage.org/webt/dh/rd/-z/dhrd-zolamvx8yfrrsodu5ylibg.jpeg" align="left">  At that time, the existence of Linux was not yet revealed to me, I lived in the MS DOS world and, later, Windows, but wrote on Borland Pascal and Delphi, sometimes looking towards C ++.  In those days, many people used InstallShield at <a href="https://ru.wikipedia.org/wiki/InstallShield">en.wikipedia.org/wiki/InstallShield</a> , which successfully solved all the tasks of software deployment and configuration. <br><br><br clear="all"><br clear="all"><h2>  Epoch Internet </h2><br>  Gradually, the complexity of software systems is even more complicated, and the transition to distributed systems, thin clients and microservices takes place from monolith and dextup applications.  Now you need to configure more than one program, and their set, and so that they are friends all together. <br><br>  The concept has changed completely, the Internet has come, the era of cloud services has arrived.  It is still interpreted in the initial stage, in the form of sites, no one dreamed of services especially.  but this was a turning point in the development and application delivery industry. <br><br>  For myself, I noted that at this moment there was a change of generations of developers (or it was only in my environment), and it seemed that all the good old delivery methods were forgotten at one moment and everything started from the very beginning: they began to make all the delivery Knee scripts and called it proudly "Continuous delivery".  In fact, a period of mess has begun, when the old is forgotten and not used, and the new is simply not there. <br><br>  I remember the times when we worked in the company where I then worked (I will not name it), instead of doing the build via ant (maven was not yet popular or not at all), people just collected jar in IDE and serenely commit him in svn.  Accordingly, the deployment consisted in retrieving a file from SVN and copying it over SSH to the desired machine.  That's so simple and clumsy. <br><br>  At the same time, the delivery of simple PHP sites was done quite primitively by simply copying the corrected file via FTP to the target machine.  Sometimes there was no such thing - the code was ruled live on the grocery server, and it was special chic if there were backups somewhere. <br><br><br clear="all"><h4>  RPM and DEB packages </h4><br><img src="https://habrastorage.org/webt/2x/05/di/2x05didl55rli_ripn5rwowwtju.png" align="right">  On the other hand, with the development of the Internet, UNIX-like systems began to gain more and more popularity, in particular, it was at that time that I discovered RedHat Linux 6 for myself, about 2000.  Naturally, there were also certain means for software delivery, according to Wikipedia, RPM as the main package manager appeared already in 1995, in the version of RedHat Linux 2.0.  And from then until now, the system comes in the form of RPM-packages and quite successfully exists and develops. <br><br>  The distributions of the Debian family went the same way and implemented the delivery in the form of deb packages, which is also consistently up to now. <br><br>  Package managers allow you to deliver the software products themselves, configure them during the installation process, manage dependencies between different packages, remove products and clean up the extra during the uninstallation process.  Those.  for the most part this is all that is needed, which is why they lasted for several decades with little or no change. <br><br>  Cloudiness added to the package managers installation not only from physical media, but also from cloud repositories, but fundamentally little has changed. <br><br>  It is worth noting that at present there are some inclinations towards avoiding deb and switching to snap-packages, but more on that later. <br><br>  So, this new generation of cloud developers, which neither DEB nor RPM knew, also grew slowly, gained experience, products became more complicated, and some more reasonable delivery methods were needed than FTP, bash scripts and similar student crafts. <br>  And here Docker comes on the scene, a kind of mix of virtualization, resource boundaries and delivery methods.  It is now fashionable, youth, but is it needed for everything?  Is it a panacea? <br><br>  According to my observations, very often Docker is not offered as a rational choice, but simply because, on the one hand, this is talked about in the community, and those who offer it know it only.  On the other hand, the good old packaging systems for the most part are silent - they are and are, they do their work quietly and unnoticed.  In such a situation there is no other choice - the choice is obvious - Docker. <br><br>  I'll try to share my experience, how we implemented Docker, and what happened as a result. <br><br><br clear="all"><h4>  Custom scripts </h4><br>  Initially there were bash-scripts that deploy jar-archives on the necessary machines.  Managed this Jenkins process.  It worked successfully, since the jar-archive itself is already an assembly, containing classes, resources, and even a configuration.  If you put everything in it to the maximum - then expanding it with a script is not the most difficult thing to do. <br><br>  But scripts have several drawbacks: <br><br><ul><li>  Scripts are usually written in haste and are therefore so primitive that they contain only one most prosperous script.  This is facilitated by the fact that the developer is interested in speedy delivery, and a normal script requires the investment of a decent amount of resources </li><li>  as a consequence of the preceding paragraph, the scripts do not contain an uninstall procedure </li><li>  no upgrade procedure installed </li><li>  when a new product appears, write a new script </li><li>  no dependency support </li></ul><br>  Of course, you can write a fancy script, but, as I wrote above, this is the time for development, and not the least, and time, as you know, is always not enough. <br><br>  All this obviously limits the scope of application of such a deployment method only to the simplest systems.  The time has come to change it. <br><br><br clear="all"><h4>  Docker </h4><br><img src="https://habrastorage.org/webt/kw/he/dz/kwhedzdiytfkvockures3cqm66i.jpeg" align="left">  At some point, freshly baked midli began to arrive, seething with ideas and delirious dockers.  Well, the flag in hand - do it!  There were two attempts.  Both failed, so to speak, because of big ambitions, but lack of real experience.  Was it necessary to force and finish by any means?  Hardly - the team must evolutionarily grow to the desired level before it can use the appropriate tools.  On top of that, using ready-made images of the docker, we often faced the fact that the network worked there incorrectly (which might have also been related to the dampness of the docker itself) or it was difficult to expand other people's containers. <br><br>  What inconveniences have we encountered? <br><br><ul><li>  Network problems in bridge mode </li><li>  It is inconvenient to watch the logs in the container (if they are not transferred to the host file system separately) </li><li>  Periodically strange suspension of ElasticSearch inside the container, the reason was not established, the container is official </li><li>  It is tricky to use the shell inside the container - everything is severely curtailed, there are no usual tools </li><li>  Large collectable containers - expensive to store </li><li>  Due to the large size of the containers, it is difficult to maintain multiple versions. </li><li>  Longer build, unlike other methods (scripts or deb-packages) </li></ul><br>  On the other hand, why the Spring-service in the form of a jar-archive is worse to deploy through the same deb?  Is resource isolation really necessary?  Is it worth losing convenient tools of the operating system, stuffing the service into a heavily trimmed container? <br><br>  As practice has shown, in reality this is not necessary, the deb-package is enough in 90% of cases. <br><br>  When all the same good old deb does not work, and when did we really need a docker? <br><br>  For us, this was the deployment of services in python.  Many libraries needed for machine learning and not in the standard delivery of the operating system (and the fact that there were not those versions), hacks with settings, the need for different versions for different services living on the same host system led to that the only sensible way to supply this nuclear mix was the docker.  The complexity of assembling the docker-container turned out to be lower than the idea to pack it all into separate deb-packages with dependencies, and actually no one in their right mind would have taken it. <br><br>  The second point where the docker is planned to be used is to deploy services according to the blue-green deploy scheme.  But here I want to get a gradual increase in complexity: deb packages are collected first, and then a docker container is assembled from them. <br><br><br clear="all"><h4>  Snap packages </h4><br><img src="https://habrastorage.org/webt/tx/gf/dx/txgfdxgq-kdxvmmqc8hin30g_re.jpeg" align="left">  Let's return to snap packages.  For the first time they officially appeared in Ubuntu 16.04.  Unlike the usual deb packages and rpm packages, snap carry all the dependencies.  On the one hand, this avoids the conflict of the libraries, on the other hand, it is a more significant size of the resulting package.  In addition, the same can affect the security of the system: in the case of the delivery of a snap, all changes to the included libraries should be followed by the developer himself who creates the package.  In general, not everything is so unequivocal and universal happiness from their use does not occur.  But, nevertheless, this is quite a reasonable alternative if the same Docker is used only as a means of packaging, and not virtualization. <br><br><br clear="all">  As a result, we now have in a reasonable combination both deb-packages and docker-containers, which, perhaps, in some cases, we will replace with snap-packages. </div><p>Source: <a href="https://habr.com/ru/post/444102/">https://habr.com/ru/post/444102/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444088/index.html">New material for fuel cells allows you to create long-term "energy cells"</a></li>
<li><a href="../444090/index.html">Methods for processing physical experiment data</a></li>
<li><a href="../444094/index.html">A sound insulation method has been developed that suppresses up to 94% of noise - we tell how it works</a></li>
<li><a href="../444096/index.html">Cancel WFIRST telescope and the Russians in orbit of the moon</a></li>
<li><a href="../444100/index.html">1. Check Point Getting Started R80.20. Introduction</a></li>
<li><a href="../444104/index.html">How to get the most out of your investment portfolio?</a></li>
<li><a href="../444106/index.html">Easel for microcontroller programmer</a></li>
<li><a href="../444110/index.html">Serial, UART and Android, as a link with microcontrollers</a></li>
<li><a href="../444112/index.html">Counting the trailing zeros of the factorial of a number in any number system</a></li>
<li><a href="../444114/index.html">How the personal data of patients and doctors could be affected due to the open ClickHouse database (updated)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>