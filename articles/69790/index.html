<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Watchman: on guard system</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Once upon a time in the cold winter time, 
 We uploaded a mountain backdoor to the server ... ‚Äù 

 Folk Admin Works 



 In general, once on one of t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Watchman: on guard system</h1><div class="post__text post__text-html js-mediator-article">  <em>"Once upon a time in the cold winter time,</em> <em><br></em>  <em>We uploaded a mountain backdoor to the server ... ‚Äù</em> <br><br>  Folk Admin Works <br><br><img title="Watchman" src="http://www.my-sosedi.ru/wp-content/uploads/2009/02/4440c214723b8.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, once on one of the servers, a php-shell was discovered, through which malicious hackers broke the cozy diary of a good person. <br>  After a two-hour tinkering in the logs of Apache, there was a hole through which the shell was poured. <br>  The hole was covered, the diary was brought back to life from backups, and they got a thought to think. <br><a name="habracut"></a><br>  After the third bottle of beer, the idea was born: ‚ÄúWhy not catch the execution of system calls from php scripts?‚Äù. <br>  The point is that most php-shells somehow use the functions <a href="http://ua2.php.net/manual/en/function.exec.php">exec ();</a>  , <a href="http://ua2.php.net/manual/en/function.system.php">system ();</a>  , <a href="http://ua2.php.net/manual/en/function.shell-exec.php">shell_exec ();</a>  or <a href="http://ua2.php.net/manual/en/function.passthru.php">passthru ();</a>  .  Accordingly, the execution of these functions can be intercepted and quietly logged that such and such a number on such a line called the exec () function with the ‚Äúrm -rf /‚Äù parameter. <br>  No sooner said than done.  The good man <a href="https://habrahabr.ru/users/kastigar/" class="user_link">kastigar</a> was delivered to those.  task and work began to boil. <br>  I‚Äôm not going to tell you how he picked up the subtleties of the Zend Engine, but in the end, an extension for PHP4 / PHP5 was born, codenamed BAXTEP. <br>  Initially, we did not plan to lay out the code for general access, because everything was written in general ‚Äúfor ourselves‚Äù and ‚Äúfrom and to‚Äù was not tested, but the open source spirit still took its <a href="http://baxtep.googlecode.com/">toll</a> - and the source code was posted on <a href="http://baxtep.googlecode.com/">GoogleCode</a> . <br><br><h2>  Assembly and installation: </h2><br><br>  The extension supports PHP versions 4 and 5. <br><br>  Requirements: <br><br>  - packages for PHP4 / PHP5 development (php4-dev, php5-dev) <br>  - gcc <br>  - subversion <br><br>  Pick up the source: <br><br><pre>  svn checkout http://baxtep.googlecode.com/svn/trunk/ baxtep </pre><br><br>  We collect: <br><br> <code>cd baxtep <br> phpize <br> ./configure <br> make</code> <br> <br>  After the build, we take out baxtep.so from the ./modules/ directory and put it in extension_dir, and in php.ini we add something like this: <br><br> <code>;;;;;;;;;; <br> ; BAXTEP ; <br> ;;;;;;;;;; <br> ; Load extension <br> extension=baxtep.so <br> <br> ; Absolute path to logfile. File must exist and have write access for php <br> baxtep.logfile = "/tmp/baxtep_messages"</code> <br> <br>  Log file you need to create yourself.  In addition, php scripts must have sufficient permissions to write to this file: <br><br> <code>touch /tmp/baxtep_messages <br> chmod 777 /tmp/baxtep_messages</code> <br> <br>  Everything, we restart Apache, write a test script and look at the log.  There will be something like this: <br><br> <code>2009-03-13 07:59:05 BAXTEP: system CMDLINE: `pwd` FILE: /var/www/html/test.php on line 5 URI: /test.php</code> <br> <br>  Format: <br><br> <code>-- :: BAXTEP:  CMDLINE:  FILE:       on line N URI:  REQUEST_URI</code> <br> <br>  <strong>UPD:</strong> <a href="https://habrahabr.ru/users/l0rda/" class="user_link">l0rda</a> assembled packages for CentOS 5 (i386 and x86_64), you can download it here: <a href="http://rpm.l0rda.biz/CentOS/5/RPMS/i386/">rpm.l0rda.biz/CentOS/5/RPMS/i386</a> , key: <a href="http://rpm.l0rda.biz/L0RDA-KEY">rpm.l0rda.biz/L0RDA-KEY</a> </div><p>Source: <a href="https://habr.com/ru/post/69790/">https://habr.com/ru/post/69790/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../69782/index.html">The course of the young fighter: protect the router itself</a></li>
<li><a href="../69783/index.html">Plum counted, or Sales in Russian</a></li>
<li><a href="../69785/index.html">Why Beeline Kamaz for 5 million?</a></li>
<li><a href="../69788/index.html">Pirate Bay with a taste of Wi-Fi</a></li>
<li><a href="../69789/index.html">Typedia font encyclopedia</a></li>
<li><a href="../69792/index.html">Video lesson on soldering small things</a></li>
<li><a href="../69797/index.html">Java virtual machine bytecode structure</a></li>
<li><a href="../69799/index.html">Opera Mini 5 beta released</a></li>
<li><a href="../69801/index.html">New version of Android Market is already available in Cyanogen Mod v4.1.10.1</a></li>
<li><a href="../69806/index.html">Microsoft refused to patch Windows XP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>