<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Animations in Android on the shelves (Part 2. Complex animations)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 1. Basic animations 
 Part 2. Complex animations 
 Part 3. "Low-level" animation 
 Part 4. Transition Animations 
 Part 5. Libraries for working ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Animations in Android on the shelves (Part 2. Complex animations)</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://habrahabr.ru/post/347918/">Part 1. Basic animations</a> <br>  <a href="https://habrahabr.ru/post/348336/">Part 2. Complex animations</a> <br>  <a href="https://habrahabr.ru/post/348664/">Part 3. "Low-level" animation</a> <br>  Part 4. Transition Animations <br>  Part 5. Libraries for working with animation <br><br>  The tools in the previous section were relatively low-level, and in Android there are much simpler ways to achieve beautiful animations without resorting to direct drawing of graphics or changing properties of objects. <br><br>  In this part we will consider as little effort as possible to get beautiful animations. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Part 2. Complex animations </h2><br><h3>  <a href="https://developer.android.com/training/animation/layout.html">1. Animation of layout changes (aka animateLayoutChanges)</a> </h3><br><img src="https://habrastorage.org/webt/3u/ov/so/3uovsoczuf4mrnnpopxjspavacq.gif" alt="image" width="300"><br><a name="habracut"></a><br>  All we need to do to achieve animation like on the gif above is to add the <code>animateLayoutChanges</code> flag to our ViewGroup in xml.  Now, when we remove or add an item to our container, or change its properties, they will automatically be animated. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AnyViewGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:animateLayoutChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Okay, I was a little cunning when I said that in order to get the animation like on the gif above, you just need to set the flag.  Adding <code>animateLayoutChanges</code> actually sets the <code>LayoutTransition</code> our ViewGroup.  But by default LayoutTransition only animates the change in the visibility of objects in the layout.  Therefore, if we want to change the properties of an object (for example, width and height), we need to enable this option separately: <br><br><pre> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> layoutTransition = viewGroup.layoutTransition layoutTransition.enableTransitionType(<span class="hljs-type"><span class="hljs-type">LayoutTransition</span></span>.<span class="hljs-type"><span class="hljs-type">CHANGING</span></span>)</code> </pre><br>  Now for sure.  If you want to somehow customize this behavior, then <code>LayoutTransition</code> has a <code>setAnimator</code> method <code>setAnimator</code> allows you to set your own change animation.  Well, the most hardcore guys can always write their own <code>LayoutTransition</code> . <br><br>  ‚Ä¢ Application: <br>  The basic animation changes objects on the scene. <br>  ‚Ä¢ Advantages: <br>  Minimum effort <br>  ‚Ä¢ Disadvantages: <br>  Weak customization <br><br><h3>  <a href="https://developer.android.com/training/transitions/overview.html">2. Transitions framework</a> </h3><br><img src="https://habrastorage.org/webt/ao/vo/a6/aovoa6id176pjkv01o7k-jbsdja.gif" alt="image" width="225"><br><br>  Starting from API 19, a new framework appeared in Android that allows you to create complex animations with a large number of elements and a minimum of code. <br><br>  There are two main options for its use: <br><br>  <b>1) Using <code>TransitionManager.beginDelayedTransition(ViewGroup)</code></b> <br>  To create an animation, you need to call TransitionManager.beginDelayedTransition (ViewGroup) before making changes to our View and transfer the ViewGroup that we want to animate to it.  The framework remembers the View state and starts the animation on the next frame. <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">TransitionManager</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.beginDelayedTransition</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">viewGroup</span></span>)</code> </pre><br>  <b>2) Creating scenes</b> <br>  Creating an animation in this case comes down to creating two similar xml, responsible for the initial and final state of your animations.  Accordingly, the id of the objects in the xml must match to give the framework the ability to find a match (Actually, <code>beginDelayedTransition</code> also creates scenes, one at the time of the call and the second in the next frame. Then it starts the animation between them). <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sceneA = Scene.getSceneForLayout(viewGroup, R.layout.scene_a, context) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sceneB = Scene.getSceneForLayout(viewGroup, R.layout.scene_b, context) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">expand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { TransitionManager.go(sceneB) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">collapse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { TransitionManager.go(sceneA) }</code> </pre><br>  Customization in the Transitions framework is achieved by passing the Transition object to the second parameter.  The default is <code>AutoTransition()</code> , so the code below will work exactly the same as the code above. <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">TransitionManager</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.go</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">sceneA</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">AutoTransition</span></span>())</code> </pre><br>  or <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">TransitionManager</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.beginDelayedTransition</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">viewGroup</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">AutoTransition</span></span>())</code> </pre><br>  And if you look inside <code>AutoTransition</code> you will notice that the animations will occur in <i>sequential order</i> in the following order: <br>  - disappearing objects are animated <br>  - animated resizing <br>  - animated objects appear <br><br><pre> <code class="xml hljs">setOrdering(ORDERING_SEQUENTIAL); addTransition(new Fade(Fade.OUT)). addTransition(new ChangeBounds()). addTransition(new Fade(Fade.IN));</code> </pre><br>  ‚Ä¢ Application: <br>  Animation of a large number of objects <br><br>  ‚Ä¢ Advantages: <br>  Minimum effort <br>  Available customization <br><br>  All examples can be <a href="https://github.com/JuzTosS/AnimationsDemo">viewed and studied here.</a> </div><p>Source: <a href="https://habr.com/ru/post/348336/">https://habr.com/ru/post/348336/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348326/index.html">Big Migration: How we raised a private cloud at RISC</a></li>
<li><a href="../348328/index.html">Creating a bonus system in Unity</a></li>
<li><a href="../348330/index.html">AI @ MIPT: ‚ÄúNeuromorphic computations and brain mechanisms‚Äù</a></li>
<li><a href="../348332/index.html">Bored mail or how to send messages from the site to Telegram via Node.js (Express)</a></li>
<li><a href="../348334/index.html">Game design to life. An example of the analysis of the mechanics of the game</a></li>
<li><a href="../348338/index.html">Implementing a parallel quick sort using ForkJoinPool</a></li>
<li><a href="../348340/index.html">29% of websites are vulnerable to a DOS attack even by one machine (CVE-2018-6389)</a></li>
<li><a href="../348344/index.html">Leakpocalypse: Rust can surprise unpleasantly</a></li>
<li><a href="../348346/index.html">New industry requirements: Certification Centers stop issuing 3-year SSL certificates from March 1, 2018</a></li>
<li><a href="../348348/index.html">It is dangerous to use EDS in Kazakhstan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>