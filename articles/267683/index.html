<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 39: XcodeGhost, D-Link certificate leak, million for a bug on iOS9</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A new episode of the series wants to start with the news, not related to information security in general. In Volkswagen cars with a diesel engine foun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 39: XcodeGhost, D-Link certificate leak, million for a bug on iOS9</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/54d/c3b/4e9/54dc3b4e9f764ec3b4958fc21cd0c69f.png" align="right">  A new episode of the series wants to start with the news, not related to information security in general.  In Volkswagen cars with a diesel engine found different indicators of emission of harmful substances during the movement, and during stationary testing.  Until everything is completely clear with this story, I would prefer to stick to just such a formulation.  This story tells us how important the software has become: it turned out that using a small tweak in the program code you can change a very important characteristic of the car, so much so that no one will notice. <br><br>  Wired <a href="http://www.wired.com/2015/09/vw-fool-epa-couldnt-trick-chemistry/">writes</a> that it was easy to hide the increased level of emission of harmful substances.  How is laboratory testing done?  The car is put on rollers, press on the gas, the wheels spin, the engine is running, the exhaust is analyzed.  What is the only difference between this mode and the usual driving on the highway?  That's right, the steering wheel doesn't move.  That is, it is enough to enter the only condition: nobody turns the steering wheel, and the car is driving - that means we are at the vehicle inspection station.  Such a "hack" could be detected only by chance - which, in fact, happened. <br><br>  Again, until the story was told to the end, the difference in exhaust can be considered as a deliberate action of the auto concern (or rather a narrow group of people responsible for the control code), as well as a simple mistake.  Could this be a mistake?  Yes, it is quite.  In today's digest of the most important news from the <a href="https://threatpost.ru/">Threatpost.ru</a> site in a week - stories about how mistakes occur, how they are used and how they make money on them.  All previous issues <a href="http://habrahabr.ru/search/%3Ftarget_type%3Dposts%26q%3D%255Bklsw%255D%2520%26order_by%3Ddate">here</a> . <br><a name="habracut"></a><br>  <b>D-Link mistakenly posted its own certificates to the public.</b> <br>  <a href="https://threatpost.ru/d-link-accidentally-leaks-private-code-signing-keys/11941/">News</a>  Detailed investigation on the Dutch website Tweakers.net with a <a href="http://tweakers.net/nieuws/105137/d-link-blundert-met-vrijgeven-privesleutels-van-certificaten.html">thick layer of</a> Google Translate. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Just imagine that you are a manufacturer of a variety of network pieces, from routers to surveillance cameras.  Firmware, drivers, software, software for updating firmware, software for updating drivers, drivers for updating software and firmware, and so on are attached to the hardware.  All of this lies somewhere on the secret server in the ‚ÄúVirtual Flow‚Äù daddy and, according to a pre-approved schedule, is updated, sent out, laid out on the update servers, and there are checked boxes, users get updates, everything is fine. <br><br>  Naturally, it is impossible to maintain a dimensionless nomenclature of glands with your hands; scripts are involved in this.  So we got a fresh code, so we launched a batch file (shell script, python, etz), so the fresh code decomposed into the necessary daddies, all this was packed into an archive, everyone is happy and happy.  But the engineer, named Jack, who decided to make a radical improvement in the script, tested it on a couple of tasks and was completely satisfied with the result.  But the bug that Jack built.  In one line of code responsible for selecting files and folders for updating, a space is missing or an extra bracket is placed, and hello - that which should not have gone to public under any circumstances begins to be sent to users. <br><br>  This I, of course, fantasize, maybe it was not so.  And in fact it turned out that: a vigilant user who downloaded the firmware update for the D-Link webcam found in the archive the keys with which the vendor signs his software.  There were several certificate keys; some of them have expired, but one recently - September 3. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a55/581/0f3/a555810f3a814e6ab5295799bf5aa0b8.jpg"></div><br><br>  And before that, for <b>six months the</b> key was in the public domain, and they could sign any software, including malicious software.  There is a clear mistake, offensive and dangerous.  We live in an era when a line of 512 numbers can contain anything: the key to infecting millions of computers, and hundreds of thousands of dollars in virtual currency, and access codes to top-secret information.  In this case, the same 512 bytes - a speck of dust on the surface of the hard disk of your computer, which can just as easily be thrown into open space.  It remains to hope that no one noticed, and yes, most often it happens.  But sometimes, alas, they notice, although specifically in the case of D-Link, a simple search for malware using a lost key did not give anything. <br><br>  <b>XcodeGhost - Apple IDE Bookmark</b> <br>  <a href="https://threatpost.ru/v_magazine_apple_obnaruzheny_zarazhennye_prilozhenija/11963/">News</a>  Palo Alto <a href="http://researchcenter.paloaltonetworks.com/2015/09/novel-malware-xcodeghost-modifies-xcode-infects-apple-ios-apps-and-hits-app-store/">study</a> .  <a href="http://www.macrumors.com/2015/09/24/xcodeghost-top-25-apps-apple-list/">List of</a> infected applications.  Official <a href="http://www.apple.com/cn/xcodeghost/">information</a> from Apple.  Alas, in Chinese. <br><br>  Imagine that you are a Chinese iPhone application developer.  Actually, there is nothing to imagine here: devices, development tools are the same for all developers, from any country.  Is that you need to add a little local flavor.  And here you are for the next cool project to buy a new Mac, put on it the Xcode development environment and, therefore, code.  Everything is good, except for one thing: from the Apple site, free Xcode downloads very slowly, because it is hosted for the great firewall.  It's easier to download from the local site, it's much faster, and what's the difference - for free. <br><br>  Then <i>suddenly</i> in the code of several applications, popular and not so, a malicious insert is detected, which, at a minimum, sends the encrypted information about the device to the C &amp; C server.  As a maximum, commands are received from the server, possibly allowing you to do something bad with the device owner, and exploiting vulnerabilities in iOS. <br><br><img src="https://habrastorage.org/files/b4a/fa9/1fb/b4afa91fbe394a26954ff23e7329fe6e.png"><br>  <i>Code "bookmarks" from the <a href="http://researchcenter.paloaltonetworks.com/2015/09/novel-malware-xcodeghost-modifies-xcode-infects-apple-ios-apps-and-hits-app-store/">study of</a> Palo Alto.</i> <br><br>  Next, it turns out that the tab was in those very locally-available versions of Xcode, and in several releases of Xcode at once, that is, someone made these bookmarks quite purposefully.  It is even worse: it‚Äôs not even the fact that two dozen of quite popular applications have suffered (including the popular WeChat chat and the local version of Angry Birds), but the malicious code went through the App Store moderation.  Naturally, now all the infected applications have been deleted, and finding a bookmark, after everyone has learned about it, is quite simple - at least across the domains of the management servers (they are also blocked).  But without knowing about the tab, it was quite difficult to find it: they hid it wisely, inserting into the standard Apple libraries used in 99.9% of applications. <br><br>  Here is another interesting moment.  The Intercept edition, which specializes (including) in disclosing secret data from Edward Snowden, <a href="https://theintercept.com/2015/09/22/apples-app-store-infected-type-malware-cia-developed/">reports</a> that the method of penetration of infected software on Apple devices from XcodeGhost is fully consistent with the secret plans of those very leaks.  Journalists say that they made this information public <a href="https://theintercept.com/2015/03/10/ispy-cia-campaign-steal-apples-secrets/">in March of</a> this year.  Say "Vooot, and we said!".  Well, and we said even earlier: in 2009, before Snowden and others, we, for example, <a href="http://www.kaspersky.com/news%3Fid%3D207575885">found malware</a> infecting IDE Delphi, and inserting a bookmark in all compiled applications.  The idea lies on the surface.  However, knowing about such a problem, it is also easy to eliminate it: it is enough to verify the integrity of the development tool with the standard.  Well, do not download software from dubious sources, although we seem to be talking about experienced developers, right?  Oh, they can not make such a banal mistake?  It turns out that they can. <br><br>  <b>Hole dealer announced a million award for vulnerability in iOS 9</b> <br>  <a href="https://threatpost.ru/zerodium-hosts-million-dollar-ios-9-bug-bounty/11993/">News</a> <br><br>  Wikipedia has a <a href="https://en.wikipedia.org/wiki/IOS_jailbreaking">sign</a> about the history of the jailbreak of Apple devices.  Unlike Android and desktop operating systems, where the ability to have full control over the system is, in general, standard, and relatively easy to operate, smartphones, tablets (and even watches and TV set-top boxes) from Apple were originally made so that user rights quite seriously limited.  And now, for seven years, the vendor, on the one hand, has been trying <s>to</s> protect his devices as much as possible, and on the other hand, ahem, the community of caring lovers of the root hacks this protection.  And almost always cracks: jailbreak for all devices, with the exception of the third version of Apple TV and (so far) hours, always appears in the period from one day to six months after the device appeared on sale. <br><br>  So, for a fresh iOS 9 jailbreak seems to be there, but on the other hand it doesn't seem to exist.  It was not possible to break the system to the end.  Zerodium is planning to <i>‚Äú</i> rectify <i>‚Äù the</i> situation, announcing a reward of up to a million dollars to anyone who shows how iOS 9 is hacked with the following properties: <br><br>  - The exploit should be launched remotely (for example, automatically when visiting a prepared page in a browser, opening or receiving an SMS or MMS) <br>  - Exploit allows you to install an arbitrary application on the device (for example, Cydia) <br>  - Changes to the device should be saved after a reboot <br>  - The exploit should be ‚Äúreliable, imperceptible, not requiring user intervention‚Äù <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/580/a5c/096/580a5c096e1e408c884e68b2ec808c70.jpeg"></div><br><br>  According to this list, it is already clear that the company is not going to throw three million dollars to the wind at all (this is a general prize fund) in order to satisfy the rut-fans.  The founder of Zerodium, Chauki Bekrarar, had previously formed VUPEN.  The latter specializes in providing "government agencies" with tools for computer hacking.  This is such a <s>muddy</s> gray area in which, presumably, the good guys catch the bad guys with the tools of the bad guys.  And if VUPEN, at least officially, does not trade in exploits, then Zerodium was created just for this.  This means that as a result, someone may receive a lot of money, someone else will hack using the device exploit purchased, without revealing the details of the vulnerability (otherwise, what‚Äôs the point of paying?).  What happens when exploit traders are cracked, we already <a href="https://threatpost.ru/400-gbajt-konfidentsialnyh-dannyh-utekli-iz-hacking-team/9577/">know</a> from the example of the Hacking Team: all of a sudden there were many zero-day vulnerabilities in public access, and the dark business of the company in the Middle East, and in general. <br><br>  So, if someone really wants to break his own iPhone, then this is absolutely not forbidden (or rather, it is forbidden, but with restrictions).  But hacking someone's device without the knowledge of the user is not very good, and if such a possibility is found, then it is desirable that the vendor should know it and close it.  In the end, hacking for the sake of the most good goals is still hacking. <br><br>  <b>What else happened:</b> <br>  Adobe has <a href="https://threatpost.ru/adobe-patches-23-critical-vulnerabilities-in-flash-player/11999/">closed</a> 23 vulnerabilities in Flash Player.  In August <a href="https://threatpost.ru/huge-flash-update-patches-more-than-30-vulnerabilities/10804/">,</a> another 30 <a href="https://threatpost.ru/huge-flash-update-patches-more-than-30-vulnerabilities/10804/">were closed</a> . <br><br>  Data from millions of public sector employees, including 5.6 million (!) Fingerprints, were <a href="https://threatpost.com/5-6-million-fingerprints-stolen-in-opm-hack/114784/">stolen</a> from the US government.  Couch analysts point out that the finger is not a password, you just can‚Äôt change it, and the number of combinations is limited.  So far, nothing illegal with these prints can be done, but who knows what the progress will be. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2ff/787/c3b/2ff787c3bfb64aedb366fe2c66f6d040.png"></div><br>  <i><a href="https://twitter.com/jpluscplusm/status/646811379312279552">Change</a> fingerprints more often, use a fingerprint manager and never use the same fingerprint twice.</i> <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right">  <b>Antiquities:</b> <br>  "PrintScreen" <br><br>  Very dangerous virus, 512 bytes in length (1 sector).  It infects the boot sector of floppy disks and the hard drive when reading from them (int 13h).  The old boot sector stores on the floppy disk at 1/0/3 (stron / track / sector), and on the hard drive at 3/1/13.  At the same time, it can destroy one of the FAT sectors or data (depending on the disk size).  When infecting a hard drive, it assumes that its boot sector is located at 0/1/1 (this indicates a low qualification of the author of the virus). <br><br>  Intercepts int 13h.  Judging by the virus's listing, when a disk is infected with a probability of 1/256 (depending on the value of its internal counter), the virus should cause int 5 (screen printing), but an error is made, as a result of which the new counter value is not saved. <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 102.</i> <br><br>  <i>Disclaimer: This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/267683/">https://habr.com/ru/post/267683/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267673/index.html">How to evaluate the quality of the product</a></li>
<li><a href="../267675/index.html">Software support</a></li>
<li><a href="../267677/index.html">10 common mistakes novice web developers</a></li>
<li><a href="../267679/index.html">How we did the conversation: from the prototype on the hackathon to the application of Yandex</a></li>
<li><a href="../267681/index.html">Why did Apple come up with and introduced in iOS a new font San Francisco?</a></li>
<li><a href="../267687/index.html">How to improve application localization using glossaries</a></li>
<li><a href="../267689/index.html">Activity Control with Google reCAPTCHA</a></li>
<li><a href="../267691/index.html">Live broadcast Droidcon Moscow 2015</a></li>
<li><a href="../267697/index.html">Command line utilities can be 235 times faster than your Hadoop cluster</a></li>
<li><a href="../267699/index.html">How yoga kodit and live helps: personal experience</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>