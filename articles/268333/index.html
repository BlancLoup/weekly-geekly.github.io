<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Office as Platform Issue 5 - Introducing the OneNote REST API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the next article, Alexander Bogdanova talks about using the new OneNote REST API for applications of any type and using the example of universal Wi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Office as Platform Issue 5 - Introducing the OneNote REST API</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <i>In the next article, Alexander Bogdanova talks about using the new OneNote REST API for applications of any type and using the example of universal Windows 10 applications. You can always find all articles in the ‚ÄúOffice as Platform‚Äù column using the link <a href="http://habrahabr.ru/search/%3Fq%3D%255B%2523officeplatform%255D%26target_type%3Dposts">#officeplatform</a> - Vladimir Yunev.</i> </blockquote>  <a href="http://www.onenote.com/">OneNote</a> is one of the most popular applications for creating notes, lists, daily routines.  In order to simplify the creation of diaries, Microsoft released the OneNote API.  You can integrate OneNote to work with notes in your application.  For developers, <a href="http://dev.onenote.com/">OneNote REST API is available</a> , on the basis of which you can create an application for any platform. <br><br><div style="text-align:center;"><img width="650" src="https://habrastorage.org/files/30d/ee3/456/30dee3456d514066946fdd2653fddb19.png"></div><br>  <a href="http://habrahabr.ru/post/220169/">On Habr√©,</a> <a href="http://habrahabr.ru/post/220169/">there was already a</a> brief tutorial on using OneNote API, today I will talk about the capabilities of the OneNote REST API using the example of a Windows 10 application. <br><a name="habracut"></a><br><h3>  How does the OneNote API work? </h3><br>  The Microsoft OneNote API runs in the globally accessible Microsoft cloud and sends data from your applications to the user's OneDrive client. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a1c/4a3/c45/a1c4a3c45e6e42e889db8c172282ee2f.png"></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Working with the OneNote API in an application consists of three steps: <br><br><ol><li>  <a href="http://msdn.microsoft.com/ru-ru/library/office/dn575435(v%3Doffice.15).aspx">Verify user login information</a> and get the OAuth token for a Microsoft account in case a user wants to send data to OneNote. </li><li>  <a href="http://msdn.microsoft.com/ru-ru/library/office/dn575428(v%3Doffice.15).aspx">Sending information and token to the</a> API. </li><li>  Add data to a notebook on the Internet.  Data becomes available in other OneNote clients. </li></ol><br>  In order to start working with the OneNote API, you need to obtain a client identifier (clientID).  Let's see how to do it. <br><br><h3>  Getting client ID (clientID) </h3><br>  Go to the <a href="https://account.live.com/developers/applications/index">Development Center for Microsoft Accounts</a> website and sign in with your Microsoft account.  A window opens in which the applications you created previously are displayed. <br><br>  For those who do not have an account: Create a Microsoft account <a href="https://signup.live.com/signup.aspx%3Flic%3D1">here</a> . <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/ca2/574/28c/ca257428c4f140c1a83eca2db026a52e.png"></div><br><br>  Click <b>Create Application</b> , enter the Application Name, and click <b>I Accept.</b> <br><br><img src="https://habrastorage.org/files/23b/71a/fdb/23b71afdb6df41e48771ee73d5105842.png"><br><br>  On the left, select <b>Application Settings</b> , the <b>client ID</b> appears on the screen.  That is what we need. <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/e07/b95/384/e07b95384c754f58b64dbf45aa0a6706.png"></div><br><br>  Next, to use the API in the application, you need to carry out the process of authorizing the user, check his credentials, get a token to perform requests. <br><br><h3>  User authentication </h3><br>  When using the OneNote API, an application must request certain permissions when verifying a Microsoft account.  For the user, this process is standard - a login and password entry form appears, then it is asked to allow the application to perform any activity on its behalf (for example, to post entries or to be able to view friends from the social network). <br><br>  The developer needs to conduct a user authentication process, get a token.  We will use the OAuth 2.0 authorization process, for this we need a <a href="http://yandex.ru/clck/jsredir%3Ffrom%3Dyandex.ru%253Byandsearch%253Bweb%253B%253B%26amp%3Btext%3D%26amp%3Betext%3D577.bj9Vl1pt5XvD-4S36nsxC1z8gaMBzI4rFPaoM_REnTLVVbFa6ihy5QfwuYZ1oRB0.9e7195f1c045ef86f6dbc6d96401485cfd47cf77%26amp%3Buuid%3D%26amp%3Bstate%3DAiuY0DBWFJ4ePaEse6rgeAjgs2pI3DW99KUdgowt9XsMCv5TMMN9UQmOZZ0YK44d_VVrnwO4aZpVBnT0P4VI7JsVHxmRm9p7dVsSufUoW8W-aiBIOlwxsTRReJJ9k3cEzCa4UlmWQL8rbs6jex3AI6qqnemSkAJUlZJ9z5MNgck5h2IGPdB_rQM0-P-J6M132cw8ewVrWWfn2bOi75r5zXZP6EJbKnWT8fFCAa-yoligFxh8xxYfKjLCZ09Pud1iZ7ZL7__BZCjcZPHfMHt-xfvZYIzX8xgYRGe-FPHWvxWGjscoJHPWMyRdRIs1f_NPFMlh9fxbxjqGzh9usXEZl0QvBrqkB35nt15u6XsB0jVe3erBg8XvuENG6kHzJ3Z84zt0PFSpIO3qkWIOifw-R2unJYiCAwrNB8pGjifXN_FDJ6-AFp9uOWx6NCLeBSAVgB95GcS-h_q3D7iQVQf-sztPovBul1HEieKb_ucvUxsQAXCzUdD563WaLX_RLUp0pk8DccX-cMoben0fEGwvx0aJKX_yV2Bg6hnisnTbk00k9ejZRSiopQ%26amp%3Bdata%3DUlNrNmk5WktYejR0eWJFYk1LdmtxdTZzT3d6Mlo1Nm9vaWdJMlhJSHNaX3J6ZTE3bUJXOV9PeUVSVndZeEFRZjlHUXljMXY4dEEtSHg2dXVPSzZRTVhVajdWdjRUSmxESjBwcFB1SDdrV3Y5THhvdjJ1Q2ZIZWdoSFJwUE9mVmlxWm9zT0k2SkNTYnVLMmhLbVJ6dkNyVXhvZ0h4aExBVlJBQ2ZGNlJJVWNfQTB5MU1Vblp3Um80WjZmSkliV0czQ1NPd2h6QkJndmg0VUNNUE9WQjlMUWF5UVAzcnYyWk1GU040UGFsSW1LYw%26amp%3Bb64e%3D2%26amp%3Bsign%3D4be3e9580339299e0f4b672cd68d50e2%26amp%3Bkeyno%3D0%26amp%3Bl10n%3Dru%26amp%3Bcts%3D1421914745478%26amp%3Bmc%3D0">WebAuthenticationBroker</a> . <br><br>  At the beginning, the client executes a request for authorization at a specific address, therefore, first we need to generate this address.  In general, it looks like this: <br><br>  <a href="">login.live.com/oauth20_authorize.srf?client_id=CLIENT_ID&amp;scope=SCOPES&amp;response_type=RESPONSE_TYPE&amp;redirect_uri=REDIRECT_URL</a> <br><br>  Below is a table with query parameters: <br><table border="1"><tbody><tr><td width="203">  <b>Parameter</b> <br></td><td width="171">  <b>Description</b> <br></td><td width="250">  <b>Value</b> <br></td></tr><tr><td width="203">  CLIENT_ID <br></td><td width="171">  Customer ID <br></td><td width="250">  00000000 *** <br></td></tr><tr><td width="203">  SCOPES <br></td><td width="171">  Corresponds to the scope parameter in the OAuth 2.0 specification. <br></td><td width="250">  wl.signin% 20wl.basic <br></td></tr><tr><td width="203">  response_type <br></td><td width="171">  Type of data returned in the authorization server response <br></td><td width="250">  token <br></td></tr><tr><td width="203">  REDIRECT_URI <br></td><td width="171">  URI to redirect the user after authentication <br></td><td width="250">  https% 3A% 2F% 2Fwww.tdgdgdgdd.com <br></td></tr></tbody></table>  <a href="http://yandex.ru/clck/jsredir%3Ffrom%3Dyandex.ru%253Byandsearch%253Bweb%253B%253B%26amp%3Btext%3D%26amp%3Betext%3D577.bj9Vl1pt5XvD-4S36nsxC1z8gaMBzI4rFPaoM_REnTLVVbFa6ihy5QfwuYZ1oRB0.9e7195f1c045ef86f6dbc6d96401485cfd47cf77%26amp%3Buuid%3D%26amp%3Bstate%3DAiuY0DBWFJ4ePaEse6rgeAjgs2pI3DW99KUdgowt9XsMCv5TMMN9UQmOZZ0YK44d_VVrnwO4aZpVBnT0P4VI7JsVHxmRm9p7dVsSufUoW8W-aiBIOlwxsTRReJJ9k3cEzCa4UlmWQL8rbs6jex3AI6qqnemSkAJUlZJ9z5MNgck5h2IGPdB_rQM0-P-J6M132cw8ewVrWWfn2bOi75r5zXZP6EJbKnWT8fFCAa-yoligFxh8xxYfKjLCZ09Pud1iZ7ZL7__BZCjcZPHfMHt-xfvZYIzX8xgYRGe-FPHWvxWGjscoJHPWMyRdRIs1f_NPFMlh9fxbxjqGzh9usXEZl0QvBrqkB35nt15u6XsB0jVe3erBg8XvuENG6kHzJ3Z84zt0PFSpIO3qkWIOifw-R2unJYiCAwrNB8pGjifXN_FDJ6-AFp9uOWx6NCLeBSAVgB95GcS-h_q3D7iQVQf-sztPovBul1HEieKb_ucvUxsQAXCzUdD563WaLX_RLUp0pk8DccX-cMoben0fEGwvx0aJKX_yV2Bg6hnisnTbk00k9ejZRSiopQ%26amp%3Bdata%3DUlNrNmk5WktYejR0eWJFYk1LdmtxdTZzT3d6Mlo1Nm9vaWdJMlhJSHNaX3J6ZTE3bUJXOV9PeUVSVndZeEFRZjlHUXljMXY4dEEtSHg2dXVPSzZRTVhVajdWdjRUSmxESjBwcFB1SDdrV3Y5THhvdjJ1Q2ZIZWdoSFJwUE9mVmlxWm9zT0k2SkNTYnVLMmhLbVJ6dkNyVXhvZ0h4aExBVlJBQ2ZGNlJJVWNfQTB5MU1Vblp3Um80WjZmSkliV0czQ1NPd2h6QkJndmg0VUNNUE9WQjlMUWF5UVAzcnYyWk1GU040UGFsSW1LYw%26amp%3Bb64e%3D2%26amp%3Bsign%3D4be3e9580339299e0f4b672cd68d50e2%26amp%3Bkeyno%3D0%26amp%3Bl10n%3Dru%26amp%3Bcts%3D1421914745478%26amp%3Bmc%3D0">WebAuthenticationBroker</a> takes two parameters as input: the address of the request that we created earlier and REDIRECT_URI.  Note the format of the forwarding address for the request. <br><br>  Authorization Request Code (for Windows): <br><br><pre><code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getToken</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { //  var startURI = Windows.Foundation.Uri(<span class="hljs-string"><span class="hljs-string">"https://login.live.com/oauth20_authorize.srf?client_id=0000000040*****&amp;scope=wl.signin%20wl.basic&amp;response_type=token&amp;redirect_uri=https%3A%2F%2Fwww.tdgdgdgdd.com"</span></span>); // REDIRECT_URI var endURI = Windows.Foundation.Uri(<span class="hljs-string"><span class="hljs-string">"https://www.tdgdgdgdd.com"</span></span>); //   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Windows.Security.Authentication.Web.WebAuthenticationBroker.authenticateAsync( Windows.Security.Authentication.Web.WebAuthenticationOptions.none, startURI, endURI).<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onComplete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getTokenFromResponse(response.responseData); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(error)</span></span></span></span> { //  }); }</code> </pre> <br>  In case of a successful request, you will receive a string in the following form: <br><br>  <a href="">https://login.live.com/oauth20_desktop.srf?lc=1033#access_token=******token_type=bearer&amp;expires_in=3600&amp;scope=wl.signin%20wl.basic&amp;user_id=**********</a> <br><br>  For further requests, we need only what is between the <b>access_</b> <b>token</b> and <b>token_</b> <b>type</b> , cut off the list: <br><br><pre> <code class="hljs actionscript"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTokenFromResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startid = response.indexOf(<span class="hljs-string"><span class="hljs-string">"access_token"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> endid = response.indexOf(<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>, startid + <span class="hljs-number"><span class="hljs-number">13</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> token = response.substring(startid + <span class="hljs-number"><span class="hljs-number">13</span></span>, endid); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> token; }</code> </pre> <br>  Note the difference in methods for Windows and Windows Phone.  For Windows, the authenticateAsync method is used, and for Windows Phone, the authenticateAndContinue method is used.  Also consider saving and restoring the application mode when the authorization window appears. <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/f75/a11/7e0/f75a117e00c84d838fe5c5d5a3cf34dd.png"></div><br><br>  Fine!  Token received and now you can make requests. <br><br><h3>  Sending POST and GET requests </h3><br>  Receiving and recording data occurs using POST and GET requests. <br><br>  Currently, the OneNote API allows you to: <br><br><ul><li>  View the list and add new notebooks (Notebooks) </li><li>  View the list and add new sections (Sections) </li><li>  View the list and add new pages (Pages). </li><li>  View the contents of pages (Pages) (viewing the contents of pages while in Beta mode) </li></ul><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/9a3/5eb/6d1/9a35eb6d1c6c46828c27e7443f656eef.png"></div><br>  You can view the format and advanced request parameters on the <a href="http://dev.onenote.com/docs">OneNote Development Center</a> website.  Also on the site there is an opportunity to choose a language and see an example of a specific request code, as well as an answer option. <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/d4c/31a/307/d4c31a307ade4c75856f7b771cb01133.png"></div><br><br>  In addition to <a href="http://dev.onenote.com/docs">the OneNote Development Center</a> , you can test your request in the <a href="https://apigee.com/onenote/embed/console/onenote">apigee.com</a> interactive console. <br><br><h3>  Work with the apigee interactive console </h3><br>  The console allows you to create a simple REST call to the OneNote API.  To get started with the console, <a href="https://apigee.com/onenote/embed/console/onenote">go to the site</a> . <br><br>  Click <b>oAuth</b> in the upper left corner and select <b>OAuth 2 Implicit Grant</b> . <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/91b/418/1da/91b4181daca94a3692ac8d5f3bc34a0f.png"></div><br><br>  Click the <b>Sign in with OneNote</b> button, then enter your Microsoft credentials. <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/2fb/f94/6f2/2fbf946f284a4934af64bc1c4805b260.png"></div><br><br>  Confirm that you allow the OneNote API to create pages in OneNote.  Click <b>Yes</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/74e/2a9/3a8/74e2a93a827d4a6ba91c7cca868c9f7d.png"></div><br><br>  Now you can send requests to the API and create pages in OneNote notebooks that are hosted on OneDrive. <br><br><h3>  Sending a request using the interactive console </h3><br>  On the left is a gray arrow.  Click on it to open a list of possible requests.  Then select the query you want to make. <br><br>  For example, add a new notebook.  To do this, select the section <b>Notebooks</b> , <b>POST</b> <b>notebooks</b> . <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/779/845/31b/77984531b0dd432287dae3269992b006.png"></div><br><br>  A page will appear, at the top of which will be the address of the request, just below you can select the data of your request (name of the address book, the main text of the page, etc.). <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/eee/76d/f26/eee76df2648f454ca068246a81fb8a24.png"></div><br><br>  Click the <b>Send</b> button and the request will be sent. <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/291/e12/bf0/291e12bf09ba47928ca74b9a8232bf7b.png"></div><br><br>  The request body will be displayed on the left side of the screen, and the response from the OneNote API will be displayed on the right.  Note data such as <b>Content-Type</b> and <b>Autorization</b> .  You will need them when you create a request in your application. <br><br><h3>  Using the OneNote API in a generic application </h3><br>  We got acquainted with the main stages of working with the OneNote REST API.  Now let's take a look at the OneNote API features using the example of a universal HTML and JavaScript application. <br><br>  The main application logic is as follows: <br><br><ul><li>  When you start the application, an authorization window appears where the user needs to enter the login and password of his account. </li><li>  Further, in case of successful login, the page with the list of available for viewing notebooks (Notebooks) is loaded. </li><li>  Book lists are loaded as buttons; when you click on each, the corresponding section list is loaded.  Also we come with a list of sections and pages. </li></ul><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/af3/09a/f6f/af309af6f5364c8e9d3c0e6b983257cb.png"></div><br><br>  <strong>Sending a GET request</strong> <br><br>  To download the list, we use the XMLHttpRequest request. <br><br>  In the open method we form a GET request.  Link - the address to download available for viewing notebooks, <a href="https://www.onenote.com/api/v1.0/notebooks">https://www.onenote.com/api/v1.0/notebooks</a> . <br><br>  Further, in the parameters of the setRequestHeader method, we specify that authorization will occur using a token. <br><br>  And finally, we process the answer.  As a response, we receive a JSON file that needs to be ‚Äúparsed‚Äù for further work.  After that, based on the number of available notebooks (sections, pages), buttons are created, in whose properties we need to write a link to the section (page) to which they lead. <br><br>  You can see an example of the request under the spoiler. An example of this request is presented. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> GetNotebookList(token) { //  var request = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> XMLHttpRequest; // <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> request.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>("GET", "https://www.onenote.com/api/v1.0/notebooks", <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); // setRequestHeader request.setRequestHeader("Authorization", "Bearer " + token); //  request.onreadystatechange = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> (response) { //  var notes = <span class="hljs-type"><span class="hljs-type">JSON</span></span>.parse(this.responseText); var length = notes.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.length; //   var buttonList = document.createElement("div"); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (var i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length; i++) { var NotebookName = notes.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>[i].name; var sec = notes.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>[i].self; var b = document.createElement("button"); b.innerText = NotebookName; b.id = notes.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>[i].id; var link = notes.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>[i].sectionsUrl; b.dataset.link = link; buttonList.appendChild(b); //     ‚Äì    + //    ,      b.addEventListener("click", <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> (e) { var link = this.dataset.link; WinJS.Navigation.navigate("/pages/notebook/viewnotebook.html",link); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }); } var buttonsDiv = document.getElementById("buttonsDiv"); buttonsDiv.appendChild(buttonList); } request.send(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre> <br>  <strong>Tip:</strong> <a href="https://msdn.microsoft.com/en-us/library/windows/apps/dn301831.aspx">x-ms-webview is a good choice</a> for displaying page content. <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/1b8/73b/385/1b873b385d7942faac0f48aea1a32130.png"></div><br><br>  <strong>Sending a POST request</strong> <br><br>  In OneNote API POST request is used when creating new pages (notebooks, sections). <br><br>  For example, if you want to add a new page, the request will be as follows. <img alt="Sad face" src="http://$wlEmoticon-sadsmile[2].png"><br><br><pre> <code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PostNewPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(token)</span></span></span></span> { var body = document.getElementById(<span class="hljs-string"><span class="hljs-string">"viewPage"</span></span>).innerHTML; //  var request = new XMLHttpRequest; // <span class="hljs-built_in"><span class="hljs-built_in">open</span></span> request.<span class="hljs-built_in"><span class="hljs-built_in">open</span></span>(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>, https://www.onenote.com/api/v1<span class="hljs-number"><span class="hljs-number">.0</span></span>/pages, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); // setRequestHeader request.setRequestHeader(<span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>, <span class="hljs-string"><span class="hljs-string">'application/xhtml+xml'</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);v // setRequestHeader request.setRequestHeader(<span class="hljs-string"><span class="hljs-string">"Authorization"</span></span>, <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span> + token); //  request.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span></span> { //  } request.send(body.name); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; } }</code> </pre> <br>  Please note that in the POST request for adding a new page we use the setRequestHeader method twice - once we define the format of the data to be sent ( <b>application / xhtml + xml</b> ), then we set the authorization parameters. <br><br>  The remaining requests are similar to those that we have already considered.  Once again, I would like to draw your attention to the fact that you can test your request in the interactive console <a href="https://apigee.com/onenote/embed/console/onenote">apigee.com</a> or view the required request parameters on the <a href="http://dev.onenote.com/docs">OneNote Development Center</a> website. <br><br>  Working with OneNote API is very simple, I suggest you start right now! <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/files/0b2/917/804/0b29178046a445d795049789424ab424.png"></div><br><br><h3>  Additional links </h3><br><ul><li>  <a href="http://dev.onenote.com/docs">OneNote Development Center</a> </li><li>  <a href="https://apigee.com/onenote/embed/console/onenote">Apigee.com Interactive Console for OneNote API</a> </li><li>  <a href="http://www.microsoftvirtualacademy.com/training-courses/publication-and-promotion-applications-in-windows-store-rus">View a course on publishing applications in the Windows Store</a> </li><li>  <a href="http://l.techdays.ru/go/getvs">Download free or trial Visual Studio</a> </li></ul><br><h3>  about the author </h3><br><img src="https://habrastorage.org/files/e31/c01/2fd/e31c012fd4d94027a3069ca69521da44.png"><br><br>  Alexandra Bogdanova, project manager, Customer and Partner Experience, Microsoft Russia.  Participant of various conferences, meetings, hackathons, including Microsoft Developer Tour and Microsoft Developer Conference. </div><p>Source: <a href="https://habr.com/ru/post/268333/">https://habr.com/ru/post/268333/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268319/index.html">Two tasks HeadHunter on Data Science Week: try to solve it yourself</a></li>
<li><a href="../268325/index.html">What can be not ready, becoming a team lead</a></li>
<li><a href="../268327/index.html">AI, BigData & HPC Digest # 2</a></li>
<li><a href="../268329/index.html">Intel sold Microsoft's Havok</a></li>
<li><a href="../268331/index.html">DHCP server on multiple VLANs</a></li>
<li><a href="../268335/index.html">(Archive) Matreshka.js ECMAScript.next boilerplate</a></li>
<li><a href="../268337/index.html">Welcome to OWASP EEE October 11</a></li>
<li><a href="../268339/index.html">Adding a new processor family to IDA pro</a></li>
<li><a href="../268341/index.html">We are looking for stability in retail, XYZ analysis of the range</a></li>
<li><a href="../268343/index.html">How do startups need IaaS: Speech Recognition Services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>