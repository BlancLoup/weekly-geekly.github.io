<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reverse Development of April Fools' Snake by Google</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Perhaps one of you noticed that Google on April 1 added an interactive game ‚ÄúSnake‚Äù to the Google Maps application for Android and iOS. 

 Check Point...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reverse Development of April Fools' Snake by Google</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/652/8f8/687/6528f8687ec814cb2ae33bfc63f46f97.jpg"><br><br>  Perhaps one of you noticed that Google on April 1 added an interactive game ‚ÄúSnake‚Äù to the Google Maps application for Android and iOS. <br><br>  Check Point specialists are usually busy researching the latest cyber threats, but here they were very enthusiastic about this game, however, they were very upset because of losses ... therefore a logical thought arose: why not crack it! <br><a name="habracut"></a><br>  Thus, our most mischievous employees began to think about the reverse development of the application using remote debugging.  In general, they succeeded, and soon we successfully completed the task of never losing - and even added a simple AI that plays the game itself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b62/c71/fc4/b62c71fc418fcb097b52c4245eeb4d6c.jpg" width="550"></div><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/865/187/d2b/865187d2b602ab168bdfafd147e64598.png"></div><br><br>  In this article we describe in detail the hack. <br><br>  First, we opened the application on a virtual device through Genymotion and launched ‚ÄúSnake‚Äù, which is located in the menu in the upper right corner. <br><br>  It looks like the game is displayed in WebView, so we launched remote debugging in the Chrome developer tools: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/513/35d/b2a/51335db2aeb6fec60fce9f3b15ad8dc5.png"><br><br>  Then we went to the site and found the v18.js file on the source tab, and there are several interesting features. <br><br>  First, the <b>fa ()</b> function initiates a 20 √ó 20 field: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.height = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.width = <span class="hljs-number"><span class="hljs-number">20</span></span>;</code> </pre> <br>  Our main goal is to find and change a function that determines when a snake smashes into a wall or into itself in order to disable the possibility of losing.  The variables <i>width</i> and <i>height</i> represent the dimensions of the playing field, so we looked for the <i>width</i> and <i>height</i> inside the source code and found the function <b>F (a, b)</b> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7db/875/4aa/7db8754aa46203e12e8cc609cd7c106e.png"></div><br><br>  It seems that <b>F (a, b)</b> checks if the coordinates of the body of the snake are within the field.  One option is to completely remove the conditions in the function so that it always returns the truth, thereby transferring us to the ‚ÄúGod mode‚Äù where we can pass through the walls without dying. <br><br>  To do this, we pressed the <i>Inspect</i> button in the remote console and changed the function <b>F (a, b)</b> to the following: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21e/14d/452/21e14d452d2b31afdec5ca293cc2eb86.png"></div><br><br>  Now we can pass through the walls: <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/5e1/7c8/27d/5e17c827d93c1e9dffbc3e73c9be1998.png"></a> </div><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">1. God mode</font></i> <br><br>  It's all very well, but we still have to play, picking up people on our own to earn points.  The following hack will solve this problem. <br><br>  There are many <b>wa (a)</b> function calls in the call stack.  If we study this function, we will see that it is recursive and is responsible for requesting animation frames.  <b>wa (a)</b> calls the functions <b>xa (a, b)</b> and <b>ya (a)</b> , which display the game pieces (train, people) and field, respectively. <br><br>  Consider the function <b>xa (a, b)</b> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd0/524/984/bd052498424b070f1927505e064bb65c.png"></div><br><br>  It takes two arguments: 'a' and 'b'.  The first is part of the global variable Q, which contains interesting information about our game, including an array, which represents the playing field (Fig. 2), where we see the train (M), people and objects (K).  The function also calculates the score and stores it in ci, which is also equivalent to Qb. <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/342/6db/729/3426db7294084bde0b602e57ac0a9b71.png"></a> </div><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">2. Array of the playing field</font></i> <br><br>  This array corresponds to this field: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/70a/08f/84e/70a08f84e4494a9b822c72b3d33ebc2e.png"></div><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">3. Playing field</font></i> <br><br>  <b>xa (a)</b> also refers to the <b>sa (a)</b> function in fig.  4, which generates random coordinates each time a new person is created.  If you call a function more than once, you can create as many people as you like (Fig. 5). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/182/38f/358/18238f358816860cf2de195f0428b335.png"></div><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">4. Calling <b>sa (a)</b></font></i> <br><br>  Like here: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c8f/c01/d3b/c8fc01d3b7c183913a11a30183772a47.png"></div><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">5. The function call with the creation of any number of people on the map</font></i> <br><br>  Please note that even if you call <b>sa (a)</b> more than once and pick up a person, the bill does not change.  When selecting a passenger, the function <b>ka (a, b)</b> in fig.  6. Thus, it needs to be changed so that with each call it adds 10 points and updates the score on the screen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e96/091/159/e9609115944b21a2e324b99c46d9c094.png"></div><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">6. Updated feature</font></i> <br><br>  The coordinates of each part of the train are given in Qbob, where the first element is the first carriage on the train. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e6/d8e/0ea/4e6d8e0ea5fc7dc12186a5a27ee63f08.png"></div><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">7. Array of trailers</font></i> <br><br>  This is needed to create a simple AI.  Let's start with his logic: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d25/e30/214/d25e30214681ad9d0469982f9a596830.jpg"></div><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">8. Logic AI</font></i> <br><br>  Snake is a state machine (state machine): <br><br><ol><li>  On X = 19 go <b>down</b> until we get to Y = 19. </li><li>  On X = 19 and Y = 19, we go <b>left</b> to X = 0. </li><li>  Go to the state machine for zigzags: <br><ol><li>  <b>Up</b> one square and to the <b>right</b> to X = 18. </li><li>  <b>Up</b> one square and <b>left</b> to X = 0. </li><li>  Back to step A. </li></ol></li><li>  At Y = 0, go <b>right</b> to X = 19. </li><li>  Go back to step 1. </li></ol><br>  The full code is published <a href="https://github.com/romanzaikin/Google_Maps_Snake_Hack">on GitHub</a> . <br><br>  Video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/sRHW4ScWqoM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/446920/">https://habr.com/ru/post/446920/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446908/index.html">DLP and FSTEC recommendations on information security: intersecting parallels</a></li>
<li><a href="../446912/index.html">How much does web application security cost (for example Barracuda WAF-as-a-Service)</a></li>
<li><a href="../446914/index.html">Why do you need to learn Go</a></li>
<li><a href="../446916/index.html">Hierarchical address book release, updated Zimbra Docs and other new features in Zimbra 8.8.12</a></li>
<li><a href="../446918/index.html">These 6 lessons of working with cloudformation I learned for life</a></li>
<li><a href="../446922/index.html">Cat under the hood. Part 2</a></li>
<li><a href="../446924/index.html">Representation of arbitrary polynomials in the form of finite differences with an arbitrary step</a></li>
<li><a href="../446926/index.html">‚ÄúSo I realized that I am now a data engineer, and in a different way I can position myself on the market‚Äù</a></li>
<li><a href="../446932/index.html">TDMS Fairway and BIM</a></li>
<li><a href="../446938/index.html">Particle system in Core Animation. Christmas story</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>