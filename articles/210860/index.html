<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with a basket. ImageCMS Cart API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you follow the ‚Äúroadmap‚Äù of ImageCMS releases, then, most likely, you have already noticed that more and more of the functionality becomes independ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with a basket. ImageCMS Cart API</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/37b/c85/310/37bc853100f91d547f56c41128903c12.jpg"><br><br>  If you follow the ‚Äúroadmap‚Äù of ImageCMS releases, then, most likely, you have already noticed that more and more of the functionality becomes independent.  This vector has become even clearer with the release of ImageCMS 4.5.2 release.  Here was presented a new approach to the functionality of the basket module. <br><a name="habracut"></a><br><h4>  What was the work done for the basket functionality? </h4><br>  This module is one of the main in the store, so he paid special attention.  The idea of ‚Äã‚Äãdistributing system capabilities by dividing into functional modules allows you to create flexible solutions and provide more independent APIs. <br><br>  The latter should be especially interesting for integrators and developers on ImageCMS.  Since previously there was no clear understanding of the available methods for working with the basket, the solution of this issue became a priority task for us.  We encapsulated internal methods, and all important methods, on the contrary, left it on the surface.  Moreover, they were combined into an API.  All of them exchange information in JSON-format and are described in the documentation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the design stage, we are faced with the issue of backward compatibility.  Since the new approach had a completely new implementation, we had to make an explicit pointer to the methods used.  To use the old approach, insert in config.php the attribute <code>$config['use_deprecated_cart_methods'] = TRUE;</code>  for the new approach, the value is <code>FALSE</code> , or remove the directive from the file. <br><br><h4>  Where to see the API, as well as its documentation and implementation </h4><br>  All available methods for working with the basket are described in the specially created section of the documentation: <a href="http://docs.imagecms.net/api-docs">http://docs.imagecms.net/api-docs</a> <code>Classes Cart\Api</code> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/91b/249/54d/91b24954dac5963ce2175a6866cec3db.png"><br><br>  Here you can find a brief description of the method, as well as the necessary input data.  This is the first such kind of documentation in ImageCMS, so the plans are to add more description and continue the development of this section. <br><br><h4>  Example </h4><br><h5>  Add item to cart </h5><br>  The following example adds a product to the cart.  For this we use the <code>addProductByVariantId</code> method. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f7/722/022/8f7722022221432b9fd94936ac065451.png"><br><br>  It can also be used to add product to the cart.  The easiest way to do this is to use the AJAX request, but the variations can be different, for every taste. <br><br><pre> <code class="php hljs">&lt;a <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">=‚Äù</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">buy</span></span></span><span class="hljs-class">‚Äù </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">variantId</span></span></span><span class="hljs-class">=‚Äù198‚Äù </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">href</span></span></span><span class="hljs-class">=‚Äù#‚Äù&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">&gt; $('.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">buy</span></span></span><span class="hljs-class">').</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">on</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">click</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class">() </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> variantId = $(this).attr(<span class="hljs-string"><span class="hljs-string">'data-variantId'</span></span>); $.ajax({ url: <span class="hljs-string"><span class="hljs-string">'/shop/cart/api/addProductByVariantId/'</span></span>+ variantId, dataType: <span class="hljs-string"><span class="hljs-string">'json'</span></span>, success: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }); })</code> </pre><br>  This simple example demonstrates the uncomplicated ability to add a product to the cart.  Summing up this example, we add that it all came down to sending a request: <code>/shop/cart/api/addProductByVariantId/198</code> to the server.  After that, the product with <code>ID 19</code> 8, (or rather the product version) will be added to the cart for the current user. <br><br><h5>  Number of items in the cart </h5><br>  The space method is responsible for the number of products added by the user to the cart: <code>Cart/Api getTotalItemsCount</code> .  The request to the server is as follows: <code>/shop/cart/api/getTotalItemsCount</code> .  But, imagine that this information needs to be displayed in a template or for the purposes of your module. <br><br>  The method is accessed via the namespace path: <code>\Cart\Api</code> .  The first method in the ‚Äú <code>create()</code> ‚Äù chain which will prohibit the creation of several similar API instances is required. <br><br>  To business: <br><pre> <code class="php hljs">\Cart\Api::create()-&gt;getTotalItemsCount()</code> </pre><br>  We get: <code>{"success":true,"errors":false,"data":1}</code> <br><br>  Using the function for working with the JSON json_decode format, we can present the obtained data as an object: <br><br><pre> <code class="php hljs">$result = json_decode(\Cart\Api::create()-&gt;getTotalItemsCount()); $count = $result-&gt;data; <span class="hljs-comment"><span class="hljs-comment">//     </span></span></code> </pre><br><h4>  What do we plan next? </h4><br>  This approach has already proved itself to be a good one, and we do not plan to stop there.  Soon we are waiting for additions to the already published <code>Cart::API</code> , as well as an API for products, categories and discounts.  All developed solutions will be presented in the appropriate section of the documentation. <br><br>  In addition, you can save the local version of this documentation by downloading the developer version of <a href="http://www.imagecms.net/developers">http://www.imagecms.net/developers</a> .  Documentation will be available at <i>site_name.loc / docs</i> <br><br>  Follow our updates;  in case of questions - ask them in the comments. </div><p>Source: <a href="https://habr.com/ru/post/210860/">https://habr.com/ru/post/210860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210850/index.html">Benefits of Cloud Hosting - Infographics</a></li>
<li><a href="../210852/index.html">New Garmin: for dogs, thrill-seekers and motorists</a></li>
<li><a href="../210854/index.html">Google has provided a tool to transfer Chrome applications to Android</a></li>
<li><a href="../210856/index.html">About the performance of Thin Provision in LVM2</a></li>
<li><a href="../210858/index.html">Disabling ASLR when debugging third-party iOS apps</a></li>
<li><a href="../210862/index.html">Video recordings of the Happu New Front-End conference reports: On the frontend in a new way</a></li>
<li><a href="../210864/index.html">How to read a patent in one minute</a></li>
<li><a href="../210866/index.html">PHDays CTF Quals Summary</a></li>
<li><a href="../210868/index.html">MEGA released a client for Windows</a></li>
<li><a href="../210872/index.html">Google and Lenovo deal strengthens Android ecosystem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>