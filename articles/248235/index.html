<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>I offer a custom .Net questionnaire</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I offer not quite a standard survey on the .Net platform. Spoilers reveal the answers to the questions, but still I ask you first to answer the questi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>I offer a custom .Net questionnaire</h1><div class="post__text post__text-html js-mediator-article">  I offer not quite a standard survey on the .Net platform.  Spoilers reveal the answers to the questions, but still I ask you first to answer the questionnaire yourself, then go and see the answers :) <br><br><div class="spoiler">  <b class="spoiler_title">When the static method is called, the JIT ...</b> <div class="spoiler_text">  <i>JIT compiles a call to a proxy method that makes an unconditional transition to the compiler necessary and replaces the address of the transition to the proxy with a new method body.</i>  <i>This is done for several reasons.</i> <br><br>  Initially, when methods are compiled, all the call points of other methods indicate not a compiled body, but a piece of assembler code of fixed length and containing the same instructions for any method.  As a matter of fact, only the address where jmp occurs changes.  Before the method is compiled, the address points to the compiler of this method (therefore, the first call involves compilation).  Further, when the compilation is complete, the argument of the jmp command changes from the address of the compiler to the address of the target, already compiled method.  The advantages are obvious:  proxy - contains the same instructions, the group of methods can be viewed as a table with two fields: Code and Address of the Transition on the one hand and not to change the addresses of the method call instruction - on the other. <br></div></div><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">What happens when casting to class</b> <div class="spoiler_text">  <i>Type casting to base - nothing happens, casting to inherited - to start, the possibility of casting is checked and work with the object will follow the same virtual method table as before</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Type coercion is the syntactic sugar of a language that has almost nothing in common at the level of the structure of an object in memory.  Since an object consists of the fields + SyncBlockIndex + MethodsTablePtr, where MethodsTablePtr is responsible for pointing the object type description, nothing happens when the pointer is placed in an object of another type (the object type does not change).  Called additional check when casting up, because  at the compilation stage it is not known in advance what is up, what types.  Need to check.  The check is performed by going to the table of methods and passing through the ParentClassMethodsTable pointer chain until either Object is encountered (then casting is not possible) or until a pointer is found that is equal to the one we are looking for.  How the virtual method is called is well described here: <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B0%25D0%25B1%25D0%25BB%25D0%25B8%25D1%2586%25D0%25B0_%25D0%25B2%25D0%25B8%25D1%2580%25D1%2582%25D1%2583%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D1%258B%25D1%2585_%25D0%25BC%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4%25D0%25BE%25D0%25B2">Wiki</a> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">What happens when casting to an interface?</b> <div class="spoiler_text">  <i>In the type table, there is a link to the dictionary of interfaces and to check the possibility of casting it is necessary to bypass it all.</i>  <i>According to the basic types do not go, because</i>  <i>all of them are also present in the dictionary.</i>  <i>If a match is found, the address of the table of virtual methods of the interface will be loaded into the register, and not the type of the object.</i> <br><br>  Since interfaces can appear in a type right in the middle of inheritance, both in one type and in another, for them a common scheme with virtual method tables will not work.  Instead, in the virtual method table there is a link to the second table - the dictionary of interfaces.  In essence, this is a list of references to the virtual method tables of each of them.  When casting a type, the required table is searched for using the binary search method, since the search is performed according to the equality of the pointer to the required one (among the list we look for the presence of the pointer we need to the virtual methods table).  If it is found, a pointer to this table is loaded into the register and then the method call goes through it (the table contains the addresses of the methods in the class. Therefore, for each interface implementation, the list of methods is present in the tables of all the classes that implement the interface, as well as all the descendants of the classes and interfaces) <br></div></div><br><div class="spoiler">  <b class="spoiler_title">What is the difference between Implicit and Explicit interfaces?</b> <div class="spoiler_text">  <i>Both are highlighted in the interface dictionary, but the Explicit methods are not in the class's virtual methods table, only in the interface dictionary.</i> <br><br>  Indeed, since the methods of implicit interfaces are part of the class inheritance hierarchy and can be called separately from the interface type, they must be present in the class's virtual methods table.  However, there are also Explicit implementations when methods are separated from the class.  Such methods are not present in the class's virtual methods table.  However, for both cases we have the right to cast to the interface and work through it.  This means that they will be present in the map of interfaces of both types, and with all the basic types - interfaces. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Streams in .Net</b> <div class="spoiler_text">  <i>are MS Windows platform threads, because the price of switching between threads is equal to the total price for Windows</i> <br><br>  Here, in general, without comment.  GC cannot interfere with the overall process of servicing a multi-threaded code.  .Net applications work like regular Windows applications. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Generic types</b> <div class="spoiler_text">  <i>JIT creates unrelated classes for each type parameter.</i> <br><br>  Since the JIT cannot know anything about the application logic, it cannot build the argument that <pre><code class="cs hljs">IEnumerable&lt;<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt; a = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;()</code> </pre>  should somehow work.  because implementation for each specific set of generic arguments is compiled into a separate code. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">How instance methods are called - this</b> <div class="spoiler_text">  <i>this is the first parameter of the method that is not shown for the purposes of syntactic sugar.</i> <br><br>  If you imagine a method call, then at the processor level it will occur by fastcall notation: the first two parameters of the method go to registers, and the rest to the stack.  if we don‚Äôt pass on anything in addition, we‚Äôll get that inside the method we will not have a clue what object we were called for.  To correct the situation, we always pass this as the first parameter, and in the programming language (for example, C #) we simply do not show it by entering the local variable this, which is always present, regardless of the programmer‚Äôs wishes.  This is actually the first parameter of the method. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Value and Reference types.</b>  <b class="spoiler_title">What is the difference?</b> <div class="spoiler_text">  <i>Value types are on the stack and on the heap, and Reference are only on the heap.</i>  <i>They differ in that value is passed by value, and Reference by reference.</i> <br><br>  A huge percentage of developers at the interviews say the first answer.  And in fact, it does not suit them, because if the Value type is a class field, its value cannot be in the working stack, because when exiting the method that created the frame, it containing it would cease to be valid with the correct data.  The class field (even if it is the Value type) is always on the heap.  The difference between Value and Ref types is that when copying from Ref types, the reference is copied, and in Value, the entire structure is copied.  The second difference: the non-Value Value types lack the MethodsTable field and SyncBlockIndex. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Where are the static variables?</b> <div class="spoiler_text">  <i>They lie in the internal arrays and the reference goes to the link to the array + index</i> <br><br>  This is simply sacred knowledge.  Just done and all. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">How are virtual methods called?</b> <div class="spoiler_text">  <i>JIT creates a virtual method table for a type, through which the call goes with a pre-calculated index</i> <br>  In the case of inheritance and the presence of virtual methods, it turns out that: from class to class, they can only be added in stock, without going anywhere.  and in each subsequent class all methods of all basic will be guaranteed to be present.  With one difference - at inheritance the method can be redefined.  Therefore, when constructing a table of methods for a class, the methods of the base class must be located at the same indices as in the table of the base class.  If the method is not overridden, then the address of the method body in the table will coincide with the address of this method in the table of the base class.  If the method is overridden, the value will be different.  After all the methods of the base classes will be the methods of the current class.  And the call itself will occur like this: <br><ul><li>  Load the address of the table of virt methods. </li><li>  Move to the beginning of the list of methods </li><li>  take the address of the method by index (for example) 1 </li><li>  Call it. </li></ul><br>  Moreover, since the inheritance at this place will always contain the ToString () method, then even by overriding it in the heirs, the ToString () method will be called, but not of the base class, but of the heir. <br></div></div><br> <a href="http://clrium.ru/%3Futm_source%3Dhistory%26utm_medium%3Ddirect%26utm_campaign%3Dhabr"><img src="https://habrastorage.org/getpro/habr/post_images/243/44e/207/24344e20757143d25661a8fbeaa706a3.png"></a> <br><habracut text=" -  "></habracut></div><p>Source: <a href="https://habr.com/ru/post/248235/">https://habr.com/ru/post/248235/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248219/index.html">Home automation with openHAB: lighting and remote control of heaters. Part 1</a></li>
<li><a href="../248225/index.html">Yandex investigation: full disclosure about the virus on Facebook</a></li>
<li><a href="../248227/index.html">Pivotal stops developing Groovy & Grails from March 31</a></li>
<li><a href="../248229/index.html">Binary operations on unordered sets</a></li>
<li><a href="../248231/index.html">The main functions of ETL-systems</a></li>
<li><a href="../248239/index.html">Project Migration from StarTeam to SVN</a></li>
<li><a href="../248241/index.html">Books by Yii2</a></li>
<li><a href="../248243/index.html">Full customization of select without using JS</a></li>
<li><a href="../248249/index.html">Ubuntu Make - a developer to help</a></li>
<li><a href="../248251/index.html">15 most popular IoT gadgets in 2014</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>