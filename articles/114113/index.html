<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We are looking fast, even faster</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I came across an interesting question in the QA section. The answer to it forced me to write this article as a more complete answer to the question ‚Äúh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We are looking fast, even faster</h1><div class="post__text post__text-html js-mediator-article">  I came across an interesting question in the QA section.  The answer to it forced me to write this article as a more complete answer to the question ‚Äúhow to organize a search using a variety of parameters, like in a Yandex market, for example.‚Äù <br><br>  I know that on Habr√©, and indeed there are many supporters of noSQL solutions (he himself is not without sin), but still I‚Äôm a supporter of first thinking, and only then choosing a solution. <br><br>  So, what we have in "DANO" <br><ul><li>  We have 120 checkboxes - option 1/0 </li><li>  We have 30 "radio" with the choice of "yes / no / no matter" </li><li>  We have 2-3 sliders to indicate the price / size range of which the thread </li><li>  We have the most important thing: 12 million records in the database. </li><li>  We have Select * From tovar Where (wifi = true) and (led = false) and (type = 3) and ... the rest of the parameters ...;  with a runtime close to the hysteria of the client. </li></ul><br><a name="habracut"></a><br>  The hysterics came from the understanding that it was necessary to process more than 100 requests per second, and for this you have to sell a ‚Äúthree rubles‚Äù with a view of the Kremlin and buy more iron. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, we start to think about how to save a lot of money and put a part in your pocket in the form of a bonus. <br>  I want to note right away that we are not aiming to get a list of the necessary lines from the database.  We need to do prefiltration to speed up the search and filtering process. <br><br><h5>  Checkboxes </h5><br><br>  To begin with, all our checkboxes, which have only 2 variants of meaning, we will convert into bits and group them into one ‚Äúnumber‚Äù.  In our case, this number will be 120 bit (128 bit for even counting).  This will be our first "index".  According to it, we can always filter out those products that meet our conditions.  In practice, on average, such goods are not more than 10 thousand for the entire base.  The remaining parameters can already be viewed only in these 10 thousand products, and not to ‚Äúshovel‚Äù the entire base. <br><br><h5>  Ranges </h5><br><br>  Any range (height, weight, waist, bust volume) can be divided into intervals and numbered.  Divide into 256 parts.  The figure is taken "from the ceiling."  In any case, for the range of $ 100 - $ 1200, we get 2 numbers.  If we take $ 1 - $ 100 with a maximum of $ 25,500, then we can write our range as 2 | 12 - in fact, this is a 16-bit number.  We will have such numbers according to the number of possible ranges.  If there are less than a few, then we‚Äôll stop at this, if there are 100-10000, then everything is more complicated.  We can not adequately quickly search for 200-20000 bit key.  And we will not, we just calculate it md5, and to speed up the process we will also convert everything into a 128-bit number (some miserable 16 bytes).  Combined with a lot of checkboxes, we get an even more accurate sample. <br><br><h5>  Yes / No / Not Important </h5><br><br>  Algorithm for finding data values ‚Äã‚Äãwith add.  the ‚Äúnot important‚Äù parameter is almost similar to the option with checkboxes, except that we write only yes / no in the 1 index (and 0, when choosing ‚Äúnot important‚Äù).  In the second index, we will put 0 for the ‚Äúnot important‚Äù variant and 1 for any other. <br><br>  <b>Total we get 2 indexes:</b> <br>  1 index: 01010000001010101010001 <br>  2 index: 01111101110111101110111 <br><br>  <i>Homework will be build through Xor | And | Or request in which we reset all insignificant bits on index 2 and compare with index 1.</i> <br><br>  So, we from 12 million records found 0-100-500 suitable under conditions.  These records are already worth checking in their entirety (120 bit checkbox field, range and ‚ÄúYes / no / no matter‚Äù).  Agree that a complete check among a couple of hundred lines is much faster than a full search. <br><br><h5>  ... </h5><br><h5>  Profit !!! </h5><br><br>  The variant with the conversion of a long key into a short one, by, say, encryption, is sufficiently convenient for carrying out data prefiltration.  At the same time, if we work with SQL, then the prefilter sample can be stored in MemTable for acceleration and full filtering can be carried out with this data. <br><br>  A similar algorithm is used by us and in the filter of texts by shingles, when from the checksum we get a 32-bit number, which is faster to compare than 128-bit ones. <br>  A similar technique works in one specialized document storage system, which allows, in microseconds, to find in 2.2Gb text databases links to documents where the search word or phrase is located.  But, about this in a little more detail in another article. </div><p>Source: <a href="https://habr.com/ru/post/114113/">https://habr.com/ru/post/114113/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../114104/index.html">The expediency of fast internet at home</a></li>
<li><a href="../114105/index.html">How to edit OpenStreetMap (video example)</a></li>
<li><a href="../114107/index.html">Automate logging of inputs in functions</a></li>
<li><a href="../114108/index.html">Synchronization of tasks and calendar with MS Outlook</a></li>
<li><a href="../114111/index.html">Wopad WR701 - 7-inch tablet with a capacitive screen from China (part 2)</a></li>
<li><a href="../114114/index.html">Native Client: Ready for takeoff!</a></li>
<li><a href="../114117/index.html">About C ++ aliasing, deft optimizations and vile bugs</a></li>
<li><a href="../114118/index.html">Fun ImageMagick features to help web designer</a></li>
<li><a href="../114119/index.html">Layout mailing: view from the inside</a></li>
<li><a href="../114120/index.html">Collaboration approach to machine creativity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>