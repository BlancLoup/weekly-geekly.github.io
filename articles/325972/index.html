<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 14: Hacking a bank with a Brazilian scale, ATMs throw money in bitch, 54 hours Mirai</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Do you know, friends, that antivirus analysts love more than anything else? Tell each other scary stories. So, for our annual analyst congress, Fabio ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 14: Hacking a bank with a Brazilian scale, ATMs throw money in bitch, 54 hours Mirai</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/527/8e0/f9c/5278e0f9c38643508ac79d8579453c4f.jpg" width="300" align="right">  Do you know, friends, that antivirus analysts love more than anything else?  Tell each other scary stories.  So, for our annual <a href="https://sas.kaspersky.com/">analyst congress,</a> Fabio Assolini and Dmitry Bestuzhev prepared a real crypot.  Can you imagine an old respected bank with a capitalization of 25 yards of non-rubles and 500 branches, <a href="https://threatpost.com/lessons-from-top-to-bottom-compromise-of-brazilian-bank/124770/">compromised</a> from top to bottom?  All of its 36 domains and the mail server were also infected, and they poured malware on all users. <br><a name="habracut"></a><br>  At first it looked like an ordinary hacking site.  You come in to see, say, the rates on deposits, and along the way you open the frame leading to the host with the malware.  But when analysts began to dig, it turned out that the bank had such surprises everywhere, literally on all resources: on the Internet bank, on the investment portal, on the mobile website, and so on.  And it was not just an infection, but an interactive attack - having understood that their activity was detected, the hackers cut down the bank‚Äôs mail server.  Apparently, in order to make it more difficult for clients of the bank, its domain registrar and DNS provider to notify. <br><br>  The captured malware contained eight modules, including an update module, a tool for stealing Exchange credentials and an address book, as well as a module for managing an Internet bank.  All components are knocked on a command server located in Canada.  By the way, one of the modules was initially a legitimate utility for removing rootkits from the system - hackers used it to demolish antivirus programs from compromised machines. <br><br>  There was a double profit at the exit: not only did the guys could interfere in the operations of the clients of the hacked bank, they also infected the clients' machines, gaining access to their accounts in other banks.  They also stole card billing data - for example, some bank sites were replaced with phishing pages with forms for entering card numbers and other payment information.  An SSL certificate for phishing pages was issued to Let's Encrypt.  Everything is as it should be: fast, free, automatically.  And the fact that the certificate is missing information about the organization, the owner - well, who in Brazil care about such details? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Finally, the villains managed to take control of the DNS used by the bank, for which several phishing emails were enough.  The diagnosis is obvious: due to the lack of a modern multi-level information security system, the bank and its customers have completed in full. <br><br>  <b>Fileless file gutted ATMs and disappears</b> <br>  <a href="https://threatpost.com/fileless-banking-malware-attackers-break-in-cash-out-disappear/124711/">News</a>  <a href="https://securelist.com/blog/sas/77918/atmitch-remote-administration-of-atms/">Research</a>  The title is not quite accurate - the ATMs in this story were gutted more or less traditional Trojans, but their infection was carried out with the help of a fileless file entrenched in the bank‚Äôs network.  Fileless attack is difficult to detect and investigate.  However, the experts still managed to find something. <br><br>  In the memory of one of the AD-controllers found Meterpeter, a module for Metasploit.  Presumably, cybercriminals used PowerShell scripts, NETSH and Mimikatz, which are not stored in files on infected machines, and the hackers cleaned up other traces. <br><br>  Having detected and infected the necessary computer in the bank, the attackers opened a RDP connection to the ATM and introduced the ATMitch Trojan through it.  After starting at ATM, ATMitch read its command.txt command file containing a single character and executed the corresponding command: <br><br>  'O' - open dispenser (money dispenser) <br>  'D' - give money <br>  'I' - Initialize the XFS library <br>  'U' - Unlock XFS <br>  'S' - Installation <br>  'E' - Logout <br>  'G' - Get dispenser identifier <br>  'L' - Set dispenser identifier <br>  'C' - Cancel <img src="https://habrastorage.org/files/89b/cab/b56/89bcabb56d3a4a2c9a6dc241166ab318.gif" width="300" align="right"><br><br>  Having executed the command, the Trojan recorded the result in the log and deleted command.txt. <br><br>  It must be said that such a hardware does nothing at all with ATM money, because its computer interacts with the periphery through the standard XFS software interface, which has been well studied by black hats.  In this case, the Trojan gave all the money from the tapes and removed itself from the device.  The one who was at this moment near the ATM was very lucky.  Although, of course, it was not a casual passer-by, but a bitch to which, according to the log, the malvar addressed. <br><br><pre><code class="hljs perl">[Date ‚Äî Time] [%d %m %Y ‚Äî %H : %M : %S] &gt; Entering process dispense. [%d %m %Y ‚Äî %H : %M : %S] &gt; Items from parameters converted successfully. <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">40</span></span> [%d %m %Y ‚Äî %H : %M : %S] &gt; Unlocking dispenser, result is <span class="hljs-number"><span class="hljs-number">0</span></span> [%d %m %Y ‚Äî %H : %M : %S] &gt; Catch some money, bitch! <span class="hljs-number"><span class="hljs-number">4000000</span></span> [%d %m %Y ‚Äî %H : %M : %S] &gt; Dispense success, code is <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  Due to a strange mistake, ATMitch did not manage to delete his log, and this gave the researchers a clue.  Based on the analysis of the log data, it was possible to create rules for Yara, with which they found a sample. <br><br><img src="https://habrastorage.org/files/d12/756/60e/d1275660e03b439cb4063c4d5baa3641.png"><br><br>  It‚Äôs not at all news that ATMs still work for the most part under outdated Windows XP, the holes of which can be compared to the tunnel under the English Channel in size and frequency of their use.  And yet the use of at least the same waisting would not allow Malvari to start. <br><br>  <b>Mirai-botnet conducted a 54-hour DDoS attack</b> <br>  <a href="https://threatpost.com/new-mirai-variant-carries-out-54-hour-ddos-attacks/124660/">News</a>  <a href="https://www.incapsula.com/blog/new-mirai-variant-ddos-us-college.html">Research</a>  The sect of witnesses Mirai continues to grow by leaps and bounds.  This time, some fans of the Internet of things have collected a botnet from 9793 IP cameras, routers and video recorders of surveillance systems.  Apparently, these were bored students who did not find a better use for their botnet than to check the website of an American college for 54 hours in a row.  Wow, someone's parents found out about the deduction of the kiddie three days later! <br><img src="https://habrastorage.org/files/2bd/c1a/0a7/2bdc1a0a771747058c78de96ee528241.gif" width="400" align="right"><br>  The organizers did not split hairs, and chose an HTTP attack ‚Äî the bots contacted the web server 30,000 times a second, which, of course, could not withstand any college.  The young talents had the skills to remake in their version the hard-coded user agent.  However, by all indications, it was the same good old Mirai. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right"><h3>  Antiquities </h3><br>  "RedX-796" <br><br>  Non-resident non-dangerous virus.  Typically infects .COM files in the current directory and in directories marked in the PATH.  Depending on the number of affected files, it is shown by a rather funny video effect - the picture passes through the screen to the sound of a siren from left to right: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2fc/d85/3c7/2fcd853c726344f5a8179c5d8e1c923a.png"></div><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 81.</i> <br><br>  <i><strong>Disclaimer:</strong> This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/325972/">https://habr.com/ru/post/325972/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325956/index.html">From Root CA to User Authorization in nginx + apache. Part 1. Create a Root & Intermediate Certificate Authority</a></li>
<li><a href="../325958/index.html">It is no exaggeration to say that this is a hyperbole</a></li>
<li><a href="../325960/index.html">Free plugins, tools and services for the development of a game on a unit</a></li>
<li><a href="../325966/index.html">Kotlin for Android: simplify working with weak links in asynchronous calls</a></li>
<li><a href="../325968/index.html">Archaic video compression algorithms of the era of FMV games</a></li>
<li><a href="../325976/index.html">How an IaaS provider can make payment for services more convenient: 2 simple rules</a></li>
<li><a href="../325978/index.html">WebRTC, Safari</a></li>
<li><a href="../325980/index.html">Using IMS QTI in ePUB e-learning courses</a></li>
<li><a href="../325982/index.html">Photo-realistic graphics in a mobile game or the world's first "video" game (mobile)</a></li>
<li><a href="../325986/index.html">EGaaS Digital Ecosystem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>