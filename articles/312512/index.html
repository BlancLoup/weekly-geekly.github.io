<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>BizTalk Server Support: helpful tips. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue the series of articles in which we share with you our experience in supporting MS BizTalk Server 2010. In this article we will talk about ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>BizTalk Server Support: helpful tips. Part 2</h1><div class="post__text post__text-html js-mediator-article">  We continue the series of articles in which we share with you our experience in supporting MS BizTalk Server 2010. In this article we will talk about a tool that will save you a lot of time!  It will be about Pipelines, and more specifically, Pipeline components.  Link to the first article <a href="https://habrahabr.ru/company/icl_services/blog/303646/">is here</a> .  In it you will find some general information about what MS BizTalk Server is and why you may need it. <br><br><img src="https://habrastorage.org/files/cf6/c9c/8c9/cf6c9c8c99a44678b1d487fb3d01f4ec.jpg" alt="image"><a name="habracut"></a><br><br>  A pipeline is an element (more often referred to as an artifact) of the infrastructure of the BizTalk Server application, which contains .Net or COM components for processing an incoming message in a certain sequence. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/604/9b7/639/6049b763901f4c0e927ff233a356ccff.gif" alt="image" align="left">  BizTalk Server provides a large set of components for the pipelines, so to speak out of the box.  For small applications it is quite enough.  But when it comes to large corporate solutions without components of its own design can not do. <br><br>  For those who are familiar with this topic, I am sure it will not be news that msdn has articles on the topic <a href="https://blogs.msdn.microsoft.com/brajens/2006/11/25/how-to-develop-biztalk-custom-pipeline-components-part1/">"How to develop your own pipeline components</a> . <a href="https://blogs.msdn.microsoft.com/brajens/2006/11/25/how-to-develop-biztalk-custom-pipeline-components-part1/">"</a>  It describes in detail the types of components, the process of creating a project in Visual Studio, the namespace to be connected, which interfaces to implement, etc.  Here it is important to understand that having made one component, you will develop another one in the same way each time.  Knowing this is important, but there is an option that will allow you to save time on preparing a project and focus your attention on writing code.  And this is the <i>BizTalk Server Pipeline Component Wizard</i> ( <i><a href="https://btsplcw.codeplex.com/">project page on codeplex</a></i> ).  Add-on for VS 2010 (available for more recent versions), which in a few simple steps allows you to create a pipeline component project, ready to execute your code, you just have to add it there. <br><br>  And so there is a task: <br><br>  <i>Our company receives orders from clients in the form of files of different formats.</i>  <i>BizTalk Server has a standard set of components for working with files in XML and text files, but for files of other formats you will have to develop a pipeline component that will convert it to XML.</i> <br><br>  <i>But more to the point:</i> <br><br>  <strong>1.</strong> <i><a href="https://btsplcw.codeplex.com/releases/view/46419">From the project page on the codeplex,</a> download the plcwsrc2.20 archive.</i> <br><br>  <strong>2.</strong> To install, unzip <i>plcwsrc2.20</i> and you will receive a project for Visual Studio.  Open and build the project and from the PipelineComponentWizard Setup project folder, run setup.exe. <br><br>  <strong>3.</strong> Start Visual Studio 2010 and create a new BizTalk Server Pipeline Component Project. <br><br><img src="https://habrastorage.org/files/c3d/96d/f85/c3d96df8567943d98dc9ad76503882ac.png" alt="image"><br><br>  <strong>4.</strong> Next, the Wizard will open, which will prompt us to fill in some fields. <br><br><img src="https://habrastorage.org/files/f24/af3/9e1/f24af39e12f1473aa2bfb1061bee8057.png" alt="image"><br><br>  <strong>5.</strong> In the next window, we are asked to enter the component name, version, and description. <br><br><img src="https://habrastorage.org/files/a4d/a6b/c13/a4da6bc13f694a48b665b8ed845f8f53.png" alt="image"><br><br>  Also double click on <img src="https://habrastorage.org/files/c9f/4cb/051/c9f4cb05120c44e69b3724f8532b4462.png" alt="image">  You can change the icon of the components (size 16x16).  The component's own icon will make it easier to search in the list of components.  Choose one of the standard BizTalk icons <br><br><img src="https://habrastorage.org/files/c87/5d6/4d9/c875d64d90e5485c8312f9102ca2c334.png" alt="image"><br><br>  <strong>6.</strong> Further proposed to add the parameters of the components.  Parameters are optional, but for the example, add one.  Parameters are also available from Visual Studio to set default values. <br><br><img src="https://habrastorage.org/files/d78/d12/725/d78d12725bbd4bd09a947c45be244e26.png" alt="image"><br><br>  <strong>7.</strong> Next, click Next, then Finish.  The wizard will create a pipeline component project.  There will be two files in the project: cs is the skeleton of our component and .resx contains properties with the name, description and version.  In the generated class you will have several sections: <br><br>  ‚Ä¢ public variables - component parameters; <br>  ‚Ä¢ IBaseComponent members - defines the properties that provide information about the component; <br>  ‚Ä¢ IPersistPropertyBag members - defines methods for preparing, loading and saving component properties; <br>  ‚Ä¢ IConponentUI - defines the components icon and the method that verifies that all properties are set correctly; <br>  ‚Ä¢ IComponent - defines the method that starts the component to process the incoming message. <br><br>  An example of code that will be executed in the Execute () method of this component: <br><br><img src="https://habrastorage.org/files/00a/80c/91e/00a80c91ed394291b5f7576d10366316.jpg" alt="image"><br><br>  <i>In our case, this is the main and only method in which the incoming message is processed.</i>  <i>It is also important that the output you write to pInMsg.BodyPart.Data is a stream that is XML.</i>  <i>To do this, you can use a regular XmlWriter.</i>  <i>Moreover, there should also be a .xsd message scheme that exits the component.</i> <i><br></i> <br><img src="https://habrastorage.org/files/a7a/107/f19/a7a107f1930f4d2c81a3b9440a482a45.png" alt="image"><br><br>  <strong>8.</strong> Build the project and copy the resulting DLL to <i>C: \ Program Files (x86) \ Microsoft BizTalk Server 2010 \ Pipeline Components</i> , but this is an optional condition, you can select any other folder and close the project. <br><br>  <strong>9.</strong> In Visual Studio, open the project with the pipeline to which you want to place your component, then in the context menu of Toolbox -&gt; Choose items-&gt; BizTalk Pipeline Components, select your component from the list and transfer it to the pipeline. <br><br>  Also, we only have access to the created property.  We can set its default value before deploying the assembly to BizTalk Server. <br><br><img src="https://habrastorage.org/files/90a/6a9/f03/90a6a9f030904256af7d09f05b5d0d57.png" alt="image"><br><br>  <strong>10.</strong> Assemble and back up the assembly with the pipeline on BizTalk Server. <br><br>  Done!  So, in a few simple steps in your application, you can use a pipeplan with a component of its own design. </div><p>Source: <a href="https://habr.com/ru/post/312512/">https://habr.com/ru/post/312512/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312500/index.html">Do not step on our rake with TK: an epic contest experience and a couple of tales</a></li>
<li><a href="../312504/index.html">Web Alerts in Loaded Projects</a></li>
<li><a href="../312506/index.html">.NET Portability Analyzer</a></li>
<li><a href="../312508/index.html">Toolkit for front-end development for Linux</a></li>
<li><a href="../312510/index.html">‚ÄúThe world is a collection of facts, not things‚Äù: Wittgenstein and operation-oriented programming</a></li>
<li><a href="../312514/index.html">Do not postpone to the mailbox: 2GIS b2c-messenger</a></li>
<li><a href="../312516/index.html">Making the Android app loading screen right</a></li>
<li><a href="../312518/index.html">BCP and DRP. The difference is sometimes not obvious.</a></li>
<li><a href="../312520/index.html">Automatic test generation: Excel, XML, XSLT, hereinafter - everywhere</a></li>
<li><a href="../312522/index.html">GLPI in a small organization, part 1. Typical deployment and pitfalls</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>