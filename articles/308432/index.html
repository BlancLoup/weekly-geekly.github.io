<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Everything is under control: we protect corporate conversations. Part 3: Secure SIM Card</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During the discussion of the previous two parts of the Tottoli GSM project description ‚ÄúEverything under control: protecting corporate conversations‚Äù ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Everything is under control: we protect corporate conversations. Part 3: Secure SIM Card</h1><div class="post__text post__text-html js-mediator-article"><p>  During the discussion of the previous two parts of the <a href="http://tottoli-gsm.com/ru/">Tottoli GSM</a> project description ‚ÄúEverything under control: protecting corporate conversations‚Äù ( <a href="https://habrahabr.ru/company/tottoli_gsm/blog/305586/">Part 1</a> , <a href="https://habrahabr.ru/company/tottoli_gsm/blog/306370/">Part 2</a> ), it became clear that the technology of using and implementing MULTI SIM requires a separate description.  In this article we will describe in detail exactly the technology MULTI SIM. </p><br><img src="https://habrastorage.org/files/90d/ce0/848/90dce08482724cedb9b3d0d41b17738a.jpg"><br><br><p>  Everyone is accustomed to perceive the SIM card as a certain unconditional element of subscriber authentication in the network.  As part of the Tottoli GSM platform, the MULTI SIM module is an integral part of the system and performs the necessary functions shown by the project.  Since the SIM card is a network element, it is impossible to consider its functionality outside the system.  A more illustrative will be the consideration of the module functionality with respect to specific scenarios. </p><br><h1>  First, about MULTI SIM itself: </h1><br><p>  ‚Ä¢ Memory size: 256 KB <br>  ‚Ä¢ Hardware support for the MILENAGE algorithm card and below COMP128v1-v3. <br>  ‚Ä¢ Support javacard 2.2 <br>  ‚Ä¢ Download applets using APDU, and with support for GSM 03.48 downloads </p><br><p>  Support of functions for the purpose of implementing MULTI SIM functionality: changing "files" (EF GSM 11.11) in (u) SIM card in order to change the profiles of the mobile operator: IMSI, KI, HPLMN, PLMN, FPLMN. <br>  Also, on the SIM-cards, the applets developed by us and the basic profile (IMSI / KI and other parameters necessary for registering on the network) of one of the operators available to us are pre-installed.  By ‚Äúoperator availability‚Äù in this context is meant the support contract with this operator and the implementation of the profile pool in our HLR. </p><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c33/51d/a3b/c3351da3bb85471cba2cd9b364d5e38a.jpg"></div><br><br><p>  In the described scenarios, we intentionally omitted the standard procedures of interaction with the network and focused on the main points. </p><br><h1>  Scenario 1: </h1><br><p>  An employee receives a telephone set (TA) with MULTI SIM installed.  When you turn on the phone, MULTI-SIM is automatically registered in the local network due to the pre-defined network settings in the SIM card.  The local network, in turn, allows this SIM card to register based on the prescribed SIM parameters in the HLR of its network. </p><br><img src="https://habrastorage.org/files/82a/dd9/015/82add90159d34bc38df1adfeee504da8.jpg"><br><h1>  Scenario 2: </h1><br><p>  Outgoing calls within the local network are made in the standard way.  FMC short numbers are used for calls between employees.  FMC numbers and routing rules for them are configured in the company's billing.  Employees can use FMC numbers both inside and outside the local network. </p><br><img src="https://habrastorage.org/files/668/792/ff9/668792ff91314e5ba107b54973421f01.jpg"><br><h1>  Scenario 3: </h1><br><p>  The employee leaves the local network coverage area, the telephone apparatus performs the Location Update (LU) procedure from the networks currently available.  All network parameters when LU automatically get into the billing company for further analysis and management.  If necessary, the server makes a decision about changing the current profile and / or changing the operator.  For this, the OTA team is formed with the parameters of the profile and the priority network.  This command is sent to the subscriber device and the profile is changed and the network is re-elected.  When an employee is in public networks, all his communications also pass through the company's resources and are subject to internal rules.  This makes it possible to allow or prohibit the use of specific networks or make them a priority.  A special applet continuously transmits network parameters to the company's server.  Thus, depending on the location of the employee, the parameters of the trust network come to the SIM card. </p><br><img src="https://habrastorage.org/files/c04/4ba/2f7/c044ba2f7a9746809a00f3af0c0acc48.jpg"><br><h1>  Scenario 4: </h1><br><p>  If the outgoing call goes to the external PLMN network, it also passes through the company's PBX.  This is achieved by using a special applet on the SIM card.  After dialing the number and pressing the call button, the applet intercepts the call and routes it to the service number, which is allocated to the company's billing for each call.  Thus, a company PBX is always located between subscriber A and subscriber B, which does not allow detecting direct communication between subscribers. </p><br><img src="https://habrastorage.org/files/f64/e54/e21/f64e54e217d74e838256bff00c7ccf7f.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Scenario 5: </h1><br><p>  The organization of the incoming call is made using a virtual number (DID). <br>  Each employee has a virtual number in the format ABC / DEF.  Rules for routing calls to these numbers are also registered in the company's billing.  Thus, a call from an external PLMN network to a virtual number (DID) also passes through the company's PBX. </p><br><img src="https://habrastorage.org/files/08e/734/3ea/08e7343ea1d24b1b905111f851fbe9af.jpg"><br><h1>  Scenario 6: </h1><br><p>  The use of the Internet (DATA) in the external network occurs according to the rules prescribed in the company's billing.  Access point settings are registered on the SIM-card.  The APN is provided by the company and thus all DATA traffic is routed to the company's equipment (GGSN).  On the side of the company, the Policy Controller (DPI) is also deployed to analyze the DATA traffic of employees.  This ensures security at the Internet level, regardless of which operator‚Äôs network is on the network. </p><br><img src="https://habrastorage.org/files/a33/69f/e5d/a3369fe5d0654bf9be8a6d32710fadc3.jpg"><br><h1>  Scenario 7: </h1><br><p>  SMS service is also on the side of the company.  Thus, the company has all the SMSC management tools: enable / disable sending / receiving SMS, routing control and logic.  All this is done at the network level.  Thus, if the billing company has a flag to ban incoming SMS, such an attempt will be stopped at the level of the initiator operator.  This mechanism does not allow attacks using SMS of any class, including the so-called silent SMS. </p><br><h1>  Scenario 8: </h1><br><p>  USSD service is available to all employees.  Through the SIM MENU of the SIM card, an employee can use the services of this service.  All logic is deployed on the company's service.  Thus, an employee receives all relevant information and manages available services and services that are authorized for a specific employee or group of employees. </p><br><h1>  Scenario 9: </h1><br><p>  A profile change (IMSI / KI) on a SIM card may occur due to different events: during the LU procedure, an employee himself initiates a profile change via the SIM MENU, a profile change is initiated from the server without an employee, the profile is changed according to a specified timing.  The profile change is provided by a pre-applet on the SIM-card.  Profile loading is performed using OTA from the company's server side.  The profile change procedure is synchronized with the TA function and the IMEI change.  Thus, there is a change of all identifiers in the network. </p><br><p>  Also on the data MULTI-SIM cards are available applets with features: </p><br><ol><li>  Track IMEI </li><li>  Remote control </li><li>  Dynamic SIM menu </li><li>  History Location </li><li>  Notification Bar </li></ol><br><p>  As a result, thanks to software additions implemented on MULTI-SIM, we were able to realize the necessary interaction between the subscriber device and the server part in the local network and in public networks without compromising security. </p><br><h2>  Read more: </h2><br><p>  Everything is under control: we protect corporate conversations.  <a href="https://habrahabr.ru/company/tottoli_gsm/blog/305586/">Part 1.</a> <br>  Everything is under control: we protect corporate conversations.  <a href="https://habrahabr.ru/company/tottoli_gsm/blog/306370/">Part 2: Secure Telephone</a> </p></div><p>Source: <a href="https://habr.com/ru/post/308432/">https://habr.com/ru/post/308432/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../308420/index.html">Ways of integration with 1C</a></li>
<li><a href="../308422/index.html">Match ambiguous terms in GitLab, GitHub and Bitbucket</a></li>
<li><a href="../308424/index.html">‚ÄúMy friends lost sight of me for 3 months‚Äù or how people learn from us big data</a></li>
<li><a href="../308426/index.html">Increase conversion</a></li>
<li><a href="../308428/index.html">Music, Mathematica and Computational Universe: Automatic Music Creation Based on Cellular Automata</a></li>
<li><a href="../308434/index.html">Financial accounting in the text console</a></li>
<li><a href="../308438/index.html">Mobile App Metrics Overview</a></li>
<li><a href="../308440/index.html">How to stop being afraid and fall in love with mbed [Part 1]</a></li>
<li><a href="../308442/index.html">Becoming a PostgreSQL Contributor</a></li>
<li><a href="../308444/index.html">Alawar experience: how to increase eCPM advertising in the game by 150%</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>