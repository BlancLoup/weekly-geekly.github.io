<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Switching from CruiseControl.NET to Jenkins in the PVS-Studio development team</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Now it is difficult to imagine software development without automated project builds and testing. To minimize the time spent on integrating developer ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Switching from CruiseControl.NET to Jenkins in the PVS-Studio development team</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1bb/7a8/97e/1bb7a897e17c6d5626f949ad85534c73.png" alt="Picture 1"></div><br>  Now it is difficult to imagine software development without automated project builds and testing.  To minimize the time spent on integrating developer changes into the project, there are various ready-made solutions.  In this article I will talk about replacing the continuous integration server CruiseControl.NET with Jenkins in the PVS-Studio development team.  And also about what prompted us to this, what goals we pursued and what problems we faced. <br><a name="habracut"></a><br><h2>  Introduction </h2><br>  Continuous Integration (eng. Continuous Integration, hereinafter CI) is an automated process for assembling, deploying and testing the software being developed.  This development practice is popular both in large teams and among individual developers.  For this practice, there are many ready-made solutions.  This article will discuss free open source projects CruiseControl.NET and Jenkins. <br><br>  <a href="http://www.cruisecontrolnet.org/">CruiseControl.NET</a> (CCNet) is a tool for continuous software integration implemented on the .NET Framework.  There are also versions of the Java tool (CruiseControl) and version for Ruby environments (CruiseControl.rb).  Manage and view information about the assembly is carried out through a web interface or desktop utility.  Integrates with various version control systems.  It is an open source project and, unfortunately, has not been developing since about 2013. <br><br>  <a href="https://jenkins.io/">Jenkins</a> is a continuous, open source integration tool written in Java.  Was branched from the <a href="http://hudson-ci.org/">Hudson</a> project after a dispute with Oracle.  Providing continuous integration functions, it allows you to automate part of the software development process in which human participation is not necessary.  Jenkins features can be expanded with plugins.  At the moment, the project is actively developing and supported by both developers and the community. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Although the article is a bit similar to the review in the style ‚ÄúCCNet Vs.  Jenkins ‚Äù, the emphasis will immediately be placed on choosing a server with Jenkins.  The main reason for the change of the continuous integration tool for us is the lack of development of the project CruiseControl.NET.  The article will also describe other aspects of working with CCNet, which had difficulties. <br><br>  Recently, the PVS-Studio project had a 10-year anniversary, which can be found in the article ‚Äú <a href="http://www.viva64.com/ru/b/0465/">How the PVS-Studio project began 10 years ago</a> ‚Äù.  For more than half the product's lifetime, we used CCNet.  Its interface, settings and functions have become so familiar that Jenkins seemed extremely uncomfortable.  We first began to use it when PVS-Studio for Linux appeared.  The transition to Jenkins was preceded by a long study of this tool.  Part of the time we spent searching for an analogue of the functions we were used to from CCNet.  Next will be described interesting points from the work done. <br><br><h2>  Our claims for CCNet </h2><br><ol><li>  CCNet no longer develops.  You can still use it, but you will have to expand the functionality and correct existing / potential errors on your own. </li><li>  The Source Code Management (SCM) polling mode is unstable about changes, namely, for automatic launch when there are changes in the version control system.  If there are problems with the network, in this mode the project receives the status ‚ÄúFailed‚Äù, even if it did not start.  In practice, the problem occurs so often (unfortunately, in our office is not the most stable Internet access), it becomes impossible to use this mode. </li><li>  When polling SCM about changes, if there is an error in the version control system (for example, if any directory specified in the settings was removed from the repository and a tree conflict arose), the project is immediately interrupted, keeping the status ‚ÄúSuccess‚Äù - the project stops working but its status in the web interface and desktop utility remains "green".  In this mode, for example, running tests may not be performed for weeks, and there is a risk that no one pays attention to this, thinking that the tests work successfully. </li><li>  The general server log is too verbose and unstructured: it is difficult to understand which build step has fallen off and to find the log for this step.  When running several projects in parallel, the build log is ‚Äúmixed‚Äù.  The XML log of a separate project is available in the web interface, but on the contrary, it is often not sufficiently detailed and does not contain all the commands that are run. </li><li>  Inefficient parallelization of subtasks within the project.  Subtasks are run in parallel in groups by the number of processor cores.  If the group includes long-lasting and quick tasks, then new tasks will not be launched until all tasks from the previous launch have completed. </li></ol><br><h2>  Comparison of use cases </h2><br><h3>  Server settings </h3><br>  The CCNet project settings (server configuration) were stored in one xml file, and various passwords in another.  Although the settings file has reached ~ 4500 lines, it was quite convenient to use.  With an easy click of Alt + 2 in Notepad ++, the list of all projects can be minimized and edited to the desired one (Figure 1). <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/dee/821/454/dee821454f62cb008a1c34aaa8bd567f.png" alt="Figure 1 - Editing CCNet settings in Notepad ++"></p><br>  <font color="#999999"><i>Figure 1 - Editing CCNet settings in Notepad ++</i></font> <br><br>  Although the file contained duplicate code, there was no particular difficulty with server support. <br><br>  This is how the SCM block was filled: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svn</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;SVN_USERNAME;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;SVN_PASSWORD;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">trunkUrl</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;SVN_ROOT;...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">trunkUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">workingDirectory</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;PROJECT_ROOT;...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">workingDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executable</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;SVN_FOLDER;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executable</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">deleteObstructions</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">deleteObstructions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cleanUp</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cleanUp</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">revert</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">revert</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">timeout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">units</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"minutes"</span></span></span><span class="hljs-tag">&gt;</span></span>30<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">timeout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svn</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  So the MSBuild block was filled: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">msbuild</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>PVS-Studio 2015<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">workingDirectory</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;PROJECT_ROOT;...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">workingDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">projectFile</span></span></span><span class="hljs-tag">&gt;</span></span>...\PVS-Studio-vs2015.sln<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">projectFile</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">buildArgs</span></span></span><span class="hljs-tag">&gt;</span></span>/p:Configuration=Release<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">buildArgs</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">targets</span></span></span><span class="hljs-tag">&gt;</span></span>Build<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">targets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">timeout</span></span></span><span class="hljs-tag">&gt;</span></span>600<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">timeout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executable</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;MSBUILD14_PATH;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executable</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">msbuild</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  And so the block was filled for common tasks: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exec</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>PVS-Studio 2015 sign<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executable</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;PROJECT_ROOT;...\SignToolWrapper.exe<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executable</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">baseDirectory</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;PROJECT_ROOT;...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">baseDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">buildArgs</span></span></span><span class="hljs-tag">&gt;</span></span>"&amp;SIGNTOOL;" ... \PVS-Studio-vs2015.dll"<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">buildArgs</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">buildTimeoutSeconds</span></span></span><span class="hljs-tag">&gt;</span></span>600<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">buildTimeoutSeconds</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exec</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  On the basis of such a CCNet project file, then it conveniently displays all the steps performed (albeit, only in the desktop tray utility. For some reason, the Web interface did not support this).  In Jenkins, we had to tinker with the ‚Äúhigh-level‚Äù display of the stages of the integration project, but this will be discussed later. <br><br>  For Jenkins, you need to store a lot of configuration files: server config, configuration files of some plugins, each project has its own configuration file.  Although all these files are in xml format, they are not very convenient for viewing and editing (at least compared to CCNet), since  All commands within tags are spelled out in solid text.  True, this is largely due to the ideology of using the tool.  The configuration is written to CCNet manually, and therefore, it can be ‚Äúbeautifully‚Äù formatted.  Jenkins, on the other hand, assumes editing project settings via its web interface, and automatically generates configs. <br><br>  This is what the commands in Jenkins configurations look like: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hudson.tasks.BatchFile</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">command</span></span></span><span class="hljs-tag">&gt;</span></span>CD &amp;quot;%BUILD_FOLDERS%\Builder&amp;quot;&amp;#xd; PVS-Studio_setup.exe /VERYSILENT /SUPPRESSMSGBOXES ...&amp;#xd; Publisher_setup.exe /VERYSILENT /SUPPRESSMSGBOXES<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">command</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hudson.tasks.BatchFile</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  And this is a very small example. <br><br><h3>  View task statuses </h3><br>  As I wrote earlier, in CCNet projects are filled with Task blocks.  This is what a successfully completed task looks like with the display of steps (Figure 2). <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bff/a83/92e/bffa8392e1f0d457bd7bfdeb25402ada.png" alt="Figure 2 - Viewing task status in CCTray (desktop client for CCNet)"></div><p></p><br>  <font color="#999999"><i>Figure 2 - Viewing task status in CCTray (desktop client for CCNet)</i></font> <br><br>  The error in any of the blocks can be clearly seen in the hierarchy of subtasks.  This is a very convenient and clear visualization of the integration process.  Almost never there was a need to look for logs; by the description of the task it was immediately clear what to check on the local computer.  There was nothing right in this form in Jenkins, so I had to study this moment in detail before moving to a new server. <br><br>  One can draw such an analogy between CCNet and Jenkins: there is a project in CCNet (Project), a step in this project is a Task (as seen in the figure above).  Jenkins also has a project (Job), and his steps are Step's (Figure 3). <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/259/e6a/de2/259e6ade29ad52b8d89ffa65917d14b6.png" alt="Figure 3 - Correspondence of project naming in CCNet and Jenkins"></div><p></p><br>  <font color="#999999"><i>Figure 3 - Correspondence of project naming in CCNet and Jenkins</i></font> <br><br>  Unfortunately, Jenkins web interface does not know how to visualize the work of individual steps - Job has only a complete console log of all steps together.  The big inconvenience here is that from Jenkins it is impossible to see which of the steps ended with an error - you need to look at the complete Job‚Äôs build log.  And since you quickly get used to the good, you didn‚Äôt want to give up the old usage scenario.  Then <a href="https://wiki.jenkins-ci.org/display/JENKINS/Multijob%2BPlugin">Multijob Plugin</a> came to our <a href="https://wiki.jenkins-ci.org/display/JENKINS/Multijob%2BPlugin">aid</a> . <br><br>  This plugin allowed us to make the following innovations: <br><br>  1. Using Job'ov as Step'ov in other Job'ah.  Thus, universal Job'y appeared, which allowed to separate the log of specific subtasks and, most importantly, separately view the statuses of specific subtasks.  Jenkins Web interface is able to visualize well the performance of individual jobs within Multijob - just what we were looking for.  Figure 4 shows an example of a Multijob run. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/28e/432/3c7/28e4323c725752c6e5594edfac42d1da.png" alt="Figure 4 - View completed Multijob"></div><p></p><br>  <font color="#999999"><i>Figure 4 - View completed Multijob</i></font> <br><br>  2. Using universal Job'ov managed to get rid of duplicate code.  For example, there is a compilation of some utility: for distribution, to run tests and to run code analysis.  In CCNet, these were the same Task blocks in 3 different projects.  Jenkins compiled this utility with Job, which is used by several Multijobs. <br><br>  3. When creating projects in Jenkins, the following ideology is used.  All jobs are divided into multijob ‚Äúprojects‚Äù and universal ‚Äústeps‚Äù.  The names of universal jobs are prefixed with ‚Äújob_‚Äù and do not imply use as an independent project.  Also, they do not contain the download of source code from the repository.  Multijob names are prefixed with ‚Äúproj_‚Äù and include downloading the source code, and running only other jobs.  (Step'y we try to avoid, because they are not visualized). <br><br>  Universal jobs are launched with the following parameter: <br><br><pre> <code class="cpp hljs">WORKSPACE=$WORKSPACE</code> </pre> <br>  This means that Job will be launched in the working directory of the Multijob. <br><br>  Thus, it is possible to obtain separately the update log of the source files and the logs of all stages of the assembly separately.  To follow this ideology for all projects is difficult and meaningless.  This is done only for a few of the largest and most important projects that need to be studied in detail when problems arise. <br><br>  4. In Multijob, you can configure conditional and parallel runs of jobs.  Multijobs can run Multijobs using the same rules.  So you can combine project launches: for example, run the assembly of all installers or all tests. <br><br><h3>  View build logs </h3><br>  It was extremely inconvenient to view the project build logs in CCNet, since  they mixed up with the server output, and had special markup.  In Jenkins, there is no such problem, and in addition there is an opportunity to share logs for subtasks in some projects. <br><br><h3>  Getting a source code revision </h3><br>  Jenkins has its own revision version for each added link to the SVN repository.  Those.  If you add several directories, the numbers can be very different, and you need one maximum. <br><br>  According to the documentation, it‚Äôs necessary to work with it as follows: <br><br>  <i>If you have multiple modules checked out, use the svnversion command.</i>  <i>If you have multiple commands checked out, you can use the environment variables, where you‚Äôre configured.</i> <br><br>  And they did it: from all the <i>SVN_REVISION_ &lt;n&gt;</i> values, the maximum is taken and added to the assembled programs. <br><br><h2>  Useful Jenkins Plugins </h2><br>  Expansion of possibilities with the help of plug-ins allows the most flexible configuration of the server.  The plug-ins for running tests in Visual Studio are perhaps the only ones that we refused to use.  They had additional required launch parameters that we didn‚Äôt use, so it was easier to make a generic Job, just running tests from the command line.  Unfortunately, ‚Äúout of the box‚Äù Jenkins didn‚Äôt know much of what we were used to at CCNet.  However, with the help of plug-ins, we managed to ‚Äúreturn‚Äù all the required functionality. <br><br>  The following is a list of plugins with a small description, which was convenient for us to use: <br><br><ol><li>  <a href="http://wiki.jenkins-ci.org/display/JENKINS/Multijob%2BPlugin"><u>Multijob plugin</u></a> - allows you to use as a build stages other jobs with the possibility of sequential and parallel execution. </li><li>  <a href="https://wiki.jenkins-ci.org/display/JENKINS/EnvInject%2BPlugin"><u>Environment Injector Plugin</u></a> - with this plugin you can set global passwords.  They are used as environment variables, while the plugin hides the values ‚Äã‚Äãof such a variable in the log. </li><li>  <a href="https://wiki.jenkins-ci.org/display/JENKINS/pre-scm-buildstep"><u>Pre SCM BuildStep Plugin</u></a> - add extra steps before executing version control system commands. </li><li>  <a href="http://wiki.jenkins-ci.org/display/JENKINS/MSBuild%2BPlugin"><u>MSBuild Plugin</u></a> is a handy plugin for building projects using MSBuild.  In the settings, the paths to different versions of MSBuild are indicated once.  Next in the project, you can easily add assembly steps. </li><li>  <a href="http://wiki.jenkins-ci.org/display/JENKINS/Parameterized%2BTrigger%2BPlugin"><u>Parameterized Trigger plugin</u></a> - adds project launch parameters.  You can, for example, make a choice of the trunk / stable branch for building the distribution. </li><li>  <a href="http://wiki.jenkins-ci.org/display/JENKINS/PostBuildScript%2BPlugin"><u>Post-Build Script Plug-in</u></a> - perform additional steps after assembly. </li><li>  <a href="https://wiki.jenkins-ci.org/display/JENKINS/Throttle%2BConcurrent%2BBuilds%2BPlugin"><u>Throttle Concurrent Builds Plug-in</u></a> - this plugin allows you to adjust the number of parallel running project builds globally or within a given category.  It allows Jenkins to get functionality similar to queues in CCNet ‚Äî the ability to execute several projects in parallel from different categories (queues), while ensuring consistent execution of projects within one queue.  For example, we have the queues Installers (distributions) and Tests (tests).  We want to be able to simultaneously build some distribution kit when tests are running, but tests should not work in parallel - there will not be enough "cores" on the server. </li><li>  <a href="https://wiki.jenkins-ci.org/display/JENKINS/Build%2BName%2BSetter%2BPlugin"><u>Build Name Setter Plugin</u></a> - allowed to set the build name in the format we need: <i>Major.Minor.Revision.Build</i> . </li><li>  <a href="https://wiki.jenkins-ci.org/display/JENKINS/Dashboard%2BView"><u>Dashboard View</u></a> - allows you to add your own display of jobs in the browser.  Since  we have universal jobs that don't make sense to start manually, we created a list without them using this plugin. </li><li>  <a href="https://wiki.jenkins-ci.org/display/JENKINS/ZenTimestamp%2BPlugin"><u>ZenTimestamp Plugin</u></a> is a handy plugin that adds timestamps in the build logs. </li></ol><br><h2>  Desktop Client Overview </h2><br>  To receive notifications from CCNet, we used a Windows client, CCTray. <br><br>  Here are some options for working with Jenkins now: <br><br>  1. CCTray - this program can be used for a server with Jenkins.  Projects will look about, as before (Figure 5). <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/422/3a7/00c/4223a700c013ad004a2bb01a74878cb4.png" alt="Figure 5 - CCTray Screenshot"></p><br>  <font color="#999999"><i>Figure 5 - CCTray Screenshot</i></font> <br><br>  Description as a client for Jenkins: <br><br><ul><li>  Does not develop, as well as CCNet; </li><li>  Cannot show subtasks (works only for CCNet); </li><li>  Can not run projects; </li><li>  By clicking on the name you can go to the project page; </li><li>  Adjusts the type of display projects (Icons, List, Details); </li><li>  Open source. </li></ul><br>  2. <a href="https://catlight.io/">CatLight</a> (Figure 6) <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b1/8ae/e90/6b18aee9061a878ccffa0ba4a92df10a.png" alt="Figure 6 - CatLight Screenshot"></div><p></p><br>  <font color="#999999"><i>Figure 6 - CatLight Screenshot</i></font> <br><br>  Customer Description: <br><br><ul><li>  At the moment, Beta version, the final version will be paid; </li><li>  There are still crashes during installation, operation and glitches in the interface; </li><li>  When a computer comes out of hibernation, the status of projects on the dashboard is not automatically updated; </li><li>  Cannot show subtasks for Multijobs; </li><li>  Can not run projects; </li><li>  The type of project display is not configured (the only possible view is Figure 6); </li><li>  By clicking on the name you can go to the project page; </li><li>  You can see the status of the last 5 launches and go to them; </li><li>  You can see the progress of the running project; </li><li>  When adding multiple servers, they are conveniently separated by a dash; </li><li>  There are for Windows, Linux and Mac. </li></ul><br>  3. <a href="http://fieryjoy.com/kato">Kato</a> (Figure 7) <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/062/beb/d7b/062bebd7bffaa94362dbd058dfbbec21.png" alt="Figure 7 - Kato Screenshot"></div><p></p><br>  <font color="#999999"><i>Figure 7 - Kato Screenshot</i></font> <br><br>  Customer Description: <br><br><ul><li>  Cannot show subtasks for Multijobs; </li><li>  Able to run projects.  Unfortunately, it does not support projects with parameterized launch - the utility crashes when trying to launch such a project; </li><li>  Projects from different servers are displayed in one list and are indistinguishable (not always convenient); </li><li>  Adjusts the type of display projects (List, Grid); </li><li>  By clicking on the name you can go to the project page; </li><li>  You can view the last log directly in the client, but due to the lack of monospace text this is not very convenient; </li><li>  Open source; </li><li>  Only for Windows. </li></ul><br>  4. <a href="http://ccmenu.org/">CCMenu</a> is an open source Mac client only.  For us it is not relevant, but can someone come in handy. <br><br><h2>  Conclusion </h2><br>  Using CI is useful in any project.  There is a great free Jenkins tool for this, which was covered in the article, as well as many other free and paid CIs.  It's nice to use a developing project: for Jenkins and plugins, there are a lot of updates from time to time.  New solutions are emerging, such as, for example, the new project <a href="https://jenkins.io/projects/blueocean/">Blue Ocean</a> , which is still at the Beta stage, is now on the main page. <br><br>  The clients for monitoring Jenkins projects have not really pleased me.  There are a lot of functions that are not obvious.  Perhaps desktop clients are not particularly in demand and it is more correct to use only the web interface. <br><br>  When moving to a new server, it was not possible to use Jenkins as a Windows service, since  UI tests are not performed in this mode.  Out of position, setting up the server as a console application with a hidden window. <br><br>  If you have any additions to the stated material or interesting solutions to the above problems, we will be happy if you leave a comment on the article or write us via the feedback <a href="http://www.viva64.com/ru/about-feedback/">form</a> . <br><br><div style="text-align:center;"> <a href="http://www.viva64.com/en/b/0472/"><img src="https://habrastorage.org/files/8d2/41b/5bf/8d241b5bf34747169141ed7c1997143b.png"></a> </div><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Svyatoslav Razmyslov.  <a href="http://www.viva64.com/en/b/0472/">Moving from CruiseControl.NET to Jenkins in the PVS-Studio development team</a> <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="http://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. </div></div></div><p>Source: <a href="https://habr.com/ru/post/321346/">https://habr.com/ru/post/321346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321332/index.html">What is the difference between a designer in a grocery company and a designer in an agency or studio?</a></li>
<li><a href="../321334/index.html">Crossover holds the Hiring challenge competition and hires hundreds of Java and Ruby on Rails developers.</a></li>
<li><a href="../321338/index.html">Cryptography and secure communication: the history of the first ciphers</a></li>
<li><a href="../321340/index.html">Introduction to the design of entities, the problem of creating objects</a></li>
<li><a href="../321344/index.html">Inversion of injection control</a></li>
<li><a href="../321348/index.html">We recycle. So what?</a></li>
<li><a href="../321350/index.html">Kaggle and Linux. Digit Recognizer for analysts (for beginning analysts)</a></li>
<li><a href="../321352/index.html">Search for large documents in ElasticSearch</a></li>
<li><a href="../321354/index.html">How-to: tools for competitive analysis of software products</a></li>
<li><a href="../321356/index.html">One-day conference on the gaming industry at VSBI February 11</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>