<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using SuiteCRM EntryPoints</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will focus on the well-known open source CRM system - SuiteCRM. The openness of the system provides endless possibilities for customizati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using SuiteCRM EntryPoints</h1><div class="post__text post__text-html js-mediator-article">  This article will focus on the well-known open source CRM system - SuiteCRM.  The openness of the system provides endless possibilities for customization, and, as an example, the process of creating dynamically loadable directories from the database using the select2 jQuery library will be considered. <br><br>  Select2 can work with static sets of choices, as well as receive data from external sources, has widely customizable display formats using pictures, etc.  The data format is in the form of JSON, so our task is to develop an EntryPoint so that the output will produce the necessary JSON structure. <br><br>  The SuiteCRM is based on the MVC model, and all actions imply a call to the action controller.  It happens that it is necessary to deviate from the standard MVC approach, since the use of the usual MVC approach can be difficult or simply not necessary. <br><a name="habracut"></a><br>  Creating your own EntryPoints takes place in two stages.  The first is to register such an EntryPoint through the embedded MVC framework.  Listing 1 shows an example of registering an EntryPoint with the system. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Listing 1.</b> <br><br>  ./custom/Extension/application/Ext/EntryPointRegistry/custom_entry_point_registry.php <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $entry_point_registry[<span class="hljs-string"><span class="hljs-string">'CustomEntryPoint'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'file'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'custom/modules/&lt;Module&gt;/customEntryPoint.php'</span></span>, <span class="hljs-string"><span class="hljs-string">'auth'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> );</code> </pre> <br>  The second stage is the creation of a file that describes the logic of this EntryPoint itself (Listing 2). <br><br>  <b>Listing 2.</b> <br><br>  ./custom//customEntryPoint.php <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!defined(<span class="hljs-string"><span class="hljs-string">'sugarEntry'</span></span>) || !sugarEntry) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Not A Valid Entry Point'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span>;</code> </pre><br>  After creating these files, you need to perform ‚ÄúQuick Repair and Rebuild‚Äù, then go to: <nobr>... index.php? EntryPoint = CustomEntryPoint.</nobr> <br><br>  For the formation of JSON objects, you can use a different approach, for example, json_encode (), but in this example we will consider a simple string concatenation, since you only need to form a part of the JSON object. <br><br>  <b>Listing 3.</b> <br><br>  ./custom//customEntryPoint.php <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!defined(<span class="hljs-string"><span class="hljs-string">'sugarEntry'</span></span>) || !sugarEntry) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Not A Valid Entry Point'</span></span>); $response = <span class="hljs-string"><span class="hljs-string">'{"more": "false", "results":['</span></span>; $sql = <span class="hljs-string"><span class="hljs-string">"SELECT stage, name FROM opportunity_stages order by name"</span></span>; $res = $GLOBALS[<span class="hljs-string"><span class="hljs-string">'db'</span></span>]-&gt;query($sql); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$res) { <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Bad query'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>($row = $GLOBALS[<span class="hljs-string"><span class="hljs-string">'db'</span></span>]-&gt;fetchByAssoc($res)){ $response .= <span class="hljs-string"><span class="hljs-string">'{"text":"'</span></span> . $row[<span class="hljs-string"><span class="hljs-string">"stage"</span></span>] . <span class="hljs-string"><span class="hljs-string">'", '</span></span> . $row[<span class="hljs-string"><span class="hljs-string">"name"</span></span>] . <span class="hljs-string"><span class="hljs-string">'],'</span></span>; } $response = rtrim($response, <span class="hljs-string"><span class="hljs-string">","</span></span>); $response .= <span class="hljs-string"><span class="hljs-string">']}'</span></span>; header(<span class="hljs-string"><span class="hljs-string">'Content-Type: application/json'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $response;</code> </pre><br>  The result of the work is shown in Listing 4. <br><br>  <b>Listing 4.</b> <br><br>  index.php? entryPoint = CustomEntryPoint <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"more"</span></span>: <span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"results"</span></span>: [ {<span class="hljs-string"><span class="hljs-string">"text"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"text"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"2"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"text"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"3"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"text"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"4"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"text"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"5"</span></span>} ] }</code> </pre><br>  Now you need to get this data in select2.  An example of initialization is shown in Listing 5. <br><br>  <b>Listing 5.</b> <br><br><pre> <code class="javascript hljs">$(<span class="hljs-string"><span class="hljs-string">'#select'</span></span>).select2({ <span class="hljs-attr"><span class="hljs-attr">placeholder</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-attr"><span class="hljs-attr">minimumInputLength</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">ajax</span></span>: { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">"index.php?entryPoint=CustomEntryPoint"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dataType</span></span>: <span class="hljs-string"><span class="hljs-string">'json'</span></span>, <span class="hljs-attr"><span class="hljs-attr">quietMillis</span></span>: <span class="hljs-number"><span class="hljs-number">250</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">term, page</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">q</span></span>: term, }; }, <span class="hljs-attr"><span class="hljs-attr">results</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, page</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">results</span></span>: data.results }; }, <span class="hljs-attr"><span class="hljs-attr">cache</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">initSelection</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">element, callback</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> elementValue = $(element).val(); callback({<span class="hljs-string"><span class="hljs-string">"text"</span></span>:elementValue,<span class="hljs-string"><span class="hljs-string">"id"</span></span>:$(<span class="hljs-string"><span class="hljs-string">'#select'</span></span>).val()}); }, <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">object</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> object.text; }, <span class="hljs-attr"><span class="hljs-attr">formatSelection</span></span>: customFormatSelection, }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">customFormatSelection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state.text; };</code> </pre><br>  That's all.  Now the page should have a convenient drop-down list.  Despite the fact that in this example, implementation with 5 drop-down options for sales stages is considered, this approach can be very convenient when implementing directories with large amounts of data, for example, KLADR and others. <br><br>  "A link to the select2 library: <a href="https://select2.github.io/examples.html">https://select2.github.io/examples.html</a> <br><br>  The article was prepared by Sergey Shirnin, consultant of Siebel, Jet Infosystems </div><p>Source: <a href="https://habr.com/ru/post/310490/">https://habr.com/ru/post/310490/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310480/index.html">Why does the network of mobile operators sometimes ‚Äúfall‚Äù?</a></li>
<li><a href="../310482/index.html">Another type of XSS attack on the site</a></li>
<li><a href="../310484/index.html">Compress mobile graphics to ETC1 format and open utility</a></li>
<li><a href="../310486/index.html">We make a startup simply and technologically. Eddystone Beacon</a></li>
<li><a href="../310488/index.html">Do Tango robots dance</a></li>
<li><a href="../310492/index.html">Vladislav Kochetkov, President of FINAM Holding: ‚ÄúWe are better able to teach than aggressively sell‚Äù</a></li>
<li><a href="../310494/index.html">CIKM Cup 2016 - an international competition in the field of Data Science</a></li>
<li><a href="../310496/index.html">Just a label on the site</a></li>
<li><a href="../310498/index.html">Quick integration of Google Chromecast in Android app</a></li>
<li><a href="../310500/index.html">Matrix-based collection development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>