<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experience with TDD and thinking about how to test code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Our company recently hosted a lecture ‚ÄúEngineering Practices‚Äù and this turned out to be an introduction to TDD. 
 Oh no not this! "Sometimes they come...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experience with TDD and thinking about how to test code</h1><div class="post__text post__text-html js-mediator-article">  Our company recently hosted a lecture ‚ÄúEngineering Practices‚Äù and this turned out to be an introduction to TDD. <br>  Oh no not this!  "Sometimes they come back" (c) Stephen King <br><br>  In previous work, we spent 3 years trying to introduce this technique.  It was painful.  Management sincerely believed that TDD would solve the problems of the company.  Reality is strikingly inconsistent with this.  All this awakened the erased memories of the Soviet era.  I remembered posters ‚ÄúForward to the victory of communism‚Äù hanging on the walls and phrases like ‚ÄúThe doctrine of Marx is omnipotent because it is true‚Äù. <br><img src="https://habrastorage.org/getpro/habr/post_images/79c/3d2/740/79c3d27402424aea1dfdc59122f3029a.jpg"><br><br>  So what's wrong with the TDD <strike>Conservatory</strike> ? <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Disclaimer </h3><br>  Unfortunately, my post was understood by many in the sense that I am against testing.  And especially against unit tests in all their manifestations.  This is not quite true; more precisely, this is not at all true. <br><br>  I copy here an important remark, which was at the end of the post and it was not too striking. <br>  There are 3 types of code when unit tests are very appropriate and their use is justified: <br><ol><li>  Software of increased reliability - for example, software for aircraft, power plants, etc. </li><li>  Easily isolated code - algorithms and all that. </li><li>  Utilities is a code that will be VERY widely used in the system, so it‚Äôs worth thoroughly scanning them in advance </li></ol><br>  If you easily and simply write unit tests, which means that your code is easy to isolate, then you don‚Äôt have to read further and understand my experience with pain, sweat and blood.  Well, if not, then keep in mind that the following is an exceptional single case, but it is well-worn and meaningful. <br><br>  For a start, we will define the terms. <br><br><h3>  Terminology </h3><br>  <u>Manual tests</u> <br>  The functionality is tested manually on a ‚Äúlive‚Äù system using the standard UI for it. <br>  This is the usual, traditional QA testing method. <br><br>  <u>Functional tests</u> <br>  The programmer writes a kind of "test" UI, which allows you to run certain scripts on a "live" system, with the interaction of these modules. <br>  This is a very common testing method used by programmers. <br><br>  <u>Unit tests</u> <br>  The programmer writes tests that are able to run in an ‚Äúisolated‚Äù environment - without other modules.  Other modules to which the test code should refer to during the work are replaced by mocks.  Thus, tests can be executed automatically, on the build machine, after compilation. <br>  There is a trend for the use of such tests.  And programmers are under pressure (moral and administrative) in order to switch to their use. <br><br>  <u>Separate remark about TDD</u> <br>  TDD is a programming technique that uses unit tests extensively.  And if something is wrong with the Unit tests, then TDD can add to this trouble (which it successfully does), but it does not diminish. <br><br>  <u>"Error in the code"</u> <br>  The code is written with an error and does something different from the programmer‚Äôs intent. <br><br>  <u>"Integration errors"</u> <br>  Two programmers wrote interacting modules / classes, and misunderstood the protocol.  A protocol means both parameters passed to functions and a valid / valid sequence of calls. <br>  Moreover, each of the classes can be written ‚Äúpurely‚Äù, but when combined, they give a teravilny system operation. <br><br>  <u>"Multisulting and Timing Errors"</u> <br>  If several threads participate in the work, there may be errors associated with access to a shared resource or with a sequence of calls.  These are the most elusive (after memory corruption) bugs that I have encountered. <br><br>  <u>‚ÄúUI Errors‚Äù and ‚ÄúUnexpected Errors‚Äù</u> <br>  The UI does not meet the requirements at all or somehow crookedly handles some specific situations. <br>  For example, it allows for the input of incorrect data or does not display a sufficiently clear message in case of a negative result. <br><br><h3>  Pros and cons of various types of testing </h3><br><table><tbody><tr><th></th><th>  Manual </th><th>  Functional </th><th>  Unit </th></tr><tr><td>  Ability to find "errors in the code" </td><td>  Yes </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  Ability to find "integration errors" </td><td>  Yes </td><td>  Yes </td><td>  Not </td></tr><tr><td>  Ability to find "Multisulting errors and timing" </td><td>  Partially </td><td>  Partially </td><td>  Not </td></tr><tr><td>  Ability to find ‚ÄúUI errors‚Äù and ‚Äúcontingency errors‚Äù </td><td>  Yes </td><td>  Partially </td><td>  Not </td></tr><tr><td>  Ability to test with a variety of input data </td><td>  Low </td><td>  <nobr>Acceptable</nobr> </td><td>  Very high </td></tr><tr><td>  Ability to automate testing </td><td>  Very low </td><td>  Low </td><td>  Yes </td></tr><tr><td>  Extra programming effort </td><td>  Not </td><td>  No ... x1.5 </td><td>  x2 ... x5 </td></tr></tbody></table><br><br>  According to my experience (I don‚Äôt have accurate statistics, unfortunately), ‚Äúerrors in the code‚Äù make up less than 30% of all bugs in a fairly complex system.  If the programmer is experienced enough, the number of such errors will be even less. <br>  The vast majority of such errors are perfectly captured using ‚Äúcode reviews‚Äù (code review) and functional tests. <br><br>  Unit tests are capable of testing code with a wide variety of possible options, up to all conceivable input data.  You can test the code very carefully, you can even "to the last comma." <br>  The problem is that there is a certain set of situations that can happen in a real system.  Testing something beyond this set is irrelevant and is a waste of time. <br>  Typically, functional tests cover a completely rational set of possible situations. <br><br>  The strongest side of unit tests is automation. <br>  But personally, I (over 3 years of work) did not come across a situation where unit tests helped find a bug quite a long time after it was written. <br>  That is, unit tests are effective (helping to find bugs) for an exceptionally short time after writing. <br>  I have never seen any unit tests run automatically on the builder unit.  They are there "clean clean."  And, of course, they serve the guidance of peace of mind.  :) <br><br>  Minus unit tests are a huge effort to spend on writing and programming mocks.  That is why the time required to develop using unit tests is 2-5 times longer than without them. <br><br>  Of course, if the code weakly uses other modules, so that it is very easy to isolate it completely, then the unit tests almost intersect with the functional tests and the difference between them is only in the name and minor technical details. <br><br>  <strong>Summary:</strong> <br>  <em>Unit tests do not give a significant gain in system reliability.</em> <em><br></em>  <em>There are 3 types of code when unit tests are very appropriate and their use is justified:</em> <em><br></em> <ol><li>  High reliability software - no expense here </li><li>  Easily isolated code - writing unit tests is easy, simple, and the cost of them is no more than that of functional tests. </li><li>  Utilities is a code that will be VERY widely used in the system, so it‚Äôs worth thoroughly scanning them in advance </li></ol>  In all other cases, the unit test win / cost ratio is rather low.  There are much cheaper ways to deal with those bugs that are caught using unit tests (in particular, code inspection). <br>  If the cost of the error is exceptionally high (for example, we write the software of an airplane or a power plant), then, of course, no costs are excessive and unit tests must be used.  But usually the cost of the error is much less. <br><br><h3>  Organizational and psychological issues </h3><br>  The backfill question is: who and how can make sure that the programmer wrote unit tests well enough? <br><br>  There are two possible options for testing unit tests: <br>  <u>Instrumental check</u> <br>  It is possible to measure the "coverage" of the code with tests - whether all the lines of code were executed as part of tests.  I have never seen such a check used.  Well, of course, such tests can verify that the tests "cover" the code, but they cannot verify that the tests "cover" the possible input data. <br><br>  <u>Inspection of unit tests by another programmer or supervisor</u> <br>  I have seen it done.  Writing unit tests is a very boring thing.  Understanding them is generally dark.  That is, you can understand, but it requires a serious amount of time and motivation.  At the very beginning of implementation, people had an interest and motivation to do everything as it should to figure out what it was - unit tests and TDD.  But it passed very soon. <br><br>  Thus, it is quite difficult to control the programmer that he wrote unit tests well. <br>  As soon as control and administrative pressure decreases, programmers, here are lazy people, tend to write unit tests more and more ‚Äúfor show‚Äù and test their code using manual or functional testing. <br>  For systems with a not too high error cost, programmers do not have enough pressure to be paranoid for honest use of unit tests. <br><br>  If the programmer misses something in the code, it is caught in QA or already at the client and the bug is returned for correction.  Feedback makes you take the code seriously and attentively. <br>  If a programmer misses something in writing tests, in fact, no one will ever notice.  The lack of feedback allows you to treat the question of disregard. <br>  Even if the programmer got five times more time to develop, <strike>I</strike> ‚Äôd rather <strike>go to</strike> read Habrahabr instead of jigging tests, moki, tests, moki ... and so many days in a row. <br><br>  How else can you make unit tests "work"?  They should work if the tests are written by <u>another</u> programmer, and it‚Äôs best <u>to</u> the code itself. <br>  And here we come to TDD. <br><br><h3>  Test Driven Development </h3><br>  If the test is written before and provided to the programmer as source data, it becomes a ‚Äútechnical requirement‚Äù (requirement).  Of course, the one who writes the test must write and program all the required mocks in advance.  Haha, I would not want to be the programmer whose responsibility it is to program tests for others. <br><br>  Well, can a programmer himself write tests to his code in advance? <br>  In my experience, no and no.  Programmers (and I and the vast majority with whom I discussed it) just think in the opposite direction. <br><br>  Yes, at first people tried to honestly follow the methodology.  But after some time, they started to write the code first and then add tests to it.  And after some time, the tests lost their versatility and meticulousness.  And then ‚Äúshtob was‚Äù was written at all, since they ask. <br><br>  Does it even need it? </div><p>Source: <a href="https://habr.com/ru/post/207448/">https://habr.com/ru/post/207448/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../207392/index.html">Published video reports of the conference Cloud OS Summit 2013</a></li>
<li><a href="../207394/index.html">Ruby 2.1 released</a></li>
<li><a href="../207402/index.html">Results of the year in the mobile applications market: facts and conclusions from the report from Distimo</a></li>
<li><a href="../207444/index.html">Change the backlight monitor (themselves)</a></li>
<li><a href="../207446/index.html">We get paid through PayPal</a></li>
<li><a href="../207454/index.html">Great guide to Yiinitializr</a></li>
<li><a href="../207456/index.html">Miracast standard - old protocols in a new wrapper</a></li>
<li><a href="../207460/index.html">Benchmark of HTTP servers (C / C ++) on FreeBSD</a></li>
<li><a href="../207464/index.html">Analysis of spherical motion of a solid in the case of Lagrange</a></li>
<li><a href="../207466/index.html">We will do TICT. Creation experience, prospects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>