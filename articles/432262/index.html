<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We make our USB sound card with galvanic isolation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started as usual, from nefig to do from an excess of free time, I decided to do something such. Then I remembered that friends in the discord a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We make our USB sound card with galvanic isolation</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/zd/we/vh/zdwevhixe3tigzgz9q7oqv6v9mg.png"></div><br>  It all started as usual, <s>from nefig to do</s> from an excess of free time, I decided to do something such.  Then I remembered that friends in the discord are complaining about my microphone, some digital noise is heard, but if you start copying files on your computer, then in general.  Buy a normal sound card?  This is not about us. <br><br>  Anyone interested under the cat. <br><a name="habracut"></a><br><h3>  Codec Chip Selection </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bf/yx/vo/bfyxvosk2wy9p0y3topxttwgznm.png"></div><br>  In general, I am not a fan of making electronics from anything, even for myself, especially from Chinese components with Ali, so first of all we go to the digikey and look for something.  The first thought was to take a full-fledged codec chip and connect it to the <i>STM32</i> , let alone <i>USB</i> .  In principle, it is not difficult, but at some point I realized that I did not want to bother so much and decided to find something ‚Äúall in one‚Äù.  Google insistently issued <i>CM108</i> from <i>C-Media Electronics</i> , a manufacturer in Taiwan.  Well, okay, so be it <br><br><img src="https://habrastorage.org/webt/dw/nw/fh/dwnwfhui0rti_a-0jstcq4x-lzs.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The codec requires an <i>EEPROM</i> , and even offers a specific, analogue from <i>STMicroelectronics M93C46-WMN6TP</i> quickly found on the same digikey (Integrated Circuits (ICs)&gt; Memory).  Just in case, I connected its power through the filter so that nothing bad could happen to us in the codec's power. <br><br>  Just quartz, and because  I like to do everything for less and more compactly, then I put the <i>ABM3</i> series ( <i>ABM3-12.000MHZ-B2-T</i> ) <i>5</i> by <i>3.2</i> mm (do not put the same giant <i>HC-49</i> ) <br><br><h3>  Audio connectors </h3><br><img src="https://habrastorage.org/webt/g2/4c/at/g24catxvxd2w0nr-gz6ir1bzl0y.png"><br><br>  After looking for the connectors for headphones and microphone.  I personally prefer the <i>CUI</i> for audio and simple household power connectors <i>5.5</i> , I always put them, of course, search on digikey (Connectors, Interconnects&gt; Barrel - Audio Connectors). <br><br>  In my case, I already had a component in the library under <i>SJ2-3574A-SMT</i> .  I used to use it before; I could have chosen different colors (I have a <i>CUI</i> ), but I didn‚Äôt want to (I‚Äôm doing it for myself, I‚Äôll figure it out somehow). <br><br>  Usually capacitors are put in series ( <i>0.47uF</i> or <i>1uF</i> , <i>4.7uF</i> can be <i>used</i> ), it can be tantalum or ceramics, but film is best used.  In the reference scheme in the datasheet offer <i>470uF</i> , which is too much, choose <i>0.47uF</i> (if you need very low bass, then you can and <i>1uF</i> ).  Film capacitors are in <i>SMD</i> packages, which is very convenient, I put the <i>ECP-U1C474MA5</i> in case <i>1206</i> . <br><br><h3>  Electrical isolation for power </h3><br>  And now the most interesting <br><br><img src="https://habrastorage.org/webt/ol/7h/rp/ol7hrpatmnwgehalytm5qnl5ftm.png"><br><br>  <i>CM108</i> has 2 modes, <i>100mA</i> and <i>500mA</i> , of course, I chose fatter so that with a span of <i>500mA * 5V = 2.5W</i> , with a margin we need to find a junction somewhere in <i>3W</i> , set parameters (in the section Power Supplies - Board Mount&gt; DC DC Converters) and see what's cheaper, just remembering to sift out manufacturers that you don't really trust.  The choice fell on the <i>CC3-0505SF-E</i> from <i>TDK</i> (although I really wanted to deliver from <i>Murata</i> !).  It is worth bold, 11 bucks, but nothing can be done. <br><br>  After it, I put the filter, not forgetting about the capacitors <i>0.01uF</i> and <i>0.001uF</i> to filter out any HF heresy, since  it crawls through electroplating.  Another <i>100uF</i> electrolyte, it will definitely not be superfluous. <br><br><h4>  Interface decoupling </h4><br><img src="https://habrastorage.org/webt/7n/8i/bu/7n8ibugv6dcdr55eel3cchtdh58.png"><br><br>  Isolation of power is good, but it does not hurt to untie the <i>USB</i> interface itself.  In the Digital Isolators (Isolators&gt; Digital Isolators) section, you can find the right one, I selected <i>ADUM4160</i> from <i>Analog Devices</i> . <br><br>  Do not forget to pull the <i>DATA P</i> on the <i>USB</i> interface to <i>3.3V</i> , because  this tells the host (PC) that the device is plugged into the port and we should start working with it, in an amicable way, this pull-up should be inside the chip, but for some reason it does not. <br><br><h3>  Well, the little things </h3><br><img src="https://habrastorage.org/webt/s_/kl/ty/s_kltyf8we3lh0xmv9tzdhii81k.png"><br><br>  The <i>USB connector</i> itself is of course from <i>Molex</i> , it is still possible from <i>TE</i> or <i>Wurth</i> .  Or search others, but I think that such connectors are better to choose from these three, the rest are good, but in another. <br><br><img src="https://habrastorage.org/webt/qd/5u/_6/qd5u_6qb1z9psnkvstgwxib97vy.png"><br><br>  I also decided that if so much money was spent on clean food, then everything must be done well until the end, and the denouement of digital land and analog is no exception.  Moreover, instead of the usual jumper on the board, I put the <i>BLM15</i> filter (when distributing the board, the division of the earth is better to move closer to the main ground, that is, to the <i>GND</i> output of our isolator on the power supply, digital and analog ground should diverge) <br><br><h3>  Conclusion </h3><br><img src="https://habrastorage.org/webt/ar/iu/fz/ariufzigwozythclj-53m0tgsdc.png"><br><br>  Well, that's all, I spread the board in 4 layers of a standard class, after preparation for production it will cost about 130 rubles.  Also 4 layers are better in terms of the fact that polygons of food, earth and digital land are better to do proper polygons, in a good way, every layer has its own layer, but I have power and digital earth on one. <br><br>  It took about an hour and a half from the idea to the full layout.  The fee came out in size <i>22</i> by <i>66</i> mm. <br><br>  Honestly, while I was writing an article I had no idea to order a fee (well, as always), so let it be at least an article. <br><br>  PS Often I kill time like this by planting different projects, from simple wireless charging to wiring processors and ... leaving them gathering dust in the hard drive folder.  I lose interest in most cases (and because it's free, no need to spend money on components).  If you are interested in such articles, you can offer your ideas for the following projects. <br><br>  PPS Due to the fact that the board did not order and did not check errors are possible. </div><p>Source: <a href="https://habr.com/ru/post/432262/">https://habr.com/ru/post/432262/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../432250/index.html">Rust news # 3 (November 2018)</a></li>
<li><a href="../432252/index.html">How to earn more in the IT sector in Russia?</a></li>
<li><a href="../432256/index.html">Autumn aggravation: how RTM hackers staged a massive attack on banks and businesses on behalf of state institutions</a></li>
<li><a href="../432258/index.html">U-NOVUS 2018: workshop</a></li>
<li><a href="../432260/index.html">Changing global settings on local command servers in the infrastructure using Gitlab CI and Ansible [Concept]</a></li>
<li><a href="../432264/index.html">GitLab 11.5 released with control panels for operators and security professionals and access control GitLab Pages</a></li>
<li><a href="../432268/index.html">How to turn a client into data: we change video surveillance and video analytics for retail</a></li>
<li><a href="../432270/index.html">HappySecretSantaBot - Telegram bot for the game "Secret Santa"</a></li>
<li><a href="../432272/index.html">How we prepare stores for the new year</a></li>
<li><a href="../432276/index.html">Errors in the preparation of USP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>