<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using JSON MVC Controller in Visual Studio on Empty Web Site Template and C # Language</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will discuss the connection of the MVC3 library in Visual Studio 2010. But we will not use the ‚ÄúASP.NET MVC3 Web Application‚Äù project tem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using JSON MVC Controller in Visual Studio on Empty Web Site Template and C # Language</h1><div class="post__text post__text-html js-mediator-article">  This article will discuss the connection of the MVC3 library in Visual Studio 2010. But we will not use the ‚ÄúASP.NET MVC3 Web Application‚Äù project template, but create a Web site (Web site) based on the ‚ÄúEmpty Web Site‚Äù template, then eat from scratch.  We will connect the library to an empty Web site, since  There is no MVC template for the Web site. <br>  At the end of the article, a JSON controller based on the MVC library will be implemented. <br><a name="habracut"></a>  I would explain the pictures, but they are not inserted.  Therefore, I will explain in words. <br><br><h4>  Prehistory </h4><br>  Recently I was interested in the implementation of MVC in Visual Studio.  On the Internet, and in particular on Habr√©, there are many articles on how to use it, but reviewing 20 pieces of instructions, I found that all of them are based only on the ‚ÄúASP.NET MVC3 Web Application‚Äù template.  The first two steps in most instructions are as follows: <br><ol><li>  Download and install MVC3. </li><li>  Select item: <br>  File -&gt; New -&gt; Project ... -&gt; Installed Templates -&gt; Visual C # -&gt; Web -&gt; ‚ÄúASP.NET MVC3 Web Application‚Äù -&gt; Ok. </li></ol>  But what if a person wants to create a ‚Äúweb site‚Äù and not a ‚Äúweb application‚Äù.  Then he clicks the following menu items: <br>  File -&gt; New -&gt; Web Site -&gt; Installed Templates -&gt; Visual C # <br>  And then it looks for where this MVC3 is: ‚ÄúI just downloaded it and installed it‚Äù. <br>  If you take a good look, it‚Äôs not for nothing that MVC3 was installed: a new ‚ÄúASP.NET Web Site (Razor)‚Äù template appeared.  Razor is certainly cool, but MVC was not in it. <br>  So, it turns out that the MVC project for the Web site is not. <br>  In addition, I confess that I didn‚Äôt particularly like the ‚ÄúASP.NET MVC3 Web Application‚Äù template, because it contains too much of itself.  For me, it would be enough to include the necessary libraries there and create a directory structure.  It is more convenient for me when I control the contents of the project. <br>  Therefore, it was easier for me to create an MVC project from scratch based on the Empty Web Site template. <br>  I will not go into details of what is better to use: "Web site" or "Web Application".  To be honest, I am not sure that I fully represent their advantages and disadvantages.  But be that as it may, the version of the new project ‚ÄúWeb site‚Äù in Visual Studio is.  Therefore, it is used.  Therefore, someone will want to use MVC based on it. <br>  The only thing that confused me was that there were some features in the ‚ÄúASP.NET MVC3 Web Application‚Äù template that I couldn‚Äôt realize in the Web Site project: <br><ul><li>  The directory structure turned out to be different, because  all classes must be in the folder "App_Code" </li><li>  In the ‚ÄúWeb Site‚Äù it will not be possible to right-click on the ‚ÄúControllers‚Äù directory and select Add -&gt; Controller. </li></ul>  I spent some time trying to correct these shortcomings, until I came across an article where the author simply ignored them.  Therefore, I decided that the implementation of these two points would be a very costly process and so far we can do without them. <br><br><h4>  Foreword </h4><br>  Actually all the basics outlined <a href="http://www.dotnetbips.com/articles/f2a6ea8c-5aec-448d-8f45-566b257e4919.aspx">here</a> . <br>  In order not to duplicate existing articles on the Internet, I will not describe the following questions: how to start the IIS server, how to install MVC3, and how to use it. <br>  I will only briefly describe how the MVC library is added to an empty project, routes are created and a controller is added, which gives the results in JSON format.  That is, the minimum that will then allow you to use MVC capabilities in your ‚ÄúWeb Site‚Äù project will be considered. <br>  It is assumed that the project will be located on the local IIS server. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Creating a project </h4><br><ol><li>  Download and install MVC3. </li><li>  Before creating a project, you need to start the IIS server.  Create a new site there.  Register it in the hosts file. </li><li>  We open Visual Studio as an administrator (otherwise Visual Studio will not want to post and edit a project on the IIS server). </li><li>  Select File -&gt; New -&gt; Web Site -&gt; Installed Templates -&gt; Visual C # -&gt; Empty Web Site </li><li>  Choosing .NET Framework 4 </li><li>  Choosing Web Location: HTTP </li><li>  We register url to the site we click "OK" </li></ol><br><h4>  Project Setup </h4><br>  Open the "Solution Explorer".  Initially, we have only one file in the project: web.config. <br>  Add the Global.asax file, which will process all requests to the site: <br>  Right-click on the project in the "Solution Explorer".  Then the item "Add New Item ...".  Choose "Global Application Class". <br>  Since we are going to use the MVC 3 library, we will add it to the project: <br>  Provoi button on the project in the "Solution Explorer".  Then the item "Add Reference ...".  Find and add System.Web.Mvc version 3. <br>  Now if you open the web.config, then we will see that here it was registered.  To make this library available in web forms and in the Global.asax file, we add the following code to the "system.web" tag: <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pages</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">namespaces</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.Mvc"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.Routing"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">namespaces</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pages</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h4>  Route Setup </h4><br>  Open Global.asax and insert the following code into the Application_Start () function: <br><pre> <code class="cs hljs"> AreaRegistration.RegisterAllAreas(); RouteTable.Routes.IgnoreRoute(<span class="hljs-string"><span class="hljs-string">"{resource}.axd/{*pathInfo}"</span></span>); RouteTable.Routes.MapRoute( <span class="hljs-string"><span class="hljs-string">"Default"</span></span>, <span class="hljs-string"><span class="hljs-string">"{controller}/{action}"</span></span> );</code> </pre><br>  The important thing here is that in the URL you need to write the name of the class in place of the {controller}, but without the word ‚ÄúController‚Äù, and in place of {action} the class method. <br>  That is, if the URL is ‚Äúhttp://site.com/Employeer/List‚Äù, then the List method of the EmployeerController class will be called. <br><br><h4>  Creating a controller </h4><br>  Add a directory for the ‚ÄúApp_Code‚Äù classes: <br>  Right-click on the project in the "Solution Explorer".  Then the item "Add ASP.NET Folder".  Select "App_Code". <br>  In this directory, add the class EmployeeController.cs. <br>  The controller must inherit from the System.Web.Mvc.Controller class. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Web; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Web.Mvc; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmployeeController</span></span>:<span class="hljs-title"><span class="hljs-title">Controller</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ActionResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">List</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Json(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> {ID=<span class="hljs-number"><span class="hljs-number">123</span></span>,Name=<span class="hljs-string"><span class="hljs-string">"Name1"</span></span> }); } }</code> </pre><br><h4>  Controller start </h4><br>  Now, if everything is done correctly, and in the browser enter the address like "http://site.com/Employeer/List", then the server should give an error: <br>  GET request.  To allow GET requests, set JsonRequestBehavior to AllowGet. <br>  This means that there is some kind of protection so that json data can only be viewed from the current site.  You can disable this protection: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmployeeController</span></span>:<span class="hljs-title"><span class="hljs-title">Controller</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ActionResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">List</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JsonResult { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> {ID=<span class="hljs-number"><span class="hljs-number">123</span></span>,Name=<span class="hljs-string"><span class="hljs-string">"Name1"</span></span> } , JsonRequestBehavior = JsonRequestBehavior.AllowGet }; } }</code> </pre><br>  But it is better not to disable such protection, but to let the server understand that the request comes from the same site. <br>  To do this, create an index.html page, add jquery.js to the js folder and execute an ajax request using jquery. <br>  Index.html: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" /js/jquery.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> ddddfsf <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> $(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>)</span></span></span><span class="javascript">{ $.ajax({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">type</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"POST"</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">contentType</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"application/json; charset=utf-8"</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">dataType</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'json'</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">url</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">" /Employee/List"</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">success</span></span></span><span class="javascript">: </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">data</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{alert(data.ID+</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">","</span></span></span><span class="javascript">+data.Name);} }); }); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Now, if you enter the site address in the browser, the server should display the index.html page and then a window with the values ‚Äã‚Äãof the object will appear on the screen. <br><br><h4>  Conclusion </h4><br>  I hope this article will be useful for those who decide to use the MVC library on the Web site and maybe someone will save some time when creating their project. </div><p>Source: <a href="https://habr.com/ru/post/148565/">https://habr.com/ru/post/148565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148556/index.html">Twitter is laid</a></li>
<li><a href="../148557/index.html">Ability</a></li>
<li><a href="../148560/index.html">Resharper 7 released</a></li>
<li><a href="../148562/index.html">.NET events in detail</a></li>
<li><a href="../148564/index.html">Google Fiber launched in Kansas City - the cost and terms of the lightning internet</a></li>
<li><a href="../148566/index.html">Simple RegionManager</a></li>
<li><a href="../148567/index.html">Paymentwall Kiev Office</a></li>
<li><a href="../148569/index.html">"The bullet hit the wires ..."</a></li>
<li><a href="../148570/index.html">Pwnie Awards 2012 Winners Announced</a></li>
<li><a href="../148571/index.html">Flying ship or familiarity with SSD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>