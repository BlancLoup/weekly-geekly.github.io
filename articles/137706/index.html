<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Minimal program in ELF format</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inspired by the article Hi from the libc free world , I also decided to do something similar. In order not to do this aimlessly, I decided to set myse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Minimal program in ELF format</h1><div class="post__text post__text-html js-mediator-article">  Inspired by the article <a href="http://habrahabr.ru/blogs/programming/88101/">Hi from the libc free world</a> , I also decided to do something similar.  In order not to do this aimlessly, I decided to set myself the following task.  Make a program that outputs some simple line, like "ELF, hello!".  Understand exactly how it will be represented in the executable file.  Well, along the way, try to keep within 100 bytes. <br><a name="habracut"></a><br>  For starters, the standard helloworld in C ++ <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; using namespace std; int main() { cout &lt;&lt; "ELF, hello!\n"; return 0; }</span></span></span></span></code> </pre> <br>  Compile, look at the size: <br><br><pre> <code class="bash hljs">$ g++ test.cpp -static &amp;&amp; ls -s -h a.out 1,3M a.out</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How much how much  1.3 MB?  To output one single message size of 12 bytes?  Hmm ... Okay, let's try Si. <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"stdio.h"</span></span></span><span class="hljs-meta"> int main() { printf(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"ELF, hello!\n"</span></span></span><span class="hljs-meta">); return 0; }</span></span></code> </pre> <br>  We also compile it.  When compiling, I specified the option -static - I‚Äôm interested in the whole code, which will be executed.  With dynamic compilation, the dimensions are certainly smaller, but still not as much as we would like. <br><br><pre> <code class="bash hljs">$ gcc test.c -static &amp;&amp; ls -s -h a.out 568K a.out</code> </pre> <br><br>  On the floor a megabyte less.  Here it is, the fee for STL.  But still a lot.  Apparently, heavy artillery in the form of an assembler is indispensable.  We write helloworld on asm, and without stdlib.  I prefer the AT &amp; T syntax. <br><br><pre> <code class="hljs mel">.data str: .ascii <span class="hljs-string"><span class="hljs-string">"ELF, hello!"</span></span> .byte <span class="hljs-number"><span class="hljs-number">10</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">global</span></span> _start _start: movl $4, %eax movl $1, %ebx movl $str, %ecx movl $12, %edx <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> $0x80 movl $1, %eax movl $0, %ebx <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> $0x80</code> </pre> <br><br>  Two sections, in the data section - our message (and 10-ka for a new line), in the code section (.text) - we call the 80th interrupt twice (with the necessary parameters in the registers), the first time to display a message, second time for correct completion. <br><br>  We compile (or rather, broadcast and link) the created program: <br><br><pre> <code class="bash hljs">$ gcc easy.s -nostdlib &amp;&amp; du -sb a.out 752 a.out</code> </pre> <br><br>  752 bytes - this is already much closer to what is required.  Remove the debugging symbols with the strip utility: <br><br><pre> <code class="bash hljs">$ strip a.out &amp;&amp; du -sb a.out 476 a.out</code> </pre> <br><br>  Better, but still not enough.  What is in our file by as much as 476 bytes?  Disassemble a.out using objdump: <br><br><pre> <code class="bash hljs">$ objdump -D a.out a.out: file format elf32-i386 Disassembly of section .note.gnu.build-id: 08048094 &lt;.note.gnu.build-id&gt;: 8048094: 04 00 add <span class="hljs-variable"><span class="hljs-variable">$0x0</span></span>,%al ... - ,     ... 80480b6: b6 08 mov <span class="hljs-variable"><span class="hljs-variable">$0x8</span></span>,%dh Disassembly of section .text: 080480b8 &lt;.text&gt;: 80480b8: b8 04 00 00 00 mov <span class="hljs-variable"><span class="hljs-variable">$0x4</span></span>,%eax 80480bd: bb 01 00 00 00 mov <span class="hljs-variable"><span class="hljs-variable">$0x1</span></span>,%ebx 80480c2: b9 dc 90 04 08 mov <span class="hljs-variable"><span class="hljs-variable">$0x80490dc</span></span>,%ecx 80480c7: ba 0c 00 00 00 mov <span class="hljs-variable"><span class="hljs-variable">$0xc</span></span>,%edx 80480cc: <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> 80 int <span class="hljs-variable"><span class="hljs-variable">$0x80</span></span> 80480ce: b8 01 00 00 00 mov <span class="hljs-variable"><span class="hljs-variable">$0x1</span></span>,%eax 80480d3: bb 00 00 00 00 mov <span class="hljs-variable"><span class="hljs-variable">$0x0</span></span>,%ebx 80480d8: <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> 80 int <span class="hljs-variable"><span class="hljs-variable">$0x80</span></span> Disassembly of section .data: 080490dc &lt;.data&gt;: 80490dc: 45 inc %ebp 80490dd: 4c dec %esp 80490de: 46 inc %esi 80490df: 2c 20 sub <span class="hljs-variable"><span class="hljs-variable">$0x20</span></span>,%al 80490e1: 68 65 6c 6c 6f push <span class="hljs-variable"><span class="hljs-variable">$0x6f6c6c65</span></span> 80490e6: 21 0a and %ecx,(%edx)</code> </pre> <br><br>  And so, we see three sections, although we wrote only two.  In the .text section is our code.  In the data section, our elf hello is in the form of 12 bytes (objdump also disassembles them).  And what about the .note.gnu.build-id section?  We did not order it, so feel free to delete: <br><br><pre> <code class="bash hljs">$ strip -R .note.gnu.build-id a.out &amp;&amp; du -sb a.out 416 a.out</code> </pre> <br><br>  Won another 60 bytes.  Not bad.  Let's try to optimize our code a bit.  First, the program can in principle be terminated with any code, and not necessarily with zero.  Secondly, when you start the program, the registers are reset (however, you should not rely on it when creating real programs - check the ABI of the system for which you are writing). <br>  As a result, instead of movl $ 4,% eax, which is translated to 5 bytes, we can use movb $ 4,% al, which are translated to 2 bytes.  Thirdly, we‚Äôll get rid of the .data section by placing our line in the code after the last interruption (the program is no longer running anyway): <br><br><pre> <code class="hljs mel">.<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">global</span></span> _start _start: movb $4, %al movb $1, %bl movl $str, %ecx movb $12, %dl <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> $0x80 movb $1, %al <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> $0x80 str: .ascii <span class="hljs-string"><span class="hljs-string">"ELF, hello!"</span></span> .byte <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><br>  Compile, delete too much, look at the size: <br><br><pre> <code class="bash hljs">$ gcc -nostdlib easy.s $ strip a.out $ strip -R .note.gnu.build-id a.out $ du -sb a.out 320 a.out</code> </pre> <br><br>  It seems we have reached the limit.  320 bytes is nothing superfluous.  Or not?  Where do these 320 bytes come from?  Our code is clearly smaller.  However, besides the code in our binary file there is also an ELF header.  And if we want to make a truly minimal program, we will have to open the ELF description (for example, <a href="http://www.muppetlabs.com/~breadbox/software/ELF.txt">here</a> ), and form the title manually. <br><br>  Manually - this does not mean in the hex editor.  You can simply make it clear to the linker that we don‚Äôt need to attribute anything to our file, and it will output exactly what we write at the output.  True, in this case, the entire responsibility for ensuring that the file starts to fall on us. <br>  The implementation of the program with a manually compiled header I got this: <br><br><pre> <code class="hljs cs"> .<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ofs, <span class="hljs-number"><span class="hljs-number">0x10000</span></span> <span class="hljs-comment"><span class="hljs-comment">/* ofs -    */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* ELF : */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> <span class="hljs-number"><span class="hljs-number">0x7F</span></span> .ascii <span class="hljs-string"><span class="hljs-string">"ELF"</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* ident */</span></span> .word <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-comment"><span class="hljs-comment">/* type */</span></span> .word <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-comment"><span class="hljs-comment">/* machine */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* version */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> _start + ofs <span class="hljs-comment"><span class="hljs-comment">/* entry -    () */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> phdr <span class="hljs-comment"><span class="hljs-comment">/* phoff -    (phdr) ( ) */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* shoff */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* flags */</span></span> .word <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* ehsize -  elf  */</span></span> .word phdrsize <span class="hljs-comment"><span class="hljs-comment">/* phentsize -  .  */</span></span> .word <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">/* phnum -  . . */</span></span> .word <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* shentsize */</span></span> .word <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* shnum */</span></span> .word <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* e_shstrndx */</span></span> <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> phdr: .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">/* type */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* offset */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ofs <span class="hljs-comment"><span class="hljs-comment">/* vaddr -      (  ) */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* paddr */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> filesize <span class="hljs-comment"><span class="hljs-comment">/* filesz -     */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> filesize <span class="hljs-comment"><span class="hljs-comment">/* memsz -     */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-comment"><span class="hljs-comment">/* pflags */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* palign */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> phdrsize, . - phdr _start: <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> movb $<span class="hljs-number"><span class="hljs-number">4</span></span>, %al movb $<span class="hljs-number"><span class="hljs-number">1</span></span>, %bl movl $(str+ofs), %ecx movb $<span class="hljs-number"><span class="hljs-number">12</span></span>, %dl <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> $<span class="hljs-number"><span class="hljs-number">0x80</span></span> movb $<span class="hljs-number"><span class="hljs-number">1</span></span>, %al <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> $<span class="hljs-number"><span class="hljs-number">0x80</span></span> str: .ascii <span class="hljs-string"><span class="hljs-string">"ELF, hello!"</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> filesize, .</code> </pre> <br><br>  Now we also have to manually operate with the program offset.  By displacement, simply, you can understand the difference in addressing between the code that lies in our program and where it will be placed in RAM (in fact, in RAM, it will not lie there, but that's another story).  Usually the linker is involved in determining the required offsets, but now we are on our own.  The offset I placed in the ofs parameter.  The size of the offset took the minimum possible on my machine (10,000).  By default, it is 8048000, but this is not a prerequisite. <br><br>  The ELF header itself is not really one ELF header.  There should be at least two of them - the elf header, and the program header.  In general, there are more section headers, but we will not use them to save space.  Empirically, header fields that are used have been established.  The rest were filled with zeros. <br><br>  We are broadcasting the program, this time manually calling as and ld: <br><br><pre> <code class="bash hljs">$ as w3test.s -o w3test.o $ ld -Ttext 0 --oformat binary -o w3test w3test.o $ du -sb w3test 115 w3test</code> </pre> <br><br>  115 bytes!  ~ 10,000 times smaller than the original version.  It would seem that everything.  There is only the minimum necessary to run, and nothing more.  And the initial task to overcome 100 bytes will not succeed.  However, this is not the limit!  There are unused bytes in the header, which means that we can use them for our purposes.  The code itself unfortunately will not fit into any field, it is too big.  But the string will fit. <br><br>  If you look closely, then immediately after the ELF identifier we have three unused long fields (four bytes each).  This means that we can put a string there.  And besides, not the whole line, but only the last part of it, because we already have ELF in the form of ascii characters. <br><br>  In addition, we can reduce the code by placing the phd header not after elf, but immediately after the last byte used in ELF.  That is, the phd header will be slightly layered on elf, but this will not cause any consequences, since those fields that are layered are not used in elf. <br>  In the same way, we can place our program by ‚Äúlayering‚Äù it on the phd header (for the same reasons). <br><br>  The result is the following code: <br><br><pre> <code class="hljs cs"> .<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ofs, <span class="hljs-number"><span class="hljs-number">0x10000</span></span> <span class="hljs-comment"><span class="hljs-comment">/* ofs -    */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* ELF : 8*/</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> <span class="hljs-number"><span class="hljs-number">0x7F</span></span> str: .ascii <span class="hljs-string"><span class="hljs-string">"ELF"</span></span> .ascii <span class="hljs-string"><span class="hljs-string">", hello!"</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> .word <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-comment"><span class="hljs-comment">/* type */</span></span> .word <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-comment"><span class="hljs-comment">/* machine */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* version */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> _start+ofs <span class="hljs-comment"><span class="hljs-comment">/* entry -    () */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> phdr <span class="hljs-comment"><span class="hljs-comment">/* phoff -    (phdr) ( ) */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* shoff */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* flags */</span></span> .word <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* ehsize -  elf  */</span></span> .word phdrsize <span class="hljs-comment"><span class="hljs-comment">/* phentsize -  .  */</span></span> <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> phdr: .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">/* type */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* offset */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ofs <span class="hljs-comment"><span class="hljs-comment">/* vaddr -      (  ) */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* paddr */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> filesize <span class="hljs-comment"><span class="hljs-comment">/* filesz -     */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> filesize <span class="hljs-comment"><span class="hljs-comment">/* memsz -     */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-comment"><span class="hljs-comment">/* pflags */</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> phdrsize, . - phdr + <span class="hljs-number"><span class="hljs-number">4</span></span> _start: <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> movb $<span class="hljs-number"><span class="hljs-number">4</span></span>, %al movb $<span class="hljs-number"><span class="hljs-number">1</span></span>, %bl movl $(str+ofs), %ecx movb $<span class="hljs-number"><span class="hljs-number">12</span></span>, %dl <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> $<span class="hljs-number"><span class="hljs-number">0x80</span></span> movb $<span class="hljs-number"><span class="hljs-number">1</span></span>, %al <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> $<span class="hljs-number"><span class="hljs-number">0x80</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> filesize, .</code> </pre> <br><br>  After the broadcast, we get a program of 89 bytes.  You can consider the task completed. <br><br>  There was also an optimization idea - to put the phd header inside the elf header.  But this idea failed, since the minimum offset of 10,000 did not make it possible to select such parameters so that the required fields of the structures coincided. <br><br>  PS In the comments, an even more optimized version was proposed, 61 bytes in size, in which we managed to impose phd on elf.  Compiled using nasm / yasm with the -f bin option. <br><br><pre> <code class="hljs mel">BITS <span class="hljs-number"><span class="hljs-number">32</span></span>; ORG <span class="hljs-number"><span class="hljs-number">05430000</span></span>h; DB <span class="hljs-number"><span class="hljs-number">0x7F</span></span>, <span class="hljs-string"><span class="hljs-string">"ELF"</span></span>; DD <span class="hljs-number"><span class="hljs-number">01</span></span>h, <span class="hljs-number"><span class="hljs-number">00</span></span>h, $$; DW <span class="hljs-number"><span class="hljs-number">02</span></span>h, <span class="hljs-number"><span class="hljs-number">03</span></span>h; DD @main; DW @main - $$; @main: INC EBX; DB <span class="hljs-number"><span class="hljs-number">05</span></span>h; &lt;-- ADD EAX, DD <span class="hljs-number"><span class="hljs-number">04</span></span>h; &lt;-- LONG(<span class="hljs-number"><span class="hljs-number">04</span></span>h) MOV ECX, @text; MOV DL, <span class="hljs-number"><span class="hljs-number">12</span></span>; INT <span class="hljs-number"><span class="hljs-number">80</span></span>h; AND EAX, <span class="hljs-number"><span class="hljs-number">00010020</span></span>h; XCHG EAX, EBX; INT <span class="hljs-number"><span class="hljs-number">80</span></span>h; @text: DB <span class="hljs-string"><span class="hljs-string">"ELF, hello!"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>Ah;</code> </pre> <br><br><h4>  Information sources </h4><br>  <a href="http://ru.wikibooks.org/wiki/%25D0%2590%25D1%2581%25D1%2581%25D0%25B5%25D0%25BC%25D0%25B1%25D0%25BB%25D0%25B5%25D1%2580_%25D0%25B2_Linux_%25D0%25B4%25D0%25BB%25D1%258F_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2581%25D1%2582%25D0%25BE%25D0%25B2_C">wikibooks.org</a> - Linux Assembler for C Programmers <br>  <a href="http://stackoverflow.com/questions/284797/hello-world-in-less-than-20-bytes">stackoverflow.com</a> - ‚ÄúHello World‚Äù in less than 20 bytes <br>  <a href="http://www.muppetlabs.com/~breadbox/software/tiny/teensy.html">muppetlabs.com</a> - Teensy ELF Executables for Linux </div><p>Source: <a href="https://habr.com/ru/post/137706/">https://habr.com/ru/post/137706/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137700/index.html">An elderly woman replaced her own jaw with a prosthesis made on a 3D printer</a></li>
<li><a href="../137701/index.html">Data centers: who is in that much</a></li>
<li><a href="../137702/index.html">Translation of the article ‚ÄúPimp my Pimpl‚Äù, part 2</a></li>
<li><a href="../137704/index.html">Pitfalls in Project Voldemort</a></li>
<li><a href="../137705/index.html">CSS3. Work with multiple backgrounds</a></li>
<li><a href="../137707/index.html">Improving pictures in Skype chat (updated)</a></li>
<li><a href="../137708/index.html">Streaming audio</a></li>
<li><a href="../13771/index.html">The world is in search of a forgetful blonde</a></li>
<li><a href="../137710/index.html">Profiling module "ProfilerToolbar"</a></li>
<li><a href="../137711/index.html">New iOS 5 File Policy and Wacker History</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>