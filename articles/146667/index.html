<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We put Google Play Store on a virtual device with Jelly Bean (API 16)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I was always confused by the ways of installing the market circulating on the Internet: download something from somewhere, run some scripts. Everythin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We put Google Play Store on a virtual device with Jelly Bean (API 16)</h1><div class="post__text post__text-html js-mediator-article">  I was always confused by the ways of installing the market circulating on the Internet: download something from somewhere, run some scripts.  Everything can be done much easier and safer. <br><br>  Immediately I will warn you that the described method does not work on API 15, the application market does not download it, although it is installed. <br><br>  First, a brief description of the procedure: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  create a virtual device based on the Google API image; </li><li>  we start the device emulator in a shaman way; </li><li>  remove the "extra" packages; </li><li>  we get a package with a market from an existing phone via a USB cable; </li><li>  we download the package with the market; </li><li>  final shamanism. </li></ul><br><br>  Everything happens in Linux, but in other operating systems everything is absolutely the same. <br><a name="habracut"></a><br>  First you need to update the SDK Tools and Platform Tools to the latest version, so that images with API 16 appear in the list of available platforms. <br><br><h5>  Create a virtual device based on the Google API </h5><br>  Select in the <i>Target</i> field the value of <b>Google APIs (Google Inc.) - API Level 16</b> .  In the <i>Hardware</i> section we type the necessary elements. <br><br><img src="https://habrastorage.org/storage2/4d4/b64/c76/4d4b64c769e27dc5330c6d66985cf2f6.png"><br><br>  Why based on google api?  And everything is simple - in this image there are already necessary packages for the work of the Play Store (google services framework, for example) and they do not need to be searched somewhere and installed by shamans. <br><br><h5>  Run the device emulator in a shamanic way </h5><br>  Run the resulting image (shamanism is already beginning here; we assume here and hereafter that the SDK is installed in the <code>~/android/android-sdk-linux</code> directory; the virtual is called <code>test-4.1</code> ) <br><br><pre> <code class="bash hljs">% ~/android/android-sdk-linux/tools/emulator -avd <span class="hljs-built_in"><span class="hljs-built_in">test</span></span>-4.1 -partition-size 250 -no-snapstorage</code> </pre> <br><br>  This command starts a virtual device, whose system partition size is increased to 250 MB, if this is not done, there will be no empty space on the partition at all. <br><br>  Now we will remount the system partition for writing and at the same time make sure that we have remounted: <br><br><pre> <code class="bash hljs">% ~/android/android-sdk-linux/platform-tools/adb -e remount remount succeeded % adb -e shell mount|grep /system /dev/block/mtdblock0 /system yaffs2 rw 0 0</code> </pre> <br><br>  I always use the <code>-e</code> argument when calling adb so that the requests go immediately to the emulated device. <br><br><h5>  Remove the "extra" packages </h5><br>  By default, on a virtual device there are several several harmful packets that interfere with normal operation, in this case it is <code>LicenseChecker.apk</code> and <code>SdkSetup.apk</code> , we will remove them: <br><br><pre> <code class="bash hljs">% adb -e shell rm /system/app/SdkSetup.apk /system/app/LicenseChecker.apk</code> </pre> <br><br><h5>  We get a package with a market from an existing phone via a USB cable </h5><br>  Now you need to get a package with the market, for this will fit any android-phone, where this market is installed.  We turn on USB debugging on the phone, connect the phone with a cable to the computer and start shamanism.  First you need to find where the package with the market is, it's simple: <br><br><pre> <code class="bash hljs">% adb -d shell pm list packages -f | grep vending package:/data/app/com.android.vending-1.apk=com.android.vending</code> </pre> <br><br>  Here it is, my <code>/data/app/com.android.vending-1.apk</code> : <code>/data/app/com.android.vending-1.apk</code> .  We download it into the current directory (the -d key is used to designate a real device, not an emulator, this is convenient, you do not need to specify the id-device with each call): <br><br><pre> <code class="bash hljs">% adb -d pull /data/app/com.android.vending-1.apk . 7563 KB/s (4000309 bytes <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.516s)</code> </pre> <br><br>  This method should work on any, even non-ruled phone.  And yes, this way you can extract any packages from your phone. <br><br><h5>  We download the package with the market </h5><br>  Download the apk-package on the phone: <br><br><pre> <code class="bash hljs">% adb -e push com.android.vending-1.apk /system/app 3353 KB/s (4000309 bytes <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 1.164s)</code> </pre> <br><br><h5>  Final shamanism </h5><br>  The package on the virtual device is flooded, it remains to be done now so that the next time it starts it will not fly off.  This is also simple: the emulator creates a copy of the system partition in the directory with temporary files each time it starts: <br><br><pre> <code class="bash hljs">% ls -l /tmp/android-<span class="hljs-variable"><span class="hljs-variable">$USER</span></span> total 191072 -rw------- 1 cancel cancel 195680988  28 12:35 emulator-dHRHv0 srwxr-xr-x 1 cancel cancel 0  28 12:21 qemu-gles-22468</code> </pre> <br><br>  Here it is, in the <code>emulator-dHRHv0</code> (you‚Äôll have it called differently, but it will be in the same directory), just copy it to the virtual device directory under the name <code>system.img</code> : <br><br><pre> <code class="bash hljs">% cp /tmp/android-<span class="hljs-variable"><span class="hljs-variable">$USER</span></span>/emulator-dHRHv0 ~/.android/avd/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>-4.1.avd/system.img</code> </pre> <br><br>  Now the device is nailed and launched in the usual way: <br><br><img src="https://habrastorage.org/storage2/f5f/3a4/931/f5f3a49310827717194a1e70fae0c8b4.png"><br><br>  Market icon top right.  Enjoy </div><p>Source: <a href="https://habr.com/ru/post/146667/">https://habr.com/ru/post/146667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146659/index.html">Robot wins in stone-paper-scissors in 100% of cases</a></li>
<li><a href="../146660/index.html">Hone Bluetooth Dongle helps keep your keys safe.</a></li>
<li><a href="../146662/index.html">Screencast: Introducing Codeception</a></li>
<li><a href="../146663/index.html">Kerio Operator Configuration</a></li>
<li><a href="../146665/index.html">Anatomy of old tube electronics</a></li>
<li><a href="../146669/index.html">Oversun-Scalaxy - hemorrhoids every month!</a></li>
<li><a href="../146670/index.html">Cloud video processing in CDN</a></li>
<li><a href="../146672/index.html">Twitter bots create events internationally</a></li>
<li><a href="../146673/index.html">Pynba - pinba for python</a></li>
<li><a href="../146674/index.html">More than usability: four components of User Experience</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>