<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic update of IP phones in 3CX. Part two. Practice</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In continuation of the first article: Automatic update of IP phones in 3CX. Part one. The theory , as promised, will tell you how it all works in prac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic update of IP phones in 3CX. Part two. Practice</h1><div class="post__text post__text-html js-mediator-article">  In continuation of the first article: <a href="http://habrahabr.ru/company/3cx/blog/258381/">Automatic update of IP phones in 3CX.</a>  <a href="http://habrahabr.ru/company/3cx/blog/258381/">Part one.</a>  <a href="http://habrahabr.ru/company/3cx/blog/258381/">The theory</a> , as promised, will tell you how it all works in practice. <br><br>  So, when an IP phone is connected to the local network, the IP phone sends a broadcast request (SIP NOTIFY) and reports its MAC address and current location: <br><a name="habracut"></a><br><img src="https://habrastorage.org/files/dc9/3e5/807/dc93e58072424432a9ccd5bfe919fe12.jpg" alt="image"><br><br>  what the 3CX server responds to and after the IP phone appears in the 3CX system in the ‚ÄúPhones‚Äù section with the ‚ÄúNew‚Äù status: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/39d/96c/e1e/39d96ce1e2bb4aba86f17f71ae51e400.jpg" alt="image"><br><br>  Further, there may be two scenarios. <br><br>  <b>Scenario 1. Manual configuration</b> <br><br>  The point is that the IP phone is new, previously we knew nothing about it and the IP phone was simply added to the park of phones.  Our task is to assign it an internal number in the system and tighten the general settings pattern for phones of this type. <br><br>  To do this, click on the phone from the list with the right mouse button and select one of the items from the drop-down list: <br><br><img src="https://habrastorage.org/files/32c/bd8/f8f/32cbd8f8f2884b8892cf64def46935e4.jpg" alt="image"><br><ul><li>  Add extension number - a new number is created </li><li>  Assign existing extension number ‚Äî select one of the existing extension numbers. </li></ul><br>  If we select the first item, the menu for adding an extension will open: <br><br><img src="https://habrastorage.org/files/aae/e6e/41f/aaee6e41fc914db6803f6234f3db944c.jpg" alt="image"><br><br>  Enter user data and go to the tab "Autotune phone" <br><br><img src="https://habrastorage.org/files/82a/712/8e8/82a7128e8a1d4e4fa4493300ba408225.jpg" alt="image"><br><br>  The system automatically filled in the fields: MAC address and Model, then there are individual settings for this IP phone, where we can change: <br><ul><li>  Password to access the web interface </li><li>  The language on the screen is convenient if you have a multilingual company. </li><li>  Time zone - again, employees can work remotely and in different time zones </li><li>  Autotune method - user local or remote </li><li>  Interface - where the phone should go to check for updating configuration files (depending on local or remote user) </li><li>  Set codec priority </li></ul><br>  In the same menu, a BLF list is set for a specific user: <br><br><img src="https://habrastorage.org/files/946/e32/2eb/946e322eb167470abd114e606de584d8.jpg" alt="image"><br><br>  Those.  we add the extension numbers that the user should or can track. <br><br>  Next, click on the save button and the configuration file with all the individual settings, goes to the IP phone. <br><br><img src="https://habrastorage.org/files/08e/3a5/055/08e3a50554524c93ba03dad68b07931a.jpg" alt="image"><br><br>  From the log you can see that the phone is registered and subscribed to the BLF, which we wrote to it: <br><br><img src="https://habrastorage.org/files/643/ee9/fc0/643ee9fc05e44e09ade8668617df1d5d.jpg" alt="image"><br><br>  In addition, if you pay attention, the system automatically registers the old code set in 3CX (* 20 *) to capture the call. <br><br>  If you select the second item - Assign to an existing internal number, the previously created number is selected with all the settings and simply saved: <br><br><img src="https://habrastorage.org/files/22c/028/53d/22c02853d6cf4521b2ae9a5b75b844df.jpg" alt="image"><br><br>  After that, the phone will perform the same actions. <br><br>  <b>Scenario 2. Automatic update or pre-create a virtual park of phones.</b> <br><br>  In order to automate the process as much as possible in the future, one way or another, at the beginning it will be necessary to build on individual settings for each IP phone + a template for each model. <br><br>  So, the task: we have new IP phones, we know to whom which IP phone should be installed and accordingly we have all the data to configure (MAC address, extension number, etc.). <br><br>  To solve the problem, we need to create a common template for the model, where we enter general data, plus for convenience, we indicate that the IP phone will contact our server every day at a given time and check for changes in the configuration file.  This is done by means of a checksum, the IP phone sends a request, receives a response from the server, checks the checksum, and if it is different from the current one in the IP phone, the new configuration file will be uploaded. <br><br><img src="https://habrastorage.org/files/ac9/bbe/26d/ac9bbe26d09c4a82a512d5c63d91d15a.jpg" alt="image"><br><img src="https://habrastorage.org/files/d72/3c2/d7e/d723c2d7e38b43fdbfb30438b176efbf.jpg" alt="image"><br><br>  Save the template. <br><br>  Next, go to the "Internal numbers" section and create numbers with binding to the MAC address + individual settings: <br><br><img src="https://habrastorage.org/files/177/e13/9fc/177e139fcde843d38686c79b9e538b67.jpg" alt="image"><br><br>  As you can see in the screenshot, all the fields are empty and must be filled in: <br><ul><li>  MAC address - specify the MAC address of the IP phone </li><li>  Model - choose the model of the desired IP phone </li></ul><br>  And then the general settings. <br><br>  What is the difference between Scenario 1 and Scenario 2?  The only difference is that by creating a new fleet of phones, you get rid of unnecessary work - unpacking the phone, connecting to the network, catching it in the system, making the settings, after packaging or immediately attributed to the user on the table and so on for each device. <br><br>  Scenario 2 makes it possible to save time on this, since all we need to know from the IP phone is the MAC address, and it is usually written on the box itself.  And further, you can simply give the phone to an employee who sets it on his desk and after connecting the IP phone to the network, the IP phone automatically (without additional intervention) receives all the settings that we created earlier. </div><p>Source: <a href="https://habr.com/ru/post/259119/">https://habr.com/ru/post/259119/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259107/index.html">Centos-admin.ru: learn Ansible</a></li>
<li><a href="../259111/index.html">We connect Microsoft Azure and a cloud of service provider in a uniform network</a></li>
<li><a href="../259113/index.html">STB - dive</a></li>
<li><a href="../259115/index.html">Hyper-v Server 2012R2: installation and configuration experience</a></li>
<li><a href="../259117/index.html">"Jetpack" is not so reactive, or how to do without it</a></li>
<li><a href="../259121/index.html">Little tricks of passport collection</a></li>
<li><a href="../259123/index.html">Android M and Developer Tools</a></li>
<li><a href="../259125/index.html">Lectures Technopark. Semester 2 Java</a></li>
<li><a href="../259127/index.html">My Internet of Things: Guest Castle</a></li>
<li><a href="../259129/index.html">Positive Hack Days V WAF Bypass Contest</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>