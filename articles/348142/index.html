<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The history of hacking a single WordPress plugin - or how you allow vulnerabilities in your projects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A long time ago, when I was young and wrote websites in PHP, I wrote an SEO plugin to disguise external links for Wordpress. Since my imagination is b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The history of hacking a single WordPress plugin - or how you allow vulnerabilities in your projects</h1><div class="post__text post__text-html js-mediator-article">  A long time ago, when I was young and wrote websites in PHP, I wrote an SEO plugin to disguise external links for Wordpress.  Since my imagination is bad, I called it WP-NoExternalLinks.  In the entire history he had 360.000 installations and, it seems, up to 50.000 active installations. <br><br>  Then I will tell you exactly how he got into unscrupulous hands and was used maliciously - but for this you have to dive a little into his history and development environment.  Immediately warn you that this story is absolutely real. <br><img src="https://habrastorage.org/webt/ll/2e/qv/ll2eqvounxfb1if1k20qmenuwqy.jpeg"><br><a name="habracut"></a><br><h3>  Story </h3><br>  Only at first glance it seems that the task of the plug-in is elementary - in fact, it was necessary to implement a bunch of different masking options, take care that it worked with caching plugins, did not conflict with other content parsers, any permalink structures, each new version of Wordpress, and so Further.  For about 8 years, I supported this plugin, responded to a bug report and sometimes debugged other sites, the gullible owners of which voluntarily gave me all the passwords and turnout. <br><br>  At some point, it became clear to me that I have not solved the plugin for many years, I‚Äôm not interested in supporting its code, but I don‚Äôt get anything from its development.  For reference, I will clarify that in the description and on the settings page of the plug-in there were unobtrusive links and buttons with the offer to make a voluntary donation - but in the entire history of the plug-in I received around $ 40.  So there was no monetary motivation, development motivation, too, and somehow rather tired that every user for some reason thinks you owe him, since he did install your program or plug-in (it seems many users really think that as soon as they put the program, some kind of cloud spirit gives the developer a bag of money). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is not to say that the world is unfair, and I poured bitter tears of offense - just to make it clear that for several years I supported this plugin only from the strange feeling that users trusted me and I cannot deceive them and stop supporting them.  When I look back at these feelings now, I understand that it was a stupid feeling, and I had to calmly bury the plug-in and go about my business.  But this is a sensation of me from 2018 - with the advent of two children, priorities change quite a lot. <br><br><img src="https://habrastorage.org/webt/jz/ol/m0/jzolm0_yt820y2b18pkm98ut1ym.png"><br><br><h3>  Sale </h3><br>  And at some point a certain citizen came, who offered me a good amount of money for the purchase of a plug-in.  Honestly, I was sure that it was some kind of kidalovo, and communicated with him exclusively out of curiosity (well, like with all sorts of Nigerian princes).  Skepticism left when we agreed to use one trusted service for this kind of transactions.  It was already interesting here - there was a feeling that they would pay me, but I suspected that some kind of vulnerability would quickly appear in the plugin, and therefore I specially prepared a letter to the wordpress support team to instantly block the plugin.  But by that time, I almost believed that the plugin really wanted to be purchased to expand the portfolio of a company that is engaged in SEO optimization (this was exactly the motivation that was explained to me). <br><br>  And you know what happened next?  Then I honestly received the money transferred, and a few days later a major update came to the plugin, in which the interface was completely changed and the codebase was reworked (but compatibility was left) - so it became more like code from 2017, rather than 2010 (above this worked as a developer at least Middle level).  I was terribly pleased - I found interested people who would support my toy, and who had already brought a lot of good into it, pleasing the users of the plugin. <br><br>  Nevertheless, I watched the plug-in's code and updates for two weeks, keeping my finger on sending a letter to the wordpress team just in case.  But everything was fine and I calmed down. <br><br><img src="https://habrastorage.org/webt/8f/m-/op/8fm-opvlqekihlbpnhqzdzyomfu.png"><br><br><h3>  Vulnerability </h3><br>  I would like to stop at this place and end it as a success story, but alas.  A few months later, the guys from a third-party wordpress security project contacted me and told me that there was a backdoor in the plugin, and they were interested in the details of how I transferred the rights to it to a new developer.  After checking, I made sure that the plugin is really blocked on the wordpress site.  Next, I corresponded with wordpress support, the brief results are as follows: <br><br><ul><li>  They took from me all the information that might help in the incident; </li><li>  They didn‚Äôt want to tell me about the vulnerability for a long time, and had to look for it myself; </li><li>  My desire to help was ridiculed, and I was scolded with all sorts of bad words for the fact that I ‚Äúsold the plugin to the spammer‚Äù and ‚Äúloaded them with work‚Äù (literal quotes); </li><li>  After some time, wordpress employees themselves fixed the bookmark and sent it to me for a review (at least one positive point); </li><li>  The plug-in will remain blocked, and they will not transfer rights to it. </li></ul><br>  By the way, the bookmark turned out to be not an evil backdoor, but simply added some SEO links to unsuspecting users.  Unpleasant, but not as fatal as it could be. <br><br>  According to the results of communication: <br><ul><li>  A lot of time was spent to eliminate the vulnerability due to the reluctance to cooperate with the technical support of wordpress </li><li>  Wordpress forever lost one of the plugins and a developer who will no longer be there to publish and update anything.  It is unlikely that someone will regret it, but nonetheless. </li></ul><br><br>  <b>UPD.</b>  At the request of those who have a plugin - a ‚Äútab‚Äù is in the versions of the plugin 4.2.0 - 4.2.2.  Version 4.3 was fixed by wordpress support, versions before 4.0 were mine, and in versions 4.0.0 - 4.1.0, the ‚Äúbookmark‚Äù was not added yet.  Most likely, your blog has already updated the plugin to secure version 4.3. <br><br><h3>  findings </h3><br>  For me, the most interesting questions were ‚Äúwould I sell this plugin if I knew that it would be used maliciously?‚Äù And ‚Äúwould I do it again if I had an opportunity?‚Äù.  On the one hand, I would like to believe that no.  On the other hand, in fact, I have a choice between ‚Äúkeeping loyalty to people who did not even say thank you for using the results of my work‚Äù or ‚Äúgo on vacation with the children with the sea‚Äù.  Well I do not know.  The temptation is serious. <br><br><img src="https://habrastorage.org/webt/4s/ox/a0/4soxa0ditqpbpngxspqlr19b0d4.jpeg"><br><br>  You can say that there are some reputational risks for me here, but ... I am not a company that can be dishonored all over the Internet.  And I am not an icon of the development world, I am just one of the millions of developers who occasionally write something in open source.  And to be honest - you can not lose a reputation that does not exist.  It's amazing that after the sale of the plug-in at least one resource connected my name with it.  So - no reputation toffee. <br><br>  Separately, I note that, in the case when the risks relate to my commercial activity, the picture here is completely different.  At my job I get paid money, and I have certain obligations.  Repeatedly I received various offers of dubious nature, and I did not accept one ‚Äî even when I knew that my intervention or data transfer could not be traced.  Before commercial projects there is a completely different degree of responsibility - and, oddly enough, not only because they pay me money there, and because I signed 100,500 pieces of paper there.  First of all, I feel responsible because they value me there, trust me, and this is shown.  Therefore, I cannot betray the trust shown.  And, returning to open source ... Here the picture is completely different.  For example, in addition to plug-ins, I still have mobile apps.  They are supported on several resources, including on w3bsit3-dns.com.  And usually the user (I have several thousand of them) goes there to leave a message like ‚Äúturd doesn‚Äôt work‚Äù (literal quotation).  Well ... When the pull request comes to me after this with updating the binaries from the application dependencies, it is very difficult for me not to score on it or not to accept it blindly, but instead to rebuild it again with my own hands and put a new release. <br><br><h4>  Remember - no one owes you anything </h4><br>  I repeat - my goal is not to complain about how bad everything is, but just to remind you that in open source no one owes anything to anyone.  And you need to take care of the security of any third-party components that you use.  Starting from the physical server, where your projects are spinning (if you have an ‚Äúacquaintance‚Äù, then anything is possible), continuing with front-line and back-end components, plug-ins, frameworks, CMS, and so on.  And all the problems in the world are not solved by ‚Äúentering card data into an iframe‚Äù, as suggested in a recent article. <br><br><h4>  What to do </h4><br>  What can you do besides watch your safety?  At a minimum, you can be more responsible about the fact that you use the work of other developers.  See what you are actively using right now.  Buy a license for a broken web site two years ago.  Pay for the cleverly obtained template that you used in a large order.  Set up automatic redemption in favor of web developers.  Stop already in each post of PVS Studio to write about how you heroically remove comments from your code in order to use this tool for free.  Donate already $ 5 to the Android developer KeePass - he only asks for this on major holidays. <br><br>  If there is no money, go to the issues and tell us about the problem, or send your pull request.  Remember the error that you have in exotic conditions, repeat it and describe to the developer.  Make a pull request from your fork, in which you fixed some kind of bug, and this fix is ‚Äã‚Äãjust left with you. <br><br>  If you have neither the money nor the opportunity to participate in the development - just go and say "thank you" to the developer.  This, as you know, you will not be full - but even this pleases the developer and sometimes is an incentive to continue working.  It's amazing that in oral communication it is customary to thank for what they are doing for you - but this rule is rarely used in open source development. <br><br><img src="https://habrastorage.org/webt/0f/ej/g9/0fejg982gzjcatgzs32d58nra2y.jpeg"><br><br>  By the way, these rules apply not only to development.  You can also take a rule - I liked the book read from torrents - buy it.  Like music - take part in the crowdfunds of the new album.  It seems to be so simple, but very few people do it.  Let's help each other and the world will be better.  And safer. <br><br>  As for what you can do as a developer, immediately think about how to support your project.  Maybe you can figure out how to get other developers involved.  Or offer additional services - for example, support and debugging for a fixed price, or Enterprise solutions based on your project.  For example, if I took at least $ 10 for supporting a plugin on user sites, then maybe I would have a good income that would allow not to sell the plugin and continue to develop it.  Many consider the monetization of the project to be something bad and initially smelly, but in the end it only allows you to devote a lot of time to the project and take care of its quality. <br><br>  I apologize for having spent so much of your time reading very obvious things - just experience shows that their obviousness doesn‚Äôt affect their application.  And this plugin case made me think a lot.  I hope you also found it interesting and useful. </div><p>Source: <a href="https://habr.com/ru/post/348142/">https://habr.com/ru/post/348142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348132/index.html">From Amazon EC2 to Mail.ru Infra: Test Cloud VPS (Linux)</a></li>
<li><a href="../348134/index.html">Chromium: other errors</a></li>
<li><a href="../348136/index.html">The most correct implementation of splash screen</a></li>
<li><a href="../348138/index.html">Isometric depth sorting for moving platforms</a></li>
<li><a href="../348140/index.html">Four ways to fool a deep learning neural network</a></li>
<li><a href="../348148/index.html">Road to War: AI Total War Series Games</a></li>
<li><a href="../348150/index.html">How we launched the offline version of the site RG.RU</a></li>
<li><a href="../348152/index.html">WebRTC and Electron: Trend for Desktop Applications</a></li>
<li><a href="../348156/index.html">Mathematical model of snobbery</a></li>
<li><a href="../348158/index.html">What habits make me better as a software developer?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>