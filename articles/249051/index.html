<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Do not use MediaPlayer and MediaMetadataRetriever in Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As my humble experience shows, the native MediaPlayer, MediaMetadataRetriever, as well as other classes that are based on them in one way or another (...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Do not use MediaPlayer and MediaMetadataRetriever in Android</h1><div class="post__text post__text-html js-mediator-article">  As my humble experience shows, the native MediaPlayer, MediaMetadataRetriever, as well as other classes that are based on them in one way or another (VideoView, ThumbnailUtils, for example), are extremely unreliable to use.  Perhaps the problem is that they are implemented natively, and change from version to version, but the fact remains that their behavior on different devices is impossible to predict, and it does not even depend on the power of the iron. <br><a name="habracut"></a><br>  A good example was a small project where video playback was required.  The format and codec could be chosen any, I conducted tests on mp4 and avi with different codecs.  On all devices that came to hand, the reproduction went smoothly and without censure.  Older devices and OS versions &lt;4.0 were not required to be supported, and I thought that there would be no problems with these formats.  Then on HTC desire V it was found that several videos are not played, the built-in player in the gallery too.  There was a thought that the device was rather weak, but the surprise was that almost no test videos were played on the Nexus 5.  I couldn‚Äôt find any regularity - even with the same codecs, one file could be read, and the other could not.  The files were not damaged, so sin remained only on the VideoView with the MediaPlayer inside. <br><br>  Fortunately, there were good alternatives that work not only more reliably, but also faster: <br><br><ul><li>  FFmpeg library.  You can compile it yourself using Android NDK.  Well, but the disadvantages of this approach are obvious - you need to deal with the NDK, build it, and you can only do it under Linux.  To this I did not want to waste time. </li><li>  FFmpegMediaPlayer.  Actually, it is based on the first library, but you do not need to build, and an interface is already provided that is completely analogous to the native MediaPlayer.  Purely for verification, I tried to use it, but for some reason the video was not drawn on the SurfaceView, while the exact same code, but with the native MediaPlayer worked without problems.  Perhaps it was my cant, but I could not find a quick solution. <br>  (UPD: As noted in the comments, this library is for audio only) </li><li>  Vitamio.  Also takes as a basis FFmpeg and also provides ready-made assembly.  It also has its own VideoView and MediaMetadataRetriever, with an interface like the one from the Android SDK, which greatly simplifies life when creating a player.  It is possible to use your FFmpeg builds, supports OS 2.1+ and almost all formats.  I stopped at this library, there were no problems with it.  Please note that the build does not initially have a build for x86.  It is also worth expecting that your APK grows over a megabyte of ~ 8 with this library. </li><li>  There are other options, most of them use the same FFmpeg, but Vitamio completely arranged for me. </li></ul><br>  In general, I highly recommend not using standard classes, even for small projects and ‚Äúnormal‚Äù common video / audio formats.  Someone may disagree and say that everything works well for him.  Here you can only advise on testing more files and devices ... using Genymotion, for example. </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/249051/">https://habr.com/ru/post/249051/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249037/index.html">Scan and index pages in multiple languages</a></li>
<li><a href="../249039/index.html">How I implemented multilingualism on the site and in the project</a></li>
<li><a href="../249041/index.html">YouTube abandoned Flash in favor of HTML5 by default.</a></li>
<li><a href="../249045/index.html">C # for AS3 developers. Part 4: Abstract Classes and Functions</a></li>
<li><a href="../249047/index.html">Sass-architecture of your project</a></li>
<li><a href="../249053/index.html">How virtual reality came to the project on Unity</a></li>
<li><a href="../249055/index.html">Universal way to monitor Asterisk using Zabbix</a></li>
<li><a href="../249057/index.html">What should be said instead of ‚Äúfool himself!‚Äù Or 4 stories about the power of one question</a></li>
<li><a href="../249061/index.html">(Kiev) Recruitment for the course ‚ÄúIT-Project Management IT.Projects‚Äù using PMBOK standards</a></li>
<li><a href="../249063/index.html">(Kiev) In March, the Linux troubleshooting course starts.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>