<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New cloud storage feature: creating links to download files</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So, a new feature has appeared in our cloud storage: creating download links. Having created such a link, you can send it to any third-party user so t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New cloud storage feature: creating links to download files</h1><div class="post__text post__text-html js-mediator-article"><img alt="storage-sharing" src="https://habrastorage.org/getpro/habr/post_images/c4a/d68/da2/c4ad68da281a96d7cfa087472d8e5118.png" width="715" height="536"><br><br>  So, a new feature has appeared in our cloud storage: creating download links.  Having created such a link, you can send it to any third-party user so that he uploads his files to you - absolutely free.  It is not even necessary for this user to have an account in the repository. <br><br>  This function can be useful for solving a variety of tasks, for example: <br><ul><li>  to provide any users with access to your repository: for example, friends will be able to upload their photos, audio and video records for you, colleagues and partners - various working materials, etc. </li><li>  to upload custom content to sites; </li><li>  to facilitate file sharing between members of the thematic online communities; </li><li>  for quick backup backup. </li></ul><br><a name="habracut"></a><br><h2>  Prehistory </h2><br>  Recently, I participated in climbing Elbrus.  All members of the group, including me, had cameras with them.  Many interesting and beautiful photographs were made, and after the hike the question arose: how to make them available to all participants? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Someone offered to upload all pictures on VKontakte or on Facebook, someone on Mail.Ru, someone on other file sharing sites ... But all the listed services did not suit us: first, there are restrictions on the size of the downloaded files;  secondly, not all members of the group were registered on these services. <br><br>  I proposed a simple and easy-to-use solution: I created a public container in the Selectel cloud storage, turned on the file listing option.  Then he created a link by clicking on which everyone could upload their own photos into the container, as well as download photos taken by other participants.  At the same time, none of the group members needed to create an account in the vault.  So a new feature of our cloud storage was tested - creating a link to download files by third-party users.  My comrades in climbing Elbrus rated it as ‚Äúexcellent‚Äù. <br><br>  Today we present this feature to a wide audience.  We hope that all our users will appreciate it. <br><br><h2>  Link creation </h2><br>  Let's look at the simplest example of how the new function works.  Create a special container for downloading files and name it, for example, share.  Then open the container menu and select the ‚ÄúFile Download Link‚Äù option: <br><br><img alt="uploadlink-001" src="https://habrastorage.org/getpro/habr/post_images/d37/34b/ea2/d3734bea225ac4f525ae1bd15cd0d42a.png" width="784" height="372"><br><br>  The link settings window will open: <br><br><img alt="uploadlink-002" src="https://habrastorage.org/getpro/habr/post_images/6a2/190/fdf/6a2190fdf20a85297d9153aecba50d1e.png" width="718" height="688"><br>  In this dialog box, you can set the following parameters (more on some of them will be discussed below): <br><ul><li>  select link type; </li><li>  enter explanatory text for users to whom you send the download link (the explanatory text will be displayed in the subtitle at the top of the download page); </li><li>  set a password for downloading files; </li><li>  set limits on the maximum size of files uploaded to the repository; </li><li>  limit the duration of the link, as well as the shelf life of downloaded files; </li><li>  enable / disable overwriting a file when loading files with the same name into the storage (if this option is enabled, the old file will be deleted and the new one will be saved; if disabled, the old file will not be deleted, and an additional identifier will be added to the new file name). </li></ul><br>  Now click on the ‚ÄúCreate link‚Äù button.  A dialog box appears with a link that can be copied and sent to any other user.  For each container or folder, you can create an unlimited number of download links with various combinations of settings. <br><br><h3>  Download page </h3><br>  The user who received the link from you and opened it in the browser will see the following page: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/978/7b5/582/9787b5582786a05238a1d6c1bf7f3bec.png" width="1157" height="528"><br><br>  The page supports simultaneous parallel loading of three files, and due to this, the loading process is significantly accelerated: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1d3/221/581/1d322158173723d8457084a07b29947b.png"><br><br>  If any files need to be deleted, this can be done within 10 minutes after the download is complete. <br><br><h3>  Link Settings </h3><br><h4>  Link types </h4><br>  As mentioned above, when creating a link, you need to select its type.  We have provided several types of links, adapted for various uses.  Consider each type of link in more detail. <br><br><h4>  Easy download </h4><br>  Suitable for situations where you need to get files from one or more users.  Files will be uploaded to the specified container or folder, and you will be able to access them through the web panel or in other ways. <br><br><h4>  Add load time to file name </h4><br>  If you select this option, the date and time of loading will be added to the name of the file being downloaded.  For example, if you upload the file myphoto.jpg, it will be saved as myphoto_20130830_12h43m53s.jpg. <br>  This can be useful when saving backups, as well as in cases where access to a download link is provided to a large number of users, and you need to exclude matches in the names of the downloaded files. <br><br><h4>  Add a unique identifier in the file name </h4><br>  If you select this option, a unique identifier will be added to the file name.  For example, the file myphoto.jpg after downloading will be renamed to myphoto_cmrsm2ks.jpg. <br>  This type of link is suitable for implementing uploading custom content to sites (in this case, it will also be useful to include the option to ignore the original file name): the user‚Äôs given name will be rejected, and the new file name will correspond to its unique identifier. <br><br><h4>  Upload to a unique folder </h4><br>  If you select this type of link, the files will be saved in a separate folder during each download session.  For example, the file myphoto.jpg will be saved to a folder named cmrsm2ks.  If you, after downloading this file, close the download page, and then close it again and load other files, they will be saved in another folder, the name of which will be generated automatically;  a separate folder will also be created for the next download session, etc. <br><br><h4>  Upload to folder by date </h4><br>  This mode of operation is well suited for loading backups.  The downloaded files will be saved to the folder with the current date in the title.  For example, the archive mysql.dump.bz2 after downloading will be available as 2013-08-30 / mysql.dump.bz2. <br><br><h4>  Download to the folder by the hour </h4><br>  This mode is generally similar to the previous one;  the only difference is that in addition to the folder name, the time (hour) of loading will be added to the folder name.  The mysql.dump.bz2 archive will be available as 2013-08-30_15 / mysql.dump.bz2. <br><br><h4>  Download with the specified name </h4><br>  This type of link is more suitable for use through the API for applications or sites. <br>  The link will be valid for one download only, and the downloaded file will be renamed after the link itself.  For example, if the link looked like <a href="">xxx.selcdn.ru/container/you_photo.jpg</a> , then after downloading the file will be available in the repository under the name you_photo.jpg, and the link will no longer be valid. <br><br><h4>  Temporary restrictions </h4><br>  When creating a download link, you can set time limits: <br><br><img alt="uploadlink-004" src="https://habrastorage.org/getpro/habr/post_images/f15/ea7/cc6/f15ea7cc62ffc60611e9d205d63f417b.png" width="718" height="688"><br>  This is a very flexible and useful option.  It allows, first, to limit the duration of the link itself.  After the expiration date you specify, third-party users will not be able to upload files to the repository.  Such an opportunity may be useful in situations where it is necessary to accept documents from users via the Internet by a certain date (for example, when accepting applications for conferences and competitions). <br><br>  Secondly, it can be used to set the shelf life of downloaded files.  You can specify a specific period of time during which the files from the user who received the download link from you will be stored.  At the end of this period, all files will be automatically deleted.  Such functionality will be useful, for example, for organizing the loading and storage of backup copies. <br><br><h3>  Additional features </h3><br><h4>  For developers </h4><br>  Link management can be done through an API and is compatible with the Openstack Swift API.  Using libraries to work with the Openstack Swift API, you can easily create and customize links to upload files to our repository directly from your own applications and sites. <br><br>  With the help of download links you can realize the ability to download content from a third-party site to our repository. <br>  Here is a simple example: <br><br>  File upload form: <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"put-file"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fileToUpload"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"file"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  Javascript code: <br><pre> <code class="hljs javascript">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $putFile = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'put-file'</span></span>); $putFile.onsubmit = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> req = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttsourcequest(); event.sourceventDefault() file = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'fileToUpload'</span></span>).files[<span class="hljs-number"><span class="hljs-number">0</span></span>] req.open(<span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, <span class="hljs-string"><span class="hljs-string">"https://xxx.selcdn.ru/containet/sendmefile_link"</span></span>); req.withCredentials = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> req.setRequestHeader(<span class="hljs-string"><span class="hljs-string">"X-Filename"</span></span>, file.name); <span class="hljs-comment"><span class="hljs-comment">/*          */</span></span> TZ_OFFSET = (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>).getTimezoneOffset(); req.setRequestHeader(<span class="hljs-string"><span class="hljs-string">"X-Sendmefile-TZ-Offset"</span></span>, TZ_OFFSET); req.send(file); req.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(req.readyState === <span class="hljs-number"><span class="hljs-number">4</span></span> &amp;&amp; req.status === <span class="hljs-number"><span class="hljs-number">200</span></span>) alert(req.responseText) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } })()</code> </pre><br><br><h4>  For system administrators </h4><br>  The function of creating links to downloads can be useful for quickly downloading files from the server to the storage, as well as for setting up a backup. <br><br>  To upload a file, you must first create a link in the web panel, and then execute the following command in the server management console using the curl utility: <br><br><pre> <code class="bash hljs">$ curl -i https://xxx.selcdn.ru/container/upload_link -T path_to/file.name -H <span class="hljs-string"><span class="hljs-string">"X-Filename: file.name"</span></span></code> </pre> <br>  You can also organize the transfer of data through a named pipe (pipe), without saving to the file: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#      ‚Äú ‚Äù $ bzip2 bigfile.dat -c | curl -i http://xxx.selcdn.ru/container/upload_link -X PUT -d @- -H "X-Filename: bigfile.dat.bz2"</span></span></code> </pre> <br>  Another interesting feature is the multi-threaded download of files from a specific folder;  this will be much faster than using <a href="https://github.com/selectel/supload">our supload utility</a> : <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#    -P $ find path_to_dir/ -type f | xargs -I "{}" -n1 -P 10 curl http://xxx.selcdn.ru/container/upload_link -i -X PUT -H "X-Filename: {}" -T "{}"</span></span></code> </pre> <br><br><h4>  Backup </h4><br>  The new feature greatly simplifies the backup procedure: now it is not necessary to create separate containers for each server or site;  no need to create additional users, the number of which is limited.  To ensure the download and storage of backups, you just need to create a password-protected link and configure it accordingly. <br><br>  Creating links to download backups allows you to solve a number of problems that previously required considerable effort. <br><br>  First, it is sorting the downloaded backups by date and time.  In order for all uploaded files to be automatically sorted or renamed according to date and time, simply create a link of the appropriate type. <br><br>  Secondly, it is automatic removal of backups upon expiration.  Shelf life can be set in two ways: set a strictly specified time and default time.  The second option allows you to change the retention period during loading. <br><br>  Backup via download links can be easily integrated into automatic backup systems, which very often support the execution of an external command after creating an archive with a copy of the data. <br><br><h3>  Afterword </h3><br>  As is often the case with us, the new feature became available to the user several days before it was officially announced.  Some of our clients have already tried to ‚Äútie‚Äù it to their own services, and we have already received feedback from them.  In their comments, they made a number of comments and suggestions to us, which will necessarily be taken into account as soon as possible.  Very interesting wishes for the future were also expressed, in particular: <br><ul><li>  to realize the possibility of generating links for downloading downloaded files in the repository; </li><li>  create hashed passwords, which will not create a new password-protected link every time you download custom content from sites. </li></ul><br>  We invite all of our readers to try the new feature.  Link to the test version of the download page: <a href="http://23728.selcdn.ru/sendmefile-test/upload">http://23728.selcdn.ru/sendmefile-test/upload</a> (all files will be stored for an hour, the link itself will be available 30 days from the date of publication of the article). <br><br>  We will welcome any comments, suggestions, suggestions and will definitely take them into account in our future work. <br>  For those who can not comment on posts on Habr√©, we invite to our <a href="http://slc.tl/cftgg">blog</a> . </div><p>Source: <a href="https://habr.com/ru/post/193016/">https://habr.com/ru/post/193016/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../192996/index.html">We go for mushrooms after Cppcheck</a></li>
<li><a href="../192998/index.html">Responsive Android application or 1001 ways to upload a picture</a></li>
<li><a href="../193000/index.html">Artificial Intelligence and Why My Computer Doesn't Understand Me?</a></li>
<li><a href="../193004/index.html">Alternative .sortable - a new solution for sorting the list on jQuery</a></li>
<li><a href="../193008/index.html">Happy Tester!</a></li>
<li><a href="../193018/index.html">Why is the majority not always right?</a></li>
<li><a href="../193022/index.html">Method of measuring the effective value of voltage using MK</a></li>
<li><a href="../193024/index.html">Base GeoIP - countries and cities, September 2013</a></li>
<li><a href="../193026/index.html">We invite you to participate in the Intel Software Conference 2013</a></li>
<li><a href="../193028/index.html">Google introduces end-to-end encryption between data centers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>