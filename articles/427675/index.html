<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Papers, please. How a neuronet helps us check clients and catch scammers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Before a client can make money transfers in ePayments, he will have to go through verification. He provides us with his personal data and uploads docu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Papers, please. How a neuronet helps us check clients and catch scammers</h1><div class="post__text post__text-html js-mediator-article">  Before a client can make money transfers in ePayments, he will have to go through verification.  He provides us with his personal data and uploads documents to confirm identity and address.  And we check whether they meet the requirements of our regulator.  The flow of applications for verification has become increasingly, it has become difficult for us to process such a stream of documents.  We were afraid that the procedure would take a lot of time and exceed all reasonable terms for customers.  Then we decided to make a deep learning verification system. <br><br><img src="https://habrastorage.org/webt/a1/fp/4f/a1fp4fz9lw2mmlarfcsvtfsiprw.jpeg"><br><a name="habracut"></a><br><h2>  Likbez about regulators and their requirements </h2><br>  To issue electronic money, you need to get a license regulator.  If you open a payment system, for example, in Russia, the Central Bank of the Russian Federation will become your regulator.  ePayments is the English payment system, our regulator is the Financial Conduct Authority (FCA), a body accountable to the UK Ministry of Finance.  FCA ensures that we comply with the Anti-money laundering policy (AML), which includes the Know Your Customer (KYC) set of procedures. <br><br>  According to KYC, we are committed to checking who our client is and whether he is not associated with socially dangerous groups.  Therefore, we have two obligations: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  Identification and confirmation of customer identity. <br></li><li>  Verification of his data with various lists: terrorists, persons under sanctions, members of the government and many others. <br></li></ol><br>  Every year, KYC requirements are becoming stricter and more detailed.  In early 2017, without verification, ePayments customers could still receive payment or make transfers.  Now this is not possible until they confirm their identity. <br><br><h2>  Manual Verification </h2><br>  Several years ago we coped on our own.  The Russians sent a scan of certain pages of the passport to confirm their identity, to confirm the address - a scan of the lease agreement, a receipt for payment of utility bills.  Remember the game Papers, please?  In it, you, playing for a customs official, check documents on the increasingly complex requirements of the government.  Our client department played it at work every day. <br><br><img src="https://habrastorage.org/webt/l7/jg/cg/l7jgcg7r0ef-kdopy7ilfwr2snw.png"><br><br>  Clients are verified remotely, without a visit to the office.  To make the procedure faster, we hired new employees, but this is a dead end.  Then the thought appeared to entrust part of the work of the neural network.  If she copes well with facial recognition, then she will master our tasks.  From a business point of view, a quick verification system should be able to: <br><br><ol><li>  Classify document.  We are sent an ID and proof of address.  The system must answer what it received at the entrance: a passport of a citizen of the Russian Federation, a lease agreement or something else. <br></li><li>  Compare the face in the photo and document.  We ask clients to send selfies with an ID in order to make sure that they register themselves in the payment system. <br></li><li>  Extract text.  Filling dozens of fields from a smartphone is not very convenient.  Much easier if the application has done everything for you. <br></li><li>  Check image files for photo montage.  We must not forget about fraudsters who want to get into the system fraudulently. <br></li></ol><br>  At the output, the system should indicate a certain level of trust in the client: high, medium or low.  Focusing on such a gradation, we will quickly verify and not annoy customers with delays. <br><br><h2>  Document Classifier </h2><br>  The task of this module is to make sure that the user sends a valid document and give an answer what exactly he uploaded: a passport of a citizen of Kazakhstan, a lease agreement or a receipt for paying for utilities. <br><br>  The classifier receives input data: <br><br><ul><li>  Photo or scan document <br></li><li>  Country of residence <br></li><li>  Document type specified by the client (ID or proof of residence) <br></li><li>  Extracted text (more on this below) <br></li></ul><br>  At the exit, the classifier reports that he received (passport, driver's license, and so on) and how confident he is of the correct answer. <br><br><img src="https://habrastorage.org/webt/af/ol/a9/afola9agmjxbbt8bwtr5f5s30lc.png"><br><br>  Now the solution works on the Wide Residual Network architecture.  We came to her not immediately.  The first version of the fast verification system was based on the architecture that VGG inspired us for.  She had 2 obvious problems: a large number of parameters (about 130 million) and instability to the position of the document.  The more parameters, the harder it is to train such a neural network - it does not generalize knowledge well.  The document in the photo must be located in the center, otherwise the classifier would have to be trained on samples in which it is located in different parts of the photo.  As a result, we abandoned VGG and decided to switch to another architecture. <br><br>  Residual Network (ResNet) was cooler than VGG.  Thanks to <a href="https://habrahabr.ru/post/303196/">skip connections,</a> you can create a large number of layers and achieve high accuracy.  ResNet has only about 1 million parameters and was indifferent to the position of the document.  No matter where it is in the image, the solution to this architecture coped with the classification. <br><br>  While we were finalizing the solution with a file, a new modification of the architecture, the Wide Residual Network (WRN), was released.  The main difference from ResNet is a step back in terms of depth.  WRN has fewer layers, but more convolutional filters.  Now it is the best neural network architecture for most tasks and our solution works on it. <br><br><h2>  Some useful solutions. </h2><br>  <b>Problem number 1.</b> Classifier needed to be trained.  We had to load a lot of Russian, Kazakhstan and Belarusian passports and driver's licenses.  But, of course, it is impossible to take customer documents.  There are samples in the network, but they are too few for a successful neural network training. <br><br>  <b>Decision.</b>  Our technical department generated a sample of 8,000+ samples of each type.  We create a document template and propagate it into many random samples.  Then we generate a random position of the document in space relative to the camera, taking into account its mathematical model and characteristics: focal length, resolution of the matrix, and so on.  When generating an artificial photo, a random image is selected from the finished data set as the background.  After that, the document with perspective distortions is placed on the image randomly.  On such a sample, our neural network was well trained and perfectly defined the document ‚Äúin combat‚Äù.  Results - at the end of the article. <br><br>  <b>Problem number 2. The</b> banal restriction on computing resources and memory.  It makes no sense to submit a deep neural network to the input of large images.  And photos from modern smartphones are just like that. <br><br>  <b>Decision.</b>  Before submission to the input, the photo is compressed to a size of approximately 300x300 pixels.  In the image of such a resolution, it is possible to easily distinguish one identity document from another.  To solve this problem, we can use the standard Wide ResNet architecture. <br><br>  <b>Problem number 3.</b> The documents confirming the address of residence, all the more difficult.  The lease agreement or bank statement can be distinguished only by the text on the sheet.  After reducing the image size to those same 300x300 pixels, any of these documents looks the same - like an A4 sheet with illegible text. <br><br>  <b>Decision.</b>  To classify arbitrary documents, we made changes to the neural network architecture itself.  An additional input layer of neurons appeared in it, which is connected with the output layer.  The neurons of this input layer receive an input vector describing the previously recognized text using the <a href="https://en.wikipedia.org/wiki/Bag-of-words_model">Bag-of-Words</a> model. <br><br>  First, we trained the neural network to classify identity documents.  We used the weights of the trained network to initialize another network with an additional layer for the classification of arbitrary documents.  This solution had high accuracy, but text recognition took some time.  The difference in processing speed by different modules and the accuracy of classification can be found in Table 2. <br><br><h2>  Face recognition </h2><br>  How to deceive the payment system that checks the documents?  You can borrow someone else's passport and register with it.  To make sure that the client registers himself, we ask you to take a selfie with your ID.  And the recognition module should compare the face on the document and the face on the selfie and answer, it‚Äôs one person or two different. <br><br>  How to compare 2 faces if you are a car and think like a car?  Turn a photo into a set of parameters and compare their values.  This is how neural networks recognize faces.  They take an image and turn it into a 128-dimensional (for example) vector.  When you submit another face image to the input and ask them to compare, the neural network will turn the second person into a vector and calculate the distance between them. <br><br><img src="https://habrastorage.org/webt/oh/_k/ia/oh_kiatmyizksxnfavh383vu_ba.png"><br>  <i>Table 1. An example of calculating the difference between vectors in face recognition.</i>  <i>Steve Buscemi is different from himself in different photos at 0.44.</i>  <i>And from Jennifer Aniston - an average of 1.33.</i> <br><br>  Of course, there are differences between how a person looks in life and on a passport.  We also picked up the distance between the vectors and tested on real people to achieve results.  In any case, now the final decision will be made by the person, and the comment from the system will be only a recommendation. <br><br><h2>  Text recognising </h2><br>  The documents have text fields that help the classifier understand what is in front of him.  It will be convenient for the user if the text from the same passport is transferred automatically and you do not have to type manually, by whom and when it was issued.  To do this, we made the following module - recognition and text extraction. <br><br>  On some documents, for example, new RF passports there is a Machine-readable zone (MRZ).  Using it, it is easy to shoot information - this is an easy-to-read black text on a white background that is easy to recognize.  In addition, MRZ has a well-known format, thanks to which it is easier to obtain the necessary data. <br><br><img src="https://habrastorage.org/webt/c8/qg/-w/c8qg-wfvna_g7uryspfq3rx-0wc.png"><br><br>  If the task has documents with MRZ, then it becomes easier for us.  The whole process lies in the field of computer vision.  If this zone is not there, then after the recognition of the text you need to solve one interesting task - to understand, and what information have we recognized?  For example, ‚Äú05/15/1999‚Äù is the date of birth or the date of issue?  At this stage, you can also make a mistake.  MRZ is good because it is decoded unambiguously.  We always know what information and in which part of the MRZ to look for.  It is very convenient for us.  But MRZ was not on the most popular document with which the network will work - the passport of the Russian Federation. <br><br>  For text recognition, we needed a very effective solution.  The text will have to be removed from the image made by the camera phone and not the most professional photographers.  We tested Google Tesseract and several paid solutions.  Nothing came up - either it worked poorly or it was unreasonably expensive.  As a result, we began to develop our own solution.  Now we finish testing it.  The solution shows decent results - you can read about them below.  We will tell about the photomontage verification module a little later when there will be accurate research results on test samples and on the ‚Äúbattle‚Äù. <br><br><h2>  Result </h2><br>  The system is currently being tested on the verification application segment from Russia.  The segment is determined by a random sample, the results are stored and reconciled with the decisions of the operator of the client department for a specific client. <br><br><table><tbody><tr><td>  <b>A country</b> </td><td>  <b>Classifier Type</b> </td><td>  <b>Accuracy</b> </td><td>  <b>Work time with</b> </td></tr><tr><td>  Russia </td><td>  Identification </td><td>  99.96% </td><td>  0.41 </td></tr><tr><td>  Russia </td><td>  Arbitrary document </td><td>  98.62% </td><td>  6.89 </td></tr><tr><td>  Kazakhstan </td><td>  Identification </td><td>  99.51% </td><td>  0.47 </td></tr><tr><td>  Kazakhstan </td><td>  Arbitrary document </td><td>  97.25% </td><td>  7.66 </td></tr><tr><td>  Belorussia </td><td>  Identification </td><td>  98.63% </td><td>  0.46 </td></tr><tr><td>  Belorussia </td><td>  Arbitrary document </td><td>  98.63% </td><td>  9.66 </td></tr></tbody></table><br>  <i><i>Table 2. Accuracy of the document classifier (correct classification of the document compared to the operator's estimate).</i></i> <br><br>  One of the great advantages of machine learning is that the neural network really learns and makes fewer and fewer errors.  Soon we will finish testing the segment and launch the verification system in a ‚Äúcombat‚Äù mode.  30% of applications for verification come to ePayments from Russia, Kazakhstan and Belarus.  According to our estimates, the launch will help reduce the burden on the client department by 20‚Äì25%.  In the future, the solution can be scaled to European countries. <br><br><h2>  Looking for a job? </h2><br>  We are looking for employees to work in an office in St. Petersburg.  If you are interested in an international project with a large pool of ambitious tasks, we are waiting for you.  We do not have enough people who are not afraid to implement them.  Below you will find links to vacancies on hh.ru. <br><br><ul><li>  <a href="https://spb.hh.ru/vacancy/28076460">C # Developer</a> </li><li>  <a href="https://spb.hh.ru/vacancy/28239746">Front-end developer</a> </li><li>  <a href="https://spb.hh.ru/vacancy/28139768">QA Lead</a> </li><li>  <a href="https://spb.hh.ru/vacancy/28239586">QA engineer</a> </li><li>  <a href="https://spb.hh.ru/vacancy/28077529">Senior .NET developer / Team Lead</a> </li><li>  <a href="https://spb.hh.ru/vacancy/28277515">Analyst</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/427675/">https://habr.com/ru/post/427675/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../427663/index.html">Frog bears and crab</a></li>
<li><a href="../427665/index.html">The best smart scales (according to Wareable)</a></li>
<li><a href="../427669/index.html">KNX home control: lighting</a></li>
<li><a href="../427671/index.html">Sberbank and Yandex officially launched the Beru marketplace, the Russian version of Amazon</a></li>
<li><a href="../427673/index.html">Machine learning @ booking.com</a></li>
<li><a href="../427679/index.html">Resetting the limit of duty-free purchases will take a year and a half, if the decision is taken</a></li>
<li><a href="../427681/index.html">Drag and Swipe in RecyclerView. Part 1: ItemTouchHelper</a></li>
<li><a href="../427683/index.html">Why carrying over with integer overflow is not a good idea</a></li>
<li><a href="../427685/index.html">FSB against satellite Internet from foreign operators</a></li>
<li><a href="../427687/index.html">Referral for business applications | DentalTap architecture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>