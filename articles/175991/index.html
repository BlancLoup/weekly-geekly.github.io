<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LibreOffice in the corporate sector - from theory to practice</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="LibreOffice in the corporate sector - ready to start 
 There is such a good article on Habr√© by frozer , which deals with deployment (using Active Dir...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LibreOffice in the corporate sector - from theory to practice</h1><div class="post__text post__text-html js-mediator-article"><h4>  LibreOffice in the corporate sector - ready to start </h4><br>  There is such a good <a href="http://habrahabr.ru/post/154053/">article</a> on Habr√© by <a href="http://habrahabr.ru/users/frozer/" class="user_link">frozer</a> , which deals with deployment (using Active Directory) and using LibreOffice (LO) in a corporate environment. <br><br>  The only minus of the article is only a theoretical approach.  Those.  The author describes what can be done for LO corporate integration, but the practical part is missing as such. <br><br>  I tried to learn secrets and get tips on the official Russian-language forum LO, and this is what I received in response: <blockquote>  There is the most effective way. <br>  Compile from the source for themselves.  Or pay the one who does it. </blockquote>  This is clearly not the method.  There is also very little information on the Internet, so we will fill in the blanks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Instructions - under the cut. <a name="habracut"></a><br><br><h4>  Tools </h4><br>  To edit msi-packages we need the appropriate tool.  Here we have a choice, use <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa370557%2528v%3Dvs.85%2529.aspx">Orca</a> from the Windows SDK from Microsoft, or look for alternatives.  There are quite a few free editors with the necessary capabilities, but for myself I found <a href="http://www.instedit.com/home.html">InstEd</a> .  The possibilities of the free version for our needs will be enough in full. <br><br><h4>  Preparing for deployment in AD </h4><br>  So, we have the latest version of <a href="http://ru.libreoffice.org/download/">msi LibreOffice</a> (at the moment - 4.0.2).  There is no way to deploy it through GPO in AD, we will be overtaken by an error at the stage of adding a package to the policy: <br><br><img src="https://habrastorage.org/storage2/ccc/b27/710/cccb27710775cf3183d3e06a9c7a9cdb.png"><br><br>  The benefit of information to solve this problem on the Internet is.  And the bug still hangs, though with the <a href="https://bugs.freedesktop.org/show_bug.cgi%3Fid%3D45750">NOTOURBUG</a> status (not our problems, gentlemen). <br><br>  And this is solved all very simply: open msi in the editor (I will take InstEd as an example), then in the <b>Tables</b> menu - <b>Summary Info</b> ... and in the <b>Languages</b> field we see a sheet from various languages ‚Äã‚Äãin the form of their codes.  We also need to reduce it, so we remove all unnecessary, leaving for example only Russian and English (1033, 1049). <br><br>  Save the changes and move on. <br><br>  In principle, you can now deploy LO, although on client machines we will get an installed office suite with a bunch of languages, extensions, a ‚Äúquick start‚Äù enabled by automatic updating.  Watching such a zoo is quite difficult. <br><br><h4>  Get rid of unnecessary, leaving the right </h4><br>  In our organization, we adhere to the following LO setup plan: <br><ul><li>  Delete all unnecessary languages, excluding Russian and English. </li><li>  Remove all extensions, dictionaries for all languages ‚Äã‚Äãexcept Russian and English. </li><li>  Disable automatic updates. </li><li>  Disable "quick start". </li><li>  Disable file preview extension in explorer. </li><li>  Associate Microsoft Office file types with LO. </li></ul><br>  A bit of explanation: <br><ul><li>  I consider automatic updating in the AD environment not very necessary, since dispersion of versions on client PCs will cause only chaos. </li><li>  We disable the quick start, because the computers are rather weak, it makes no sense to hammer autoloading with unnecessary points. </li><li>  Expansion of the conductor is disabled, because there is a bug when the explorer crashes when you try to preview some files. </li></ul><br>  The remaining points, I think, need not be explained. <br><br>  <u>I do not urge you to adhere to the same plan, here it is considered rather as a model.</u> <br><br><h5>  We remove unnecessary languages </h5><br>  Open the msi package, go to the <b>Feature</b> table and look in the Feature column for all the values ‚Äã‚Äãmatching the <b>gm_Langpack_</b> pattern, which is further divided into several: <br><br>  gm_Langpack_Basis_ <br>  gm_Langpack_Brand_ <br>  gm_Langpack_Calc_ <br>  gm_Langpack_Draw_ <br>  gm_Langpack_Fonts_ <br>  gm_Langpack_Impress_ <br>  gm_Langpack_Math_ <br>  gm_Langpack_Resources_ <br>  gm_Langpack_Writer_ <br>  gm_Langpack_r_ <br><br>  at the end of each of the values ‚Äã‚Äãis the designation of the language, for example gm_Langpack_Math_uz or gm_Langpack_Math_uk. <br><br>  Here you can immediately remove unnecessary help files, the value <b>gm_Helppack_Help_</b> with the language code at the end is responsible for this. <br><br>  There are a lot of values, and for each of them you need to change the value in the Level column to <b>200</b> (do not set).  To save time, at the end of the post I will attach a transformation file with already corrected values. <br><br><h5>  Remove dictionaries </h5><br>  Similarly with languages, we look for the parameters <b>gm_r_ex_Dictionary_</b> with the language code at the end in the <b>Feature</b> table. <br><br><h5>  Remove extensions </h5><br>  Similarly, we look for the <b>gm_o_Extensions_</b> parameters in the <b>Feature</b> table with the extension designation.  Here you can turn off the choice. <br><br><h5>  Remove Windows Explorer Extensions </h5><br>  Table <b>Feature</b> parameters <b>gm_o_Winexplorerext</b> and <b>gm_o_Winexplorerext_x64</b> . <br><br><h5>  Turning off the "quick start" </h5><br>  Open the <b>CheckBox</b> table, and change the value of the <b>QUICKSTART</b> parameter in the Value column to 0. Thus, we will disable the quick start on the root. <br><br><h5>  Disable automatic update </h5><br>  Open the <b>Property</b> table, look for the <b>ISCHECKFORPRODUCTUPDATES</b> value, set the value to 0. <br>  In the <b>Feature</b> table, look for the <b>gm_o_Onlineupdate</b> parameter, set the Level to 200. <br><br><h5>  Matching Microsoft Office File Types with LO </h5><br>  Open the <b>Property</b> table, look for the <b>REGISTER_ALL_MSO_TYPES</b> value, set the value to 1. Optionally, you can fine-tune the mapping for each file type separately. <br><br><h4>  Making a "transformer" </h4><br>  To save time in the future, I recommend saving all changes to a transformation file.  In the future, it can simply be applied to the following (preferably minor) LO releases. <br>  In InstEd, this is done like this: before changing any parameters, go to the <b>Transform</b> menu - <b>New Transform</b> and save the future transformation file.  After the changes do not forget to save it. <br><br><h4>  Total </h4><br>  We save our package, create a distribution policy in AD and watch the process. <br>  According to my calculations, the installation (with the removal of the old version) of LibreOffice 4 on a medium-sized PC (2 cores, 2Gb RAM, HDD, KES 10) takes 10 minutes for Windows XP and 3-4 minutes for Windows 7. The installed LO takes ~ 280Mb. <br><br><h4>  Applications </h4><br>  As promised, I attach the <a href="http://yadi.sk/d/Z8g4dxFo3uW8m">finished transformation file</a> according to the sounded plan. <br><br><h5>  Links </h5><br>  When writing a post, the following sources were used: <br>  <a href="http://admintoil.blogspot.ru/">Blog "sysadmin hard work</a> . <a href="http://admintoil.blogspot.ru/">"</a> <br>  <a href="http://webgnuru.com/networking/libreoffice_msi.php">WebGNUru website</a> <br>  <a href="http://wiki.opennet.ru/%25D0%25A3%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B0_%25D0%25BF%25D1%2580%25D0%25B8%25D0%25BB%25D0%25BE%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B9_%25D1%2587%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B7_GPO">Wiki opennet</a> </div><p>Source: <a href="https://habr.com/ru/post/175991/">https://habr.com/ru/post/175991/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../175981/index.html">Intel announced the new Thunderbolt: 2 times faster speed and 4k video support</a></li>
<li><a href="../175983/index.html">Silicon Valley in Ulyanovsk</a></li>
<li><a href="../175985/index.html">Quick Start: Visual Database Design in MySQL Workbench</a></li>
<li><a href="../175987/index.html">Continuation of the video lectures of the course "Operating Systems" with Alexei Bragin in MSTU. Bauman</a></li>
<li><a href="../175989/index.html">Launch .NET MicroFramework on STM32F4Discovery (translation)</a></li>
<li><a href="../175993/index.html">Open government and all other state structures as platforms</a></li>
<li><a href="../175995/index.html">10 Tips for Initially Setting Up a Hyper-V Environment</a></li>
<li><a href="../175999/index.html">ASP.NET MVC. Lesson 0. Introduction</a></li>
<li><a href="../176001/index.html">ASP.NET MVC Lesson 1. Start</a></li>
<li><a href="../176005/index.html">Ultrabook Acer Aspire S7-191 video review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>