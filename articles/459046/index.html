<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to independently implement (Proof of Existence) in 2 steps</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! My name is Ararat and I work for QuantNet, which holds contests for algorithmic strategies. Recently, an important task has arisen before me - ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to independently implement (Proof of Existence) in 2 steps</h1><div class="post__text post__text-html js-mediator-article">  Hello!  My name is Ararat and I work for QuantNet, which holds contests for algorithmic strategies.  Recently, an important task has arisen before me - to guarantee the integrity of the users' dates (this is extremely important, as it is necessary to use real-time data from world financial markets to correctly verify the effectiveness of strategies). <br><br>  It was here that I came across the concept of PoE (Proof of Existence).  It‚Äôs written enough on the Internet, but the specifics of the platform made me think a bit over my head.  That's why I decided to write this article and share my experience in the architecture and implementation of PoE.  I think it will be especially important for guys from Fintech. <br><br>  I divided my article into 3 main blocks: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  What is PoE and when it may be needed </li><li>  Implementation algorithm </li><li>  Solution of my particular case </li></ul><a name="habracut"></a><br><h4>  So what is Proof of Existence? </h4><br>  Proof of Existence helps to prove that a document, file, or data was created at a specific date and time.  The largest application is the patent registration.  But from what I've seen, this is most often used in areas at the junction of finance and IT. <br><br>  An example from my algo trading sphere: you have an algorithm that gives about 70% of the correct stock predictions for the next 2 weeks.  You decide to sell your predictions to other market players.  Things are easy - to convince the buyer that your predictions are correct and were made before the results of the auction, i.e.  guarantee their implementation at a specific time. <br><br>  How can this be guaranteed?  Right, implement PoE. <br><br><h4>  PoE implementation algorithm </h4><br>  First you need to: <br><br><ol><li>  Prepare the file you want to patent.  (I made a PDF, but you can use any other container). </li><li>  Get the hash of this file (I used sha256 format). </li></ol><br>  Just in case, the hash is an individual ‚Äúfingerprint‚Äù of the file, which guarantees the (almost complete) lack of coincidence with the hash of another file.  When you get the hash from the file, you will need to generate a transaction in the blockchain network, specifying the hash of the document in the body of the transaction. <br><br>  Everything.  With the intro part finished.  Now we come to the most interesting. <br><br>  (For greater clarity, I created a special code (only for demonstration.) You can see a demo of the service <a href="https://repl.it/%40Araton95/PoE-Realization">here</a> .) <br><br>  Let's take a closer look at how the demo works. <br><br>  I propose to divide the implementation into 2 parts: <br><br><ol><li>  Preparation of a smart contract and an ether purse. </li><li>  Generation of transaction in the code on Node.js and the private key. </li></ol><br>  Let's take it in order: <br><br>  <b>Part 1:</b> Preparation of a smart contract and Ethereum wallet <br><br>  PoE itself was first associated with the bitcoin blockchain.  But I chose the blockchain ether and smart contracts for implementation.  Smart contracts give us flexibility, modularity and scalability in the future, acting as a repository for hashes in the blockchain. <br><br>  I chose a simple smart contract that can take a hash and with the corresponding date, hash format =&gt; date, it would also be super to have a method that returns the hash date when called.  In addition, it would be nice to take care that only the contract owner could add new hashes. <br><br>  Smart contract code: <br><br><pre><code class="coffeescript hljs">```<span class="javascript"><span class="javascript"> pragma solidity </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0.5</span></span></span><span class="hljs-number"><span class="javascript"><span class="hljs-number">.9</span></span></span><span class="javascript">; </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">/** * @title Ownable * @dev The Ownable contract has an owner address, and provides basic authorization control * functions, this simplifies the implementation of "user permissions". */</span></span></span><span class="javascript"> contract Ownable { address private _owner; event OwnershipTransferred(address indexed previousOwner, address indexed newOwner); </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">/** * @dev The Ownable constructor sets the original `owner` of the contract to the sender * account. */</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">constructor</span></span></span><span class="javascript"> () internal { _owner = msg.sender; emit OwnershipTransferred(address(</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">), _owner); } </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">/** * @return the address of the owner. */</span></span></span><span class="javascript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">owner</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">public</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">view</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">returns</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">address</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">return</span></span></span><span class="javascript"> _owner; } </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">/** * @dev Throws if called by any account other than the owner. */</span></span></span><span class="javascript"> modifier onlyOwner() { </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">require</span></span></span><span class="javascript">(isOwner()); _; } </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">/** * @return true if `msg.sender` is the owner of the contract. */</span></span></span><span class="javascript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">isOwner</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">public</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">view</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">returns</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">bool</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">return</span></span></span><span class="javascript"> msg.sender == _owner; } </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">/** * @dev Allows the current owner to transfer control of the contract to a newOwner. * @param newOwner The address to transfer ownership to. */</span></span></span><span class="javascript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">transferOwnership</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">address newOwner</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">public</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">onlyOwner</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span></span><span class="javascript">{ _transferOwnership(newOwner); } </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">/** * @dev Transfers control of the contract to a newOwner. * @param newOwner The address to transfer ownership to. */</span></span></span><span class="javascript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">_transferOwnership</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">address newOwner</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">internal</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span></span><span class="javascript">{ </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">require</span></span></span><span class="javascript">(newOwner != address(</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">)); emit OwnershipTransferred(_owner, newOwner); _owner = newOwner; } } </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">/** * @title HashStore * @dev The contract store the hashes and returns date by hash * Only the owner can add new hashes */</span></span></span><span class="javascript"> contract HashStore is Ownable { mapping(</span><span class="hljs-function"><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">bytes32</span></span></span></span><span class="javascript"><span class="hljs-function"> =&gt;</span></span></span><span class="javascript"> uint256) private _hashes; event HashAdded(bytes32 hash); </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">addHash</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">bytes32 rootHash</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">external</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">onlyOwner</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span></span><span class="javascript">{ </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">require</span></span></span><span class="javascript">(_hashes[rootHash] == </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">, </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"addHash: this hash was already deployed"</span></span></span><span class="javascript">); _hashes[rootHash] = block.timestamp; emit HashAdded(rootHash); } </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">getHashTimestamp</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">bytes32 rootHash</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">external</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">view</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">returns</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">uint256</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">return</span></span></span><span class="javascript"> _hashes[rootHash]; } } </span></span>```</code> </pre> <br>  As you have noticed, we used 2 separate contracts: Ownable and HashStore. <br>  The HashStore contract is responsible for storing hashes and issuing a hash date on request.  The Ownable contract is responsible for verifying that the new hash was added solely by the owner of the contract. <br><br>  To add a hash you need to call the addHash method, passing the value of sha256 as an argument to our file.  If the hashes within the contract match, the transaction will be rejected.  This is how unwanted duplication of values ‚Äã‚Äãwith different dates is filtered.  It is checked here: <br><br><pre> <code class="plaintext hljs">require(_hashes[rootHash] == 0, "addHash: this hash was already deployed");</code> </pre> <br>  We can get the hash transaction date using the getHashTimestamp method, passing as a hash argument with the transaction date we need.  The getHashTimestamp method returns the time in UNIX format.  You can translate into any more readable format. <br><br>  So, we have dealt with the contract, now we need to plug it into the network.  For this we need two things: <br><br><ol><li>  broadcast address for interaction with blockchain </li><li>  some amount of air to invoke methods and deploy contracts. </li></ol><br>  In order not to waste air on tests, we can use the ropsten test network.  More details can be found here.  This address is the owner of the contract, as he was the initiator of the deployment and may add new hashes in the future.  After that, you must keep this address in a safe place, as well as the private key of your wallet and the address of the contract.  We will need all this in the future. <br><br>  <b>Part 2: Generating a transaction in Node.js and a private key</b> <br><br>  So, by this time, we already have the ether purse, its secret key, the contract in the test network and the data hash.  It remains to configure the interaction with the blockchain. <br><br>  For this, we will use the web3.js library and create a token for our node.  I created my own using the infura.io service and it looks like this: <br><br><pre> <code class="plaintext hljs">ropsten.infura.io/v3/YOUR_TOKEN_HERE</code> </pre> <br>  For hashing, use the sha256 package.  The data format can be any, but in the example we use the data in JSON. <br><br><h4>  How did I solve my case using PoE? </h4><br>  Besides the very presence of PoE, it was important for me not to overload users with the blockchain and transaction fees. For example, calling the addHash method (bytes32 rootHash) costs 0.2 finney (0.0002 ETH or $ 0.06 at the June 2019 rate). <br><br><img src="https://habrastorage.org/webt/ir/jr/06/irjr069r94csnmxhnxmddfmgzjq.png"><br><br>  About 30 conclusions of the strategy position came out per day, that is, it costs us $ 2.1.  If the number of users will increase by 100 times, and the course of the Ether will go up, the cost will naturally go to the top. <br><br>  I decided to store one hash in the blockchain for a day.  This hash will be generated from the hashes of the daily conclusions of the strategies and their internal identifiers. <br><br><img src="https://habrastorage.org/webt/eh/gn/qq/ehgnqqunmlbx-soeaz9yopkryfw.png"><br><br>  We get a solution that is not inferior in functionality, however, much cheaper.  We see no problems with scalability, however, it is always possible to divide the output of the position of strategies into several blocks and save several hashes to the blockchain network.  A participant can easily verify a single hash using other neighboring hashes. <br><br><h4>  Eventually </h4><br>  For verification, we created a special template that is available as a Jupyter notebook.  At any time, the user can load a template, re-generate everything and check that all items are really those that were created and saved in the past. <br><br><pre> <code class="coffeescript hljs">```<span class="javascript"><span class="javascript">   : </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1.</span></span></span><span class="javascript">    API       </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1.</span></span></span><span class="javascript">     </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">2.</span></span></span><span class="javascript">    API  ,         </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">3.</span></span></span><span class="javascript">          ,              .          . </span></span>```</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/459046/">https://habr.com/ru/post/459046/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../459028/index.html">Static memory allocation in microcontrollers</a></li>
<li><a href="../45903/index.html">Futuristic LED Watch</a></li>
<li><a href="../459030/index.html">A look into the black box - the new system from MIT will show how the machine learning algorithms work</a></li>
<li><a href="../459034/index.html">Some simple but useful tips for working with getters in Vuex</a></li>
<li><a href="../459038/index.html">The camera's voice guidance function has become more accessible - the universal solution SmartCam A12 Voice Tracking</a></li>
<li><a href="../459050/index.html">Powerful module for typing Vuex</a></li>
<li><a href="../459052/index.html">How to compare: ‚Äúamazing cars‚Äù and ‚Äúugly barracks‚Äù, in a marketing survey and in big data</a></li>
<li><a href="../459054/index.html">Heat map of clicks - how users behave on the site</a></li>
<li><a href="../459062/index.html">The digest of interesting materials for the mobile # 305 developer (July 1 - 7)</a></li>
<li><a href="../459066/index.html">Balancing write and read in the database</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>