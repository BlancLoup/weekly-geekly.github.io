<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>History of Visual Studio. Part I</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From translator 
 Part 0.5 Continuation 

 As it turns out, C ++ is a fairly complex language to compile; yes that there - it is difficult even to und...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>History of Visual Studio. Part I</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <em>From translator</em> <br>  <a href="http://habrahabr.ru/blogs/development/71632/">Part 0.5</a> Continuation <br></blockquote><br>  As it turns out, C ++ is a fairly complex language to compile;  yes that there - it is difficult even to understand.  I remember one conversation about how confusing the pointers to class members can be.  The results were amazing and boiled down to the fact that pointers can point to members defined in a virtual base class.  This is all C ++: individual things seem simple, but as soon as you start combining them with others, things get more complicated. <br><a name="habracut"></a><br>  At this time, we were busy adding new features to our debugger.  As it turned out, the creation of the ‚ÄúExpression Evaluator‚Äù for C ++ was also quite a feat.  "Calculators" - the animals are quite pleasant.  They are used to calculate the values ‚Äã‚Äãof expressions that would be incorrect in the actual compilation context (for example, calculating the value of a static variable outside the current scope, or calculating the value of a global variable from another module).  The ‚Äúcalculator‚Äù was supposed to perform all these tasks, being simultaneously similar in spirit to the original language and as responsive as possible. <br><br>  Did I mention that it could all work slowly? <br><br>  At that time, I was working on a development environment for the Windows 3.0 platform ‚Äî another project that was never released ‚Äî and we had problems with trying to force <code>windows.h</code> compile in any reasonable amount of time. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And it was then that a miracle happened with precompiled header files. <br><br>  I call it a ‚Äúmiracle‚Äù because <code>.pch</code> literally revolutionized our approaches to software development.  Other systems in the past used a similar approach, but ours was smarter.  For example, due to the fact that our system was based on images of compiled header files, it ensured that the overall effect of header files at the precompilation point was absolutely identical in each compilation unit.  This meant that it was possible to divide between modules as information for debugging and navigation, and the internal state of the compiler.  The fact that you could get different results in two compilation units after <code>#include</code> header file was a curse to the developers.  And the precompiled headers saved us. <br><br>  Again: I do not name names, but it will suffice to say that I know very well the person who created all this and that it was in the style of ‚Äúyes it is impossible‚Äù, ‚Äúdon‚Äôt even try‚Äù, ‚Äúoh yes you did ! <br><br>  At the same time, another team was working on a product called Quick C for Windows, which later turned out to be incredibly important.  This product has been invested a lot of work;  he had the first real IDE for Windows and real debugging.  However, all this was flawed, and a little later I will say why bringing all this to the mind was not an easy task. <br><br>  While the court and the case, that other company also did not stand still, but produced cool C ++ compilers.  Until 1992, we had nothing to answer: we released Microsoft C 7.0 based on PBW and - literally at the same time - Quick C for Windows (QCW). <br><br><br>  My project was closed.  Yes, again.  Fortunately, I had a lot of time to be noted. <br><br>  By the way, Microsoft C 7.0 was, I think, the most difficult (in terms of mass) product ever released by us.  I'm not sure that we once tried to roll out so many books. <br><br>  So we released this bookshelf, and the situation in the meantime has become quite interesting. <br><br>  We could not release PBW again;  we needed a graphical development environment, the basis for which was to be QCW and work was already underway to generalize it and adapt it to our tasks, but there was work there - don't worry about your mother.  In addition, in our C ++ implementation there were some important features missing;  Microsoft C 7.0 comes with a very limited MFC 1.0 library.  We needed to do something about it.  And to increase the speed, too, would not hurt. <br><br>  Each of these tasks was frightening, but I‚Äôll only talk about a few.  First, debugging. <br><br>  Debugging in 16-bit Windows (by the time we finished, it was already Windows 3.1 in the yard) was magic.  Win16 was <a href="http://en.wikipedia.org/wiki/Computer_multitasking">cooperative multitasking</a> and there were no ‚Äúthreads‚Äù as such: there was only one thread of execution.  Now imagine what it meant: the process could not be stopped in principle.  Stop the process - and everything will rise.  So if you are trying to make the GUI debugger stop the program being debugged, then it is not worth it.  Instead, you had to make everything look as if the program had stopped, but in reality it would continue to work, but it was not the user code that had to execute, but the harmless code provided by the debugger that would continue to process window messages. <br><br>  Part of this magic was that when the process being debugged ‚Äústopped‚Äù, it was necessary to subclass all the process windows on the fly and replace <code>WndProc</code> with an implementation that displays a white rectangle instead of full-fledged drawing, storing important messages in the queue for further processing and performing some processing "By default" with the hope that she will not do anything wrong.  The focus became even more interesting when the application tried to send DDE or OLE messages.  This was the ‚Äúmiracle‚Äù of <a href="http://blogs.msdn.com/ricom/archive/2008/08/22/hard-and-soft-mode-debugging-or-the-woes-of-soft-mode.aspx">Soft Mode</a> debugging. <br><br>  Oh yeah, the development tools ... There was such a thing called Windows NT - you might have heard of it.  And we did not want to fence binaries for various environments, so it was necessary to fix the subsystem ‚ÄúDOS extensions‚Äù so that you could run console applications of Windows NT in DOS.  Impressive.  And all this had to be the good old DOS.  Twice impressive.  But we did it (not without the help of a third party, which I will not name). <br><br>  And yes, the development tools were slow.  We podnuzhilis and stuffed information for CodeView in. Pdb-files in order to facilitate the loss of information, which "provided" <code>cvpack</code> .  This is a few other changes - and for the first time in quite a long time, we have the fastest C ++ compiler on the market (at least according to our internal laboratory; your feelings may differ). <br><br>  While we were doing the compiler, MFC was doing quite well.  There appeared a designer, a couple of important craftsmen and the whole farm began to look like VB: drew, clicked, dragged - that's it! <br><br>  I have to say a few words about VB. <br><br>  The code name for Visual Basic 1.0 was Thunder.  When I first heard it, it seemed to me somewhat arrogant.  I thought their ‚ÄúFeel the power of thunder!‚Äù Style behavior was just an arrogant boast of boys.  And I was wrong. <br><br>  The fact that all products wanted to be similar to Visual Basic and changed the name to Visual something-there was a reason.  Visual Basic was just very good.  Rarely did anyone have an interpreter that provided feedback on the fly, but everyone wanted to recreate key elements of Visual Basic.  By the time we finished, Visual Basic was already everywhere, and it deeply influenced design and libraries.  We did not have Visual Basic, but something Visual: it was Visual C ++ (if you still follow: Microsoft C 8.0 and MFC 2.0). <br><br>  This was followed by a rather interesting release in which we made our 16-bit tools work under Windows NT in 16-bit mode (we remove our hat to the guys from the application compatibility department: we were not so easy to port), added support for OLE and ODBC.  Clients liked it all a lot and for the first time since working at Microsoft, I clearly felt that we had an advantage over competitors in the field of development tools for C / C ++.  The language was not yet complete, but what was was really cool. <br><br>  While these events were taking place, a part of our team was working on another ‚Äúreally cool‚Äù thing: they ported our entire farm to 32-bit Windows NT.  It was planned that the release will take place at the time of Windows NT 3.5.  This, the release of a localized version for Japan, as well as, in principle, support for internationalization, was an important, but completely undervalued work. <br><br>  This is how Visual C ++ 1.1 appeared. <br><br>  Some not entirely conscious personalities believe that version 1.1 was not a complete product, but was ‚Äújust a ported product.‚Äù  These are people who obviously do not understand anything in the development tools.  In the system version 1.1 was a completely new, 32-bit, compiler backend.  We all know how portable these backends are.  And yes, there was a completely new debugger with a completely different mechanism of operation: in Windows NT, there were real threads that could be stopped.  And again: the memory model for the entire program was different, since near and far ( <code>far</code> and <code>near</code> ) pointers disappeared.  And yes, there, it was all small things, and version 1.1 was just a port. <br><br>  This was in 1993, the product was called Barracuda.  Personally, I hardly noticed there, but the main developers deserve special mention in History. <br><br>  The situation promised to be very interesting;  The most important release of the C ++ toolkit in my memory was Visual C ++ 1.0 ‚ÄúCaviar‚Äù.  Without it, there would be nothing.  But just as important was the next release, which I will write about next time.  Visual C ++ 2.0 ‚ÄúDolphin‚Äù was the first to integrate development tools into a single software product. <br><br></div><p>Source: <a href="https://habr.com/ru/post/71667/">https://habr.com/ru/post/71667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../71659/index.html">Why TV must die</a></li>
<li><a href="../71661/index.html">Book microservices</a></li>
<li><a href="../71664/index.html">Crazy Microsoft Multi-Touch Mouse</a></li>
<li><a href="../71665/index.html">Visa -> Yandex Money etc</a></li>
<li><a href="../71666/index.html">Programs auto-balance on the desktop</a></li>
<li><a href="../71668/index.html">Online Photoshop!</a></li>
<li><a href="../71671/index.html">What will replace the television?</a></li>
<li><a href="../71672/index.html">Kempler & Strauss W PhoneWatch - The Smallest Watch- Mobile Phone</a></li>
<li><a href="../71674/index.html">My Phone will help you find your phone.</a></li>
<li><a href="../71676/index.html">A bug in Chrome or how Yandex broke Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>