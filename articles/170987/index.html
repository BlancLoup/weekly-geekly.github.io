<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using events in jQuery plugins</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The main purpose of this article is to show the differences between the traditional implementation of the jQuery plugin and the implementation using e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using events in jQuery plugins</h1><div class="post__text post__text-html js-mediator-article">  The main purpose of this article is to show the differences between the traditional implementation of the jQuery plugin and the implementation using events.  The article will be about the traditional implementation of the jQuery plugin, about working with events in jQuery, and trying to replace the methods or callback functions of the plugin with events. <br><br>  The article is primarily designed for beginners, but there is a desire to hear the professional opinion of people familiar with this issue, having a deeper understanding of the things described in the article. <br><a name="habracut"></a><br><blockquote>  1. Theory <br>  1.A.  JQuery Traditional Plugin <br>  1.B.  Variable scope <br>  1.B.  Work with events in jQuery <br>  1.G.  Application of events in plugins <br>  1.D.  Disadvantages of events <br>  2. Example of a simple plug-in application <br>  3. Conclusion, conclusion <br>  4. References </blockquote><br><br><h4>  1. Theory </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  1.A.  JQuery Traditional Plugin </h5><br><br>  Creating a traditional jQuery plugin is a rather trivial task.  To do this, you need to add a new method to the space $ .fn. <br><br><h6>  Example 1 (creating a myPlugin plugin): </h6><br><pre><code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> $ </span></span></span><span class="hljs-function">) </span></span>{ $.fn.myPlugin = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  options -   //  $(this) -    jQuery   ,     //      }; })( jQuery );</span></span></code> </pre> <br><br>  This structure is great for creating simple plugins that you don‚Äôt need to receive data from. <br><br>  But often we need to get the data or state of the plugin.  A good example is the datepicker. <br><br>  I know several solutions for data acquisition: <br><ul><li>  R.1.A.  <b>Calling a method (or function)</b> . <br>  <i>Example 2:</i> <code>$('input.date').datePicker('getDate');</code>  <code>$('input.date').datePicker('isDisabled')</code> . <br>  <i>Disadvantage:</i> there is no possibility to track changes (for example, the user chose another value); </li><li>  R.1.B.  <b>Transfer callback functions</b> . <br>  <i>Example 3:</i> <code>$('input.date').datePicker({onChange: onChangeCallback});</code>  <code>$('input.date').datePicker({onDisable: onDisableCallback})</code> . <br>  <i>Disadvantage:</i> Complication of the plug-in implementation: it is necessary to implement a call to a callback function, a subscription to the event of several listeners; </li><li>  R.1.V.  <b>Events</b> <br>  <i>Example 4:</i> <code>$('input.date').on('change', onChangeHandler);</code>  <code>$('input.date').on('disable', onDisableHandler)</code> . <br>  More on the advantages and disadvantages further. </li></ul><br><br><h5>  1.B.  Variable scope </h5><br>  The problem with the implementation of methods <i>P.1.A</i> and <i>R..1.B</i> is that the next time you call <code>$(element).datePicker(...)</code> , the plugin's ‚Äúconstructor‚Äù is executed again.  Of course, this is easily monitored by checking the parameters passed: if the object (options) is passed, this is initialization;  if a string is passed, a method call is required.  As they say, ‚Äúthis is a bug or a feature‚Äù - while there is not enough experience to understand. <br><br>  But I ran into the problem of variable scope. <br><br>  <a href="http://jsbin.com/upuyiy/1/edit"><i>Example 5: Demonstration of the scope problem</i></a> <br><br><pre> <code class="php hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $ )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  var options = { date: '00-00-0000' }, //  methods = { getDate: function() { return options.date; } }; //  $.fn.myPlugin = function(o) { if (typeof o === 'string' &amp;&amp; methods[o] !== null) { return methods[o].apply(); } options = o || options; $(this).text(options.date); }; //   $('[data-test]').myPlugin({ date: '10-10-2013' }); //   alert($('[data-test]').myPlugin('getDate')); })( jQuery );</span></span></code> </pre><br><br>  At this stage, everything is simple: create a plugin that displays the date from the options. <br><br>  But the problem arises when it is necessary to place on the page more than one plugin of this type. <br><br>  <a href="http://jsbin.com/upuyiy/2/edit"><i>Example 6: More than one plugin per page</i></a> <br><br>  As we see from example 6 - the options variable, which was moved out of the plug-in limits - was overwritten by the data during plug-in 2 initialization. <br><br><h6>  Solutions for Example 6: </h6><br><ul><li>  R.2.A.  In the options object, store data for initializing all plug-ins (code complication); </li><li>  R.2.B.  Attach initialization data to a DOM object (from my point of view: a good solution); </li><li>  R.2.V.  Use of events.  Calling methods with <code>$(...).trigger(...)</code> .  In the end I will give an example that is devoid of this shortcoming. </li></ul><br><br><h5>  1.B.  Work with events in jQuery </h5><br>  Using the jQuery library, we can both create "listeners" for <code>$('.link').on('click', onClickHandler)</code> , and trigger (provoke) <code>$('.link').trigger('click')</code> ) events <code>$('.link').trigger('click')</code> . <br><br>  Refer to the documentation, look at the parameters of both functions: <br><br>  In general, the <a href="http://api.jquery.com/on/">on</a> function has parameters: <br><ul><li>  <i>events</i> - a list of events to listen to; </li><li>  <i>handler</i> is an event <i>handler</i> function that will be called when any event from the events list is executed. </li></ul><br><br>  The <a href="http://api.jquery.com/trigger/">trigger</a> function has parameters: <br><ul><li>  <i>eventType</i> - the name of the event to be triggered; </li><li>  <i>extraParameters</i> - an array or object containing the parameters to be passed to the event handler. </li></ul><br>  <a href="http://jsbin.com/izecug/1/edit"><i>Example 7: Demonstrating how events work</i></a> <br><br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).on(<span class="hljs-string"><span class="hljs-string">'myEvent'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, p</span></span></span><span class="hljs-function">) </span></span>{ alert(<span class="hljs-string"><span class="hljs-string">'a: '</span></span> + pa + <span class="hljs-string"><span class="hljs-string">'; b: '</span></span> + pb); }); $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).trigger(<span class="hljs-string"><span class="hljs-string">'myEvent'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-string"><span class="hljs-string">'2'</span></span> }); });</code> </pre><br><br><h5>  1.G.  Application of events in plugins </h5><br>  To get rid of the problem with the scope of variables (described in example <i>P.6</i> ) and the problem of hanging several listeners (described in the solution of <i>R.1.B</i> ), I resorted to using events and wrappers implemented in jQuery (1.B). <br><br>  <a href="http://jsbin.com/eguyif/2/edit"><i>Example 7: Implementing events in a plugin</i></a> <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> $ </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   $.fn.datePicker = function(options) { var self = $(this), options = options || { year: 2012, month: 1, day: 1 }; var date = new Date(options.year, options.month, options.day), d = new Date(options.year, options.month, 1), table = $('&lt;table /&gt;'), tr = $('&lt;tr&gt;'); tr.appendTo(table); //    for (i=0; i &lt; d.getDay(); i++) { tr.append('&lt;td /&gt;'); } //   while (d.getMonth() == date.getMonth()) { if (i % 7 == 0) { tr = $('&lt;tr /&gt;'); tr.appendTo(table); i = 0; } var td = $('&lt;td&gt;' + d.getDate() + '&lt;/td&gt;'); td.data('date', d.toString()); tr.append(td); d.setDate(d.getDate() + 1); i++; } //    for (i=0; i &lt; 7 - d.getDay(); i++) { tr.append('&lt;td /&gt;'); } table.appendTo(self); //        'change'   table.find('td').on('click', function() { //     self.trigger('change', $(this).data('date')); }); return self; }; //   $('[data-datePiceker]').datePicker(); //     $('[data-datePiceker]').on('change', function(event, date) { alert(date); }); })( jQuery );</span></span></code> </pre><br><br>  What we got: <br><ul><li>  "Constructor" is called only once; </li><li>  we can hang a lot of "listeners" who will receive information about the state of the plugin; </li><li>  Variables related to the plugin are in the function body, and do not depend on other initializations of this plugin. </li></ul><br>  <a href="http://jsbin.com/eguyif/4/edit"><i>Example 8 Demonstrating the work of several initializations of a single plugin. P.7</i></a> <br><br><h5>  1.D.  Disadvantages of events </h5><br>  Of course, this approach changes the usual approach to working with the plugin, I mean the lack of traditional methods for obtaining data, for example <code>$(...).datePicker('getDate')</code> , but nevertheless at this stage of my personal development, as a programmer, this way solves some of my problems.  I personally, I think this campaign is quite universal, and has not yet come across any shortcomings - if the reader knows about those, please do not be silent, and I also want to ask to write as accessible and adequate as possible. <br><br><h4>  2. Example of a simple plug-in application </h4><br>  For training and running events, I wrote several small client applications: <br><ul><li>  Appendix 1 (Twitter <a href="http://jsbin.com/afupej/1/edit">feed</a> ): <a href="http://jsbin.com/afupej/1/edit">jsbin.com/afupej/1/edit</a> </li><li>  Appendix 2 (TODO List): <a href="http://jsbin.com/urihar/16/edit">jsbin.com/urihar/16/edit</a> </li></ul><br><br><h4>  3. Conclusion, conclusion </h4><br>  Using examples, I showed the creation of a jQuery plugin, identified actual data transfer problems for me and getting data from the plugin, showed the use of jQuery events and wrappers, and touched upon creating an application that actively uses jQuery plugins and events. <br><br>  I did not touch upon the topic of surfing events on the DOM tree, and I also wanted to pay more attention to creating applications using events.  But, if it is karma, I will definitely write a sequel. <br><br>  Once again I want to appeal to the people who create professional client applications: I love criticism, and I want to hear opinions on this approach, and in general I would like to learn more about creating client applications from first-hand.  Therefore, write - I will be grateful. <br><br>  Thanks for attention! <br><br><h4>  4. Used literature </h4><br><ol><li>  <a href="http://twitter.github.com/flight/">twitter.github.com/flight</a> </li><li>  <a href="http://api.jquery.com/trigger/">api.jquery.com/trigger</a> </li><li>  <a href="http://api.jquery.com/on/">api.jquery.com/on</a> </li><li>  <a href="http://docs.jquery.com/Plugins/Authoring">docs.jquery.com/Plugins/Authoring</a> </li></ol><br><br><h4>  5. Literature from commentators </h4><br><ol><li>  <a href="http://api.jqueryui.com/jQuery.widget/">jQuery UI: Widget Factory</a> </li><li>  <a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/">Very large selection of various design patterns and examples from popular frameworks.</a> </li><li>  Judging by the English.  name <a href="https://github.com/tcorral/Refactoring_Patterns">refactoring patterns</a> (not yet studied) </li></ol></div><p>Source: <a href="https://habr.com/ru/post/170987/">https://habr.com/ru/post/170987/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../170975/index.html">QR Ladybird miniature unmanned multi-rotor ‚ÄúBug‚Äù</a></li>
<li><a href="../170977/index.html">Remote work - sucks. Long live the remote work!</a></li>
<li><a href="../170981/index.html">The start date of LeapMotion sales has become known.</a></li>
<li><a href="../170983/index.html">Create autarky in the browser using the webcam</a></li>
<li><a href="../170985/index.html">Self-made galvanic isolation, in the common people - lightning protection</a></li>
<li><a href="../170999/index.html">TechCrunch Mobile Barcelona Meetup 2013</a></li>
<li><a href="../171003/index.html">Erlang / OTP R16B released</a></li>
<li><a href="../171005/index.html">Story of one optimization</a></li>
<li><a href="../171007/index.html">4 life hacking for investing in a startup: hooray, there is a fast and simple legal model</a></li>
<li><a href="../171009/index.html">Product Information Support: KANO Special Practice</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>