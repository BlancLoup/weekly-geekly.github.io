<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Jasig CAS - authentication server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you are developing web applications, for sure you are faced with the task of implementing single sign on. In this short article I will briefly desc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Jasig CAS - authentication server</h1><div class="post__text post__text-html js-mediator-article">  If you are developing web applications, for sure you are faced with the task of implementing <a href="http://en.wikipedia.org/wiki/Single_sign-on">single sign on.</a>  In this short article I will briefly describe a turnkey solution from <a href="http://www.jasig.org/">Jasig</a> . <br><br><h3>  Short description </h3><br>  <a href="">Jasig CAS</a> (Central Authentication Service) is a web application written in java.  To start using it, almost nothing needs to be done.  Need to download, configure, build, deploy.  And set up clients (sites on which we make single sign on). <br><a name="habracut"></a><br><h3>  Scheme of work </h3><br>  How CAS works can be understood from this diagram: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/daa/ba4/043/daaba4043639cf2415a04854aca2084c.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A similar scheme uses Yandex and Google. <br><br>  Consider it in steps: <br><ul><li>  1. The user opens the web application. </li><li>  2. The request is not yet received by CAS, but by the application. </li><li>  3. Our web application understands that the user does not have a session and redirects the user to the CAS.  Everything is simple for the user - he opened the application and immediately saw the login page. </li><li>  4. User enters login / password </li><li>  5. CAS validates them. </li><li>  6. And generates a random character set - "ticket".  In the future, he identifies the user. </li><li>  7. The request is redirected to our web application, the ticket is passed as a parameter. </li><li>  8. Our web application asks CAS if there is a user with such a ticket. </li><li>  9. If there is, in response, the CAS sends the user login and other data (which depends on how you configure). </li></ul><br><br><h3>  How to setup </h3><br><h4>  Own authorization method </h4><br>  First we need to define our logic for checking username and password.  To do this, we need to override the class <i>org.jasig.cas.authentication.handler.support.AbstractUsernamePasswordAuthenticationHandler:</i> <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> mypack; <span class="hljs-comment"><span class="hljs-comment">/** * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> http://habrahabr.ru/users/nucleotide/ */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyAuthenticationHandler</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractUsernamePasswordAuthenticationHandler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">authenticateUsernamePasswordInternal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( // </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">,    </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> UsernamePasswordCredentials credentials)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> AuthenticationException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> credentials.getUsername().equals(credentials.getPassword()); } }</code> </pre> <br><br>  After that, you need to change the configuration of the Spring context so that CAS knows that you need to use MyAuthenticationHandler. <br>  If you know little about Spring, then you can search for <a href="http://habrahabr.ru/search/%3Fq%3Dspring">something on it</a> or read the documentation on <a href="http://www.springsource.org/">www.springsource.org</a> . <br>  In CAS, the basic Spring configuration that we may need is in the deployerConfigContext.xml file.  Add our class: <br><br><pre> <code class="xml hljs">. . . . . <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"authenticationHandlers"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.jasig.cas.authentication.handler.support.HttpBasedServiceCredentialsAuthenticationHandler"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">p:httpClient-ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"httpClient"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mypack.MyAuthenticationHandler"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> . . . . .</code> </pre><br><br>  Everything that we may need for a login (for example, a dataSource) can also be injected in the Spring context: <br><br><pre> <code class="xml hljs">. . . . . <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"authenticationHandlers"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.jasig.cas.authentication.handler.support.HttpBasedServiceCredentialsAuthenticationHandler"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">p:httpClient-ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"httpClient"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mypack.MyAuthenticationHandler"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dataSource"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dataSource"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> . . . . .</code> </pre><br><h3>  Unfolding </h3><br>  To deploy, you need a server with jvm installed and some DBMS.  Even if you do not use a DBMS for authorization, CAS uses it to store its service tables. <br>  In these tables it stores lists of addresses where authorization through this server is possible. <br>  For example, if we need to log in to example.com through our CAS, but it is not listed, then authorization will fail (remember: the address of the site where the login occurs is passed as a parameter).  You can not use any lists at all, allowing you to log in with any addresses. <br><br><h3>  How to configure the client </h3><br>  Jasic already has several ready-made libraries for working with CAS (for java, .net and php).  In the case of Java, these are ready-made HTTP filters that only need to be configured (how to do this, you can read here: <a href="">https://wiki.jasig.org/display/CASC/CAS+Client+for+Java+3.1</a> ) . <br>  Or create your own, inheriting from org.jasig.cas.client.util.AbstractCasFilter. <br><br><hr><br>  Everything else is already refinement and customization to fit your needs.  From my own experience I can say that the deployment and refinement of CAS is not a very complicated and lengthy process.  You can bind and captcha, and statistics, design of course. <br><br>  References: <br>  You can take it on <a href="http://www.jasig.org/cas/download">the download page.</a> <br>  The picture is taken from here: <br>  Jasig: <a href="http://www.jasig.org/cas">http://www.jasig.org/cas</a> <br>  A list of portals where CAS is already in use: <a href="http://www.jasig.org/cas/deployments">http://www.jasig.org/cas/deployments</a> <br>  License: <a href="http://www.jasig.org/cas/license">http://www.jasig.org/cas/license</a> </div><p>Source: <a href="https://habr.com/ru/post/130289/">https://habr.com/ru/post/130289/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../130282/index.html">Windows 8 interface slightly fixed</a></li>
<li><a href="../130284/index.html">The way to accelerate the Nvidia video card in Linux</a></li>
<li><a href="../130285/index.html">Notes on design patterns</a></li>
<li><a href="../130286/index.html">12+ useful Google Chrome chrome: // commands</a></li>
<li><a href="../130287/index.html">Example of using undocumented Windows function</a></li>
<li><a href="../130290/index.html">Google Street View started shooting in the center of Kazan</a></li>
<li><a href="../130293/index.html">Zynga announced its social network for games</a></li>
<li><a href="../130294/index.html">The most impressive HTML5 apps for demonstrating WebGL</a></li>
<li><a href="../130296/index.html">How to make an application for Windows Phone in 10 minutes?</a></li>
<li><a href="../130297/index.html">Mobile device locked under AT & T? Speak English? Unlock it for free</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>