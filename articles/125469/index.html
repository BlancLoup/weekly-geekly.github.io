<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to symfony 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The release of symfony 2 seemed like a good enough reason to finally find the time and see what one of the most popular PHP frameworks in the world is...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to symfony 2</h1><div class="post__text post__text-html js-mediator-article">  The release of symfony 2 seemed like a good enough reason to finally find the time and see what one of the most popular PHP frameworks in the world is.  I described my acquaintance with him in this article.  Since this is my first experience with symfony, I will be glad if you notice any mistakes or shortcomings and let me know about them. <br><a name="habracut"></a><br><h4>  1. Installation and configuration </h4><br>  You can download the distribution from the <a href="http://symfony.com/download">official site</a> .  I think it is better to download the version-standart that comes with all the additional components.  Further, I assume that the archive was unpacked into the root folder of your web server. <br>  Check that everything works correctly on this link: <a href="http://localhost/Symfony/web/config.php">http: //localhost/Symfony/web/config.php</a> . <br>  If everything is fine, then you can start, but first you need to comment out one line in the symfony / web / app_dev.php file <br><br> <code>$kernel-&gt;loadClassCache();</code> <br> <br>  A very strange solution, by default, enable the cache in development mode. <br><br><h4>  2. Creating a new application </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Applications in symfony 2 have a modular structure, the modules are called bundles.  Our demo application will be in its separate bundle.  There are a lot of console commands in symfony that will help you in your work.  There is a corresponding command for generating the structure of the new bundle: <br><br> <code>php app/console generate:bundle --namespace=Demos/BlogBundle</code> <br> <br>  This command needs to be executed from the console, being in the Symfony / folder.  If you are working in Linux, you can assign the console file permissions to execute and not write php in front of it.  The generator will ask a few simple questions for each of which it has a default answer.  Since we are creating our first application, we agree on all options.  So, pressing the enter key several times will get the skeleton of our bundle in the symfony / src / Demos / BlogBundle folder. <br><br><h4>  3. The controller and the basics of routing </h4><br>  Like most modern frameworks, symfony follows the MVC pattern.  We will begin our acquaintance with the implementation of this pattern in symfony with the last letter, i.e.  controller. <br>  Our little bundle already has one controller, it is called DefaultController and is located in the src / Demos / BlogBundle / Controller folder.  If you look inside of him, you will see that he has an indexAction action.  Now we will see what he does.  Open the address <a href="http://localhost/Symfony/web/app_dev.php/hello/username">http: //localhost/Symfony/web/app_dev.php/hello/username</a> in your browser. <br>  You may wonder why this is exactly the address of this page, but if you look closely at PHPDoc (these are special comments that start with / ** characters) before the indexAction function, you will probably understand everything.  <a href="https://habrahabr.ru/users/route/" class="user_link">Route</a> annotation indicates to which address this action is available and which parameter it has. <br>  In general, the same can be achieved without annotations, but they are used everywhere in symfony, so it's best to get used to them right away.  On the one hand, they are more concise, and on the other hand, autocomplete in my favorite <a href="http://www.jetbrains.com/phpstorm/">IDE is</a> not well supported for them. <br>  A special component of Routing is responsible for setting up how the urls of your application will look, it allows you to customize everything very flexibly.  More details can be found in the corresponding <a href="http://symfony.com/doc/current/book/routing.html">section of the documentation</a> .  We will briefly consider why our application opens precisely at this address and why it was not necessary for us to set anything up for this. <br>  If you didn‚Äôt read very carefully what the bundle generator asked you, you could easily have missed asking whether to update the routing settings in accordance with the new bundle.  If you missed, you can open the Symfony \ app \ config \ routing.yml file.  There you will see the following entry: <br><br> <code>DemosBlogBundle: <br> resource: "@DemosBlogBundle/Controller/" <br> type: annotation <br> prefix: / <br></code> <br>  The first line is the name of the section with the configuration, it corresponds to the name of our bundle.  The second line indicates where to import the settings.  In this case, they will read all the files from the folder with the controllers, and the next line says that all the necessary settings are described in the action annotations.  Well, we have already seen the annotations.  And finally, the last line indicates which prefix will be added to all URLs from our bundle.  By default, all URLs are accessible directly from the input script.  Let's change / to / blog to make it more logical. <br>  Now everything we will do will be available at <a href="http://localhost/Symfony/web/app_dev.php/blog">http: //localhost/Symfony/web/app_dev.php/blog</a> . <br><br><h4>  4. Working with Doctrine: creating a model </h4><br>  We now turn to the next step - working with the database.  I will use Doctrine, although no one is obliged to do this, instead of doctrine, you can use any way you like to work with DB.  However, the doctrine is well integrated with symfony and it is a pleasure to work with it. <br>  To begin, set up a connection to the database.  Open the file app / config / parameters.ini and describe your settings.  By the way, I wonder why all the settings are defaulted in yml, and this one in the ini-file.  If you specified a non-existing database in the settings, then run the following command: <br>  php app / console doctrine: database: create <br>  and the doctrine itself will create it. <br>  The doctrine is a full-fledged <a href="http://ru.wikipedia.org/wiki/ORM">ORM</a> , but it is postponed by another principle than <a href="http://ru.wikipedia.org/wiki/ActiveRecord">ActiveRecord</a> , with which many now unambiguously associate this concept.  The doctrine implements the Data Mapper template, which is very detailed <a href="http://wiki.agiledev.ru/doku.php%3Fid%3Dooad:dp:data_mapper">here</a> . <br>  First we need to describe the entity with which we will work.  This will be a Post class with the properties we need.  Create a folder src / Demos / BlogBundle / Entity.  In it, create a Post.php file and fill it with the following code: <br><br> <code>&lt;?php <br> namespace Demos\BlogBundle\Entity; <br> <br> use Doctrine\ORM\Mapping as ORM; <br> <br> /** <br> * @ORM\Entity <br> * @ORM\Table(name="post") <br> */ <br> class Post { <br> <br> /** <br> * @ORM\Id <br> * @ORM\Column(type="integer") <br> * @ORM\GeneratedValue(strategy="AUTO") <br> */ <br> protected $id; <br> <br> /** <br> * @ORM\Column(type="string", length=255) <br> */ <br> protected $title; <br> <br> /** <br> * @ORM\Column(type="text") <br> */ <br> protected $body; <br> <br> /** <br> * @ORM\Column(type="datetime") <br> */ <br> protected $created_date; <br> <br> /** <br> * @ORM\Column(type="datetime") <br> */ <br> protected $updated_date; <br> }</code> <br> <br>  The class itself is in no way associated with the database, but the annotations contain a description of which of the class properties will be columns of the table and what type they will be.  I think from the annotations everything is quite obvious.  All properties are declared protected, so you must create getters and setters to access them.  For this we use the appropriate command of the doctrine: <br><br> <code>php app/console doctrine:generate:entities Demos/BlogBundle/Entity/Post</code> <br> <br>  Now look at the Post.php file, it should have appeared appropriate methods.  We have a description of the model, for it you need to create the appropriate table in the database.  To do this, run: <br><br> <code>php app/console doctrine:schema:update --force</code> <br> <br>  If everything went without errors, then the post table should appear in your database.  Let's move on to working directly with objects.  In the DefaultController class, create a new action with this code: <br><br> <code>/** <br> * @Route("/create") <br> */ <br> public function createAction() { <br> $post = new Post(); <br> $post-&gt;setTitle('Demo Blog'); <br> $post-&gt;setBody('Hello Symfony 2'); <br> $post-&gt;setCreatedDate(new \DateTime("now")); <br> $post-&gt;setUpdatedDate(new \DateTime('now')); <br> <br> $em = $this-&gt;getDoctrine()-&gt;getEntityManager(); <br> $em-&gt;persist($post); <br> $em-&gt;flush(); <br> <br> return new Response('Created product id ' . $post-&gt;getId()); <br> } <br></code> <br><br>  And at the beginning of the file you need to add the import of the necessary namespaces: <br><br> <code>use Demos\BlogBundle\Entity\Post; <br> use Symfony\Component\HttpFoundation\Response;</code> <br> <br>  Now, if you open the address <a href="http://localhost/Symfony/web/app_dev.php/blog/create">http: //localhost/Symfony/web/app_dev.php/blog/create</a> , then you should receive the id of the created entry in response. <br>  Now create an action to display the existing records.  For this we need an action with a parameter that will take the id of the record. <br><br> <code>&lt;?php <br> /** <br> * @Route("/show/{id}") <br> */ <br> public function showAction($id) <br> { <br> $post = $this-&gt;getDoctrine()-&gt;getRepository('DemosBlogBundle:Post')-&gt;find($id); <br> <br> if (!$post) { <br> throw $this-&gt;createNotFoundException('  !'); <br> } <br> <br> $html = &lt;&lt;&lt;HTML <br> &lt;h1&gt;{$post-&gt;getTitle()}&lt;/h1&gt; <br> <br> &lt;p&gt;{$post-&gt;getBody()}&lt;/p&gt; <br> <br> &lt;hr/&gt; <br> &lt;small&gt;  {$post-&gt;getCreatedDate()-&gt;format("Ymd H:i:s")}&lt;/small&gt; <br> HTML; <br> <br> return new Response($html); <br> } <br> ?&gt; <br></code> <br><br>  Now you can view the record by following the link <a href="http://localhost/Symfony/web/app_dev.php/blog/show/1">http: //localhost/Symfony/web/app_dev.php/blog/show/1</a> .  On this doctrine is complete, the details in the <a href="http://www.doctrine-project.org/docs/orm/2.1/en/index.html">documentation</a> . <br><br><h4>  5. Twig: first patterns </h4><br>  It's time to move on to the final part of our acquaintance with symfony.  At the last step, we didn‚Äôt do well by mixing the logic of working with the output of a record in showAction.  The View will help us to get rid of this drawback (in Russian, the ‚Äúlook‚Äù doesn‚Äôt sound very good, so I‚Äôll call it a view;). <br>  Symfony uses Twig as a template engine, perhaps the best PHP template engine I've worked with.  Like any other component of a symphony, you can replace it with something you like. <br>  As you remember, the indexAction action has a special annotation, <a href="https://habrahabr.ru/users/template/" class="user_link">Template</a> (), which says that it has a template. <br><br> <code>return array('name' =&gt; $name);</code> <br> <br>  The array that is returned from the action is passed to the view, the array keys will be the names of the variables that will be available there. <br>  Let's change the show action.  You need to add the corresponding annotation and instead of returning the Response object to return an array in which the record will be viewed.  Here's what happened: <br><br> <code>/** <br> * @Route("/show/{id}") <br> * @Template() <br> */ <br> public function showAction($id) <br> { <br> $post = $this-&gt;getDoctrine()-&gt;getRepository('DemosBlogBundle:Post')-&gt;find($id); <br> <br> if (!$post) { <br> throw $this-&gt;createNotFoundException('  !'); <br> } <br> <br> return array('post' =&gt; $post); <br> }</code> <br> <br>  Agree, so much better.  Now in the src / Demos / BlogBundle / Resources / views / Default folder create a show.html.twig file into which you transfer the html code that we had to the action movie.  The syntax of a twig is different from php, so you have to change something.  The final version, see the source.  You can learn more about syntax tvig in its <a href="http://www.twig-project.org/documentation">documentation</a> . <br><br><h4>  6. Conclusion </h4><br>  Perhaps this will stop.  I hope someone else besides me will be interested.  At the beginning, it was a bit tricky to work with symfony, but still interesting.  All sources are available on <a href="https://github.com/karagodin/SymfonyDemos">github</a> . </div><p>Source: <a href="https://habr.com/ru/post/125469/">https://habr.com/ru/post/125469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../125463/index.html">Symfony2 Book in pdf format</a></li>
<li><a href="../125464/index.html">Search service for Russian books for Kindle</a></li>
<li><a href="../125465/index.html">Statusboard.me announced beta testing</a></li>
<li><a href="../125466/index.html">REG.RU opens privileged club</a></li>
<li><a href="../125467/index.html">MySQL: optimized construction between</a></li>
<li><a href="../125470/index.html">How to save on software</a></li>
<li><a href="../125471/index.html">Free market niche = profitability of a business on it?</a></li>
<li><a href="../125473/index.html">In October, will begin voluntary certification of online stores</a></li>
<li><a href="../125482/index.html">Euclideon software ray tracing technology</a></li>
<li><a href="../125483/index.html">Parking Android or mobile parking application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>