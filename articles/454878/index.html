<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We study MITER ATT & CK. Mobile Matrices: Device Access. Part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Retrieving credentials (Credential Access) 
 Links to all parts: 
 Part 1. Initial access to a mobile device (Initial Access) 
 Part 2. Persistence an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We study MITER ATT & CK. Mobile Matrices: Device Access. Part 3</h1><div class="post__text post__text-html js-mediator-article"><h2>  <a href="https://attack.mitre.org/tactics/TA0031/">Retrieving credentials (Credential Access)</a> </h2><br>  <b>Links to all parts:</b> <br>  <a href="https://habr.com/ru/post/451602/">Part 1. Initial access to a mobile device (Initial Access)</a> <br>  <a href="https://habr.com/ru/post/454714/">Part 2. Persistence and Privilege Escalation</a> <br><br>  To implement unauthorized access to mobile device resources by opponents, various methods are used to capture passwords, tokens, cryptographic keys and other credential items.  Obtaining legitimate credentials by an adversary allows identifying and obtaining all the permissions of a compromised account in the system or network, which makes it difficult to detect malicious activity.  With appropriate access, the enemy can also create legitimate accounts for their use in the attacked environment. <br><a name="habracut"></a><br>  <i>The author is not responsible for the possible consequences of the application of the information contained in the article, and also apologizes for any inaccuracies in some formulations and terms.</i>  <i>The published information is a free retelling of the content of the <a href="https://attack.mitre.org/matrices/mobile/">ATT @ CK Mobile Matrices: Device Access</a> .</i> <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1453">Abuse Accessibility Features</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> Android Accessibility Features is a suite of tools for people with disabilities.  Malicious apps can use Android‚Äôs accessibility features to retrieve sensitive data or perform malicious actions.  The fact is that APIs that provide accessibility services allow you to access the contents of the interfaces with which the user interacts (for example, reading or creating an e-mail, editing a document, etc.).  This functionality ensures the ability of people with disabilities to work with publicly available mobile applications.  This functionality of the OS also attracts malware authors, but to activate the Android Accessibility Features services, the user must perform a number of unusual security warnings at the end. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>Protection recommendations: The</i> OS version of Android 7.0 and above includes additional protection from this technique.  Before allowing installation of an application in a corporate environment, it is recommended to check it for the possibility of abuse of special features or implement Mobile App Reputation Service to detect known malicious applications. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1413">Access sensitive data in device logs (Access Sensitive Data in Device Logs)</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> In Android up to version 4.1, an attacker can use a malicious application that owns the READ_LOGS permission to retrieve private keys, passwords, and other credential and confidential data stored in the device‚Äôs system log.  In Android 4.1 and later, an attacker can access the log only after successful escalation of privileges in the OS. <br><br>  <i>Security Tips:</i> If you are a mobile application developer, then you should not write sensitive data to the system log of production applications. <br>  Starting with Android 4.1, applications cannot access the system log (except for those records that are added by the application itself).  With physical access to the device, the system log can be accessed via USB using the <a href="https://developer.android.com/studio/command-line/adb">Android Debug Bridge (adb)</a> utility. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1409">Access sensitive information or credentials in files (Access Sensitive Data or Credentials in Files)</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description: An</i> attacker may attempt to read files containing confidential or credentials (private keys, passwords, access tokens).  This method requires either elevated privileges in the OS or the presence of a target application in the system that stores data in an insecure way (with unsafe access rights or in an unsafe place, for example, in an external storage directory). <br><br>  <i>Security Tips:</i> Ensure that the applications you use do not store sensitive data with insecure rights or in an insecure place.  Android and iOS provide hardware-based credential storage in an isolated location where they will not be compromised even if privilege escalation is successful.  Android 7 provides a higher level of file permissions per default in the application‚Äôs internal directory, reducing the possibility of using insecure rights. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1416">Target capture intentions (Android Intent Hijacking)</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> Android Intent or Intent is an interprocess messaging object with which one application can request an action to be taken from a component of another application.  A malicious application can register to receive Intentions (intents) intended for other applications, and then receive confidential values, such as OAuth authorization codes. <br><br>  <i>Security Tips:</i> The process of testing applications for potential flaws should include identifying insecure use of intentions (Intent).  Mobile application developers should use methods to ensure that intentions are sent only to the appropriate destination (for example, use explicit intentions, check permissions, check the certificate of the target application, or use <a href="https://developer.android.com/training/app-links/index.html">App Links</a> (the function by which the user is redirected to the target application bypassing the application selection dialog box ) added in Android 6.0. For mobile applications using OAuth, it is recommended to follow <a href="https://tools.ietf.org/html/rfc8252">best practices</a> . <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1414">Clipboard Data Capture (Capture Clipboard Data)</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description:</i> Malicious applications may attempt to capture sensitive data stored in the device's clipboard, for example, passwords copied / pasted from the Password manager application. <br><br>  <i>Protection recommendations:</i> In the corporate environment, it is recommended to implement application verification processes for vulnerabilities and unwanted actions, application installation restriction policies and Bring Your Own Device (BYOD) policies, which impose restrictions only on the part of the device controlled by the enterprise.  EMM / MDM systems or other solutions for protecting mobile devices may detect the presence of unwanted or malicious applications on corporate devices. <br><br><h3>  <a href="http://ttps//attack.mitre.org/techniques/T1412">Capture SMS Messages (Capture SMS Messages)</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description: A</i> malicious application may collect sensitive data sent in SMS messages, including authentication data.  SMS messages are often used to transmit multifactor authentication codes. <br><br>  The Android application must request and receive permission to receive SMS messages during installation or execution.  Alternatively, a malicious application may try to elevate privileges in order to circumvent this protection.  iOS applications cannot access SMS messages during normal operation, so the adversary will need to first perform a privilege elevation attack. <br><br>  Security Tips <i>:</i> In a corporate environment, it is recommended that applications be pre-checked for the RECEIVE_SMS permission.  If such permission is detected, the application requires a detailed analysis. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1405">Exploiting TEE Vulnerability Vulnerability</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> Malicious applications or another attack vector can be used to exploit code vulnerabilities executed in the Trusted Execution Environment (TEE).  The adversary can then receive the privileges that the TEE has, including the ability to access cryptographic keys or other sensitive data.  To attack a TEE opponent, you may first need elevated privileges in the OS.  If not, TEE privileges can be used to exploit OS vulnerabilities. <br><br>  <i>Protection recommendations:</i> Check the application for known vulnerabilities.  Security updates.  Using the latest OS versions. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1417">Malicious Third Party Keyboard (Malicious Third Party Keyboard App)</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description: A</i> malicious application can register as a device keypad and intercept keystrokes as the user enters sensitive data, such as a username and password. <br><br>  <i>Security Tips:</i> Applications are rarely registered as a keyboard, so those applications that do this should be carefully analyzed during the pre-testing process.  Both iOS and Android require user explicit permission to use third-party software keyboards.  Users are advised to take extreme care before granting such permission (when requested). <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1410">Capture or redirect network traffic (Network Traffic Capture or Redirection)</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description: An</i> attacker can capture inbound and outbound traffic or redirect network traffic to pass through an enemy-controlled gateway for receiving credentials and other confidential data. <br><br>  A malicious application can register as a VPN client on Android or iOS in order to gain access to network packets.  However, on both platforms, the user must give consent to the application to perform the functions of the VPN client, and on iOS, the application requires special permission from Apple. <br><br>  Alternatively, a malicious application may try to elevate privileges in order to gain access to network traffic.  An adversary can redirect network traffic to a gateway controlled by it, by establishing a VPN connection or by changing the proxy settings on the attacked device.  An example of this is the ability to redirect network traffic by installing a malicious iOS configuration profile ( <a href="https://www.symantec.com/connect/blogs/malicious-profiles-sleeping-giant-ios-security">link to the source</a> ). <br><br>  <i>Security</i> Tips <i>:</i> Carefully read the application that requests VPN access before allowing it.  Encrypting traffic is not always effective, because  the adversary can intercept traffic before encrypting it.  Both iOS and Android visualize the setup of the VPN connection in the top status bar of the device. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1415">URL Schema Interception (URL Scheme Hijacking)</a> </h3><br>  <i>Platform:</i> iOS <br>  <i>Description:</i> URL schemes (as Apple calls them) are URL handlers that can be called by Safari or can be used by an application to call another application.  For example, the tel: scheme can be used to launch the Phone application and dial a specific number by placing the corresponding HTML code on the target page: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tel:"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Scheme skype: will launch a Skype call ": <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"skype:user?call"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  iOS allows applications of different developers to share the same URL schemes.  A malicious application can maliciously register using the URL scheme of another application, which will allow it to intercept a legitimate application call and obtain user credentials or OAuth authorization codes using a phishing interface. <br><br>  Security Tips <i>:</i> When analyzing an application‚Äôs security, check for potentially dangerous URL schemes.  Give preference to programs that, as an alternative to URL schemes, use universal links (this is a link when moving to which the user is redirected to a specific installed application). <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1411">User Interface Spoofing</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description:</i> User interface spoofing is used to trick a user into providing confidential information, including credentials, bank details, or personal data. <br><br>  <b>Substitution UI legitimate applications or functions of the device</b> <br><br>  On both Android and iOS, an adversary can impersonate the user interface of a legitimate application or device function, forcing the user to enter confidential information.  The limited display size of mobile devices (as compared to PCs) can degrade the ability to provide the user with contextual information (for example, displaying the full website address), which could warn the user about the danger.  An attacker can also use this technique without having a presence on a mobile device, for example, through a fake webpage. <br><br>  <b>The substitution of a legitimate application</b> <br><br>  A malicious application can completely repeat the target application ‚Äî use the same name, icon and be installed on the device through an authorized app store or delivered by other means ( <a href="https://habr.com/ru/post/451602/">see application delivery techniques</a> ), and then request the user to enter confidential information. <br><br>  <b>Abuse of OS capabilities to interfere with a legitimate application</b> <br><br>  In older versions of Android, a malicious application can use the regular functions of the OS to interfere with a running application.  This is the outdated <a href="https://developer.android.com/reference/android/app/ActivityManager.html">ActivityManager.getRunnigTasks</a> method (available in Android prior to version 5.1.1), which allowed getting a list of OS processes and defining a foreground application, for example, to launch a fake double interface. <br><br>  <i>Security Tips:</i> In a corporate environment, it is recommended to organize application checks for vulnerabilities and undesirable actions (malicious or violating confidentiality), implementing application installation restriction policies or ‚ÄúBring Your Own Device (BYOD)‚Äù policies (bring your own device). only on the part of the device controlled by the company.  Training, training, and user guides will help support a specific configuration of corporate devices, and sometimes even prevent specific user risky actions. <br><br>  EMM / MDM systems or other solutions for protecting mobile devices can automatically detect the presence of unwanted or malicious applications on corporate devices.  Software developers typically have the ability to scan app stores for unauthorized apps that were sent using their developer ID. <br><br>  It is recommended to use only the latest versions of mobile OS, which, as a rule, contain not only fixes, but also have an improved security architecture that provides resistance to previously undetected vulnerabilities. </div><p>Source: <a href="https://habr.com/ru/post/454878/">https://habr.com/ru/post/454878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454868/index.html">Compiling C to WebAssembly without Emscripten</a></li>
<li><a href="../45487/index.html">How much is a hundred credit cards?</a></li>
<li><a href="../454872/index.html">Space Invaders: now in 512 bytes (Assembler x86)</a></li>
<li><a href="../454874/index.html">A little bit about multitasking in microcontrollers</a></li>
<li><a href="../454876/index.html">About designing a flexible system of character abilities in games</a></li>
<li><a href="../454880/index.html">"Off-season" in the life of a freelancer: how to survive and survive?</a></li>
<li><a href="../454884/index.html">Readable Naming Tests in JS and Behavioral Pattern</a></li>
<li><a href="../454886/index.html">In the liver sits. Why removal of liver tumors is an indicator of the surgeon's superior skill</a></li>
<li><a href="../45489/index.html">Unicode Normalization</a></li>
<li><a href="../454894/index.html">WWDC 2019 :: what to see</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>