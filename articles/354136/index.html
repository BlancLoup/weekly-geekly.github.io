<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Build rpm packages and configure your repository</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will describe in detail the process of creating rpm packages and organizing the repository. I ask everyone who is interested in this topi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Build rpm packages and configure your repository</h1><div class="post__text post__text-html js-mediator-article"><p>  This article will describe in detail the process of creating rpm packages and organizing the repository.  I ask everyone who is interested in this topic, go under the cat. </p><a name="habracut"></a><br><p>  I took to writing in great detail, so you can browse through things that are obvious to you. </p><br><h1 id="oglavlenie">  Table of contents </h1><br><ul><li>  System installation </li><li>  Preset </li><li>  Assembly site preparation </li><li>  We collect Tmux </li><li>  We collect fbida </li><li>  Configure access via http / https </li><li>  Ftp access setup </li><li>  Conclusion </li></ul><br><h1 id="ustanovka-sistemy">  System installation </h1><br><blockquote>  Theater starts with a hanger </blockquote><p>  Our service begins with the installation of the operating system on it.  Naturally, to build rpm packages we choose the rhel distribution.  In this case, <a href="https://www.centos.org/">CentOS 7</a> was selected. </p><br><h2 id="skachat-centos">  Download CentOS </h2><br><p>  Create a directory where the image will lie and go into it: </p><br><pre><code class="plaintext hljs">mkdir ~/centos &amp;&amp; cd $_</code> </pre> <br><p>  Then you can directly download the image and the files required for verification: </p><br><pre> <code class="plaintext hljs">wget https://mirror.yandex.ru/centos/7/isos/x86_64/CentOS-7-x86_64-Everything-1708.iso wget https://mirror.yandex.ru/centos/7/isos/x86_64/sha256sum.txt.asc</code> </pre> <br><p>  or via torrent using the <a href="https://aria2.github.io/">aria2</a> program, which we first install: </p><br><pre> <code class="plaintext hljs">sudo yum install -y epel-release sudo yum install -y aria2 aria2c https://mirror.yandex.ru/centos/7/isos/x86_64/CentOS-7-x86_64-Everything-1708.torrent cd ~/centos/CentOS-7-x86_64-Everything-1708</code> </pre> <br><h2 id="proverit-obraz">  Check image </h2><br><p>  Download the image a little, you need to check its integrity and reliability, which we will do. </p><br><p>  Download the key for CentOS 7: </p><br><pre> <code class="plaintext hljs">wget http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-7</code> </pre> <br><p>  Let's look at the key and import it: </p><br><pre> <code class="plaintext hljs">gpg --quiet --with-fingerprint RPM-GPG-KEY-CentOS-7 pub 4096R/F4A80EB5 2014-06-23 CentOS-7 Key (CentOS 7 Official Signing Key) &lt;security@centos.org&gt; Key fingerprint = 6341 AB27 53D7 8A78 A7C2 7BB1 24C6 A8A7 F4A8 0EB5 gpg --import RPM-GPG-KEY-CentOS-7 gpg: key F4A80EB5: public key "CentOS-7 Key (CentOS 7 Official Signing Key) &lt;security@centos.org&gt;" imported gpg: Total number processed: 1 gpg: imported: 1 (RSA: 1)</code> </pre> <br><p>  Check the file signature with the checksum of the image: </p><br><pre> <code class="plaintext hljs">gpg --verify sha256sum.txt.asc 2&gt;&amp;1 | grep "Good signature" gpg: Good signature from "CentOS-7 Key (CentOS 7 Official Signing Key) &lt;security@centos.org&gt;"</code> </pre> <br><p>  As we see, everything is fine and now we can check the image itself for integrity: </p><br><pre> <code class="plaintext hljs">sha256sum -c sha256sum.txt.asc 2&gt;&amp;1 | grep OK CentOS-7-x86_64-Everything-1708.iso: OK</code> </pre> <br><h2 id="zapis-obraza-na-nositel">  Burn image to media </h2><br><p>  After we were convinced of the integrity of the image and its authenticity, it would be nice to write it down and install it already!  So let's do it, but first we will decide what we will record. </p><br><h3 id="zapis-obraza-na-disk">  Burn image to disk </h3><br><p>  To record this image, we need a double-sided DVD.  Suppose we found it and write it down by setting wodim beforehand: </p><br><pre> <code class="plaintext hljs">sudo yum install -y wodim sudo wodim dev=/dev/cdrom -eject -v CentOS-7-x86_64-Everything-1708.iso</code> </pre> <br><h3 id="zapis-obraza-na-fleshku">  Burn image to USB flash drive </h3><br><p>  A double-sided DVD is archaic, so let's take a 16 GB flash drive and write the image on it, but first of all / dev / sda here is a flash drive, and you may have another one.  See the fdisk command: </p><br><pre> <code class="plaintext hljs">sudo dd if=CentOS-7-x86_64-Everything-1708.iso of=/dev/sda bs=1M status=progress; sync eject /dev/sda</code> </pre> <br><p>  If <code>status=progress</code> not supported, then as follows: </p><br><pre> <code class="plaintext hljs">watch -n 10 "sudo kill -USR1 $(pgrep ^dd)"</code> </pre> <br><p>  or like this: </p><br><pre> <code class="plaintext hljs">watch -n 10 "sudo pkill -usr1 dd"</code> </pre> <br><p>  or you can use pv: </p><br><pre> <code class="plaintext hljs">sudo yum install -y epel-release sudo yum install -y pv sudo su dd if=CentOS-7-x86_64-Everything-1708.iso | pv | dd of=/dev/sda</code> </pre> <br><h2 id="ustanovka">  Installation </h2><br><p>  How to install Centos 7, it's up to you, you can think about it for RAID and for LVM and a lot more, <br>  I set the minimum package. </p><br><p>  The installation process can be viewed in this <a href="https://youtu.be/W3XTYYoHe9A%3Ft%3D4m49s">video</a> . </p><br><h1 id="prednastroyka">  Preset </h1><br><p>  After installing the system, we need to configure our server. </p><br><h2 id="obnovlenie-i-ustanovka-paketov">  Upgrading and installing packages </h2><br><p>  At the beginning we will update all the installed packages, then we will install the epel repository, which has a lot of useful things for us: </p><br><pre> <code class="plaintext hljs">sudo yum update -y sudo yum install -y epel-release</code> </pre> <br><p>  The next step is to install a group of packages that we need to build, as well as a number of packages necessary for the deployment of the repository. </p><br><pre> <code class="plaintext hljs">sudo yum groupinstall -y "Development Tools" sudo yum install -y glibc-static tree wget vim createrepo sudo yum install -y httpd httpd-devel mod_ssl python2-certbot-apache vsftpd</code> </pre> <br><h2 id="ssh">  Ssh </h2><br><p>  In order to comfortably and securely manage the server, configure SSH. </p><br><p>  It‚Äôs safer to use keys, that's why we will create our own keys for accessing the server on our work computer: </p><br><pre> <code class="plaintext hljs">ssh-keygen</code> </pre> <br><p>  and add the key to the server: </p><br><pre> <code class="plaintext hljs">ssh-copy-id chelaxe@rpmbuild</code> </pre> <br><p>  or handles: </p><br><pre> <code class="plaintext hljs">mkdir ~/.ssh chmod 700 ~/.ssh vim ~/.ssh/authorized_keys ssh-rsa AAAA...tzU= ChelAxe (DFH) &lt;chelaxe@gmail.com&gt; chmod 600 ~/.ssh/authorized_keys</code> </pre> <br><p>  You must also tighten the nuts in the service itself.  Create a copy of the configuration file and start editing: </p><br><pre> <code class="plaintext hljs">sudo cp /etc/ssh/sshd_config{,.bak} sudo vim /etc/ssh/sshd_config</code> </pre> <br><p>  The file should add / change / uncomment the following lines: </p><br><pre> <code class="plaintext hljs">#       192.168.0.2 ListenAddress 192.168.0.2 #     30  LoginGraceTime 30 #   root  PermitRootLogin no #     MaxAuthTries 3 #     PasswordAuthentication no #  10     ClientAliveInterval 600 ClientAliveCountMax 0 #     chelaxe AllowUsers chelaxe #       chelaxe AllowGroups chelaxe #  sshd     SSH2 Protocol 2</code> </pre> <br><p>  Restart the service: </p><br><pre> <code class="plaintext hljs">sudo systemctl restart sshd</code> </pre> <br><h2 id="mezhsetevoy-ekran">  Firewall </h2><br><p>  It is important to restrict access to our server.  For this reason, we configure the firewall: </p><br><pre> <code class="plaintext hljs">sudo firewall-cmd --permanent --zone=public --remove-service=dhcpv6-client sudo firewall-cmd --permanent --zone=public --remove-service=ssh sudo firewall-cmd --permanent --zone=public --add-rich-rule='rule family="ipv4" source address="192.168.0.0/28" service name="ssh" accept' sudo firewall-cmd --permanent --zone=public --add-service=http sudo firewall-cmd --permanent --zone=public --add-service=https sudo firewall-cmd --permanent --zone=public --add-service=ftp sudo firewall-cmd --permanent --list-all public target: default icmp-block-inversion: no interfaces: sources: services: http https ftp ports: protocols: masquerade: no forward-ports: source-ports: icmp-blocks: rich rules: rule family="ipv4" source address="192.168.0.0/28" service name="ssh" accept sudo firewall-cmd --reload</code> </pre> <br><p>  Here we added our http https ftp services for accessibility from outside and ssh, but only for the network 192.168.0.0/28. </p><br><h1 id="podgotovka-ploschadki-sborki">  Assembly site preparation </h1><br><p>  Prepare the very site for assembly.  It is worth noting that the assembly is most likely to be carried out on a separate virtual host, actively using the technology of snapshots, but here I will describe everything in a single whole.  Also for the assembly you need to select an individual user who is not an administrator (i.e. <code>sudo</code> is not available to him). </p><br><h2 id="sozdanie-direktoriy">  Creating directories </h2><br><p>  Create the necessary directories: </p><br><pre> <code class="plaintext hljs">mkdir -p ~/rpmbuild/{BUILD,BUILDROOT,RPMS,SOURCES,SPECS,SRPMS} sudo mkdir /var/www/repo sudo chown -R chelaxe:chelaxe /var/www/repo ln -s /var/www/repo ~/rpmbuild/REPO tree ~/rpmbuild/ /home/chelaxe/rpmbuild/ ‚îú‚îÄ‚îÄ BUILD ‚îú‚îÄ‚îÄ BUILDROOT ‚îú‚îÄ‚îÄ REPO -&gt; /var/www/repo ‚îú‚îÄ‚îÄ RPMS ‚îú‚îÄ‚îÄ SOURCES ‚îú‚îÄ‚îÄ SPECS ‚îî‚îÄ‚îÄ SRPMS 7 directories, 0 files</code> </pre> <br><h2 id="nastroyka-pgp-podpisi">  PGP signature setup </h2><br><p>  Our packages, which we collect, must be signed, which will ensure integrity and reliability. </p><br><p>  We will use our key, or if we don‚Äôt have one, we will create it.  To create a key is on your work computer. </p><br><p>  Create a key if we do not have it: </p><br><pre> <code class="plaintext hljs">gpg --gen-key</code> </pre> <br><p>  We will be asked to answer a series of questions: <br>  key type, select (1) RSA and RSA (default), key size: 4096, expiration date: 6m, our name: Alexander F. Mikhaylov, Email: chelaxe@gmail.com, comment, here you can indicate why we need the key: repo and wait ... </p><br><p>  If suddenly after answering all the questions we get this <code>gpg: cancelled by user</code> , then run the command: </p><br><pre> <code class="plaintext hljs">script /dev/null</code> </pre> <br><p>  and repeat. </p><br><p>  View key: </p><br><pre> <code class="plaintext hljs">gpg --fingerprint chelaxe@gmail.com pub 2048R/E6D53D4D 2014-05-07 Key fingerprint = EE2A FF9A 2BE3 318E 9346 A675 8440 3961 E6D5 3D4D uid ChelAxe (DFH) &lt;chelaxe@gmail.com&gt;</code> </pre> <br><p>  Save our private key: </p><br><pre> <code class="plaintext hljs">gpg --export-secret-keys --armor chelaxe@gmail.com &gt; chelaxe-privkey.asc</code> </pre> <br><p>  Create a key for review: </p><br><pre> <code class="plaintext hljs">gpg --output chelaxe-revoke.asc --gen-revoke chelaxe@gmail.com</code> </pre> <br><p>  Export public key to keyserver: </p><br><pre> <code class="plaintext hljs">gpg --keyserver pgp.mit.edu --send-keys E6D53D4D</code> </pre> <br><p>  Now the key can be imported to our server: </p><br><pre> <code class="plaintext hljs">gpg --import ~/chelaxe-privkey.asc rm -rf ~/chelaxe-privkey.asc</code> </pre> <br><p>  Look where gpg utility is: </p><br><pre> <code class="plaintext hljs">which gpg /usr/bin/gpg</code> </pre> <br><p>  and configure the file to sign the packages: </p><br><pre> <code class="plaintext hljs">vim ~/.rpmmacros %_signature gpg %_gpg_path /home/chelaxe/.gnupg %_gpg_name ChelAxe %_gpgbin /usr/bin/gpg</code> </pre> <br><h2 id="sozdaem-repozitoriy">  Create a repository </h2><br><p>  Now we organize the repository itself. </p><br><p>  Create a directory where we will store the packages: </p><br><pre> <code class="plaintext hljs">mkdir ~/rpmbuild/REPO/Packages</code> </pre> <br><p>  Export the key to the repository: </p><br><pre> <code class="plaintext hljs">gpg --export -a 'ChelAxe' &gt; ~/rpmbuild/REPO/RPM-GPG-KEY-chelaxe</code> </pre> <br><p>  Create the repository itself and sign the metadata: </p><br><pre> <code class="plaintext hljs">createrepo ~/rpmbuild/REPO gpg --detach-sign --armor ~/rpmbuild/REPO/repodata/repomd.xml</code> </pre> <br><h2 id="paket-dlya-repozitoriya">  Repository package </h2><br><p>  Build a package to automatically install the repository in the system </p><br><pre> <code class="plaintext hljs">cd ~/rpmbuild/SOURCES mkdir chelaxe-release &amp;&amp; cd $_</code> </pre> <br><p>  Yum repository file: </p><br><pre> <code class="plaintext hljs">vim ~/rpmbuild/SOURCES/chelaxe-release/chelaxe.repo [chelaxe] name=ChelAxe Official Repository - $basearch baseurl=https://repo.chelaxe.ru/ enabled=1 gpgcheck=1 repo_gpgcheck=1 gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-chelaxe</code> </pre> <br><p>  Export the key for the package: </p><br><pre> <code class="plaintext hljs">gpg --export -a 'ChelAxe' &gt; ~/rpmbuild/SOURCES/chelaxe-release/RPM-GPG-KEY-chelaxe</code> </pre> <br><p>  Putting it all in the archive: </p><br><pre> <code class="plaintext hljs">cd ~/rpmbuild/SOURCES tar -czf chelaxe-release.tar.gz chelaxe-release/</code> </pre> <br><p>  Create a SPECS file for the package: </p><br><pre> <code class="plaintext hljs">cd ~/rpmbuild/SPECS vim ~/rpmbuild/SPECS/chelaxe-release.spec Name: chelaxe-release Version: 1.0 Release: 1%{?dist} Summary: ChelAxe repository configuration Vendor: DFH Packager: ChelAxe Group: System Environment/Base License: GPL URL: https://repo.chelaxe.ru Source0: https://repo.chelaxe.ru/%{name}.tar.gz BuildArch: noarch %description This package contains the ChelAxe official repository GPG key as well as configuration for yum. %prep %setup -q -n %{name} %install %__rm -rf %{buildroot} install -d -m 755 %{buildroot}%{_sysconfdir}/yum.repos.d install -p -m 644 chelaxe.repo %{buildroot}%{_sysconfdir}/yum.repos.d/chelaxe.repo install -d -m 755 %{buildroot}%{_sysconfdir}/pki/rpm-gpg install -p -m 644 RPM-GPG-KEY-chelaxe %{buildroot}%{_sysconfdir}/pki/rpm-gpg/RPM-GPG-KEY-chelaxe %post rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-chelaxe %clean %__rm -rf %{buildroot} %files %defattr(-,root,root,-) %{_sysconfdir}/yum.repos.d/chelaxe.repo %{_sysconfdir}/pki/rpm-gpg/RPM-GPG-KEY-chelaxe %changelog * Tue May 1 2018 ChelAxe (DFH) &lt;chelaxe@gmail.com&gt; - 1.0-1%{?dist} - Initial package.</code> </pre> <br><p>  Putting the package: </p><br><pre> <code class="plaintext hljs">rpmbuild -ba --sign ~/rpmbuild/SPECS/chelaxe-release.spec</code> </pre> <br><p>  At this stage, we will be asked for the password from our PGP key. </p><br><p>  Copy the created package into the repository and update it: </p><br><pre> <code class="plaintext hljs">cp ~/rpmbuild/RPMS/noarch/chelaxe-release-1.0-1.el7.centos.noarch.rpm ~/rpmbuild/REPO/ createrepo --update ~/rpmbuild/REPO</code> </pre> <br><p>  Do not forget to sign the metadata: </p><br><pre> <code class="plaintext hljs">gpg --detach-sign --armor ~/rpmbuild/REPO/repodata/repomd.xml</code> </pre> <br><p>  Now we will install our repository in the system: </p><br><pre> <code class="plaintext hljs">sudo yum install -y ~/rpmbuild/REPO/chelaxe-release-1.0-1.el7.centos.noarch.rpm</code> </pre> <br><p>  In the future, this package will be available at: <a href="">https://repo.chelaxe.ru/chelaxe-release-1.0-1.el7.centos.noarch.rpm</a> </p><br><p>  After installation, the chelaxe repository and the PGP key should appear: </p><br><pre> <code class="plaintext hljs">rpm -q gpg-pubkey --qf '%{name}-%{version}-%{release} --&gt; %{summary}\n' | grep ChelAxe gpg-pubkey-e6d53d4d-5369c520 --&gt; gpg(ChelAxe (DFH) &lt;chelaxe@gmail.com&gt;)</code> </pre> <br><p>  The most important thing here is the SPEC files, I will not describe them, but I will provide a number of links: </p><br><ol><li>  <a href="https://www.altlinux.org/Spec">https://www.altlinux.org/Spec</a> </li><li>  <a href="https://docs.fedoraproject.org/quick-docs/en-US/creating-rpm-packages.html">https://docs.fedoraproject.org/quick-docs/en-US/creating-rpm-packages.html</a> </li><li>  <a href="https://www.opennet.ru/docs/HOWTO-RU/RPM-HOWTO-48.html">https://www.opennet.ru/docs/HOWTO-RU/RPM-HOWTO-48.html</a> </li></ol><br><p>  and one useful command: </p><br><pre> <code class="plaintext hljs">rpm --showrc</code> </pre> <br><p>  it will display the finished macros for the assembly. </p><br><h1 id="sobiraem-tmux">  We collect Tmux </h1><br><p>  Now we will collect, for an example, something useful.  We will <a href="https://github.com/tmux/tmux/wiki">assemble tmux</a> - a terminal multiplexer, without which I am not comfortable working.  It is worth noting tmux is in the CentOS 7 base repository, but the version is 1.8 there, and we will build 2.7.  Also, the package from the base repository has a libevent dependency, but we will build tmux with static libraries of the latest versions. </p><br><h2 id="gotovim-ishodniki">  Cooking source </h2><br><p>  Download the tmux sources and the necessary libraries: </p><br><pre> <code class="plaintext hljs">cd ~/rpmbuild/SOURCES wget https://github.com/tmux/tmux/releases/download/2.7/tmux-2.7.tar.gz wget https://github.com/libevent/libevent/releases/download/release-2.1.8-stable/libevent-2.1.8-stable.tar.gz wget https://github.com/libevent/libevent/releases/download/release-2.1.8-stable/libevent-2.1.8-stable.tar.gz.asc wget ftp://ftp.gnu.org/gnu/ncurses/ncurses-6.1.tar.gz wget ftp://ftp.gnu.org/gnu/ncurses/ncurses-6.1.tar.gz.sig</code> </pre> <br><p>  We export GPG keys for source verification: </p><br><pre> <code class="plaintext hljs">gpg --recv-keys 8EF8686D gpg --recv-keys F7E48EDB</code> </pre> <br><p>  Check files: </p><br><pre> <code class="plaintext hljs">gpg --verify libevent-2.1.8-stable.tar.gz.asc libevent-2.1.8-stable.tar.gz 2&gt;&amp;1 | grep "Good signature" gpg: Good signature from "Azat Khuzhin &lt;a3at.mail@gmail.com&gt;" gpg --verify ncurses-6.1.tar.gz.sig ncurses-6.1.tar.gz 2&gt;&amp;1 | grep "Good signature" gpg: Good signature from "Thomas Dickey &lt;dickey@invisible-island.net&gt;"</code> </pre> <br><p>  Prepare the tmux configuration file: </p><br><pre> <code class="plaintext hljs">vim ~/rpmbuild/SOURCES/tmux.conf #   : #   set-option -g buffer-limit 50 #      set-option -g command-alias[100] zoom="resize-pane -Z" #    set-option -g default-terminal "screen-256color" #    escape set-option -g escape-time 500 #     set-option -g exit-empty off #     set-option -g exit-unattached off #     set-option -g focus-events off #       set-option -g history-file ~/.tmux_history #        set-option -g message-limit 100 #        escape set-option -g set-clipboard on #    set-option -g terminal-overrides[100] "xterm:colors=256" set-option -g terminal-overrides[101] "xterm*:colors=256" set-option -g terminal-overrides[102] "screen:colors=256" set-option -g terminal-overrides[103] "screen*:colors=256" #    # set-option -g user-keys[100] "\e[5;30012~" #   : #     set-option -g activity-action other #       set-option -g assume-paste-time 1 #    set-option -g base-index 1 #  ""   set-option -g bell-action other #     ( default-shell) # set-option -g default-command "vim" # Shell   set-option -g default-shell "/bin/bash" #     set-option -g destroy-unattached off #       set-option -g detach-on-destroy on #     set-option -g display-panes-active-colour "red" #    set-option -g display-panes-colour "green" #     set-option -g display-panes-time 1000 #        .  set-option -g display-time 750 #      set-option -g history-limit 2000 #      set-option -g key-table "root" #      set-option -g lock-after-time 1800 #     set-option -g lock-command "vlock" #     #  : message-command-attr message-command-bg message-command-fg set-option -g message-command-style "bg=black,fg=yellow" #     #  : message-attr message-bg message-fg set-option -g message-style "bg=yellow,fg=black" #   #   2.1  : mode-mouse mouse-resize-pane mouse-select-pane mouse-select-window set-option -g mouse off #   set-option -g prefix Cb #   set-option -g prefix2 Ca #    set-option -g renumber-windows on #        set-option -g repeat-time 500 #    set-option -g set-titles on #    set-option -g set-titles-string "#{session_name}" #  ""   set-option -g silence-action other #    set-option -g status on #     set-option -g status-interval 1 #       set-option -g status-justify left #       set-option -g status-keys vi #      set-option -g status-left " [#{session_name}]#{?session_many_attached,*,} #{version} #[reverse] #[default] " #      set-option -g status-left-length 20 #      #  : status-left-attr status-left-bg status-left-fg set-option -g status-left-style "default" #    set-option -g status-position bottom #      set-option -g status-right " #[reverse] #[default] %a %d %b %Y %H:%M:%S [%V/%j] " #      set-option -g status-right-length 40 #      #  : status-right-attr status-right-bg status-right-fg set-option -g status-right-style "default" #    #  : status-attr status-bg status-fg set-option -g status-style "bg=green,fg=black" #       set-option -g update-environment[100] "TERMINFO" #    # set-option -g user-keys[100] "\e[1~" #       set-option -g visual-activity off #    ""   set-option -g visual-bell off #    ""   set-option -g visual-silence off #       set-option -g word-separators " -_@" #   : #      set-option -gw aggressive-resize on #      set-option -gw allow-rename on #       set-option -gw alternate-screen on #    set-option -gw automatic-rename on #     set-option -gw automatic-rename-format "#{?pane_in_mode,[tmux],#{pane_current_command}}#{?pane_dead,[dead],}" #    set-option -gw clock-mode-colour "green" #    set-option -gw clock-mode-style 24 #       set-option -gw force-height 0 #       set-option -gw force-width 0 #    set-option -gw main-pane-height 24 #    set-option -gw main-pane-width 80 #       set-option -gw mode-keys vi #      #  : mode-attr mode-bg mode-fg set-option -gw mode-style "bg=yellow,fg=black" #     set-option -gw monitor-activity on #  ""   set-option -gw monitor-bell on #  ""  .  . set-option -gw monitor-silence 0 #    set-option -gw other-pane-height 0 #    set-option -gw other-pane-width 0 #     #  : pane-active-border-attr pane-active-border-bg pane-active-border-fg set-option -gw pane-active-border-style "fg=green" #    set-option -gw pane-base-index 1 #     set-option -gw pane-border-format "#{?pane_active,#[reverse],}#{?window_zoomed_flag,#[fg=red],} #{pane_index}:#{=6:pane_current_command} #[default]" #     set-option -gw pane-border-status top #    #  : pane-border-attr pane-border-bg pane-border-fg set-option -gw pane-border-style "fg=green" #       set-option -gw remain-on-exit off #       set-option -gw synchronize-panes off #    set-option -gw window-active-style "default" #         #  : window-status-activity-attr window-status-activity-bg window-status-activity-fg set-option -gw window-status-activity-style "fg=red" #     ""    #  : window-status-bell-attr window-status-bell-bg window-status-bell-fg set-option -gw window-status-bell-style "fg=red" #        set-option -gw window-status-current-format " #{window_index}:#{window_name} " #        #  : window-status-current-attr window-status-current-bg window-status-current-fg set-option -gw window-status-current-style "reverse" #       set-option -gw window-status-format " #{window_index}:#{window_name}#{?window_activity_flag,#,}#{?window_bell_flag,!,}#{?window_silence_flag,~,} " #        #  : window-status-last-attr window-status-last-bg window-status-last-fg set-option -gw window-status-last-style "default" #        set-option -gw window-status-separator "" #       set-option -gw window-status-style "default" #   set-option -gw window-style "default" #    set-option -gw wrap-search on #    set-option -gw xterm-keys on #    #    Alt +  bind-key -rT root M-Up select-pane -U bind-key -rT root M-Down select-pane -D bind-key -rT root M-Left select-pane -L bind-key -rT root M-Right select-pane -R #     bind-key -T root M-PageUp copy-mode -eu #      bind-key -T prefix Ms set-option -gw synchronize-panes\; display-message " : #{?synchronize-panes,on,off}" #   bind-key -T prefix Ml lock-session #   bind-key -T prefix Mr source-file /etc/tmux.conf\; display-message " " #   # bind-key -T prefix Me #   #   new-session -s "work"</code> </pre> <br><h2 id="gotovim-spec-fayl">  Preparing a SPEC file </h2><br><p>  This file will be more interesting than the previous SPEC file: </p><br><pre> <code class="plaintext hljs">cd ~/rpmbuild/SPECS vim ~/rpmbuild/SPECS/tmux.spec %define libevent 2.1.8 %define ncurses 6.1 Name: tmux Version: 2.7 Release: 1%{?dist} Summary: A terminal multiplexer Vendor: DFH Packager: ChelAxe Group: Applications/System License: ISC and BSD URL: https://github.com/%{name}/%{name} Source0: https://github.com/%{name}/%{name}/releases/download/%{version}/%{name}-%{version}.tar.gz Source1: https://github.com/libevent/libevent/releases/download/release-%{libevent}-stable/libevent-%{libevent}-stable.tar.gz Source2: ftp://ftp.gnu.org/gnu/ncurses/ncurses-%{ncurses}.tar.gz Source3: tmux.conf BuildRequires: gcc, gcc-c++, make, glibc-static %description tmux is a "terminal multiplexer", it enables a number of terminals (or windows) to be accessed and controlled from a single terminal. tmux is intended to be a simple, modern, BSD-licensed alternative to programs such as GNU screen. %prep %setup -q -a1 -a2 %build %__mkdir "libs" pushd "libevent-%{libevent}-stable" %_configure \ --prefix="$(pwd)/../libs" \ --disable-shared %__make install popd pushd "ncurses-%{ncurses}" %_configure \ --prefix="$(pwd)/../libs" \ --with-default-terminfo-dir="/usr/share/terminfo" \ --with-terminfo-dirs="/etc/terminfo:/lib/terminfo:/usr/share/terminfo:$HOME/.terminfo" %__make install popd %_configure \ --enable-static \ --prefix="/usr" \ CFLAGS="-Ilibs/include -Ilibs/include/ncurses" \ LDFLAGS="-Llibs/lib -Llibs/include -Llibs/include/ncurses" \ LIBEVENT_CFLAGS="-Ilibs/include" \ LIBEVENT_LIBS="-Llibs/lib -levent" \ LIBNCURSES_CFLAGS="-Ilibs/include" \ LIBNCURSES_LIBS="-Llibs/lib -lncurses" %__make %install %__rm -rf %{buildroot} %make_install install -d -m 755 %{buildroot}%{_sysconfdir} install -p -m 644 %{SOURCE3} %{buildroot}%{_sysconfdir}/tmux.conf %clean %__rm -rf %{buildroot} %files %defattr(-,root,root,-) %doc README TODO CHANGES example_tmux.conf %config(noreplace) %{_sysconfdir}/tmux.conf %{_bindir}/tmux %{_mandir}/man1/tmux.1.gz %changelog * Fri Jun 29 2018 ChelAxe (DFH) &lt;chelaxe@gmail.com&gt; - 2.7-1%{?dist} - Rebuild for new version tmux. * Tue May 1 2018 ChelAxe (DFH) &lt;chelaxe@gmail.com&gt; - 2.6-1%{?dist} - Initial package.</code> </pre> <br><h2 id="sborka">  Assembly </h2><br><p>  Build the package and add it to the repository: </p><br><pre> <code class="plaintext hljs">rpmbuild -ba --sign ~/rpmbuild/SPECS/tmux.spec cp ~/rpmbuild/RPMS/x86_64/tmux-2.7-1.el7.centos.x86_64.rpm ~/rpmbuild/REPO/Packages/ createrepo --update ~/rpmbuild/REPO</code> </pre> <br><p>  Do not forget to sign the metadata: </p><br><pre> <code class="plaintext hljs">gpg --detach-sign --armor ~/rpmbuild/REPO/repodata/repomd.xml</code> </pre> <br><p>  See what and how it happened: </p><br><pre> <code class="plaintext hljs">tree ~/rpmbuild/ -L 2 /home/chelaxe/rpmbuild/ ‚îú‚îÄ‚îÄ BUILD ‚îÇ  ‚îú‚îÄ‚îÄ chelaxe-release ‚îÇ  ‚îî‚îÄ‚îÄ tmux-2.7 ‚îú‚îÄ‚îÄ BUILDROOT ‚îú‚îÄ‚îÄ REPO -&gt; /var/www/repo ‚îú‚îÄ‚îÄ RPMS ‚îÇ  ‚îú‚îÄ‚îÄ noarch ‚îÇ  ‚îî‚îÄ‚îÄ x86_64 ‚îú‚îÄ‚îÄ SOURCES ‚îÇ  ‚îú‚îÄ‚îÄ chelaxe-release ‚îÇ  ‚îú‚îÄ‚îÄ chelaxe-release.tar.gz ‚îÇ  ‚îú‚îÄ‚îÄ libevent-2.1.8-stable.tar.gz ‚îÇ  ‚îú‚îÄ‚îÄ libevent-2.1.8-stable.tar.gz.asc ‚îÇ  ‚îú‚îÄ‚îÄ ncurses-6.1.tar.gz ‚îÇ  ‚îú‚îÄ‚îÄ ncurses-6.1.tar.gz.sig ‚îÇ  ‚îú‚îÄ‚îÄ tmux-2.7.tar.gz ‚îÇ  ‚îî‚îÄ‚îÄ tmux.conf ‚îú‚îÄ‚îÄ SPECS ‚îÇ  ‚îú‚îÄ‚îÄ chelaxe-release.spec ‚îÇ  ‚îî‚îÄ‚îÄ tmux.spec ‚îî‚îÄ‚îÄ SRPMS ‚îú‚îÄ‚îÄ chelaxe-release-1.0-1.el7.centos.src.rpm ‚îî‚îÄ‚îÄ tmux-2.7-1.el7.centos.src.rpm</code> </pre> <br><h2 id="ustanovka-i-zapusk">  Install and Run </h2><br><p>  Install our package: </p><br><pre> <code class="plaintext hljs">sudo yum clean all sudo yum install -y tmux</code> </pre> <br><p>  Run tmux and enjoy: </p><br><pre> <code class="plaintext hljs">tmux attach-session</code> </pre> <br><h1 id="sobiraem-fbida">  We collect fbida </h1><br><p>  We will collect <a href="https://www.kraxel.org/blog/linux/fbida/">fbida</a> - a set of applications for viewing images in the console.  This package is not found under Centos 7. </p><br><h2 id="gotovim-ishodniki-1">  Cooking source </h2><br><p>  Download the fbida sources: </p><br><pre> <code class="plaintext hljs">cd ~/rpmbuild/SOURCES wget https://www.kraxel.org/releases/fbida/fbida-2.14.tar.gz wget https://www.kraxel.org/releases/fbida/fbida-2.14.tar.gz.asc</code> </pre> <br><p>  We export GPG keys for source verification: </p><br><pre> <code class="plaintext hljs">gpg --recv-keys D3E87138</code> </pre> <br><p>  Check files: </p><br><pre> <code class="plaintext hljs">gpg --verify fbida-2.14.tar.gz.asc fbida-2.14.tar.gz 2&gt;&amp;1 | grep "Good signature" gpg: Good signature from "Gerd Hoffmann (work) &lt;kraxel@redhat.com&gt;"</code> </pre> <br><h2 id="gotovim-spec-fayl-1">  Preparing a SPEC file </h2><br><p>   SPEC    : </p><br><pre> <code class="plaintext hljs">cd ~/rpmbuild/SPECS vim ~/rpmbuild/SPECS/fbida.spec Name: fbida Version: 2.14 Release: 1%{?dist} Summary: FrameBuffer Imageviewer Vendor: DFH Packager: ChelAxe Group: Applications/Multimedia License: GPLv2+ URL: https://www.kraxel.org/blog/linux/fbida/ Source: https://www.kraxel.org/releases/fbida/fbida-%{version}.tar.gz BuildRequires: libexif-devel fontconfig-devel libjpeg-turbo-devel BuildRequires: libpng-devel libtiff-devel pkgconfig BuildRequires: giflib-devel libcurl-devel libXpm-devel BuildRequires: pixman-devel libepoxy-devel libdrm-devel BuildRequires: mesa-libEGL-devel poppler-devel poppler-glib-devel BuildRequires: freetype-devel mesa-libgbm-devel Requires: libexif fontconfig libjpeg-turbo Requires: libpng libtiff giflib Requires: libcurl libXpm pixman Requires: libepoxy libdrm mesa-libEGL Requires: poppler poppler-glib freetype Requires: mesa-libgbm ImageMagick dejavu-sans-mono-fonts %description fbi displays the specified file(s) on the linux console using the framebuffer device. PhotoCD, jpeg, ppm, gif, tiff, xwd, bmp and png are supported directly. For other formats fbi tries to use ImageMagick's convert. %prep %setup -q %{__sed} -i -e "s,/X11R6,,g" GNUmakefile %install %__rm -rf %{buildroot} %make_install PREFIX=/usr %clean %__rm -rf %{buildroot} %files %defattr(-,root,root,-) %doc Changes COPYING INSTALL README TODO VERSION %{_prefix}/* %changelog * Tue May 1 2018 ChelAxe (DFH) &lt;chelaxe@gmail.com&gt; - 2.14-1%{?dist} - Initial package.</code> </pre> <br><h2 id="sborka-1">  Assembly </h2><br><p>       : </p><br><pre> <code class="plaintext hljs">sudo yum install -y libexif-devel fontconfig-devel libjpeg-turbo-devel libpng-devel libtiff-devel pkgconfig giflib-devel libcurl-devel libXpm-devel ImageMagick dejavu-sans-mono-fonts pixman-devel libepoxy-devel libdrm-devel mesa-libEGL-devel poppler-devel poppler-glib-devel mesa-libgbm-devel rpmbuild -ba --sign ~/rpmbuild/SPECS/fbida.spec cp ~/rpmbuild/RPMS/x86_64/fbida-2.14-1.el7.centos.x86_64.rpm ~/rpmbuild/REPO/Packages/ createrepo --update ~/rpmbuild/REPO</code> </pre> <br><p>    : </p><br><pre> <code class="plaintext hljs">gpg --detach-sign --armor ~/rpmbuild/REPO/repodata/repomd.xml</code> </pre> <br><h2 id="ustanovka-i-zapusk-1">    </h2><br><p>   : </p><br><pre> <code class="plaintext hljs">sudo yum clean all sudo yum install -y fbida</code> </pre> <br><h1 id="nastroyka-dostupa-po-httphttps">    http/https </h1><br><p>        http/https. </p><br><h2 id="nastroyka">  Customization </h2><br><p>     Apache: </p><br><pre> <code class="plaintext hljs">sudo mv /etc/httpd/conf.d/welcome{.conf,.bak} sudo cp /etc/httpd/conf/httpd{.conf,.bak}</code> </pre> <br><p>   //  : </p><br><pre> <code class="plaintext hljs">sudo vim /etc/httpd/conf/httpd.conf #       Listen 192.168.0.2:80 # Email     ServerAdmin chelaxe@gmail.com ServerName repo.chelaxe.ru #    Apache ServerSignature Off ServerTokens Prod sudo cp /etc/httpd/conf.d/ssl{.conf,.bak} sudo vim /etc/httpd/conf.d/ssl.conf #       Listen 192.168.0.2:443 https # OCSP (Online Certificate Status Protocol) SSLStaplingCache "shmcb:logs/stapling-cache(128000)"</code> </pre> <br><p>  : </p><br><pre> <code class="plaintext hljs">sudo apachectl configtest Syntax OK</code> </pre> <br><p>       : </p><br><pre> <code class="plaintext hljs">sudo systemctl start httpd sudo systemctl enable httpd</code> </pre> <br><p>   : </p><br><pre> <code class="plaintext hljs">#      - cd /etc/ssl/certs sudo openssl dhparam -out dhparam.pem 4096 #     HKPK (HTTP Public Key Pinning) sudo openssl x509 -noout -in /etc/pki/tls/certs/localhost.crt -pubkey | openssl asn1parse -noout -inform pem -out /tmp/public.key #      HKPK (HTTP Public Key Pinning) openssl dgst -sha256 -binary /tmp/public.key | openssl enc -base64 aQxRkBUlhfQjidLUovOlxdZe/4ygObbDG7l+RgwzSWA= rm -rf /tmp/public.key</code> </pre> <br><p>  VirtualHost : </p><br><pre> <code class="plaintext hljs">sudo vim /etc/httpd/conf.d/repo.conf &lt;VirtualHost "192.168.0.2:80"&gt; ServerAdmin "chelaxe@gmail.com" ServerName "repo.chelaxe.ru" DocumentRoot "/var/www/repo" &lt;Directory "/var/www/repo"&gt; AllowOverride None Options Indexes &lt;/Directory&gt; &lt;/VirtualHost&gt; &lt;VirtualHost "192.168.0.2:443"&gt; ServerAdmin "chelaxe@gmail.com" ServerName "repo.chelaxe.ru" DocumentRoot "/var/www/repo" &lt;Directory "/var/www/repo"&gt; AllowOverride None Options Indexes &lt;/Directory&gt; SSLEngine on # HSTS (HTTP Strict Transport Security) Header always set Strict-Transport-Security "max-age=63072000; includeSubdomains; preload" # HKPK (HTTP Public Key Pinning) Header set Public-Key-Pins "pin-sha256=\"aQxRkBUlhfQjidLUovOlxdZe/4ygObbDG7l+RgwzSWA=\"; max-age=2592000; includeSubDomains" #    Header set X-Robots-Tag "none" #    XSS- Header set X-XSS-Protection "1; mode=block" #   - Header always append X-Frame-Options DENY #    MIME  Header set X-Content-Type-Options nosniff #   XSS- Header set Content-Security-Policy "default-src 'self';" # OCSP (Online Certificate Status Protocol) SSLUseStapling on #   SSL (   CRIME) SSLCompression off #  SSLv2  SSLv3 SSLProtocol all -SSLv2 -SSLv3 #   SSLCipherSuite EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH #      SSLHonorCipherOrder on #      - # cat /etc/ssl/certs/dhparam.pem &gt;&gt; /etc/pki/tls/certs/localhost.crt #  2.4.8   # SSLOpenSSLConfCmd DHParameters "/etc/ssl/certs/dhparam.pem" SSLOptions +StrictRequire SSLCertificateFile "/etc/pki/tls/certs/localhost.crt" SSLCertificateKeyFile "/etc/pki/tls/private/localhost.key" &lt;/VirtualHost&gt;</code> </pre> <br><p>  Since  Centos 7   Apache 2.4.6,   2.4.8,   -    : </p><br><pre> <code class="plaintext hljs">sudo bash -c "cat /etc/ssl/certs/dhparam.pem &gt;&gt; /etc/pki/tls/certs/localhost.crt"</code> </pre> <br><p>      HTTP/2     ,        Apache   HTTP/2. </p><br><p>     : </p><br><pre> <code class="plaintext hljs">sudo apachectl configtest Syntax OK sudo systemctl reload httpd</code> </pre> <br><h2 id="sertifikat-ot-lets-encrypt">   Let's Encrypt </h2><br><p>         ,      Let's Encrypt: </p><br><pre> <code class="plaintext hljs">sudo certbot --apache --agree-tos --email chelaxe@gmail.com -d repo.chelaxe.ru</code> </pre> <br><p>    ,   rewrite     https.        VirtualHost  http: </p><br><pre> <code class="plaintext hljs">RewriteEngine on RewriteCond %{SERVER_NAME} =repo.chelaxe.ru RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]</code> </pre> <br><p>   VirtualHost  https: </p><br><pre> <code class="plaintext hljs">Include /etc/letsencrypt/options-ssl-apache.conf SSLCertificateFile /etc/letsencrypt/live/repo.chelaxe.ru/cert.pem SSLCertificateKeyFile /etc/letsencrypt/live/repo.chelaxe.ru/privkey.pem SSLCertificateChainFile /etc/letsencrypt/live/repo.chelaxe.ru/chain.pem</code> </pre> <br><p>  <code>Include /etc/letsencrypt/options-ssl-apache.conf</code> . </p><br><p>          -   : </p><br><pre> <code class="plaintext hljs">sudo bash -c "cat /etc/ssl/certs/dhparam.pem &gt;&gt; /etc/letsencrypt/live/repo.chelaxe.ru/cert.pem"</code> </pre> <br><p>    HKPK (HTTP Public Key Pinning): </p><br><pre> <code class="plaintext hljs">#     HKPK (HTTP Public Key Pinning) sudo openssl x509 -noout -in /etc/letsencrypt/live/repo.chelaxe.ru/cert.pem -pubkey | openssl asn1parse -noout -inform pem -out /tmp/public.key #      HKPK (HTTP Public Key Pinning) openssl dgst -sha256 -binary /tmp/public.key | openssl enc -base64 aidlhfQjoxRkbvOlxdZLBUe/4ygOUDG7l+RgwzQbSWA= rm -rf /tmp/public.key</code> </pre> <br><p>      : </p><br><pre> <code class="plaintext hljs"> # HKPK (HTTP Public Key Pinning) Header set Public-Key-Pins "pin-sha256=\"aidlhfQjoxRkbvOlxdZLBUe/4ygOUDG7l+RgwzQbSWA=\"; max-age=2592000; includeSubDomains"</code> </pre> <br><p>     : </p><br><pre> <code class="plaintext hljs">sudo apachectl configtest Syntax OK sudo systemctl reload httpd</code> </pre> <br><p>    .       : </p><br><pre> <code class="plaintext hljs">sudo crontab -e SHELL=/bin/bash MAILTO=chelaxe@gmail.com @daily certbot renew &gt;&gt; /var/log/certbot-renew.log</code> </pre> <br><p>    ,         -   HKPK (HTTP Public Key Pinning). </p><br><h2 id="fayly-htaccess">  .htaccess </h2><br><p>   <code>.htaccess</code>     ,       ,   : </p><br><pre> <code class="plaintext hljs">sudo chown apache:apache ~/rpmbuild/REPO/.htaccess sudo chmod 600 ~/rpmbuild/REPO/.htaccess sudo chcon -R -t httpd_sys_content_t ~/rpmbuild/REPO/.htaccess</code> </pre> <br><p>  <code>AllowOverride</code>   <code>All</code> .   : </p><br><pre> <code class="plaintext hljs">IndexIgnore .htaccess</code> </pre> <br><p>      . </p><br><p>  <code>vsftpd</code>   : </p><br><pre> <code class="plaintext hljs">hide_file={.htaccess} deny_file={.htaccess}</code> </pre> <br><p>      .htaccess      <code>AccessFileName</code> : </p><br><pre> <code class="plaintext hljs">AccessFileName .acl</code> </pre> <br><p>     <code>mod_autoindex</code> Apache   .   <code>noscript</code>    html5, css3, javascript, jquery, bootstrap, backbone, awesome  ,    : </p><br><p><img src="https://habrastorage.org/webt/f8/wk/te/f8wktecq11k3o5hpgdhbp4baiv4.png" alt="repo.chelaxe.ru"></p><br><p>          javascript   : </p><br><p><img src="https://habrastorage.org/webt/hz/oq/5x/hzoq5xzywjpfhulmpxkcyccrcy4.png" alt="LINKS2"></p><br><p>   web       vsftpd      ,        <code>.htaccess</code> . </p><br><p>      <code>mod_autoindex</code>   nginx: </p><br><ol><li> <a href="http://www.oglib.ru/apman/mod/mod_autoindex.html">http://www.oglib.ru/apman/mod/mod_autoindex.html</a> </li><li> <a href="https://habr.com/post/353478/">https://habr.com/post/353478/</a> </li></ol><br><h1 id="nastroyka-dostupa-po-ftp">    ftp </h1><br><p>       : </p><br><pre> <code class="plaintext hljs">sudo systemctl start vsftpd sudo systemctl enable vsftpd</code> </pre> <br><p>  : </p><br><pre> <code class="plaintext hljs">sudo cp /etc/vsftpd/vsftpd{.conf,.bak} sudo vim /etc/vsftpd/vsftpd.conf anonymous_enable=YES local_enable=NO write_enable=NO local_umask=022 dirmessage_enable=YES xferlog_enable=YES connect_from_port_20=YES xferlog_std_format=YES listen=NO pam_service_name=vsftpd userlist_enable=YES tcp_wrappers=YES force_dot_files=NO anon_root=/var/www/repo no_anon_password=YES hide_ids=YES sudo usermod -d /var/www/repo ftp</code> </pre> <br><p>  SeLinux: </p><br><pre> <code class="plaintext hljs">sudo semanage fcontext -a -t public_content_t '/var/www/repo(/.*)?' sudo restorecon -Rv '/var/www/repo'</code> </pre> <br><p>  : </p><br><pre> <code class="plaintext hljs">sudo systemctl restart vsftpd</code> </pre> <br><p>    <code>.htaccess</code>  ‚Äî ,         ftp: </p><br><pre> <code class="plaintext hljs">sudo chcon -R -t httpd_sys_content_t ~/rpmbuild/REPO/.htaccess</code> </pre> <br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>    . ,     . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/354136/">https://habr.com/ru/post/354136/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354126/index.html">And if we do not design a system for managing the production of IT products. Part 1. Analysis of box solutions</a></li>
<li><a href="../354128/index.html">Moving from the CIS to the Czech Republic, own experience</a></li>
<li><a href="../354130/index.html">HoleyBeep: explanation and exploit</a></li>
<li><a href="../354132/index.html">We relieve the player from irritation: the correct use of random numbers</a></li>
<li><a href="../354134/index.html">Hypothesis</a></li>
<li><a href="../354138/index.html">How the stats and monitoring of WebRTC changed the monitoring of VoIP</a></li>
<li><a href="../354140/index.html">Kubernetes Ice Cream, or Beginner Container Solutions</a></li>
<li><a href="../354142/index.html">Difficulties of translation: how to find plagiarism from English in Russian scientific articles</a></li>
<li><a href="../354144/index.html">Hypothesis Quick Start Guide</a></li>
<li><a href="../354146/index.html">Hypotesis - Details and Extras</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>