<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IDS / IPS Suricata rule appearance statistics for new threats</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mandatory protection attribute for a large company - IDS / IPS (Intrusion Detection and Prevention System). There are a large number of commercial and...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IDS / IPS Suricata rule appearance statistics for new threats</h1><div class="post__text post__text-html js-mediator-article"> Mandatory protection attribute for a large company - IDS / IPS (Intrusion Detection and Prevention System).  There are a large number of commercial and open-source solutions on the market, and each of them has its advantages and disadvantages.  But common to all solutions is the need for timely updating of the rules for detecting threats.  Most IDS / IPSs allow you to use rules developed for Snort.  One of the best-known rule providers is Emerging Threats, which has become part of Proofpoint. <br>  We decided to collect release statistics for the pro (commercial version) and open (open-source version) sets of Emerging Threats for Suricata, since their syntax is similar to Snort, but at the same time it is slightly expanded, which gives more features. <br><br>  From the <a href="http://rules.emergingthreats.net/changelogs/">rules.emergingthreats.net/changelogs</a> page, the suricata and suricata-1.3 rule update logs have been compiled since 2015.  The first thing that interested us was how many rules were issued to identify the exploitation of vulnerabilities.  The rules for CVE, the rules of <code>attack response</code> and <code>exploit</code> classes fall into this category. <a name="habracut"></a><br><br>  To bind CVE to the rules, we <code>sid-msg.map</code> the current <code>sid-msg.map</code> file, as well as its change log.  The file contains a mapping of sid-rules for their meta-information and has lines of the following form: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">2021138 || ET WEB_SERVER ElasticSearch Directory Traversal Attempt (CVE-2015-3337) || cve,2015-3337 2021139 || ET TROJAN H1N1 Loader CnC Beacon M1 || url,kernelmode.info/forum/viewtopic.php?f=16&amp;t=3851</code> </pre><br>  CVE-identifier can be contained both separately and in the msg field.  From here, a CVE mapping for rules was obtained. <br>  Since several similar rules may correspond to one attack, it was necessary to make a selection according to the uniqueness of the rules.  The rules, slightly differing from each other by the msg field (having similarities greater than 0.99 according to the <a href="https://en.wikipedia.org/wiki/Jaro%25E2%2580%2593Winkler_distance">Jaro ‚Äì Winkler</a> algorithm), were not added to the sample.  As a result, rules were selected that contain a mapping with CVE or one of the following markers in the msg field: attack response, exploit. <br><br><img src="https://habrastorage.org/files/780/aff/b41/780affb413e345bc931c4ed430006ae6.png"><br><br>  <i>ET open statistics for 2015</i> <br><br><img src="https://habrastorage.org/files/926/2b0/a5c/9262b0a5c4c3442fb3454be8b773c2a1.png"><br><br>  <i>The ratio of the rules of the ET open set for 2015</i> <br><br><img src="https://habrastorage.org/files/b9c/57c/c7d/b9c57cc7dbfd4cfdbcba7f520bb365ea.png"><br><br>  <i>ET pro recruitment statistics for 2015</i> <br><br><img src="https://habrastorage.org/files/33f/9d7/cf3/33f9d7cf36394cd9a9f0ea388906e3b8.png"><br><br>  <i>Ratio of rules from the ET pro set for 2015</i> <br><br>  As can be seen, in 2015 the number of rules issued to identify the exploitation of vulnerabilities did not exceed 10%.  The largest area in the diagram is occupied by the rules for detecting the network activity of malicious programs. <br><br>  The next step was to collect statistics covering the vulnerability regulations, published in 2015.  Vulnerabilities with remote exploitation vector (AV: N) and CVSSv2-rating greater than 7.8 were selected.  Of these, we selected those for which the rules were issued to identify the operation. <br><br>  The diagram shows that only a small part of the vulnerabilities is covered by the rules.  The first reason is that part of CVE is issued for cases that are impossible (encrypted traffic) or meaninglessly covered with rules (with detection and prevention of exploitation of vulnerabilities in web applications, WAF can cope better, for rules you will have to use cumbersome regular expressions, which will lead to slow down the system).  The second reason is that details of the exploitation of a vulnerability are not always known, and experts do not have samples from which rules can be developed. <br><br><img src="https://habrastorage.org/files/70d/154/fc1/70d154fc123843a18867c3cca7579a14.png"><br><br>  <i>Vulnerability Coverage Statistics 2015</i> <br><br>  So, there is an acute shortage of rules for actual vulnerabilities.  One of the reasons is the reluctance of vendors, as well as experts who find vulnerabilities and create rules for IDS / IPS, to share the technical details of the vulnerabilities found.  The development of rules requires traffic patterns with exploitation of a vulnerability;  if they exist, the coverage of new vulnerabilities by the rules will increase by several times, and the situation will not be so deplorable. <br><br>  <b>Posted by</b> Alexey Lednev, Positive Technologies </div><p>Source: <a href="https://habr.com/ru/post/282029/">https://habr.com/ru/post/282029/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282019/index.html">About conferences</a></li>
<li><a href="../282021/index.html">Why should a book engineer when there is internet</a></li>
<li><a href="../282023/index.html">Microsoft Edge Web Summit 2016 Entries Available - Part 1</a></li>
<li><a href="../282025/index.html">Increase Magento Performance</a></li>
<li><a href="../282027/index.html">Houdini: one of the most impressive CSS projects you've never heard of</a></li>
<li><a href="../282031/index.html">8 mistakes when developing a mobile application</a></li>
<li><a href="../282033/index.html">April 23-24, from 12:00 to 12:00, we invite you to # 1 Global Chatbots Hackathon from Webinar.ru</a></li>
<li><a href="../282035/index.html">Weak [weak] links in the new version of Delphi</a></li>
<li><a href="../282037/index.html">We do multitasking</a></li>
<li><a href="../282039/index.html">Moscow Python Meetup ‚Ññ34 (April 27)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>