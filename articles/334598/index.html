<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Features of migration from RISC to x86 in Russia: now we are kept by the old banking software of the DOS and Netware times</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I suspect that quite a significant part of readers of the post is younger than these operating systems. But our Russian (and not only) software still ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Features of migration from RISC to x86 in Russia: now we are kept by the old banking software of the DOS and Netware times</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/3a9/d0b/f2f/3a9d0bf2f5d2439d88426c6015f7ee85.jpg"><br><br>  I suspect that quite a significant part of readers of the post is younger than these operating systems.  But our Russian (and not only) software still runs on them in the bins of the Motherland.  Yes, and you probably no-no, yes, saw DOS-butt in Sberbank's workplaces or in hospitals. <br><br>  There are some Power-machines that are designed for calculating large and heavy pieces.  They are working butt, which can not be run in a normal cluster, as a rule - banking systems and all sorts of exchange items.  The problem is that modern hypervisors create a virtual machine no more than a physical server where they are located.  And one physical x86 server is too small for such tasks.  Therefore, the x64 architecture (RISC) is used. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The same in total system performance on x86 and x64 differ in price by tens and hundreds of times.  It would seem that there are no problems: you need to rewrite the software so that it can work in hundreds of streams and get into a cluster or a cloud, right? <br><br>  Yeah, now!  Programmers who wrote this, no longer.  Source codes are usually lost or written in languages ‚Äã‚Äãof the Mesozoic times.  Even the documentation is usually not.  So you know what we do?  We wrap the hypervisor in the hypervisor.  Oh, this is a separate song.  I'll tell you now. <br><a name="habracut"></a><br><h2>  Mammoth Pieces </h2><br>  Yes, damn it, wrap the hypervisor in a hypervisor.  A typical task is to migrate something to the same Huawei x86.  In general, there are only three commercial architectures that allow to get really very large clusters that are well suited for such tasks. These are Superdom, Fujitsu cluster and Huawei cluster.  Separately, there are more solutions, but these three architectures are similar and close to optimal in terms of scaling.  In our case, Huawei was chosen for the project for two reasons: <br><br>  - The price for a given stability. <br>  - Compatibility with old OS at the level of drivers, etc., that is, the possibility of migration. <br><br><img src="https://habrastorage.org/web/ed4/8d3/0db/ed48d30db991466ea35a4f12a5f56f70.JPG"><br><br>  With the old - this means last year of release.  But the iron development team is now continuing to drive tests and adds compatibility with more and more older operating systems that are still used in banks and industry around the world. <br><br>  The queue for the test implementation of Huawei are two major customers, so the topic is very hot. <br><br>  Now the disposition.  The infrastructure is well established for customers, bugs are caught, compatibility has been achieved, so the main rule of the developer is valid: ‚Äúdo not touch‚Äù.  In banks it is oh so important.  Take and upgrade to the new version - this is a quest of a million sufferings. <br><br>  In this case, note that this does not mean that they do not tolerate anything.  The same bases with AIX P-series on Linux x86, they very quickly rework and roll - this is a proven procedure in many banks. <br><br>  Pain in the butt and DBMS.  External NIXs may not always work with DBMS due to the difference between stored procedures and a heap of other compatibility issues.  As a result, finishing begins to a consistent state.  If the RISC machines have long been established in this area, then the developers of x86 clusters in the novice area have not come to all the rakes yet.  The main thing is that the features of the deeply old NIX do not support, and in the banks or industry there are sometimes quite old versions. <br><br>  And at that very moment we are starting to wrap the hypervisor in a hypervisor, Johnny!  Not always, of course, but only when it is decided that it is better not to touch this particular butt, otherwise everyone will die.  It looks like this: <br><br><ol><li>  We find the latest stable version of the OS, where the butt works.  For you to understand all the pain - sometimes it is Novell Netware 4.x.  This is where the main network protocol is IPX / SPX, and TCP / IP is viewed as a fantasy from the future, but supported just in case.  In one bank, this miracle is still working with archive data.  And sometimes it is really needed for a deep search in financial data. <br></li><li>  We find a hypervisor that supports this stable version of the OS and the butt.  We start in it.  It turns out, for example, a certain old Linux. <br></li><li>  We find the hypervisor (most likely already fresh Vmvara), which is supported by this old Linux.  We start VM with VM on it. </li></ol><br>  It turns out the house that Jack built. <br><br>  Understandably, the butt suffers from this in performance, but there is no place to go.  I know one story about trying to leave Netwara.  10 years as developers simply do not.  All vaunted virtualizers do not support and never.  In the end, somehow managed to rise from 4 to 6.5 then it is already in the hypervisor. <br><br>  By the way, if you think that these are all very rare cases, take a look at the printers in the bank branches where you are.  There is a chance to meet the matrix printers on the connection to the LPT-ports.  These are not even universal COM ports, no, which can be found today in a mutated form of keyboard sockets.  Good old LPT!  In the same banks, reports are submitted on 3.5-inch floppy disks.  Even we have a pair of disk drives for hot swapping in stock.  There are still super-modern ZIP-drives.  Well at least 5.25 and 8 inches have not yet met in practice.  Although the "gramophone record" itself - a flexible magnetic disk of the format of 8 inches in an envelope - I also met in the storages of spare parts.  Disk drives are not. <br><br>  From the modern history in the regions one can often find old Kompakov servers everywhere.  Which 10 years ago were delivered.  This is 2004, before the merger with HP. <br><br><h2>  And what about Huawei? </h2><br>  And their development completes the driver and stuff.  The iron manufacturer must support the target axis in hardware.  The old x86 were on Intel chipsets - these are small cars.  Hullat has 16 cores and above.  And they have iron for settling non-standard.  Therefore, not everything is as simple as it may seem.  The same memory managers are very nontrivial for older systems. <br><br>  As a result, on the release of the new server at the beginning of the list of compatibility from one OS.  Later finish.  Now they want more deep NIX.  The choice is simple: either the system software rework, or work with the operating system.  Therefore, the latter is simpler, because the same Centos is free in banks (and not even Redhat), and if we give compatibility, x86 clients will immediately become more. <br><br>  Naturally, migration can lead to a rewriting of the entire system.  And nobody wants this especially.  Most often, developed are lost, because the system is 11 years old, there is no relevant documentation or it is not kept.  Finding at least integration points is a standard problem.  Stored procedures also add joy.  And finally, 90% of the dialogue: <br><br>  - Do you have a procedure for commissioning? <br>  - Of course! <br>  - Do you need documentation on it? <br>  - Absolutely. <br>  - So, and this procedure is observed? <br>  - No, of course, why are you crazy? <br><br>  The bottom line - the documented procedure is very complicated, and no one abides by, leave the system in test operation. <br><br>  So only transition to superclusters with compatibility with old OS. <br><br><h2>  Tests </h2><br>  For 2 months we tested for customers 5 platforms.  In fact, there is nothing to examine, questions only about stability and the possibility of migration.  No synthetic tests, because the results each time are very different from the real ones.  And in both directions. <br><br><h2>  Future </h2><br>  In the distant future, perhaps there will be no such dances with a tambourine.  The main problem when we need vertical scalability (an increase in the number of processors and memory in one machine), since a single Oracle database cannot be divided into several parts, it should be single.  And they want to do everything to go into the clouds and just stick the blades for fun.  Now the big DBMS on AIX are uniform and very fat.  Therefore, the vertical scale - for x86 now it is 32 processors, 16 cores each. <br><br>  Now everyone is going in the direction of in-memory-computing, so they will be parallelized anyway.  The question is when. </div><p>Source: <a href="https://habr.com/ru/post/334598/">https://habr.com/ru/post/334598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334588/index.html">Comprehensive online marketing guide. Day 67. Retargeting and what it is eaten with.</a></li>
<li><a href="../334590/index.html">How to refactor 2 500 000 lines of code and not go crazy</a></li>
<li><a href="../334592/index.html">In a section: the news aggregator on Android with backend. Assembly system</a></li>
<li><a href="../334594/index.html">‚ÄúBad advice‚Äù: How to lose a customer or the 7 best farewell phrases</a></li>
<li><a href="../334596/index.html">ZFS is the best file system (yet)</a></li>
<li><a href="../334604/index.html">Hack Sleep. Repeat</a></li>
<li><a href="../334608/index.html">In the second quarter, a 40% increase in the number of attacked devices was recorded.</a></li>
<li><a href="../334610/index.html">When will there be enough IP addresses for everyone?</a></li>
<li><a href="../334612/index.html">Translation of Hans Buvald‚Äôs article ‚ÄúBasic Test Design Principles‚Äù</a></li>
<li><a href="../334616/index.html">6 tips on launching a start-up designer anything</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>