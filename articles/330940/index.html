<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We compile, as if in the yard 1992</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I studied the vanilla source code of the 1992 Wolfenstein 3D game. Despite the fact that she is already 25 years old, and she is completely outdated f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We compile, as if in the yard 1992</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/1be/d93/579/1bed935796ddf566046772fd3043e678.png" alt="image"><br><br>  I studied the vanilla source code of the 1992 Wolfenstein 3D game.  Despite the fact that she is already 25 years old, and she is completely outdated for modern platforms, you can still compile it if you recreate the environment. <br><br>  This requires only: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Wolfenstein 3D source code. </li><li>  Dosbox </li><li>  Compiler Borland C ++ 3.1. </li><li>  Wolfenstein 3D shareware (to borrow resources). </li></ul><a name="habracut"></a><br><h3>  File system setup </h3><br>  Open the command line and create two folders, one for each of the required DOS disks: <br><br><pre><code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ <span class="hljs-built_in"><span class="hljs-built_in">mkdir</span></span> system <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> system <span class="hljs-built_in"><span class="hljs-built_in">mkdir</span></span> c <span class="hljs-built_in"><span class="hljs-built_in">mkdir</span></span> a <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~</code> </pre> <br><h3>  Download files </h3><br><ul><li>  Download Borland 3.1 in <code>system/a</code> . </li><li>  Download the source code Wolfenstein 3D in the <code>system/c</code> </li><li>  We download VGA files to <code>system/c</code> (at the end of the article I will explain why this is necessary). </li></ul><br><pre> <code class="dos hljs"> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> system/a curl -O http://fabiensanglard.<span class="hljs-built_in"><span class="hljs-built_in">net</span></span>/Compile_Like_Its_1992/tools/BCPP31.zip <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ../c curl -O http://fabiensanglard.<span class="hljs-built_in"><span class="hljs-built_in">net</span></span>/Compile_Like_Its_1992/tools/wolfsrc.zip curl -O http://fabiensanglard.<span class="hljs-built_in"><span class="hljs-built_in">net</span></span>/Compile_Like_Its_1992/tools/vgafiles.zip</code> </pre> <br>  Now all files are in the file system.  Just to check, we enter: <br><br><pre> <code class="dos hljs"> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> .. <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> ~/system</code> </pre> <br>  You should have the following: <br><br><pre> <code class="dos hljs"> /Users/fabiensanglard/system /Users/fabiensanglard/system/a /Users/fabiensanglard/system/a/BCPP31.zip /Users/fabiensanglard/system/c /Users/fabiensanglard/system/c/vgafiles.zip /Users/fabiensanglard/system/c/wolfsrc.zip</code> </pre> <br><h3>  Unpack everything </h3><br><pre> <code class="dos hljs"> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/system/a unzip BCPP31.zip <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/system/c unzip vgafiles.zip unzip wolfsrc.zip</code> </pre> <br><h3>  Dosbox </h3><br>  Download and run <a href="http://www.dosbox.com/">DosBox</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/238/5e5/e06/2385e5e06855f3948567318ed0fb1159.png"><br><br><h3>  We mount </h3><br>  Mount the file system, one folder for each of the disks: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> Z:/&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mount</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-function"> ~/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">system</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Z</span></span></span><span class="hljs-function">:/&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mount</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function"> ~/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">system</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span></span></code> </pre> <br><h3>  Install the compiler </h3><br>  It is time to install Borland C ++ 3.1: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> Z:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cd</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BCPP31</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">install</span></span></span></span></code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/722/1ad/2bc/7221ad2bc2fc89c032e7360900090282.png"><br><br>  Press "enter" when selecting the source disk (drive A must be selected) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c2/7b2/f27/1c27b2f27ac9ac0db05ef6d8ceaaa0cc.png"><br><br>  Leave all the default settings and select ‚ÄúStart Installation‚Äù: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ad/b2e/b58/6adb2eb586f40e43dbc34a4d7a16f78c.png"><br><br>  Notifications warn you that you can‚Äôt find the Microsoft Windows folder, but we don‚Äôt need it, just hit enter. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b13/d0e/9d3/b13d0e9d3adbcf491ed0fbf9fb84ab95.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a4/aa1/784/5a4aa1784fa0a5cf1ed10399b84a25e1.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d8b/36b/37f/d8b36b37f646400fa84ea47502a4017d.png"><br><br><h3>  Installing Wolfenstein 3D Source Code </h3><br>  The system works and has a compiler: it is time to unpack (again) the source code. <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> A:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cd</span></span></span><span class="hljs-function">\ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">install</span></span></span></span></code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/5f4/506/1bc/5f45061bc98973fe604d4f6419b8f017.png"><br><br>  Let's enter "C" <br><br><img src="https://habrastorage.org/getpro/habr/post_images/153/934/3f0/1539343f020b6fea6a8cb6ba8c8b51d6.png"><br><br>  Leave the default path: <code>\WOLFSRC</code> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f8a/7a0/14c/f8a7a014caad18e2b494267d97f7cbdf.png"><br><br>  Confirm ("Y") the creation of the directory. <br><br>  Fits! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aa9/9bc/df4/aa99bcdf4c205bc6dee79c8a7e31e54c.png"><br><br><h3>  Compile </h3><br>  Launch Borland C ++ 3.1: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> C:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cd</span></span></span><span class="hljs-function">\ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cd</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">borlandc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cd</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bin</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bc.exe</span></span></span></span></code> </pre> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0ae/b2f/007/0aeb2f007ade10ffaebbef440f47d562.png"><br><br>  After clicking on OK, use the mouse or hotkeys to select Project ‚Üí Open Project <code>..\..\WOLFSRC\WOLF3D.PRJ</code> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/038/8a7/799/0388a7799f42c525a17db63f5e39975c.png"><br><br>  Select Options ‚Üí Directories and change the value as follows: <br><br><pre> <code class="dos hljs"> Include Directories: C:\BORLANDC\INCLUDE Library Directories: C:\BORLANDC\LIB Ouptput Directories: OBJ Source Directories: C:\WOLFSRC</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/75d/b8c/055/75db8c05557419dcd59b94345e1776ee.png"><br><br>  Let's try to compile: Compile -&gt; Build All <br><br><img src="https://habrastorage.org/getpro/habr/post_images/242/324/bfd/242324bfd3c1a11981abbfeb34decf57.png"><br><br>  We get the error: ‚ÄúCannot find executable TASM‚Äù <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd6/a32/4d8/bd6a324d83bb10155c927f1f7b721a44.png"><br><br>  Let's exit Borland C ++, we need to configure PATH: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> C:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CD</span></span></span><span class="hljs-function"> .. </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PATH</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BORLANDC</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BIN</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BC.EXE</span></span></span></span></code> </pre> <br>  Try compiling again (Compile -&gt; Build All): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ca/fe1/5fb/2cafe15fba7f39b87f8964eca3de3bf5.png"><br><br>  Compilation was done, but a layout error occurred: ‚ÄúUnable to find OBJ file‚Äù, because the path to SIGNON.OBJ and GAMEPAL.OBJ in the project is incorrect. <br><br>  They are noted in <code>C:\SOURCE\WOLF\</code> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b6a/2de/c58/b6a2dec58c74e5705891a988816c6676.png"><br><br>  Remove them from the project (Select Projext ‚Üí Delete item).  Add them again via PROJECT ‚Üí Add Item ....  Add <code>WOLFSRC\OBJ\SIGNON.OBJ</code> and <code>WOLFSRC\OBJ\GAMEPAL.OBJ</code> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c0f/1e8/291/c0f1e82911897d60923133bab0b2a89d.png"><br><br>  Let's try to compile again (Compile ‚Üí Build All) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e33/2e4/a06/e332e4a0617de1e772c68b5f84361d9f.png"><br><br>  It worked!  But will the game start? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/119/cd7/2a1/119cd72a1ae1b61abf2b85980fa44f5e.png"><br><br><h3>  We get resources </h3><br>  Download the shareware version, or even better: buy Wolfenstein 3D as a full version. <br><br><pre> <code class="dos hljs"> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/system/c curl -O http://fabiensanglard.<span class="hljs-built_in"><span class="hljs-built_in">net</span></span>/Compile_Like_Its_1992/tools/<span class="hljs-number"><span class="hljs-number">1</span></span>wolf14.zip unzip <span class="hljs-number"><span class="hljs-number">1</span></span>wolf14.zip</code> </pre> <br>  Let's go back to DosBox and install the game in <code>C:\WOLF3D</code> . <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> C:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cd</span></span></span><span class="hljs-function"> \ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cd</span></span></span><span class="hljs-function"> 1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wolf14</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF14</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">install</span></span></span></span></code> </pre> <br>  After installing the game, copy the newly compiled .EXE file into the game folder, <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> C:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cd</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wolf3d</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D.EXE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D.OLD</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-function"> ../</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLRSRC</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF.EXE</span></span></span></span></code> </pre> <br><h3>  Run the game </h3><br>  Let's try to run: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> C:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cd</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wolf3d</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D.EXE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D.OLD</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-function"> ../</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLRSRC</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OBJ</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D.EXE</span></span></span><span class="hljs-function"> . </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D.EXE</span></span></span></span></code> </pre> <br>  Hmm, it looks weird ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/715/0fd/a3a/7150fda3a814d7347ec7ffa8b656e2c5.png"><br><br>  Oh‚Ä¶ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/945/52f/cd9/94552fcd92d25c7c39d7345b7215f1f7.png"><br><br>  What? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0aa/e6a/caa/0aae6acaaff24b66f7fcf7e3977d497f.png"><br><br>  I do not remember that the game was so ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ff/6ae/010/7ff6ae0100182cd362b1199f906569f1.png"><br><br>  So, somewhere an error occurred! <br><br><h3>  What happened? </h3><br>  The point is in the production pipeline of the game and how it was used by the engine.  When Adrian Carmack and Kevin Cloud finished working on all the graphic files, they used the IGRABed tool to package them.  The result was 3 + 2 files. <br><br><ul><li>  VGAHEAD.WL1 </li><li>  VGAGRAPH.WL1 </li><li>  VGADICT.WL1 </li></ul><br>  The VGAHEAD file is an index containing pointers to VGAGRAPH, which stores data compressed by the Huffman algorithm.  VGADICT contains Huffman dictionaries for unpacking data. <br><br>  Two other files created: <br><br><ul><li>  GRE.H </li><li>  GRE.EQU </li></ul><br>  compiled into the engine, as shown in the figure below: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f8c/56f/f87/f8c56ff87a3f3ca9967936cb19ecbe4b.png"><br><br>  What are the <code>.H</code> and <code>.EQU</code> files <code>.EQU</code> ?  In short, they allow you to access by name.  When IGRABed collects all the files, it also creates an enumeration (enum) with the corresponding indexes: <br><br>  <b>GRE.H</b> <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span>{ H_WOLFLOGOPIC GETPSYCHEDPIC L_GUYPIC . . } graphicnums</code> </pre> <br>  <b>GRE.EQU</b> <br><br><pre> <code class="cpp hljs"> H_WOLFLOGOPIC = <span class="hljs-number"><span class="hljs-number">0</span></span> GETPSYCHEDPIC = <span class="hljs-number"><span class="hljs-number">1</span></span> L_GUYPIC = <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br>  Thus, when the engine requests the desired resource, it can use a logical name (L_GUYPIC), rather than a ‚Äúmagic number‚Äù (2). <br><br>  This means that the engine was released with <b>hard-coded</b> image indices in VGA files.  Since the resources and the code base evolved after the release of wolf3D shareware (in Spear of Destiny), the new compiled game indexes do not match the location of the source resource files. <br><br><h3>  Start the game (again) </h3><br>  Fortunately, this problem has a simple solution: someone re-generated VGA resources to match the indexes in the .H and .EQU files released with the source code.  Simply copy these files (if you use resources from the shareware version, you will need to change the file extension from .WL6 to .WL1). <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> C:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vgafiles</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VGADICT.WL6</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VGADICT.WL1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vgafiles</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VGAGRAPH.WL6</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VGAGRAPH.WL1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vgafiles</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VGAHEAD.WL6</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">C</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VGAHEAD.WL1</span></span></span></span></code> </pre> <br>  Let's try again: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> C:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D.EXE</span></span></span></span></code> </pre> <br>  Works! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb4/ba8/a40/cb4ba8a40163cfb96a916e6debad0966.png"><br><br>  But we still haven't finished! <br><br><h3>  VGA frame buffer and screen aspect ratio </h3><br>  This may not be obvious to people who have never seen the original game, but the above picture from DosBox does not exactly coincide with what the players saw in 1992.  The VGA frame buffer had a size of 320x200, but for a CRT monitor the aspect ratio is 4: 3.  This means that the frame buffer when stretched to the monitor vertically stretched.  DosBox has an option to compensate for this: <br><br><pre> <code class="dos hljs"> vi ~/Library/Preferences/DOSBox\ <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">74</span></span>\ Preferences [render] # frameskip:  ,  DOSBox   . # aspect:    .      ,       ! # scaler:   /   . #    'forced',  scaler ,      . #  : none, normal2x, normal3x, advmame2x, advmame3x, advinterp2x, advinterp3x, ... frameskip=<span class="hljs-number"><span class="hljs-number">0</span></span> aspect=false scaler=normal2x</code> </pre> <br>  Change the aspect value to <b>true</b> . <br><br>  Let's try again: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function"> C:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WOLF3D.EXE</span></span></span></span></code> </pre> <br>  Finally it worked! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1be/d93/579/1bed935796ddf566046772fd3043e678.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/224/e88/787/224e88787659516fc3a36525bfbda421.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/972/e3e/cb8/972e3ecb860493126cf67c7c5c79a468.png"></div><p>Source: <a href="https://habr.com/ru/post/330940/">https://habr.com/ru/post/330940/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330930/index.html">It is a little about ServiceNow, ITSM and ServiceDesk in a format of selection of useful materials</a></li>
<li><a href="../330932/index.html">40 unusual questions asked at the interview at Apple</a></li>
<li><a href="../330934/index.html">And terrible Russian firewall will burst</a></li>
<li><a href="../330936/index.html">Optical character recognition on the microcontroller</a></li>
<li><a href="../330938/index.html">Java: automatically generate SQL queries</a></li>
<li><a href="../330942/index.html">The story of how cognitive technologies help preserve karma</a></li>
<li><a href="../330944/index.html">[Administrator's abstract] Domains, addresses and Windows: mix, but do not shake</a></li>
<li><a href="../330946/index.html">‚ÄúWhen a critical crash occurs with databases, it always happens somewhat epically‚Äù - Ilya Kosmodemyansky</a></li>
<li><a href="../330948/index.html">How to ensure that learning in games is not annoying</a></li>
<li><a href="../330950/index.html">Online conference DEV Labs JavaScript. June 24</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>