<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>W for Wikipedia</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is ‚ÄúBigData‚Äù? These are the data that can not just digest. Or you can not just cook. Or do you think that it is impossible. 
 A particularly stro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>W for Wikipedia</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/376/780/58c/37678058c2bf4bc4be4e6672757de747.png" align="left">  What is ‚ÄúBigData‚Äù?  These are the data that can not just digest.  Or you can not just cook.  Or do you think that it is impossible. <br>  A particularly strong ‚Äúimbalance‚Äù, in this understanding, the big data hid in web-cartography, in maps on various websites. <br>  <em>And so it happened - for several years I rode on various conferences, and talked about organizing the transfer of data from the server to the Map.</em>  <em>Sometimes I was asked - "but where do you get these many of your data</em> . <em>"</em> <br>  These are not the right questions, the right questions are: <br>  - how to store data <br>  - what data, when and why to transfer to the client <br>  - what server clustering is, how it looks and why it is needed <br>  - what to do with the data <br>  - and why all this is necessary% username% <br><br>  And about where to get the data ... There is one such children's rhyme <br><br>  <i>All covered</i> <i><br></i>  <i>Absolutely all</i> <i><br></i>  <i><b>Wikipedia Island</b></i> <i><br></i>  <i>In the ocean there</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And on this island is growing about ten million geotagged articles, which we will use. <br>  But with the flora and fauna there is not so simple - articles grow in different languages, in different places, and in fact there are a lot of them ... <br>  Therefore, we, like real heroes, complicate the task a bit and add a little <a href="http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html">aggregate functions</a> , <a href="http://ru.wikipedia.org/wiki/%25D0%25E0%25F1%25F1%25F2%25EE%25FF%25ED%25E8%25E5_%25CB%25E5%25E2%25E5%25ED%25F8%25F2%25E5%25E9%25ED%25E0">Levenstein</a> , <a href="http://en.wikipedia.org/wiki/Z-order_curve">Morton</a> codes, <a href="http://ru.esosedi.org/">esosedi</a> and a bit of common sense. <br><br><a name="habracut"></a><br><blockquote>  <u>Enhancing Internet connectivity ...</u>  About these words, I represented the process of integrating Wikipedia into a common pile of geodata. <br></blockquote><br>  But there was a problem - Wikipedia, although it itself does not describe the most complicated process of its cloning ( <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B8%25D0%25BA%25D0%25B8%25D0%25BF%25D0%25B5%25D0%25B4%25D0%25B8%25D1%258F:%25D0%259A%25D0%25B0%25D0%25BA_%25D1%2581%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B0%25D1%2582%25D1%258C_%25D0%25BA%25D0%25BE%25D0%25BF%25D0%25B8%25D1%258E_%25D0%2592%25D0%25B8%25D0%25BA%25D0%25B8%25D0%25BF%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25B8">Wikipedia: How_to do_copy_Wikipedia</a> ), did not want to integrate at all. <br>  Because the wiki is big.  Real bigdata, for my SSD.  And it was difficult to download the necessary data to localhost, and it was impossible to server (because all the work described in this article, like the article itself, was written in the train). <br>  But everything is solved.  Literally 5 minutes ( <i>local meme</i> ). <br><br>  <b>G for geonames</b> <br>  Some time ago I discovered such a project as <a href="http://geonames.org/">geonames.org</a> , which, among other things, provides an API to the ‚Äúgeo‚Äù wikipedia articles - <a href="http://www.geonames.org/maps/wikipedia.html">www.geonames.org/maps/wikipedia.html</a> ( <em>And there everything ‚Äújumps and jumps‚Äù</em> ) . <br>  If you dig a little bit, you can find the source of their data - the <a href="https://de.wikipedia.org/wiki/Wikipedia_Diskussion:WikiProjekt_Georeferenzierung/Hauptseite/Wikipedia-World/news">Georeferenzierung</a> project, which after all their discussions and discussions results in a small file, 700 megabytes - <a href="http://toolserver.org/~kolossos/wp-world/pg-dumps/wp-world/">http://toolserver.org/~kolossos/wp-world/pg-dumps/wp -world /</a> <br>  Please love and complain very much - this is a CSV with all the wikipedia articles we need. <br><br>  <b>D for Database</b> <br>  <u>Step 1. Import data.</u> <br>  Download from the tool server file new_C.gz.  This is a common csv, the format of which is <a href="https://de.wikipedia.org/wiki/Wikipedia_Diskussion:WikiProjekt_Georeferenzierung/Hauptseite/Wikipedia-World/news">described in the wiki</a> . <br>  There is no need for all the possible good in fact - only the name of the article, the coordinates and the length of the document's content - <i>auto_incriment_id, lang: Titel, lat, lon, psize</i> (for ranking) <br>  Based on this data, you can get a list of Wikipedia geo pages. <br><br>  <u>Step 2. Interwiki Stage</u> <br>  Many wikipedia articles are described in more than one language.  This seems to be the point.  In the original file, the data format is something like this: <br><blockquote>  lang, pageTitle, ..., en-page, ru-page, de-page ... only 273 languages ‚Äã‚Äãfrom interwiki. </blockquote><br>  Our task is to unite a group of articles in different languages ‚Äã‚Äãinto a ‚Äúcluster‚Äù.  In essence, a sequence of 273 references to different language versions is a cluster.  You can assign it a unique id (the minimum page id in the cluster, for example. Or CRC32 from the components), after which you can refer to it. <br>  Simultaneously with this operation, we find out that half of the pages for which there are links from interwiki are not in the main index. <br>  <u>They were not</u> in the first stage. <br>  Because in these articles there is no geotagging (but there is a link through interwiki), so at the first stage we didn‚Äôt ‚Äúsee‚Äù them, since they did not initially fall into the export file. <br>  In this case, these pages should be added to the main index, but the coordinates should be driven to null (for statistics). <br>  <i>PS: the first stone in the garden wikipedia.</i>  <i>No data level connectivity.</i> <i><br></i>  <i>PPS: Sometimes in the file there are names with a bit encoding.</i> <br><br>  <u>Step 3. We look!</u> <br>  Let's dwell a little bit, and finally look at how our ball looks like if we impose Wikipedia data on it <br><br><img src="https://habrastorage.org/files/633/b18/08a/633b1808aa8a43dab4dc9d17a07692c6.png"><br><br>  Almost this picture you could see in the header of the article on <a href="http://habrahabr.ru/company/yandex/blog/241361/">heat maps of Yandex. The map a</a> couple of weeks ago. <br><br>  In fact, the picture is clickable - this is an interactive example, <a href="http://www.esosedi.ru/about/heatmap/index.html">you can touch it on esosedi</a> (it only works fine in WebKit!).  The link can be viewed not only for general wiki coverage, but also for data from various language sections (en, ru, uk, de).  And there you can look at some strange version of the <a href="http://www.esosedi.ru/about/heatmap/index.html%3Fshow%3Ddeviance%26level%3D0">Incorrectenesses distribution map</a> (for those who want a <a href="https://www.facebook.com/theKashey/posts/625152777597927">little</a> math). <br><br>  The meaning of this ‚Äúterm‚Äù is very simple: <br>  1. We have Wikipedia articles. <br>  2. We have a connection between these articles. <br>  3. We can find the difference between the coordinates of the articles of one cluster.  That is the difference in the data of one and the same article, but in different languages. <br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> deviance <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> cluster, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>( lat ) - <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span>( lat ) + <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>( lng ) - <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span>( lng ) , <span class="hljs-keyword"><span class="hljs-keyword">STD</span></span>( lat ) + <span class="hljs-keyword"><span class="hljs-keyword">STD</span></span>( lng ) , <span class="hljs-keyword"><span class="hljs-keyword">VARIANCE</span></span>( lat ) + <span class="hljs-keyword"><span class="hljs-keyword">VARIANCE</span></span>( lng ) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pages <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> <span class="hljs-string"><span class="hljs-string">`pagecluster`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> pc <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> PC.page = p.uid <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> cluster <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> c.clusterId=pc.cluster <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> c.cnt&gt;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> cluster</code> </pre>  <i>PS: no matane - standard functions with results for every taste</i> <br><br>  <b>What do we get?</b> <br><br>  Those who have read carefully must remember (from item 2 of the import) that in some articles of one cluster there is <u>NO</u> geo-referencing.  And where there are such gross violations - there may be smaller ones, for example, just different coordinates in different articles.  Because at least one cluster - the articles are actually different since the wiki sections are relatively autonomous. <br>  <i>PS: Articles of the same cluster may not only have no georeference, but also links to each other through interwiki.</i>  <i>Many articles do not have links to those articles that have links to them.</i>  <i>Or they may have outgoing links to a completely different cluster.</i>  <i>Do not try to understand - I myself do not understand how this happened.</i> <br><br>  In fact, this means that the coordinates of the articles may or may not be, may not be correct.  And <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D0%25B6%25D0%25B4%25D1%2583%25D0%25BD%25D0%25B0%25D1%2580%25D0%25BE%25D0%25B4%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B0%25D1%258D%25D1%2580%25D0%25BE%25D0%25BF%25D0%25BE%25D1%2580%25D1%2582_%25D0%25B8%25D0%25BC%25D0%25B5%25D0%25BD%25D0%25B8_%25D0%25A1%25D0%25B0%25D0%25B1%25D0%25B8%25D1%2585%25D0%25B8_%25D0%2593%25D1%2591%25D0%25BA%25D1%2587%25D0%25B5%25D0%25BD">the Sabiha Gokcen Airport</a> in the ru version is ‚Äúhanging‚Äù over Domodedovo.  In this case, with <a href="https://en.wikipedia.org/wiki/Sabiha_G%25C3%25B6k%25C3%25A7en_International_Airport)">en version</a> everything is ok. <br>  At the moment this is no longer the case, and Sabiha is fine - since August someone has corrected the article.  But (!): <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-string"><span class="hljs-string">`pages`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pageCluster <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> pageCluster.page=p.uid <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> deviance <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> dv <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> dv.clusterId=cluster <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-string"><span class="hljs-string">`type`</span></span> = <span class="hljs-string"><span class="hljs-string">'airport'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> width&gt;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> cluster</code> </pre> <br>  Gives out about 500 airports with a delta of coordinates greater than a degree. <br>  For example <a href="https://ru.wikipedia.org/wiki/%25D0%25E5%25E9%25E2%25E5%25ED%25F1%25F2%25EE%25F0%25EF_(%25E0%25FD%25F0%25EE%25EF%25EE%25F0%25F2)">Ravensthorp</a> and <a href="https://en.wikipedia.org/wiki/Ravensthorpe_Airport">Ravensthorpe_Airport</a> .  There everything is OK with the coordinates - just the hemispheres were mixed up (33 and -33 degrees). <br>  <i>PS: It was the second stone in the garden wikipedia</i> <br><br><img src="https://habrastorage.org/files/4db/85e/890/4db85e890c384243b96ad063531ac8ba.png" width="300" align="left">  If you dig a little, it turns out that with airports and major universities is almost always a disaster.  Sometimes it seems that some strange robot put the coordinates.  And everywhere the same.  Most of all, he was lucky with such a place as <a href="http://ru.esosedi.org/UA/14/1000231085/ggpiiya/">‚ÄúGorlovsky State Pedagogical Institute of Foreign Languages‚Äù</a> - he gathered ‚Äúin himself‚Äù 22 other educational institutions, having surpassed both MSU and Ivy League. <br><br>  In fact, there are not too many articles on Wikipedia for which ‚Äúdeviance‚Äù can be counted - just a lot of materials are described only in one language and the calculation is not so simple to make.  But the ‚Äúorder‚Äù and the error rate are roughly preserved. <br>  Many articles are tied ‚Äúa little‚Äù aside.  Sometimes in centimeters, sometimes in meters, sometimes worse.  The maximum error found is approximately 60 degrees. <br>  Finding such places is difficult, but possible.  For example, according to Wikipedia, <a href="https://ru.wikipedia.org/wiki/%25D0%25A5%25D1%2580%25D0%25B0%25D0%25BC_%25D0%2592%25D0%25B8%25D1%2580%25D1%2583%25D0%25BF%25D0%25B0%25D0%25BA%25D1%2588%25D0%25B8_%25D0%25B2_%25D0%25A5%25D0%25B0%25D0%25BC%25D0%25BF%25D0%25B8">ru: Temple_Vyrupakshi_v_Hampi</a> is not at all in Hampi (offset 290km).  It has a link to the city of Hampi, which is in the right place.  And there are a lot of such places for which you can define at least the region of binding. <br><blockquote>  PS: Well, for example, for almost all airports and institutions. </blockquote><br><br>  But more about that another time.  Let's go to the moment about "how to show" <br><br>  <b>Z for Z-code</b> <br><br>  In order to display on the map some data, this data must be transferred. <br>  But all data cannot be transferred, because it is many, many megabytes (initially 700).  And there is only one salvation - server clustering. <br>  It is (in my terminology) of three types: <br><ul><li>  The first kind - you get all the data from the database, somewhere on the server you cluster, give it to the client. <br>  K-means.  Matan  Everyone is crying. </li><li>  The second kind - you ask the database to group you something by coordinates.  BD long and hard believes, then groups. <br>  If you whisper to ask <i>GROUP BY ROUND (Lat), ROUND (Lng)</i> , then you can hear the planner crying. </li><li>  And the third kind - you forgive the database to give you mystically grouped data.  <i>Magic</i> happens, and almost no one cries. </li></ul><br>  In particular, to export data to the heatmap example, the <u>spell</u> sounded like <br><blockquote>  SELECT z, lat, lng, SUM (weight) FROM `coordinate_map` as cm GROUP BY z &amp; 0xFFFF0000 </blockquote><br>  Where lat, lng are the usual ‚Äúearth‚Äù coordinates, and z is <a href="http://en.wikipedia.org/wiki/Z-order_curve">‚Äúz-order-curve‚Äù</a> , aka Morton code.  In which all the magic and hides. <br><br><img src="https://habrastorage.org/files/32a/a88/858/32aa88858773490eb70c51e91b168470.png"><br><br>  Morton, his fellow Hilbert (geo-hash in MongoDB) and Gray-code do the same thing - they translate 2D (or 3D) coordinates to 1D. <br><blockquote>  Z-order, Quad-code, Morton order, or Morton code. </blockquote><br><br>  In fact, Z is a ‚Äúquadtree addressing‚Äù.  Bing calls it <a href="http://msdn.microsoft.com/en-us/library/bb259689.aspx">quadkeys</a> and uses the map tiles for addressing (pyramid). <br>  It is this ‚Äúeffect‚Äù that we need.  Z-code, Quadkeys or whatever you call it ‚Äúpoints‚Äù to the quadtree node.  On the square, on the tile. <br>  In uint32, you can ‚Äúput‚Äù 16 ‚Äúdirections‚Äù along the tree.  You can address the 16 tile zoom.  It is about 300x300 meters.  In bigint 16 <u>more</u> levels will get. <br>  For comparison, I show you the size of the tile 16 of the zoom - for clustering, and for selecting data - this is enough. <br><br><img src="https://habrastorage.org/files/72a/6bc/20c/72a6bc20c6094afab0f8c78e76f87e36.png" align="right"><br><br>  But the ‚Äúmain‚Äù bonus of Z-addressing is in fast data sampling (1D index) and very fast aggregate operations. <br>  GROUP BY z &amp; BITMASK and all.  For tens of millions of records, the request runs in tens of milliseconds. <br>  With the mask 0xFFFF0000 (16 units, 16 zeros) we ‚Äúcover‚Äù the tiles up to the 8th zoom, after which we ‚Äúdiscard‚Äù further variability.  We perform clustering.  The output for the wiki will be ~ 22k "server-clustered" points for our heatmap. <br>  This process itself is not so easy to understand, but read the math.  Of course in wikipedia.  : P <br>  These spatial filling curves are used for data sampling, and for grouping, and for sorting.  For several decades they have continued to find various uses for such mechanics and there is no end in sight. <br><blockquote>  In <a href="http://habrahabr.ru/post/268643/">my</a> other <a href="http://habrahabr.ru/post/268643/">article</a> , about the regions, there is a link to the <a href="http://www.geos.ed.ac.uk/~gisteac/gis_book_abridged/files/ch27.pdf">drug chapter</a> in the book about spatial access methods.  Recommend. <br></blockquote><br>  You can also see the <a href="https://www.drupal.org/project/geocluster">module for Drupal</a> , which works on the basis of <a href="http://en.wikipedia.org/wiki/Geohash">geoHash.org</a> , which (in its essence) is also ‚ÄúMorton number‚Äù, but for some reason in base32. <br>  The main thing to remember is that strings are not numbers, B-trees cannot be built from them (normal).  Although - if you have MongoDB - there is no choice, but everything works - checked (link to maple REST <a href="">server clustering</a> from API Yandex.Map and <a href="http://dimik.github.io/ymaps/examples/2.1/remote-object-manager/">example</a> to it) <br><br>  So, at the very beginning of the article some questions were raised. <br>  Q: How to store data? <br>  A: Store in a database like data.  As it is more convenient, and finish the data with z-coordinates. <br><br>  Q: What data, when and why to transfer to the client? <br>  A: Use smart data transfer, such as <a href="">RemoteObjectManager</a> and company.  This was recently <a href="http://habrahabr.ru/company/yandex/blog/243665/">an article</a> . <br><br>  Q: What is server clustering and how does it look and why is it needed? <br>  A: Oh!  This is not at all a scary beast, and allows not only to reduce the load on the client, but also to provide a more even data coverage (it also ‚Äújumps and jumps‚Äù) <br><br>  There are two questions that have not yet been answered: <br>  - what to do with the data <br>  - and why all this is necessary% username% <br><br>  So I'm starting to tell you about the last stage - the stage where it is decided what to do with this data, and how they can be useful. <br><br>  <i>All covered with tags ... Absolutely all ... There is a ball.</i> <br><br>  When I started writing this article - it was August in the yard.  Since then, a lot of time has passed, the API Map released <a href="http://habrahabr.ru/company/yandex/blog/243665/">ObjectManager</a> and I wanted to make a ‚Äúpen‚Äù for it so that you could show the Wikipedia objects on your map.  But the public handle which would sustain a habraeffect I and did not make. <br>  If you want to get a little bit of ‚Äúexperience‚Äù in placing and displaying more or less normal amounts of data on a map, this topic, the topic about ObjectManager and our performances ( <a href="https://events.yandex.ru/lib/talks/2354/">one</a> , <a href="http://www.highload.ru/2014/abstracts/1628.html">two</a> ) will help you with this. <br>  But - this is not the topic of this story.  We're talking about Wiki. <br><br><blockquote>  PS: By the way - recently <a href="http://www.the-village.ru/village/city/city-news/172141-glava-russkoy-wikipedia">an interview</a> with the head of Russian Wikipedia was <a href="http://www.the-village.ru/village/city/city-news/172141-glava-russkoy-wikipedia">published</a> on the-village.  In fact, this prompted me to get an article from drafts. </blockquote><br><br>  <b>L for levenshtein</b> <br><br>  <u>Enhancing Internet connectivity ...</u>  Approximately with these words I represented the process of integrating wikipedia into a common pile of esosedi geodata. <br>  The essence of the esosedi project is very simple - adding different places to the map, with or without a goal.  What for a couple of years and do.  And if you add more wiki data in that pile of objects, there will be porridge mala≈°a.  We must somehow raise the connectivity. <br><br>  It was at this point that I called for help <a href="https://ru.wikipedia.org/wiki/%25D0%25E0%25F1%25F1%25F2%25EE%25FF%25ED%25E8%25E5_%25CB%25E5%25E2%25E5%25ED%25F8%25F2%25E5%25E9%25ED%25E0">Levenshtein distance</a> : <br><blockquote>  The Levenshtein distance is the minimum number of operations to insert one character, delete one character, and replace one character with another, necessary to turn one line into another. </blockquote><br>  The final algorithm looks like this: for all places, find wiki articles around you, compare your description with other candidates, write the result into the database. <br>  The ‚Äúcompare‚Äù moment is not as simple as it seems - approximately 16 measurements should be taken for each pair.  In transliteration, without vowels, without ‚Äúbrackets‚Äù, without minus words, through secondary directories ... <br><br>  It is Levenstein (and the distance factor) that helps to understand that the Golden and Golden Lane are the same, just like Fox Gora and Lisa Gora. <br>  Sometimes he can even distinguish between Quang Nam, Quang Ngai and Quang Nin (these are regions of Vietnam).  But B·∫Øc, B·∫°c and B·∫Øc will not be able to, because the transliteration is the same. <br><br>  The work is further complicated by different data sets for comparison.  Nobody is perfect.  For example - algorithms.  But especially UGC data.  We have to work with what is. <br><br>  <b>I for Interwiki</b> <br><img src="https://habrastorage.org/files/d59/452/e4b/d59452e4bac04e3db4b67664b09586d0.png" align="left" width="200">  And a good example of errors in UGS is interwiki. <br>  Let's open the <a href="https://ru.wikipedia.org/wiki/ISO_3166-2:SI">ru: ISO_3166-2: SI</a> page (Slovenia).  There, unfortunately, almost no region has been described. <br>  Now open the same thing, but in another language - <a href="https://en.wikipedia.org/wiki/ISO_3166-2:SI">en: ISO_3166-2: SI</a> .  There, of course, not everything is normal either, but there is some hint of data. <br>  For example, there you can find a link to the region SI-060 - <a href="https://en.wikipedia.org/wiki/Municipality_of_Litija">Municipality_of_Litija</a> , which has the Russian version - <a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B8%25D1%2582%25D0%25B8%25D1%258F_(%25D0%25B3%25D0%25BE%25D1%2580%25D0%25BE%25D0%25B4)">ru: Liya_ (city)</a> .  Here are just page 3166-2 in the Russian version contained a link to "Lithia (Slovenia)".  Not on "_ (city)". <br>  The second point - en: 3166: SI, among other things, has a link to the "statistical regions" of Slovenia.  For example, on SI-08 Osrednjeslovenska. <br>  But!  When entering <a href="https://en.wikipedia.org/wiki/Osrednjeslovenska_statistical_region">Osrednjeslovenska_statistical_region, it</a> will redirect to <a href="https://en.wikipedia.org/wiki/Central_Slovenia_Statistical_Region">en: Central_Slovenia_Statistical_Region</a> , and this article has a Russian version.  But no information about this, about such an important (probably) things like SI-08 in the Russian section 3166: SI ... well, as if there is simply no. <br>  Similar addiction occurs quite often.  Taking into account the footnote about some problems in interwiki, I will tell you in secret - <i>error: foreign key constraint failed</i> . <br><br>  <b>T for translate</b> <br>  And there is another problem - I do not know Spanish.  And I do not know German well.  And I know that someone knows English badly.  But my mother likes to relax in Sorrento. <br>  Sorento himself is fine, do not worry.  But 99% of the articles there are exclusively in Italian.  And no Levenshtein can help to understand that ‚ÄúValley of the Mills‚Äù and ‚Äú <a href="http://it.wikipedia.org/wiki/Vallone_dei_Mulini">Vallone dei Mulini</a> ‚Äù are one and the same. <br><img src="https://habrastorage.org/files/8dc/ed2/bec/8dced2bec14d4cfc80e01b12604cdb07.png" width="300" align="right"><br>  At the same time, despite the fact that this is a world-class attraction, the article is only on it.  In our country, more precisely in the Wikipedia section, everything is the same everywhere - most of the information about any places or "objects" is not translated into other languages.  Well, except for the UNESCO heritage list. <br>  As a result, it turns out that it is required to show information to a person, even if this person cannot read this information.  Just because there is no other information. <br>  There are no other options other than how to use the <a href="https://tech.yandex.ru/translate/">Yandex.Translator API</a> . <br>  <i>PS: It is a pity that the Google API.Translate is no longer with us.</i> <i><br></i>  <i>PPS: Ever since then, I think my translator has to write everything, since the quality of what exists leaves much to be desired ...</i> <br><br>  <b>V - means courtesy</b> <br>  Personally, I have had about two hours since finding the link to toolserver.org and getting the first result.  You can repeat my path too, and it will not take long.  And, most importantly, will bring a lot of pleasure. <br>  Why moderators and other active bot owners of Wikipedia cannot apply a similar analysis (and generally a ‚Äúscientific approach‚Äù) is an open question. <br>  If you have a wikipedia activist in your friends - let him know about the existence of this article.  I myself am a pessimist Wikipedia. <br>  <i>PS: Wikipedia considers any UGC ‚Äúnon-AI‚Äù sites, including esosedi for several years as included in the spam lists.</i>  <i>Because you can not trust.</i>  <i>Like the wikipedia itself, in fact.</i> <i><br></i> <br><br>  <b>Results</b> <br>  A long time ago, about 6 years ago, in the crisis of 2008, standard google maps allowed displaying a wiki overlay.  Not anymore. <br>  This year, adding a wiki layer to the neighbors, I understood what was missing - an avalanche of information about places and events in these places.  One thing you need to remember - <u>You can not just take and show Wikipedia</u> . <br><img src="https://habrastorage.org/files/0ce/f83/1e0/0cef831e0ae5456fbe485ba6b3fff62d.png"><br>  <i>PS: Many pages that eventually ended up on the map do not lead anywhere.</i>  <i>Because there are ‚Äúcriteria for the importance of information‚Äù and these pages <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B8%25D0%25BA%25D0%25B8%25D0%25BF%25D0%25B5%25D0%25B4%25D0%25B8%25D1%258F:%25D0%259A_%25D1%2583%25D0%25B4%25D0%25B0%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258E/22_%25D0%25B8%25D1%258E%25D0%25BB%25D1%258F_2014">simply erase</a> .</i> <br>  <i>PPS: I know that wiki is not a directory, and not a directory.</i>  <i>And not enough complete source of information.</i> <br><br>  <b>Afterword</b> <br>  Perhaps the world will be better, and the <a href="https://ru.wikipedia.org/wiki/%25D0%2591%25D0%25BE%25D0%25BB%25D1%258C%25D1%2588%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B5%25D1%2587%25D0%25B5%25D1%2582%25D1%258C_%25D0%25B2_%25D0%25A1%25D0%25B0%25D0%25BC%25D0%25B0%25D1%2580%25D1%2580%25D0%25B5">Big_Marry_In</a> Samarra will finally be in Samarra. <br><br><blockquote>  Initially, there were a lot of different SQL, and for this reason I added an article to the SQL hub.  But then I decided that this is unnecessary, and the requests are all banal and are of interest only within the framework of the solution of this problem. <br>  Let this article be an example of how <i>someone forgot about normal database forms, foreign keys and other automatic integrity checks</i> . <br>  For my part, I‚Äôll just give a <a href="https://yadi.sk/d/wxt5SZ6gdRQDp">SQL dump</a> (Mysql, 150mb) of my database.  Play  Check the calculations.  Run the bots.  If it is necessary to someone. <br></blockquote><br>  In fact, my story with wikipedia, geonames and Virupaksha in Hampi did not end there.  They were joined by openstreetmap, the forward and reverse geocoder, and they are together ... But more about that another time. </div><p>Source: <a href="https://habr.com/ru/post/239925/">https://habr.com/ru/post/239925/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../239907/index.html">Tesla D: Two engines, four-wheel drive, acceleration to 100 km / h in 3.2 seconds</a></li>
<li><a href="../239913/index.html">‚ÄúWild‚Äù tourism as the highest gradation of the traveler, or for whom Tourista.me was created</a></li>
<li><a href="../239915/index.html">Table of virtual methods and safety</a></li>
<li><a href="../239919/index.html">How we developed our first application on Xamarin.Forms and what came of it</a></li>
<li><a href="../239921/index.html">Trial versions of applications will appear on Google Play Store</a></li>
<li><a href="../239927/index.html">News from the world of Node: Node 0.11.14, svgexport, node-webkitgtk, Nightmare, Prototypes, node-libpq and node-pg-native</a></li>
<li><a href="../239931/index.html">Amazon opens first physical store in New York</a></li>
<li><a href="../239933/index.html">How to try a new Windows Server Technical Preview without installation</a></li>
<li><a href="../239937/index.html">Seminar for developers of custom solutions on Windows Phone October 21</a></li>
<li><a href="../239939/index.html">Solving the problem of spontaneously changing MAC addresses on Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>