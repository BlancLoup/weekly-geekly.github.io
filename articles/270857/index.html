<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Semantic technologies are simple and accessible by the example of pedigrees.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A program that is capable of drawing conclusions within the framework of the task, can seem to be a technical miracle and the embodiment of Skynet. Bu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Semantic technologies are simple and accessible by the example of pedigrees.</h1><div class="post__text post__text-html js-mediator-article">  A program that is capable of drawing conclusions within the framework of the task, can seem to be a technical miracle and the embodiment of Skynet.  But, as can be seen below, today it‚Äôs not difficult to create such a program in Python if you use semantic technologies.  We will dwell on the illustrative example of ontologies - pedigrees - and for any family member in the pedigree we will be able to deduce his family relationships of arbitrary complexity (it is limited by computational resources).  For example, on the family tree of the Romanov family, below is the first cousin twice removed nephew of Russian Emperor Peter II. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d23/314/13a/d2331413a25143c93218a2b9796c666d.png" alt="image"><br><br>  So if you want to get acquainted with the technologies of the semantic web in practice, welcome to the cat, where we will practice <s>on cats</s> on pedigrees. <br><a name="habracut"></a><br>  About triplets, RDF and ontologies can be read in <a href="https://en.wikipedia.org/wiki/Semantic_Web">Wikipedia</a> or in <a href="http://habrahabr.ru/post/14849">other</a> <a href="http://habrahabr.ru/company/itis/blog/258405">posts</a> .  To describe family relationships in pedigrees, we use the OWL 2 ontology of the Family History Knowledge Base ( <a href="http://ceur-ws.org/Vol-1207/paper_11.pdf">FHKB</a> ).  Note that although the FHKB authors recognize their offspring as a good learning example, they <a href="http://www.researchgate.net/publication/271131820_Manchester_Family_History_Advanced_OWL_Tutorial">do not recommend</a> OWL 2 for use in real genealogical applications due to computational complexity for today's reasoning systems.  Our application will remain educational: we will limit ourselves to small genealogies of up to one hundred family members. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Genealogical data is usually available in text format <a href="https://en.wikipedia.org/wiki/GEDCOM">GEDCOM</a> ( <b>.ged</b> ).  Some genealogical portals and pedigree management programs allow you to upload link graphs in this format.  We will read GEDCOM with the help of the <a href="https://github.com/madprime/python-gedcom">same name library</a> for the Python language and generate triplets of individuals (the so-called <a href="https://en.wikipedia.org/wiki/Abox">ABox</a> ) for the ontology FHKB.  Logic ( <a href="https://en.wikipedia.org/wiki/Tbox">TBox</a> ) for the derivation of kinship we already have, and all we need to do is set the data to which this logic will be applied. <br><br>  Imagine that we have data for the following three individuals (abstractly), using the example of the above-mentioned family of Russian tsars: <br><br><pre><code class="markdown hljs"> I <span class="hljs-emphasis"><span class="hljs-emphasis">*-*</span></span>  I.  I <span class="hljs-emphasis"><span class="hljs-emphasis">*-*</span></span>  II.</code> </pre> <br><br>  and FHKB logic: <br><br><pre> <code class="markdown hljs"> <span class="hljs-emphasis"><span class="hljs-emphasis">*-*</span></span>    <span class="hljs-emphasis"><span class="hljs-emphasis">*-*</span></span>  <span class="hljs-emphasis"><span class="hljs-emphasis">*-*</span></span>.</code> </pre><br><br>  Then the reasoning system is able to establish the following fact: <br><br><pre> <code class="markdown hljs"> I <span class="hljs-emphasis"><span class="hljs-emphasis">*-*</span></span>  II.</code> </pre><br><br>  The same information in the <a href="http://www.w3.org/TR/turtle">Turtle</a> RDF dialect is below.  It is compact and quite easy to read: <br><br><pre> <code class="markdown hljs">fhkb:i1 a owl:NamedIndividual ; fhkb:isBrotherOf fhkb:i2 ; rdfs:label " I" . fhkb:i2 a owl:NamedIndividual ; fhkb:isFatherOf fhkb:i3 ; rdfs:label " I" . fhkb:i3 a owl:NamedIndividual ; rdfs:label " II" . fhkb:isFatherOf a owl:ObjectProperty ; rdfs:label "-" . fhkb:isBrotherOf a owl:ObjectProperty ; rdfs:label "-" . fhkb:isUncleOf a owl:ObjectProperty ; owl:propertyChainAxiom ( fhkb:isBrotherOf fhkb:isFatherOf ) ; rdfs:label "-" .</code> </pre><br><br>  (Note: some details are omitted here for clarity. In the original FHKB, the <i>isFatherOf</i> , <i>isBrotherOf</i> and <i>isUncleOf properties are</i> defined somewhat differently to optimize logical reasoning.) <br><br>  So, we set individuals <i>i1</i> , <i>i2</i> and <i>i3</i> , the properties <i>isFatherOf</i> and <i>isBrotherOf</i> , assigned these properties to individuals and introduced a new property <i>isUncleOf</i> .  Pay attention to the prefixes <b>rdfs</b> :, <b>owl</b> : and <b>fhkb</b> : - they show the areas of expertise involved.  The prefix <b>rdfs</b> : points to the standard RDF schema (in the example above, this is the label property).  Owl prefix: indicates standard ontological terms (individual, property, sequence of properties, etc.).  And the prefix <b>fhkb</b> : is the <b>FHKB</b> genealogical ontology used by us, where the logic of family relationships is defined ( <i>isFatherOf</i> , <i>isBrotherOf</i> , <i>isUncleOf</i> , as well as other terms, <i>isGrandfatherOf</i> , <i>isFirstCousinOf</i> , etc.). <br><br>  For each individual, we only need to take from GEDCOM only minimal information about paternity (motherhood), brothers, sisters and marriages (in fact, GEDCOM doesn‚Äôt contain anything else), all other related relationships, the logic for which is given to us in FHKB, will be derived by the system reasoning. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a17/192/a67/a17192a67bf6a864b08603ccac07a16f.png" alt="image"><br><br>  So, the logical base (TBox) is available in the Turtle file <a href=""><b>header.ttl</b></a> from the repository for this article.  The genealogy of the royal family of the Romanovs in GEDCOM is also <a href="">present</a> , but the reader is advised to take one's own for interest.  And here is the script that generates individuals for the ontology FHKB from a GEDCOM file: <a href="https://github.com/blokhin/genealogical-trees/blob/master/gedcom2ttl.py"><b>gedcom2ttl.py</b></a> .  (After cloning the repository, you need to install the Python dependencies using the <b>pip install -r requirements.txt</b> command.) Copy the FHKB logic <b>header.ttl</b> to a new file and write the result of the script operation into it: <br><br><pre> <code class="bash hljs">cp data/header.ttl romanov_family.ttl ./gedcom2ttl.py data/tsars.ged &gt;&gt; romanov_family.ttl</code> </pre><br><br>  As a result, we have an ontology (TBox + ABox) in Turtle format, which can be opened in any external editor (for example, <a href="http://protege.stanford.edu/">Prot√©g√©</a> ).  If necessary, Turtle can be converted to OWL XML format using the <a href="https://github.com/blokhin/genealogical-trees/blob/master/ttl2owl.py"><b>ttl2owl.py</b></a> script.  Now the derivation of kinship for this ontology is a matter of technology.  I know of three modern open source reasoning systems for Python: <a href="https://github.com/RDFLib/OWL-RL">RDFClosure</a> , <a href="https://github.com/RDFLib/FuXi">FuXi,</a> and <a href="http://owl.man.ac.uk/factplusplus">Fact ++</a> with <a href="http://owl-cpp.sourceforge.net/"><i>owlcpp</i></a> wrapper.  In fact, there are much more of them if you ‚Äúmake friends‚Äù with a Java virtual machine Python (historically, Java is the leader in semantic technologies and provides a much larger set of tools).  These three are built to increase the complexity and performance.  The first one is a naive ‚Äúbrute force‚Äù approach, when all possible triplets are generated by the exhaustive method.  The second (FuXi) is based on the infix Python notation for OWL and <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC_Rete">the Rete algorithm</a> .  The third (Fact ++) is a low-level, optimized implementation of <a href="http://www.cs.ox.ac.uk/ian.horrocks/Publications/download/2007/HoSa07a.pdf">the Tableaux algorithm</a> .  In general, today it is one of the most effective open source reasoning systems.  For our tasks, the first system (RDFClosure) is sufficient, especially since it is written in pure Python and installed with the trivial pip install command.  For reasoning on the genealogy of the Romanovs <b>tsars.ged</b> (41 family members) RDFClosure on a laptop with an Intel Core i7 1.70GHz takes about ten seconds. <br><br>  As already mentioned, the disadvantage of OWL 2 in relation to pedigrees is computational complexity.  I dropped some of the family relationships mentioned in the illustration above and reduced the family tree of the Romanovs to royal persons and their closest relatives so that the demonstration reasoning would not load your computer too much.  If you specify all the related relationships from the illustration above and expand the genealogy to at least several hundred family members, RDFClosure becomes useless (Fact ++, however, continues to work). <br><br>  Let us start the reasoning for the above ontology: <br><br><pre> <code class="bash hljs">./infer.py romanov_family.ttl</code> </pre><br><br>  While there are arguments, I will explain the key points of the <a href="https://github.com/blokhin/genealogical-trees/blob/master/infer.py"><b>infer.py</b></a> script.  Its essence fits in six lines: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> rdflib <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> RDFClosure <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DeductiveClosure, OWLRL_Extension g = rdflib.Graph() g.parse(<span class="hljs-string"><span class="hljs-string">"romanov_family.ttl"</span></span>, format=<span class="hljs-string"><span class="hljs-string">"turtle"</span></span>) DeductiveClosure(OWLRL_Extension).expand(g) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> g.serialize(format=<span class="hljs-string"><span class="hljs-string">"turtle"</span></span>)</code> </pre><br><br>  In the first two lines, we import the RDFClosure reasoning system and the RDFLib library, which provides interaction with ontologies.  In the third and fourth line - we declare the graph and fill it with the ontology content <b>romanov_family.ttl</b> .  The fifth line is the launch of the reasoning.  In this case, they are nothing more than a cyclic expansion of the input graph with new triplets according to the rules of OWL 2. The sixth is the printing of the resulting graph (in the same Turtle format). <br><br>  So, we got the result <b>romanov_family.ttl.inferred</b> (it is several times larger than the input file by disk size).  Let's prepare it for visualization.  I wrote a simple HTML5 application ( <a href="https://github.com/blokhin/genealogical-trees/blob/master/index.html"><b>index.html</b></a> ), showing a graph of derived relationship in the browser using the D3.js JavaScript library.  It is available in the <a href="http://blokhin.github.io/genealogical-trees/">online</a> repository <a href="http://blokhin.github.io/genealogical-trees/">branch</a> for this article.  The edges of the graph correspond to information taken from GEDCOM (marriages, <i>isFatherOf</i> , <i>isMotherOf</i> ), and the derived relationship is highlighted in different colors when choosing a family member.  The choice is made by hovering the cursor or by touching the touch displays.  The graph for this application is given in JSON format with a very simple structure - a list of edges with an indication of the vertices (individuals) and the type of connection (relationship) between them.  The ontology obtained in the previous step is translated into this JSON by the <a href="https://github.com/blokhin/genealogical-trees/blob/master/ttl2json.py"><b>ttl2json.py</b></a> script: <br><br><pre> <code class="bash hljs">./ttl2json.py romanov_family.ttl.inferred &gt; romanov_family.json</code> </pre><br><br>  By default, the HTML5 application loads JSON at <b>data / tsars.json</b> .  The new JSON generated by you can be downloaded to the browser by simply pressing a button on the web page (using the File API without a server, and the visualization works offline). <br><br>  All the above commands are collected in the Shell-script <a href=""><b>gedcom2json.sh</b></a> .  With it, you can directly translate GEDCOM genealogies into JSON with derived related links for visualization.  Adding inference and visualizing other related relationships is relatively easy.  To do this, firstly, add the appropriate logic in <a href="">TBox FHKB</a> , secondly, add the identifier of the new relative to the Turtle-JSON <a href="https://github.com/blokhin/genealogical-trees/blob/master/ttl2json.py"><b>converter ttl2json.py</b></a> , and third, specify the color, name and identifier of the new relative in the HTML5 visualization code .  Of course, the generation time of JSON from GEDCOM will increase somewhat. <br><br>  In addition, there is an idea that the input maps for any ontology (not only genealogical) can be mind maps.  Of course, when drawing, you must adhere to clear rules so that you can translate the map into ABox ontologies, using, for example, the Python XMind SDK.  So, for example, I ran a logical reasoning for my pedigree, which historically led in the form of an intelligence card. <br><br>  To summarize: by setting only the closest kinship ties between family members (brothers and sisters, marriages, paternity and motherhood) and defining the logic of the remaining links, we were able to derive all other links due to semantic technologies.  Thus, we have touched the most powerful tool that underlies such products as <a href="http://products.wolframalpha.com/api/faqs.html">Wolfram Alpha</a> and the <a href="http://blogs.gartner.com/darin-stewart/2012/05/17/googles-knowledge-graph-yeah-thats-the-semantic-web-sort-of">Google knowledge graph</a> .  Ontologies and reasoning systems are mature and widely used technologies today, but, unfortunately, the threshold for entering this area is not low. <br><br>  Link to the repository for this article: <a href="https://github.com/blokhin/genealogical-trees">github.com/blokhin/genealogical-trees</a> <br>  HTML5 application: <a href="http://blokhin.github.io/genealogical-trees/">blokhin.github.io/genealogical-trees/#ru</a> <br>  Public GEDCOM files can be exported from genealogical portals, for example, <a href="http://www.wikitree.com/">www.wikitree.com</a> <br><br>  Have a nice immersion in semantic technologies, and do not be afraid of us Skynet! </div><p>Source: <a href="https://habr.com/ru/post/270857/">https://habr.com/ru/post/270857/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270845/index.html">How to make an elephant out of a fly</a></li>
<li><a href="../270847/index.html">JS Programming Contest: Email Filters</a></li>
<li><a href="../270849/index.html">An example of solving a typical OOP problem in the Go language</a></li>
<li><a href="../270851/index.html">Moscow Python Meetup ‚Ññ30</a></li>
<li><a href="../270855/index.html">Development of 2D games on Windows, Mac OS, Linux and Android without programming. Part 2</a></li>
<li><a href="../270859/index.html">Facebook helps to find out if everything is good with your friends in case of emergency</a></li>
<li><a href="../270861/index.html">Parallel development of desktop and computer games: how things got upside down in different versions</a></li>
<li><a href="../270863/index.html">We are switching from STM32 to the Russian K1986BE92QI microcontroller. Practical application: We interrogate keys, we generate PWM. Comparison of CMSIS and SPL code (PWM + TIM + PORT). Part two</a></li>
<li><a href="../270865/index.html">Out of my head. GTD in development</a></li>
<li><a href="../270871/index.html">Office in your pocket. We configure cloud PBX on mobile phones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>