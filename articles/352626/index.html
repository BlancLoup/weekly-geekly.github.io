<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Storage options for cryptographic keys</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PKI-based solutions continue to grow in popularity - more and more websites are switching to HTTPS, enterprises are introducing digital certificates f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Storage options for cryptographic keys</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/7n/8i/yn/7n8iyndbyq7ia1vd4lo2pty78ow.jpeg" align="left">  PKI-based solutions continue to grow in popularity - more and more websites are switching to HTTPS, enterprises are introducing digital certificates for authenticating users and computers, S / MIME is proving its ability to encrypt email, and as a way to verify the source of messages to counter phishing.  But encryption and authentication in these applications is practically meaningless without proper key management. <br><br>  Each time you issue a digital certificate from a certification authority (CA) or self-signed certificate, you need to generate a <a href="https://www.globalsign.com/en/ssl-information-center/what-is-public-key-cryptography/">pair of private and public keys</a> .  According to the best practices, your secret keys must be protected and be, well ... secret!  If someone receives them, depending on the type of certificate, they can create phishing sites with a certificate of your organization in the address bar, authenticate themselves to corporate networks, posing as you, sign applications or documents on your behalf, or read your encrypted emails . <br><br>  In many cases, secret keys are your employees' personal IDs (and, therefore, part of the organization‚Äôs personal data), so their protection equals fingerprint protection when using biometric credentials.  You will not allow a hacker to get the imprint of your finger?  The same with secret keys. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this article we will discuss options for protecting and storing private keys.  As you will see, these options may vary slightly depending on the type of certificate (s) and how you use it (for example, the recommendations for SSL / TLS certificates differ from those for end-user certificates). <br><a name="habracut"></a><br><h1>  Certificate / Key Store in OS and Browsers </h1><br>  <i>Examples: Windows Certificate Store, Mac OS Keychain</i> <br><br>  Some operating systems and browsers have certificate or key repositories.  These are software databases that locally store a pair of private and public keys on your computer as part of a certificate.  Such key storage is quite popular: many applications automatically search for keys here right away, and you do not need to manually specify the certificate file each time, so this is quite a convenient option. <br><br>  Another plus of this option is that it is fairly easy to configure.  You can enable / disable the export of the private key, enable reliable protection for it (entering the password every time the certificate is used), and you can create backup copies if the private key is exported.  In addition, when you turn on roaming profiles in Windows, the certificate is bound to a profile and becomes available when you log on to another computer with this profile. <br><br>  If you decide to choose this option, you should consider several aspects.  First, even if you mark a private key as non-exportable, some utilities can bypass this protection (that is, the impossibility of exporting is not guaranteed).  In addition, if someone worked under your account, and you did not include strong private key protection (password when using the certificate), then they can use your certificate.  Finally, if your private key is marked as exportable, then someone at your computer will be able to export it.  Even if you have the private key protection enabled, the password is not asked when exporting. <br><br>  One last thing: Chrome and IE use the Windows certificate store, while Firefox has its own certificate store (from Mozilla).  This means that if you import a certificate into the Windows storage, then Chrome and IE will automatically find it, but Firefox will not. <br><br><h3>  Typical applications: </h3><br><ul><li>  Digital signatures (for example, Adobe Acrobat, Microsoft Outlook, and Office will access the Windows [custom] certificate store). </li><li>  Microsoft IIS Server is also looking for SSL certificates in the Windows certificate store [shared for computer]. </li><li>  Client (user or computer) authentication, depending on the settings, most often refers to the Windows certificate store. </li><li>  Signature code in Windows (applications and drivers). </li></ul><br><h1>  .Pfx and .jks files (keystores) </h1><br>  PKCS # 12 files (.pfx or .p12) and .jks * (created by the Java Keytool tool) contain your private and public keys.  Unlike local storage for OS and browsers, these files can be located almost anywhere, including remote servers, and are always protected with a password (that is, each time you use your private key, you must enter the password).  Another attractive feature: since these are just files, it is easy to send copies to several people who need to use a certificate. <br><br>  If you decide to save the file on a remote server, then you should especially take care to restrict access to it.  If someone gets access, they can use your certificate.  Similarly, you should be especially careful with easy copying and distribution of these files.  Although this is a great convenience for you, at the same time, the attacker will simply make a copy if he gets access to your keystore.  The private key password is still needed to effectively use the copied file.  This is another reason to use strong passwords of 15 or more characters containing capital letters, numbers and special characters.  With this storage option, one more thing needs to be taken into account: more responsibility is imposed on the end user in terms of where the file is located and whether it is stored correctly. <br><br>  If you cannot use cryptographic equipment or Windows keystore (described above), but still want to increase security (instead of just placing the keystore file on your computer), you can write this file to a flash drive, which will be in a safe place. .  Of course, some convenience is lost here, so if you need to frequently use a signature, you would rather want to store the file locally for easier access. <br><br><h3>  Typical applications: </h3><br><ul><li>  Signing Windows or Java code. </li><li>  <a href="https://www.globalsign.com/en/fda-esg/">FDA ESG</a> and <a href="https://www.globalsign.com/en/lp/ides-irs-fatca-compliance/">IRS IDES</a> use .pfx to communicate securely with US government agencies. </li><li>  Some web servers (for example, Apache Tomcat or Jboss). </li></ul><br>  * Note: Java <a href="https://bugs.openjdk.java.net/browse/JDK-8044445">recently switched</a> from JKS to PKCS # 12 as the default keystore type. <br><br><h1>  Cryptographic Tokens and Smart Cards </h1><br><img src="https://habrastorage.org/webt/xi/rq/zr/xirqzrbj0cj68c8xwjeacart4pc.jpeg"><br><br>  As casually mentioned above, you can increase security by storing the secret key on separate hardware.  But there is a big difference between using cryptographic tokens or smart cards and standard flash drives.  With cryptographic equipment, the key is generated on the hardware itself and is not exported.  The private key never leaves the device, which makes it difficult for an outsider to gain access and compromise. <br><br>  Note: if you want to additionally secure the private key that has already been generated earlier (that is, not on the token itself), then you can import the .pfx file to the token, and then delete the original .pfx. <br><br>  With a token, every time you use a certificate, you must enter a password.  This means that even if someone gets your token, they still need a password.  Keeping a key in a token means that you can safely use the same certificate on multiple computers without having to create multiple copies and go through the export / import process.  Cryptographic equipment <a href="https://csrc.nist.gov/projects/cryptographic-module-validation-program/standards">complies with FIPS</a> , which is required for some industry and government regulations. <br><br>  Of course, there are some other considerations to keep in mind if you decide to choose this option.  In addition to the additional difficulties of managing tokens, this option may not work with automatic builds due to the requirement to enter a password every time the certificate is used.  There is also no way to back up the certificate, since the private key is not exported (lack of additional security).  Finally, in some scenarios, this storage option is simply not possible.  For example, if specialized devices do not support tokens or smart cards.  Or in situations where employees do not have physical access to the computer, but work from remote terminals. <br><br><h3>  Typical applications: </h3><br>  As a rule, all use cases listed for storage in OS / browser (signature of documents and code, client authentication, Windows IIS), support crypto tokens or smart cards - if there are appropriate drivers.  However, this is not always practical (for example, in web servers or automated assembly systems for code signing, which will require a password to be entered each time a signature is applied). <br><br>  Compliance with regulatory requirements is one of the main reasons for using cryptographic tokens. <br><br><ul><li>  Required to sign the Extended Validation Code (EV) in accordance with the <a href="https://cabforum.org/wp-content/uploads/EV-Code-Signing-v.1.3.pdf">recommendations of the CA / Browser forum</a> . </li><li>  Recommended for standard code signing in accordance with the <a href="https://casecurity.org/wp-content/uploads/2016/09/Minimum-requirements-for-the-Issuance-and-Management-of-code-signing.pdf">minimum requirements of the CA Security Council</a> .  Certification centers are required to recommend cryptographic equipment as the main option for issuing certificates.  If the cryptographic equipment is not issued, the client must sign an agreement that will store the private key on some removable equipment (which is removed after signing). </li><li>  Required to digitally sign and obtain trusted status in Adobe programs, in accordance with the <a href="https://helpx.adobe.com/content/dam/help/en/acrobat/kb/approved-trust-list2/_jcr_content/main-pars/download-section/download-1/aatl_technical_requirements_v2.0.pdf">requirements of the Adobe Approved Trust List (AATL)</a> . </li><li>  Industry rules such as CFR 21 part 11 from the FDA and digital signature requirements in individual countries often speak of a secret key that is solely owned by the owner.  Storage on cryptographic equipment meets these requirements. </li></ul><br><h1>  Cryptographic Hardware Modules (HSM) </h1><br><img src="https://habrastorage.org/webt/nn/f6/_f/nnf6_fmxjnhtzqqaeqjbw9f4mzg.jpeg"><br><br>  HSM is another hardware key storage solution, especially if you don‚Äôt want to rely on individual tokens or this seems too burdensome.  While tokens are more focused on manual input or individual applications (for example, signing a small number of documents or code, authenticating with VPN or other networks), HSMs provide APIs, support automated workflows, and automated assembly.  They also comply with FIPS requirements and usually provide a higher rating than tokens. <br><br>  Traditionally, HSMs are local physical devices that require qualified resources to manage and support basic requirements and SLAs.  HSM maintenance can be an expensive and resource-intensive process, which in the past has prevented the spread of this technology.  Fortunately, in recent years, cloud-based HSM modules have emerged that provide many of the advantages of local HSM without needing local maintenance. <br><br>  An example would be the familiar <a href="https://azure.microsoft.com/en-gb/services/key-vault/">Key Vault</a> service in the Microsoft Azure cloud, which stores cryptographic keys in the cloud-based HSM from Microsoft.  If you have a small organization that does not allow itself to purchase and manage its own HSM, then this is an excellent solution that integrates with public certification authorities, including <a href="https://www.globalsign.com/en/lp/certificates-for-azure-key-vault/">GlobalSign</a> . <br><br>  If you are considering the option of signing documents, we recently launched a new <a href="https://www.globalsign.com/en/blog/digital-signatures-in-the-cloud/">Digital Signing Service</a> , which also uses the HSM cloud storage for private keys.  It is worth noting that the new service supports individual signatures of all employees.  In the past, most signature-based HSM solutions supported only identifiers at the level of departments or organizations (for example, accounting, marketing, finance) and not for individuals (for example, John Doe).  Therefore, to work at the level of individual employees, organizations had to deploy the infrastructure of tokens, which, as we noted above, can be burdensome.  With this new service, digital signatures of individual employees are introduced without the need to independently manage HSM (and without the risk of employees losing tokens). <br><br><h3>  Typical applications: </h3><br><ul><li>  Signature of documents or code in large quantities. </li><li>  SSL (depending on server configuration). </li><li> The CA infrastructure for running your own CA (root CA, subordinate CA, RFC 3161 time stamp server) is offline or online (the root CA usually works offline). </li></ul><br><h1>  Future key storage methods </h1><br>  We considered the main options that have been used for many years.  But it seems that nothing in the world of information security, including the storage of keys, is immune to the influence of IoT, so new options are being developed. <br><br>  As more and more devices connect to the network with the need for authentication and secure data exchange, many developers and manufacturers are turning to PKI-based solutions.  In turn, this leads to new considerations, requirements and technologies for protecting private keys.  Below are two trends that we see in this area. <br><br><h3>  Trusted Platform Module (TPM) </h3><br>  TPMs are not new in themselves, but increasingly they are used to protect private keys.  The TPM can be used to store (or transfer) the root key and protect additional keys created by the application.  Application keys cannot be used without TPM, which makes it a very useful authentication method for endpoints such as laptops, servers, and IoT device manufacturers.  While many laptops are already shipped with TPM, this technology is not widely used in the corporate sector.  However, in the IoT world, they are often used to securely identify devices as the <a href="https://www.globalsign.com/en/blog/iot-security-hardware/">hardware root of trust</a> . <br><br>  IoT has created a problem when many anonymously interacting devices make it easier for hackers to intercept messages or impersonate devices.  The TPM module is implemented at the production stage to protect the cryptographic key and, therefore, for reliable identification of the device. <br><br>  During production, a pair of private and public keys is generated.  The public key is sent to a certification authority for signing and issuing a digital certificate.  The private key never leaves the device.  It is stored on a chip and cannot be exported / copied / destroyed.  Now the certificate is a device passport, and the protected private key forms the hardware root of trust. <br><br>  We work closely with <a href="https://www.infineon.com/cms/en/applications/smart-card-and-security/internet-of-things-security/">Infineon</a> to develop Internet of Things solutions that combine PKI based device identification with TPM-based trust roots.  For more information, read the proof of concept: <i><a href="http://downloads.globalsign.com/acton/attachment/2674/f-0508/1/-/-/-/-/strong-device-identity-iot-poc.pdf">"Secure authentication and hardware management using Infineon's GlobalSign and Cloud Certificate Service OPTIGA TPM."</a></i> <br><br><h1>  Physically uncloneable functions (PUF) </h1><br>  The technology of physically non-cloning functions (PUF) is a paradigm shift in key protection.  Instead of storing keys (with the probability of a physical attack), they are generated from the unique physical properties of the static SRAM of a particular chip and only exist when the power is turned on.  That is, instead of storing the private key securely, the same key is restored again and again on demand (until the device fails).  This key is guaranteed to be unique, because the generation uses the inherent uncontrollable disorder in the silicon structure of the chip. <br><br>  PUF technology combined with a trusted execution environment (TEE) is an attractive solution if you need low-cost, easy-to-integrate and ultra-secure key protection.  PUFs, along with the PKI, constitute a comprehensive identification solution. <br><br>  Our partner Intrinsic ID has developed a key preparation system based on SRAM PUF, which produces unique, tamper-proof and copy-protected device identifiers at the hardware level.  Using our certification services, we translate these identifiers into digital identities, adding PKI capabilities.  Thus, each device is assigned a unique key pair protected from cloning, which is not stored on the device in the off state, but the device is able to recreate this key upon request.  This protects against an attack on a switched off device. <br><br>  More about our joint identification solution. <br>  IoT devices; see a recent webinar: <i><a href="https://www.globalsign.com/en/lp/webinar-strong-device-identities-sram-puf-based-certificates/">‚ÄúPersistent Device Ids with SRAM PUF Certificates‚Äù</a></i> . <br><br><h1>  Do not lose the (secret) keys to your fortress! </h1><br>  Keeping a private key should not be black magic.  Ultimately, the correct option depends on who and what uses the certificates, what standards you have to follow, what the price is, the current environment and internal resources.  I hope this article will help in your decision. <br><br>  _______________________________________________________ <br><hr><br>  <b>PROMOTION GLOBALSIGN: Wildcard SSL + 1 YEAR AS A GIFT</b> <br>  Protect all subdomains with one certificate! <br><br>  Save up to 30 thousand rubles when you buy Wildcard SSL certificate for 2 years! <br>  Promotional Code: WC001HRFR <br><br>  The promotion is valid for subscribers of the <a href="http://habr.com/company/globalsign/%3Futm_source%3Dhabrahabr%26utm_medium%3Dblog_GlobalSign%26utm_campaign%3DChrome-_unsecure">blog GlobalSign</a> until June 15, 2018. <br><br>  For more information, please contact GlobalSign managers by phone: +7 (499) 678 2210 or by filling out a <a href="http://www.globalsign.com/ru-ru/kompania/kontakty/obshiy-zapros.html%3Futm_source%3Dhabrahabr%26utm_medium%3DForm-create_order%26utm_campaign%3DChrome-_unsecure">form on the website</a> indicating the promotional code. </div><p>Source: <a href="https://habr.com/ru/post/352626/">https://habr.com/ru/post/352626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352616/index.html">Ansible is not so simple</a></li>
<li><a href="../352618/index.html">How to switch to microservices and not break production</a></li>
<li><a href="../352620/index.html">We open the history of the Bolshoi Theater. Part one</a></li>
<li><a href="../352622/index.html">Performance analysis of the drive Intel Optane SSD 750GB</a></li>
<li><a href="../352624/index.html">The Metrix has you ...</a></li>
<li><a href="../352628/index.html">Rumors about the cancellation of the Kotelnikov theorem are greatly exaggerated</a></li>
<li><a href="../352630/index.html">As Google Adwords experts helped me to throw away 150,000 UAH (about $ 6000) per month or why I will not ...</a></li>
<li><a href="../352632/index.html">True implementation of a neural network from scratch. Part 2. Recognition of numbers</a></li>
<li><a href="../352634/index.html">Network Optimization for Unreal Engine 4</a></li>
<li><a href="../352636/index.html">20 modules for Node.js, which is useful to know</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>