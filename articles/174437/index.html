<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Delegating Administrative Tasks to Active Directory</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In view of the fact that during Habravstrechi I talked about 11 different scenarios, naturally, I would like to dwell on each of these moments. In oth...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Delegating Administrative Tasks to Active Directory</h1><div class="post__text post__text-html js-mediator-article">  In view of the fact that during Habravstrechi I talked about 11 different scenarios, naturally, I would like to dwell on each of these moments.  In other words, starting with this article, I will consider most of the points that were discussed during the previous report.  So‚Ä¶ <br>  Relatively recently, I was asked several questions in Windows Live Messenger related to the delegation of administrative authority in Active Directory.  However, before proceeding to the questions themselves on this topic, I will literally tell you in a few words what the delegation is and why it is needed. <a name="habracut"></a><br><h2>  Delegation of Active Directory Objects </h2><br><img src="https://habrastorage.org/storage2/a26/a19/fa3/a26a19fa3e14b304aa71b04eca7eaa57.jpg" align="right">  It‚Äôs more than obvious that in virtually every organization, the IT department includes several administrators, and the various administrative tasks should be distributed among the administrators, or, say, among the support service members.  For example, as in this example, let's say employees of the support department have to add computers to the domain.  However, such a group of users should not be able to perform operations other than those that you want to allow them. <br>  But those permissions that can be assigned to users, groups, or computers, in other words, to security principals, are called <b>access control entries</b> (ACE).  Therefore, the access permissions for the object are modified using the ACL.  You can view ACLs directly using such snap-ins as <b>Active Directory Users and Computers</b> , <b>Active Directory Administrative Center</b> , as well as in such snap-ins as <b>Active Directory Sites and Services</b> , <b>ADSI Editor</b> , and also <b>"LDP"</b> (some funds will be discussed in more detail later in this article).  If we talk about permissions to control access to objects AD, then immediately it should be noted that they are divided into <b>standard permissions</b> and <b>special permissions</b> .  Special permissions are granular options that apply to a particular object, and standard access permissions are already composed of a set of special permissions that allow, or, conversely, prohibit a particular function.  Solely, as an example, we can single out such a standard resolution as <b>reading</b> , because in fact it includes recording such special permissions as <b>reading permissions</b> , a <b>list of contents</b> , as well as <b>reading all the properties</b> .  But that's another topic. <br>  Actually, all ACE records are located in a <b>discretionary access control list</b> , in other words, in the original it sounds like the <b>Discretionary Access Control List</b> , or, more simply, in the DACL.  This is a list of access control entries that defines the access permissions for each security principal to an object.  In turn, each security principal that is added to an object receives a list of permissions, which indicates that a particular user or group of users can perform specific operations with the object itself.  It should always be remembered here that ACEs that have been explicitly assigned will always be evaluated before inherited ACEs.  And also it is always necessary to take into account the fact that prohibiting records will always prevail over allowing ones. <br>  The DACL itself is part of the ACL of the object itself, which still contains the <b>system access control list</b> , in other words, the System Access Control List, SACL.  This list defines the audit parameters for an object, including all security principals and operations for which an audit is to be performed. <br>  Thus, returning to the very topic of this section, the <b>delegation of administrative tasks</b> is the inheritance of permissions of the parent object for the security principal created in Active Directory. <br><h2>  Example delegation of administrative authority </h2><br>  One of the tasks that had to be performed was the following: it was necessary to provide an opportunity to a certain group of users, say, to some technical staff, to add computers to the domain and distribute these computers to different departments.  In principle, this task can be called trivial, but we slightly change the conditions to make it more interesting.  What will be done: since, by default, each user can join a computer to the domain, we will correct this situation so that only those users who are members of the <b>‚ÄúSupport‚Äù</b> security group can join the computers to the domain.  Therefore, you need to perform the following steps: <br><ol><li>  First, open <b>the Active Directory Users and Computers</b> snap-in on the domain controller.  Here you need to create a global security group whose members will be able to join users' computers to the domain.  In other words, this group will look like this: <br><br><img src="https://habrastorage.org/storage2/db7/d85/c7e/db7d85c7e3af0ae4abdace0e01173c73.png"><br>  <b>Fig.</b>  <b>1. Properties of the group responsible for joining computers to the domain</b> </li><li>  The next step is to indicate that computers can only be joined to the domain by users who are members of the global security group created in the previous step.  To do this, open <b>the Group Policy Management</b> snap- <b>in</b> and go to the GPME editor for the <b>Default Domain Controllers Policy</b> GPO created by default, which is located in the <b>Domain Controllers</b> division. <br>  In the displayed snap-in, go to the <b>"Computer Configuration \ Policies \ Windows Configuration \ Security Settings \ Local Policies \ User Rights Assignment"</b> node and localize the policy setting called <b>"Adding workstations to the domain"</b> .  When you open the dialog box for this policy setting, you will immediately be able to find that, by default, the <b>"Authenticated"</b> group is listed there, thanks to which every user can join computers to the domain.  Now, in order to allow computers to be joined to the domain only by users from the <b>‚ÄúSupport‚Äù</b> security group, you should remove the group specified in this default policy setting, and then use <b>the Add User or Group</b> button and the Active Directory object search dialog, should add the previously created global security group.  The process of adding such a group is depicted in the following illustration: <br><br><img src="https://habrastorage.org/storage2/5f8/10c/6b2/5f810c6b2f89e979b4b9844cf8a8038d.png" width="550" height="394"><br>  <b>Fig.</b>  <b>2. Change the group responsible for joining computers to the domain</b> </li><li>  Now, although it was described a little bit earlier, in which scenarios delegation is performed, and that in most cases delegation is performed at the department level, in this case, to allow computers to join the domain, we should be in the <b>Active Directory Users and Computers</b> snap-in. <b>¬ª</b> Call the Delegation Wizard directly for the entire domain.  Therefore, in the <b>Active Directory Users and Computers</b> snap-in, in the snap-in tree area, call the context menu for the domain and select <b>the Delegate control</b> option, as shown below: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/3e2/32d/e75/3e232de75861d8221ab86762240ff35f.png" width="550" height="382"><br>  <b>Fig.</b>  <b>3. Calling the Delegation Management Wizard</b> </li><li> On the first page of the wizard, you can simply familiarize yourself with the main task of this tool and, since you cannot perform any actions on the first page, you should simply click on the <b>‚ÄúNext‚Äù</b> button.  On the second page of the wizard, the <b>Users and Groups</b> page, you need to localize the group for which you want to delegate control.  In this example, click on the <b>‚ÄúAdd‚Äù</b> button and select the <b>‚ÄúSupport‚Äù</b> group using the appropriate dialog, as shown in the following illustration: <br><br><img src="https://habrastorage.org/storage2/b76/be5/455/b76be545506566c490eb6f66cc212337.png" width="550" height="369"><br>  <b>Fig.</b>  <b>4. Adding a group for which management is delegated</b> <br>  After the group is added, to go to the next page of the wizard, click on the <b>"Next"</b> button. </li><li>  The <b>"Delegated Tasks"</b> page allows you to define specific operations that should be performed in Active Directory Domain Services by users or groups of users that were added on the previous page of the wizard.  Since in this example the task of joining computers to a domain is delegated and such a task can be found in the provided list of common tasks, check the box next to the task <b>‚ÄúJoin a computer to the domain‚Äù</b> and click on the <b>‚ÄúNext‚Äù</b> button.  It is worth paying attention to the fact that this wizard allows you to delegate not only those tasks that appear on this list, and if you were unable to immediately find a specific task, you will need to create a special task for delegation.  The creation of a special task will be shown later in this article, and the delegation of the task of joining a computer to a domain is shown in the following illustration: <br><br><img src="https://habrastorage.org/storage2/cda/0ac/c17/cda0acc17301d32440491269d28b503a.png"><br>  <b>Fig.</b>  <b>5. Delegation of the task of joining computers to the domain for members of the Support group</b> </li><li>  On the last page, the wizard will re-inform that the work of the wizard was successfully completed and control was transferred to a specific group of users to join the computers to the domain, which, in fact, was the task assigned to us: <br><br><img src="https://habrastorage.org/storage2/09b/b17/289/09bb17289c9de5afbbe9dec7120a6407.png"><br>  <b>Fig.</b>  <b>6. Completion of the delegation of management</b> </li></ol><br>  Now, after all these actions have been completed, only those users who are members of the global <b>support</b> group <b>‚ÄúSupport‚Äù</b> created earlier will be able to join computers to the domain. <br><h2>  Defining the tasks for which delegation was granted </h2><br>  Immediately after the possibility of joining computers to the domain to a specific security group, a question of this nature arose: ‚ÄúCan I somehow view the tasks delegated earlier‚Äù?  Here the answer is simple: you can view, and not the only method.  All possible options for viewing tasks for which delegation was delegated are simply meaningless to be considered in one article, so later in this article several basic options will be presented: <br><ol><li>  The first method is to use <b>the Active Directory Users and Computers</b> snap <b>-in</b> .  First of all, in order to view the tasks that have been delegated, for the snap-in itself, the display of additional components should be enabled in the <b>View</b> menu.  After that, go to the properties dialog of the department for which the delegation was performed.  Since the previous section delegated for the entire domain level, in this example, the domain properties dialog box appears. <br>  In the dialog box that appears, go to the <b>"Security"</b> tab, and then from there call the dialog box for advanced security settings.  Here, in the dialog box that appears, you can find all the ACE entries that were set, both by default and with the help of the Delegation Wizard.  For example, in the following illustration, you can see that a permission has been added to the <b>Support group</b> that allows you to create <b>Computer</b> objects: <br><br><img src="https://habrastorage.org/storage2/4b3/a9d/82f/4b3a9d82f44b90e786c27e13d76685af.png" width="550" height="369"><br>  <b>Fig.</b>  <b>7. View delegated tasks for the Support group</b> <br>  If you wish, you can either change the permissions for the current group, and, if necessary, delete it completely. </li><li>  Now consider a more sophisticated method, namely the use of <b>LDP.exe</b> .  This time you should do the following: <br>  Open the LDP tool and connect to the domain controller on port 389 using <b>the Connection</b> menu, as shown in the following illustration: <br><br><img src="https://habrastorage.org/storage2/4c8/7c7/46c/4c87c746ce87aee25bed3278efd6c5ff.png" width="550" height="374"><br>  <b>Fig.</b>  <b>8. Connection to a domain controller</b> <br>  After that you should bind using the command of the same name from the <b>"Connection"</b> menu.  Since at the moment I am logged in as an administrator, I can not enter credentials, and in the displayed <b>‚ÄúBinding‚Äù</b> dialog box immediately press the <b>‚ÄúOK‚Äù button</b> , as shown below: <br><br><img src="https://habrastorage.org/storage2/84d/bfc/860/84dbfc860867d8f80366876e9ed07f94.png" width="550" height="374"><br>  <b>Fig.</b>  <b>9. Perform bind</b> <br>  Now you can connect to the required department or immediately to the entire domain by selecting the <b>"Tree"</b> command from the <b>"View"</b> menu.  In case you need to view the entire domain, you can leave the field blank, but if you plan to view a specific department, you must specify the distinguished name in the following format: "OU = OU name, DN = domain ...". <br>  Then, in order to see who was granted the delegation, you should look at the entire structure in a tree view.  In other words, from the <b>‚ÄúView‚Äù</b> menu <b>,</b> select the <b>‚ÄúTree‚Äù</b> command and in the displayed <b>‚ÄúTree‚Äù</b> dialog box specify the base expandable name (or, since in the example above you need to view the entire domain, you can leave this text field empty). <br>  Already in the familiar area of ‚Äã‚Äãthe tree, you need to select a department, the rights to which should be checked, and then select the <b>"Advanced"</b> command and the <b>"Security Descriptor"</b> from the context menu.  In the dialog box that appears, be sure to ensure that you have the correct DN selected, and that the checkbox is on the <b>‚ÄúACL List‚Äù</b> option, as shown in the following illustration: <br><br><img src="https://habrastorage.org/storage2/b4a/376/f18/b4a376f18815c521fc85e5653377b977.png" width="550" height="376"><br>  <b>Fig.</b>  <b>10. Opening Security Descriptor Dialog</b> <br>  Now in the dialog box that appears, you can view all groups and users who have been granted certain permissions.  If necessary, you can also edit or delete delegated permissions using the appropriate buttons.  The security descriptors dialog box, as well as the window for editing delegated permissions, is displayed in the following illustration: <br><br><img src="https://habrastorage.org/storage2/6a3/524/ba9/6a3524ba9bd93f4d90fa71dd0a25dfb8.png" width="550" height="348"><br>  <b>Fig.</b>  <b>11. View and change delegated permissions for a support group.</b> </li><li>  The third option to some extent can be called more modernistic, since now we will determine which permissions were assigned to the same support group, but already using the <b>Active Directory Administrative Center</b> snap-in.  To do this, open this tool, select a subdivision in the snap-in tree for which you should see who was granted the delegation, and then go to the properties of the selected object, for example, as shown in the following illustration, directly from the context menu: <br><br><img src="https://habrastorage.org/storage2/012/059/627/0120596279df640e43e0ee99d26c08dc.png" width="550" height="285"><br>  <b>Fig.</b>  <b>12. Go to the properties of the selected object</b> <br>  After working with <b>the Active Directory Users and Computers snap-in,</b> you can immediately decide what needs to be done.  In the dialog box that appears, go to the <b>Permissions group</b> , and all that remains is to select the required group and go to the Advanced Security Settings dialog.  The permission group is displayed below: <br><br><img src="https://habrastorage.org/storage2/b1c/1af/b5f/b1c1afb5fb51f242e80a225078a29ae6.png" width="550" height="475"><br>  <b>Fig.</b>  <b>13. Permissions of the security support team</b> </li><li>  If you are a fan of the command line, then no one limits you.  To view permissions to control user actions in Active Directory, a command line utility such as <b>DSACLS is provided</b> .  Often this command is executed with the distinguished name of the object.  For example, in order to find out who has permissions to the entire domain, run the command: <br>  <i>DSACLS DC = 331zone, DC = com</i> <br>  The result of the command is shown in the following illustration: <br><br><img src="https://habrastorage.org/storage2/32c/21c/d17/32c21cd176183b61d87acf8279013a6b.png" width="550" height="588"><br>  <b>Fig.</b>  <b>14. Check permissions for the support team using command line</b> </li></ol><br>  By and large, there are still at least 6 ways to view the delegation of administrative authority, but they are simply meaningless to describe in one article, and if this topic interests you, I can show most of these methods in a separate webcast. <br>  However, in addition to allowing computers to join the domain and viewing the configured permissions, we still have another small task, which will be discussed in the next small section. <br><h2>  Permissions for moving objects between departments </h2><br>  The latter task, which will be discussed in this article, is the implementation of allowing the movement of computer objects between departments for the <b>Support group</b> .  Since last time we implemented permissions for joining computers to a domain by means of delegating control, this time we should try to look for means of solving this problem in this wizard.  To solve this problem, it will be necessary to edit some permissions for <b>the Computers</b> container, since it is known that GPOs cannot be associated with this container, and the support division employees need to distribute computers among different departments. <br>  After opening the delegate management wizard and adding the target group, you will find that it is impossible to perform such actions among normal tasks.  In this case, you should try to use the list of <b>special tasks for delegation</b> .  In the displayed dialog box, you have the opportunity to delegate all objects in the container you selected (in this case, you should set the switch to the option <b>‚Äúthis folder, existing objects in it and creation of new objects in this folder‚Äù</b> ), as well as the ability to transfer control only to selected objects which can be found in the corresponding list (the option <b>‚Äúonly to the following objects in this folder‚Äù</b> ). <br>  Among the available objects, check the box <b>‚ÄúComputer objects‚Äù</b> and then select the check box <b>‚ÄúDelete selected objects from this folder‚Äù</b> under this list. <br>  The dialog box for this page of the Delegation Wizard is shown in the following illustration: <br><br><img src="https://habrastorage.org/storage2/191/99d/928/19199d9282944be6a3cc9c5d8bb558dd.png"><br>  <b>Fig.</b>  <b>15. The page for creating a special task for delegation</b> <br>  After that, on the next page of the wizard, the <b>‚ÄúPermissions‚Äù</b> page - you should indicate that the <b>‚ÄúRecord‚Äù</b> permission is delegated, and that will be enough. <br>  Since the task of moving can be divided into two parts ‚Äî removing an object from <b>the Computers</b> container and then creating an object in another department ‚Äî as an example only, creating objects in a specially created department for computer accounts will be demonstrated by changing additional security settings for the required units (similar actions were discussed in the previous section). <br>  Now, if you closed <b>the Active Directory Users and Computers</b> snap <b>-in,</b> you need to enable the display of additional components for it, and then go to the subdivisions properties dialog box to which computer accounts should be moved.  In my case, this is the <b>Clients</b> division. <br>  In the properties dialog of this unit, go to the <b>Security</b> tab, and then open the advanced security settings dialog box.  In the dialog box that appears, localize the previously added group and make sure that support group employees are allowed to join computers to the domain, but the permissions associated with deleting objects are missing here, and then go to the permission editing dialog by clicking the <b>Add</b> button. <br>  In the <b>‚ÄúPermission element for Computers‚Äù</b> dialog box that appears <b>,</b> you need to add a group that will apply permissions.  In other words, click on the link <b>‚ÄúSelect a Subject‚Äù</b> and localize the <b>Support</b> group using the appropriate dialog box.  Since within the previously created subdivisions there may be sub-divisions with different breakdowns (for example, computers by departments), from the <b>"Applies to"</b> drop-down list, select the <b>"This object and all child objects"</b> option, which is set by default. <br>  It remains only to choose the desired resolution.  Since we need to allow computers to be moved, which means that objects will be created inside this and all nested containers, check the box next to the <b>‚ÄúCreate Objects: Computer‚Äù</b> permission, and then save all the changes made.  The " <b>Permissions for Clients"</b> dialog box is shown below: <br><br><img src="https://habrastorage.org/storage2/53c/4ef/41f/53c4ef41fa8541aa52c6f622b6b2bf16.png" width="550" height="353"><br>  <b>Fig.</b>  <b>16. Adding Permissions to Create Computer Objects</b> <br><h2>  Instead of conclusion </h2><br>  By and large, you can come up with many more examples related to the delegation of authority and the assignment of non-standard permissions to different security groups, and almost every example can be called unique and interesting in its own way.  Remember that instead of assigning all administrators, it will be much more beneficial if you simply assign permissions to specific tasks to specific groups of users.  Please write in the comments to this article whether you used delegation in yourselves and what examples you encountered and experienced difficulties. </div><p>Source: <a href="https://habr.com/ru/post/174437/">https://habr.com/ru/post/174437/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../174421/index.html">Jason Zander confirmed his participation in the DevCon 2013 conference</a></li>
<li><a href="../174423/index.html">Zero day vulnerability in roundcube</a></li>
<li><a href="../174431/index.html">Development for BlackBerry 10. Start</a></li>
<li><a href="../174433/index.html">Cognitive Anatomy of Languages ‚Äã‚Äãin iTunes</a></li>
<li><a href="../174435/index.html">Booklet for sharing in Odnoklassniki.ru</a></li>
<li><a href="../174439/index.html">Flipboard 2.0 released [Review]</a></li>
<li><a href="../174441/index.html">"Building blocks" for corporate networks</a></li>
<li><a href="../174443/index.html">Clearing float elements by creating a new block formatting context</a></li>
<li><a href="../174449/index.html">Console Command Notifications</a></li>
<li><a href="../174451/index.html">We return privacy or big brother watching me on the standard settings. Part 2. We block tracking scripts on sites and configure VPN</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>