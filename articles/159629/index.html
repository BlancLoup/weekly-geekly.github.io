<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Localization of a simple pygtk program with glade form in Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At once I will make a reservation that python and gtk I have 2nd version. 

 The unexpected desire to make the inscriptions on the main form of the pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Localization of a simple pygtk program with glade form in Linux</h1><div class="post__text post__text-html js-mediator-article">  At once I will make a reservation that python and gtk I have 2nd version. <br><br>  The unexpected desire to make the inscriptions on the main form of the program I am developing are not only Russian, but also in other languages ‚Äã‚Äã(and maybe it will be necessary not only for me), forced me to start looking for implementation methods.  With a swoop, it was not possible to find working documentation on the localization of glade forms, so it was decided to write this article in the future so that others are more fortunate. <br><br>  What is not in this article: <br>  - How to make a translation of the form in the process.  I could not find it, but I would like to know ... <br>  - how to translate text in .py code in the process. <br>  - Of course there is no beer, blackjack and the rest. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The translation will be done by specifying the locale at startup (or the default locale). <br><br><a name="habracut"></a><br>  The first thing you need is a finished glade form.  Since  I deliberately did a simple test to figure out, then I have a simple mold, with a label, a button and a checkbox. <br><br><div class="spoiler">  <b class="spoiler_title">xml form code</b> <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE glade-interface SYSTEM "glade-2.0.dtd"&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--Generated with glade3 3.4.5 on Tue Nov 13 12:44:47 2012 --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">glade-interface</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GtkWindow"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"window1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">child</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GtkVBox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vbox1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"visible"</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">child</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GtkLabel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"label1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"visible"</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"label"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">translatable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span>label text<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">child</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">child</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GtkButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"visible"</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"can_focus"</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"receives_default"</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"label"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">translatable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span>button text<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"response_id"</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packing</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"position"</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packing</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">child</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">child</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GtkCheckButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbutton1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"visible"</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"can_focus"</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"label"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">translatable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span>checkbutton text<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"response_id"</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"draw_indicator"</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packing</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"position"</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packing</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">child</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">child</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">widget</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">glade-interface</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  You will also need a program on python (since I'm writing about it), which shows this form: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python # -*- coding: utf-8 -*- import pygtk, gtk, gtk.glade print "hello to me" wTree = gtk.glade.XML("localize.glade", "window1") window = wTree.get_widget("window1") window.connect("delete_event", gtk.main_quit) window.show_all() gtk.main()</span></span></code> </pre><br>  At the same time, it will output a string to the console to show that the language is also changing in the console. <br><br>  You can localize in different ways.  For example, write the code for processing each line / widget and update the lines depending on a control command.  This is a tiny plus - all actions can be performed at any time of the program, but the rest - minuses.  And it will look and work terribly. <br><br>  A question arises: how not to reinvent the wheel with square wheels?  It turned out that everything is already there, you just need to be able to use it (as in most cases). <br><br>  First you need to reset the locale settings to default for the user (usually defined in the LANG environment variable).  This will help get rid of possible problems in a multi-thread program.  For such an action you will need to connect the <a href="http://docs.python.org/2/library/locale.html">locale</a> module. <br><br><pre> <code class="python hljs"> locale.setlocale(locale.LC_ALL, <span class="hljs-string"><span class="hljs-string">''</span></span>)</code> </pre><br>  Next, we will use the features of the <a href="http://docs.python.org/2/library/gettext.html">gettext</a> module (because it will also have to be connected).  Looking at his documentation, you will notice that he needs some ‚Äúbinary .mo files‚Äù. <br><br>  .mo files are files with a list of all translatable strings of the program. <br><br>  How to get them: <br><br>  First you need to tear out all the lines from the glade form (the inscriptions on the widgets), but you should not do this manually, of course.  To do this, use the intltool command set: <br><br><pre> <code class="bash hljs"> intltool-extract --<span class="hljs-built_in"><span class="hljs-built_in">type</span></span>=gettext/glade localize.glade</code> </pre><br>  if desired, additional parameters can be viewed in man  ªe.  The last input parameter is the glade file of the form, from where you need to tear out the text.  This command will create a localize.glade.h file: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *s = N_(<span class="hljs-string"><span class="hljs-string">"label text"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *s = N_(<span class="hljs-string"><span class="hljs-string">"button text"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *s = N_(<span class="hljs-string"><span class="hljs-string">"checkbutton text"</span></span>);</code> </pre><br>  where, as you can see, all text strings from form widgets are listed. <br><br>  We remember that in the Python file there is also a string that I would like to translate.  You do not need to tear it out, you just need to mark it so that the localization teams understand that it needs to be translated.  Therefore, the documentation suggests to write a string in the form: <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> _(<span class="hljs-string"><span class="hljs-string">"hello to me"</span></span>)</code> </pre><br>  those.  take in _ () <br><br>  As you can see above, in localize.glade.h, the lines are wrapped in N_ ().  It is also a kind of marker. <br><br>  So, all the necessary text is marked and now it must be collected in one place.  The team will help us with this: <br><br><pre> <code class="bash hljs"> xgettext --language=Python --keyword=_ --keyword=N_ --output=show_form.pot show_form.py localize.glade.h</code> </pre><br>  The option --keyword shows the program which labels to pay attention to when collecting, because there are two ‚Äú_‚Äù and ‚ÄúN_‚Äù here.  --output sets the name of the output file, and then comes a list of all the files where you need to look for tags (it can be concluded that the tags may be different, but I didn‚Äôt bother with them, because this is not particularly important). <br><br><div class="spoiler">  <b class="spoiler_title">The result is a file of the following content:</b> <div class="spoiler_text">  # SOME DESCRIPTIVE TITLE. <br>  # Copyright YEAR THE PACKAGE'S COPYRIGHT HOLDER <br>  # This file is distributed under the PACKAGE package. <br>  # FIRST AUTHOR &lt;EMAIL @ ADDRESS&gt;, YEAR. <br>  # <br>  # fuzzy <br>  msgid "" <br>  msgstr "" <br>  "Project-Id-Version: PACKAGE VERSION \ n" <br>  "Report-Msgid-Bugs-To: \ n" <br>  "POT-Creation-Date: 2012-11-14 13: 54 + 0300 \ n" <br>  "PO-Revision-Date: YEAR-MO-DA HO: MI + ZONE \ n" <br>  ‚ÄúLast Translator: FULL NAME &lt;EMAIL @ ADDRESS&gt; \ n‚Äù <br>  "Language-Team: LANGUAGE &lt;LL@li.org&gt; \ n" <br>  "Language: \ n" <br>  "MIME-Version: 1.0 \ n" <br>  ‚ÄúContent-Type: text / plain;  charset = CHARSET \ n " <br>  "Content-Transfer-Encoding: 8bit \ n" <br><br>  #: show_form.py:14 <br>  msgid "hello to me" <br>  msgstr "" <br><br>  #: localize.glade.h: 1 <br>  msgid "label text" <br>  msgstr "" <br><br>  #: localize.glade.h: 2 <br>  msgid "button text" <br>  msgstr "" <br><br>  #: localize.glade.h: 3 <br>  msgid "checkbutton text" <br>  msgstr "" <br></div></div><br>  This is a template for all future files with translations.  You do not need to edit it.  Now it's time to decide on languages.  I used English (en_US), Russian (ru) and German (de_DE) (in fact, from German I only know ‚ÄúHitler Kaput‚Äù and ‚ÄúHandehoh‚Äù and not in writing, but let it be to the heap).  For each of the languages ‚Äã‚Äãyou need to create a localized file from the template.  This is done by the commands: <br><br><pre> <code class="bash hljs"> msginit --locale=ru --input=show_form.pot msginit --locale=en_US --input=show_form.pot msginit --locale=de_DE --input=show_form.pot</code> </pre><br>  As a result, three files ru.po, de.po and en_US.po appear.  Inside, they are almost as empty as the template, but the header is full, though not with the exact data that I would like (maybe I didn‚Äôt indicate something in the keys) and without translating strings into other languages ‚Äã‚Äã(naturally).  Translation will have to be hammered into msgstr fields.  I also adjusted the charset to utf-8, the character size to 16 bits and e-mail. <br><br>  The result was: <br><div class="spoiler">  <b class="spoiler_title">ru.po</b> <div class="spoiler_text">  # Russian translations for PACKAGE package. <br>  # Copyright 2012 THE PACKAGE'S COPYRIGHT HOLDER <br>  # This file is distributed under the PACKAGE package. <br>  # &lt;aaa @ bbb&gt;, 2012. <br>  # <br>  msgid "" <br>  msgstr "" <br>  "Project-Id-Version: PACKAGE VERSION \ n" <br>  "Report-Msgid-Bugs-To: \ n" <br>  "POT-Creation-Date: 2012-11-14 13: 54 + 0300 \ n" <br>  "PO-Revision-Date: 2012-11-14 13: 58 + 0300 \ n" <br>  "Last Translator: &lt;aaa @ bbb&gt; \ n" <br>  "Language-Team: Russian \ n" <br>  "Language: ru \ n" <br>  "MIME-Version: 1.0 \ n" <br>  ‚ÄúContent-Type: text / plain;  charset = utf-8 \ n " <br>  "Content-Transfer-Encoding: 16bit \ n" <br>  "Plural-Forms: nplurals = 3;  plural = (n% 10 == 1 &amp;&amp; n% 100! = 11? 0: n% 10&gt; = 2 &amp;&amp; n " <br>  "% 10 &lt;= 4 &amp;&amp; (n% 100 &lt;10 || n% 100&gt; = 20)? 1: 2); \ n" <br><br>  #: show_form.py:14 <br>  msgid "hello to me" <br>  msgstr "hello to me" <br><br>  #: localize.glade.h: 1 <br>  msgid "label text" <br>  "tag" <br><br>  #: localize.glade.h: 2 <br>  msgid "button text" <br>  "button" <br><br>  #: localize.glade.h: 3 <br>  msgid "checkbutton text" <br>  "checkmark" <br></div></div><br><div class="spoiler">  <b class="spoiler_title">de.po</b> <div class="spoiler_text">  (Yes, there is not German, but in general it does not matter): <br>  # German translations for PACKAGE package. <br>  # Copyright 2012 THE PACKAGE'S COPYRIGHT HOLDER <br>  # This file is distributed under the PACKAGE package. <br>  # &lt;aaa @ bbb&gt;, 2012. <br>  # <br>  msgid "" <br>  msgstr "" <br>  "Project-Id-Version: PACKAGE VERSION \ n" <br>  "Report-Msgid-Bugs-To: \ n" <br>  "POT-Creation-Date: 2012-11-14 13: 54 + 0300 \ n" <br>  "PO-Revision-Date: 2012-11-14 14: 14 + 0300 \ n" <br>  "Last Translator: &lt;aaa @ bbb&gt; \ n" <br>  Language-Team: German \ n <br>  "Language: de \ n" <br>  "MIME-Version: 1.0 \ n" <br>  ‚ÄúContent-Type: text / plain;  charset = utf-8 \ n " <br>  "Content-Transfer-Encoding: 16bit \ n" <br>  "Plural-Forms: nplurals = 2;  plural = (n! = 1); \ n " <br><br>  #: show_form.py:14 <br>  msgid "hello to me" <br>  msgstr "f" <br><br>  #: localize.glade.h: 1 <br>  msgid "label text" <br>  msgstr "d" <br><br>  #: localize.glade.h: 2 <br>  msgid "button text" <br>  msgstr "g" <br><br>  #: localize.glade.h: 3 <br>  msgid "checkbutton text" <br>  msgstr "e" <br></div></div><br><div class="spoiler">  <b class="spoiler_title">en_US.po</b> <div class="spoiler_text">  # English translations for PACKAGE package. <br>  # Copyright 2012 THE PACKAGE'S COPYRIGHT HOLDER <br>  # This file is distributed under the PACKAGE package. <br>  # &lt;aaa @ bbb&gt;, 2012. <br>  # <br>  msgid "" <br>  msgstr "" <br>  "Project-Id-Version: PACKAGE VERSION \ n" <br>  "Report-Msgid-Bugs-To: \ n" <br>  "POT-Creation-Date: 2012-11-14 13: 54 + 0300 \ n" <br>  "PO-Revision-Date: 2012-11-14 13: 58 + 0300 \ n" <br>  "Last Translator: &lt;aaa @ bbb&gt; \ n" <br>  Language-Team: English \ n <br>  "Language: en_US \ n" <br>  "MIME-Version: 1.0 \ n" <br>  ‚ÄúContent-Type: text / plain;  charset = utf-8 \ n " <br>  "Content-Transfer-Encoding: 16bit \ n" <br>  "Plural-Forms: nplurals = 2;  plural = (n! = 1); \ n " <br><br>  #: show_form.py:14 <br>  msgid "hello to me" <br>  msgstr "hello to me" <br><br>  #: localize.glade.h: 1 <br>  msgid "label text" <br>  msgstr "label text" <br><br>  #: localize.glade.h: 2 <br>  msgid "button text" <br>  msgstr "button text" <br><br>  #: localize.glade.h: 3 <br>  msgid "checkbutton text" <br>  msgstr "checkbutton text" <br></div></div><br>  It would seem - why make the native version (I have en_US by default).  But after all, another native person may have, for example, de_DE, and he wants to see a translation into English.  Yes, and gettext developers recommend creating yet. <br><br>  Some programmers also suggest using the intltool-merge command to make changes back to the form, but since  at the same time I created exactly the same form without any changes, I do not see any need for it. <br><br>  So, there is everything to create .mo files.  This is done by the commands: <br><br><pre> <code class="bash hljs"> msgfmt ru.po -o locale/ru/LC_MESSAGES/show_form.mo msgfmt en_US.po -o locale/en_US/LC_MESSAGES/show_form.mo msgfmt de.po -o locale/de/LC_MESSAGES/show_form.mo</code> </pre><br>  The option -o (quite obvious) indicates the directory in which the finished file will lie, and it is worth noting that the top directory (here ‚Äúlocale‚Äù) should be the same for all .mo files, and then there should be a directory with the locale name (ru, de, en_US, de_DE, ru_RU - since the last two are without dialects, the programs shorten them to the first letters, but you can use the full names).  It should be called as well as the domain specified in the Python program, only with ".mo".  Also LC_MESSAGES is one of several possible variants of the name of the internal directory (I also think it is better to use the same names). <br>  Here is what the official documentation says about this: <br><br><blockquote>  ... <br>  localedir / language / LC_MESSAGES / domain.mo, where LANGU, LC_ALL, LC_MESSAGES, and LANG respectively. <br></blockquote><br>  The result was a file with the translation of strings that can already be used in the program (such manipulations are made not only for python / glade). <br><br>  Let's go back to the python program. <br><br>  First set up gettext.  After resetting locale settings, you need to tell him where to get the translation files and which files exactly.  To do this, I have entered two variables: <br><br><pre> <code class="python hljs"> APP=<span class="hljs-string"><span class="hljs-string">"show_form"</span></span> DIR=<span class="hljs-string"><span class="hljs-string">"locale"</span></span></code> </pre><br>  The fact that the APP matches the name of the program is left over from the documentation, but I think there can be any name.  Although if you look at .mo files with the name of the program to which they belong, it is much easier to understand what's what. <br><br>  APP is the name of the .mo file, DIR is the common directory with languages.  The explanation of this fact gettext is produced by strings: <br><br><pre> <code class="python hljs"> gettext.bindtextdomain(APP, DIR) gettext.textdomain(APP)</code> </pre><br>  Now we need to explain to the python what to do with strings of the form _ ().  To do this, "_" is assigned the function of taking a transfer from the specified file.  This can be recorded in two ways: <br><br><pre> <code class="python hljs"> lang = gettext.translation(APP, DIR) _ = lang.gettext</code> </pre><br>  or <br><br><pre> <code class="python hljs"> _ = gettext.gettext</code> </pre><br>  that, if you look at the module code, the same thing.  So it makes sense to choose a shorter recording. <br><br>  This is enough to display text in .py files in the desired language.  And to localize the glade form, you need to explain gtk, where to get the translation and which one: <br><br><pre> <code class="python hljs"> gtk.glade.bindtextdomain(APP, DIR) wTree = gtk.glade.XML(<span class="hljs-string"><span class="hljs-string">"localize.glade"</span></span>, <span class="hljs-string"><span class="hljs-string">"window1"</span></span>, APP)</code> </pre><br>  Summary Code: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python # -*- coding: utf-8 -*- import pygtk, gtk, gtk.glade import locale, gettext APP="show_form" DIR="locale" locale.setlocale(locale.LC_ALL, '') gettext.bindtextdomain(APP, DIR) gettext.textdomain(APP) _ = gettext.gettext print _("hello to me") gtk.glade.bindtextdomain(APP, DIR) wTree = gtk.glade.XML("localize.glade", "window1", APP) window = wTree.get_widget("window1") window.connect("delete_event", gtk.main_quit) window.show_all() gtk.main()</span></span></code> </pre><br>  Run: <br><br><pre> <code class="bash hljs">LANG=en_US.utf-8 ./show_form.py</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/620/c7c/753/620c7c753985563346d7bc36f3177d68.png" alt="image"><br><br><pre> <code class="bash hljs">LANG=ru_RU.utf-8 ./show_form.py</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/ff6/370/99b/ff637099b85eefa3efde252fe7a3e151.png" alt="image"><br><br><pre> <code class="bash hljs">LANG=de_DE.utf-8 ./show_form.py</code> </pre><br>  And then honestly crashes, because  My German locale is not connected.  Thus, to use a locale, you need to add it in the settings of the graphical shell. <br><br>  That's all. <br><br>  <b>Upd</b> : <br><br>  Pro Builder.  If the form for libglade is already there, then you can either try to convert using libglade-convert (I got an error) or draw a new one for the builder. <br><br>  The code will look like this: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python # -*- coding: utf-8 -*- import gtk, gtk.glade import locale, gettext APP="show_form" DIR="locale" locale.setlocale(locale.LC_ALL, '') gettext.bindtextdomain(APP, DIR) gettext.textdomain(APP) _ = gettext.gettext print _("hello to me") builder = gtk.Builder() gtk.glade.bindtextdomain(APP, DIR) builder.set_translation_domain(APP) builder.add_from_file("localize.xml") window = builder.get_object("window1") window.connect("delete_event", gtk.main_quit) window.show_all() gtk.main()</span></span></code> </pre><br><br>  And, as Moonrise correctly noted, Content-Transfer-Encoding is officially recommended to be set to 8 bits (ie, not to change). </div><p>Source: <a href="https://habr.com/ru/post/159629/">https://habr.com/ru/post/159629/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../159619/index.html">Mobile payments market overview</a></li>
<li><a href="../159621/index.html">Collectible Card Games: The Secret to Success on Mobile Platforms</a></li>
<li><a href="../159623/index.html">USB-IRPC: Socket Module Upgrade</a></li>
<li><a href="../159625/index.html">Samsung Chromebook performance tests for Ubuntu 13.04</a></li>
<li><a href="../159627/index.html">Elite Dangerous - Kickstarter revives another veteran</a></li>
<li><a href="../159631/index.html">Website for the programmer [on Node.js]. Simply. Stylish. Is free</a></li>
<li><a href="../159633/index.html">Officially introduced to SailFish OS</a></li>
<li><a href="../159637/index.html">Runetology (174): Alexander Kazakov, founder of Navitel</a></li>
<li><a href="../159639/index.html">Tracks Flow is open</a></li>
<li><a href="../159643/index.html">"Sound in my ears," or five computer headsets: review and comparison</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>