<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We prohibit the use of known UserJS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 UserJS provides users with a convenient and simple mechanism for modifying web pages, precisely because of this, many users automate th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We prohibit the use of known UserJS</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  UserJS provides users with a convenient and simple mechanism for modifying web pages, precisely because of this, many users automate their actions using UserJS, and sometimes bypass weak security systems. <br>  Browser-based online games suffer the most from UserJS users, many of whom have already launched a war against UserJS.  For example, in the Travian game, fake hidden web forms are used, which sometimes appear along with the usual ones, UserJS scripts written without taking this feature into account are mistaken and send data through the fake form, for which the player immediately receives punishment. <br>  I would like to immediately note that you can only fight with well-known UserJS scripts, the solution shown is not universal and cannot protect against any script. <br>  Today, I am submitting to your court my own method of dealing with user scripts - MD5 hashing followed by comparison.  The main acting roles are played by JavaScript and PHP. <br><a name="habracut"></a><br><h4>  Legend </h4><br>  Suppose we have a website with a simple authorization form, but users have got into the habit of not entering their login, but using the UserJS script, which adds an additional button to the form, clicking on which automatically enters their login.  This example was taken just for clarity, on-site authorization form may be, for example, the form of sending troops in an online strategy, and UserJS-script - bot, automatically sending troops. <br><br><h4>  Initial data </h4><br>  So, our form looks like this: <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/86/4b/864bf53609e37bab2327f14c46351024.jpg"></a> <br><br>  Users use the following UserJS in Opera browser: <br> <code><a href="http://s-c.me/9676/s"></a> <a href="http://s-c.me/9676/h"></a> <font color="black">Copy Source | Copy HTML window.opera.addEventListener( <font color="#A31515">'AfterEvent.load'</font> , <font color="#0000ff">function</font> (e){ <font color="#0000ff">if</font> (e. <font color="#0000ff">event</font> .target instanceof Document){ e.preventDefault(); document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ; } }, <font color="#0000ff">false</font> );</font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/9676/s"></a> <a href="http://s-c.me/9676/h"></a> Copy Source | Copy HTML window.opera.addEventListener( <font color="#A31515">'AfterEvent.load'</font> , <font color="#0000ff">function</font> (e){ <font color="#0000ff">if</font> (e. <font color="#0000ff">event</font> .target instanceof Document){ e.preventDefault(); document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ; } }, <font color="#0000ff">false</font> );</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9676/s"></a> <a href="http://s-c.me/9676/h"></a> Copy Source | Copy HTML window.opera.addEventListener( <font color="#A31515">'AfterEvent.load'</font> , <font color="#0000ff">function</font> (e){ <font color="#0000ff">if</font> (e. <font color="#0000ff">event</font> .target instanceof Document){ e.preventDefault(); document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ; } }, <font color="#0000ff">false</font> );</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9676/s"></a> <a href="http://s-c.me/9676/h"></a> Copy Source | Copy HTML window.opera.addEventListener( <font color="#A31515">'AfterEvent.load'</font> , <font color="#0000ff">function</font> (e){ <font color="#0000ff">if</font> (e. <font color="#0000ff">event</font> .target instanceof Document){ e.preventDefault(); document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ; } }, <font color="#0000ff">false</font> );</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9676/s"></a> <a href="http://s-c.me/9676/h"></a> Copy Source | Copy HTML window.opera.addEventListener( <font color="#A31515">'AfterEvent.load'</font> , <font color="#0000ff">function</font> (e){ <font color="#0000ff">if</font> (e. <font color="#0000ff">event</font> .target instanceof Document){ e.preventDefault(); document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ; } }, <font color="#0000ff">false</font> );</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9676/s"></a> <a href="http://s-c.me/9676/h"></a> Copy Source | Copy HTML window.opera.addEventListener( <font color="#A31515">'AfterEvent.load'</font> , <font color="#0000ff">function</font> (e){ <font color="#0000ff">if</font> (e. <font color="#0000ff">event</font> .target instanceof Document){ e.preventDefault(); document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ; } }, <font color="#0000ff">false</font> );</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9676/s"></a> <a href="http://s-c.me/9676/h"></a> Copy Source | Copy HTML window.opera.addEventListener( <font color="#A31515">'AfterEvent.load'</font> , <font color="#0000ff">function</font> (e){ <font color="#0000ff">if</font> (e. <font color="#0000ff">event</font> .target instanceof Document){ e.preventDefault(); document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ; } }, <font color="#0000ff">false</font> );</font></code> </li> </ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Or in FireFox for the GreaceMonkey extension: <br> <code><a href="http://s-c.me/9677/s"></a> <a href="http://s-c.me/9677/h"></a> <font color="black">Copy Source | Copy HTML <font color="#008000">// ==UserScript==</font> <font color="#008000">// @name           test1</font> <font color="#008000">// @namespace      test</font> <font color="#008000">// @include        http://localhost/anti-userjs/test1.php</font> <font color="#008000">// ==/UserScript==</font> document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ;</font></code> <ol> <li> <code><font color="black"><font color="#008000"><a href="http://s-c.me/9677/s"></a> <a href="http://s-c.me/9677/h"></a> Copy Source | Copy HTML // ==UserScript== <font color="#008000">// @name           test1</font> <font color="#008000">// @namespace      test</font> <font color="#008000">// @include        http://localhost/anti-userjs/test1.php</font> <font color="#008000">// ==/UserScript==</font> document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ;</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://s-c.me/9677/s"></a> <a href="http://s-c.me/9677/h"></a> Copy Source | Copy HTML <font color="#008000">// ==UserScript==</font> // @name           test1 <font color="#008000">// @namespace      test</font> <font color="#008000">// @include        http://localhost/anti-userjs/test1.php</font> <font color="#008000">// ==/UserScript==</font> document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ;</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://s-c.me/9677/s"></a> <a href="http://s-c.me/9677/h"></a> Copy Source | Copy HTML <font color="#008000">// ==UserScript==</font> <font color="#008000">// @name           test1</font> // @namespace      test <font color="#008000">// @include        http://localhost/anti-userjs/test1.php</font> <font color="#008000">// ==/UserScript==</font> document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ;</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://s-c.me/9677/s"></a> <a href="http://s-c.me/9677/h"></a> Copy Source | Copy HTML <font color="#008000">// ==UserScript==</font> <font color="#008000">// @name           test1</font> <font color="#008000">// @namespace      test</font> // @include        http://localhost/anti-userjs/test1.php <font color="#008000">// ==/UserScript==</font> document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ;</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://s-c.me/9677/s"></a> <a href="http://s-c.me/9677/h"></a> Copy Source | Copy HTML <font color="#008000">// ==UserScript==</font> <font color="#008000">// @name           test1</font> <font color="#008000">// @namespace      test</font> <font color="#008000">// @include        http://localhost/anti-userjs/test1.php</font> // ==/UserScript== document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ;</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://s-c.me/9677/s"></a> <a href="http://s-c.me/9677/h"></a> Copy Source | Copy HTML <font color="#008000">// ==UserScript==</font> <font color="#008000">// @name           test1</font> <font color="#008000">// @namespace      test</font> <font color="#008000">// @include        http://localhost/anti-userjs/test1.php</font> <font color="#008000">// ==/UserScript==</font> document.forms[ <font color="#A31515">0</font> ].innerHTML+= <font color="#A31515">'&lt;input type="button" onclick="document.forms[0].login.value=\'Login\';" value="AutoLogin"&gt;'</font> ;</font></code> </li> </ol><br><br>  After enabling this script, users receive this type of authorization form: <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/69/2c/692ccbf500dfaba75cce8892b7d39613.jpg"></a> <br><br>  Clicking on the ‚ÄúAutoLogin‚Äù button, as seen from the source code, results in filling in the ‚Äúlogin‚Äù field. <br>  Let's try to prohibit the user to use this script. <br><br><h4>  Displays authorization form </h4><br>  We will display the authorization form from a PHP file, frame it with a div tag, and also cache all the data inside this tag using PHP.  Hash will be saved in the session for follow-up: <br> <code><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> <font color="black">Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><font color="#cc6633"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; &lt;? ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><font color="#cc6633"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); ?&gt; &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><font color="#cc6633"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; &lt;? <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9679/s"></a> <a href="http://s-c.me/9679/h"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.ob-get-contents.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-flush.php"></a> <a href="http://www.php.net/manual/en/function.strtr.php"></a> <a href="http://www.php.net/manual/en/function.preg-replace.php"></a> <a href="http://www.php.net/manual/en/function.md5.php"></a> Copy Source | Copy HTML &lt;div id= <font color="#008000">"main"</font> &gt; <font color="#cc6633">&lt;?</font> ob_start(); <font color="#cc6633">?&gt;</font> &lt;form method= <font color="#008000">"POST"</font> &gt; : &lt;input name= <font color="#008000">"login"</font> type= <font color="#008000">"text"</font> &gt;&lt;br&gt; : &lt;input name= <font color="#008000">"password"</font> type= <font color="#008000">"password"</font> &gt;&lt;br&gt; &lt;input name= <font color="#008000">"md5"</font> type= <font color="#008000">"hidden"</font> &gt;&lt;br&gt; &lt;input value= <font color="#008000">""</font> type= <font color="#008000">"submit"</font> &gt; &lt;/form&gt; <font color="#cc6633">&lt;?</font> <font color="#cc6633">$data</font> =ob_get_contents(); ob_end_flush(); <font color="#cc6633">$data</font> =strtr( <font color="#cc6633">$data</font> , <font color="#008000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#008000">'abcdefghijklmnopqrstuvwxyz'</font> ); <font color="#cc6633">$data</font> =preg_replace( <font color="#008000">"/[ \t\n\r]/"</font> , <font color="#008000">''</font> , <font color="#cc6633">$data</font> ); <font color="#cc6633">$md5</font> =md5( <font color="#cc6633">$data</font> ); <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]= <font color="#cc6633">$md5</font> ; <font color="#cc6633">?&gt;</font> &lt;/div&gt;</font></code> </li> </ol><br><br>  A couple of words about the processing of content - Opera and FireFox browsers in their own way are izglyayutsya over HTML-code, so processing it through JavaScript leads to different results.  So, Opera brings all HTML tags to uppercase letters, and FireFox changes parameters in tags according to the standard.  Therefore, it is important to write valid HTML-controlled code. <br>  To eliminate various processing of the register of tags and the transfer of lines, all spaces, tabs and line breaks are removed from the contents, as well as all English letters are given in lower case. <br>  Another important note is that the document encoding must be UTF-8, with CP1251 JavaScript in browsers and PHP I work differently. <br><br><h4>  JavaScript control </h4><br>  So, the form is displayed, its checksum is counted, now you need to calculate it from the user‚Äôs side and make sure that UserJS didn‚Äôt intervene.  To do this, we add an event to onLoad and call the JS function: <br> <code><a href="http://s-c.me/9680/s"></a> <a href="http://s-c.me/9680/h"></a> <font color="black">Copy Source | Copy HTML &gt; <font color="#0000ff">function</font> checkuserjs(){ <font color="#0000ff">var</font> data=document.getElementsByTagName( <font color="#A31515">'div'</font> )[ <font color="#A31515">0</font> ].innerHTML; data=strtr(data, <font color="#A31515">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#A31515">'abcdefghijklmnopqrstuvwxyz'</font> ); data=data.replace(/[ \t\n\r]/g, <font color="#A31515">''</font> ); document.forms[ <font color="#A31515">0</font> ].md5.value=md5(data); } <br> <br></font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/9680/s"></a> <a href="http://s-c.me/9680/h"></a> Copy Source | Copy HTML &gt; <font color="#0000ff">function</font> checkuserjs(){ <font color="#0000ff">var</font> data=document.getElementsByTagName( <font color="#A31515">'div'</font> )[ <font color="#A31515">0</font> ].innerHTML; data=strtr(data, <font color="#A31515">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#A31515">'abcdefghijklmnopqrstuvwxyz'</font> ); data=data.replace(/[ \t\n\r]/g, <font color="#A31515">''</font> ); document.forms[ <font color="#A31515">0</font> ].md5.value=md5(data); } <br> <br></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9680/s"></a> <a href="http://s-c.me/9680/h"></a> Copy Source | Copy HTML &gt; <font color="#0000ff">function</font> checkuserjs(){ <font color="#0000ff">var</font> data=document.getElementsByTagName( <font color="#A31515">'div'</font> )[ <font color="#A31515">0</font> ].innerHTML; data=strtr(data, <font color="#A31515">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#A31515">'abcdefghijklmnopqrstuvwxyz'</font> ); data=data.replace(/[ \t\n\r]/g, <font color="#A31515">''</font> ); document.forms[ <font color="#A31515">0</font> ].md5.value=md5(data); } <br> <br></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9680/s"></a> <a href="http://s-c.me/9680/h"></a> Copy Source | Copy HTML &gt; <font color="#0000ff">function</font> checkuserjs(){ <font color="#0000ff">var</font> data=document.getElementsByTagName( <font color="#A31515">'div'</font> )[ <font color="#A31515">0</font> ].innerHTML; data=strtr(data, <font color="#A31515">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#A31515">'abcdefghijklmnopqrstuvwxyz'</font> ); data=data.replace(/[ \t\n\r]/g, <font color="#A31515">''</font> ); document.forms[ <font color="#A31515">0</font> ].md5.value=md5(data); } <br> <br></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9680/s"></a> <a href="http://s-c.me/9680/h"></a> Copy Source | Copy HTML &gt; <font color="#0000ff">function</font> checkuserjs(){ <font color="#0000ff">var</font> data=document.getElementsByTagName( <font color="#A31515">'div'</font> )[ <font color="#A31515">0</font> ].innerHTML; data=strtr(data, <font color="#A31515">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#A31515">'abcdefghijklmnopqrstuvwxyz'</font> ); data=data.replace(/[ \t\n\r]/g, <font color="#A31515">''</font> ); document.forms[ <font color="#A31515">0</font> ].md5.value=md5(data); } <br> <br></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9680/s"></a> <a href="http://s-c.me/9680/h"></a> Copy Source | Copy HTML &gt; <font color="#0000ff">function</font> checkuserjs(){ <font color="#0000ff">var</font> data=document.getElementsByTagName( <font color="#A31515">'div'</font> )[ <font color="#A31515">0</font> ].innerHTML; data=strtr(data, <font color="#A31515">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#A31515">'abcdefghijklmnopqrstuvwxyz'</font> ); data=data.replace(/[ \t\n\r]/g, <font color="#A31515">''</font> ); document.forms[ <font color="#A31515">0</font> ].md5.value=md5(data); } <br> <br></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9680/s"></a> <a href="http://s-c.me/9680/h"></a> Copy Source | Copy HTML &gt; <font color="#0000ff">function</font> checkuserjs(){ <font color="#0000ff">var</font> data=document.getElementsByTagName( <font color="#A31515">'div'</font> )[ <font color="#A31515">0</font> ].innerHTML; data=strtr(data, <font color="#A31515">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#A31515">'abcdefghijklmnopqrstuvwxyz'</font> ); data=data.replace(/[ \t\n\r]/g, <font color="#A31515">''</font> ); document.forms[ <font color="#A31515">0</font> ].md5.value=md5(data); } <br> <br></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9680/s"></a> <a href="http://s-c.me/9680/h"></a> Copy Source | Copy HTML &gt; <font color="#0000ff">function</font> checkuserjs(){ <font color="#0000ff">var</font> data=document.getElementsByTagName( <font color="#A31515">'div'</font> )[ <font color="#A31515">0</font> ].innerHTML; data=strtr(data, <font color="#A31515">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#A31515">'abcdefghijklmnopqrstuvwxyz'</font> ); data=data.replace(/[ \t\n\r]/g, <font color="#A31515">''</font> ); document.forms[ <font color="#A31515">0</font> ].md5.value=md5(data); } <br> <br></font></code> </li> </ol> <code><font color="black"><a href="http://s-c.me/9680/s"></a> <a href="http://s-c.me/9680/h"></a> Copy Source | Copy HTML &gt; <font color="#0000ff">function</font> checkuserjs(){ <font color="#0000ff">var</font> data=document.getElementsByTagName( <font color="#A31515">'div'</font> )[ <font color="#A31515">0</font> ].innerHTML; data=strtr(data, <font color="#A31515">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font> , <font color="#A31515">'abcdefghijklmnopqrstuvwxyz'</font> ); data=data.replace(/[ \t\n\r]/g, <font color="#A31515">''</font> ); document.forms[ <font color="#A31515">0</font> ].md5.value=md5(data); } <br> <br></font></code> <br><br>  In it, I used several ready-made functions - md5 and strtr, I will not post them in the article, you can find them in the attached file. <br>  On the user side, Java Script performs the same actions as the PHP script above, the result ‚Äî the content hash ‚Äî is entered into the form. <br><br><h4>  Server side processing </h4><br>  The case remains for small - check the data: <br> <code><a href="http://s-c.me/9681/s"></a> <a href="http://s-c.me/9681/h"></a> <font color="black">Copy Source | Copy HTML <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> ){ <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> [ <font color="#008000">'md5'</font> ]!= <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]) <font color="#0000ff">die</font> ( <font color="#008000">' UserJS !'</font> ); <font color="#0000ff">echo</font> <font color="#008000">' '</font> ; }</font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/9681/s"></a> <a href="http://s-c.me/9681/h"></a> Copy Source | Copy HTML <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> ){ <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> [ <font color="#008000">'md5'</font> ]!= <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]) <font color="#0000ff">die</font> ( <font color="#008000">' UserJS !'</font> ); <font color="#0000ff">echo</font> <font color="#008000">' '</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9681/s"></a> <a href="http://s-c.me/9681/h"></a> Copy Source | Copy HTML <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> ){ <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> [ <font color="#008000">'md5'</font> ]!= <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]) <font color="#0000ff">die</font> ( <font color="#008000">' UserJS !'</font> ); <font color="#0000ff">echo</font> <font color="#008000">' '</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9681/s"></a> <a href="http://s-c.me/9681/h"></a> Copy Source | Copy HTML <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> ){ <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> [ <font color="#008000">'md5'</font> ]!= <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]) <font color="#0000ff">die</font> ( <font color="#008000">' UserJS !'</font> ); <font color="#0000ff">echo</font> <font color="#008000">' '</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9681/s"></a> <a href="http://s-c.me/9681/h"></a> Copy Source | Copy HTML <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> ){ <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> [ <font color="#008000">'md5'</font> ]!= <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]) <font color="#0000ff">die</font> ( <font color="#008000">' UserJS !'</font> ); <font color="#0000ff">echo</font> <font color="#008000">' '</font> ; }</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/9681/s"></a> <a href="http://s-c.me/9681/h"></a> Copy Source | Copy HTML <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> ){ <font color="#0000ff">if</font> ( <font color="#cc6633">$_POST</font> [ <font color="#008000">'md5'</font> ]!= <font color="#cc6633">$_SESSION</font> [ <font color="#008000">'md5'</font> ]) <font color="#0000ff">die</font> ( <font color="#008000">' UserJS !'</font> ); <font color="#0000ff">echo</font> <font color="#008000">' '</font> ; }</font></code> </li> </ol><br><br>  Thus, we catch unscrupulous users (note the GreaseMonkey indicator): <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/5b/20/5b203efe09bbee65af3099d27c53e1f7.jpg"></a> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/92/4a/924a00781edf0df42ad52a58a8f302ae.jpg"></a> <br><br><h4>  Conclusion </h4><br>  The example I mentioned demonstrates the very approach to prohibiting the use of UserJS, when developing solutions based on it, you need to understand the main point - it is not possible to prohibit the use of any UserJS, therefore you need to monitor the laid out scripts that affect our sites and develop protection against them.  Since such scripts are being made with enthusiasm, there is a great chance that a new version of the script, bypassing our protection, if it comes out, will not be soon.  The same Travian demonstrates this - the simplest protection with fake forms was introduced half a year ago, there is still no new version of UserJS scripts. <br><br>  <b>Application:</b> <a href=""><img src="https://habrastorage.org/storage/habraeffect/88/1f/881f12d2bcebb09c550cb751669152e9.png"></a>  <a href="">anti-userjs.tar.gz</a> 3708 bytes </div><p>Source: <a href="https://habr.com/ru/post/107396/">https://habr.com/ru/post/107396/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../107389/index.html">The difference in the approaches of code analysis by the compiler and the selected tool</a></li>
<li><a href="../107390/index.html">Democamp 2010 Report</a></li>
<li><a href="../107393/index.html">1-bit symphony of Tristan Peric</a></li>
<li><a href="../107394/index.html">Social networks in business. Employee Conduct Policies</a></li>
<li><a href="../107395/index.html">In two months, Twitter has 30 million more users.</a></li>
<li><a href="../107397/index.html">WeVi.ru - Web Videos</a></li>
<li><a href="../107398/index.html">Accounting for personal finances: fun and useful!</a></li>
<li><a href="../107400/index.html">Donetsk coffee-and-code - digest and announcement</a></li>
<li><a href="../107401/index.html">Answers to questions about Unity on desktops</a></li>
<li><a href="../107403/index.html">Creating GTK + Applications Using the Glade Environment</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>