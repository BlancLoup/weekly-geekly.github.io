<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We hand over positions?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the last half of the year, I have a dual impression of using MySQL. I do not want to evaluate the work done by Oracle, as a management company, but...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We hand over positions?</h1><div class="post__text post__text-html js-mediator-article">  In the last half of the year, I have a dual impression of using MySQL.  I do not want to evaluate the work done by Oracle, as a management company, but I really want to comment on the fact that already 5 releases cannot wait for a stable version of MySQL, which will allow to work normally. <br><a name="habracut"></a><br>  <b>5.5.19</b> <br>  The long-awaited release came out in which they fixed the bug <a href="http://bugs.mysql.com/bug.php%3Fid%3D56299">bugs.mysql.com/bug.php?id=56299</a> , thanks to which every switch of logs on our database had to be monitored, in view of a possible freeze of a sale due to replication <a href="http://bugs.mysql.com/bug.php%3Fid%3D61186">bugs.mysql.com/bug.php ? id = 61186</a> . <br>  While we were testing the release, we realized that when using MySQL partitions it shamelessly flows.  The developers claim that it is not it flowing, but the memory is fragmented <a href="http://blogs.innodb.com/wp/2011/12/improving-innodb-memory-usage-continued">blogs.innodb.com/wp/2011/12/improving-innodb-memory-usage-continued</a> <br><img src="http://blogs.innodb.com/wp/wp-content/uploads/2011/12/memfix1.png" alt="image"><br>  BUT!  those.  if my OS cannot use the memory that MySQL used, it certainly doesn‚Äôt have to be blamed on the OS. <br>  <b>5.5.21</b> <br>  I waited for the bug <a href="http://bugs.mysql.com/bug.php%3Fid%3D57480">fix bugs.mysql.com/bug.php?id=57480</a> .  Backport from 5.6.5 came fixed, thanks to which MySQL does not need to be reloaded every month, due to the swap filling.  But then a new surprise arose!  Which of course is old, but for PCI DSS assessors is a red rag, because you can get into the database without a password: <a href="http://seclists.org/oss-sec/2012/q2/493">seclists.org/oss-sec/2012/q2/493</a> .  The problem was well lit on <a href="http://habrahabr.ru/post/145641/">habrahabr.ru/post/145641</a> .  All versions prior to 5.5.22 are vulnerable.  We ourselves are not fast, we test, download the source code patch. <br>  <b>5.5.25</b> <br>  While patch and test out 5.5.25.  Well, like there are a lot of fixes, we decided to put it.  A month ago, we started the process of testing this version.  I am writing a ticket, here bang surprise!  Sources of this version are missing from the site.  There is a patch, we can not collect it, because there is no source to download the source code.  The reason is trivial <a href="http://bugs.mysql.com/bug.php%3Fid%3D65745">bugs.mysql.com/bug.php?id=65745</a> .  Update the primary key (I do not know who came up with the update primary key) causes a recursive change of data, which leads to filling the entire place on the HDD. <br>  <b>5.5.25a</b> <br>  Hooray released a new version.  So there everything should work.  We check the work: suddenly one of the developers says that he has MySQL falling on any request.  We are checking.  And the truth is, if you request data from a partitioned table for a non-existent period, MySQL crashes <br><pre><code class="bash hljs">12:06:58 UTC - mysqld got signal 8 ; This could be because you hit a bug. ... Thread pointer: 0x4169f30 Attempting backtrace. You can use the following information to find out <span class="hljs-built_in"><span class="hljs-built_in">where</span></span> mysqld died. If you see no messages after this, something went terribly wrong... stack_bottom = 7ff9fa384e58 thread_stack 0x30000 /opt/mysql-5.5.25a/bin/mysqld(my_print_stacktrace+0x29)[0x75feb9] ... /opt/mysql-5.5.25a/bin/mysqld(pfs_spawn_thread+0x54)[0x879cf4] /lib/x86_64-linux-gnu/libpthread.so.0(+0x7efc)[0x7ffa669e8efc] /lib/x86_64-linux-gnu/libc.so.6(<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span>+0x6d)[0x7ffa65d5b59d]</code> </pre> <br>  Checking - all versions up to 5.5.22 are vulnerable, but you can enter 5.5.22 without a password.  I do not know what to do.  We're sitting scratching turnips.  I, for example, after running this script (which we wrote all day), overload Ubuntu. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> test_mysql_crash; <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> test_table; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> test_table ( agad_id <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> auto_increment, partition_key <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>, caaf_caaf_id <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> (agad_id,partition_key), <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> idx_1 (partition_key), <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> idx_2 (caaf_caaf_id) ) <span class="hljs-keyword"><span class="hljs-keyword">engine</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">innodb</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> (partition_key) (<span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> test_table_20120717 <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">less</span></span> <span class="hljs-keyword"><span class="hljs-keyword">than</span></span> (<span class="hljs-number"><span class="hljs-number">20120718</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">engine</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">innodb</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> test_table_20120718 <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">less</span></span> <span class="hljs-keyword"><span class="hljs-keyword">than</span></span> (<span class="hljs-number"><span class="hljs-number">20120719</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">engine</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">innodb</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> test_table_20120719 <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">less</span></span> <span class="hljs-keyword"><span class="hljs-keyword">than</span></span> (<span class="hljs-number"><span class="hljs-number">20120720</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">engine</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">innodb</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> test_table_20120720 <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">less</span></span> <span class="hljs-keyword"><span class="hljs-keyword">than</span></span> (<span class="hljs-number"><span class="hljs-number">20120721</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">engine</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">innodb</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> test_table_20120721 <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">less</span></span> <span class="hljs-keyword"><span class="hljs-keyword">than</span></span> (<span class="hljs-number"><span class="hljs-number">20120722</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">engine</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">innodb</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> ui_test_mysql_crash; delimiter $$ <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> ui_test_mysql_crash() main_sql: <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> v_sql_core <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> v_sql_core = <span class="hljs-keyword"><span class="hljs-keyword">concat</span></span>( <span class="hljs-string"><span class="hljs-string">' explain select caaf_caaf_id, '</span></span>, <span class="hljs-string"><span class="hljs-string">' partition_key '</span></span>, <span class="hljs-string"><span class="hljs-string">' from test_table '</span></span>, <span class="hljs-string"><span class="hljs-string">' where partition_key between ? and ? '</span></span>, <span class="hljs-string"><span class="hljs-string">' group by caaf_caaf_id, partition_key'</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> @sv_ddl_statement = v_sql_core; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> @sv_partition_key_from = <span class="hljs-number"><span class="hljs-number">20120801</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> @sv_partition_key_to = <span class="hljs-number"><span class="hljs-number">20120831</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">prepare</span></span> v_stmt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> @sv_ddl_statement; <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span> v_stmt <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> @sv_partition_key_from, @sv_partition_key_to; <span class="hljs-keyword"><span class="hljs-keyword">deallocate</span></span> <span class="hljs-keyword"><span class="hljs-keyword">prepare</span></span> v_stmt; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> $$ delimiter ; <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ui_test_mysql_crash;</code> </pre><br>  Well, comment on the bug <a href="http://bugs.mysql.com/bug.php%3Fid%3D65587">bugs.mysql.com/bug.php?id=65587</a> and wait ... <br><br>  PS Of course, all events are not chronological, I just wanted to describe that in all the latest versions something is wrong ... <br><br>  <b>Update:</b> <a href="http://habrahabr.ru/users/shagguboy/" class="user_link">shagguboy</a> correctly noted - in one bug it is written that in 5.5.26 the last bug is already fixed, for which he thanks, and yes I am waiting for the next version <u>again</u> (IMHO is extremely symbolic) </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/148895/">https://habr.com/ru/post/148895/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148887/index.html">The principle of "confidence" of high-quality web design</a></li>
<li><a href="../148889/index.html">Five facts about the Belarusian labor market QA specialists</a></li>
<li><a href="../148892/index.html">Place Lucene index in RAM using Azul Zing JVM</a></li>
<li><a href="../148893/index.html">Continuous integration in the cloud</a></li>
<li><a href="../148894/index.html">One day from our life</a></li>
<li><a href="../148896/index.html">About how we vorpsimanii teskkt</a></li>
<li><a href="../148897/index.html">Video review of the laptop (slikbuk) HP ENVY 6</a></li>
<li><a href="../148899/index.html">Object Oriented Functional Metaprogramming</a></li>
<li><a href="../148901/index.html">We use fast exponentiation of matrices to write a very fast interpreter of a simple programming language.</a></li>
<li><a href="../148902/index.html">Nokia 101 Review - Flashlight with Player and $ 35 Phone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>