<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ASMX web services development techniques</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will talk about the various techniques for developing SOAP web services using ASMX technology, as well as about this technology in g...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ASMX web services development techniques</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/files/295/2c2/714/2952c2714f3e49a5be5d2d05452f938e.jpg">  In this article I will talk about the various techniques for developing SOAP web services using ASMX technology, as well as about this technology in general.  In addition to SOAP, the implementation of AJAX will also be considered.  The article will be useful both to those who are already familiar with it, and to those who are just about to create their first web service. <br><a name="habracut"></a><br><br clear="left"><br clear="left"><h3>  <b>Content</b> </h3><br>  <a href="https://habr.com/ru/post/254165/">History reference</a> <br>  <a href="https://habr.com/ru/post/254165/">ASMX and WCF</a> <br>  <a href="https://habr.com/ru/post/254165/">Introduction</a> <br><ol><li>  <a href="https://habr.com/ru/post/254165/">Simplest design</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Recommended design</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Proxy class using wsdl.exe</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Server class for this wsdl</a> </li><li>  <a href="https://habr.com/ru/post/254165/">ajax</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Request Metadata</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Accessing files</a> </li><li>  <a href="https://habr.com/ru/post/254165/">web.config</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Multiple asmx files</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Replacing a webpage</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Expansion replacement</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Hiding wsdl</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Exceptions</a> </li><li>  <a href="https://habr.com/ru/post/254165/">soap: Header</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Caching</a> </li><li>  <a href="https://habr.com/ru/post/254165/">SoapExtension</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Debagging x64 in Visual Studio</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Depla (publication)</a> </li><li>  <a href="https://habr.com/ru/post/254165/">IIS application pools</a> </li><li>  <a href="https://habr.com/ru/post/254165/">Development tools</a> </li></ol><br><habracut><br><a name="history"></a><h3>  <b>History reference</b> </h3><br>  From the very beginning, Microsoft was one of the main developers of the SOAP standard.  In 2002, as part of the very first version of ASP.NET 1.0, it introduced ASMX (Active Server Method Extended) technology, which allowed developers to easily create and consume SOAP web services in the latest Visual Studio 2002.  Note that this technology is officially on MSDN called ‚ÄúXML Web Services‚Äù.  In those years, SOAP only took the first serious steps in the world of web development.  The W3C consortium <a href="http://www.w3.org/TR/soap/">approved</a> SOAP 1.1 in 2000, SOAP 1.2 in 2003 (updated 2007).  Therefore, it was very important to make an easy-to-learn technology for the new standard.  And this goal was achieved - to work with web services, the developer did not even need to know XML, SOAP and WSDL. <br><br>  In subsequent years, ASMX technology has received very wide distribution and recognition.  Also from the very beginning, Microsoft delivered to it an addon of Web Services Enhancements (WSE), which allowed it to implement various WS- * security specifications such as WS-Security, WS-Policy, WS-ReliableMessaging.  The latest version, WSE 3.0, was released in 2005.  And in 2007, as part of .NET 3.0, the Windows Communication Foundation (WCF) technology was introduced, which became the official replacement for ASMX.  Despite the fact that ASMX technology has not been developed for a long time, it continues to be widely used and supported by the latest versions of the .NET Framework. <br><br><a name="wcf"></a><h3>  <b>ASMX and WCF</b> </h3><br>  It is interesting to compare how many web services of both types Google sees: <a href="https://www.google.com/">314,000 ASMX</a> and <a href="https://www.google.com/">6,280 WCF</a> <br>  Why is ASMX technology still so popular?  It's very simple: it is easy to use and perfectly solves the problem in most cases.  The advantage of WCF is manifested, for example, in cases where you need high speed transport, duplex, streaming, compliance with modern security standards, REST.  By the way, if you only need REST, then instead of WCF you should use ASP.NET Web API technology. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We specifically list the advantages of each technology: <br>  <b>Pros ASMX:</b> <br><ul><li>  Ease of development </li><li>  Ease of learning </li><li>  No configuration <a href="http://stackoverflow.com/questions/7029815/wcf-configuration-hell">hell</a> </li></ul><br>  <b>WCF Pros:</b> <br><ul><li>  Very diverse and flexible transportation options. </li><li>  Current and emerging technology </li><li>  Different hosting options </li><li>  Ability to implement a large variety of standards WS- * </li></ul><br>  So, WCF is a ‚ÄúSwiss knife‚Äù in the field of data transport, and ASMX is a ‚Äúgood-quality screwdriver‚Äù.  And best of all, of course, be able to use both tools.  Since the WCF development techniques on the Internet are described more fully and relevantly, I decided to write an article about ASMX, which is useful for those who have to support old web services and those who continue to use this technology to create new ones. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/512/82b/840/51282b84011948e798d8860f8060b45f.jpg"></div><br><br><a name="intro"></a><h3>  <b>Introduction</b> </h3><br>  The article describes 20 different practical techniques that can be applied when developing web services using this technology.  The scenario for the examples will be as follows.  There is a regularly updated database of financial reports.  It is necessary to develop a universal mechanism by which various clients will always have relevant data on these reports.  Solution: write a SOAP web service with two methods: <br><br><ul><li>  The first method takes a period in time and returns the identifiers of all reports that appeared in this period. </li><li>  The second method takes the report identifier and returns the data for the report itself. </li></ul><br>  Consumers of a web service regularly send requests to the first method, indicating the period since their last request, and if there are identifiers in the response, request data through the second method. <br><br>  Examples are demonstrated based on the code from the ‚ÄúRecommended Construction‚Äù, and in order to test them, it is enough to call the GetReportInfo web method as shown in the Proxy class example. <br><br><a name="trick_01"></a><h3>  <b>1. The simplest design</b> </h3><br>  Let's start with a description of the simplest web service design.  Attention, the example is purely theoretical!  Even though he is a worker, never do this in practice.  This is just a demonstration of the simplicity of the ASMX technology itself. <br><br>  Create a new project <b>‚ÄúASP.NET Empty Web Application‚Äù</b> or <b>‚ÄúASP.NET Web Service Application‚Äù</b> with the name <b>FinReportWebService</b> in Visual Studio.  Add two files to it: <b>FinReport.asmx</b> and <b>FinReportService.cs</b> , and add FinReport.asmx as a Text File, not a Web Service, so that it is a single file. <br><br>  FinReport.asmx <br><blockquote>  &lt;% <font color="blue">@</font> <font color="red">Class</font> <font color="blue">= "FinReportWebService.FinReportService"</font> %&gt; <br></blockquote><br>  FinReportService.cs <br><blockquote>  <font color="blue">using</font> System; <br>  <font color="blue">using</font> System.Web.Services; <br><br>  <font color="blue">namespace</font> FinReportWebService { <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReportService</font> { <br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  <font color="blue">public</font> <font color="blue">int</font> [] GetReportIdArray ( <font color="#2B91AF">DateTime</font> dateBegin, <font color="#2B91AF">DateTime</font> dateEnd) { <br>  <font color="blue">int</font> [] array = <font color="blue">new</font> <font color="blue">int</font> [] {357, 358, 360, 361}; <br>  <font color="blue">return</font> array; <br>  } <br><br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  <font color="blue">public</font> <font color="#2B91AF">FinReport</font> GetReport ( <font color="blue">int</font> reportID) { <br>  <font color="#2B91AF">FinReport</font> finReport = <font color="blue">new</font> <font color="#2B91AF">FinReport</font> () { <br>  ReportID = reportID, <br>  Date = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 03, 15), <br>  Info = <font color="#A31515">"Some info"</font> <br>  }; <br><br>  <font color="blue">return</font> finReport; <br>  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReport</font> { <br>  <font color="blue">public</font> <font color="blue">int</font> ReportID { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="#2B91AF">DateTime</font> Date { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="blue">string</font> Info { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br>  } <br></blockquote><br>  Press <b>F5</b> to launch the web server and open <b>FinReport.asmx</b> in your browser, you should see <br><br><img src="https://habrastorage.org/files/47d/609/4d5/47d6094d57bb43b4b2917ca3ee77feee.png"><br><br>  Is done.  Now we analyze in order.  A web service is represented by one regular class with only one mandatory feature ‚Äî some of its methods are marked with a special attribute <b>[WebMethod]</b> .  Such class methods become web-based web service methods with the appropriate call signature.  This class must have a default constructor.  With each new IIS request, it instantiates it with the default constructor and calls the appropriate method. <br><br>  The second mandatory part of the minimal construction is a file with the asmx extension, inside which you must specify this class. <br><br>  It is interesting to compare this manually created asmx file with the one that Visual Studio will create.  Suppose we want to make another web service that returns a currency exchange rate.  Add the <b>ExchangeRate.asmx</b> file with the Web Service type through the <b>Add New Item</b> menu. <br><br><img src="https://habrastorage.org/files/bae/65f/90f/bae65f90f6f64897a28fb83104a8a4b8.png"><br><br>  By pressing F7 once or twice, you can see the following: <br><blockquote>  &lt;% <font color="blue">@</font> <font color="maroon">WebService</font> <font color="red">Language</font> <font color="blue">= "C #"</font> <font color="red">CodeBehind</font> <font color="blue">= "ExchangeRate.asmx.cs"</font> <font color="blue"><font color="windowtext">&nbsp;&nbsp;</font></font>  <font color="blue"><font color="red">Class</font> = "FinReportWebService.ExchangeRate"</font> %&gt; <br></blockquote><br>  The operator Language = "C #" is rudimentary, and is needed only if you will write the source code directly inside the asmx file.  Such code will be compiled dynamically.  But I believe that, in general, dynamic compilation of a web service is not a very good practice, and in particular, I do not recommend using the special folder App_Code.  And the operator CodeBehind = "ExchangeRate.asmx.cs" simply links the two files at the Visual Studio level. <br><br><a name="trick_02"></a><h3>  <b>2. Recommended design</b> </h3><br>  In this example, the same web service is implemented in a more correct way.  Although this is a more correct code, it also serves only for demonstration.  For example, such important standard things as authorization, exception handling, logging are omitted here.  Also this example will be the basis on which other techniques of this article will be demonstrated.  In the file FinReportService.cs, replace the content with the following source code: <br><br>  FinReportService.cs <br><blockquote>  <font color="blue">using</font> System; <br>  <font color="blue">using</font> System.Web.Services; <br>  <font color="blue">using</font> System.Xml.Serialization; <br><br>  <font color="blue">namespace</font> FinReportWebService { <br><br>  [ <font color="#2B91AF">WebServiceBinding</font> (ConformsTo = <font color="#2B91AF">WsiProfiles</font> .BasicProfile1_1)] <br>  [ <font color="#2B91AF">WebService</font> (Description = <font color="#A31515">"</font> <font color="#A31515">Fin</font> <font color="#A31515">.</font> <font color="#A31515">Reports</font> <font color="#A31515">"</font> , Namespace = XmlNS)] <br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReportService</font> : <font color="#2B91AF">WebService</font> { <br>  <font color="blue">public</font> <font color="blue">const</font> <font color="blue">string</font> XmlNS = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> ; <br><br>  [ <font color="#2B91AF">WebMethod</font> (Description = <font color="#A31515">"Get a list of report IDs by period"</font> )] <br>  <font color="blue">public</font> <font color="#2B91AF">GetReportIdArrayResult</font> GetReportIdArray ( <font color="#2B91AF">GetReportIdArrayArg</font> arg) { <br>  <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">GetReportIdArrayResult</font> () { <br>  ReportIdArray = <font color="blue">new</font> <font color="blue">int</font> [] {357, 358, 360, 361} <br>  }; <br>  } <br><br>  [ <font color="#2B91AF">WebMethod</font> (Description = <font color="#A31515">"</font> <font color="#A31515">Getting</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">report</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">by</font> <font color="#A31515">id "</font> )] <br>  <font color="blue">public</font> <font color="#2B91AF">GetReportResult</font> GetReport ( <font color="#2B91AF">GetReportArg</font> arg) { <br>  <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">GetReportResult</font> () { <br>  Report = <font color="blue">new</font> <font color="#2B91AF">FinReport</font> { <br>  ReportID = arg.ReportID, <br>  Date = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 03, 15), <br>  Info = getReportInfo (arg.ReportID) <br>  } <br>  }; <br>  } <br><br>  <font color="blue">private</font> <font color="blue">string</font> getReportInfo ( <font color="blue">int</font> reportID) { <br>  <font color="blue">return</font> <font color="#A31515">"ReportID ="</font> + reportID; <br>  } <br>  } <br><br><br>  <font color="green">// [Serializable]</font> <br>  <font color="green">// [XmlType (Namespace = FinReportService.XmlNS)]</font> <br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReport</font> { <br>  <font color="blue">public</font> <font color="blue">int</font> ReportID { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="#2B91AF">DateTime</font> Date { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="blue">string</font> Info { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportIdArrayArg</font> { <br>  <font color="blue">public</font> <font color="#2B91AF">DateTime</font> DateBegin { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="#2B91AF">DateTime</font> DateEnd { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportIdArrayResult</font> { <br>  <font color="blue">public</font> <font color="blue">int</font> [] ReportIdArray { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportArg</font> { <br>  <font color="blue">public</font> <font color="blue">int</font> ReportID { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportResult</font> { <br>  <font color="blue">public</font> <font color="#2B91AF">FinReport</font> Report { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br>  } <br></blockquote><br>  We will analyze the changes. <br>  The attribute <b>[WebServiceBinding (ConformsTo = WsiProfiles.BasicProfile1_1)]</b> means that the web service is checked for compliance with the WSI Basic Profile 1.1 specification.  For example, according to it, overloading the operation name is prohibited, or using the attribute [SoapRpcMethod].  Such violations will result in a web service error ‚ÄúService‚Äû FinReportWebService.FinReportService ‚Äúdoes not meet the Simple SOAP Binding Profile Version 1.0 specification.‚Äù.  In the absence of this attribute, violations will only result in the warning ‚ÄúThis web service does not meet the requirements of WS-I Basic Profile v1.1.‚Äù.  In general, it is recommended to add this attribute, which provides greater interoperability. <br><br>  The attribute <b>[WebService (Description = ‚ÄúFin. Reports‚Äù, Namespace = XmlNS)]</b> has only three properties: <br>  Namespace - default CML namespace - be sure to specify <br>  Description - the web service description displayed in the browser <br>  Name - web service name (the class name is taken by default) <br><br>  Inheriting from the <b>WebService</b> class gives access to HttpContext, HttpSessionState, and several others, which can be useful in some cases. <br><br>  In the attribute <b>[WebMethod (Description = ‚ÄúReceive report by ID‚Äù)]</b> usually indicate only Description, which describes the web method in the browser, other properties are rarely used. <br><br>  I personally recommend encapsulating incoming parameters and return values ‚Äã‚Äãin special classes.  For example, I call them by adding the suffixes -Arg and -Result to the name of the method, which means the argument and the result.  In this example, for simplicity, they are all in the same FinReportService.cs file, but in real projects I place each of them in a separate file in a special folder of the type FinReportServiceTypes.  It is also convenient to inherit from common classes. <br><br>  In theory, all of your own classes in the web methods need to specify the attributes [Serializable] and [XmlType (Namespace = FinReportService.XmlNS)].  However, in this case it is not necessary.  After all, if only XML serialization is performed, the [Serializable] attribute is not needed, and the XML namespace is taken from the [WebService] attribute by default.  I note that, unlike WCF, ASMX uses the usual XmlSerializer, which allows you to widely manage serialization using standard attributes such as [XmlType], [XmlElement], [XmlIgnore], etc. <br><br><a name="trick_03"></a><h3>  <b>3. Proxy class using wsdl.exe</b> </h3><br>  The wsdl.exe utility is an asmx-compliant technique for using SOAP web services.  According to the wsdl file or link, it generates a proxy class - a special class that makes it as easy as possible to access this web service.  Of course, it does not matter on which technology the web service itself is implemented, it can be anything - ASMX, WCF, JAX-WS or NuSOAP.  By the way, WCF has a similar utility called SvcUtil.exe. <br><br>  The utility is located in the folder C: \ Program Files (x86) \ Microsoft SDKs \ Windows, moreover, it is presented there in different versions, depending on the .net version, bit depth, windows version and visual studio. <br><br><img src="https://habrastorage.org/files/225/d39/21c/225d3921c163464bb2e965145991271c.png"><br><br>  Examples of using <br><blockquote>  <b>wsdl http://192.168.1.101:8080/SomeDir/SomeService?wsdl</b> <b><br></b>  <b>wsdl HabraService.wsdl</b> <br></blockquote><br>  Let's make a client for FinReportWebService.  In the current or new solution, create a new Windows Forms project <b>FinReportWebServiceClient</b> .  Add the ProxyClass folder in it, copy the wsdl.exe utility into it and create the GenProxyClass.bat batch file in it: <br><blockquote>  <b>wsdl /n:FinReportWebServiceClient.ProxyClass http: // localhost: 3500 / FinReport.asmx? wsdl</b> <b><br></b>  <b>pause</b> <b><br></b> </blockquote><br>  Using the argument /n:FinReportWebServiceClient.ProxyClass we specify the namespace for the class.  Running it, you should get the file FinReportService.cs.  Via Solution Explorer - Show All Files, include all three files in the solution. <br><br><img src="https://habrastorage.org/files/908/f7d/076/908f7d0765f143d9a7732e6a467fbed2.png"><br><br>  Add a button to the form, and the following three methods to the form source code: <br><blockquote>  <font color="blue">public</font> <font color="blue">static</font> <font color="#2B91AF">FinReportService</font> GetFinReportService () { <br>  <font color="blue">var</font> service = <font color="blue">new</font> <font color="#2B91AF">FinReportService</font> (); <br>  service.Url = <font color="#A31515">"http: // localhost: 3500 / FinReport.asmx"</font> ; <br>  service.Timeout = 100 * 1000; <br>  <font color="blue">return</font> service; <br>  } <br><br><br>  <font color="blue">private</font> <font color="blue">void</font> webMethodTest_GetReportIdArray () { <br>  <font color="blue">var</font> service = GetFinReportService (); <br>  <font color="blue">var</font> arg = <font color="blue">new</font> <font color="#2B91AF">GetReportIdArrayArg</font> (); <br>  arg.DateBegin = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 03, 01); <br>  arg.DateEnd = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 03, 02); <br><br>  <font color="blue">var</font> result = service.GetReportIdArray (arg); <br>  <font color="#2B91AF">MessageBox</font> .Show ( <font color="#A31515">"result.ReportIdArray.Length ="</font> + result.ReportIdArray.Length); <br>  } <br><br><br>  <font color="blue">private</font> <font color="blue">void</font> webMethodTest_GetReport () { <br>  <font color="blue">var</font> service = GetFinReportService (); <br>  <font color="blue">var</font> arg = <font color="blue">new</font> <font color="#2B91AF">GetReportArg</font> (); <br>  arg.ReportID = 45; <br><br>  <font color="blue">var</font> result = service.GetReport (arg); <br>  <font color="#2B91AF">MessageBox</font> .Show (result.Report.Info); <br>  } <br></blockquote><br>  The most important properties of the proxy class are Url and Timeout, and the timeout is specified in milliseconds and 100 seconds is its default value.  Now with the help of them you can test the work of the web service.  A demonstration of further techniques will be shown by calling the GetReport method and filling in the result.Report.Info field. <br><br>  In the case of creating a proxy class for a wsdl file that refers to external xsd schemes, all these schemes must be listed in the command: <br><blockquote>  <b>wsdl / n: MyNamespace HabraService.wsdl Data.xsd Common.xsd Schema.xsd</b> <b><br></b> </blockquote><br>  However, in addition to manually creating a proxy class, Visual Studio allows you to create it automatically.  The item ‚ÄúAdd Service Reference‚Äù allows you to create a proxy class using WCF technology, and there is an ‚ÄúAdd Web Reference‚Äù button in Advanced that also creates it using ASMX technology. <br><br><a name="trick_04"></a><h3>  <b>4. Server class for this wsdl</b> </h3><br>  As you know, wsdl description of a web service in ASMX technology is automatically generated.  However, sometimes there is an inverse problem: for a given wsdl file, develop the corresponding web service.  It is solved using the same wsdl.exe utility.  It can create the necessary skeleton from the classes and all you have to do is implement the program logic of the web methods. <br><br>  For example, take the wsdl of our web service.  Save it from the browser as a FinReport.wsdl file or copy from here: <br><div class="spoiler">  <b class="spoiler_title">FinReport.wsdl</b> <div class="spoiler_text"><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font>  <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">utf-8</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: definitions</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: tm</font> <font color="blue">=</font> " <font color="blue">http://microsoft.com/wsdl/mime/textMatching/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: soapenc</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/encoding/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: mime</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/wsdl/mime/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: tns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/wsdl/soap/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: s</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: soap12</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/wsdl/soap12/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: http</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/wsdl/http/</font> " <font color="blue">&nbsp;</font>  <font color="red">targetNamespace</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: wsdl</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/wsdl/</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: documentation</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: wsdl</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/wsdl/</font> " <font color="blue">&gt;</font> Fin.  reports <font color="blue">&lt;/</font> <font color="#A31515">wsdl: documentation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl:</font> <font color="#A31515">types</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: schema</font> <font color="blue">&nbsp;</font>  <font color="red">elementFormDefault</font> <font color="blue">=</font> " <font color="blue">qualified</font> " <font color="blue">&nbsp;</font>  <font color="red">targetNamespace</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArray</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">0</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">arg</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">tns: GetReportIdArrayArg</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: element</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: complexType</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArrayArg</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">DateBegin</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">s: dateTime</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">DateEnd</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">s: dateTime</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArrayResponse</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">0</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArrayResult</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">tns: GetReportIdArrayResult</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: element</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: complexType</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArrayResult</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">0</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">ReportIdArray</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">tns: ArrayOfInt</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: complexType</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">ArrayOfInt</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">0</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">unbounded</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">int</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">s: int</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReport</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">0</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">arg</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">tns: GetReportArg</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: element</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: complexType</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportArg</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">ReportID</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">s: int</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportResponse</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">0</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportResult</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">tns: GetReportResult</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: element</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: complexType</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportResult</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">0</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">Report</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">tns: FinReport</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: complexType</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">FinReport</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s:</font> <font color="#A31515">sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">ReportID</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">s: int</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">Date</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">s: dateTime</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">s: element</font> <font color="blue">&nbsp;</font>  <font color="red">minOccurs</font> <font color="blue">=</font> " <font color="blue">0</font> " <font color="blue">&nbsp;</font>  <font color="red">maxOccurs</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">Info</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">s: string</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: sequence</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: complexType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">s: schema</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: types</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: message</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArraySoapIn</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: part</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">parameters</font> " <font color="blue">&nbsp;</font>  <font color="red">element</font> <font color="blue">=</font> " <font color="blue">tns: GetReportIdArray</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: message</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: message</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArraySoapOut</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: part</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">parameters</font> " <font color="blue">&nbsp;</font>  <font color="red">element</font> <font color="blue">=</font> " <font color="blue">tns: GetReportIdArrayResponse</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: message</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: message</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportSoapIn</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: part</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">parameters</font> " <font color="blue">&nbsp;</font>  <font color="red">element</font> <font color="blue">=</font> " <font color="blue">tns: GetReport</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: message</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: message</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportSoapOut</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: part</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">parameters</font> " <font color="blue">&nbsp;</font>  <font color="red">element</font> <font color="blue">=</font> " <font color="blue">tns: GetReportResponse</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: message</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: portType</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">FinReportServiceSoap</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArray</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: documentation</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: wsdl</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/wsdl/</font> " <font color="blue">&gt;</font> Getting a list of report IDs by period <font color="blue">&lt;/</font> <font color="#A31515">wsdl: documentation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: input</font> <font color="blue">&nbsp;</font>  <font color="red">message</font> <font color="blue">=</font> " <font color="blue">tns: GetReportIdArraySoapIn</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: output</font> <font color="blue">&nbsp;</font>  <font color="red">message</font> <font color="blue">=</font> " <font color="blue">tns: GetReportIdArraySoapOut</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReport</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: documentation</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: wsdl</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/wsdl/</font> " <font color="blue">&gt;</font> Getting the report by ID <font color="blue">&lt;/</font> <font color="#A31515">wsdl: documentation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: input</font> <font color="blue">&nbsp;</font>  <font color="red">message</font> <font color="blue">=</font> " <font color="blue">tns: GetReportSoapIn</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: output</font> <font color="blue">&nbsp;</font>  <font color="red">message</font> <font color="blue">=</font> " <font color="blue">tns: GetReportSoapOut</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: portType</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: binding</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">FinReportServiceSoap</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">tns: FinReportServiceSoap</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: binding</font> <font color="blue">&nbsp;</font>  <font color="red">transport</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/http</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArray</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: operation</font> <font color="blue">&nbsp;</font>  <font color="red">soapAction</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/GetReportIdArray</font> " <font color="blue">&nbsp;</font>  <font color="red">style</font> <font color="blue">=</font> " <font color="blue">document</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl:</font> <font color="#A31515">input</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: body</font> <font color="blue">&nbsp;</font>  <font color="red">use</font> <font color="blue">=</font> " <font color="blue">literal</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: input</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl:</font> <font color="#A31515">output</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: body</font> <font color="blue">&nbsp;</font>  <font color="red">use</font> <font color="blue">=</font> " <font color="blue">literal</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: output</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReport</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: operation</font> <font color="blue">&nbsp;</font>  <font color="red">soapAction</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/GetReport</font> " <font color="blue">&nbsp;</font>  <font color="red">style</font> <font color="blue">=</font> " <font color="blue">document</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl:</font> <font color="#A31515">input</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: body</font> <font color="blue">&nbsp;</font>  <font color="red">use</font> <font color="blue">=</font> " <font color="blue">literal</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: input</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl:</font> <font color="#A31515">output</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: body</font> <font color="blue">&nbsp;</font>  <font color="red">use</font> <font color="blue">=</font> " <font color="blue">literal</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: output</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: binding</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: binding</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">FinReportServiceSoap12</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">tns: FinReportServiceSoap</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap12: binding</font> <font color="blue">&nbsp;</font>  <font color="red">transport</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/http</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReportIdArray</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap12: operation</font> <font color="blue">&nbsp;</font>  <font color="red">soapAction</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/GetReportIdArray</font> " <font color="blue">&nbsp;</font>  <font color="red">style</font> <font color="blue">=</font> " <font color="blue">document</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl:</font> <font color="#A31515">input</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap12: body</font> <font color="blue">&nbsp;</font>  <font color="red">use</font> <font color="blue">=</font> " <font color="blue">literal</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: input</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl:</font> <font color="#A31515">output</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap12: body</font> <font color="blue">&nbsp;</font>  <font color="red">use</font> <font color="blue">=</font> " <font color="blue">literal</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: output</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">GetReport</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap12: operation</font> <font color="blue">&nbsp;</font>  <font color="red">soapAction</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/GetReport</font> " <font color="blue">&nbsp;</font>  <font color="red">style</font> <font color="blue">=</font> " <font color="blue">document</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl:</font> <font color="#A31515">input</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap12: body</font> <font color="blue">&nbsp;</font>  <font color="red">use</font> <font color="blue">=</font> " <font color="blue">literal</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: input</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl:</font> <font color="#A31515">output</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap12: body</font> <font color="blue">&nbsp;</font>  <font color="red">use</font> <font color="blue">=</font> " <font color="blue">literal</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: output</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: operation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: binding</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: service</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">FinReportService</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: documentation</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: wsdl</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/wsdl/</font> " <font color="blue">&gt;</font> Fin.  reports <font color="blue">&lt;/</font> <font color="#A31515">wsdl: documentation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: port</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">FinReportServiceSoap</font> " <font color="blue">&nbsp;</font>  <font color="red">binding</font> <font color="blue">=</font> " <font color="blue">tns: FinReportServiceSoap</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: address</font> <font color="blue">&nbsp;</font>  <font color="red">location</font> <font color="blue">=</font> " <font color="blue">http: // localhost: 3500 / FinReport.asmx</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: port</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdl: port</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">FinReportServiceSoap12</font> " <font color="blue">&nbsp;</font>  <font color="red">binding</font> <font color="blue">=</font> " <font color="blue">tns: FinReportServiceSoap12</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap12: address</font> <font color="blue">&nbsp;</font>  <font color="red">location</font> <font color="blue">=</font> " <font color="blue">http: // localhost: 3500 / FinReport.asmx</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: port</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: service</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">wsdl: definitions</font> <font color="blue">&gt;</font> <br></blockquote><br></div></div>  Create a new empty web-project in the solution with the name <b>FinReportWebServiceByWsdl</b> .  In it, add the ServerClass folder to which you copy the files FinReport.wsdl and wsdl.exe.  Create a GenServerClass.bat batch file in it: <br><blockquote>  <b>wsdl / server /n:FinReportWebServiceByWsdl.ServerClass FinReport.wsdl</b> <b><br></b>  <b>pause</b> <b><br></b> </blockquote><br>  Running it, you should get the file FinReportService.cs.  Include all four files in the solution. <br><br><img src="https://habrastorage.org/files/e4d/1d2/864/e4d1d28648db41df80f1925dfaea5448.png"><br><br>  So, as you can see, the only difference from the proxy class generation is the server attribute.  This creates an abstract class inherited from the WebService with abstractly described web methods.  You can inherit from it, but you still need to copy all the attributes, so I suggest doing this as follows.  Copy the class definition to the new file and namespace, remove the word abstract and write the implementation of the methods.  After formatting the code, I got the following file <br><blockquote>  <font color="blue">using</font> System; <br>  <font color="blue">using</font> System.Web.Services; <br>  <font color="blue">using</font> System.Web.Services.Description; <br>  <font color="blue">using</font> System.Web.Services.Protocols; <br>  <font color="blue">using</font> FinReportWebServiceByWsdl.ServerClass; <br><br>  <font color="blue">namespace</font> FinReportWebServiceByWsdl { <br><br>  [ <font color="#2B91AF">WebService</font> (Namespace = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> )] <br>  [ <font color="#2B91AF">WebServiceBinding</font> (Name = <font color="#A31515">"FinReportServiceSoap"</font> , Namespace = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> )] <br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReportService</font> : <font color="#2B91AF">WebService</font> { <br><br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  [ <font color="#2B91AF">SoapDocumentMethod</font> ( <font color="#A31515">"http://asmx.habrahabr.ru/GetReportIdArray"</font> , <br>  RequestNamespace = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> , <br>  ResponseNamespace = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> , <br>  Use = <font color="#2B91AF">SoapBindingUse</font> .Literal, <br>  ParameterStyle = <font color="#2B91AF">SoapParameterStyle</font> .Wrapped)] <br><br>  <font color="blue">public</font> <font color="#2B91AF">GetReportIdArrayResult</font> GetReportIdArray ( <font color="#2B91AF">GetReportIdArrayArg</font> arg) { <br>  <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">GetReportIdArrayResult</font> (); <br>  } <br><br><br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  [ <font color="#2B91AF">SoapDocumentMethod</font> ( <font color="#A31515">"http://asmx.habrahabr.ru/GetReport"</font> , <br>  RequestNamespace = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> , <br>  ResponseNamespace = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> , <br>  Use = <font color="#2B91AF">SoapBindingUse</font> .Literal, <br>  ParameterStyle = <font color="#2B91AF">SoapParameterStyle</font> .Wrapped)] <br><br>  <font color="blue">public</font> <font color="#2B91AF">GetReportResult</font> GetReport ( <font color="#2B91AF">GetReportArg</font> arg) { <br>  <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">GetReportResult</font> () { <br>  Report = <font color="blue">new</font> <font color="#2B91AF">FinReport</font> { <br>  ReportID = arg.ReportID, <br>  Date = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 03, 15), <br>  Info = <font color="#A31515">"ByWSDL"</font> <br>  } <br>  }; <br>  } <br>  } <br>  } <br></blockquote><br>  In this code, the utility explicitly described using the attributes of those web service parameters that were implicitly determined by default.  It remains only to add the file <b>FinReportByWsdl.asmx</b> , which will point to this new class: <br><blockquote>  &lt;% <font color="blue">@</font> <font color="red">Class</font> <font color="blue">= "FinReportWebServiceByWsdl.FinReportService"</font> %&gt; <br></blockquote><br><br><a name="trick_05"></a><h3>  <b>5. ajax</b> </h3><br>  ASMX web service can receive and return data in JSON format, which allows to implement ajax technique.  For the example to work, your web project must have the following three files: <br><br>  FinReport.asmx - the same as in the first examples, just 1 line <br><blockquote>  &lt;% <font color="blue">@</font> <font color="red">Class</font> <font color="blue">= "FinReportWebService.FinReportService"</font> %&gt; <br></blockquote><br>  FinReportService.cs - the code changes to the next <br><blockquote>  <font color="blue">using</font> System; <br>  <font color="blue">using</font> System.Text; <br>  <font color="blue">using</font> System.Web.Script.Serialization; <br>  <font color="blue">using</font> System.Web.Script.Services; <br>  <font color="blue">using</font> System.Web.Services; <br>  <font color="blue">using</font> Newtonsoft.Json; <br><br>  <font color="blue">namespace</font> FinReportWebService { <br>  [ <font color="#2B91AF">ScriptService</font> ] <br>  [ <font color="#2B91AF">WebServiceBinding</font> (ConformsTo = <font color="#2B91AF">WsiProfiles</font> .BasicProfile1_1)] <br>  [ <font color="#2B91AF">WebService</font> (Description = <font color="#A31515">"</font> <font color="#A31515">Fin</font> <font color="#A31515">.</font> <font color="#A31515">Reports</font> <font color="#A31515">"</font> , Namespace = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> )] <br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReportService</font> : <font color="#2B91AF">WebService</font> { <br><br>  [ <font color="#2B91AF">ScriptMethod</font> (ResponseFormat = <font color="#2B91AF">ResponseFormat</font> .Json)] <br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  <font color="blue">public</font> <font color="#2B91AF">GetReportResult</font> Method_1_POST_Objects ( <font color="#2B91AF">GetReportArg</font> arg) { <br>  <font color="blue">return</font> getFinReportResult (arg.ReportID, <font color="#A31515">"Method_1_POST_Objects"</font> ); <br>  } <br><br><br>  [ <font color="#2B91AF">ScriptMethod</font> (ResponseFormat = <font color="#2B91AF">ResponseFormat</font> .Json, UseHttpGet = <font color="blue">true</font> )] <br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  <font color="blue">public</font> <font color="blue">string</font> Method_2_GET ( <font color="blue">int</font> id) { <br>  <font color="blue">var</font> result = getFinReportResult (id, <font color="#A31515">"Method_2_GET"</font> ); <br>  <font color="blue">string</font> text = <font color="#2B91AF">JsonConvert</font> .SerializeObject (result); <br>  <font color="blue">return</font> text; <br>  } <br><br><br>  [ <font color="#2B91AF">ScriptMethod</font> (ResponseFormat = <font color="#2B91AF">ResponseFormat</font> .Json)] <br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  <font color="blue">public</font> <font color="blue">string</font> Method_3_POST ( <font color="blue">int</font> id) { <br>  <font color="blue">var</font> result = getFinReportResult (id, <font color="#A31515">"Method_3_POST"</font> ); <br>  <font color="#2B91AF">JavaScriptSerializer</font> js = <font color="blue">new</font> <font color="#2B91AF">JavaScriptSerializer</font> (); <br>  <font color="blue">return</font> js.Serialize (result); <br>  } <br><br><br>  [ <font color="#2B91AF">ScriptMethod</font> (ResponseFormat = <font color="#2B91AF">ResponseFormat</font> .Json)] <br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  <font color="blue">public</font> <font color="blue">string</font> Method_4_POST_ComplexArg ( <font color="blue">string</font> json) { <br>  <font color="blue">var</font> arg = <font color="#2B91AF">JsonConvert</font> .DeserializeObject &lt; <font color="#2B91AF">GetReportArg</font> &gt; (json); <br>  <font color="blue">var</font> result = getFinReportResult (arg.ReportID, arg.Token + <font color="#A31515">"</font> <font color="#A31515">Received</font> <font color="#A31515">."</font> ); <br>  <font color="blue">return</font> <font color="#2B91AF">JsonConvert</font> .SerializeObject (result); <br>  } <br><br><br>  [ <font color="#2B91AF">ScriptMethod</font> (ResponseFormat = <font color="#2B91AF">ResponseFormat</font> .Json)] <br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  <font color="blue">public</font> <font color="#2B91AF">DateTime</font> Method_5_TransformDate ( <font color="#2B91AF">DateTime</font> dateTime) { <br>  <font color="blue">Return</font> dateTime.AddYears (-3) .AddDays (-5) .AddHours (-2) .AddMinutes (6); <br>  } <br><br><br>  [ <font color="#2B91AF">ScriptMethod</font> (ResponseFormat = <font color="#2B91AF">ResponseFormat</font> .Json)] <br>  [ <font color="#2B91AF">WebMethod</font> ] <br>  <font color="blue">public</font> <font color="blue">void</font> Method_6_POST_NonStandard ( <font color="blue">int</font> id) { <br>  <font color="blue">var</font> result = getFinReportResult (id, <font color="#A31515">"Method_6_POST_NonStandard,</font> <font color="#A31515">My</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">text</font> <font color="#A31515">"</font> ); <br>  <font color="blue">string</font> text = <font color="#2B91AF">JsonConvert</font> .SerializeObject (result); <br>  <font color="blue">byte</font> [] data = <font color="#2B91AF">Encoding</font> .UTF8.GetBytes (text); <br><br>  Context.Response.Clear (); <br>  Context.Response.ContentType = <font color="#A31515">"application / json; charset = utf-8"</font> ; <br>  Context.Response.AddHeader ( <font color="#A31515">"content-length"</font> , data.Length.ToString ()); <br>  Context.Response.BinaryWrite (data); <br>  Context.Response.Flush (); <br>  } <br><br><br>  <font color="blue">private</font> <font color="#2B91AF">GetReportResult</font> getFinReportResult ( <font color="blue">int</font> id, <font color="blue">string</font> info) { <br>  <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">GetReportResult</font> () { <br>  Report = <font color="blue">new</font> <font color="#2B91AF">FinReport</font> () { <br>  ReportID = id, <br>  Info = info, <br>  Date = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 03, 15), <br>  } <br>  }; <br>  } <br>  } <br><br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReport</font> { <br>  <font color="blue">public</font> <font color="#2B91AF">DateTime</font> Date { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="blue">string</font> Info { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="blue">int</font> ReportID { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportArg</font> { <br>  <font color="blue">public</font> <font color="blue">int</font> ReportID { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="blue">string</font> Token { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportResult</font> { <br>  <font color="blue">public</font> <font color="#2B91AF">FinReport</font> Report { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br>  } <br></blockquote><br>  Page.htm - the actual webpage <br><blockquote>  <font color="blue">&lt;!</font>  <font color="maroon">doctype</font> <font color="red">html</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">html</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">head</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="maroon">meta</font> <font color="red">charset</font> <font color="blue">= utf-8&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">script</font> <font color="red">src</font> <font color="blue">= "// ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"&gt;&lt;/</font> <font color="maroon">script</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="maroon">script</font> <font color="blue">&gt;</font> <br>  $ (document) .ready ( <font color="blue">function</font> () { <br>  $ ( <font color="maroon">"# btn1"</font> ) .click ( <font color="blue">function</font> () { <br>  <font color="blue">var</font> arg = {arg: {ReportID: 1}}; <br><br>  $ .ajax ({ <br>  type: <font color="maroon">"POST"</font> , <br>  contentType: <font color="maroon">"application / json; charset = utf-8"</font> , <br>  url: <font color="maroon">"/FinReport.asmx/Method_1_POST_Objects"</font> , <br>  data: JSON.stringify (arg), <br>  dataType: <font color="maroon">"json"</font> , <br>  success: <font color="blue">function</font> (data, status) { <br>  $ ( <font color="maroon">"# div1"</font> ) .html (data.d.Report.Info); <br>  }, <br>  error: <font color="blue">function</font> (request, status, error) {alert ( <font color="maroon">"Error"</font> );  } <br>  }); <br>  }); <br><br>  $ ( <font color="maroon">"# btn2"</font> ) .click ( <font color="blue">function</font> () { <br>  $ .ajax ({ <br>  type: <font color="maroon">"GET"</font> , <br>  contentType: <font color="maroon">"application / json; charset = utf-8"</font> , <br>  url: <font color="maroon">"/FinReport.asmx/Method_2_GET"</font> , <br>  data: {id: 2}, <br>  dataType: <font color="maroon">"json"</font> , <br>  success: <font color="blue">function</font> (data, status) { <br>  $ ( <font color="maroon">"# div2"</font> ) .html (JSON.parse (data.d) .Report.Info); <br>  }, <br>  error: <font color="blue">function</font> (request, status, error) {alert ( <font color="maroon">"Error"</font> );  } <br>  }); <br>  }); <br><br>  $ ( <font color="maroon">"# btn3"</font> ) .click ( <font color="blue">function</font> () { <br>  $ .ajax ({ <br>  type: <font color="maroon">"POST"</font> , <br>  contentType: <font color="maroon">"application / json; charset = utf-8"</font> , <br>  url: <font color="maroon">"/FinReport.asmx/Method_3_POST"</font> , <br>  data: <font color="maroon">'{"id": 3}'</font> , <br>  dataType: <font color="maroon">"json"</font> , <br>  success: <font color="blue">function</font> (data, status) { <br>  $ ( <font color="maroon">"# div3"</font> ) .html (JSON.parse (data.d) .Report.Info); <br>  }, <br>  error: <font color="blue">function</font> (request, status, error) {alert ( <font color="maroon">"Error"</font> );  } <br>  }); <br>  }); <br><br><br>  $ ( <font color="maroon">"# btn4"</font> ) .click ( <font color="blue">function</font> () { <br>  <font color="blue">var</font> arg = {ReportID: 4, Token: <font color="maroon">"</font> <font color="maroon">Token</font> <font color="maroon">&nbsp;</font>  <font color="maroon">method</font> <font color="maroon">4. "</font> }; <br>  <font color="blue">var</font> argObj = {json: JSON.stringify (arg)}; <br><br>  $ .ajax ({ <br>  type: <font color="maroon">"POST"</font> , <br>  contentType: <font color="maroon">"application / json; charset = utf-8"</font> , <br>  url: <font color="maroon">"/FinReport.asmx/Method_4_POST_ComplexArg"</font> , <br>  data: JSON.stringify (argObj), <br>  dataType: <font color="maroon">"json"</font> , <br>  success: <font color="blue">function</font> (data, status) { <br>  $ ( <font color="maroon">"# div4"</font> ) .html (JSON.parse (data.d) .Report.Info); <br>  }, <br>  error: <font color="blue">function</font> (request, status, error) {alert ( <font color="maroon">"Error"</font> );  } <br>  }); <br>  }); <br><br>  $ ( <font color="maroon">"# btn5"</font> ) .click ( <font color="blue">function</font> () { <br>  <font color="blue">var</font> now = <font color="blue">new</font> Date (); <br>  <font color="blue">var</font> arg = {dateTime: now}; <br><br>  $ .ajax ({ <br>  type: <font color="maroon">"POST"</font> , <br>  contentType: <font color="maroon">"application / json; charset = utf-8"</font> , <br>  url: <font color="maroon">"/FinReport.asmx/Method_5_TransformDate"</font> , <br>  data: JSON.stringify (arg), <br>  dataType: <font color="maroon">"json"</font> , <br>  success: <font color="blue">function</font> (data, status) { <br>  <font color="blue">var</font> date = <font color="blue">new</font> Date (parseInt (data.d.replace ( <font color="maroon">"/ Date ("</font> , <font color="maroon">""</font> ) .replace ( <font color="maroon">") /"</font> , <font color="maroon">""</font> ), 10)); <br>  $ ( <font color="maroon">"# div5"</font> ) .html (date.toString ()); <br>  }, <br>  error: <font color="blue">function</font> (request, status, error) {alert ( <font color="maroon">"Error"</font> );  } <br>  }); <br>  }); <br><br>  $ ( <font color="maroon">"# btn6"</font> ) .click ( <font color="blue">function</font> () { <br>  $ .ajax ({ <br>  type: <font color="maroon">"POST"</font> , <br>  contentType: <font color="maroon">"application / json; charset = utf-8"</font> , <br>  url: <font color="maroon">"/FinReport.asmx/Method_6_POST_NonStandard"</font> , <br>  data: <font color="maroon">'{"id": 6}'</font> , <br>  dataType: <font color="maroon">"json"</font> , <br>  success: <font color="blue">function</font> (data, status) { <br>  $ ( <font color="maroon">"# div6"</font> ) .html (data.Report.Info); <br>  }, <br>  error: <font color="blue">function</font> (request, status, error) {alert ( <font color="maroon">"Error"</font> );  } <br>  }); <br>  }); <br><br><br>  }); <br>  <font color="blue">&lt;/</font> <font color="maroon">script</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;/</font> <font color="maroon">head</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">body</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="maroon">div</font> <font color="red">id</font> <font color="blue">= "div1"&gt;</font> Div 1 <font color="blue">&lt;/</font> <font color="maroon">div</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">div</font> <font color="red">id</font> <font color="blue">= "div2"&gt;</font> Div 2 <font color="blue">&lt;/</font> <font color="maroon">div</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">div</font> <font color="red">id</font> <font color="blue">= "div3"&gt;</font> Div 3 <font color="blue">&lt;/</font> <font color="maroon">div</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">div</font> <font color="red">id</font> <font color="blue">= "div4"&gt;</font> Div 4 <font color="blue">&lt;/</font> <font color="maroon">div</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">div</font> <font color="red">id</font> <font color="blue">= "div5"&gt;</font> Div 5 <font color="blue">&lt;/</font> <font color="maroon">div</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">div</font> <font color="red">id</font> <font color="blue">= "div6"&gt;</font> Div 6 <font color="blue">&lt;/</font> <font color="maroon">div</font> <font color="blue">&gt;</font> <br>  <font color="blue"><font color="maroon">&lt;Br</font></font> <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">button</font> <font color="red">id</font> <font color="blue">= "btn1"&gt;</font> Method 1 <font color="blue">&lt;/</font> <font color="maroon">button</font> <font color="blue">&gt;</font> <br>  <font color="blue"><font color="maroon">&lt;Br</font></font> <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">button</font> <font color="red">id</font> <font color="blue">= "btn2"&gt;</font> Method 2 <font color="blue">&lt;/</font> <font color="maroon">button</font> <font color="blue">&gt;</font> <br>  <font color="blue"><font color="maroon">&lt;Br</font></font> <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">button</font> <font color="red">id</font> <font color="blue">= "btn3"&gt;</font> Method 3 <font color="blue">&lt;/</font> <font color="maroon">button</font> <font color="blue">&gt;</font> <br>  <font color="blue"><font color="maroon">&lt;Br</font></font> <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">button</font> <font color="red">id</font> <font color="blue">= "btn4"&gt;</font> Method 4 <font color="blue">&lt;/</font> <font color="maroon">button</font> <font color="blue">&gt;</font> <br>  <font color="blue"><font color="maroon">&lt;Br</font></font> <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">button</font> <font color="red">id</font> <font color="blue">= "btn5"&gt;</font> Method 5 <font color="blue">&lt;/</font> <font color="maroon">button</font> <font color="blue">&gt;</font> <br>  <font color="blue"><font color="maroon">&lt;Br</font></font> <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">button</font> <font color="red">id</font> <font color="blue">= "btn6"&gt;</font> Method 6 <font color="blue">&lt;/</font> <font color="maroon">button</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;/</font> <font color="maroon">body</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="maroon">html</font> <font color="blue">&gt;</font> <br></blockquote><br>  The example also uses the <a href="https://github.com/JamesNK/Newtonsoft.Json/releases">Json.NET</a> library aka Newtonsoft.Json. <br><br>  In order for the web service to work with JSON, you need to apply 2 new attributes: <br> [ScriptService] ‚Äì  ,  [ScriptMethod],    ResponseFormat     ‚Äî JSON  XML,  UseHttpGet ‚Äì    ‚Äì GET  POST. <br><br>   - 6 ,      ajax. <br><br> <b> 1</b> .    2        GetReportArg  GetReportResult.         : <br><blockquote>  <font color="black">{</font> <br> <font color="black">"</font> <font color="black">arg</font> <font color="black">":</font> <font color="black">{</font> <br> <font color="black">"ReportID":</font> <font color="#1C00CF">1</font> <br>  <font color="black">}</font> <br>  <font color="black">}</font> <br></blockquote><br><blockquote>  <font color="black">{</font> <br> <font color="black">"</font> <font color="black">d</font> <font color="black">":</font> <font color="black">{</font> <br> <font color="black">"__type":</font> <font color="#C41A16">"FinReportWebService.GetReportResult"</font> <font color="black">,</font> <br> <font color="black">"Report": {</font> <br> <font color="black">"ReportID":</font> <font color="#1C00CF">1</font> <font color="black">,</font> <br> <font color="black">"Date":</font> <font color="#C41A16">"/Date(1426356000000)/"</font> <font color="black">,</font> <br> <font color="black">"Info":</font> <font color="#C41A16">"Method_1_POST_Objects"</font> <br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="black">}</font> <br>  <font color="black">}</font> <br>  <font color="black">}</font> <br></blockquote>     ,    .  JSON- -       ¬´d¬ª.      "__type": ¬´FinReportWebService.GetReportResult¬ª.     "/Date(1426356000000)/"  .     ,   5 ,  ,    ,   . <br><br> <b> 2</b> .    .    GET,  ,  json-,        .      data: { id: 2 },   URL    http://localhost:3500/FinReport.asmx/Method_2_GET?id=2,       URL. <br><br>     <br><blockquote>  <font color="black">{</font> <br> <font color="black">"</font> <font color="black">d":</font> <font color="#C41A16">"{\"Report\":{\"ReportID\":2,\"Date\":\"2015-03-15T00:00:00\",\"Info\":\"Method_2_GET\"}}"</font> <br>  <font color="black">}</font> <br></blockquote>  ,    JSON.parse(data.d),     : <br><blockquote>  <font color="black">{</font> <br> <font color="black">"</font> <font color="black">Report": {</font> <br> <font color="black">"ReportID":</font> <font color="#1C00CF">2</font> <font color="black">,</font> <br> <font color="black">"Date":</font> <font color="#C41A16">"2015-03-15T00:00:00"</font> <font color="black">,</font> <br> <font color="black">"Info":</font> <font color="#C41A16">"Method_2_GET"</font> <br><font color="black">&nbsp;&nbsp;&nbsp;</font>  <font color="black">}</font> <br>  <font color="black">}</font> <br></blockquote>  ,     Json.NET   .      contentType: ¬´application/json; charset=utf-8¬ª,   ,   GET.      CSRF.      URL      .    GET  . <br><br> <b> 3.</b>   ,     POST     .   : <br><blockquote>  <font color="black">{</font> <br> <font color="black">"</font> <font color="black">id</font> <font color="black">":</font> <font color="#1C00CF">3</font> <br>  <font color="black">}</font> <br></blockquote>     : <br><blockquote>  <font color="black">{</font> <br> <font color="black">"</font> <font color="black">d":</font> <font color="#C41A16">"{\"Report\":{\"ReportID\":3,\"Date\":\"\\/Date(1426356000000)\\/\",\"Info\":\"Method_3_POST\"}}"</font> <br>  <font color="black">}</font> <br></blockquote><br> <b> 4.</b>   ,    <font color="blue">var</font> arg = { ReportID: 4, Token: <font color="maroon">"</font> <font color="maroon"></font> <font color="maroon"></font> <font color="maroon">4."</font>  };   : <br><blockquote>  <font color="black">{</font> <br> <font color="black">"json":</font> <font color="#C41A16">"{\"ReportID\":4,\"Token\":\"</font> <font color="#C41A16"></font> <font color="#C41A16">&nbsp;</font> <font color="#C41A16"></font> <font color="#C41A16">4\"}"</font> <br>  <font color="black">}</font> <br></blockquote>  . <br><br> <b> 5.</b>            ,     .   1      ¬´Date¬ª: "/Date(1426356000000)/".    ‚Äì   ,    1  1970  UTC (UNIX epoch).   ,    Date    new Date(milliseconds),           : <br><blockquote> <font color="blue">var</font> date = <font color="blue">new</font> Date(parseInt(data.d.replace( <font color="maroon">"/Date("</font> , <font color="maroon">""</font> ).replace( <font color="maroon">")/"</font> , <font color="maroon">""</font> ), 10)); <br></blockquote><br>    -       : <br><blockquote>  <font color="black">{</font> <br> <font color="black">"</font> <font color="black">dateTime":</font> <font color="#C41A16">"2015-03-25T05:49:13.604Z"</font> <br>  <font color="black">}</font> <br></blockquote><br> <b> 6.</b>     ,            .   ,           . <br><blockquote>  <font color="black">{</font> <br> <font color="black">"</font> <font color="black">Report": {</font> <br> <font color="black">"Date":</font> <font color="#C41A16">"2015-03-15T00:00:00"</font> <font color="black">,</font> <br> <font color="black">"Info":</font> <font color="#C41A16">"Method_6_GET_NonStandard,</font> <font color="#C41A16"></font> <font color="#C41A16">&nbsp;</font> <font color="#C41A16"></font> <font color="#C41A16">"</font> <font color="black">,</font> <br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font> <font color="black">"ReportID":</font> <font color="#1C00CF">6</font> <br>  <font color="black">}</font> <br>  <font color="black">}</font> <br></blockquote>  ,      ¬´d¬ª.    GET.  ,      -   ¬´application/json;¬ª. <br><br><h5> <b>maxJsonLength</b> </h5><br>        maxJsonLength  web.config: <br><blockquote> <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font> <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font><br> <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font> <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font> <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">/&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br> <font color="blue">&lt;</font> <font color="#A31515">system.web.extensions</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">scripting</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">webServices</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">jsonSerialization</font> <font color="blue">&nbsp;</font> <font color="red">maxJsonLength</font> <font color="blue">=</font> " <font color="blue">1073741824</font> " <font color="blue">/&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">webServices</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">scripting</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">system.web.extensions</font> <font color="blue">&gt;</font> <br><br> <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote><br><br><a name="trick_06"></a><h3> <b>6.  </b> </h3><br>    ,      ,    IP-   URL.    ,       .     ,      .     DNS-,        .    getReportInfo()   <br><blockquote> <font color="blue">private</font> <font color="blue">string</font> getReportInfo() { <br> <font color="blue">var</font> request = <font color="blue">this</font> .Context.Request; <br> <font color="green">//    var request = HttpContext.Current.Request;</font> <br><br> <font color="#2B91AF">StringBuilder</font> sb = <font color="blue">new</font> <font color="#2B91AF">StringBuilder</font> (); <br> sb.Append( <font color="#A31515">"IP = "</font> ).AppendLine(request.UserHostAddress); <br> sb.Append( <font color="#A31515">"URL = "</font> ).AppendLine(request.Url.OriginalString); <br> sb.Append( <font color="#A31515">"Header 'Connection' = "</font> ).AppendLine(request.Headers[ <font color="#A31515">"Connection"</font> ]); <br><br> <font color="#2B91AF">DateTime</font> dnsDate = <font color="#2B91AF">DateTime</font> .Now; <br> <font color="#2B91AF">TimeSpan</font> dnsSpan; <br><br> <font color="blue">try</font> { <br> <font color="green">//        throw new Exception("</font> <font color="green"></font> <font color="green">&nbsp;</font> <font color="green"></font> <font color="green">.");</font> <br> <font color="blue">var</font> entry = Dns.GetHostEntry(request.UserHostAddress); <br> dnsSpan = <font color="#2B91AF">DateTime</font> .Now.Subtract(dnsDate); <br> sb.Append( <font color="#A31515">"HostName = "</font> ).AppendLine(entry.HostName); <br><br> } <font color="blue">catch</font> ( <font color="#2B91AF">Exception</font> ex) { <br> dnsSpan = <font color="#2B91AF">DateTime</font> .Now.Subtract(dnsDate); <br> sb.AppendLine(ex.Message); <br>  } <br><br> sb.Append( <font color="#A31515">"dnsSpan = "</font> ).AppendLine(dnsSpan.ToString()); <br> <font color="blue">return</font> sb.ToString(); <br>  } <br></blockquote><br><br><a name="trick_07"></a><h3> <b>7.   </b> </h3><br>        ,     -.     getReportInfo   : <br><blockquote> <font color="blue">private</font> <font color="blue">string</font> getReportInfo( <font color="blue">int</font> reportID) { <br> <font color="blue">string</font> dirRoot = <font color="#2B91AF">HttpContext</font> .Current.Server.MapPath( <font color="#A31515">"~"</font> ); <br><br> <font color="#2B91AF">StringBuilder</font> sb = <font color="blue">new</font> <font color="#2B91AF">StringBuilder</font> (); <br> sb.AppendLine( <font color="#A31515">"dirRoot = "</font> + dirRoot); <br><br> <font color="blue">string</font> fileCars = <font color="#2B91AF">HttpContext</font> .Current.Server.MapPath( <font color="#A31515">"~/bin/MyFiles/Cars.txt"</font> ); <br> sb.AppendLine( <font color="#A31515">"fileCars = "</font> + fileCars); <br><br> <font color="blue">try</font> { <br> sb.AppendLine( <font color="#A31515">"Line 1 = "</font> + <font color="#2B91AF">File</font> .ReadAllLines(fileCars)[0]); <br> <font color="#2B91AF">File</font> .AppendAllText(fileCars, <font color="#2B91AF">Environment</font> .NewLine + <font color="#2B91AF">DateTime</font> .Now + <font color="#A31515">" ReportID = "</font> + reportID); <br><br> } <font color="blue">catch</font> ( <font color="#2B91AF">Exception</font> ex) { <br> sb.AppendLine(ex.Message); <br>  } <br><br> <font color="blue">string</font> dirFiles = <font color="#2B91AF">Path</font> .Combine(( <font color="blue">new</font> <font color="#2B91AF">DirectoryInfo</font> (dirRoot)).Parent.FullName, <font color="#A31515">"FinReportWebService_Files"</font> ); <br> sb.AppendLine( <font color="#A31515">"dirFiles = "</font> + dirFiles); <br><br> <font color="blue">try</font> { <br> <font color="#2B91AF">Directory</font> .CreateDirectory(dirFiles); <br> <font color="blue">string</font> newFile = <font color="#2B91AF">Path</font> .Combine(dirFiles, <font color="#2B91AF">Guid</font> .NewGuid() + <font color="#A31515">".txt"</font> ); <br> <font color="#2B91AF">File</font> .WriteAllText(newFile, <font color="#A31515">"ReportID = "</font> + reportID); <br> sb.AppendLine(newFile); <br><br> } <font color="blue">catch</font> ( <font color="#2B91AF">Exception</font> ex) { <br> sb.AppendLine(ex.Message); <br>  } <br><br><br> <font color="blue">return</font> sb.ToString(); <br>  } <br></blockquote>     MyFiles      Cars.txt   Build Action: None / Copy always  -  : <br><br><img src="https://habrastorage.org/files/fa7/c7c/830/fa7c7c830d1f46fabebc3b3cddc6b318.png"><br><br>       bin     MyFiles   ,     .         FinReportWebService_Files,   . <br><br> ,  getReportInfo  ,    : <br><br>   - <br>     Cars.txt <br>     <br>        <br>     FinReportWebService_Files <br>        <br>        <br><br>   -  IIS,              : <br><blockquote> dirRoot = C:\CommonFolder\publish_FinReport <br> fileCars = C:\CommonFolder\publish_FinReport\bin\MyFiles\Cars.txt <br> Line 1 = Audi <br> Access to the path 'C:\CommonFolder\publish_FinReport\bin\MyFiles\Cars.txt' is denied. <br> dirFiles = C:\CommonFolder\FinReportWebService_Files <br> Access to the path 'C:\CommonFolder\FinReportWebService_Files' is denied. <br></blockquote>           .       <a href="https://habr.com/ru/post/254165/">19.   IIS.</a> <br><br><a name="trick_08"></a><h3> <b>8. web.config</b> </h3><br>  web.config      ASP.NET .          ASP.NET ,      asmx -.             . ,  ,     ASP.NET . <br><br><h5> <b>web.config</b> </h5><br>   web.config  : <br><blockquote> <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font> <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><br> <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font> <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportType</font> " <font color="blue">&nbsp;</font> <font color="red">value</font> <font color="blue">=</font> " <font color="blue">8</font> " <font color="blue">/&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font> <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportSubject</font> " <font color="blue">&nbsp;</font> <font color="red">value</font> <font color="blue">=</font> " <font color="blue"></font> <font color="blue">&nbsp;</font> <font color="blue"></font> " <font color="blue">/&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br><br> <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font> <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font> <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">/&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font> <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br> <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote>          compilation. <br><br>          ,           .    ,    : <br><blockquote> <font color="blue">using</font> System; <br>  <font color="blue">using</font> System.Collections.Generic; <br>  <font color="blue">using</font> System.Configuration; <br><br>  <font color="blue">namespace</font> FinReportWebService { <br>  <font color="blue">internal</font> <font color="blue">static</font> <font color="blue">class</font> <font color="#2B91AF">WebConfig</font> { <br><br>  <font color="blue">public</font> <font color="blue">static</font> <font color="blue">int</font> ReportType { <font color="blue">get</font> { <font color="blue">return</font> getStructureValue &lt; <font color="blue">int</font> &gt; ( <font color="#A31515">"ReportType"</font> );  }} <br>  <font color="blue">public</font> <font color="blue">static</font> <font color="blue">string</font> ReportSubject { <font color="blue">get</font> { <font color="blue">return</font> getTextValue ( <font color="#A31515">"ReportSubject"</font> );  }} <br>  <font color="blue">public</font> <font color="blue">static</font> <font color="blue">string</font> DbLogin { <font color="blue">get</font> { <font color="blue">return</font> getTextValue ( <font color="#A31515">"DbLogin"</font> , <font color="blue">true</font> );  }} <br>  <font color="blue">public</font> <font color="blue">static</font> <font color="blue">string</font> DbPass { <font color="blue">get</font> { <font color="blue">return</font> getTextValue ( <font color="#A31515">"DbPass"</font> , <font color="blue">true</font> );  }} <br><br>  <font color="green">// =============================================== ==========</font> <br><br>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">string</font> getTextValue ( <font color="blue">string</font> name, <font color="blue">bool</font> getDefaultOnNotFound = <font color="blue">false</font> ) { <br>  <font color="blue">string</font> value = <font color="#2B91AF">ConfigurationManager</font> .AppSettings [name]; <br><br>  <font color="blue">if</font> (value == <font color="blue">null</font> &amp;&amp;! getDefaultOnNotFound) { <br>  <font color="blue">throw</font> <font color="blue">new</font> <font color="#2B91AF">KeyNotFoundException</font> ( <font color="#A31515">"</font> <font color="#A31515">In</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">the</font> <font color="#A31515">web.config file is</font> <font color="#A31515">not</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">found</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">setting</font> <font color="#A31515">""</font> + name + <font color="#A31515">"" "</font> ); <br>  } <br><br>  <font color="blue">return</font> value; <br>  } <br><br><br>  <font color="blue">private</font> <font color="blue">static</font> T getStructureValue &lt;T&gt; ( <font color="blue">string</font> name, <font color="blue">bool</font> getDefaultOnNotFound = <font color="blue">false</font> ) <font color="blue">where</font> T: <font color="blue">struct</font> { <br>  <font color="blue">string</font> textValue = getTextValue (name, getDefaultOnNotFound); <br><br>  <font color="blue">if</font> (textValue == <font color="blue">null</font> ) { <br>  <font color="blue">return</font> <font color="blue">default</font> (T); <br>  } <br><br>  <font color="blue">try</font> { <br>  T value = (T) <font color="#2B91AF">Convert</font> .ChangeType (textValue, <font color="blue">typeof</font> (T)); <br>  <font color="blue">return</font> value; <br><br>  } <font color="blue">catch</font> ( <font color="#2B91AF">Exception</font> ex) { <br>  <font color="blue">string</font> message = <font color="#A31515">"In the web.config file, the setting '{0}' with the value '{1}' could not be parsed as '{2}'"</font> ; <br>  message = <font color="blue">string</font> .Format (message, name, textValue, <font color="blue">typeof</font> (T) .Name); <br>  <font color="blue">throw</font> <font color="blue">new</font> <font color="#2B91AF">InvalidCastException</font> (message, ex); <br>  } <br>  } <br><br>  } <br>  } <br></blockquote><br>  And finally, in the FinReportService.cs file, replace the getReportInfo method with this code: <br><blockquote>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">string</font> getReportInfo ( <font color="blue">int</font> reportID) { <br>  <font color="#2B91AF">StringBuilder</font> sb = <font color="blue">new</font> <font color="#2B91AF">StringBuilder</font> (); <br>  <font color="blue">try</font> { <br>  sb.Append ( <font color="#A31515">"ReportType ="</font> ) .AppendLine ( <font color="#2B91AF">WebConfig</font> .ReportType.ToString ()); <br>  sb.Append ( <font color="#A31515">"ReportSubject ="</font> ) .AppendLine ( <font color="#2B91AF">WebConfig</font> .ReportSubject); <br>  sb.Append ( <font color="#A31515">"DbLogin ="</font> ) .AppendLine ( <font color="#2B91AF">WebConfig</font> .DbLogin); <br>  sb.Append ( <font color="#A31515">"DbPass ="</font> ) .AppendLine ( <font color="#2B91AF">WebConfig</font> .DbPass); <br><br>  } <font color="blue">catch</font> ( <font color="#2B91AF">Exception</font> ex) { <br>  sb.AppendLine (ex.Message); <br>  } <br><br>  <font color="blue">return</font> sb.ToString (); <br>  } <br></blockquote>  Now you can test the read configuration. <br><br><h5>  <b>web_alpha.config</b> </h5><br>  Go ahead, a very useful feature is the ability to place some of the settings in an additional file.  For example, when the test and combat environments differ in the connection string to the database.  It also allows you to store the secret part of the settings separately.  In this case, the duplicate settings are overridden by this file and new ones can also be declared in it. <br><br>  Add the <b>web_alpha.config</b> file to the project: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportSubject</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">Small</font> <font color="blue">&nbsp;</font>  <font color="blue">business</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">DbLogin</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">reader</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">DbPass</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">uYE4_wn7xc5Sp</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br></blockquote>  And change <b>web.config</b> itself to: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&nbsp;</font>  <font color="red">file</font> <font color="blue">=</font> " <font color="blue">web_alpha.config</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportType</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">8</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportSubject</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">Medium</font> <font color="blue">&nbsp;</font>  <font color="blue">business</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font>  <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote><br><h5>  <b>web_beta.config</b> </h5><br>  The third-party file can be located in the parent folder.  Create a new <b>web_beta.config</b> file in the parent folder: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportSubject</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">Large</font> <font color="blue">&nbsp;</font>  <font color="blue">business</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">DbLogin</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">admin</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">DbPass</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">guXu4awewr $ w</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br></blockquote>  Change the <b>web.config</b> accordingly to: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&nbsp;</font>  <font color="red">file</font> <font color="blue">=</font> " <font color="blue">..</font> <font color="blue">/web_beta.config</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportType</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">8</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportSubject</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">Medium</font> <font color="blue">&nbsp;</font>  <font color="blue">business</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font>  <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote><br><h5>  <b>web_gamma.config</b> </h5><br>  There is an alternative way of placing the settings in an additional file.  Change <b>web.config</b> to: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&nbsp;</font>  <font color="red">configSource</font> <font color="blue">=</font> " <font color="blue">web_gamma.config</font> " <font color="blue">/&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font>  <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote>  And create the <b>web_gamma.config</b> file: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportType</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">9</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportSubject</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">Noncommercial</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">DbLogin</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">writer</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">DbPass</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">hQ5zGPPSrkqqfsb</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br></blockquote>  This approach is less flexible, as it has a number of major differences from the previous one: <br><ul><li>  All values ‚Äã‚Äãof the settings section are defined only in the specified third-party file.  No override of web.config. </li><li>  The web_gamma.config file must exist, in the case of web_alpha.config it is optional. </li><li>  Its modification will lead to a restart of the pool; in the case of web_alpha.config, it will not. </li><li>  Apply to other sections, not just &lt;appSettings&gt; </li></ul><br><br><h5>  <b>web.Debug.config</b> </h5><br>  Now we will describe another useful web.config technique that appeared in Visual Studio 2010. We are talking about the <b>web.Debug.config</b> and <b>web.Release.config files</b> .  These files transform web.config <b>when publishing</b> depending on the current build type.  Change the contents of these files to the following: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns</font> <font color="red">:</font> <font color="red">xdt</font> <font color="blue">=</font> " <font color="blue">http</font> <font color="blue">: //</font> <font color="blue">schemas</font> <font color="blue">.</font> <font color="blue">microsoft</font> <font color="blue">.</font> <font color="blue">com</font> <font color="blue">/</font> <font color="blue">XML</font> <font color="blue">-</font> <font color="blue">Document</font> <font color="blue">-</font> <font color="blue">Transform</font> " <font color="blue">&gt;</font> <br><br><font color="blue">&nbsp;&nbsp;</font>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportSubject</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">debag</font> " <font color="blue">&nbsp;&nbsp;</font>  <font color="red">xdt: Transform</font> <font color="blue">=</font> " <font color="blue">Replace</font> " <font color="blue">&nbsp;</font>  <font color="red">xdt: Locator</font> <font color="blue">=</font> " <font color="blue">Match (key)</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;</font><br></blockquote><br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: xdt</font> <font color="blue">=</font> " <font color="blue">http://schemas.microsoft.com/XML-Document-Transform</font> " <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">xdt: Transform</font> <font color="blue">=</font> " <font color="blue">RemoveAttributes</font> <font color="blue">(debug)</font> " <font color="blue">/&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote><br>  The conversion syntax is described on <a href="https://msdn.microsoft.com/ru-ru/library/dd465326(VS.100).aspx">MSDN</a> . <br><br>  But even without knowing the syntax, it can be understood that in the case of <b>Debug</b> , the value of the <b>ReportSubject</b> setting is <b>replaced</b> , and in the case of <b>Release</b> , the <b>debug = ‚Äútrue‚Äù</b> attribute is deleted.  By the way, do not forget to delete the attribute debug = ‚Äútrue‚Äù in production or set it to false, this improves performance and security. <br><br>  In addition, you can create your own <b>web.Habr.config</b> transformation via the <b>Build -&gt; Configuration Manager</b> menu, and the <b>Add Config Transoforms</b> web.config file's context menu. <br><br><h5>  <b>MaxRequestLength</b> </h5><br>  From the general settings for ASP.NET I want to highlight the limit on the maximum size of the incoming request.  It is equal to the smaller of the two parameters.  Moreover, maxRequestLength is specified in kilobytes, and maxAllowedContentLength in bytes.  Here is an example for setting a limit of 100 megabytes, as well as 30 minutes of execution of the request. <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportType</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">8</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">ReportSubject</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">Medium</font> <font color="blue">&nbsp;</font>  <font color="blue">business</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br><br><font color="blue">&nbsp;&nbsp;</font><br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;! -</font> <font color="green">100</font> <font color="green">mb</font> <font color="green">&nbsp;</font>  <font color="green">and</font> <font color="green">30</font> <font color="green">minutes</font> <font color="green">(</font> <font color="green">valid</font> <font color="green">&nbsp;</font>  <font color="green">only</font> <font color="green">&nbsp;</font>  <font color="green">with</font> <font color="green">compilation.debug = false) <font color="blue">-&gt;</font></font> <br>  <font color="blue">&lt;</font> <font color="#A31515">httpRuntime</font> <font color="blue">&nbsp;</font>  <font color="red">maxRequestLength</font> <font color="blue">=</font> " <font color="blue">102400</font> " <font color="blue">&nbsp;</font>  <font color="red">executionTimeout</font> <font color="blue">=</font> " <font color="blue">1800</font> " <font color="blue">/&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">compilation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">system.webServer</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">security</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">requestFiltering</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;! -</font> <font color="green">100</font> <font color="green">mb</font> <font color="blue">-&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">requestLimits</font> <font color="blue">&nbsp;</font>  <font color="red">maxAllowedContentLength</font> <font color="blue">=</font> " <font color="blue">104857600</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">requestFiltering</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">security</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.webServer</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote><br><br>  Their default values ‚Äã‚Äãare 4096 KB and 30000000 bytes, that is, 4 MB and 28.61 MB <br><br><h5>  <b>Web.config Hierarchy</b> </h5><br>  In fact, this web.config is at the very bottom of the hierarchy of config files. <br><br>  The top level of configuration is the <b>machine.config file</b> .  Its settings act globally on all web applications only if they are not redefined by lower-level config files.  For .net 4 pools, it is located in the <b>% windir% \ Microsoft.NET \ Framework \ v4.0.30319 \ Config</b> or <b>% windir% \ Microsoft.NET \ Framework64 \ v4.0.30319 \ Config folder</b> , depending on the bit depth. <br><br>  The next level is also global - this is the <b>web.config file</b> located there. <br><br>  The third level is the level of the website, by default it is the folder <b>\ inetpub \ wwwroot</b> , and initially there is not even a web.config file. <br><br>  The fourth is the web application tier, the standard tier described here. <br><br>  There is also a fifth level - when web.config settings are applied to subfolders of a web application, but this is true for other types of web applications. <br><br>  You can read more on <a href="https://msdn.microsoft.com/en-us/library/ms178685(v%3Dvs.140).aspx">MSDN</a> <br><br><a name="trick_09"></a><h3>  <b>9. Multiple asmx files</b> </h3><br>  In one web application there can be not one, but several asmx files.  Obviously, this way you can develop several different web services that will have some common source code.  However, this technique can also be used for a single web service, the example below shows why. <br><br>  In the FinReportService.cs file, change the code to the following: <br><blockquote>  <font color="blue">using</font> System; <br>  <font color="blue">using</font> System.Configuration; <br>  <font color="blue">using</font> System.Web.Services; <br><br>  <font color="blue">namespace</font> FinReportWebService { <br><br>  [ <font color="#2B91AF">WebServiceBinding</font> (ConformsTo = <font color="#2B91AF">WsiProfiles</font> .BasicProfile1_1)] <br>  [ <font color="#2B91AF">WebService</font> (Description = <font color="#A31515">"</font> <font color="#A31515">Fin</font> <font color="#A31515">.</font> <font color="#A31515">Reports</font> <font color="#A31515">v.2"</font> , Namespace = XmlNS)] <br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReportService_v2</font> : <font color="#2B91AF">FinReportService</font> { <br>  <font color="blue">public</font> FinReportService_v2 (): <font color="blue">base</font> (2) { <br>  } <br>  } <br><br><br><br>  [ <font color="#2B91AF">WebServiceBinding</font> (ConformsTo = <font color="#2B91AF">WsiProfiles</font> .BasicProfile1_1)] <br>  [ <font color="#2B91AF">WebService</font> (Description = <font color="#A31515">"CHECK:</font> <font color="#A31515">Fin</font> <font color="#A31515">.</font> <font color="#A31515">Reports</font> <font color="#A31515">"</font> , Namespace = <font color="#2B91AF">FinReportService</font> .XmlNS)] <br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReportService_Check</font> { <br>  <font color="blue">private</font> <font color="#2B91AF">FinReportService</font> _service; <br><br>  <font color="blue">public</font> FinReportService_Check () { <br>  _service = <font color="blue">new</font> <font color="#2B91AF">FinReportService</font> (); <br>  } <br><br>  [ <font color="#2B91AF">WebMethod</font> (Description = <font color="#A31515">"</font> <font color="#A31515">Enter</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">identifier</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">report</font> <font color="#A31515">. "</font> )] <br>  <font color="blue">public</font> <font color="#2B91AF">GetReportResult</font> GetReport ( <font color="blue">int</font> reportID) { <br>  <font color="#2B91AF">GetReportArg</font> arg = <font color="blue">new</font> <font color="#2B91AF">GetReportArg</font> (); <br>  arg.ReportID = reportID; <br>  <font color="blue">return</font> _service.GetReport (arg); <br>  } <br><br>  [ <font color="#2B91AF">WebMethod</font> (Description = <font color="#A31515">"</font> <font color="#A31515">Period</font> <font color="#A31515">:</font> <font color="#A31515">January</font> <font color="#A31515">2015.</font> <font color="#A31515">"</font> )] <br>  <font color="blue">public</font> <font color="#2B91AF">GetReportIdArrayResult</font> GetReportIdArray () { <br>  <font color="#2B91AF">GetReportIdArrayArg</font> arg = <font color="blue">new</font> <font color="#2B91AF">GetReportIdArrayArg</font> (); <br>  arg.DateBegin = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 01, 01); <br>  arg.DateEnd = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 02, 01); <br>  <font color="blue">return</font> _service.GetReportIdArray (arg); <br>  } <br>  } <br><br><br><br>  [ <font color="#2B91AF">WebServiceBinding</font> (ConformsTo = <font color="#2B91AF">WsiProfiles</font> .BasicProfile1_1)] <br>  [ <font color="#2B91AF">WebService</font> (Description = <font color="#A31515">"</font> <font color="#A31515">Fin</font> <font color="#A31515">.</font> <font color="#A31515">Reports</font> <font color="#A31515">"</font> , Namespace = XmlNS)] <br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReportService</font> : <font color="#2B91AF">WebService</font> { <br>  <font color="blue">public</font> <font color="blue">const</font> <font color="blue">string</font> XmlNS = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> ; <br>  <font color="blue">private</font> <font color="blue">int</font> _version; <br><br>  <font color="blue">public</font> FinReportService () { <br>  _version = 1; <br>  } <br><br>  <font color="blue">public</font> FinReportService ( <font color="blue">int</font> version) { <br>  _version = version; <br>  } <br><br>  [ <font color="#2B91AF">WebMethod</font> (Description = <font color="#A31515">"</font> <font color="#A31515">Getting</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">report</font> <font color="#A31515">ID</font> <font color="#A31515">list</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">by</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">period</font> <font color="#A31515">"</font> )] <br>  <font color="blue">public</font> <font color="#2B91AF">GetReportIdArrayResult</font> GetReportIdArray ( <font color="#2B91AF">GetReportIdArrayArg</font> arg) { <br>  <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">GetReportIdArrayResult</font> () { <br>  ReportIdArray = <font color="blue">new</font> <font color="blue">int</font> [] {357, 358, 360, 361} <br>  }; <br>  } <br><br>  [ <font color="#2B91AF">WebMethod</font> (Description = <font color="#A31515">"</font> <font color="#A31515">Getting</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">report</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">by</font> <font color="#A31515">id "</font> )] <br>  <font color="blue">public</font> <font color="#2B91AF">GetReportResult</font> GetReport ( <font color="#2B91AF">GetReportArg</font> arg) { <br>  <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">GetReportResult</font> () { <br>  Report = <font color="blue">new</font> <font color="#2B91AF">FinReport</font> { <br>  ReportID = arg.ReportID, <br>  Date = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 03, 15), <br>  Info = <font color="#A31515">"Phone:"</font> + <font color="#2B91AF">ConfigurationManager</font> .AppSettings [ <font color="#A31515">"phone"</font> ] + <font color="#A31515">"Version:"</font> + _version <br>  } <br>  }; <br>  } <br>  } <br><br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReport</font> { <br>  <font color="blue">public</font> <font color="blue">int</font> ReportID { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="#2B91AF">DateTime</font> Date { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="blue">string</font> Info { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportIdArrayArg</font> { <br>  <font color="blue">public</font> <font color="#2B91AF">DateTime</font> DateBegin { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="#2B91AF">DateTime</font> DateEnd { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportIdArrayResult</font> { <br>  <font color="blue">public</font> <font color="blue">int</font> [] ReportIdArray { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportArg</font> { <br>  <font color="blue">public</font> <font color="blue">int</font> ReportID { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportResult</font> { <br>  <font color="blue">public</font> <font color="#2B91AF">FinReport</font> Report { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br>  } <br></blockquote>  Also in the project should be the following 3 asmx files: <br>  <b>FinReport.asmx</b> - no change: <br><blockquote>  &lt;% <font color="blue">@</font> <font color="red">Class</font> <font color="blue">= "FinReportWebService.FinReportService"</font> %&gt; <br></blockquote>  <b>FinReport_v2.asmx</b> - new: <br><blockquote>  &lt;% <font color="blue">@</font> <font color="red">Class</font> <font color="blue">= "FinReportWebService.FinReportService_v2"</font> %&gt; <br></blockquote>  <b>FinReport_CHECK.asmx</b> - new: <br><blockquote>  &lt;% <font color="blue">@</font> <font color="red">Class</font> <font color="blue">= "FinReportWebService.FinReportService_Check"</font> %&gt; <br></blockquote>  And change web.config to: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font>  <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">phone</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">nokia</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font><br><br>  <font color="blue">&lt;</font> <font color="#A31515">location</font> <font color="blue">&nbsp;</font>  <font color="red">path</font> <font color="blue">=</font> " <font color="blue">FinReport.asmx</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">phone</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">samsung</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">location</font> <font color="blue">&gt;</font> <br><br><br>  <font color="blue">&lt;</font> <font color="#A31515">location</font> <font color="blue">&nbsp;</font>  <font color="red">path</font> <font color="blue">=</font> " <font color="blue">FinReport_v2.asmx</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">phone</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">htc</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">location</font> <font color="blue">&gt;</font> <br><br><font color="blue">&nbsp;&nbsp;</font><br>  <font color="blue">&lt;</font> <font color="#A31515">location</font> <font color="blue">&nbsp;</font>  <font color="red">path</font> <font color="blue">=</font> " <font color="blue">FinReport_CHECK.asmx</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">key</font> <font color="blue">=</font> " <font color="blue">phone</font> " <font color="blue">&nbsp;</font>  <font color="red">value</font> <font color="blue">=</font> " <font color="blue">apple</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">appSettings</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">webServices</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">protocols</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">clear</font> <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">Documentation</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">HttpPostLocalhost</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">protocols</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">webServices</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">location</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote>  As you can see, two new asmx files refer to two new classes.  First I will explain the purpose of the FinReportService_v2 class.  Its only functional difference from the base class is that its default constructor initializes the int _version field with a value of 2, not 1. Thus, the web service has a clone that has exactly the same contract, but there are differences in processing requests.  For example, this clone may be intended for testing or actually represent a new version. <br><br>  The FinReportService_Check class has a completely different purpose.  As you know, if you open a web service in a browser from localhost, then for web methods with primitive argument types, you can make a request and see the answer directly in the browser itself.  This allows you, the admin and everyone who has access to the server, to easily verify that it is working correctly. <br><br><img src="https://habrastorage.org/files/81c/31a/338/81c31a3384484447867807cdab8e18f6.png"><br><br><img src="https://habrastorage.org/files/fed/13d/eed/fed13deeda5540a2a843984a678dcfd2.png"><br>  Now I will comment on the config file.  Using the design, you can override any settings for a specific file.  In this case, different asmx files will have different values ‚Äã‚Äãfor the ‚Äúphone‚Äù custom setting. <br><br>  Using the &lt;protocols&gt; section, we first clear all the ways to interact with FinReport_CHECK.asmx, and then add the view and call to localhost.  This makes remote access impossible. <br><br><a name="trick_10"></a><h3>  <b>10. Replacing a web page</b> </h3><br>  By default, the asmx web page of the web service that you see in the browser is created using the DefaultWsdlHelpGenerator.aspx web form, which for x64 is located in the% windir% \ Microsoft.NET \ Framework64 \ v4.0.30319 \ Config folder, I recommend to familiarize yourself with it . <br><br>  However, using web.config it is easy to specify your own aspx file.  Add the FinReportPage.aspx file to the project: <br><blockquote>  <font color="blue">&lt;!</font>  <font color="maroon">doctype</font> <font color="red">html</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">html</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">head</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">meta</font> <font color="red">charset</font> <font color="blue">= utf-8&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">title</font> <font color="blue">&gt;</font> Welcome <font color="blue">&lt;/</font> <font color="maroon">title</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="maroon">head</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">body</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="maroon">p</font> <font color="blue">&gt;</font> Welcome!  <font color="blue">&lt;</font> <font color="blue">/</font> <font color="maroon">p</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="maroon">body</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="maroon">html</font> <font color="blue">&gt;</font> </blockquote>  And specify in web.config <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">webServices</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">wsdlHelpGenerator</font> <font color="blue">&nbsp;</font>  <font color="red">href</font> <font color="blue">=</font> " <font color="blue">FinReportPage.aspx</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">webServices</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font>  <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">/&gt;</font> <br><br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> </blockquote><br><br><a name="trick_11"></a><h3>  <b>11. Replacing the extension</b> </h3><br>  Using web.config, you can easily change the asmx extension to any other.  Add a file with the habr extension to the project, for example, <b>FinReportClone.habr</b> , with the same content as FinReport.asmx.  And change the config to the following: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font>  <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">buildProviders</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">remove</font> <font color="blue">&nbsp;</font>  <font color="red">extension</font> <font color="blue">=</font> " <font color="blue">.habr</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">extension</font> <font color="blue">=</font> " <font color="blue">.habr</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">System.Web.Compilation.WebServiceBuildProvider</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">buildProviders</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">compilation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">system.webServer</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">handlers</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">HabraHandler</font> " <font color="blue">&nbsp;</font>  <font color="red">verb</font> <font color="blue">=</font> " <font color="blue">*</font> " <font color="blue">&nbsp;</font>  <font color="red">path</font> <font color="blue">=</font> " <font color="blue">* .habr</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">System.Web.Services.Protocols.WebServiceHandlerFactory</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">handlers</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.webServer</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote>  I will note that when launched from Visual Studio, FinReportClone.habr will not work, for this you need to make a publication in IIS.  By the way, using this technique, you can replace the ASMX web service with a WCF web service while preserving the original URL. <br><br><a name="trick_12"></a><h3>  <b>12. Hiding wsdl</b> </h3><br>  By default, a wsdl description of any SOAP web service is available by adding? Wsdl to its URL.  This means that anyone who knows and sees this address can easily invoke its web methods.  And if it does not have an authorization mechanism, it can be very insecure.  But even if such a mechanism exists, it is generally undesirable to show the contract of your web service. <br><br>  <b>1 way.</b>  Add the following setting to web.config: <br><blockquote><font color="blue">&nbsp;&nbsp;</font>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">webServices</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">protocols</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">remove</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">Documentation</font> " <font color="blue">/&gt;</font> <br><font color="blue">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">&lt;/</font> <font color="#A31515">protocols</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">webServices</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system</font> <font color="#A31515">.</font>  <font color="#A31515">web</font> <font color="blue">&gt;</font> <br></blockquote>  This is the standard way to hide web service information.  In fact, it simply prohibits GET requests.  Attempting to open the address in the browser will result in an exception, while POST requests for web methods work as usual.  The uncritical minus of this method is what the browser says about the error. <br><br><img src="https://habrastorage.org/files/c91/b6b/e01/c91b6be01e94480a985fa69a5d1a09a7.png"><br><br>  <b>2 way.</b>  GET requests can be intercepted using a custom HTTP handler.  Add the following class to the project: <br><blockquote>  <font color="blue">using</font> System.Web; <br>  <font color="blue">namespace</font> FinReportWebService { <br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReportGetHandler</font> : <font color="#2B91AF">IHttpHandler</font> { <br>  <font color="blue">public</font> <font color="blue">void</font> ProcessRequest ( <font color="#2B91AF">HttpContext</font> context) { <br>  <font color="blue">string</font> response = <br>  <font color="#A31515">@ "&lt;! doctype html&gt;</font> <br>  <font color="#A31515">&lt;html&gt;</font> <br>  <font color="#A31515">&lt;head&gt;</font> <br>  <font color="#A31515">&lt;meta charset = utf-8&gt;</font> <br>  <font color="#A31515">&lt;/ head&gt;</font> <br>  <font color="#A31515">&lt;body&gt;</font> <br>  <font color="#A31515">&lt;p&gt; {0} &lt;/ p&gt;</font> <br>  <font color="#A31515">&lt;/ body&gt;</font> <br>  <font color="#A31515">&lt;/ html&gt; "</font> ; <br><br>  <font color="blue">bool</font> wsdlRequested = (context.Request.QueryString.ToString (). ToLower () == <font color="#A31515">"wsdl"</font> ); <br><br>  <font color="blue">if</font> (wsdlRequested) { <br>  response = <font color="blue">string</font> .Format (response, <font color="#A31515">"</font> <font color="#A31515">Refer</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">to</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">administrator</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">for</font> <font color="#A31515">wsdl. "</font> ); <br>  } <font color="blue">else</font> { <br>  response = <font color="blue">string</font> .Format (response, <font color="#A31515">"</font> <font color="#A31515">Web</font> <font color="#A31515">service</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">financial</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">reporting</font> <font color="#A31515">. "</font> ) <br>  } <br><br>  context.Response.ContentType = <font color="#A31515">"text / html; charset = utf-8"</font> ; <br>  context.Response.Write (response); <br><br>  <font color="green">// string filePage = HttpContext.Current.Server.MapPath ("~ / FinReportPage.htm");</font> <br>  <font color="green">// context.Response.WriteFile (filePage);</font> <br>  } <br><br>  <font color="blue">public</font> <font color="blue">bool</font> IsReusable { <br>  <font color="blue">get</font> { <font color="blue">return</font> <font color="blue">false</font> ;  } <br>  } <br>  } <br>  } </blockquote>  And change the web.config: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font><br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font>  <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">compilation</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><br>  <font color="blue">&lt;</font> <font color="#A31515">system.webServer</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">handlers</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">add</font> <font color="blue">&nbsp;</font>  <font color="red">name</font> <font color="blue">=</font> " <font color="blue">FinReportGetHandler</font> " <font color="blue">&nbsp;</font>  <font color="red">verb</font> <font color="blue">=</font> " <font color="blue">GET</font> " <font color="blue">&nbsp;</font>  <font color="red">path</font> <font color="blue">=</font> " <font color="blue">FinReport.asmx</font> " <font color="blue">&nbsp;</font>  <font color="red">type</font> <font color="blue">=</font> " <font color="blue">FinReportWebService.FinReportGetHandler</font> " <font color="blue">/&gt;</font> <br><font color="blue">&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">&lt;/</font> <font color="#A31515">handlers</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.webServer</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote><br>  Just as in the previous technique, the handler will only work in IIS.  By the way, a web page is better not to hardcod, but to read from a file. <br><br><a name="trick_13"></a><h3>  <b>13. Exceptions</b> </h3><br>  Handling exceptions in a web service is always very important.  Building a successful mechanism for identifying and returning errors will save a lot of time and nerves for developers on both sides.  Below are two different ways to inform the web service client that something went wrong. <br><br><h5>  <b>&lt;soap: Fault&gt;</b> </h5><br>  The &lt;soap: Fault&gt; element is a standard way for SOAP to return an error.  It consists of four sub-elements: <br><ul><li>  &lt;faultcode&gt; - error code </li><li>  &lt;faultstring&gt; - human-readable error description </li><li>  &lt;faultactor&gt; - source of error </li><li>  &lt;detail&gt; - arbitrary XML structure for detailed data </li></ul><br>  &lt;faultcode&gt; and &lt;faultstring&gt; are mandatory, the other two are optional. <br>  To demonstrate it, change the getReportInfo method to the following code: <br><blockquote>  <font color="blue">private</font> <font color="blue">string</font> getReportInfo ( <font color="blue">int</font> reportID) { <br>  throwException_1 (); <br>  <font color="green">// throwException_2 ();</font> <br>  <font color="green">// throwException_3 ();</font> <br>  <font color="blue">return</font> <font color="#A31515">"ReportID ="</font> + reportID; <br>  } <br><br><br>  <font color="blue">private</font> <font color="blue">void</font> throwException_1 () { <br>  <font color="blue">int</font> x = 0; <br>  x = 1 / x; <br>  } <br><br><br>  <font color="blue">private</font> <font color="blue">void</font> throwException_2 () { <br>  <font color="blue">throw</font> <font color="blue">new</font> <font color="#2B91AF">SoapException</font> ( <font color="#A31515">"</font> <font color="#A31515">Incorrect</font> <font color="#A31515">ReportID"</font> , <font color="#2B91AF">SoapException</font> .ClientFaultCode, Context.Request.Url.AbsoluteUri); <br>  } <br><br><br>  <font color="blue">private</font> <font color="blue">void</font> throwException_3 () { <br>  <font color="#2B91AF">XmlDocument</font> xmlDoc = <font color="blue">new</font> <font color="#2B91AF">XmlDocument</font> (); <br>  <font color="#2B91AF">XmlNode</font> rootNode = xmlDoc. CreateNode ( <font color="#2B91AF">XmlNodeType.</font> Element, <font color="#2B91AF">SoapException.</font> DetailElementName. Name, <font color="#2B91AF">SoapException.</font> DetailElementName. Namespace); <br><br>  <font color="#2B91AF">XmlNode</font> descNode = xmlDoc. CreateNode ( <font color="#2B91AF">XmlNodeType.</font> Element, <font color="#A31515">"Description"</font> , XmlNS); <br><br>  <font color="#2B91AF">XmlNode</font> descTypeNode = xmlDoc. CreateNode ( <font color="#2B91AF">XmlNodeType.</font> Element, <font color="#A31515">"Type"</font> , XmlNS); <br>  descTypeNode.InnerText = <font color="#A31515">"DbConnection"</font> ; <br>  descNode.AppendChild (descTypeNode); <br><br>  <font color="#2B91AF">XmlNode</font> descMessageNode = xmlDoc. CreateNode ( <font color="#2B91AF">XmlNodeType.</font> Element, <font color="#A31515">"Message"</font> , XmlNS); <br>  descMessageNode.InnerText = <font color="#A31515">"</font> <font color="#A31515">Host</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">not</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">found</font> <font color="#A31515">. " <font color="windowtext">;</font></font> <br>  descNode.AppendChild (descMessageNode); <br><br>  <font color="#2B91AF">XmlNode</font> habraNode = xmlDoc. CreateNode ( <font color="#2B91AF">XmlNodeType.</font> Element, <font color="#A31515">"HabraInfo"</font> , XmlNS); <br>  <font color="#2B91AF">XmlAttribute</font> habraNodeAttribute = xmlDoc.CreateAttribute ( <font color="#A31515">"User"</font> ); <br>  habraNodeAttribute.Value = <font color="#A31515">"capslocky"</font> ; <br>  habraNode.Attributes.Append (habraNodeAttribute); <br><br>  rootNode.AppendChild (descNode); <br>  rootNode.AppendChild (habraNode); <br><br>  <font color="#2B91AF">XmlQualifiedName</font> faultCode = <font color="blue">new</font> <font color="#2B91AF">XmlQualifiedName</font> ( <font color="#A31515">"TempError"</font> , XmlNS); <br>  <font color="blue">throw</font> <font color="blue">new</font> <font color="#2B91AF">SoapException</font> ( <font color="#A31515">"</font> <font color="#A31515">Temporary</font> <font color="#A31515">&nbsp;</font>  <font color="#A31515">error</font> <font color="#A31515">"</font> , faultCode, Context.Request.Url.AbsoluteUri, rootNode); <br>  } <br></blockquote>  Call the GetReport web method with throwException_1 (), which generates an unhandled divide-by-zero error.  ASP.NET DevServer (or IIS) in this case will return the http code ‚Äú500 Internal Server Error‚Äù instead of ‚Äú200 OK‚Äù and the following content, which is formatted for convenience: <br><blockquote><font color="#333333">&nbsp;</font><br>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font>  <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF-8</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: Envelope</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Fault</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">faultcode</font> <font color="blue">&gt;</font> soap: Server <font color="blue">&lt;/</font> <font color="#A31515">faultcode</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">faultstring</font> <font color="blue">&gt;</font> Server was unable to process request.  --- <font color="red">&amp; gt;</font>  Attempted to divide by zero.  <font color="blue">&lt;</font> <font color="blue">/</font> <font color="#A31515">faultstring</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">detail</font> <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">soap: Fault</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">soap: Body</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">soap: Envelope</font> <font color="blue">&gt;</font> <br></blockquote>  Unhandled exceptions always give soap: Server.  In this case, the display of the exception stack depends on the customErrors setting: <br><blockquote><font color="#333333">&nbsp;</font><br>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font><br>  <font color="blue">&lt;</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">compilation</font> <font color="blue">&nbsp;</font>  <font color="red">debug</font> <font color="blue">=</font> " <font color="blue">true</font> " <font color="blue">&nbsp;</font>  <font color="red">targetFramework</font> <font color="blue">=</font> " <font color="blue">4.0</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">customErrors</font> <font color="blue">&nbsp;</font>  <font color="red">mode</font> <font color="blue">=</font> " <font color="blue">On</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">system.web</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;&nbsp;</font><br>  <font color="blue">&lt;/</font> <font color="#A31515">configuration</font> <font color="blue">&gt;</font> <br></blockquote>  The mode attribute has only three possible values: <br><ul><li>  On - Never show stack </li><li>  Off - Always show </li><li>  RemoteOnly - Only show for localhost requests </li></ul><br>  With the manual SoapException throw-in, you can completely define the &lt;soap: Fault&gt; structure yourself.  Call the throwException_2 method.  This code will lead to the following response content <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font>  <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF</font> <font color="blue">-8</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: Envelope</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Fault</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">faultcode</font> <font color="blue">&gt;</font> soap: Client <font color="blue">&lt;/</font> <font color="#A31515">faultcode</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">faultstring</font> <font color="blue">&gt;</font> <font color="#A31515">Invalid</font> ReportID <font color="blue">&lt;/</font> <font color="#A31515">faultstring</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">faultactor</font> <font color="blue">&gt;</font> http: //win2012/custom_folder/FinReport.asmx <font color="blue">&lt;/</font> <font color="#A31515">faultactor</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">detail</font> <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">soap: Fault</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">soap: Body</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">soap: Envelope</font> <font color="blue">&gt;</font> <br></blockquote>  Here we changed the error code, wrote our text-explanation, and also indicated, which usually indicate the URL of the request. <br>  In general, there are four standard fault codes that are represented by static fields in the SoapException class: <br><ul><li>  Server - a problem in the web service itself </li><li>  Client - the client sent an incorrect request. </li><li>  MustUnderstand - do not remove the soap: Header required for processing </li><li>  VersionMismatch - incorrect version of SOAP </li></ul><br>  The throwException_3 () method demonstrates the formation of your own &lt;detail&gt; and error code: <br><blockquote>  <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font>  <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font>  <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF-8</font> " <font color="blue">?&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap: Envelope</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font>  <font color="red">xmlns: xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Fault</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">faultcode</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns: q0</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> q0: TempError <font color="blue">&lt;/</font> <font color="#A31515">faultcode</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">faultstring</font> <font color="blue">&gt;</font> Temporary Error <font color="blue">&lt;/</font> <font color="#A31515">faultstring</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">faultactor</font> <font color="blue">&gt;</font> http: //win2012/custom_folder/FinReport.asmx <font color="blue">&lt;/</font> <font color="#A31515">faultactor</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">detail</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">Description</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">Type</font> <font color="blue">&gt;</font> DbConnection <font color="blue">&lt;/</font> <font color="#A31515">Type</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">Message</font> <font color="blue">&gt;</font> Host not found.  <font color="blue">&lt;</font> <font color="blue">/</font> <font color="#A31515">Message</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">Description</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;</font> <font color="#A31515">HabraInfo</font> <font color="blue">&nbsp;</font>  <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&nbsp;</font>  <font color="red">User</font> <font color="blue">=</font> " <font color="blue">capslocky</font> " <font color="blue">/&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">detail</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">soap: Fault</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">soap: Body</font> <font color="blue">&gt;</font> <br>  <font color="blue">&lt;/</font> <font color="#A31515">soap</font> <font color="#A31515">:</font> <font color="#A31515">Envelope</font> <font color="blue">&gt;</font> <br></blockquote>  However, it is recommended not to allow the possibility of unhandled exceptions in the web methods at all.  That is, the method should always have a global try-catch, which will catch any unhandled or manually thrown exceptions, and return them to the client in a predetermined format, which can be represented both by &lt;soap: Fault&gt; and in the manner described below. <br><br><h5>  <b>enum</b> </h5><br>  The idea of ‚Äã‚Äãthis method is to use enums to tell the client about the successful or unsuccessful processing of his request.  It is important that all enumeration values ‚Äã‚Äãare reflected in wsdl, so they are automatically present in the client proxy class. <br><br>  Add the file FinReport_GetReport.cs to the project: <br><blockquote>  <font color="blue">using</font> System; <br><br>  <font color="blue">namespace</font> FinReportWebService { <br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">WebServiceError</font> { <br>  <font color="blue">public</font> <font color="#2B91AF">ErrorType</font> Type { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  <font color="blue">public</font> <font color="blue">string</font> Message { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br><br>  <font color="blue">public</font> <font color="blue">enum</font> <font color="#2B91AF">ResultType</font> { <br>  Error, <br>  FoundBasicData, <br>  FoundFullData <br>  } <br><br><br>  <font color="blue">public</font> <font color="blue">enum</font> <font color="#2B91AF">ErrorType</font> { <br>  Undefined <br>  Dbconnection <br>  InvalidArgument, <br>  Forbidden <br>  } <br><br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">WebServiceErrorException</font> : <font color="#2B91AF">Exception</font> { <br>  <font color="blue">public</font> <font color="#2B91AF">WebServiceError</font> Error { <font color="blue">get</font> ;  <font color="blue">set</font> ;  } <br>  } <br><br><br>  <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReport_GetReport</font> { <br>  <font color="blue">private</font> <font color="#2B91AF">GetReportArg</font> _arg; <br>  <font color="blue">private</font> <font color="#2B91AF">GetReportResult</font> _result; <br><br>  <font color="blue">public</font> <font color="#2B91AF">GetReportResult</font> GetReport ( <font color="#2B91AF">GetReportArg</font> arg) { <br>  _arg = arg; <br>  initializeResultWithError (); <br><br>  <font color="blue">try</font> { <br>  checkArg (); <br>  fillResult (); <br><br>  } <font color="blue">catch</font> ( <font color="#2B91AF">WebServiceErrorException</font> ex) { <br>  setResultType ( <font color="#2B91AF">ResultType</font> .Error); <br>  _result. Error = ex. Error; <br><br>  } <font color="blue">catch</font> ( <font color="#2B91AF">Exception</font> ex) { <br>  setResultType ( <font color="#2B91AF">ResultType</font> .Error); <br> _result.Error.Type = <font color="#2B91AF">ErrorType</font> .Undefined; <br> _result.Error.Message = ex.GetType() + <font color="#A31515">": "</font> +  ex.Message; <br>  } <br><br> <font color="blue">if</font> (_result.ResultType == <font color="#2B91AF">ResultType</font> .Error) { <br> _result.Report = <font color="blue">null</font> ; <br><br> } <font color="blue">else</font> { <br> _result.Error = <font color="blue">null</font> ; <br>  } <br><br> <font color="blue">return</font> _result; <br>  } <br><br><br> <font color="blue">private</font> <font color="blue">void</font> setResultType( <font color="#2B91AF">ResultType</font> type) { <br> _result.ResultType = type; <br>  } <br><br><br> <font color="blue">private</font> <font color="blue">void</font> initializeResultWithError() { <br> _result = <font color="blue">new</font> <font color="#2B91AF">GetReportResult</font> (); <br> setResultType( <font color="#2B91AF">ResultType</font> .Error); <br><br> _result.Error = <font color="blue">new</font> <font color="#2B91AF">WebServiceError</font> (); <br> _result.Error.Type = <font color="#2B91AF">ErrorType</font> .Undefined; <br> _result.Error.Message = <font color="#A31515">"  "</font> ; <br>  } <br><br><br> <font color="blue">private</font> <font color="blue">void</font> checkArg() { <br> <font color="blue">if</font> (_arg.ReportID &lt;= 0) { <br> <font color="blue">throw</font> <font color="blue">new</font> <font color="#2B91AF">WebServiceErrorException</font> () { <br> Error = <font color="blue">new</font> <font color="#2B91AF">WebServiceError</font> () { <br> Type = <font color="#2B91AF">ErrorType</font> .InvalidArgument, <br> Message = <font color="#A31515">"</font> <font color="#A31515"></font> <font color="#A31515">&nbsp;</font> <font color="#A31515"></font> <font color="#A31515">&nbsp;</font> <font color="#A31515"></font> <font color="#A31515">: "</font> + _arg.ReportID <br>  } <br>  }; <br>  } <br>  } <br><br><br> <font color="blue">private</font> <font color="blue">void</font> fillResult() { <br> _result.Report = <font color="blue">new</font> <font color="#2B91AF">FinReport</font> (); <br> _result.Report.ReportID = _arg.ReportID; <br> _result.Report.Date = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 03, 15); <br><br> <font color="green">//            throw new WebServiceErrorException() {</font> <br> <font color="green">//                Error = new WebServiceError() {</font> <br> <font color="green">//                    Type = ErrorType.DbConnection,</font> <br> <font color="green">//                    Message = "</font> <font color="green"></font> <font color="green">&nbsp;</font> <font color="green"></font> <font color="green">&nbsp;</font> <font color="green"></font> <font color="green">"</font> <br> <font color="green">//                }</font> <br> <font color="green">//            };</font> <br><br> <font color="green">//            throw new InvalidOperationException("</font> <font color="green"></font> <font color="green">");</font> <br><br> _result.Report.Info = <font color="#A31515">"Some info"</font> ; <br> setResultType( <font color="#2B91AF">ResultType</font> .FoundFullData); <br>  } <br><br>  } <br>  } <br></blockquote> - GetReport   <br><blockquote> [ <font color="#2B91AF">WebMethod</font> (Description = <font color="#A31515">"   ID"</font> )] <br> <font color="blue">public</font> <font color="#2B91AF">GetReportResult</font> GetReport( <font color="#2B91AF">GetReportArg</font> arg) { <br> <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">FinReport_GetReport</font> ().GetReport(arg); <br>  } <br></blockquote>     GetReportResult <br><blockquote> <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportResult</font> { <br> <font color="blue">public</font> <font color="#2B91AF">ResultType</font> ResultType { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br> <font color="blue">public</font> <font color="#2B91AF">WebServiceError</font> Error { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br> <font color="blue">public</font> <font color="#2B91AF">FinReport</font> Report { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br>  } <br></blockquote> ,    ResultType  ,      -      .             .        .        ¬´200 OK¬ª   GetReportResult. <br><br>  : <br><blockquote> <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font> <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font> <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF-8</font> " <font color="blue">?&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&nbsp;</font> <font color="red">xmlns:soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&nbsp;</font> <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">ResultType</font> <font color="blue">&gt;</font> FoundFullData <font color="blue">&lt;/</font> <font color="#A31515">ResultType</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Report</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">ReportID</font> <font color="blue">&gt;</font> 45 <font color="blue">&lt;/</font> <font color="#A31515">ReportID</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Date</font> <font color="blue">&gt;</font> 2015-03-15T00:00:00 <font color="blue">&lt;/</font> <font color="#A31515">Date</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Info</font> <font color="blue">&gt;</font> Some info <font color="blue">&lt;/</font> <font color="#A31515">Info</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">Report</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&gt;</font> <br><font color="#333333">&nbsp;</font><br><font color="#333333">&nbsp;</font><br> <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font> <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font> <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF-8</font> " <font color="blue">?&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&nbsp;</font> <font color="red">xmlns:soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&nbsp;</font> <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">ResultType</font> <font color="blue">&gt;</font> Error <font color="blue">&lt;/</font> <font color="#A31515">ResultType</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Error</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Type</font> <font color="blue">&gt;</font> DbConnection <font color="blue">&lt;/</font> <font color="#A31515">Type</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Message</font> <font color="blue">&gt;</font>    <font color="blue">&lt;/</font> <font color="#A31515">Message</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">Error</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&gt;</font> <br><font color="#333333">&nbsp;</font><br><font color="#333333">&nbsp;</font><br> <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font> <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font> <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF-8</font> " <font color="blue">?&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&nbsp;</font> <font color="red">xmlns:soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&nbsp;</font> <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">ResultType</font> <font color="blue">&gt;</font> Error <font color="blue">&lt;/</font> <font color="#A31515">ResultType</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Error</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Type</font> <font color="blue">&gt;</font> Undefined <font color="blue">&lt;/</font> <font color="#A31515">Type</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Message</font> <font color="blue">&gt;</font> System.InvalidOperationException:  <font color="blue">&lt;/</font> <font color="#A31515">Message</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">Error</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&gt;</font> <br><br><br> <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font> <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font> <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF-8</font> " <font color="blue">?&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&nbsp;</font> <font color="red">xmlns:soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&nbsp;</font> <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">ResultType</font> <font color="blue">&gt;</font> Error <font color="blue">&lt;/</font> <font color="#A31515">ResultType</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Error</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Type</font> <font color="blue">&gt;</font> InvalidArgument <font color="blue">&lt;/</font> <font color="#A31515">Type</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Message</font> <font color="blue">&gt;</font>   : -245 <font color="blue">&lt;/</font> <font color="#A31515">Message</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">Error</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&gt;</font> <br></blockquote>   ,   http-            -,  -  ,    soap:Fault    . <br><br><a name="trick_14"></a><h3> <b>14. soap:Header</b> </h3><br>     SOAP           .       ,    , ,     -   . <br><br>   -  : <br><blockquote> <font color="blue">using</font> System; <br> <font color="blue">using</font> System.Text; <br> <font color="blue">using</font> System.Web.Services; <br> <font color="blue">using</font> System.Web.Services.Protocols; <br><br> <font color="blue">namespace</font> FinReportWebService{ <br><br> [ <font color="#2B91AF">WebServiceBinding</font> (ConformsTo = <font color="#2B91AF">WsiProfiles</font> .BasicProfile1_1)] <br> [ <font color="#2B91AF">WebService</font> (Description = <font color="#A31515">"</font> <font color="#A31515"></font> <font color="#A31515">.</font> <font color="#A31515"></font> <font color="#A31515">"</font> , Namespace = XmlNS)] <br> <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReportService</font> : <font color="#2B91AF">WebService</font> { <br> <font color="blue">public</font> <font color="blue">const</font> <font color="blue">string</font> XmlNS = <font color="#A31515">"http://asmx.habrahabr.ru/"</font> ; <br><br> <font color="blue">public</font> <font color="#2B91AF">HabraSoapHeader</font> HabraHeader { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br> <font color="blue">public</font> <font color="#2B91AF">ResultTimeSoapHeader</font> ResultTimeHeader { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br> <font color="blue">public</font> <font color="#2B91AF">SoapUnknownHeader</font> [] UnknownHeaders { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br><br><br> [ <font color="#2B91AF">SoapHeader</font> ( <font color="#A31515">"HabraHeader"</font> )] <font color="green">//</font> <font color="green"></font> <font color="green">&nbsp;</font> <font color="green"></font> <font color="green">&nbsp;</font> <font color="green"></font> <br> [ <font color="#2B91AF">SoapHeader</font> ( <font color="#A31515">"ResultTimeHeader"</font> , Direction = <font color="#2B91AF">SoapHeaderDirection</font> .Out)] <br> [ <font color="#2B91AF">SoapHeader</font> ( <font color="#A31515">"UnknownHeaders"</font> )] <br> [ <font color="#2B91AF">WebMethod</font> (Description = <font color="#A31515">"</font> <font color="#A31515"></font> <font color="#A31515">&nbsp;</font> <font color="#A31515"></font> <font color="#A31515">&nbsp;</font> <font color="#A31515"></font> <font color="#A31515">ID"</font> )] <br> <font color="blue">public</font> <font color="#2B91AF">GetReportResult</font> GetReport( <font color="#2B91AF">GetReportArg</font> arg) { <br> <font color="green">//            throw new SoapHeaderException("</font> <font color="green"></font> <font color="green">", SoapException.ClientFaultCode);</font> <br> <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">GetReportResult</font> () { <br> Report = <font color="blue">new</font> <font color="#2B91AF">FinReport</font> { <br> ReportID = arg.ReportID, <br> Date = <font color="blue">new</font> <font color="#2B91AF">DateTime</font> (2015, 03, 15), <br> Info = getReportInfo(arg.ReportID) <br>  } <br>  }; <br>  } <br><br><br> <font color="blue">private</font> <font color="blue">string</font> getReportInfo( <font color="blue">int</font> reportID) { <br> <font color="#2B91AF">StringBuilder</font> sb = <font color="blue">new</font> <font color="#2B91AF">StringBuilder</font> (); <br> sb.Append( <font color="#A31515">"ReportID = "</font> ).Append(reportID).AppendLine(); <br><br> <font color="blue">if</font> (HabraHeader != <font color="blue">null</font> ) { <br> sb.Append( <font color="#A31515">"Login = "</font> ).Append(HabraHeader.Login).AppendLine(); <br> sb.Append( <font color="#A31515">"Password = "</font> ).Append(HabraHeader.Password).AppendLine(); <br>  } <br><br> <font color="blue">foreach</font> ( <font color="blue">var</font> header <font color="blue">in</font> UnknownHeaders) { <br> sb.Append( <font color="#A31515">"</font> <font color="#A31515"></font> <font color="#A31515">SoapHeader = "</font> ).Append(header.Element.Name).AppendLine(); <br> sb.Append( <font color="#A31515">"MustUnderstand = "</font> ).Append(header.MustUnderstand).AppendLine(); <br><br> <font color="green">//                if (header.Element.Name == "HabraSoapHeader") {</font> <br> <font color="green">//                    sb.AppendLine("HabraSoapHeader</font> <font color="green"></font> <font color="green">");</font> <br> <font color="green">//                    sb.Append("Login = ").Append(header.Element["Login"].InnerText).AppendLine();</font> <br> <font color="green">//                    sb.Append("Password = ").Append(header.Element["Password"].InnerText).AppendLine();</font> <br> <font color="green">//                    header.DidUnderstand = true;</font> <br> <font color="green">//                }</font> <br>  } <br><br> ResultTimeHeader = <font color="blue">new</font> <font color="#2B91AF">ResultTimeSoapHeader</font> (); <br> ResultTimeHeader.ResultTime = <font color="#2B91AF">DateTime</font> .Now; <br> <font color="blue">return</font> sb.ToString(); <br>  } <br>  } <br><br><br> <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">HabraSoapHeader</font> : <font color="#2B91AF">SoapHeader</font> { <br> <font color="blue">public</font> <font color="blue">string</font> Login { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br> <font color="blue">public</font> <font color="blue">string</font> Password { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br>  } <br><br><br> <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">ResultTimeSoapHeader</font> : <font color="#2B91AF">SoapHeader</font> { <br> <font color="blue">public</font> <font color="#2B91AF">DateTime</font> ResultTime { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br>  } <br><br><br> <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">FinReport</font> { <br> <font color="blue">public</font> <font color="blue">int</font> ReportID { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br> <font color="blue">public</font> <font color="#2B91AF">DateTime</font> Date { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br> <font color="blue">public</font> <font color="blue">string</font> Info { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br>  } <br><br><br> <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportArg</font> { <br> <font color="blue">public</font> <font color="blue">int</font> ReportID { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br>  } <br><br><br> <font color="blue">public</font> <font color="blue">class</font> <font color="#2B91AF">GetReportResult</font> { <br> <font color="blue">public</font> <font color="#2B91AF">FinReport</font> Report { <font color="blue">get</font> ; <font color="blue">set</font> ;  } <br>  } <br>  } </blockquote>   -      -,       wsdl.    : <br><blockquote> <font color="blue">private</font> <font color="blue">void</font> webMethodTest_GetReport() { <br> <font color="blue">var</font> service = GetFinReportService(); <br> <font color="blue">var</font> arg = <font color="blue">new</font> <font color="#2B91AF">GetReportArg</font> (); <br> arg.ReportID = 45; <br><br> service.HabraSoapHeaderValue = <font color="blue">new</font> <font color="#2B91AF">HabraSoapHeader</font> (); <br> service.HabraSoapHeaderValue.Login = <font color="#A31515">"neo"</font> ; <br> service.HabraSoapHeaderValue.Password = <font color="#A31515">"3Ku2kcQfNLOW"</font> ; <br> service.HabraSoapHeaderValue.MustUnderstand = <font color="blue">true</font> ; <br><br> <font color="blue">var</font> result = service.GetReport(arg); <br> <font color="blue">var</font> resultTimeSoapHeader = service.ResultTimeSoapHeaderValue; <br><br> <font color="blue">if</font> (resultTimeSoapHeader != <font color="blue">null</font> ) { <br> <font color="#2B91AF">MessageBox</font> .Show( <font color="#A31515">"ResultTimeSoapHeader = "</font> + resultTimeSoapHeader.ResultTime); <br>  } <br><br> <font color="#2B91AF">MessageBox</font> .Show(result.Report.Info); <br>  } <br></blockquote><br> ,    asmx -  soap,    : <br><ul><li>    SoapHeader   </li><li>      </li><li>   -  [SoapHeader],     </li></ul><br>    -    ‚Äì HabraSoapHeader  ResultTimeSoapHeader,     ,     . <br><br>      : <br><blockquote> <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font> <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font> <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF-8</font> " <font color="blue">?&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&nbsp;</font> <font color="red">xmlns:soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Header</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">HabraSoapHeader</font> <font color="blue">&nbsp;</font> <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&nbsp;</font> <font color="red">soap:mustUnderstand</font> <font color="blue">=</font> " <font color="blue">1</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Login</font> <font color="blue">&gt;</font> neo <font color="blue">&lt;/</font> <font color="#A31515">Login</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Password</font> <font color="blue">&gt;</font> 3Ku2kcQfNLOW <font color="blue">&lt;/</font> <font color="#A31515">Password</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">HabraSoapHeader</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Header</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReport</font> <font color="blue">&nbsp;</font> <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">arg</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">ReportID</font> <font color="blue">&gt;</font> 45 <font color="blue">&lt;/</font> <font color="#A31515">ReportID</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">arg</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReport</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&gt;</font> <br></blockquote><br><blockquote> <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font> <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font> <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF-8</font> " <font color="blue">?&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&nbsp;</font> <font color="red">xmlns:soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Header</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">ResultTimeSoapHeader</font> <font color="blue">&nbsp;</font> <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">ResultTime</font> <font color="blue">&gt;</font> 2015-03-24T11:37:00.6135717+06:00 <font color="blue">&lt;/</font> <font color="#A31515">ResultTime</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">ResultTimeSoapHeader</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Header</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&nbsp;</font> <font color="red">xmlns</font> <font color="blue">=</font> " <font color="blue">http://asmx.habrahabr.ru/</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Report</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">ReportID</font> <font color="blue">&gt;</font> 45 <font color="blue">&lt;/</font> <font color="#A31515">ReportID</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Date</font> <font color="blue">&gt;</font> 2015-03-15T00:00:00 <font color="blue">&lt;/</font> <font color="#A31515">Date</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">Info</font> <font color="blue">&gt;</font> <br> ReportID = 45 <br> Login = neo <br> Password = 3Ku2kcQfNLOW <br> <font color="blue">&lt;/</font> <font color="#A31515">Info</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">Report</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResult</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">GetReportResponse</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap</font> <font color="#A31515">:</font> <font color="#A31515">Envelope</font> <font color="blue">&gt;</font> <br><font color="blue">&nbsp;</font><br></blockquote>     soap:mustUnderstand=¬´1¬ª,  ,  -     .   SoapHeader   public bool DidUnderstand { set; get; },  ,    .       true,     ‚Äì false.   ,    mustUnderstand=¬´1¬ª,  DidUnderstand  false, -  soap:Fault.   [SoapHeader(¬´HabraHeader¬ª)],      : <br><blockquote> <font color="blue">&lt;?</font>  <font color="#A31515">xml</font> <font color="blue">&nbsp;</font> <font color="red">version</font> <font color="blue">=</font> " <font color="blue">1.0</font> " <font color="blue">&nbsp;</font> <font color="red">encoding</font> <font color="blue">=</font> " <font color="blue">UTF-8</font> " <font color="blue">?&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&nbsp;</font> <font color="red">xmlns:soap</font> <font color="blue">=</font> " <font color="blue">http://schemas.xmlsoap.org/soap/envelope/</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsd</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema</font> " <font color="blue">&nbsp;</font> <font color="red">xmlns:xsi</font> <font color="blue">=</font> " <font color="blue">http://www.w3.org/2001/XMLSchema-instance</font> " <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">soap:</font> <font color="#A31515">Fault</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">faultcode</font> <font color="blue">&gt;</font> soap:MustUnderstand <font color="blue">&lt;/</font> <font color="#A31515">faultcode</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;</font> <font color="#A31515">faultstring</font> <font color="blue">&gt;</font>  SOAP HabraSoapHeader  . <font color="blue">&lt;/</font> <font color="#A31515">faultstring</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Fault</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Body</font> <font color="blue">&gt;</font> <br> <font color="blue">&lt;/</font> <font color="#A31515">soap:Envelope</font> <font color="blue">&gt;</font> <br></blockquote>       public SoapUnknownHeader[] UnknownHeaders { get;  set; },         foreach. <br><br>         SoapExtension.        -.           .            - ( -),       . <br><br>  ,   ,   ,    SoapHeaderException,   SoapException. ,      ,       ,   SoapException,      soap:Fault.     . <br><br><a name="trick_15"></a><h3> <b>15. </b> </h3><br>  asmx -     .      <b>CacheDuration</b>   -,     <b>HttpContext.Cache</b> .      : <br><blockquote> [ <font color="#2B91AF">WebMethod</font> (Description = <font color="#A31515">"</font> <font color="#A31515"></font> <font color="#A31515">&nbsp;</font> <font color="#A31515"></font> <font color="#A31515">&nbsp;</font> <font color="#A31515"></font> <font color="#A31515">ID"</font> , CacheDuration = 5)] <br> <font color="blue">public</font> <font color="#2B91AF">GetReportResult</font> GetReport( <font color="#2B91AF">GetReportArg</font> arg){ <br> <font color="blue">return</font> <font color="blue">new</font> <font color="#2B91AF">GetReportResult</font> (){ <br> Report = <font color="blue">new</font> <font color="#2B91AF">FinReport</font> { <br> ReportID = arg.ReportID, <br> Date = <font color="#2B91AF">DateTime</font> .Now, <br> Info = getReportInfo(arg.ReportID) <br>  } <br>  }; <br>  } <br><br><br> <font color="blue">private</font> <font color="blue">string</font> getReportInfo( <font color="blue">int</font> reportID){ <br> <font color="blue">string</font> key = <font color="#A31515">"getReportInfo_"</font> + reportID; <br> <font color="blue">string</font> cachedInfo = Context.Cache.Get(key) <font color="blue">as</font> <font color="blue">string</font> ; <br><br> <font color="blue">if</font> (cachedInfo != <font color="blue">null</font> ){ <br> <font color="blue">return</font> cachedInfo; <br>  } <br><br> <font color="blue">string</font> info = <font color="#2B91AF">DateTime</font> .Now + <font color="#A31515">" reportID = "</font> + reportID; <br> <font color="blue">this</font> .Context.Cache.Add(key, info, <font color="blue">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddSeconds(10), <font color="#2B91AF">TimeSpan</font> .Zero, <font color="#2B91AF">CacheItemPriority</font> .High, <font color="blue">null</font> ); <br> <font color="blue">return</font> info; <br>  } <br></blockquote>                soap .           , -  ,    . <br><br>      ,             . <br><br>           ,   Date     5 ,   Info ‚Äì   10 . <br><br> ,     ,            . <br><br><a name="trick_16"></a><h3> <b>16. SoapExtension</b> </h3><br> SoapExtension ‚Äì   ,       ,     -,     .  ,          ,            . <br><br>  SoapExtension: <br><ul><li>      ( soap    MemoryStream) </li><li>      </li><li>     (soap header) </li><li> 1  :  - (-  )    </li><li> 2  :  - ( )   web.config (app.config)  ! </li><li>     -  - </li><li>     SoapExtension </li></ul><br>      SoapExtension <br><ul><li>    </li><li>  </li><li>     </li><li>  </li><li>  compression </li><li>  soap header </li><li>    </li></ul><br>  Links <br><ul><li> <a href="https://msdn.microsoft.com/ru-ru/library/vstudio/esw638yk(v%3Dvs.100).aspx">https://msdn.microsoft.com/ru-ru/library/vstudio/esw638yk(v=vs.100).aspx</a> </li><li> <a href="https://www.google.com/search%3Fq%3Dsite%253Acodeproject.com%2Bsoap%2Bextension">https://www.google.com/search?q=site%3Acodeproject.com+soap+extension</a> </li></ul><br><br><a name="trick_17"></a><h3> <b>17.  x64  Visual Studio</b> </h3><br>  -  Visual Studio   64-     -.    Platform target: x64,       ¬´      ¬´FinReportWebService¬ª     .     ,   ¬ª. <br><br>       . <br><br>  <b>1 way.</b>   -  ¬´Use Local IIS Web server¬ª,     IIS <br><br><img src="https://habrastorage.org/files/bc2/253/878/bc2253878ea14fc4acb1ee2d7ba166c4.png"><br><br> <b>2 .</b>  -   IIS      <b>Debug -&gt; Attach to Process</b> . <br><br> <b>3 .</b>   IIS     ASP.NET Development Server   - <b>CassiniDev</b> .  CassiniDev  : <a href="https://cassinidev.codeplex.com/SourceControl/latest">https://cassinidev.codeplex.com/SourceControl/latest#ReadMe.htm</a> <br><br> ,    \trunk\src\CassiniDev.sln,      trunk\src\packages.         x64  : <br><br><img src="https://habrastorage.org/files/b49/cef/19a/b49cef19a3ce442db57dc74696eb5df3.png"><br><br>  -    <b>C:\Program Files (x86)\Common Files\microsoft shared\DevServer</b> .   ,     \trunk\src\CassiniDev\bin\x64\Debug <br><br><img src="https://habrastorage.org/files/46d/5cf/d65/46d5cfd656e74401a83f9b41415c1ebc.png"><br><br><a name="trick_18"></a><h3> <b>18.  ()</b> </h3><br>    <b>Publish</b>   File System Visual Studio      ,     IIS <br><br><img src="https://habrastorage.org/files/7f4/96a/3c9/7f496a3c9e3948e08c44d20d57186a6c.png"><br><br><h5> <b>wwwroot</b> </h5><br>      -     <b>C:\inetpub\wwwroot</b> ,       -. ,  IIS    <b>inetmgr</b> . <br><br><img src="https://habrastorage.org/files/7b6/683/961/7b668396147c4089972995d2d080d080.png"><br><br><img src="https://habrastorage.org/files/4af/282/6b9/4af2826b9d104dd78ee13ba46329688a.png"><br><br><h5> <b>HTTP Error 404.3 ‚Äî Not Found</b> </h5><br>    HTTP Error 404.3 ‚Äî Not Found,      IIS <br><br><img src="https://habrastorage.org/files/cc0/ca4/44b/cc0ca444b04542a2a3a9068984c6bbf1.png"><br><br>    <br> %windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_regiis.exe ‚Äìir <br><br><h5> <b> </b> </h5><br> -       <br><br><img src="https://habrastorage.org/files/7fb/62a/967/7fb62a9672cf40858e352af21803dbf9.png"><br><br>        -   IIS    : <br><blockquote> HTTP Error 500.19 ‚Äî Internal Server Error. <br> The requested page cannot be accessed because the related configuration data for the page is invalid. <br></blockquote>  or <br><blockquote> Access is denied. <br> Error message 401.3: You do not have permission to view this directory or page using the credentials you supplied <br></blockquote>       . <br><br><a name="trick_19"></a><h3> <b>19.   IIS</b> </h3><br> -        .       .    <b>FinReportPool</b>     -. <br><br><h5> <b> </b> </h5><br>      ApplicationPoolIdentity    : <br> <b>IIS AppPool\&lt; &gt;</b> <br><br> , <b>IIS AppPool\FinReportPool</b> ,  <b>IIS AppPool\DefaultAppPool</b> <br><br>                 ,     <br><br><img src="https://habrastorage.org/files/577/317/052/577317052079451fab563fd98db575b5.png"><br><br>       <br><br><img src="https://habrastorage.org/files/4d6/b60/f12/4d6b60f126b143a08ce8919bfd75c76c.png"><br><br>  ,        <b>&lt; &gt;\IIS_IUSRS</b> <br><br>       . <br><br><img src="https://habrastorage.org/files/865/9b6/cde/8659b6cde19f453db264b42dc07d0fd8.png"><br><br>  ,    x86/x64 <br><blockquote>       ¬´FinReportWebService¬ª     .     ,   . </blockquote><blockquote> Could not load file or assembly 'FinReportWebService' or one of its dependencies. An attempt was made to load a program with an incorrect format. <br></blockquote>   -    <b>Enable 32-Bit Applications</b> . <br><br>     <b>Identity</b>        -. <br><br><h5> <b>AppCmd.exe</b> </h5><br>        w3wp.exe.            : <br> AppcmdList.bat <br><blockquote> %systemroot%\System32\inetsrv\appcmd list wp <br> %systemroot%\System32\inetsrv\appcmd list sites <br> %systemroot%\System32\inetsrv\appcmd list app <br> %systemroot%\System32\inetsrv\appcmd list appPools <br>  pause <br></blockquote><br><img src="https://habrastorage.org/files/4ac/98b/a93/4ac98ba93d6e42bcb12689fdded15347.png"><br><br>     ,    ,      -.     AppCmd.exe   <a href="http://www.iis.net/learn/get-started/getting-started-with-iis/getting-started-with-appcmdexe"></a> . <br><br><a name="trick_20"></a><h3> <b>20.  </b> </h3><br>       -,     ,     . <br><ul><li> <a href="http://www.telerik.com/fiddler">Fiddler</a> .  HTTP-.    .    <a href="http://habrahabr.ru/post/140147/"></a> . Must have. </li><li> <a href="http://www.soapui.org/">SoapUI</a> .      -.    ,  . </li><li> <a href="http://www.oxygenxml.com/">Oxygen XML Editor</a> .      XML.    WSDL  SOAP. </li><li> <a href="https://www.wsdl-analyzer.com/">www.wsdl-analyzer.com</a> .    WSDL. </li><li> <a href="http://www.freeformatter.com/">www.freeformatter.com</a> .     ,   . </li></ul></habracut></div><p>Source: <a href="https://habr.com/ru/post/254165/">https://habr.com/ru/post/254165/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254145/index.html">Washington Post: Sit on Facebook all day? Be careful: your boss can keep an eye on you</a></li>
<li><a href="../254149/index.html">Android for developers. Perplexed and upset</a></li>
<li><a href="../254151/index.html">How to get to the top on Kaggle, or Matriksnet at home</a></li>
<li><a href="../254161/index.html">Extraordinary weekly build Vivaldi 1.0.138.4</a></li>
<li><a href="../254163/index.html">Why many do not like Arduino</a></li>
<li><a href="../254167/index.html">Python, xlsx with pictures, macros, media-art, embedded objects</a></li>
<li><a href="../254171/index.html">What is good: how we developed the criteria for assessing the quality of the layout of web projects</a></li>
<li><a href="../254173/index.html">How Trendnet tricked me the 2nd time</a></li>
<li><a href="../254175/index.html">Chrome: Popular Developer Extensions</a></li>
<li><a href="../254177/index.html">PNG resize automation for iOS and Android applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>