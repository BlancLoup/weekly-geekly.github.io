<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Slingshot APT: Advanced virus found - it went unnoticed for 6 years</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last week, researchers at Kaspersky Lab discovered a virus that had gone unnoticed for six years. He got the name Slingshot. Many of their ‚Äúvictims‚Äù w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Slingshot APT: Advanced virus found - it went unnoticed for 6 years</h1><div class="post__text post__text-html js-mediator-article">  Last week, researchers at Kaspersky Lab <a href="https://arstechnica.com/information-technology/2018/03/potent-malware-that-hid-for-six-years-spread-through-routers/">discovered a</a> virus that had gone unnoticed for six years.  He got the name Slingshot.  Many of their ‚Äúvictims‚Äù were attacked by malware via compromised MikroTik routers. <br><br>  According to experts, the complexity of the implementation of Slingshot surpasses the <a href="https://arstechnica.com/information-technology/2014/11/highly-advanced-backdoor-trojan-cased-high-profile-targets-for-years/">Regin trojan</a> that has hit the networks of the Belgian operator Belgacom and other large organizations, and <a href="https://arstechnica.com/information-technology/2016/08/researchers-crack-open-unusually-advanced-malware-that-hid-for-5-years/">Project Sauron</a> . <br><br>  On the components and purpose of the virus, we describe below. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="https://habrahabr.ru/company/it-grad/blog/350974/"><img src="https://habrastorage.org/webt/se/gk/xr/segkxraotydzvsdr6l5rgxy4spg.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ photo by <a href="https://www.flickr.com/photos/hammershaug/5867866634/">Jan Hammershaug</a> <a href="https://creativecommons.org/licenses/by/2.0/">CC</a></i></font> <br><br>  The virus was <a href="https://www.theregister.co.uk/2018/03/09/slingshot_malware_uses_cunning_plan_to_find_a_route_to_sysadmins/">detected</a> by luck.  A group of researchers analyzed the keylogger code and decided to check if it is found elsewhere.  The signature of the virus manifested itself in a seemingly innocent scesrv.dll file on another computer.  Further tests showed that when the computer was connected to the router's configuration system, the virus was activated, unloaded a copy of itself onto a ‚Äúfresh‚Äù machine and got root access. <br><br>  The malware "collects" screenshots, information about the network and USB-connections, intercepts passwords and data in the clipboard, monitors the activity on the computer.  Based on this, the researchers concluded that the purpose of the Slingshot is probably espionage. <br><br>  <a href="https://arstechnica.com/information-technology/2018/03/potent-malware-that-hid-for-six-years-spread-through-routers/">It is not precisely established</a> how Slingshot infected its first targets, however, it is known that the creators of the virus have injected malicious code into the routers of the Latvian company MikroTik.  It uses the Winbox configuration tool to load DLL files into the computer‚Äôs memory.  Hackers put the ipv4.dll library on the router, which also began to be transferred to memory.  After unloading, the file downloaded other components of the virus. <br><br><h2>  Virus components </h2><br>  The Slingshot program itself is a bootloader that replaces the existing system dynamic library on the victim's computer.  Slingshot embeds the necessary modules into a DLL, compressing a part of the original file to keep the size unchanged.  Then it changes the entry point, ‚Äúswitching‚Äù the pointer to the required loader, and calculates a new checksum DLL.  In this case, after downloading the malicious modules, the boot loader restores the original code of the system DLL file in memory. <br><br>  Slingshot loads a lot of support components, but the two main and largest modules are Cahnadr (running in kernel mode) and GollumApp (running in user mode).  They are connected and help each other with searching and collecting information. <br><br>  Canhadr <a href="https://arstechnica.com/information-technology/2018/03/potent-malware-that-hid-for-six-years-spread-through-routers/">interacts</a> with the network at a low level and can reproduce malicious code without disrupting the entire file system and causing a blue screen of death.  It is written in pure C and is able to access the hard disk and RAM despite the limitations set in the system.  He is also responsible for monitoring the integrity and concealing the activities of the virus from analysis systems. <br><br>  For example, it <a href="https://s3-eu-west-1.amazonaws.com/khub-media/wp-content/uploads/sites/43/2018/03/09133534/The-Slingshot-APT_report_ENG_final.pdf">uses</a> special algorithms that mask network traffic.  All components of the virus are located in a separate pool, which allows them to be distinguished from other, "harmless" requests.  All information about the packets transmitted on the network falls into NET_BUFFER_LIST.  If a command from the ‚Äúmalicious pool‚Äù appears in the list, Cahnadr deletes it, preventing the sending of a success message. <br><br>  As for the GollumApp module, it <a href="https://arstechnica.com/information-technology/2018/03/potent-malware-that-hid-for-six-years-spread-through-routers/">contains</a> approximately 1.5 thousand functions and is embedded in the services.exe file.  It creates a new thread and works directly with system services: collects network data (routing tables, proxy information, AutoConfigUrl settings), steals passwords stored in Mozilla and IE, ‚Äúwrites‚Äù all keystrokes on the keyboard, starts new processes with system rights and manages <a href="https://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2584%25D0%25B0%25D0%25B9%25D0%25BB%25D0%25BE%25D0%25B2%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0">EFS</a> I / O requests. <br><br><img src="https://habrastorage.org/webt/cd/5d/kd/cd5dkdwmfqxiuyger8p-bfc2nhu.jpeg"><br>  <font color="#A9A9A9"><i>/ photo <a href="https://www.flickr.com/photos/christiaancolen/21206509269/">Christiaan Colen</a> <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC</a></i></font> <br><br><h2>  Spread </h2><br>  Presumably, the virus has been operating since 2012, but for a long time it was not known about it, because Slingshot uses a set of techniques to hide its activities - these are anti-virus software detection systems, specialized solutions for complicating analysis and encryption. <br><br>  At the same time, the virus turned out to be quite <a href="https://www.theregister.co.uk/2018/03/09/slingshot_malware_uses_cunning_plan_to_find_a_route_to_sysadmins/">rare</a> , which also made detection difficult: researchers <a href="https://arstechnica.com/information-technology/2018/03/potent-malware-that-hid-for-six-years-spread-through-routers/">recorded</a> about 100 infected computers, most of which are in Africa and the Middle East: these are Kenya, Yemen, Afghanistan, Turkey, Iraq, Sudan, Jordan, etc. Most of the victims are separate users, however, there are government organizations on the list. <br><br>  In "Kaspersky Lab" note that they could not find any connection with previously known APT.  However, some techniques and exploits (for example, driver vulnerabilities) used by Slingshot have been detected in such malware as Turla, Grayfish and White Lambert.  Experts say that virus signatures have now been identified, and MikroTik has already released a software update to block Slingshot. <br><br><hr><br>  PS Materials on the topic from the First Corporate IaaS Blog: <br><br><ul><li>  <a href="http://iaas-blog.it-grad.ru/bezopasnost/osobennosti-razmeshheniya-gis-v-oblake/">IaaS for state information systems: placement features</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/tendencii/zashhita-personalnyx-dannyx-evropejskij-podxod/">Personal data protection: a European approach</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/bezopasnost/osobennosti-dvuxfaktornoj-autentifikacii/">Features of two-factor authentication: does it work in the IaaS cloud</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/bezopasnost/na-chto-obratit-vnimanie-pri-vybore-uslugi-oblachnogo-pci-dss-xostinga/">Cloud PCI DSS hosting: what to look for</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/350974/">https://habr.com/ru/post/350974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350962/index.html">Hooks life cycle Vue.js</a></li>
<li><a href="../350964/index.html">How we saddled OPNsense</a></li>
<li><a href="../350966/index.html">Choosing Web Fonts: A Beginner's Guide</a></li>
<li><a href="../350968/index.html">Yandex opens Alice for all developers. Yandex.Dialogy Platform (beta)</a></li>
<li><a href="../350972/index.html">Organization of information systems production processes. Part 1. Starting point</a></li>
<li><a href="../350976/index.html">Guide to SEO javascript sites. Part 1. The Internet through the eyes of Google</a></li>
<li><a href="../350978/index.html">Drupal 8 + Varnish: Cache HTML correctly</a></li>
<li><a href="../350982/index.html">6 myths about Service Fabric</a></li>
<li><a href="../350984/index.html">First steps in machine learning</a></li>
<li><a href="../350986/index.html">Centralized continuous deployment for the year vol 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>