<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Building Android applications step by step, part one</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article we will talk about architecture design and creating a mobile application based on the MVP pattern using RxJava and Retrofit. The topic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Building Android applications step by step, part one</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/b3e/38d/99e/b3e38d99e09442b3b755aaf894d39daf.jpg"><br><br>  In this article we will talk about architecture design and creating a mobile application based on the MVP pattern using RxJava and Retrofit.  The topic turned out to be quite large, so it will be delivered in separate portions: in the first we design and create an application, in the second we do DI with the help of Dagger 2 and write unit tests, in the third we add integration and functional tests, and also think about TDD in the realities of Android development . <br><a name="habracut"></a><br>  Content: <br><ul><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Introduction</a> </li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Step 1. Simple architecture</a> <br><ul><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Layering, MVP</a> </li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Model</a> <br><ul><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Retrofit</a> </li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">POJO</a> </li></ul></li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Presenter</a> </li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">View</a> </li></ul></li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Step 2. Complicated architecture</a> <ul><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Retrolambda</a> </li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Different data models for different layers</a> </li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Model</a> </li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Presenter</a> </li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">View</a> </li></ul></li><li>  <a href="https://habr.com/ru/company/rambler-co/blog/275943/">Conclusion or to be continued</a> </li></ul><br><div class="spoiler">  <b class="spoiler_title">Full content</b> <div class="spoiler_text"><ul><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/275943/">Introduction</a> </li><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/275943/">Step 1. Simple architecture</a> </li><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/275943/">Step 2. Complicated architecture</a> </li><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/277343/">Step 3. Dependency Injection</a> </li><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/277343/">Step 4. Unit Testing</a> </li><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/279799/">Step 5. Integration Testing</a> </li><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/279799/">Step 6. Functional testing</a> </li><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/279799/">Step 7. TDD</a> </li><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/279799/">Step 8. What's next?</a> </li><li>  <a href="https://habrahabr.ru/company/rambler-co/blog/279799/">Conclusion</a> </li></ul><br></div></div><br><a name="1"></a><h4>  Introduction </h4><br>  For a better understanding and consistent complication of the code, we divide the design into two stages: primitive (minimally viable) and ordinary architecture.  In the primitive we will manage the minimum amount of code and files, then we will improve this code. <br>  All sources can be found on <a href="https://github.com/andrey7mel/android-step-by-step">github</a> .  The branches in the repository correspond to the steps in the article: <a href="https://github.com/andrey7mel/android-step-by-step/tree/Step_1_Simple_architecture">Step 1 Simple architecture</a> - the first step, <a href="https://github.com/andrey7mel/android-step-by-step/tree/Step_2_Complex_architecture">Step 2 Complex architecture</a> - the second step. <br>  For example, let's try to get a list of repositories for a specific user using the Github API. <br><br>  In our application, we will use Rx, so to understand the article, you need to have a general idea of ‚Äã‚Äãthis technology. <a href="http://habrahabr.ru/post/265269/">We recommend</a> reading the <a href="http://habrahabr.ru/post/265269/">series of publications by Grokai RxJava</a> , these materials will give a good idea about reactive programming. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="2"></a><h4>  Step 1. Simple architecture <br></h4><br><a name="3"></a>  Layering, MVP <br>  When designing the architecture, we will adhere to the MVP pattern.  More details can be found here: <br>  <a href="https://ru.wikipedia.org/wiki/Model-View-Presenter">https://ru.wikipedia.org/wiki/Model-View-Presenter</a> <br>  <a href="http://habrahabr.ru/post/131446/">http://habrahabr.ru/post/131446/</a> <br><br>  We divide our entire program into 3 main layers: <br>  <b>Model</b> - here we receive and store data.  At the output we get Observable. <br>  <b>Presenter</b> - this layer stores all application logic.  Get Observable, subscribe to it and pass the result to the view. <br>  <b>View</b> - a display layer, contains all view elements, activations, fragments and so on. <br><br><div class="spoiler">  <b class="spoiler_title">Conventional scheme:</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/e08/de8/101/e08de8101f3b486b9c7f556126dea55e.png"><br></div></div><br><a name="4"></a><h4>  Model </h4><br>  The data layer should give us Observable &lt;List &lt;Repo &gt;&gt;, we will write the interface: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Model</span></span></span><span class="hljs-class"> </span></span>{ Observable&lt;List&lt;Repo&gt;&gt; getRepoList(String name); }</code> </pre> <br><a name="5"></a><h5>  Retrofit </h5><br>  For simplification of work with a network we use Retrofit.  Retrofit is a library for working with the REST API, it will take over all the work with the network, we can only describe the requests using the interface and annotations. <br><br><div class="spoiler">  <b class="spoiler_title">Retrofit 2</b> <div class="spoiler_text">  There are a lot of materials about Retrofit in RuNet ( <a href="http://www.pvsm.ru/android/58484">http://www.pvsm.ru/android/58484</a> , <a href="http://tttzof351.blogspot.ru/2014/01/java-retrofit.html">http://tttzof351.blogspot.ru/2014/01/java-retrofit.html</a> ). <br>  The main difference between the second version and the first is that we have lost the difference between synchronous and asynchronous methods.  Now we get a Call &lt;Data&gt; for which we can call execute () for a synchronous or execute (callback) for an asynchronous request.  There is also a long-awaited opportunity to cancel requests: call.cancel ().  As before, you can get Observable &lt;Data&gt;, though now with the help of a special plugin <br><br></div></div><br>  Interface for getting data about repositories: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApiInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"users/{user}/repos"</span></span>) Observable&lt;List&lt;Repo&gt;&gt; getRepositories(<span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"user"</span></span>) String user); }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Model implementation</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ModelImpl</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Model</span></span></span><span class="hljs-class"> </span></span>{ ApiInterface apiInterface = ApiModule.getApiInterface(); <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Observable&lt;List&lt;Repo&gt;&gt; getRepoList(String name) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> apiInterface.getRepositories(name) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()); } }</code> </pre></div></div><br><a name="6"></a><h5>  Work with data, POJO </h5><br>  Retrofit (and GSON inside it) work with POJO (Plain Old Java Object).  This means that to get an object from JSON like: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Andrey"</span></span>, <span class="hljs-string"><span class="hljs-string">"phone"</span></span>:<span class="hljs-string"><span class="hljs-string">"511 55 55"</span></span> }</code> </pre><br>  We need the User class, in which GSON writes the values: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String phone; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id = id; } <span class="hljs-comment"><span class="hljs-comment">// etc }</span></span></code> </pre><br>  It is naturally not necessary to generate such classes by hands, for this there are special generators, for example: <a href="http://www.jsonschema2pojo.org/">www.jsonschema2pojo.org</a> . <br><br>  We feed him our JSON, choose: <br><br>  Source type: JSON <br>  Annotation style: Gson <br>  Include getters and setters <br><br>  and get the code of our files.  You can download as a zip or jar and put in our project.  For the repository it turned out 3 objects: Owner, Permissions, Repo. <br><br><div class="spoiler">  <b class="spoiler_title">Sample generated code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Permissions</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@SerializedName</span></span>(<span class="hljs-string"><span class="hljs-string">"admin"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Expose</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> admin; <span class="hljs-meta"><span class="hljs-meta">@SerializedName</span></span>(<span class="hljs-string"><span class="hljs-string">"push"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Expose</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> push; <span class="hljs-meta"><span class="hljs-meta">@SerializedName</span></span>(<span class="hljs-string"><span class="hljs-string">"pull"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Expose</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> pull; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> The admin */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isAdmin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> admin; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> admin The admin */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAdmin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> admin)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.admin = admin; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> The push */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isPush</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> push; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> push The push */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPush</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> push)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.push = push; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> The pull */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isPull</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pull; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> pull The pull */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPull</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pull)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pull = pull; } }</code> </pre> </div></div><br><a name="7"></a><h4>  Presenter </h4><br>  Presenter knows what to download, how to show what to do in case of an error and so on.  Ie separates the logic from the presentation.  View in this case is the most "easy".  Our presenter should be able to handle pressing the search button, initialize the download, send data and unsubscribe if the Activity is stopped. <br><br>  Presenter interface: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presenter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSearchClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Implementation of the presenter</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepoListPresenter</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presenter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Model model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ModelImpl(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> View view; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Subscription subscription = Subscriptions.empty(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RepoListPresenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View view)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.view = view; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSearchButtonClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!subscription.isUnsubscribed()) { subscription.unsubscribe(); } subscription = model.getRepoList(view.getUserName()) .subscribe(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Observer&lt;List&lt;Repo&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCompleted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Throwable e)</span></span></span><span class="hljs-function"> </span></span>{ view.showError(e.getMessage()); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onNext</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Repo&gt; data)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !data.isEmpty()) { view.showData(data); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { view.showEmptyList(); } } }); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!subscription.isUnsubscribed()) { subscription.unsubscribe(); } } }</code> </pre></div></div><br><a name="8"></a><h4>  View </h4><br>  We implement the View as an Activity, which is able to display the received data, show an error, notify about an empty list and issue a user name upon request from the presenter.  Interface: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IView</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Repo&gt; RepoList)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String error)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showEmptyList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUserName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Implementing View Methods</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Repo&gt; list)</span></span></span><span class="hljs-function"> </span></span>{ adapter.setRepoList(list); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onStop(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (presenter != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { presenter.onStop(); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String error)</span></span></span><span class="hljs-function"> </span></span>{ makeToast(error); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showEmptyList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ makeToast(getString(R.string.empty_repo_list)); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUserName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> editText.getText().toString(); }</code> </pre> <br></div></div><br>  As a result, we got a simple application, which is divided into layers. <br><br>  Scheme: <br><br><img src="https://habrastorage.org/files/3b9/2de/2f8/3b92de2f812b4c8abc9f82fec4c790f7.png"><br><br>  Some things need improvement, however, the general idea is clear.  Now we will complicate our task by adding new functionality. <br><br><a name="9"></a><h4>  Part 2. Complicated architecture </h4><br>  Add new functionality to our application, displaying information about the repository.  We will show the branches and contributors lists, which are obtained by different requests from the API. <br><br><a name="10"></a><h5>  Retrolambda </h5><br>  Working with Rx without lambda is a pain, the need to write anonymous classes every time quickly tires.  Android does not support Java 8 and lambda, but Retrolambda comes to the rescue ( <a href="https://github.com/evant/gradle-retrolambda">https://github.com/evant/gradle-retrolambda</a> ).  Learn more about lambda expressions: <a href="http://habrahabr.ru/post/224593/">http://habrahabr.ru/post/224593/</a> <br><br><a name="11"></a><h5>  Different data models for different layers. </h5><br>  As you can see, we are working with the same Repo data object on all three layers.  This approach is good for simple applications, but in real life we ‚Äã‚Äãcan always face a change in the API, the need to change an object or something else.  If several people work on a project, there is a risk of class change in the interests of another layer. <br><br>  Therefore, the approach is often used: single layer = single data format.  And if some fields in the model change, it will not affect the View layer in any way.  We can make any changes in the Presenter layer, but in View we give a strictly defined object (class).  Due to this, the independence of layers from data models is achieved, each layer has its own model.  When changing any model, we will need to rewrite the mapper and not touch the layer itself.  This is similar to contract programming, when we know exactly which object will come to our layer and which one we should give away, thereby protecting ourselves and colleagues from unpredictable consequences. <br><br>  In our example, two data types will be enough for us, DTO - Data Transfer Object (completely copies JSON object) and View Object (adapted object for display).  If there is a more complex application, you may need a Business Object (for business processes) or, for example, a Data Base Object (for storing complex objects in a database) <br><br><div class="spoiler">  <b class="spoiler_title">The schematic image of the transmitted data</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b18/e03/a1f/b18e03a1f14d4868bc37a674006884c0.png"><br></div></div><br>  Rename Repo to RepositoryDTO, create a new class Repository and write a mapper implementing the interface Func1 &lt;List &lt;RepositoryDTO &gt;&gt;, List &lt;Repository &gt;&gt; <br>  (translation from List &lt;RepositoryDTO&gt; to List &lt;Repository&gt;) <br><br><div class="spoiler">  <b class="spoiler_title">Mapper for objects</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RepoBranchesMapper</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Func1</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">List</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BranchDTO</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">List</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Branch</span></span></span><span class="hljs-class">&gt;&gt; </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;Branch&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;BranchDTO&gt; branchDTOs)</span></span></span><span class="hljs-function"> </span></span>{ List&lt;Branch&gt; branches = Observable.from(branchDTOs) .map(branchDTO -&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Branch(branchDTO.getName())) .toList() .toBlocking() .first(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> branches; } }</code> </pre><br></div></div><br><br><a name="12"></a><h4>  Model </h4><br>  We have introduced different data models for different layers, the Model interface now gives DTO objects, otherwise everything also. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Model</span></span></span><span class="hljs-class"> </span></span>{ Observable&lt;List&lt;RepositoryDTO&gt;&gt; getRepoList(String name); Observable&lt;List&lt;BranchDTO&gt;&gt; getRepoBranches(String owner, String name); Observable&lt;List&lt;ContributorDTO&gt;&gt; getRepoContributors(String owner, String name); }</code> </pre><br><a name="13"></a><h4>  Presenter </h4><br>  In the Presenter layer, we need a common class.  A presenter can perform a variety of functions, it can be a simple download-show presenter, there can be a list with the need to upload items, there can be a map where we will request objects on the site, as well as many other entities.  But all of them are united by the need to unsubscribe from the Observable in order to avoid memory leaks.  The rest depends on the type of presenter. <br><br>  If we use several Observable, then we need to unsubscribe from all at once in onStop.  To do this, you can use the CompositeSubscription: add all our subscriptions there and unsubscribe by command. <br><br>  Also add preservation state.  To do this, we create and implement the onCreate (Bundle savedInstanceState) and onSaveInstanceState (Bundle outState) methods.  To translate DTO to VO we use mappers. <br><br><div class="spoiler">  <b class="spoiler_title">Code example</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSearchButtonClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ String name = view.getUserName(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TextUtils.isEmpty(name)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; Subscription subscription = dataRepository.getRepoList(name) .map(repoListMapper) .subscribe(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Observer&lt;List&lt;Repository&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCompleted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Throwable e)</span></span></span><span class="hljs-function"> </span></span>{ view.showError(e.getMessage()); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onNext</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Repository&gt; list)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (list != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !list.isEmpty()) { repoList = list; view.showRepoList(list); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { view.showEmptyList(); } } }); addSubscription(subscription); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (savedInstanceState != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { repoList = (List&lt;Repository&gt;) savedInstanceState.getSerializable(BUNDLE_REPO_LIST_KEY); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isRepoListEmpty()) { view.showRepoList(repoList); } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isRepoListEmpty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repoList == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || repoList.isEmpty(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSaveInstanceState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle outState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isRepoListEmpty()) { outState.putSerializable(BUNDLE_REPO_LIST_KEY, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(repoList)); } }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">General Layer Presenter Layouts:</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/927/8ae/ea2/9278aeea28644bc6a521578306749fa6.png"><br></div></div><br><br><a name="14"></a><h4>  View </h4><br>  We will use activit to manage the fragments.  For each entity, its own fragment, which is inherited from the base fragment.  The base fragment using the base presenter interface is written in onStop (). <br><br>  Also pay attention to the restoration of the state, all the logic has moved to the presenter - View should be as simple as possible. <br><br><div class="spoiler">  <b class="spoiler_title">Base Slice Code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onStop(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (getPresenter() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { getPresenter().onStop(); } }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">General Layer View Layer</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/29d/d30/c0e/29dd30c0e62544f4a5bf7a17d7a6e237.png"><br></div></div><br><br>  The general scheme of the application in the second step ( <a href="">clickable</a> ): <br> <a href=""><img src="https://habrastorage.org/files/4e0/9f7/802/4e09f78028274958819a59445c3065fd.png"></a> <br><br><a name="15"></a><h4>  Conclusion or to be continued ... </h4><br>  As a result, we got a working application in compliance with all necessary levels of abstraction and a clear division of responsibility by component ( <a href="https://github.com/andrey7mel/android-step-by-step">source</a> ).  Such code is easier to maintain and complement; a development team can work on it.  But one of the main advantages is fairly easy testing.  In the next article we will consider the implementation of Dagger 2, we will cover the existing code with tests and write new functionality, following the principles of TDD. <br><br>  <b>UPDATE</b> <br>  <a href="https://habrahabr.ru/company/rambler-co/blog/277343/">Building Android applications step by step, part two</a> <br>  <a href="https://habrahabr.ru/company/rambler-co/blog/279799/">Building Android applications step by step, part three</a> </div><p>Source: <a href="https://habr.com/ru/post/275943/">https://habr.com/ru/post/275943/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275927/index.html">Optimization of Android-games created on Unity for the Intel platform: an example from life</a></li>
<li><a href="../275929/index.html">Setting color tabs in the new assembly Vivaldi 1.0.380.2</a></li>
<li><a href="../275933/index.html">Grandstream First Conference Background Review - GAC2500</a></li>
<li><a href="../275937/index.html">Fuzzy search in the dictionary with the universal Levenshtein automaton. Part 1</a></li>
<li><a href="../275939/index.html">Dry anti-pattern</a></li>
<li><a href="../275947/index.html">Customer support, Amazon backdoor</a></li>
<li><a href="../275949/index.html">Course for beginners. The Basics of IP Telephony on Cisco Packet Tracer</a></li>
<li><a href="../275951/index.html">A few things to remember about the age programmer</a></li>
<li><a href="../275953/index.html">Experience home rover</a></li>
<li><a href="../275957/index.html">How to specify date ranges in interfaces?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>