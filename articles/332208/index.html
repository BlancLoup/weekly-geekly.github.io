<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Solving the traveling salesman problem with the Little algorithm with visualization on the plane</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The traveling salesman problem, known at least since the 19th century, has many solutions and has been repeatedly described. Its optimization version ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Solving the traveling salesman problem with the Little algorithm with visualization on the plane</h1><div class="post__text post__text-html js-mediator-article"><p>  The traveling salesman problem, known at least since the 19th century, has many solutions and has been repeatedly described.  Its optimization version is NP-hard, so the optimal solution can be obtained either by brute-force or by optimized brute-force - by the branch and bound method. </p><br><p>  Trying to program the Little algorithm (a special case of the branch and bound method), I realized that in RuNet it is extremely difficult to find its correct description in a clear language and a disassembled software implementation.  However, abundant descriptions are deceptively plausible on small data and are difficult to verify without visualization. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d38/d7d/262/d38d7d262f71d6d2775d0bd7d61b3b0a.gif" alt="animation"></p><a name="habracut"></a><br><h2 id="metod-vetvey-i-granic">  Branch and Bound Method </h2><br><p>  The Little algorithm is a special case of M &amp; G, i.e.  in the worst case, its complexity is equal to the complexity of complete enumeration.  The theoretical description is as follows: </p><br><p>  There is a set S of all Hamiltonian cycles of a raf.  At each step in S, an edge (i, j) is sought, the exclusion of which from the route will maximally increase the estimate from below.  Then the set is divided into two non-intersecting S1 and S2.  S1 - all cycles containing an edge (i, j) and not containing (j, i).  S2 - all cycles not containing (i, j).  Further, a lower estimate is calculated for the length of the path of each set and, if it exceeds the length of the solution already found, the set is discarded.  If not, the sets S1 and S2 are treated the same way as S. </p><br><h2 id="algoritmicheskoe-opisanie">  Algorithmic description </h2><br><p>  There is a distance matrix M. The diagonal is filled with infinite values, because  there should be no premature cycles.  There is also a variable storing the lower bound. </p><br><p>  It is necessary to make a reservation that you need to keep records of two types of infinity - one is added after removing the row and column from the matrix, so that there are no premature cycles, the other - when the edges are dropped.  Cases will be reviewed later.  The first infinity is denoted as inf1, the second - inf2.  Diagonal filled inf1. </p><br><ol><li>  The minimum element of the given line is subtracted from each element of each line.  At the same time, the minimum element of the string is added to the bottom border. </li><li>  The minimum element is similarly subtracted from each column and added to the lower boundary. </li><li>  For each zero element M (i, j), a coefficient is calculated that is equal to the sum of the minimum elements of row i and column j, excluding the element itself (i, j).  This coefficient shows how guaranteed the lower bound of the solution increases, if we exclude the edge (i, j) from it </li><li>  Looking for an element with a maximum coefficient.  If there are several of them, you can choose any (all the same, the rest will be considered in the next steps of recursion) </li><li>  Two matrices are considered - M1 and M2.  M1 is equal to M with deleted row i and column j.  It contains the column k and the string l, which do not contain inf1 and the element M (k, l) equals inf1.  As mentioned earlier, this is necessary in order to avoid premature cycles (that is, in the first stages (k, l) == (j, i)).  The matrix M1 corresponds to the set containing the edge (i, j).  Along with the removal of the column and row, the edge (i, j) is included in the path. </li><li>  M2 is equal to the matrix M, for which the element (i, j) is equal to inf2.  The matrix corresponds to a set of paths that do not contain an edge (i, j) (it is important to understand that the edge (j, i) is not excluded here). </li><li>  Go to step 1 for matrices M1 and M2. </li></ol><br><p>  The heuristic is that the lower bound of the matrix M1 is no larger than that of the matrix M2, and the branch containing the edge (i, j) is considered first of all. </p><br><h2 id="primer">  Example </h2><br><p>  There are a huge number of examples on the Internet, but the really interesting is in <a href="https://habrahabr.ru/post/246437/">this article</a> with well-illustrated trees (the only article I found that also indicates a common mistake, but unfortunately, the algorithmic description of the algorithm is not enough - first about matrices, then about sets ).  An interesting example is that if we consider only branches with edges with a maximum penalty, an incorrect result will be obtained. </p><br><p>  So here are the steps to find the optimal path for this matrix. </p><br><table><thead><tr><th></th><th>  0 </th><th>  one </th><th>  2 </th><th>  3 </th><th>  four </th></tr></thead><tbody><tr><td>  0 </td><td>  <strong>inf</strong> </td><td>  20 </td><td>  18 </td><td>  12 </td><td>  eight </td></tr><tr><td>  one </td><td>  five </td><td>  <strong>inf</strong> </td><td>  14 </td><td>  7 </td><td>  eleven </td></tr><tr><td>  2 </td><td>  12 </td><td>  18 </td><td>  <strong>inf</strong> </td><td>  6 </td><td>  eleven </td></tr><tr><td>  3 </td><td>  eleven </td><td>  17 </td><td>  eleven </td><td>  <strong>inf</strong> </td><td>  12 </td></tr><tr><td>  four </td><td>  five </td><td>  five </td><td>  five </td><td>  five </td><td>  <strong>inf</strong> </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">Step by step solution</b> <div class="spoiler_text"><pre><code class="hljs css">0 1 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 20<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 18<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 12<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 8<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 14<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 7<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 11<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 12<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 18<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 11<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 11<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 17<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 11<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 12<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 1 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 12<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 12<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (4, 1) 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (3, 2) 0 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (0, 4) 0 3 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">candidate</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">solution</span></span>(4 1) (3 2) (0 4) (1 3) (2 0) <span class="hljs-selector-tag"><span class="hljs-selector-tag">cost</span></span>: 43; <span class="hljs-selector-tag"><span class="hljs-selector-tag">record</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">NEW</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">RECORD</span></span> 0 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">not</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (0, 4) 0 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">limit</span></span>: 44; <span class="hljs-selector-tag"><span class="hljs-selector-tag">record</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:43</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">DISCARDING</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">BRANCH</span></span> 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">not</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (3, 2) 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">limit</span></span>: 44; <span class="hljs-selector-tag"><span class="hljs-selector-tag">record</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:43</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">DISCARDING</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">BRANCH</span></span> 0 1 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 12<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 12<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">not</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (4, 1) 0 1 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 12<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 12<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 1 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (3, 1) 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (0, 4) 0 2 3 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 2 3 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (4, 2) 2 3 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">candidate</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">solution</span></span>(3 1) (0 4) (1 0) (2 3) (4 2) <span class="hljs-selector-tag"><span class="hljs-selector-tag">cost</span></span>: 41; <span class="hljs-selector-tag"><span class="hljs-selector-tag">record</span></span>: 43 <span class="hljs-selector-tag"><span class="hljs-selector-tag">NEW</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">RECORD</span></span> 0 2 3 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">not</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (2, 0) 0 2 3 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 2 3 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 2 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">limit</span></span>: 56; <span class="hljs-selector-tag"><span class="hljs-selector-tag">record</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:41</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">DISCARDING</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">BRANCH</span></span> 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">not</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (0, 4) 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">limit</span></span>: 50; <span class="hljs-selector-tag"><span class="hljs-selector-tag">record</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:41</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">DISCARDING</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">BRANCH</span></span> 0 1 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">not</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edge</span></span> (3, 1) 0 1 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">After</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">subtracting</span></span>: 0 1 2 3 4 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 2 6<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 3 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 4 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf2</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.00</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">limit</span></span>: 47; <span class="hljs-selector-tag"><span class="hljs-selector-tag">record</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:41</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">DISCARDING</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">BRANCH</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Solution</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">tour</span></span>: 0 4 2 3 1 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Tour</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">length</span></span>: 41</code> </pre> </div></div><br><h2 id="realizaciya">  Implementation </h2><br><h5 id="shag-1">  Step 1 </h5><br><p>  Getting zeros in each row and each column. </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> LittleSolver::subtractFromMatrix(MatrixD &amp;m) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     double subtractSum = 0; //        vector&lt;double&gt; minRow(m.size(), DBL_MAX), minColumn(m.size(), DBL_MAX); //    for (size_t i = 0; i &lt; m.size(); ++i) { for (size_t j = 0; j &lt; m.size(); ++j) //      if (m(i, j) &lt; minRow[i]) minRow[i] = m(i, j); for (size_t j = 0; j &lt; m.size(); ++j) { //      //  ,   if (m(i, j) &lt; _infinity) { m(i, j) -= minRow[i]; } //         if ((m(i, j) &lt; minColumn[j])) minColumn[j] = m(i, j); } } //      //  ,   for (size_t j = 0; j &lt; m.size(); ++j) for (size_t i = 0; i &lt; m.size(); ++i) if (m(i, j) &lt; _infinity) { m(i, j) -= minColumn[j]; } //    for (auto i : minRow) subtractSum += i; for (auto i : minColumn) subtractSum += i; return subtractSum; }</span></span></code> </pre> <br><h5 id="shag-2">  Step 2 </h5><br><p>  Increase the lower bound and compare it with a record. </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//       //    bottomLimit += subtractFromMatrix(matrix); //      if (bottomLimit &gt; _record) { return; }</span></span></code> </pre> <br><h5 id="shag-3">  Step 3 </h5><br><p>  The calculation of the coefficients. </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> LittleSolver::getCoefficient(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MatrixD &amp;m, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> r, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> c) { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> rmin, cmin; rmin = cmin = DBL_MAX; <span class="hljs-comment"><span class="hljs-comment">//     for (size_t i = 0; i &lt; m.size(); ++i) { if (i != r) rmin = std::min(rmin, m(i, c)); if (i != c) cmin = std::min(cmin, m(r, i)); } return rmin + cmin; }</span></span></code> </pre> <br><p>  Search all zero elements and calculate their coefficients. </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//     list&lt;pair&lt;size_t, size_t&gt;&gt; zeros; //    list&lt;double&gt; coeffList; //   double maxCoeff = 0; //    for (size_t i = 0; i &lt; matrix.size(); ++i) for (size_t j = 0; j &lt; matrix.size(); ++j) //    if (!matrix(i, j)) { //     zeros.emplace_back(i, j); //       coeffList.push_back(getCoefficient(matrix, i, j)); //    maxCoeff = std::max(maxCoeff, coeffList.back()); }</span></span></code> </pre> <br><h5 id="shag-4">  Step 4 </h5><br><p>  Drop zero elements with non-maximal coefficients. </p><br><pre> <code class="cpp hljs">{ <span class="hljs-comment"><span class="hljs-comment">//    auto zIter = zeros.begin(); auto cIter = coeffList.begin(); while (zIter != zeros.end()) { if (*cIter != maxCoeff) { //    ,     zIter = zeros.erase(zIter); cIter = coeffList.erase(cIter); } else { ++zIter; ++cIter; } } } return zeros;</span></span></code> </pre> <br><h5 id="shag-5">  Step 5 </h5><br><p>  Jump to a set containing an edge with a maximum penalty. </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> edge = zeros.front(); <span class="hljs-comment"><span class="hljs-comment">//   auto newMatrix(matrix); //      ,    newMatrix.removeRowColumn(edge.first, edge.second); //  iter    auto newPath(path); newPath.emplace_back(matrix.rowIndex(edge.first), matrix.columnIndex(edge.second)); //       addInfinity(newMatrix); //  ,   edge handleMatrix(newMatrix, newPath, bottomLimit);</span></span></code> </pre> <br><h5 id="shag-6">  Step 6 </h5><br><p>  Jump to a set that does not contain an edge with a maximum penalty. </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,    edge //      newMatrix = matrix; //     iter newMatrix(edge.first, edge.second) = _infinity + 1; //  ,    edge handleMatrix(newMatrix, path, bottomLimit);</span></span></code> </pre> <br><h3 id="sravnenie-mvig-s-polnym-pereborom">  Brute force comparison </h3><br><p>  Despite the fact that the branch and bound method is at best no better than complete enumeration, in most cases it gains much time in time thanks to heuristics for finding the initial solution and discarding obviously bad sets. </p><br><p>  Below are graphs comparing MVG with full brute force and the average time of the algorithm I implemented on a different number of cities.  Tested on matrices for randomly generated points. </p><br><p>  Comparison of the branch and bound method with brute force. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f48/3d4/0ed/f483d40ed11d4ababcfcfbc5d1a305ec.png" alt="compare"></p><br><p>  Starting with 9 cities, brute force is noticeably losing.  Starting with 13 cities brute force takes more than a minute. </p><br><p>  Working hours of the Ministry of Foreign Affairs on a different number of cities </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d4b/1ac/ab6/d4b1acab63999b4e19369598dffd215f.png" alt="time"></p><br><h3 id="graficheskoe-prilozhenie">  Graphic application </h3><br><p>  A graphical interface was also made on Qt with the ability to dynamically look at the solution process.  Just his working area on the gif in the header of the article.  They can compile and touch the prog with their hands. </p><br><p>  The yellow color indicates the best path found and its length is in the "Tour length" field. </p><br><p>  Black marks the edges that are in the last viewed set. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a9f/f96/af9/a9ff96af938531f7e6ab9dc76e3890ed.png" alt="gui"></p><br><p>  For dynamic mapping, the problem must be solved either step-by-step, or in a stream parallel to the graphical interface.  Since  the main solution function is recursive, the second option was chosen, which made it necessary to add a mutex to the decision class, and make the record variable atomic and in some methods take care of thread safety. </p><br><h4 id="vmesto-zaklyucheniya">  Instead of conclusion </h4><br><p>  I hope this article will help those who want to implement this algorithm or have already implemented and do not understand why it gives the wrong result. </p><br><p>  ‚Üí <a href="https://bitbucket.org/iminchenko/visualtsp/src/">Source Code</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/332208/">https://habr.com/ru/post/332208/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../332198/index.html">Introduction to procedural animation: inverse kinematics</a></li>
<li><a href="../332200/index.html">VeeamON 2017: what marketers do not write in blogs</a></li>
<li><a href="../332202/index.html">About analytics and silver bullets or ‚ÄúWhat does Rambler / Top 100 have to do with it?‚Äù</a></li>
<li><a href="../332204/index.html">GitLab 9.3 released: Code Quality and inter-project pipeline schedules</a></li>
<li><a href="../332206/index.html">How to repeat anyroom.io service in several JS lines and without a backend</a></li>
<li><a href="../332214/index.html">IBM Watson and cybersecurity: how a cognitive system protects valuable data</a></li>
<li><a href="../332260/index.html">Work with VPC using the package ansible-selvpc-modules</a></li>
<li><a href="../332264/index.html">Conducting a retrospective of the method of six hats</a></li>
<li><a href="../332292/index.html">Translation of Redmine plug-ins from TelegramCLI to Webogram</a></li>
<li><a href="../332294/index.html">The complete guide to moving from HTTP to HTTPS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>