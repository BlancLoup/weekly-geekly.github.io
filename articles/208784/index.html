<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How a good piece of hardware was made excellent - an overview of EMC VNX storage systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="EMC data storage systems are like a good German machine. You know that you overpay a little for the brand, but data security and sensitivity of manage...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How a good piece of hardware was made excellent - an overview of EMC VNX storage systems</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/496/60d/2cb/49660d2cb480216bf84e2e44a471736d.png" alt="image"><br><br>  <b>EMC data storage systems</b> are like a good German machine.  You know that you overpay a little for the brand, but data security and sensitivity of management are provided.  And service: premium warranty, for example, delivery of spare parts within 4 hours with the departure of the engineer if necessary. <br><br>  A relatively recently released new line of equipment, the flagship of which allows you to put up to 1500 drives - a total of <b>6 PB</b> .  Below is its overview with a brief educational program about <abbr title="Data storage systems">storage</abbr> at all.  And the story of how really good things made it even better. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Right away </h4><br>  I know that immediately ask for the cost.  She is tall.  You need to pay at least thirty thousand dollars.  For this money they give a fully fault-tolerant configuration with powerful functionality, three-year support and updated software, which will be discussed below.  That is, the system is far from home and not even for small business. <br><br>  The most important thing that you get for this money: the frightening words of <abbr title="Data unavailability / Data loss">DU / DL</abbr> will no longer appear in the reports.  And this is the worst combination for service engineers and customers.  Reducing the risk of downtime or data loss is what the CIO is prepared to fight by any means. <br><br><h4>  Why are hybrid storage systems needed? </h4><br>  First, a little history.  Multi-level storage is a combination of fast and cheap, but capacious disks in one data file.  There was the possibility of such a combination even when we only dreamed about flash-disks because of their cosmic value.  So, there is a myth that this chip was invented to improve performance.  And no!  Initially, such storage was used to save: put data that is not used on slow and cheap disks.  It means you need less fast data - only for ‚Äúhot‚Äù data. <br><br>  Then SSD tightly entered our lives.  It was logical to add some seasonings from SSD to our ‚Äúsoup‚Äù from fast and slow disks.  The fastest and ‚Äúhottest‚Äù data, only 5-10 percent of the total, now fell on them.  The updated VNX storage systems are already the third generation of hybrid arrays in which they, in my opinion, have succeeded to fame. <br><br>  So, on the one hand, we have solutions that consist entirely of computational and flash-modules.  They work with hot data at a speed close to DRAM rather than to classic HDD, but at the same time such systems are very expensive when recalculating the cost of a gigabyte of stored data.  As a rule, they are used where you need to constantly "grind" 10-20 terabytes with great speed.  An example is high-load DBMS, VDI.  On the other hand, systems on classic mechanical disks do not allow working with data so quickly, but they make it possible to store a lot of them (the cost per gigabyte stored can be much lower). <br><br>  However, in most cases, you must simultaneously have a large amount of storage and quickly provide access to the ‚Äúhot‚Äù data.  An example would be typical tasks for storage systems, when you need to store some DBMS simultaneously with virtualization volumes, mail, archives, etc ... In these cases, either Flash-storage systems + classic storage systems or mixed (hybrid) storage systems are used.  Today we are talking about the latest - supporting both flash drives and classic drives in one system. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/99c/551/1cc/99c5511ccc9af089e564df02533bd1b3.png" alt="image"><br><br>  So, the system of the previous generation was already very good.  She herself was able to work with flash-modules and was able to do everything that is needed to work with high-loaded applications.  In general, it might seem that doing something better is quite difficult, and a further increase in productivity is possible only at the expense of iron.  But no, the developers succeeded, by making major changes to the software part of the platform, to achieve just a huge performance gain. <br><br><h4>  New generation </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/700/94a/094/70094a0945a7861429cf412107125d01.png" alt="image"><br>  <i>Here are the things.</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/091/794/b6a/091794b6a6358d9c9d43ceb3f7286e5c.png" alt="image"><br><br>  <b>First, the new EMC is designed for large volumes</b> .  The flagship allows you to put up to 1500 discs.  One of our clients, by the way, these 6 PBs can be useful, since there are quite a lot of data there - but in practice there have not been more deployments than 2PB yet. <br><br>  <b>Everything works faster.</b>  There is more cache, X-BLADE (file servers) are now more optimized.  Yes, yes, do not forget that access to this storage system can be either block (FC, iSCSI, FCoE) or file (CIFS, NFS). <br><br>  <b>Added new block deduplication.</b>  About her and other software details below. <br><br>  <b>Updated hardware component.</b>  Block controllers can now work with full SSD configuration and support up to 32 cores. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dfd/9d7/84a/dfd9d784aa9d07eeb25fa09a4458afd6.png" alt="image"><br>  <i>Block Controller Architecture</i> <br><br>  <b>The main differences from the previous line (more below)</b> <br><ul><li>  Multi-core MCx architecture (R5.33): 4 times more performance than previous generation, multi-core Cache and FAST Cache management, multi-thread RAID management </li><li>  FAST VP update </li><li>  Synchronous Active / Active LUN mode </li><li>  Virtual Recoverpoint (vRPA) </li><li>  Supports HyperV ODX and SMB 3.0 </li></ul><br><h4>  Iron </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/80b/f4f/915/80bf4f915f9378b655016a1d3a7cf924.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/410/73d/4d8/41073d4d83b80947fd24a482583be7a3.png" alt="image"><br><br>  A new hardware constructive controller has appeared - everything except the flagship uses the new DPE platform.  Of the major changes is another backup power module.  Fail-safe power batteries are built into the controller for all models except the flagship.  In the older model, there are still batteries, but now there are not 2, but 4 of them, and they are now much more convenient to replace. <br><br>  The layout of the controllers and shelves is the same as before (VNX8000 is an exception): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/305/f70/447/305f70447c8329b0607c652d42fc4c84.png" alt="image"><br><br>  Take a look at the wheels: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f29/a06/f4b/f29a06f4b00fc9f8f505557885dcd729.png" alt="image"><br><br>  Now flash drives are divided into two categories: ultrafast (eMLC) is used for cache and level storage, regular (just MLC) - only for level storage. <br><br><h4>  Soft </h4><br>  The basic functionality of the software "out of the box" is now also more, but this, in general, was expected. <br><br>  What is interesting - new software chips have appeared.  For example, I was very pleased with the <b>new approach to the allocation of processor resources.</b>  Previously, the process received a certain number of cores and worked only for them.  That is, with unequal loads of certain processes (quite frequent for real systems) there was an uneven load on the cores.  Somewhere the core could be idle, but somewhere the load was close to 100%.  The new architecture has taken a step towards greater virtualization ‚Äî dynamic resource sharing and multi-thread processing. <br><br>  <b>Completely redesigned cache.</b>  Previously, the memory was divided into 2 areas: a cache for writing and a cache for reading.  These two buffers did not intersect.  Accordingly, one did the optimization of writing data to disk optimal blocks, and the second predicted the reading of the following blocks.  So, on the new arrays, the work of the cache is completely reorganized, the arrays now use the dynamic cache, which is responsible for both tasks simultaneously without splitting the memory into different areas.  This approach not only allowed more efficient use of memory space, but also dramatically increased performance.  On typical loads, according to the manufacturer, this very magically increases cache speed up to 5 times. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/04c/935/8a6/04c9358a6c7b5baf7fb50852cf16a026.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/03b/2d1/342/03b2d13428380e471ccee74b515173f2.png" alt="image"><br><br>  <b>Reworked Fast Cache</b> - these are flash-drives used as an additional cache.  He is now given more processor resources due to the dynamic allocation of resources.  Plus, under Fast Cache, faster eMLC drives are now delivered.  As a result, the developers were able to use more aggressive algorithms, which makes warming up the cache much faster.  At the same time, the engineers, along with the developers of the classic cache algorithms, walked through the drivers and rewrote them under the modular principle, which also greatly improved performance and lowered the response time of a single treatment. <br><br>  <b>Fully Automated Storage Tiering Virtual Pool (FAST VP).</b>  This is the very mechanism of combining various disks into a single "pool".  It was also significantly reworked and more closely integrated with FAST cache.  By the way, the granularity of Fast VP is reduced 4 times and now the data is moved in chunks of 256 MB each. <br><br>  Here, probably, it will be relevant to return to the beginning, where I said that mixing discs does not lead to an increase in performance.  Now, when we were able to use the SSD for storage and as a cache, we can talk about speed and the efficiency of data storage and processing. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f3/a1b/704/6f3a1b70493c5974868468144acc194d.png" alt="image"><br><br>  <b>New block deduplication.</b>  The principle is as old as the world: data is broken into blocks, the same blocks are stored once.  For duplicate blocks, links to the same blocks as in archives are used.  Now all this is very much "sharpened" for virtual environments. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2f/494/945/c2f4949454296ebf22c7209960f76ec5.png" alt="image"><br><br>  On new storage deduplication occurs on schedule.  For example, applications write data to the pool without deduplication during the working period.  Then, at the time of reducing the load, the storage engine begins analyzing the recorded data and compressing it by removing duplicates.  All this is in great agreement with fast-cache (since the load on deduplicated blocks will increase, and their number will naturally decrease, as a result, they will move to fast-cache).  In practice, this means that subjectively more data will fit in the fast cache.  This greatly speeds up the work of the array.  Two of the most typical types of load maximize the benefits from the new mechanism: <br><ul><li>  Single-type virtual environments, such as VDI. </li><li>  Multiple applications for one data set. </li></ul><br><br>  The estimated savings for such loads will be: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e5/cdd/fa2/1e5cddfa2a1d83c5609817720005bd0b.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f9/d76/c9a/8f9d76c9a3339c1815d808856dc4c9bf.png" alt="image"><br><br>  <b>The new principle of working with disks.</b>  EMC also changed the principle of working with disks.  Earlier, the disk address was rigidly attached to its physical location in the shelf, in the new generation the system remembers disks by their unique identifiers, which makes it possible not to become attached more to the location of disks in the system.  It seems to be an insignificant change, however, how easy it is now to move the array to another site!  After all, now you can not suffer from the location of the disks in the same manner as before.  And the problem of unbalanced load on the back-end can be solved simply by orders of magnitude easier and faster: rearranged the disks one by one - and that's ready, you don't even need to put out the base.  And now, if necessary, part of the data can be physically pulled out of the array and taken away for a while to another site, such a kind of hot backup is obtained, I think, you will figure out why you might need it. <br><br>  Added Permanent Sparing technology has proven itself on Hi-end systems.  In addition, now there is no need to allocate special disks for hot swapping, the array will use the default maximum suitable non-occupied disk. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/669/665/38b/66966538bb9a07a258dcdc0e014e7eef.png" alt="image"><br><br>  <b>There are important changes in the principle of disk access by the controller.</b>  Initially, in the mid-range systems, one controller worked with disks, and the access paths of other controllers were used only for failures.  At failure, the volume moved to another controller.  This meant that if a certain array requires full system resources, it can theoretically even get no more than 50% of the total system resources - from a single controller.  This problem was partially solved in 2 past lines: the ALUA mechanism appeared.  The essence of the mechanism: the transfer of host requests to the controller to the owner of the volume through the cache synchronization interface.  Unfortunately, the bandwidth of this interface is far from unlimited and the call to the controller to the volume owner is still processed faster.  The paths began to be divided into optimal and non-optimal instead of active and passive.  Roughly speaking, in the ideal case - up to 75% of the array capacity on that.  In the new generation, the developers have gone further.  Without changing the hardware structure (!), They changed the logic of the array to Active-Active.  Now both controllers simultaneously write to different areas simultaneously, simply blocking their area during recording. <br><br>  In practice, if we use an array for one task, we can use a cheaper younger storage model.  And the load balancing on the tracks becomes much easier.  Plus, earlier, when the LUN moved under the control of another controller, there were serious delays in the processing of external I / O calls, and now there will be neither. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a31/52a/643/a3152a643d0b7e7769b7425629ffd387.png" alt="image"><br><br>  <b>Updated software for the array.</b>  Externally, the interface to work with an array has not changed much.  According to my subjective assessment, this was, as it was, and remained (fortunately) the most convenient interface for DSS - 99% of tasks are done in a couple of clicks right in the web interface.  Exotic, of course, requires a console. <br><br>  In the basic package now comes a very useful new long-term monitoring tool.  You can see the reports on the file and block parts - a bunch of metrics.  Makes it easy to find bottlenecks.  Another tool based on these metrics allows you to plan the expansion of the infrastructure - so that the administrator does not count with his hands what and how much is needed next year. <br><br>  <b>Another very important thing for virtual environments.</b>  Arrays still support tight integration with virtualization systems.  If anyone knows, VMware is a division of EMC (rather independent, but division).  Hence, the joint work of VMware programmers and storage developers.  The consequence is convenient seamless and extremely deep integration.  Virtual machines are integrated into the storage interface (monitoring machine resources at the storage level), typical loads for copying and cloning machines can be shifted to the array itself, typical tasks for managing storage systems can be done from the VMware infrastructure interface. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d07/e9d/3ec/d07e9d3ec58a74ac1ad80c560a2f38e9.png" alt="image"><br><br>  Strange as it may seem, there are similar advantages for Hyper-V (since the EMC has been working closely with MS for a very long time, the work of the developers has historically formed together).  Almost the same level of integration depth: general management, infrastructure unloading.  There are special chips for MS - for example, Branch Cahe unloads the network infrastructure with weak communication channels.  Yes!  EMC VNX is the first storage system with SMB 3.0 support. <br><br>  For now.  Questions can be asked in the comments or by e-mail <b>VBolotnov@croc.ru</b> .  As regards the cost for specific tasks, I can orient rather quickly with concrete calculations - if necessary, request, not a problem. <br><br>  Yes.  We have already twisted our VNX5400 demo system in our hands and gave it to testing for one of the customers who are planning to update their storage systems this year.  She will be back soon, so if anyone is interested in feeling the real system on her own, you can come to our office and look at the EMC Solution Center.  Write, agree on a date. <br><br>  <b>UPD</b> : If anything, we have a <a href="http://www.croc.ru/SC/data_domain.php">program to</a> replace tape and disk libraries with new EMCs. </div><p>Source: <a href="https://habr.com/ru/post/208784/">https://habr.com/ru/post/208784/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208772/index.html">Fantastic series - fan review</a></li>
<li><a href="../208774/index.html">Why do we all need SAT and all these P-NPs (part two)</a></li>
<li><a href="../208778/index.html">HHVM, Nginx and PHP (as well as Laravel)</a></li>
<li><a href="../208780/index.html">Real Time Operating Systems for Beginners</a></li>
<li><a href="../208782/index.html">SoftEther VPN - an advanced multi-protocol VPN server and client</a></li>
<li><a href="../208786/index.html">Packet crafting as it is</a></li>
<li><a href="../208788/index.html">Seamless splitting and splicing video with DirectShow</a></li>
<li><a href="../208792/index.html">Data Virtualization in WPF</a></li>
<li><a href="../208796/index.html">Domestic MOOC provider - Universarium</a></li>
<li><a href="../208798/index.html">Google Glass as a regular tool for data center employees</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>