<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why sql?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When we gave a general description of the architecture of our service on our English-language technical blog, readers who have experience with other l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why sql?</h1><div class="post__text post__text-html js-mediator-article">  When we gave a <a href="http://habrahabr.ru/company/evernote/blog/120319/">general description of the architecture of our service</a> on our English-language technical blog, readers who have experience with other large services, the most frequent questions were: <br><ol><li>  Why are your structured data stored in SQL databases instead of using NoSQL solutions? </li><li>  Why do you use your own hardware instead of using cloud hosting services? </li></ol><br>  Both of these questions are logical and interesting.  Today we will respond to the first, and the second we will save for a separate post. <br><br>  When properly applied, a modern data storage mechanism in associative arrays (key-value) can provide significant performance and scalability compared to a single instance of a SQL server.  However, there are several reasons why we decided to post all the data of your MySQL account. <br><a name="habracut"></a><br><br><h3>  SQL benefits </h3><br>  For starters, <a href="http://en.wikipedia.org/wiki/ACID">ACID properties of</a> transactional databases, such as InnoDB with MySQL, are essential for our application and <a href="http://www.evernote.com/about/developer/api/edam-sync.pdf">synchronization model</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Here is a small fragment of the database tables for storing notebooks and notes in the server database: <br><br> <code>CREATE TABLE notebooks ( <br> id int UNSIGNED NOT NULL PRIMARY KEY, <br> guid binary(16) NOT NULL, <br> user_id int UNSIGNED NOT NULL, <br> name varchar(100) COLLATE utf8_bin NOT NULL, <br> ... <br> ) ENGINE=InnoDB DEFAULT CHARSET=utf8; <br> <br> CREATE TABLE notes ( <br> id int UNSIGNED NOT NULL PRIMARY KEY, <br> guid binary(16) NOT NULL, <br> user_id int UNSIGNED NOT NULL, <br> notebook_id int UNSIGNED NOT NULL, <br> title varchar(255) NOT NULL, <br> ... <br> FOREIGN KEY (notebook_id) REFERENCES notebooks(id) <br> ) ENGINE=InnoDB DEFAULT CHARSET=utf8; <br></code> <br>  If you create a notebook called ‚ÄúRecipes‚Äù on your Windows client Evernote, and then immediately copy your favorite casserole recipe into this notebook, your client will do the following at the next sync: <br><ul><li>  <a href="http://www.evernote.com/about/developer/api/ref/NoteStore.html">Call NoteStore.createNotebook ()</a> to request creation of a <a href="http://www.evernote.com/about/developer/api/ref/Types.html">notepad</a> on the server.  That will return him the identifier (GUID) of the created notepad. </li><li>  <a href="http://www.evernote.com/about/developer/api/ref/NoteStore.html">Call NoteStore.createNote ()</a> to request the creation of a <a href="http://www.evernote.com/about/developer/api/ref/Types.html">note</a> on the server with the already specified notepad GUID. </li></ul><br>  Each of these high-level API requests is done through a single SQL transaction that ensures that the client can completely trust any server response. <br><br>  ACID-compatible database provides such advantages as: <br><br>  <b>Atomicity</b>  If the API call is successful, then 100% of the changes will be executed, and if the API call fails, none of them will be made.  This means that if we fail to place the fourth image in your note, then your account will not have a half-formed note, which, moreover, will be calculated from the remaining monthly volume for downloading data. <br><br>  <b>Consistency</b>  At the end of any API call, the account is in a fully operational and internally consistent state.  Each note has its own notebook, and none of them is in limbo.  The database will not allow us to delete the notebook, in which there are still notes, thanks to the FOREIGN KEY constraint. <br><br>  <b>Warranty</b>  When the server reports that a notebook has been created, the client may assume that he already has a notebook and take this into account in further operations (such as a call to create a note).  This change is guaranteed, and the client knows that it consistently reflects the state of the service at any time. <br><br>  The principle of warranty plays the most important role for our synchronization protocol.  If the client application would not be sure that the changes made by the service were guaranteed to occur, the synchronization protocol would become much more complicated and less effective.  Each synchronized client would have to constantly check the compliance of each server object with the current situation.  Such an implementation of absolute control over consistency for an account with 20 thousand notes, 40 thousand resource files and 10 thousand tags would be extremely expensive if the changes did not imply a warranty. <br><br><h3>  How about a lot of data? </h3><br>  The advantages of ACID in the case of a transactional database make it very difficult to scale data beyond the limits of a single server.  Database clustering and replication with multiple master servers is very dark, and associative data warehouses provide a much simpler approach to scaling a single repository to multiple servers. <br><br>  Fortunately, Evernote doesn't need to solve this problem right now.  Although we already have about a billion notes and almost 2 billion resource files on servers, this is actually not a single large data set ‚Äî these are 20 million individual sets, one per user. <br><br>  Such fragmentation means that we do not have the problem of storing a large single amount of data, we are dealing with the storage of a variety of isolated data sets of average size, which neatly falls into our server shard architecture. <br><br><h3>  Maybe in the future‚Ä¶ </h3><br>  We, meanwhile, are trying to keep abreast of modern technologies in the field of data storage for future projects that do not require strict transaction ACID and provide horizontal scalability.  For example, our reporting and analytics system has already outgrown the capabilities of the MySQL platform and needs to be replaced with something larger, faster and more interesting. <br><br>  However, we are quite satisfied with the existing MySQL-storage of user data, although it is not so cool in the opinion of some guys. </div><p>Source: <a href="https://habr.com/ru/post/139021/">https://habr.com/ru/post/139021/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139008/index.html">Live wallpaper on Android without native code or the story of writing Two Hearts Live Wallpaper</a></li>
<li><a href="../139010/index.html">New mobile applications "Rambler News"</a></li>
<li><a href="../139012/index.html">Comparison of compression programs as applied to transferring large amounts of data</a></li>
<li><a href="../139016/index.html">A simple and secure way to transfer user data to a non-system disk.</a></li>
<li><a href="../139017/index.html">Performance comparison of IoC containers under Windows Phone</a></li>
<li><a href="../139022/index.html">Recommender systems: problem statement</a></li>
<li><a href="../139023/index.html">The second long-awaited Dropquest 2012 from Dropbox.com</a></li>
<li><a href="../139024/index.html">Twitter Screensaver</a></li>
<li><a href="../139025/index.html">How many laws do you need for happiness?</a></li>
<li><a href="../139026/index.html">Custom assembly of plugins - we will go the other way</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>