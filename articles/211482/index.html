<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unity3D WWW Wrapper</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! I decided to share my bike for working with WWW in Unity3D. 

 What is WWW? 

 WWW is a class that allows you to send web requests to a specifi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unity3D WWW Wrapper</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/c6c/e85/8b5/c6ce858b5b5d4e6ff026422355949b93.jpg"><br>  Hello!  I decided to share my bike for working with WWW in Unity3D. <br><br>  What is WWW? <br><br>  <b>WWW</b> is a class that allows you to send web requests to a specified URL and receive an answer in the form of text, texture, download bundles.  More details can be found in the help ( <a href="http://docs.unity3d.com/Documentation/ScriptReference/WWW.html">klats</a> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I will focus on text data format. <br><br><h5>  Prerequisites </h5><br>  Sometimes there is a task to associate the game with the server, written in Php (although you can use any other yap to scan the backend part).  All the time send requests in the form of new WWW (Address + "? Api = login &amp; username = ...");  It is not convenient, I want to make it more convenient to work with sending / receiving data. <br><br>  There is another catch: requests are sent synchronously, blocking the main thread.  There is an option to use korutiny to avoid this. <br><br>  As a result, the thought was ripe to write something that could simplify life for working with WWW.text. <br><a name="habracut"></a><br><h5>  Implementation </h5><br>  Usually it is required to pull some method on the server that will return the result.  The list method can be shoved into enum, and then expanded as needed: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> PacketTypes { nil, auth, updateinfo }</code> </pre> <br><br>  Next will be the request / response objects, represented by the <u>NetRequest</u> and <u>NetResponse classes,</u> respectively.  They hide the format of data exchange and store them in a Dictionary (universally).  NetRequest allows you to get a query string to send to the server via <u>GetParamsString ()</u> .  NetResponse contains ready-to-use data, and also allows you to check the response to an error through <u>IsError</u> . <br><br>  It also uses a certain class HttpUtility (not from System.Web, by Patrik Torstensson), which allows you to encode characters (space, quotes, etc.).  The reason is that System.Web for Unity3d does not have this class.  I will cite only the source, we will not consider. <br><br><div class="spoiler">  <b class="spoiler_title">HttpUtility.cs</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// // System.Web.HttpUtility // // Authors: // Patrik Torstensson (Patrik.Torstensson@labs2.com) // Wictor Wil√©n (decode/encode functions) (wictor@ibizkit.se) // Tim Coleman (tim@timcoleman.com) // Gonzalo Paniagua Javier (gonzalo@ximian.com) // // Copyright (C) 2005 Novell, Inc (http://www.novell.com) // // Permission is hereby granted, free of charge, to any person obtaining // a copy of this software and associated documentation files (the // "Software"), to deal in the Software without restriction, including // without limitation the rights to use, copy, modify, merge, publish, // distribute, sublicense, and/or sell copies of the Software, and to // permit persons to whom the Software is furnished to do so, subject to // the following conditions: // // The above copyright notice and this permission notice shall be // included in all copies or substantial portions of the Software. // // THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, // EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF // MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND // NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE // LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION // OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION // WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. // using System.Collections; using System.Collections.Specialized; using System.Globalization; using System.IO; using System.Text; using System; public sealed class HttpUtility { #region Fields static Hashtable entities; static object lock_ = new object(); #endregion // Fields static Hashtable Entities { get { lock (lock_) { if (entities == null) InitEntities(); return entities; } } } #region Constructors static void InitEntities() { // Build the hash table of HTML entity references. This list comes // from the HTML 4.01 W3C recommendation. entities = new Hashtable(); entities.Add("nbsp", '\u00A0'); entities.Add("iexcl", '\u00A1'); entities.Add("cent", '\u00A2'); entities.Add("pound", '\u00A3'); entities.Add("curren", '\u00A4'); entities.Add("yen", '\u00A5'); entities.Add("brvbar", '\u00A6'); entities.Add("sect", '\u00A7'); entities.Add("uml", '\u00A8'); entities.Add("copy", '\u00A9'); entities.Add("ordf", '\u00AA'); entities.Add("laquo", '\u00AB'); entities.Add("not", '\u00AC'); entities.Add("shy", '\u00AD'); entities.Add("reg", '\u00AE'); entities.Add("macr", '\u00AF'); entities.Add("deg", '\u00B0'); entities.Add("plusmn", '\u00B1'); entities.Add("sup2", '\u00B2'); entities.Add("sup3", '\u00B3'); entities.Add("acute", '\u00B4'); entities.Add("micro", '\u00B5'); entities.Add("para", '\u00B6'); entities.Add("middot", '\u00B7'); entities.Add("cedil", '\u00B8'); entities.Add("sup1", '\u00B9'); entities.Add("ordm", '\u00BA'); entities.Add("raquo", '\u00BB'); entities.Add("frac14", '\u00BC'); entities.Add("frac12", '\u00BD'); entities.Add("frac34", '\u00BE'); entities.Add("iquest", '\u00BF'); entities.Add("Agrave", '\u00C0'); entities.Add("Aacute", '\u00C1'); entities.Add("Acirc", '\u00C2'); entities.Add("Atilde", '\u00C3'); entities.Add("Auml", '\u00C4'); entities.Add("Aring", '\u00C5'); entities.Add("AElig", '\u00C6'); entities.Add("Ccedil", '\u00C7'); entities.Add("Egrave", '\u00C8'); entities.Add("Eacute", '\u00C9'); entities.Add("Ecirc", '\u00CA'); entities.Add("Euml", '\u00CB'); entities.Add("Igrave", '\u00CC'); entities.Add("Iacute", '\u00CD'); entities.Add("Icirc", '\u00CE'); entities.Add("Iuml", '\u00CF'); entities.Add("ETH", '\u00D0'); entities.Add("Ntilde", '\u00D1'); entities.Add("Ograve", '\u00D2'); entities.Add("Oacute", '\u00D3'); entities.Add("Ocirc", '\u00D4'); entities.Add("Otilde", '\u00D5'); entities.Add("Ouml", '\u00D6'); entities.Add("times", '\u00D7'); entities.Add("Oslash", '\u00D8'); entities.Add("Ugrave", '\u00D9'); entities.Add("Uacute", '\u00DA'); entities.Add("Ucirc", '\u00DB'); entities.Add("Uuml", '\u00DC'); entities.Add("Yacute", '\u00DD'); entities.Add("THORN", '\u00DE'); entities.Add("szlig", '\u00DF'); entities.Add("agrave", '\u00E0'); entities.Add("aacute", '\u00E1'); entities.Add("acirc", '\u00E2'); entities.Add("atilde", '\u00E3'); entities.Add("auml", '\u00E4'); entities.Add("aring", '\u00E5'); entities.Add("aelig", '\u00E6'); entities.Add("ccedil", '\u00E7'); entities.Add("egrave", '\u00E8'); entities.Add("eacute", '\u00E9'); entities.Add("ecirc", '\u00EA'); entities.Add("euml", '\u00EB'); entities.Add("igrave", '\u00EC'); entities.Add("iacute", '\u00ED'); entities.Add("icirc", '\u00EE'); entities.Add("iuml", '\u00EF'); entities.Add("eth", '\u00F0'); entities.Add("ntilde", '\u00F1'); entities.Add("ograve", '\u00F2'); entities.Add("oacute", '\u00F3'); entities.Add("ocirc", '\u00F4'); entities.Add("otilde", '\u00F5'); entities.Add("ouml", '\u00F6'); entities.Add("divide", '\u00F7'); entities.Add("oslash", '\u00F8'); entities.Add("ugrave", '\u00F9'); entities.Add("uacute", '\u00FA'); entities.Add("ucirc", '\u00FB'); entities.Add("uuml", '\u00FC'); entities.Add("yacute", '\u00FD'); entities.Add("thorn", '\u00FE'); entities.Add("yuml", '\u00FF'); entities.Add("fnof", '\u0192'); entities.Add("Alpha", '\u0391'); entities.Add("Beta", '\u0392'); entities.Add("Gamma", '\u0393'); entities.Add("Delta", '\u0394'); entities.Add("Epsilon", '\u0395'); entities.Add("Zeta", '\u0396'); entities.Add("Eta", '\u0397'); entities.Add("Theta", '\u0398'); entities.Add("Iota", '\u0399'); entities.Add("Kappa", '\u039A'); entities.Add("Lambda", '\u039B'); entities.Add("Mu", '\u039C'); entities.Add("Nu", '\u039D'); entities.Add("Xi", '\u039E'); entities.Add("Omicron", '\u039F'); entities.Add("Pi", '\u03A0'); entities.Add("Rho", '\u03A1'); entities.Add("Sigma", '\u03A3'); entities.Add("Tau", '\u03A4'); entities.Add("Upsilon", '\u03A5'); entities.Add("Phi", '\u03A6'); entities.Add("Chi", '\u03A7'); entities.Add("Psi", '\u03A8'); entities.Add("Omega", '\u03A9'); entities.Add("alpha", '\u03B1'); entities.Add("beta", '\u03B2'); entities.Add("gamma", '\u03B3'); entities.Add("delta", '\u03B4'); entities.Add("epsilon", '\u03B5'); entities.Add("zeta", '\u03B6'); entities.Add("eta", '\u03B7'); entities.Add("theta", '\u03B8'); entities.Add("iota", '\u03B9'); entities.Add("kappa", '\u03BA'); entities.Add("lambda", '\u03BB'); entities.Add("mu", '\u03BC'); entities.Add("nu", '\u03BD'); entities.Add("xi", '\u03BE'); entities.Add("omicron", '\u03BF'); entities.Add("pi", '\u03C0'); entities.Add("rho", '\u03C1'); entities.Add("sigmaf", '\u03C2'); entities.Add("sigma", '\u03C3'); entities.Add("tau", '\u03C4'); entities.Add("upsilon", '\u03C5'); entities.Add("phi", '\u03C6'); entities.Add("chi", '\u03C7'); entities.Add("psi", '\u03C8'); entities.Add("omega", '\u03C9'); entities.Add("thetasym", '\u03D1'); entities.Add("upsih", '\u03D2'); entities.Add("piv", '\u03D6'); entities.Add("bull", '\u2022'); entities.Add("hellip", '\u2026'); entities.Add("prime", '\u2032'); entities.Add("Prime", '\u2033'); entities.Add("oline", '\u203E'); entities.Add("frasl", '\u2044'); entities.Add("weierp", '\u2118'); entities.Add("image", '\u2111'); entities.Add("real", '\u211C'); entities.Add("trade", '\u2122'); entities.Add("alefsym", '\u2135'); entities.Add("larr", '\u2190'); entities.Add("uarr", '\u2191'); entities.Add("rarr", '\u2192'); entities.Add("darr", '\u2193'); entities.Add("harr", '\u2194'); entities.Add("crarr", '\u21B5'); entities.Add("lArr", '\u21D0'); entities.Add("uArr", '\u21D1'); entities.Add("rArr", '\u21D2'); entities.Add("dArr", '\u21D3'); entities.Add("hArr", '\u21D4'); entities.Add("forall", '\u2200'); entities.Add("part", '\u2202'); entities.Add("exist", '\u2203'); entities.Add("empty", '\u2205'); entities.Add("nabla", '\u2207'); entities.Add("isin", '\u2208'); entities.Add("notin", '\u2209'); entities.Add("ni", '\u220B'); entities.Add("prod", '\u220F'); entities.Add("sum", '\u2211'); entities.Add("minus", '\u2212'); entities.Add("lowast", '\u2217'); entities.Add("radic", '\u221A'); entities.Add("prop", '\u221D'); entities.Add("infin", '\u221E'); entities.Add("ang", '\u2220'); entities.Add("and", '\u2227'); entities.Add("or", '\u2228'); entities.Add("cap", '\u2229'); entities.Add("cup", '\u222A'); entities.Add("int", '\u222B'); entities.Add("there4", '\u2234'); entities.Add("sim", '\u223C'); entities.Add("cong", '\u2245'); entities.Add("asymp", '\u2248'); entities.Add("ne", '\u2260'); entities.Add("equiv", '\u2261'); entities.Add("le", '\u2264'); entities.Add("ge", '\u2265'); entities.Add("sub", '\u2282'); entities.Add("sup", '\u2283'); entities.Add("nsub", '\u2284'); entities.Add("sube", '\u2286'); entities.Add("supe", '\u2287'); entities.Add("oplus", '\u2295'); entities.Add("otimes", '\u2297'); entities.Add("perp", '\u22A5'); entities.Add("sdot", '\u22C5'); entities.Add("lceil", '\u2308'); entities.Add("rceil", '\u2309'); entities.Add("lfloor", '\u230A'); entities.Add("rfloor", '\u230B'); entities.Add("lang", '\u2329'); entities.Add("rang", '\u232A'); entities.Add("loz", '\u25CA'); entities.Add("spades", '\u2660'); entities.Add("clubs", '\u2663'); entities.Add("hearts", '\u2665'); entities.Add("diams", '\u2666'); entities.Add("quot", '\u0022'); entities.Add("amp", '\u0026'); entities.Add("lt", '\u003C'); entities.Add("gt", '\u003E'); entities.Add("OElig", '\u0152'); entities.Add("oelig", '\u0153'); entities.Add("Scaron", '\u0160'); entities.Add("scaron", '\u0161'); entities.Add("Yuml", '\u0178'); entities.Add("circ", '\u02C6'); entities.Add("tilde", '\u02DC'); entities.Add("ensp", '\u2002'); entities.Add("emsp", '\u2003'); entities.Add("thinsp", '\u2009'); entities.Add("zwnj", '\u200C'); entities.Add("zwj", '\u200D'); entities.Add("lrm", '\u200E'); entities.Add("rlm", '\u200F'); entities.Add("ndash", '\u2013'); entities.Add("mdash", '\u2014'); entities.Add("lsquo", '\u2018'); entities.Add("rsquo", '\u2019'); entities.Add("sbquo", '\u201A'); entities.Add("ldquo", '\u201C'); entities.Add("rdquo", '\u201D'); entities.Add("bdquo", '\u201E'); entities.Add("dagger", '\u2020'); entities.Add("Dagger", '\u2021'); entities.Add("permil", '\u2030'); entities.Add("lsaquo", '\u2039'); entities.Add("rsaquo", '\u203A'); entities.Add("euro", '\u20AC'); } public HttpUtility() { } #endregion // Constructors #region Methods public static void HtmlAttributeEncode(string s, TextWriter output) { output.Write(HtmlAttributeEncode(s)); } public static string HtmlAttributeEncode(string s) { if (null == s) return null; if (s.IndexOf('&amp;') == -1 &amp;&amp; s.IndexOf('"') == -1) return s; StringBuilder output = new StringBuilder(); foreach (char c in s) switch (c) { case '&amp;': output.Append("&amp;"); break; case '"': output.Append("""); break; default: output.Append(c); break; } return output.ToString(); } public static string UrlDecode(string str) { return UrlDecode(str, Encoding.UTF8); } private static char[] GetChars(MemoryStream b, Encoding e) { return e.GetChars(b.GetBuffer(), 0, (int)b.Length); } public static string UrlDecode(string s, Encoding e) { if (null == s) return null; if (s.IndexOf('%') == -1 &amp;&amp; s.IndexOf('+') == -1) return s; if (e == null) e = Encoding.UTF8; StringBuilder output = new StringBuilder(); long len = s.Length; MemoryStream bytes = new MemoryStream(); int xchar; for (int i = 0; i &lt; len; i++) { if (s[i] == '%' &amp;&amp; i + 2 &lt; len &amp;&amp; s[i + 1] != '%') { if (s[i + 1] == 'u' &amp;&amp; i + 5 &lt; len) { if (bytes.Length &gt; 0) { output.Append(GetChars(bytes, e)); bytes.SetLength(0); } xchar = GetChar(s, i + 2, 4); if (xchar != -1) { output.Append((char)xchar); i += 5; } else { output.Append('%'); } } else if ((xchar = GetChar(s, i + 1, 2)) != -1) { bytes.WriteByte((byte)xchar); i += 2; } else { output.Append('%'); } continue; } if (bytes.Length &gt; 0) { output.Append(GetChars(bytes, e)); bytes.SetLength(0); } if (s[i] == '+') { output.Append(' '); } else { output.Append(s[i]); } } if (bytes.Length &gt; 0) { output.Append(GetChars(bytes, e)); } bytes = null; return output.ToString(); } public static string UrlDecode(byte[] bytes, Encoding e) { if (bytes == null) return null; return UrlDecode(bytes, 0, bytes.Length, e); } private static int GetInt(byte b) { char c = (char)b; if (c &gt;= '0' &amp;&amp; c &lt;= '9') return c - '0'; if (c &gt;= 'a' &amp;&amp; c &lt;= 'f') return c - 'a' + 10; if (c &gt;= 'A' &amp;&amp; c &lt;= 'F') return c - 'A' + 10; return -1; } private static int GetChar(byte[] bytes, int offset, int length) { int value = 0; int end = length + offset; for (int i = offset; i &lt; end; i++) { int current = GetInt(bytes[i]); if (current == -1) return -1; value = (value &lt;&lt; 4) + current; } return value; } private static int GetChar(string str, int offset, int length) { int val = 0; int end = length + offset; for (int i = offset; i &lt; end; i++) { char c = str[i]; if (c &gt; 127) return -1; int current = GetInt((byte)c); if (current == -1) return -1; val = (val &lt;&lt; 4) + current; } return val; } public static string UrlDecode(byte[] bytes, int offset, int count, Encoding e) { if (bytes == null) return null; if (count == 0) return String.Empty; if (bytes == null) throw new ArgumentNullException("bytes"); if (offset &lt; 0 || offset &gt; bytes.Length) throw new ArgumentOutOfRangeException("offset"); if (count &lt; 0 || offset + count &gt; bytes.Length) throw new ArgumentOutOfRangeException("count"); StringBuilder output = new StringBuilder(); MemoryStream acc = new MemoryStream(); int end = count + offset; int xchar; for (int i = offset; i &lt; end; i++) { if (bytes[i] == '%' &amp;&amp; i + 2 &lt; count &amp;&amp; bytes[i + 1] != '%') { if (bytes[i + 1] == (byte)'u' &amp;&amp; i + 5 &lt; end) { if (acc.Length &gt; 0) { output.Append(GetChars(acc, e)); acc.SetLength(0); } xchar = GetChar(bytes, i + 2, 4); if (xchar != -1) { output.Append((char)xchar); i += 5; continue; } } else if ((xchar = GetChar(bytes, i + 1, 2)) != -1) { acc.WriteByte((byte)xchar); i += 2; continue; } } if (acc.Length &gt; 0) { output.Append(GetChars(acc, e)); acc.SetLength(0); } if (bytes[i] == '+') { output.Append(' '); } else { output.Append((char)bytes[i]); } } if (acc.Length &gt; 0) { output.Append(GetChars(acc, e)); } acc = null; return output.ToString(); } public static byte[] UrlDecodeToBytes(byte[] bytes) { if (bytes == null) return null; return UrlDecodeToBytes(bytes, 0, bytes.Length); } public static byte[] UrlDecodeToBytes(string str) { return UrlDecodeToBytes(str, Encoding.UTF8); } public static byte[] UrlDecodeToBytes(string str, Encoding e) { if (str == null) return null; if (e == null) throw new ArgumentNullException("e"); return UrlDecodeToBytes(e.GetBytes(str)); } public static byte[] UrlDecodeToBytes(byte[] bytes, int offset, int count) { if (bytes == null) return null; if (count == 0) return new byte[0]; int len = bytes.Length; if (offset &lt; 0 || offset &gt;= len) throw new ArgumentOutOfRangeException("offset"); if (count &lt; 0 || offset &gt; len - count) throw new ArgumentOutOfRangeException("count"); MemoryStream result = new MemoryStream(); int end = offset + count; for (int i = offset; i &lt; end; i++) { char c = (char)bytes[i]; if (c == '+') { c = ' '; } else if (c == '%' &amp;&amp; i &lt; end - 2) { int xchar = GetChar(bytes, i + 1, 2); if (xchar != -1) { c = (char)xchar; i += 2; } } result.WriteByte((byte)c); } return result.ToArray(); } static char[] hexChars = "0123456789abcdef".ToCharArray(); const string notEncoded = "!'()*-._"; static void UrlEncodeChar(char c, Stream result, bool isUnicode) { if (c &gt; 255) { //</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">FIXME:</span></span></span><span class="hljs-comment"> what happens when there is an internal error? //if (!isUnicode) // throw new ArgumentOutOfRangeException ("c", c, "c must be less than 256"); int idx; int i = (int)c; result.WriteByte((byte)'%'); result.WriteByte((byte)'u'); idx = i &gt;&gt; 12; result.WriteByte((byte)hexChars[idx]); idx = (i &gt;&gt; 8) &amp; 0x0F; result.WriteByte((byte)hexChars[idx]); idx = (i &gt;&gt; 4) &amp; 0x0F; result.WriteByte((byte)hexChars[idx]); idx = i &amp; 0x0F; result.WriteByte((byte)hexChars[idx]); return; } if (c &gt; ' ' &amp;&amp; notEncoded.IndexOf(c) != -1) { result.WriteByte((byte)c); return; } if (c == ' ') { result.WriteByte((byte)'+'); return; } if ((c &lt; '0') || (c &lt; 'A' &amp;&amp; c &gt; '9') || (c &gt; 'Z' &amp;&amp; c &lt; 'a') || (c &gt; 'z')) { if (isUnicode &amp;&amp; c &gt; 127) { result.WriteByte((byte)'%'); result.WriteByte((byte)'u'); result.WriteByte((byte)'0'); result.WriteByte((byte)'0'); } else result.WriteByte((byte)'%'); int idx = ((int)c) &gt;&gt; 4; result.WriteByte((byte)hexChars[idx]); idx = ((int)c) &amp; 0x0F; result.WriteByte((byte)hexChars[idx]); } else result.WriteByte((byte)c); } public static byte[] UrlEncodeToBytes(byte[] bytes, int offset, int count) { if (bytes == null) return null; int len = bytes.Length; if (len == 0) return new byte[0]; if (offset &lt; 0 || offset &gt;= len) throw new ArgumentOutOfRangeException("offset"); if (count &lt; 0 || count &gt; len - offset) throw new ArgumentOutOfRangeException("count"); MemoryStream result = new MemoryStream(count); int end = offset + count; for (int i = offset; i &lt; end; i++) UrlEncodeChar((char)bytes[i], result, false); return result.ToArray(); } public static byte[] UrlEncodeUnicodeToBytes(string str) { if (str == null) return null; if (str == "") return new byte[0]; MemoryStream result = new MemoryStream(str.Length); foreach (char c in str) { UrlEncodeChar(c, result, true); } return result.ToArray(); } /// &lt;summary&gt; /// Decodes an HTML-encoded string and returns the decoded string. /// &lt;/summary&gt; /// &lt;param name="s"&gt;The HTML string to decode. &lt;/param&gt; /// &lt;returns&gt;The decoded text.&lt;/returns&gt; public static string HtmlDecode(string s) { if (s == null) throw new ArgumentNullException("s"); if (s.IndexOf('&amp;') == -1) return s; StringBuilder entity = new StringBuilder(); StringBuilder output = new StringBuilder(); int len = s.Length; // 0 -&gt; nothing, // 1 -&gt; right after '&amp;' // 2 -&gt; between '&amp;' and ';' but no '#' // 3 -&gt; '#' found after '&amp;' and getting numbers int state = 0; int number = 0; bool have_trailing_digits = false; for (int i = 0; i &lt; len; i++) { char c = s[i]; if (state == 0) { if (c == '&amp;') { entity.Append(c); state = 1; } else { output.Append(c); } continue; } if (c == '&amp;') { state = 1; if (have_trailing_digits) { entity.Append(number.ToString(CultureInfo.InvariantCulture)); have_trailing_digits = false; } output.Append(entity.ToString()); entity.Length = 0; entity.Append('&amp;'); continue; } if (state == 1) { if (c == ';') { state = 0; output.Append(entity.ToString()); output.Append(c); entity.Length = 0; } else { number = 0; if (c != '#') { state = 2; } else { state = 3; } entity.Append(c); } } else if (state == 2) { entity.Append(c); if (c == ';') { string key = entity.ToString(); if (key.Length &gt; 1 &amp;&amp; Entities.ContainsKey(key.Substring(1, key.Length - 2))) key = Entities[key.Substring(1, key.Length - 2)].ToString(); output.Append(key); state = 0; entity.Length = 0; } } else if (state == 3) { if (c == ';') { if (number &gt; 65535) { output.Append("&amp;#"); output.Append(number.ToString(CultureInfo.InvariantCulture)); output.Append(";"); } else { output.Append((char)number); } state = 0; entity.Length = 0; have_trailing_digits = false; } else if (Char.IsDigit(c)) { number = number * 10 + ((int)c - '0'); have_trailing_digits = true; } else { state = 2; if (have_trailing_digits) { entity.Append(number.ToString(CultureInfo.InvariantCulture)); have_trailing_digits = false; } entity.Append(c); } } } if (entity.Length &gt; 0) { output.Append(entity.ToString()); } else if (have_trailing_digits) { output.Append(number.ToString(CultureInfo.InvariantCulture)); } return output.ToString(); } /// &lt;summary&gt; /// Decodes an HTML-encoded string and sends the resulting output to a TextWriter output stream. /// &lt;/summary&gt; /// &lt;param name="s"&gt;The HTML string to decode&lt;/param&gt; /// &lt;param name="output"&gt;The TextWriter output stream containing the decoded string. &lt;/param&gt; public static void HtmlDecode(string s, TextWriter output) { if (s != null) output.Write(HtmlDecode(s)); } /// &lt;summary&gt; /// HTML-encodes a string and returns the encoded string. /// &lt;/summary&gt; /// &lt;param name="s"&gt;The text string to encode. &lt;/param&gt; /// &lt;returns&gt;The HTML-encoded text.&lt;/returns&gt; public static string HtmlEncode(string s) { if (s == null) return null; StringBuilder output = new StringBuilder(); foreach (char c in s) switch (c) { case '&amp;': output.Append("&amp;"); break; case '&gt;': output.Append("&gt;"); break; case '&lt;': output.Append("&lt;"); break; case '"': output.Append("""); break; default: // MS starts encoding with &amp;# from 160 and stops at 255. // We don't do that. One reason is the 65308/65310 unicode // characters that look like '&lt;' and '&gt;'. if (c &gt; 159) { output.Append("&amp;#"); output.Append(((int)c).ToString(CultureInfo.InvariantCulture)); output.Append(";"); } else { output.Append(c); } break; } return output.ToString(); } /// &lt;summary&gt; /// HTML-encodes a string and sends the resulting output to a TextWriter output stream. /// &lt;/summary&gt; /// &lt;param name="s"&gt;The string to encode. &lt;/param&gt; /// &lt;param name="output"&gt;The TextWriter output stream containing the encoded string. &lt;/param&gt; public static void HtmlEncode(string s, TextWriter output) { if (s != null) output.Write(HtmlEncode(s)); } #if NET_1_1 public static string UrlPathEncode (string s) { if (s == null || s.Length == 0) return s; MemoryStream result = new MemoryStream (); int length = s.Length; for (int i = 0; i &lt; length; i++) { UrlPathEncodeChar (s [i], result); } return Encoding.ASCII.GetString (result.ToArray ()); } static void UrlPathEncodeChar (char c, Stream result) { if (c &gt; 127) { byte [] bIn = Encoding.UTF8.GetBytes (c.ToString ()); for (int i = 0; i &lt; bIn.Length; i++) { result.WriteByte ((byte) '%'); int idx = ((int) bIn [i]) &gt;&gt; 4; result.WriteByte ((byte) hexChars [idx]); idx = ((int) bIn [i]) &amp; 0x0F; result.WriteByte ((byte) hexChars [idx]); } } else if (c == ' ') { result.WriteByte ((byte) '%'); result.WriteByte ((byte) '2'); result.WriteByte ((byte) '0'); } else result.WriteByte ((byte) c); } #endif #if NET_2_0 public static NameValueCollection ParseQueryString (string query) { return ParseQueryString (query, Encoding.UTF8); } public static NameValueCollection ParseQueryString (string query, Encoding encoding) { if (query == null) throw new ArgumentNullException ("query"); if (encoding == null) throw new ArgumentNullException ("encoding"); if (query.Length == 0 || (query.Length == 1 &amp;&amp; query[0] == '?')) return new NameValueCollection (); if (query[0] == '?') query = query.Substring (1); NameValueCollection result = new NameValueCollection (); ParseQueryString (query, encoding, result); return result; } #endif internal static void ParseQueryString(string query, Encoding encoding, NameValueCollection result) { if (query.Length == 0) return; int namePos = 0; while (namePos &lt;= query.Length) { int valuePos = -1, valueEnd = -1; for (int q = namePos; q &lt; query.Length; q++) { if (valuePos == -1 &amp;&amp; query[q] == '=') { valuePos = q + 1; } else if (query[q] == '&amp;') { valueEnd = q; break; } } string name, value; if (valuePos == -1) { name = null; valuePos = namePos; } else { name = UrlDecode(query.Substring(namePos, valuePos - namePos - 1), encoding); } if (valueEnd &lt; 0) { namePos = -1; valueEnd = query.Length; } else { namePos = valueEnd + 1; } value = UrlDecode(query.Substring(valuePos, valueEnd - valuePos), encoding); result.Add(name, value); if (namePos == -1) break; } } #endregion // Methods }</span></span></code> </pre><br></div></div><br><br>  NetRequest.cs <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">NetRequest</span></span> : <span class="hljs-title"><span class="hljs-title">Dictionary</span></span>&lt;<span class="hljs-title"><span class="hljs-title">string</span></span>, <span class="hljs-title"><span class="hljs-title">string</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> METHOD_KEY = <span class="hljs-string"><span class="hljs-string">"method"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NetRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PacketTypes header</span></span></span><span class="hljs-function">)</span></span> { AddParam(METHOD_KEY, header.ToString()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddParam</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> val = HttpUtility.HtmlEncode(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ContainsKey(key)) <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>[key] = val; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Add(key, val); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddParam</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { AddParam(key, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.ToString()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddParam</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { AddParam(key, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveParam</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ContainsKey(key)) Remove(key); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetParamsString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Join(<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Select(n =&gt; n.Key + <span class="hljs-string"><span class="hljs-string">"="</span></span> + n.Value).ToArray()); } }</code> </pre><br><br>  NetResponse.cs <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">NetResponse</span></span> : <span class="hljs-title"><span class="hljs-title">Dictionary</span></span>&lt;<span class="hljs-title"><span class="hljs-title">string</span></span>, <span class="hljs-title"><span class="hljs-title">string</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ERROR_KEY = <span class="hljs-string"><span class="hljs-string">"error"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> GetError { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (IsError) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>[ERROR_KEY]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsError { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ContainsKey(ERROR_KEY); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NetResponse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mas = data.Split(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-string"><span class="hljs-string">'&amp;'</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> mas) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keyVal = s.Split(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-string"><span class="hljs-string">'='</span></span> }); Add(keyVal[<span class="hljs-number"><span class="hljs-number">0</span></span>], HttpUtility.UrlDecode(keyVal[<span class="hljs-number"><span class="hljs-number">1</span></span>])); } } }</code> </pre><br><br>  Now how it is used.  There is a class Network (singleton) that contains a method for sending requests, as well as an implementation of API methods on the client side (to fill requests with specific data). <br><br>  Network.cs <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Network</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Network _instance; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Network Instance { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_instance == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) _instance = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Network(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _instance; } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> SERVER_PATH = <span class="hljs-string"><span class="hljs-string">"http://localhost:8080/server/engine.php"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">NetRequest request</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> www = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WWW(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Concat(SERVER_PATH, <span class="hljs-string"><span class="hljs-string">"?"</span></span>, request.GetParamsString())); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!www.isDone) <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> www; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(www.error)) { <span class="hljs-comment"><span class="hljs-comment">//Logger.Log("[Network] SendRequest ERROR:" + www.error); yield return new NetResponse("error=" + www.error); yield break; } //Logger.Log("[Network] input data:{0}", www.text); yield return new NetResponse(www.text); } /// &lt;summary&gt; ///   /// &lt;/summary&gt; public IEnumerator SendUpdateInfo(int points) { var request = new NetRequest(PacketTypes.updateinfo); request.AddParam("points", points); return SendRequest(request).ContinueWith(response =&gt; { if (response.IsError) { //Logger.Log("SendUpdateInfoError:", response.GetError); } else { //OK } }); } }</span></span></code> </pre><br><br>  Here, perhaps, two important points: <br><br>  First, the <b>SendRequest</b> method returns an IEnumerator, since  we want to execute the query asynchronously.  We wait for the request to execute and then return the NetResponse object with the data. <br><br>  Secondly, if an error occurs on the WWW or comes from the server, then we successfully pop it into NetResponse and process it with the overlying logic. <br><br>  If necessary, we, before sending the request, can attach the missing data (hash from the entire filling, user ID, etc.) directly to SendRequest. <br><br>  Let us dwell on the IEnumerator SendUpdateInfo (int points).  Why IEnumerator?  This, brothers, is needed for StartCoroutine.  This is how we will call the methods.  But where is the profit? <br><br>  He is below <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SendRequest(request).ContinueWith(response =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.IsError) { <span class="hljs-comment"><span class="hljs-comment">//Logger.Log("SendUpdateInfoError:", response.GetError); } else { //OK } });</span></span></code> </pre><br><br>  Since  we return NetResponse from SendRequest, then we already have access to the data, nothing needs to be parsed. <br><br>  It remains only to figure out what <b>.ContinueWith is</b> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">NetApiExt</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContinueWith</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IEnumerator request, Action&lt;NetResponse&gt; resp</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> link = request; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (link.MoveNext()) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> link; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = link.Current <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> NetResponse; resp(obj); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> obj; } }</code> </pre><br><br>  Here is a hack :) <br><br>  It is possible to catch the answer both inside the sending method and outside: <br><br><pre> <code class="cs hljs"> StartCoroutine(Network.Instance.SendUpdateInfo(userPoints).ContinueWith(reponse =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!reponse.IsError) { <span class="hljs-comment"><span class="hljs-comment">//var newPoints = int.Parse(reponse["points"]); } }));</span></span></code> </pre><br><br>  I will give the server part only partially.  We get through $ _GET ["some key"], then we do something and add the necessary to the object of the NetResponse class: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NetResponse</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $mas = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($key, $val)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mas[$key] = urlencode($val); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($val)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;AddParam(<span class="hljs-string"><span class="hljs-string">"error"</span></span>, $val); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SendResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ $res = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $key =&gt; $val) { $res = $res.strtolower($key).<span class="hljs-string"><span class="hljs-string">"="</span></span>.$val.<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(strlen($res) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> substr($res,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">-1</span></span>); } }</code> </pre><br><br>  It remains to cause <br><pre> <code class="php hljs">$resp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NetResponse; $resp-&gt;AddParam(<span class="hljs-string"><span class="hljs-string">"points"</span></span>,<span class="hljs-string"><span class="hljs-string">"123456"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//... echo response.SendResponse();</span></span></code> </pre><br><br><h5>  Total </h5><br>  Of course, the option is not ideal, but it has found practical application + good portability from project to project. <br><br>  I want to ask you, dear% usernames, how do you work with the WWW, what was interesting? </div><p>Source: <a href="https://habr.com/ru/post/211482/">https://habr.com/ru/post/211482/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../211472/index.html">Basics of creating a 2D character in Unity 3D 4.3. Part 1: character preparation and animation of rest</a></li>
<li><a href="../211474/index.html">The easiest cross-platform server with ssl support</a></li>
<li><a href="../211476/index.html">About liberties in the links or the simplest messaging</a></li>
<li><a href="../211478/index.html">Experience of implementing caching in a small project with a strong social component</a></li>
<li><a href="../211480/index.html">Playing MIDI sounds in JAVA</a></li>
<li><a href="../211486/index.html">Olympic widgets for your site: live broadcast from social media</a></li>
<li><a href="../211488/index.html">Flexible cms for bold projects</a></li>
<li><a href="../211490/index.html">Python guard wallet</a></li>
<li><a href="../211492/index.html">One-wheeled electrocycle goes on sale</a></li>
<li><a href="../211494/index.html">Best practices and recommendations for protecting php applications from XSS attacks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>