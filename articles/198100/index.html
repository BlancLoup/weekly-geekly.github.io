<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ActiveRecord and transaction rollback in Yii</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I would like to talk about one problem that we encountered in developing our startup project for management accounting. 

 For our project, as an acco...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ActiveRecord and transaction rollback in Yii</h1><div class="post__text post__text-html js-mediator-article">  I would like to talk about one problem that we encountered in developing our startup project for management accounting. <br><br>  For our project, as an accounting system, it is typical to make changes in other objects after saving the current one, for example, holding a document on registers after saving.  The bottom line is that after saving an object in a transaction, ActiveRecord will assume that all changes were successful, although this is not guaranteed, because subsequent changes can cause an Exception, and it in turn will roll back the transaction.  In our case, it threatens with the fact that if an entry is erroneously created, the ActiveRecord instance will already have the status of an existing record (the isNewRecord flag == false) or the new record will already be assigned primaryKey.  If you relied on these attributes when rendering (as we did in our project), then you will get an erroneous idea as a result. <br><a name="habracut"></a><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Creates a new model. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> BaseActiveRecord $model */</span></span> $model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;modelClass(<span class="hljs-string"><span class="hljs-string">'create'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;performAjaxValidation($model); $model-&gt;attributes = Yii::app()-&gt;request-&gt;getParam(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;modelClass, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Yii::app()-&gt;request-&gt;isPostRequest &amp;&amp; !Yii::app()-&gt;request-&gt;isAjaxRequest) { $transaction = $model-&gt;getDbConnection()-&gt;beginTransaction(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $model-&gt;save(); $transaction-&gt;commit(); $url = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'update'</span></span>, <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $model-&gt;primaryKey); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;redirect($url); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $e) { $transaction-&gt;rollback(); } } <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'create'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'model'</span></span> =&gt; $model)); }</code> </pre> <br><br>  This is practically the code of lessons Yii.  With one exception, saving the object to the database is wrapped in a transaction. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What to do?  It is necessary after rollback () to restore the original state of ActiveRecord.  In our case, it was necessary to restore all ActiveRecord `s, changed inside the original model. <br><br>  To begin with, we appeal to the universal mind, all of a sudden, we are reinventing the bicycle.  On <a href="https://github.com/yiisoft/yii/issues/1253">Gitkhab,</a> this problem has already been discussed.  The developers said that they have no plans to solve it at the framework level, since it is resource intensive.  They can be understood for the majority of projects with sufficient preliminary validation of the model.  We do not have enough - we write our own solution to the problem. <br><br>  Extend the CDbTransaction class. <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Class DbTransaction * Stores models states for restoring after rollback. */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DbTransaction</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CDbTransaction</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> BaseActiveRecord[] models with stored states */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $_models = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-comment"><span class="hljs-comment">/** * Checks if model state is already stored. * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> BaseActiveRecord $model * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> boolean */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isModelStateStoredForRollback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($model)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> in_array($model, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_models, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-comment"><span class="hljs-comment">/** * Stores model state for restoring after rollback. * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> BaseActiveRecord $model */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">storeModelStateForRollback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($model)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;isModelStateStoredForRollback($model)) { $model-&gt;storeState(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_models[] = $model; } } <span class="hljs-comment"><span class="hljs-comment">/** * Rolls back a transaction. * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> CException if the transaction or the DB connection is not active. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rollback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::rollback(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_models <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $model) { $model-&gt;restoreState(); } <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_models = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); } }</code> </pre><br><br>  We add the methods restoreState (), hasStoredState (), and storeState () to the BaseActiveRecord class (the CActiveRecord extension, it already existed in our project). <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseActiveRecord</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CActiveRecord</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> array    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $_storedState = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-comment"><span class="hljs-comment">/** *      * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> boolean */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasStoredState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_storedState !== <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); } <span class="hljs-comment"><span class="hljs-comment">/** *    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> boolean $force    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">storeState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($force = false)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hasStoredState() || $force) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_storedState = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'isNewRecord'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;isNewRecord, <span class="hljs-string"><span class="hljs-string">'attributes'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getAttributes(), ); } } <span class="hljs-comment"><span class="hljs-comment">/** *    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">restoreState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hasStoredState()) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;isNewRecord = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_storedState[<span class="hljs-string"><span class="hljs-string">'isNewRecord'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;setAttributes(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_storedState[<span class="hljs-string"><span class="hljs-string">'attributes'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_storedState = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); } } }</code> </pre><br><br>  As you can see from the code, we back up only the isNewRecord flag and the current attributes (including primaryKey).  Now it only remains to correct our first code fragment in order to remember the state of the model before saving. <br><br><pre> <code class="php hljs"> <span class="hljs-comment"><span class="hljs-comment">/** * Creates a new model. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> BaseActiveRecord $model */</span></span> $model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;modelClass(<span class="hljs-string"><span class="hljs-string">'create'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;performAjaxValidation($model); $model-&gt;attributes = Yii::app()-&gt;request-&gt;getParam(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;modelClass, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Yii::app()-&gt;request-&gt;isPostRequest &amp;&amp; !Yii::app()-&gt;request-&gt;isAjaxRequest) { $transaction = $model-&gt;getDbConnection()-&gt;beginTransaction(); <span class="hljs-comment"><span class="hljs-comment">//    $transaction-&gt;storeModelStateForRollback($model); try { $model-&gt;save(); $transaction-&gt;commit(); $url = array('update', 'id' =&gt; $model-&gt;primaryKey); $this-&gt;redirect($url); } catch (Exception $e) { $transaction-&gt;rollback(); } } $this-&gt;render('create', array('model' =&gt; $model)); }</span></span></code> </pre><br><br>  In our project, we went a little further - we moved $ transaction-&gt; storeModelStateForRollback ($ model) to the BaseActiveRecord's save () method. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseActiveRecord</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CActiveRecord</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... /** *    (  ) * @param boolean $runValidation      * @param array $attributes     * @throws Exception|UserException * @return boolean   */ public function save($runValidation = true, $attributes = null) { /** @var DbTransaction $transaction */ $transaction = $this-&gt;getDbConnection()-&gt;getCurrentTransaction(); $isExternalTransaction = ($transaction !== null); if ($transaction === null) { $transaction = $this-&gt;getDbConnection()-&gt;beginTransaction(); } $transaction-&gt;storeModelStateForRollback($this); $exception = null; try { $result = parent::save($runValidation, $attributes); } catch (Exception $e) { $result = false; $exception = $e; } if ($result) { if (!$isExternalTransaction) { $transaction-&gt;commit(); } } else { if (!$isExternalTransaction) { $transaction-&gt;rollback(); } throw $exception; } return $result; } // ... }</span></span></code> </pre><br>  This allowed the rest of the code not to think that the model needs to be restored after rollback of transactions, and also makes it necessary to back up all participating models recursively in saving the current model. <br><br>  It may seem that the problem and its solution is not worth attention, but as practice has shown, if you do not take this into account immediately during development, you can search for a reason for incomprehensible bugs for a long time. </div><p>Source: <a href="https://habr.com/ru/post/198100/">https://habr.com/ru/post/198100/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../198086/index.html">3CX Phone System 12 Service Pack 2 released</a></li>
<li><a href="../198092/index.html">How we prey on authors - confession publisher</a></li>
<li><a href="../198094/index.html">Time management: a simple experiment</a></li>
<li><a href="../198096/index.html">IB far and wide on ZeroNights</a></li>
<li><a href="../198098/index.html">Write Back in MS SQL Server Analysis Service cubes</a></li>
<li><a href="../198102/index.html">We control the webcam with the joystick</a></li>
<li><a href="../198104/index.html">Under the hood at Dictionary and ConcurrentDictionary</a></li>
<li><a href="../198106/index.html">Old, kind ‚ÄúThe Matrix‚Äù or visualizer for matrix version one</a></li>
<li><a href="../198108/index.html">ICMP port knocking in OpenWRT</a></li>
<li><a href="../198110/index.html">Install pyload as standalone rocking for ReadyNAS DUO v2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>