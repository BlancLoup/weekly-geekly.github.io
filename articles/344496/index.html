<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New spyware StrongPity2 replaced FinFisher in a cyber espionage campaign with the possible participation of an Internet provider</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing the study of cyber espionage operations with obvious traces of participation in the scheme of a large Internet provider, we found that anot...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New spyware StrongPity2 replaced FinFisher in a cyber espionage campaign with the possible participation of an Internet provider</h1><div class="post__text post__text-html js-mediator-article"> Continuing the study of <a href="https://habrahabr.ru/company/eset/blog/338422/">cyber espionage operations</a> with obvious traces of participation in the scheme of a large Internet provider, we found that another FinFisher spyware software (FinSpy) was replaced by another program.  The new Win32 / StrongPity2 spyware noticeably resembles a program attributed to the StrongPity cyber group.  All ESET products, including the free <a href="https://www.esetnod32.ru/home/products/online-scanner/">ESET Online Scanner</a> tool, detect and block the threat, and also eliminate StrongPity2 from the compromised system. <br><br><img src="https://habrastorage.org/webt/1m/lv/e9/1mlve9qovdiomwmjgmcyloj_tjg.jpeg"><br><br>  As we wrote in September, in two countries of the world, man-in-the-middle attacks were used to spread FinFisher, and in most cases the mentioned ‚Äúman‚Äù with a fair degree of probability was at the level of an Internet provider.  According to ESET telemetry, the campaigns were terminated on September 21, 2017, the day our report was published. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      On October 8, in one of the two countries, an identical campaign was launched using the same (and rather unusual) NTTR redirection structure to redirect browsers on the fly, only now instead of FinFisher Win32 / StrongPity2 was distributed.  We studied new spyware and found similarities to the program that the StrongPity group allegedly used in the past. <br><br><a name="habracut"></a>  The first similarity is the attack scenario.  A user who tries to download legitimate software is redirected to a fake website, from which a trojanized version of the necessary software is downloaded.  Similar watering hole attacks performed by the StrongPity group <a href="https://securelist.com/on-the-strongpity-waterhole-attacks-targeting-italian-and-belgian-encryption-users/76147/">were recorded</a> in the summer of 2016, their target was mainly Italian and Belgian users of encryption programs. <br><br>  During the study, we discovered infected Win32 / StrongPity2 versions of the following programs: <br><br>  - CCleaner v 5.34 <br>  - Driver Booster <br>  - Opera Browser <br>  - Skype <br>  - VLC Media Player v2.2.6 (32 bit) <br>  - WinRAR 5.50 <br><br>  Since the beginning of the campaign, our telemetry systems have recorded more than one hundred attempts at attacks using Win32 / StrongPity2. <br><br>  We also found other similarities between the StrongPity group spyware and the Win32 / StrongPity2 implementation: <br><br>  - identical code fragments <br>  - configuration file structures (rather unusual) have a noticeable similarity, as shown in Figure 1: <br><br><img src="https://habrastorage.org/webt/dk/ex/w6/dkexw62kn2ny3k3behnsed-pts4.png"><br>  <i>Figure 1. Sample configuration files: at the top of StrongPity, at the bottom of StrongPity2</i> <br><br>  - the same encryption algorithm is used in StrongPity and StrongPity2 (very unusual Byte ^ = ((Byte &amp; 0xF0) &gt;&gt; 4) <br>  - Both programs use the identical (old) version of libcurl 7.45 <br>  - both programs use the same method of exfiltration of files (the main payload produces the exfiltration of files previously collected and saved by a special module) <br><br>  If we talk about data theft, there are several file types under the Win32 / StrongPity2 target: <br><br>  - .ppt <br>  - .pptx <br>  - .xls <br>  - .xlsx <br>  - .txt <br>  - .doc <br>  - .docx <br>  - .pdf <br>  - .rtf <br><br>  In search of these files, the program avoids the following folders: <br><br>  - <code>%Windows%</code> <br>  - <code>%Windows.old%</code> <br>  - <code>%AppData%</code> <br>  - <code>%Program Files%</code> <br>  - <code>%Program Files (x86)%</code> <br>  - <code>%ProgramData%</code> <br><br>  In addition to exfiltration of data, Win32 / StrongPity2 can download and execute other malicious programs to choose from attackers with the privileges of a compromised account. <br><br><h3>  Check for compromise, cleaning the system and prevention </h3><br>  To check your system for Win32 / StrongPity2 infection, use the free ESET Online Scanner.  Upon detecting Win32 / StrongPity2, the scanner will remove it. <br><br>  The system can be checked manually.  To do this, check the presence / absence of the <code>%temp%\lang_be29c9f3-83we</code> , which the malware creates to store its components, the main of which is the file <code>wmpsvn32.exe</code> . <br><br>  Another infection indicator that is easy to check is a registry string parameter located in <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code> , called <code>Help Manager</code> with the value <code>%temp% \lang_be29c9f3-83we\wmpsvn32.exe</code> in the data field. <br><br><img src="https://habrastorage.org/webt/dh/em/8u/dhem8uqfzksoczxeehzqv1pcxao.png"><br>  <i>Figure 2. Registry entry used by malware</i> <i><br></i> <br>  To manually clean the infected system, follow these steps: <br><br><ol><li>  Eliminate the main process component <code>wmpsvn32.exe</code> </li><li>  Delete the folder <code>%temp%\lang_be29c9f3-83we</code> and all its contents </li><li>  Delete the value of the <code>Help Manager</code> in the mentioned registry entry </li></ol><br>  For the prevention of infection, we recommend using integrated security solutions. <br><br><h3>  Infection indicators </h3><br>  <b>Hashes of the studied samples:</b> <br> <code>4ad3ecc01d3aa73b97f53e317e3441244cf60cbd <br> 8b33b11991e1e94b7a1b03d6fb20541c012be0e3 <br> 49c2bcae30a537454ad0b9344b38a04a0465a0b5 <br> e17b5e71d26b2518871c73e8b1459e85fb922814 <br> 76fc68607a608018277afa74ee09d5053623ff36 <br> 87a38a8c357f549b695541d603de30073035043d <br> 9f2d9d2131eff6220abaf97e2acd1bbb5c66f4e0 <br> f8009ef802a28c2e21bce76b31094ed4a16e70d6 <br> a0437a2c8c50b8748ca3344c38bc80279779add7</code> <br> <br>  <b>Domain used for downloading Trojan Win32 / StrongPity2 software:</b> <br> <code>hxxps://downloading.internetdownloading.co</code> <br> <br>  <b>URLs used to exfiltrate stolen data:</b> <br> <code>hxxps://updserv-east-cdn3.com/s3s3sxhxTuDSrkBQb88wE99Q.php <br> hxxps://updserv-east-cdn3.com/kU2QLsNB6TzexJv5vGdunVXT.php <br> hxxps://updserv-east-cdn3.com/p55C3xhxTuD5rkBQbB8wE99Q.php</code> <br> <br>  <b>Folder created by Win32 / StrongPity2 to store its components:</b> <br> <code>%temp%\lang_be29c9f3-83we <br></code> </div><p>Source: <a href="https://habr.com/ru/post/344496/">https://habr.com/ru/post/344496/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344486/index.html">Parcel - a very fast bandler that does not require configuration.</a></li>
<li><a href="../344488/index.html">Monitoring Trassir Servers</a></li>
<li><a href="../344490/index.html">Let's drive a mammoth into a hole: how to make a presentation so that you can be heard and remembered</a></li>
<li><a href="../344492/index.html">Zabbix 3.4: Macros in time intervals</a></li>
<li><a href="../344494/index.html">Do not succumb to HYIP, or why the price of Bitcoin does not reflect its real value.</a></li>
<li><a href="../344498/index.html">PHP dependency management</a></li>
<li><a href="../344502/index.html">TypeScript basics for developing Angular applications</a></li>
<li><a href="../344504/index.html">Avito iOS Winter Edition - video, photos, slides, reviews</a></li>
<li><a href="../344506/index.html">Singleton, service locator and tests in iOS</a></li>
<li><a href="../344508/index.html">Dependency injection and unit implementation using Castle Windsor and NHibernate</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>