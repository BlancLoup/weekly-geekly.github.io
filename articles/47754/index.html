<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I fought with Microsoft Word!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I would like to tell one story that happened to me. In my opinion, it is quite interesting, and can help someone with a similar problem. At once I wil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I fought with Microsoft Word!</h1><div class="post__text post__text-html js-mediator-article">  I would like to tell one story that happened to me.  In my opinion, it is quite interesting, and can help someone with a similar problem.  At once I will say - this is my first post on Habr√© :-) It turned out to be a bit long, so I made the main conclusions separately - at the end of the article. <br><br>  <b>So, the task:</b> <br>  There is a portal to which Microsoft Word documents are uploaded in Doc format.  They must be processed before they are shared.  How exactly is not important, therefore, to simplify, let's take the following algorithm: <br><ol><li>  Create a new document. </li><li>  Insert data from the source (insert file). </li><li>  Save the resulting file instead of the original. </li></ol><br><a name="habracut"></a><br>  I will say right away: An additional server with Win2k3 + Office + Apache + PHP5 is on board for Doc-files.  Perhaps in the comments, I will find the answer to how I can perform similar manipulations on FreeBSD :-) <br><br>  <b>The answer to the first question:</b> Why do we need this treatment? <br>  Through trial and error, it was concluded that this is the minimum sequence of actions that must be performed for all documents. <br>  There are two reasons for this: <br><ul><li>  First, when inserting a file, only its contents are inserted (text, formatting, pictures), and the macros remain ‚Äúoverboard‚Äù.  This allows you to get rid of malicious code that may get into your Normal.dot :-) Of course, if you need to save macros, this option will not work, but for most tasks, macros are not needed. </li><li>  Secondly, if the source file was locked for writing, then you cannot change it.  A new document does not inherit this lock. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>The answer to the second question:</b> How was the processing of documents implemented? <br>  Several generations of handlers were made by trial and error.  The fact is that, in the beginning, a normally working program, after a while began to produce errors.  As a result, the processing stopped.  And when the stops became too frequent, one had to admit the failure of the previous decision and invent a new one. <br><br>  So. <br>  <b>First generation: "mainscript.exe"</b> <br>  This script runs Word with command line options.  One of them is the name of the file being processed, and the second is the name of the macro processing.  After 2 minutes the program killed the process launched by it.  The script itself was run via CGI. <br>  Of the minuses, it can be noted: <br><ol><li>  the program worked exactly 2 minutes </li><li>  frequent freezes and programs and word.  As a result, a bunch of hanging processes winword.exe and mainscript.exe. </li></ol><br><br>  <b>Second generation: simple php - com / ole</b> <br>  If the first generation was implemented before me, then the second is my add-on above the first.  A simple script was written that implements the same actions from a macro.  One script was replaced by another.  Locally everything worked fine.  Processing the average file took 15 seconds (instead of 2 minutes).  The script is transferred to the server.  Testing.  Same 15 seconds.  We start in work, and ... <br>  Winwords fall, hang, brake ... Exceptions constantly appear.  In addition, php scripts hang for a time longer than max_execution_time and hang only if they are thrown out, the winword.exe process.  The reasons are not clear, Google suggests an <a href="http://support.microsoft.com/kb/257757/ru">article</a> in which Microsoft warns that the office is not intended for server applications and its behavior in my situation is unpredictable.  Also, it was not recommended to run more than one winword process there. <br><br>  Said - done: <br>  <b>Third generation: monopolizing access to winword.exe</b> <br>  Another processing request checks whether Word is already running or not.  This check can be done through the database or pid-file.  I did through the db.  The value of the flag field increases with each request.  If there were a lot of requests, it means that the process has hung, and then the magic program killword.exe is started.  She stupidly kills all processes called winword.exe. <br><br>  It seems everything works fine, but over time, the script has increased its runtime, and increasingly it is required to launch the killword.  Constant Exception ... <br><br>  <b>Fourth generation: handler release</b> <br>  A painstaking search for the causes of errors gave a very interesting result.  After opening / saving the file, the control returns to the php script, but the COM server remains busy for a while.  And <i>if at this moment to send the following command to the COM server, we will fly to Exception</i> .  After that, Word can kill and start all over again. <br><br>  The problem was solved by simply <u>copying to a temporary folder.</u>  It turned out Word scans the folder for temporary files, or something else.  Over time, the number of files in the source folder increased and the script began to fail. <br><br>  In general, the last scheme of work turned out to be the most efficient.  Sometimes errors such as ‚Äúlack of memory‚Äù pop up, but this is quite rare and is still a secret :-) <br><br>  So: <b>DOC handler operation scheme</b> <br>  The handler consists of two files: tmanager.php and handler.php <br>  1. tmanger.php <br>  This is a daemon that runs continuously (or periodically starts through the task scheduler).  Every n seconds he checks the table in the database for the presence of the next request for processing (the so-called queue). <br>  If there is an application, perform the following actions: <br><ol><li>  Delete all files from temporary folders (including% SYSTEM_ROOT% \ TEMP) </li><li>  Kill all word processes (killword.exe) </li><li>  Copy source file to temporary folder </li><li>  Run handler.php (via curl) </li><li>  Copy the resulting file to a shared folder. </li><li>  Clean up temporary files and unnecessary processes. </li><li>  Remove entry from DB queue </li></ol><br><br>  2. handler.php <br>  This is the handler itself.  In a separate file, it is taken out in case of a hang.  If after some time it does not return the result, then tmanager.php will start the killword. <br>  here is its simplified code: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); //      $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> &lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <font color="#0000ff">try</font> { $doc = <font color="#0000ff">new</font> COM( <font color="#A31515">"Word.Document"</font> ); $doc-&gt;Range-&gt;InsertFile( <font color="#A31515">'E:\\tmp\\tmp1.doc'</font> ); <font color="#008000">//     </font> $doc-&gt;SaveAs( <font color="#A31515">'E:\\tmp\\tmp2.doc'</font> ); $doc = <font color="#0000ff">null</font> ; } <font color="#0000ff">catch</font> (Exception $e) { print <font color="#A31515">'3'</font> ; $doc = <font color="#0000ff">null</font> ; die(); } print 0; ?&gt;</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The tmanager.php script passes the file handler.php to the script for processing.  The latter processes it and creates a new file.  In the event of a hang handler.php, tmanager.php just kills winword. <br><br>  <b>findings</b> <br><ol><li>  Do not open the files sent to you directly, paste the file. </li><li>  Do not run multiple Winword.exe processes - they may conflict. </li><li>  Do not open or save files in a folder with a large number of files - Word will try to scan these files and at the same time ‚Äúslow down‚Äù. </li><li>  Separate the process working with COM from the main process.  This will allow you to take some actions when the first hangs up. </li></ol><br><br>  <b>Update:</b> Found a link to <a href="http://support.microsoft.com/kb/257757/ru">an article</a> on server automation.  Since the last reading, she has become in Russian and has grown a bit. </div><p>Source: <a href="https://habr.com/ru/post/47754/">https://habr.com/ru/post/47754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../47742/index.html">Create your own personal OpenID</a></li>
<li><a href="../47743/index.html">Who added to myself my habratopik?</a></li>
<li><a href="../47747/index.html">Gift wrapping like geeks</a></li>
<li><a href="../47752/index.html">Unit tests and inheritance</a></li>
<li><a href="../47753/index.html">On the architecture of the distributed blogosphere</a></li>
<li><a href="../47755/index.html">What software development methodology does your company use?</a></li>
<li><a href="../47756/index.html">Let's play in CacheGraph?</a></li>
<li><a href="../47762/index.html">30+ great toys made by designers</a></li>
<li><a href="../47763/index.html">Christmas game on rapper Syavu</a></li>
<li><a href="../47764/index.html">TANK</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>