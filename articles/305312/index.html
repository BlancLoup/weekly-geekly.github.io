<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Review of physics in Sonic games. Parts 5 and 6: the loss of rings and being under water</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuation of a series of articles on physics in games about Sonic. This post covers the loss of rings and being under water. 

 Links to other part...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Review of physics in Sonic games. Parts 5 and 6: the loss of rings and being under water</h1><div class="post__text post__text-html js-mediator-article"><img width="640" src="https://habrastorage.org/files/ab3/72f/7f5/ab372f7f51a24160b51c50b297a1e654.png"><br><br>  <i>Continuation of a series of articles on physics in games about Sonic.</i>  <i>This post covers the loss of rings and being under water.</i> <br><a name="habracut"></a><br>  <b>Links to other parts of the series:</b> <br>  <a href="https://habrahabr.ru/post/276669/">Part 1: hard tiles</a> <br>  <a href="https://habrahabr.ru/post/276849/">Part 2: Running</a> <br>  <a href="https://habrahabr.ru/post/278373/">Parts 3 and 4: Jumping and Spinning</a> <br>  <a href="https://habrahabr.ru/post/306756/">Parts 7 and 8: springs and gizmos, super speeds</a> <br><br><h1>  Part 5: the loss of rings </h1><br><ul><li>  <a href="https://habr.com/ru/post/305312/">1 Restrictions on rings</a> </li><li>  <a href="https://habr.com/ru/post/305312/">2 ring scatter</a> </li><li>  <a href="https://habr.com/ru/post/305312/">3 Gravity for rings</a> </li><li>  <a href="https://habr.com/ru/post/305312/">4 Ring Bounces</a> </li><li>  <a href="https://habr.com/ru/post/305312/">5 Time "life" rings</a> </li><li>  <a href="https://habr.com/ru/post/305312/">6 Repeated collection of rings</a> </li><li>  <a href="https://habr.com/ru/post/305312/">7 Invulnerability</a> </li><li>  <a href="https://habr.com/ru/post/305312/">8 ring animations</a> </li><li>  <a href="https://habr.com/ru/post/305312/">9 Depth of drawing rings</a> </li></ul><br><a name="Ring_Limit"></a>  <b>Ring Restrictions</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When Sonic hits an adversary or dangerous obstacles, he loses all the rings he has collected, but 32 rings fly in different directions.  So Sonic cannot reassemble more than 32 rings, even if he had 100 of them. <br><br><a name="Ring_Distribution"></a>  <b>Scatter rings</b> <br><br>  Rings, flying away from Sonic, move along a certain trajectory of two concentric circles, each of which contains no more than 16 rings.  The rings in the first circle fly apart faster than the rings in the second.  Here is a formula for creating rings that can be converted to any programming language: <br><br><pre><code class="dos hljs">{ let t = <span class="hljs-number"><span class="hljs-number">0</span></span> let angle = <span class="hljs-number"><span class="hljs-number">101</span></span>.<span class="hljs-number"><span class="hljs-number">25</span></span> ;  <span class="hljs-number"><span class="hljs-number">0</span></span>=, <span class="hljs-number"><span class="hljs-number">90</span></span>=, <span class="hljs-number"><span class="hljs-number">180</span></span>=, <span class="hljs-number"><span class="hljs-number">270</span></span>= let n = false let speed = <span class="hljs-number"><span class="hljs-number">4</span></span> while t &lt;   {   " "      -sin(angle)*speed      cos(angle)*speed <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n = true {      -<span class="hljs-number"><span class="hljs-number">1</span></span>    <span class="hljs-number"><span class="hljs-number">22</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span> } let n = <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> n ; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n = false, n  true,    t  <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> t = <span class="hljs-number"><span class="hljs-number">16</span></span> { let speed = <span class="hljs-number"><span class="hljs-number">2</span></span> ;     ,     let angle = <span class="hljs-number"><span class="hljs-number">101</span></span>.<span class="hljs-number"><span class="hljs-number">25</span></span> ;    } } }</code> </pre> <br>  So, the first 16 rings move at a speed of 4 pixels per cycle, and the second 16 - two times slower (2 pixels per cycle). <br><br><a name="Ring_Gravity"></a>  <b>Gravity for rings</b> <br><br>  Rings do not use the same gravitational constant as Sonic.  The value of their gravitational force is 0.09375.  Therefore, this value is added each cycle to the vertical speed of the rings. <br><br><a name="Ring_Bounce"></a>  <b>Ring bouncing</b> <br><br>  When the scattering rings touch the ground, their vertical speed is multiplied by a factor of -0.75.  This leads to a change in the direction of their vertical movement, and also reduces speed.  This calculation is performed after adding gravity.  Ring bouncing does not affect their horizontal speed. <br><br>  The ring rebound is calculated so roughly that it is almost annoying.  But in a normal game, this is actually imperceptible, and perhaps it was necessary to avoid the brakes.  It seems that they do not check every cycle, whether they are bumped into the ground, so that sometimes they sink into the surface rather heavily before deciding to bounce back.  This behavior does not need to be emulated. <br><br>  However, there are other restrictions for jumping rings, perhaps they are used to avoid processor load.  The rings are completely unaffected by walls, and they interact with vertical surfaces.  In addition, they check for collisions with the surface only when they are moving down (i.e. when their vertical velocity is positive).  Therefore, they can even fly through the ceiling.  Sometimes it can really be a problem for Sonic if he gets hit in a small corridor, because most of the rings will fly into the ceiling and cannot be assembled again. <br><br>  If I used a more powerful system than Genesis / Mega Drive, I would program the rings to check for horizontal collisions.  In a collision, they must multiply their horizontal speed by a factor of -0.25.  They should also check for collisions with ceilings, determining whether a collision happened while moving up or down.  If they were moving down, they should bounce as usual, but if they moved up, they should reset their vertical speed.  It would be more gracious to the player, so most of the rings would not be lost when trying to re-gather. <br><br><a name="Ring_Lifespan"></a>  <b>The life of the rings</b> <br><br>  All flying rings are destroyed after 256 cycles, if they were not reassembled.  Also, they are destroyed when going beyond the horizontal borders of the screen.  And, again, on a more powerful system, this behavior can be not emulated. <br><br><a name="Regathering_Rings"></a>  <b>Re-collecting rings</b> <br><br>  After hitting, Sonic needs 64 cycles before he can reassemble the scattered rings. <br><br><a name="Invulnerability"></a>  <b>Invulnerability</b> <br><br>  After impact, Sonic becomes invulnerable for a short time.  This invulnerability lasts until Sonic flies away from the blow, and then another 120 cycles after the resumption of movement.  During these 120 cycles, it flickers, disappearing and appearing every 4 cycles. <br><br><a name="Ring_Animations"></a>  <b>Ring animations</b> <br><br>  The rings hanging in place have 4 animation frames, and they are replaced every 8 cycles.  The behavior of the scattering rings is more difficult, because they have a higher animation speed when created, but over time it decreases.  At the beginning, the animation frames are replaced every 2 cycles, but at the end they are slowed down and changed every 16 cycles or so.  While I do not know the exact values.  The scattering rings are created with one starting frame of the animation - the ring can be seen entirely. <br><br><a name="Ring_Depth"></a>  <b>The depth of drawing rings</b> <br><br>  Both flying and hanging rings have a greater depth than Sonic, that is, they are drawn behind it.  But they have less depth, that is, they appear above it when they turn into sparks. <br><br><img width="640" src="https://habrastorage.org/files/329/b1b/10a/329b1b10aa1343e48d35ecf93b84a9a3.png"><br><br><h1>  Part 6: being under water </h1><br>  When Sonic is under water, he moves more slowly, but in general the physics remains the same.  This is mainly achieved by dividing the corresponding variables in half, but some, such as gravity and the initial jump speed, are not exactly equal to half. <br><br><ul><li>  <a href="https://habr.com/ru/post/305312/">1 Variables</a> <br><ul><li>  <a href="https://habr.com/ru/post/305312/">1.1 Acceleration</a> </li><li>  <a href="https://habr.com/ru/post/305312/">1.2 Slowdown</a> </li><li>  <a href="https://habr.com/ru/post/305312/">1.3 Friction force</a> </li><li>  <a href="https://habr.com/ru/post/305312/">1.4 Maximum speed</a> </li><li>  <a href="https://habr.com/ru/post/305312/">1.5 Acceleration in the air</a> </li><li>  <a href="https://habr.com/ru/post/305312/">1.6 Gravity</a> </li><li>  <a href="https://habr.com/ru/post/305312/">1.7 jump speed</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/305312/">2 Bubbles</a> </li><li>  <a href="https://habr.com/ru/post/305312/">3 Entry and exit</a> </li><li>  <a href="https://habr.com/ru/post/305312/">4 drowning</a> </li><li>  <a href="https://habr.com/ru/post/305312/">5 speed shoes</a> </li><li>  <a href="https://habr.com/ru/post/305312/">6 animation speeds</a> </li></ul><br><a name="Variables"></a>  <b>Variables</b> <br><br><a name="Acceleration"></a>  <b>Acceleration</b> <br><br>  Acceleration has half the normal value: 0.0234375. <br><br><a name="Deceleration"></a>  <b>Slowdown</b> <br><br>  Slowdown is half the usual value: 0.25. <br><br>  Rotation slowdown remains unchanged. <br><br><a name="Friction"></a>  <b>Friction force</b> <br><br>  The frictional force is half the usual value: 0.0234375. <br><br>  The frictional force during rotation is 0.01171875. <br><br><a name="Top_Speed"></a>  <b>Max speed</b> <br><br>  Sonic's maximum running speed is 3, half the normal value. <br><br><a name="Air_Acceleration"></a>  <b>Acceleration in the air</b> <br><br>  Acceleration in the air operates in the usual way, but has a value of 0.046875, two times less than usual. <br><br><a name="Gravity"></a>  <b>Gravity</b> <br><br>  Gravity is 0.0625.  Thanks to this, Sonic falls much more slowly. <br><br><a name="Jump_Velocity"></a>  <b>Jump speed</b> <br><br>  The initial jump speed is -3.5 (-3 for Nackles), the speed at the time of separation from the ground is -2. <br><br><a name="Bubbles"></a>  <b>Bubbles</b> <br><br>  When Sonic collides under water with a bubble, his velocities in X and Y both become equal to 0. <br><br><a name="Entry_Exit"></a>  <b>entrance and exit</b> <br><br>  When Sonic falls into water, his horizontal speed is multiplied by 0.5, and the vertical speed is multiplied by 0.25 (this happens after adding gravity).  Conversely, when Sonic jumps out of the water, his vertical speed doubles (after adding the value of ‚Äúwater‚Äù gravity) and he begins to move faster, because water no longer affects his movement (however, leaving the water does not affect the horizontal speed). <br><br><a name="Drowning"></a>  <b>Drowning</b> <br><br>  When Sonic sinks, his speeds on X and Y both become equal to 0, and ‚Äúwater‚Äù gravity remains normal. <br><br><a name="Speed_Shoes"></a>  <b>Speed ‚Äã‚Äãshoes</b> <br><br>  If Speed ‚Äã‚ÄãShoes are worn on Sonic and he falls under water, water variables have a greater impact, thus zeroing all the effects of Speed ‚Äã‚ÄãShoes.  No calculations, such as multiplication by 0.5, are performed. <br><br><a name="Animation_Speeds"></a>  <b>Animation speeds</b> <br><br>  Diving under the water does not affect the speed of the animation of Sonic.  Animations whose speeds are proportional to variables that change, such as Sonic's speed, change automatically in the same proportion. <br><br>  <i>PS for attentive and curious readers.</i>  <i>In this series of posts there is a small Easter egg, namely, two encrypted English words.</i>  <i>Each part contains exactly one letter (that is, it is now possible to decrypt already 6 letters), there will be 14 of them, like the parts. sites.</i>  <i>Your guesses can be sent to the PM, for the read-on and just readers in the profile there is my mail.</i>  <i>The first one who guessed will have some nice bonus (for example, translation of an article that is interesting for him).</i>  <i>(I hope such riddles are not against the rules of Habr)</i> <br><br><img src="https://habrastorage.org/files/431/566/0a5/4315660a514f4269a5accf9671b01a30.png"></div><p>Source: <a href="https://habr.com/ru/post/305312/">https://habr.com/ru/post/305312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305298/index.html">Pass a technical interview (Level 2)</a></li>
<li><a href="../305300/index.html">Improving user interaction paths through page transitions</a></li>
<li><a href="../305304/index.html">Accidents on server farms</a></li>
<li><a href="../305306/index.html">Making a multi-channel full duplex walkie-talkie</a></li>
<li><a href="../305308/index.html">In the footsteps of Google I / O 2016 - the new Firebase: integration with Android</a></li>
<li><a href="../305314/index.html">It seems that Github is again unavailable in Russia ... and other sites</a></li>
<li><a href="../305316/index.html">Facebook Messenger will receive end-to-end encryption</a></li>
<li><a href="../305318/index.html">Photos from Varlamov. Honest business or misunderstood law</a></li>
<li><a href="../305330/index.html">Writing an adaptive template for Emlog CMS</a></li>
<li><a href="../305332/index.html">Encoder's good instincts will ultimately hit you in the teeth</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>