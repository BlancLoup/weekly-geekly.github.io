<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic renaming of hosts in Zabbix, according to data from snmp sysName</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The cycle of articles about Zabbix is ‚Äã‚Äãcontinued by an unregistered user. The first article can be read here . 

 Why do you need it? 
 You can add a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic renaming of hosts in Zabbix, according to data from snmp sysName</h1><div class="post__text post__text-html js-mediator-article">  The cycle of articles about Zabbix is ‚Äã‚Äãcontinued by an unregistered user.  The first article can be read <a href="http://osj.habrahabr.ru/blog/81630/">here</a> . <br><br><h2>  Why do you need it? </h2><br>  You can add a new host to Zabbix in two main ways: autodetect and manually add a host.  When we have a very large number of nodes, adding them to the monitoring system with pens takes a lot of time, tracking their numbers and keeping them up to date is also not an easy task.  In this case, it is convenient to use auto detection.  How to use it in this article will not be described (if anyone is interested it will be possible to prepare a small overview of the main functions).  The main disadvantage of auto-detection is that the added hosts get a name equal to the IP device.  With a large number of devices to figure out where that is problematic. <br><br><h2>  Decision. </h2><br><a name="habracut"></a>  As a rule, any device controlled by snmp has a standard OID .1.3.6.1.2.1.1.5.0 or system.sysName.0.  This is the so-called hostname glands.  As a device name, it is impossible to use any value obtained by OID by standard means in Zabbix. <br>  The easiest way is to use external scripts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  For PostgresSQL: </h4><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#!/bin/bash <br> <br> PGSQL="psql -d &lt; &gt; -h &lt;  &gt; -U &lt;  &gt; -W -c" <br> <br> $PGSQL" <font color="#0000ff">SELECT</font> ip <font color="#0000ff">FROM</font> hosts <font color="#0000ff">where</font> ip ILIKE <font color="#A31515">'192.168.1.%'</font> " | <font color="#0000ff">while</font> <font color="#0000ff">read</font> line <br> do <br> arr=($line) <br> x=`snmpwalk -Ou -Oq -v2c -c &lt;community string&gt; ${arr[0]} system.sysName.0 2&gt; /dev/ <font color="#0000ff">null</font> | awk <font color="#A31515">'{print$2}'</font> | tr "[: <font color="#0000ff">upper</font> :]" "[: <font color="#0000ff">lower</font> :] " ` <br> [[ -n $x ]] &amp;&amp; $PGSQL" <font color="#0000ff">UPDATE</font> hosts <font color="#0000ff">SET</font> <font color="#0000ff">host</font> = <font color="#A31515">'$x'</font> <font color="#0000ff">WHERE</font> ip = <font color="#A31515">'${arr[0]}'</font> " <br> <br> done</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><h4>  For MYSQL: </h4><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#!/bin/bash <br> <br> MYSQL="mysql --connect_timeout 10 &lt; &gt; -h &lt;  &gt; -u &lt;  &gt; --password=&lt;&gt; --skip- <font color="#0000ff">column</font> - <font color="#0000ff">names</font> -B -e" <br> <br> $MYSQL " <font color="#0000ff">SELECT</font> ip <font color="#0000ff">FROM</font> hosts <font color="#0000ff">where</font> ip <font color="#0000ff">like</font> <font color="#A31515">'192.168.1.%'</font> " | <font color="#0000ff">while</font> <font color="#0000ff">read</font> line <br> do <br> arr=($line) <br> x=`snmpwalk -Ou -Oq -v2c -c &lt;community string&gt; ${arr[0]} system.sysName.0 2&gt; /dev/ <font color="#0000ff">null</font> | awk <font color="#A31515">'{print$2}'</font> | tr "[: <font color="#0000ff">upper</font> :]" "[: <font color="#0000ff">lower</font> :] " ` <br> [[ -n $x ]] &amp;&amp; $MYSQL " <font color="#0000ff">UPDATE</font> hosts <font color="#0000ff">SET</font> <font color="#0000ff">host</font> = <font color="#A31515">'$x'</font> <font color="#0000ff">WHERE</font> ip = <font color="#A31515">'${arr[0]}'</font> " <br> <br> done</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Instead of '192.168.1.%' We substitute the desired range of ip addresses of the glands. <br>  Save the script in a convenient place to use, do chmod + X and run as needed.  You can register this script in cron. <br><br>  There is an option to go further and slightly changing the script to execute it under the action of auto-detection by Zabiks himself, but only for the piece of iron that was found.  It is not difficult to make it, but there was no need. <br><br>  The article is written by an <s>unregistered</s> user <a href="https://habrahabr.ru/users/sersad/" class="user_link">sersad</a> <br><br></div><p>Source: <a href="https://habr.com/ru/post/82465/">https://habr.com/ru/post/82465/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../82455/index.html">Old Diseases and New Oper Sores</a></li>
<li><a href="../82458/index.html">Today (Moscow time in the morning) the fifth-generation Russian fighter (PAK FA) took to the air</a></li>
<li><a href="../82459/index.html">"Hot Planets" turned out to be stars</a></li>
<li><a href="../82463/index.html">The most expensive camera in the world</a></li>
<li><a href="../82464/index.html">Marilyn Manstr</a></li>
<li><a href="../82466/index.html">Again ipad 0_o</a></li>
<li><a href="../82467/index.html">Live photo (or bring the future closer)</a></li>
<li><a href="../82468/index.html">idomen and ragtime - I resent!</a></li>
<li><a href="../82471/index.html">Nontrivial task for Node Reference Drupal fields</a></li>
<li><a href="../82472/index.html">Registration on the site. Pros, cons, pitfalls</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>