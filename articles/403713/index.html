<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability in Intel AMT turned out to be more serious than they thought.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On May 1, 2017, Intel announced a critical vulnerability in Active Management Technology (AMT) (INTEL-SA-00075, aka CVE-2017-5689 ). Vulnerability fou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability in Intel AMT turned out to be more serious than they thought.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/277/70b/343/27770b34399f023dc48c0a762649c26a.png"><br><br>  On May 1, 2017, Intel announced a <a href="https://security-center.intel.com/advisory.aspx%3Fintelid%3DINTEL-SA-00075%26languageid%3Den-fr">critical vulnerability in Active Management Technology (AMT)</a> (INTEL-SA-00075, aka <a href="https://www.cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3D2017-5689">CVE-2017-5689</a> ).  Vulnerability <a href="https://www.embedi.com/news/mythbusters-cve-2017-5689">found Maxim Malyutin</a> from the company Embedi, but kept it secret at the request of Intel before the official announcement. <br><a name="habracut"></a><br>  Intel AMT is a hardware technology that provides remote and out-of-band (via an independent auxiliary TCP / IP channel) access to manage settings and security of a computer regardless of the power state (remote on / off of the computer) and OS status.  The technology is integrated into the chipset.  If you use it as an anti-rootkit for scanning the RAM and PC drives, then there are no ways to bypass such protection.  Worse, remote queries to the AMT are not logged in the system log. <br><br>  Now a <a href="https://www.shodan.io/search%3Fquery%3Dport%253A%252216992%2522%2BIntel">query to Shodan</a> issues more than 8500 systems with open ports AMT.  For some BIOS firmwares, patches that fix the bug in AMT have not yet been released. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The AMT technology allows system administrators to remotely perform various actions on the system: turn on off computers, change bootloader code, control input devices, executable programs, etc. In fact, AMT allows you to perform all actions that you can perform remotely. having physical access to the PC. <br><br>  After reading the description of the technology, you can begin to fantasize what possibilities the hacker has, having remote access to an off computer with the AMT technology.  So, your fantasies <a href="https://www.tenable.com/blog/rediscovering-the-intel-amt-vulnerability">were true</a> .  Remote access to AMT is provided via the web interface in the browser.  As Maxim found out, any cryptographic hash is suitable for <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25B0%25D0%25B9%25D0%25B4%25D0%25B6%25D0%25B5%25D1%2581%25D1%2582-%25D0%25B0%25D1%2583%25D1%2582%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2584%25D0%25B8%25D0%25BA%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">digest access authentication,</a> or none at all.  That is, the corresponding field in the authorization form can be left empty. <br><br>  It doesn't even look like a backdoor, because who will implement it in such a clumsy way? <br><br>  Vulnerable systems after 2010-2011 release (a list of vulnerable firmware, see below).  This is 100% not RCE, but rather a logical vulnerability.  Maxim Malyutin believes that there are several attack vectors, as an attacker could use this vulnerability, perhaps even on Intel systems without Intel AMT support. <br><br>  ‚ÄúAuthentication <i>is still</i> working, <a href="https://arstechnica.com/security/2017/05/the-hijacking-flaw-that-lurked-in-intel-chips-is-worse-than-anyone-thought/">‚Äù</a> Malyutin <a href="https://arstechnica.com/security/2017/05/the-hijacking-flaw-that-lurked-in-intel-chips-is-worse-than-anyone-thought/">explained</a> .  ‚ÄúWe just found a way around it.‚Äù <br><br>  Through a web browser, you can get full access to the AMT functions, as if you recognize the admin password in the system.  Here is how this is done using the local proxy at 127.0.0.1:16992: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.htm HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>:<span class="hljs-number"><span class="hljs-number">16992</span></span> <span class="hljs-keyword"><span class="hljs-keyword">User</span></span>-Agent: Mozilla/<span class="hljs-number"><span class="hljs-number">5.0</span></span> (X11; Linux x86_64; rv:<span class="hljs-number"><span class="hljs-number">45.0</span></span>) Gecko/<span class="hljs-number"><span class="hljs-number">20100101</span></span> Firefox/<span class="hljs-number"><span class="hljs-number">45.0</span></span> Accept: <span class="hljs-type"><span class="hljs-type">text</span></span>/html,application/xhtml+<span class="hljs-type"><span class="hljs-type">xml</span></span>,application/<span class="hljs-type"><span class="hljs-type">xml</span></span>;q=<span class="hljs-number"><span class="hljs-number">0.9</span></span>,*<span class="hljs-comment"><span class="hljs-comment">/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: keep-alive HTTP/1.1 401 Unauthorized WWW-Authenticate: Digest realm="Digest:048A0000000000000000000000000000", nonce="qTILAAUFAAAjY7rDwLSmxFCq5EJ3pH/n",stale="false",qop="auth" Content-Type: text/html Server: AMT Content-Length: 678 Connection: close GET /index.htm HTTP/1.1 Host: 127.0.0.1:16992 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/</span></span>*;q=<span class="hljs-number"><span class="hljs-number">0.8</span></span> Accept-<span class="hljs-keyword"><span class="hljs-keyword">Language</span></span>: en-US,en;q=<span class="hljs-number"><span class="hljs-number">0.5</span></span> Accept-<span class="hljs-keyword"><span class="hljs-keyword">Encoding</span></span>: gzip, deflate <span class="hljs-keyword"><span class="hljs-keyword">Connection</span></span>: keep-alive <span class="hljs-keyword"><span class="hljs-keyword">Authorization</span></span>: Digest username="admin", realm="Digest:048A0000000000000000000000000000", nonce="qTILAAUFAAAjY7rDwLSmxFCq5EJ3pH/n", uri="/index.htm", response="", qop=auth, nc=<span class="hljs-number"><span class="hljs-number">00000001</span></span>, cnonce="60513ab58858482c" HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK <span class="hljs-type"><span class="hljs-type">Date</span></span>: Thu, <span class="hljs-number"><span class="hljs-number">4</span></span> May <span class="hljs-number"><span class="hljs-number">2017</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span> GMT <span class="hljs-keyword"><span class="hljs-keyword">Server</span></span>: AMT Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>: <span class="hljs-type"><span class="hljs-type">text</span></span>/html Transfer-<span class="hljs-keyword"><span class="hljs-keyword">Encoding</span></span>: chunked <span class="hljs-keyword"><span class="hljs-keyword">Cache</span></span>-Control: no <span class="hljs-keyword"><span class="hljs-keyword">cache</span></span> Expires: Thu, <span class="hljs-number"><span class="hljs-number">26</span></span> Oct <span class="hljs-number"><span class="hljs-number">1995</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> GMT <span class="hljs-number"><span class="hljs-number">04E6</span></span></code> </pre> <br>  A few days after the information was disclosed, Tenact <a href="https://www.tenable.com/blog/intel-amt-vulnerability-detection-with-nessus-and-pvs-intel-sa-00075">released an exploit</a> to exploit a critical vulnerability with an increase in AMT privileges.  The company offered to use this tool to detect vulnerable systems in its network.  That system administrators knew where to install new firmware versions.  The exploit is implemented as a <a href="http://www.tenable.com/plugins/index.php%3Fview%3Dsingle%26id%3D97999">Nessus plugin</a> . <br><br>  On the same days, the largest security server and personal computer manufacturers released official security messages for their customers: a <a href="https://support.hp.com/us-en/document/c05507350">message from HP</a> , <a href="http://en.community.dell.com/techcenter/extras/m/white_papers/20443914">from Dell</a> , <a href="https://support.lenovo.com/us/en/product_security/LEN-14963">from Lenovo</a> , <a href="http://support.ts.fujitsu.com/content/Intel_Firmware.asp">from Fujitsu</a> .  There will be detailed information about vulnerable firmware and links to updated versions will appear as soon as they become available. <br><br>  <b>List of patched firmware from Intel</b> <br><table border="1"><tbody><tr><th>  Vulnerable versions <br>  firmware </th><th>  Corresponding <br>  CPU generation </th><th>  Patched <br>  firmware </th></tr></tbody><tbody><tr><td width="107">  6.0.xx.xxxx <br><br></td><td rowspan="3" width="161">  1 <sup>st</sup> Gen Core <br><br></td><td width="163">  6.2.61.3535 <br><br></td></tr><tr><td width="107">  6.1.xx.xxxx <br><br></td><td width="163">  6.2.61.3535 <br><br></td></tr><tr><td width="107">  6.2.xx.xxxx <br><br></td><td width="163">  6.2.61.3535 <br><br></td></tr><tr><td width="107">  7.0.xx.xxxx <br><br></td><td rowspan="2" width="161">  2 <sup>nd</sup> Gen Core <br><br></td><td width="163">  7.1.91.3272 <br><br></td></tr><tr><td width="107">  7.1.xx.xxxx <br><br></td><td width="163">  7.1.91.3272 <br><br></td></tr><tr><td width="107">  8.0.xx.xxxx <br><br></td><td rowspan="2" width="161">  3 <sup>rd</sup> Gen Core <br><br></td><td width="163">  8.1.71.3608 <br><br></td></tr><tr><td width="107">  8.1.xx.xxxx <br><br></td><td width="163">  8.1.71.3608 <br><br></td></tr><tr><td width="107">  9.0.xx.xxxx <br><br></td><td rowspan="3" width="161">  4 <sup>th</sup> Gen Core <br><br><br><br></td><td width="163">  9.1.41.3024 <br><br></td></tr><tr><td width="107">  9.1.xx.xxxx <br><br></td><td width="163">  9.1.41.3024 <br><br></td></tr><tr><td width="107">  9.5.xx.xxxx <br><br></td><td width="163">  9.5.61.3012 <br><br></td></tr><tr><td width="107">  10.0.xx.xxxx <br><br></td><td width="161">  5 <sup>th</sup> Gen Core <br><br></td><td width="163">  10.0.55.3000 <br><br></td></tr><tr><td width="107">  11.0.xx.xxxx <br><br></td><td width="161">  6 <sup>th</sup> Gen Core <br><br></td><td width="163">  11.0.25.3001 <br><br>  11.0.22.3001 <br><br>  11.0.18.3003 <br><br></td></tr><tr><td width="107">  11.5.xx.xxxx <br><br></td><td rowspan="2" width="161">  7 <sup>th</sup> Gen Core <br><br></td><td width="163">  11.6.27.3264 <br><br></td></tr><tr><td width="107">  11.6.xx.xxxx <br><br></td><td width="163">  11.6.27.3264 <br><br>  11.6.12.3202 <br><br></td></tr></tbody></table>  Intel has released the <a href="https://downloadcenter.intel.com/download/26755">official tool</a> to check the system for vulnerabilities under Windows 7/10, as well as a guide for its use. </div><p>Source: <a href="https://habr.com/ru/post/403713/">https://habr.com/ru/post/403713/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../403703/index.html">Where are the Saturn 5 rockets?</a></li>
<li><a href="../403705/index.html">Permian shale basin model</a></li>
<li><a href="../403707/index.html">Radio from ... potatoes</a></li>
<li><a href="../403709/index.html">Turn off the light. What to do?</a></li>
<li><a href="../403711/index.html">How delivery services and online stores in the US affect traffic congestion</a></li>
<li><a href="../403715/index.html">Legend has become more accessible</a></li>
<li><a href="../403717/index.html">Sewn electronics for children: expectation and reality</a></li>
<li><a href="../403719/index.html">Why design will soon completely replace the front-end</a></li>
<li><a href="../403723/index.html">Wanhao Duplicator 7 changes the rules of the game</a></li>
<li><a href="../403725/index.html">Multiroom: The Coming Future of Smart AV and the Beginning of the End of Traditional Systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>