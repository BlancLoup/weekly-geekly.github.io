<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Developing a game application for the iPhone. Part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Development time - 6+ months of two people in their free time. 
 Team composition - 1 artist 1 programmer. 
 Time from idea to prototype - 1 week 
 Ar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Developing a game application for the iPhone. Part 3</h1><div class="post__text post__text-html js-mediator-article">  Development time - 6+ months of two people in their free time. <br>  Team composition - 1 artist 1 programmer. <br>  Time from idea to prototype - 1 week <br>  Art data - 288 megabytes, 1400 files <br>  Code Engine and Games (without third-party libraries) ~ 50024 lines of code, 485 files <br>  Game Code - 4338 lines - 12 files <br>  The final size of the distribution for upload in AppStore 22mb <br>  Final size in AppStore 25MB <br><br><a name="habracut"></a><br><br>  The code was measured using <a href="http://blog.schuager.com/2009/01/line-count-in-visual-studio.html">blog.schuager.com/2009/01/line-count-in-visual-studio.html</a> (Only engine and game projects were left in the solution) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Prehistory </h4><br>  <a href="http://habrahabr.ru/blogs/macosxdev/122351/">Part 1</a> <br>  <a href="http://habrahabr.ru/blogs/macosxdev/123919/">Part 2</a> <br><br><h4>  Work organization </h4><br><br>  Project management was organized online using Google Sites and Google Docs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e19/aec/d18/e19aecd18161bd8affdbee147cc3257b.png" alt="image"><br>  Project home page.  On the left is a list of projects and their internal pages: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7b/956/a4e/c7b956a4e76a6bbfcdb858b2b2278508.png" alt="image"><br>  You can create pages whose template are file storages, for example: <br>  Limit 20 MB per file and 100 MB for the entire site. <br>  When our builds became larger than 20 megabytes, we started fumbling through Google Docs <br><br><img src="https://habrastorage.org/getpro/habr/post_images/414/ecf/a0f/414ecfa0fada40b39a375bfc9ded7611.png" alt="image"><br>  You can create pages, the template of which are all sorts of Issue Trackers <br><br><h5>  Pros: </h5><br><ul><li>  Is free </li><li>  Does not require time for support </li><li>  Online </li></ul><br><h5>  Minuses: </h5><br><ul><li>  The lack of a forum in the capabilities of Google Sites </li><li>  Restriction on file sizes and site size - but no one forbids creating more than one site per account </li></ul><br><br><h4>  Development </h4><br>  Development went on weekends (up to 10 hours in total over the weekend) and sometimes in working hours after 7 pm (2-3 hours). <br>  The gameplay from the prototype stage and until the release almost did not change.  A lot of time was spent balancing spawn, as a result so-called spawn waves, falling helmets and arrows were added.  Initially, the game was planned as a paid one, but at some point we decided to experiment with the free version.  Plans for features for the future paid version are now very carefully sorted, weighed and discussed.  A strong optimization of load time and memory (details below). <br>  Switching to Xcode 4 is busy for 2 days.  For me, the xCode 4 environment didn‚Äôt seem very much, even compared to xCode 3 (lack of compilation and preprocessing capability, lack of the ability to customize the toolbar, Build for Archive constant rebuild glitches, brakes, etc.).  I liked very much to use the profiler - in my opinion this is the most convenient of all profilers I've used (including Windows).  From now on I prefer through it. <br><br><h4>  Assets </h4><br>  Art was originally made in the vector and exported to png.  I hope that when the 3rd iPad comes out and there will be another netivny permission, the conversion will be quick and painless.  Now it is exported as for 1024x768 and special scripts are prepared for iphone (480x320), iphone retina (960x640). <br><br>  Total: <br><ul><li>  basic set of assests for the iPad </li><li>  for each platform its own set of assets (generated by the rules of the script) </li><li>  if the distillation script generated the same .png files, this is not a problem, as it is taken into account at the stage of generating the pack file. </li></ul><br><h4>  Sound </h4><br>  Sound in .ogg.  Some of the sounds are played in streams, the number and length of the OEnAL buffers is set via the config.  Streaming sound playback was completely debugged on Windows and earned on the iPhone without any changes. <br>  Now I am considering alternatives to vorbis-ogg because of the relatively slow decoding.  I look towards IMA4 (which is maintained at the level of iron). <br>  Perhaps the sound in IMA4 will be converted during the compilation of the pack (described below). <br><br><h4>  Game resources </h4><br>  For iOS builds, all data was pushed into a pack file. <br>  A packfile is compiled assets for the required platform using additional optimizations: <br><ul><li>  Check and remove alpha from textures where it is all white </li><li>  Compress data if size reduces file size by more than NN percent. </li><li>  File Instance Detection </li><li>  Precompilation and stripping of scripts and configuration files </li><li>  Run OptiPng on all png resources, including Defaul.png and Icon ###. Png </li><li>  converting some (large) png files into its own format (due to the fact that png uses zlib (deflate) which does not unpack very quickly (see below for details) </li></ul><br>  Why do you need it: <br><ul><li>  there is always only one data0000.pak file in the project - it saves you from adding each asset to the Xcode project and completely eliminates errors at this stage </li><li>  Download speed - on Iphone 4 from 10 seconds to 5 seconds, on Windows from 5 seconds to less than a second </li><li>  Dimensions - all data in the pack is compressed and optimized </li></ul><br><h5>  Features of the implementation of the pack file </h5><br>  This is not a zip file, but a simple proprietary format (which often changes from version to version). <br>  Why not a zip file - unpacking zlib on iPhone does not give any advantages - loading time from a file for uncompressed data is faster than unpacking. <br>  The options that I tried: <br><ul><li>  zlib - very slow with excellent compression (test parrots unpack for 15ms) </li><li>  snappy - is fast, but the compression is not very (test parrots unpacks in 5ms) (the Windows version is sometimes asserted on not aligned data - there wasn‚Äôt much time to understand) </li><li>  flastlz - fast and with good compression (test parrots unpack for 7ms) - <a href="http://www.fastlz.org/">www.fastlz.org</a> </li></ul><br>  Do not forget that the application from the AppStore is downloaded in a packed form, therefore the level of compression is not very important. <br>  Linking fastlz and over zip (appstore) arranged for me.  Zip for appstore compresses packs by another 4 MB.  C 19 to 15 megabytes. <br>  In the future, there are plans to recheck snappy. <br>  On pre-release days, JPG was also revised as an alternative format for storing textures, not all, but only 24 bits, and only those that after JPG differ by the minimum error (large textures that satisfy this condition, I found at least 5).  This will be an additional step at the stage of compiling the file pack. <br>  Now the pack build takes about 15 seconds and is done only before compiling for the iPhone (climbed through the RSync from the Wind Machine) <br><br>  A 20 MB limit appeared on the size of the application in the AppStore (restriction for downloading through 3g). <br>  As the data does not pack, and how not cool we always get more than 20. If our product were paid, we would certainly be divided into HD and not HD. <br>  In our case (free application) decided not to share. <br><br><h4>  Advertising </h4><br>  Advertising from iAd and AdMob is embedded in the application - banners are not shown in the gameplay (and will never be shown) <br>  On the latest version of my first application, the ad logic has been fixed.  The final version works like this: If iAd for some reason feils, (judging by the reports, this happens almost 90% of the time for non-USA, Germany, France) then adMob is connected.  As a result of this change, the amount of money brought up by adMob has seriously increased. <br><br><h4>  Result </h4><br>  The application can be downloaded in the AppStore and it is free (honestly free).  Brings money only for clicks on banners.  Universal application for iPhone, iPhone4 (Retina) and iPad. <br><br><h4>  Useful software </h4><br><ul><li>  AppResigner - a program that allows you to relocate from AppStore Distribution provision to Dev provision, which allows you to test the binary that you will send to the AppStore (the jail bladed device allows you to test even with AppStore Distribution) </li><li>  SvnX client for svn under MacOS </li><li>  VisualSVN - server with UI for Windows </li><li>  swRSyncServer - rsync for Windows (used for sync packs between Windows and MacOS) </li></ul><br><h4>  What well: </h4><br><ul><li>  Did not roll anything </li><li>  The quality of which is very satisfied </li><li>  We like the game </li></ul><br><h4>  What is wrong: </h4><br><ul><li>  Not invested in 20 MB </li><li>  He dragged out - about 6 months - the last month was very hard to work. </li></ul><br><h4>  What's next: </h4><br><ul><li>  Android (most likely before the new year) </li><li>  Setting up a full pipeline for the night build </li></ul></div><p>Source: <a href="https://habr.com/ru/post/128953/">https://habr.com/ru/post/128953/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128945/index.html">ConfeT & QA Testers Online Conference</a></li>
<li><a href="../128948/index.html">Immersion into the scripts of the Unity3d game engine, part 2</a></li>
<li><a href="../128949/index.html">Facebook API: How to allow commenting on a wall post to everyone [upd: 09/25/2011]</a></li>
<li><a href="../128951/index.html">Validation messages in Russian in Rails 3</a></li>
<li><a href="../128952/index.html">Ocsigen 2.0 - a new version of the framework for OCaml</a></li>
<li><a href="../128954/index.html">Future brand logos</a></li>
<li><a href="../128955/index.html">Firefox Sync OR Xmarks? AND!</a></li>
<li><a href="../128957/index.html">Meeting 1, season 2011: storing data in WP 7.5 and using Event Tracing in Windows</a></li>
<li><a href="../128959/index.html">A small haiku contest on IT topics</a></li>
<li><a href="../128960/index.html">Where to watch f8 today?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>