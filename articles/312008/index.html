<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write a smart contract for Solidity. Part 1 - installation and "Hello world"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="People interested in the blockchain theme have already heard about the project of the Russian-Canadian programmer Vitalik Buterin - Ethereum , and alo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write a smart contract for Solidity. Part 1 - installation and "Hello world"</h1><div class="post__text post__text-html js-mediator-article"><p>  People interested in the blockchain theme have already heard about the project of the Russian-Canadian programmer Vitalik Buterin - <a href="http://ethereum.org/">Ethereum</a> , and along with it about the so-called smart contracts.  In this series of articles, I will try as simple as possible to describe the essence of Ethereum, smart contracts, the concept of gas and show how smart contracts are written. </p><br><h3 id="smart-contract--gas">  Smart Contract &amp; Gas </h3><br><p>  If on the fingers, a ‚Äúsmart contract‚Äù is some code that lives inside the blockchain.  Any member of the network can call it for a small fee.  This fee is called Gas, literally "fuel."  Why do you need it?  To protect the miner from the abuse of fraud his resources. </p><br><p>  Few people know, but even in Bitcoin there is an opportunity to write these very contracts, but for some reason very few people do it.  One of the main problems is that the <a href="https://en.bitcoin.it/wiki/Script">Script</a> language is not Turing-complete and it is not easy to write something less serious (so that you understand the scale of the problem, there is not even the possibility to add a loop).  In the case of Ethereum, everything is a little different, Turing languages ‚Äã‚Äãare full, and there is a risk that someone will write a contract of the form. </p><br><pre><code class="hljs pgsql">//   foo = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) { foo++; }</code> </pre> <br><p>  It is clear that the miner who launched this contract will not finish soon and in fact will simply spend his resources to nowhere.  So that this did not happen, the developers of Ethereum and invented gas - in reality, it would be economically inexpedient to run a code like what I wrote, because the caller will have to pay for every contract action. </p><a name="habracut"></a><br><p>  The cost of calling a contract in gas is very easy to calculate - the ready code can be compiled and presented as a sequence of assembler commands.  Here is the <a href="https://ethereum.github.io/browser-solidity/">online compiler</a> , it already has a sample code, you just need to click <b>Compile</b> &gt; <b>Toggle Details</b> &gt; <b>Assembly</b> .  For each team there is a hardcoded cost. </p><br><p>  At the moment, the cost of one gas is 50 wei - that is, 50 * 10 ^ -18 ether. </p><br><h3 id="environment">  Environment </h3><br><p>  In order to start working with Ethereum, it is not necessary to synchronize the entire current blockchain - the platform makes it easy to create a so-called "private blockchain", which we will do.  This is reasonable not only because it will take you a couple of days to download the whole chain, but also because you can play with the contracts without paying real money for it (and you have to pay for gas, including loading the contract into the blockchain). </p><br><h4 id="ustanovka-command-line-klienta-ethereum">  Ethereum client command line installation </h4><br><p>  We will use <a href="https://github.com/ethereum/go-ethereum/wiki/geth">geth</a> .  It is written in Go and is recommended to be used in most articles.  Here is his <a href="https://github.com/ethereum/go-ethereum/wiki/Building-Ethereum">official documentation</a> . </p><br><pre> <code class="bash hljs"> sudo apt-get install software-properties-common sudo add-apt-repository -y ppa:ethereum/ethereum sudo apt-get update sudo apt-get install ethereum</code> </pre> <br><p>  Installation instructions for other operating systems can be found <a href="https://www.ethereum.org/cli">here</a> .  Here you can find other client implementations - in C ++ or in Python. </p><br><h4 id="podnimaem-nodu">  Raise the node </h4><br><p>  To get started, just write in the terminal <code>geth</code> .  This command will start the node to work in the main blockchain and start synchronizing the blocks.  We will not do this, but if you really need, I recommend using <code>geth --fast --cache 1024</code> .  The important point is that with the --fast flag you download only block headers and, according to the Internet, you can download 500,000 blocks in half an hour, which is an order of magnitude faster than classical synchronization.  But if you have already started downloading without this flag, you will have to delete everything and start again.  Read more <a href="http://ethereum.stackexchange.com/a/3805/4406">here</a> . </p><br><p>  The main option for us is the console, which will allow us to work with geth in an interactive mode.  We will also use the --dev flag, which runs geth in private blockchain mode.  <code>geth --dev console</code> .  We assume that now you have a good deal with the subtleties of geth.  As an example, below is the code of work with the miner, I think you will understand everything yourself. </p><br><pre> <code class="javascript hljs">&gt; personal.newAccount(<span class="hljs-string"><span class="hljs-string">"123"</span></span>) <span class="hljs-comment"><span class="hljs-comment">//      "123" "0x07ae7ebb7b9c65b51519fc6561b8a78ad921ed13" //   &gt; eth.accounts //    ["0x07ae7ebb7b9c65b51519fc6561b8a78ad921ed13"] &gt; miner.setEtherbase(eth.accounts[0]) //        true &gt; eth.coinbase //  "0x07ae7ebb7b9c65b51519fc6561b8a78ad921ed13" //   &gt; miner.start() //       ,      31,32,... true I1005 09:25:44.363901 miner/miner.go:136] Starting mining operation (CPU=2 TOT=3) I1005 09:25:44.364247 miner/worker.go:539] commit new work on block 31 with 0 txs &amp; 0 uncles. Took 291.8¬µs I1005 09:25:45.049267 miner/worker.go:342] Mined block (#31 / 4ca861c2). Wait 5 blocks for confirmation I1005 09:25:45.049567 miner/worker.go:539] commit new work on block 32 with 0 txs &amp; 0 uncles. Took 133.101¬µs I1005 09:25:45.049976 miner/worker.go:539] commit new work on block 32 with 0 txs &amp; 0 uncles. Took 121.3¬µs I1005 09:25:45.632474 miner/worker.go:342] Mined block (#32 / f79f0df7). Wait 5 blocks for confirmation I1005 09:25:45.632796 miner/worker.go:539] commit new work on block 33 with 0 txs &amp; 0 uncles. Took 182.601¬µs I1005 09:25:45.632915 miner/worker.go:539] commit new work on block 33 with 0 txs &amp; 0 uncles. Took 86.9¬µs I1005 09:25:46.441888 miner/worker.go:342] Mined block (#33 / 16e99579). Wait 5 blocks for confirmation I1005 09:25:46.442257 miner/worker.go:539] commit new work on block 34 with 0 txs &amp; 0 uncles. Took 268.9¬µs I1005 09:25:46.442440 miner/worker.go:539] commit new work on block 34 with 0 txs &amp; 0 uncles. Took 120.201¬µs &gt; miner.stop() true &gt; eth.getBalance(eth.coinbase) //   15000000000000000000</span></span></code> </pre> <br><p>  The attentive reader noticed that everything written suspiciously reminds JS - this is what he is.  For example, the function code that displays accounts with balances in a readable form: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkAllBalances</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> totalBal = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> acctNum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> eth.accounts) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> acct = eth.accounts[acctNum]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> acctBal = web3.fromWei(eth.getBalance(acct), <span class="hljs-string"><span class="hljs-string">"ether"</span></span>); totalBal += <span class="hljs-built_in"><span class="hljs-built_in">parseFloat</span></span>(acctBal); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" eth.accounts["</span></span> + acctNum + <span class="hljs-string"><span class="hljs-string">"]: \t"</span></span> + acct + <span class="hljs-string"><span class="hljs-string">" \tbalance: "</span></span> + acctBal + <span class="hljs-string"><span class="hljs-string">" ether"</span></span>); } <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" Total balance: "</span></span> + totalBal + <span class="hljs-string"><span class="hljs-string">" ether"</span></span>); };</code> </pre> <br><p>  Save this code in geth_scripts.js and run it. </p><br><pre> <code class="javascript hljs">&gt; loadScript(<span class="hljs-string"><span class="hljs-string">"geth_scripts.js"</span></span>) <span class="hljs-literal"><span class="hljs-literal">true</span></span> &gt; checkAllBalances() eth.accounts[<span class="hljs-number"><span class="hljs-number">0</span></span>]: <span class="hljs-number"><span class="hljs-number">0x07ae7ebb7b9c65b51519fc6561b8a78ad921ed13</span></span> balance: <span class="hljs-number"><span class="hljs-number">15</span></span> ether <span class="hljs-literal"><span class="hljs-literal">undefined</span></span></code> </pre> <br><p>  Now that you have become a recognized Geth expert, you can close the console with peace of mind and start using the GUI as a white man. </p><br><h4 id="mist-wallet">  Mist wallet </h4><br><p>  <a href="https://github.com/ethereum/mist">Mist</a> is by far the most common wallet for Ethereum.  Written using Meteor, cross-platform, for installation you just need to download the installation file from the <a href="https://github.com/ethereum/mist/releases">releases page</a> . </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/0ad/190/b95/0ad190b953259cc749f8532a2885677d.png" alt="image">  To date, there is no so-called light wallet that would allow working with contracts, so the first thing Mist will offer you is to synchronize either the Main network or Test-net.  We don't need all this for now, we will launch Mist on our private blockchain.  This is very easy to do: </p><br><pre> <code class="bash hljs">geth --dev --rpc --rpcaddr <span class="hljs-string"><span class="hljs-string">"0.0.0.0"</span></span> --rpcapi <span class="hljs-string"><span class="hljs-string">"admin,debug,miner,shh,txpool,personal,eth,net,web3"</span></span> console mist.exe --rpc http://localhost:8545</code> </pre> <br><p>  The first line does the same thing as before, but this time we also open the HTTP-RPC server, defaulting to <a href="http://localhost:8545/">http: // localhost: 8545</a> .  The rpcapi flag defines the permission set that the Mist will have after connecting to the server.  In this case, all that is indicated is general.  If, for example, you do not specify personal, then Mist will not be able to create new accounts, etc.  News set of command line options is listed <a href="https://github.com/ethereum/go-ethereum/wiki/Command-Line-Options">here</a> . </p><br><p>  The second line starts Mist with the specified RPC server.  If everything worked correctly, then the Private-net message should appear on startup. </p><br><h3 id="hello-world">  Hello, world! </h3><br><p>  It's time to create your first contract.  To do this, click on <b>Contracts</b> &gt; <b>Deploy new contract</b> . <br>  In the <b>Solidity contract source code</b> window we write: </p><br><pre> <code class="javascript hljs">contract mortal { <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> address owner; <span class="hljs-comment"><span class="hljs-comment">/*     -            owner     ,    */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mortal</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ owner = msg.sender; } <span class="hljs-comment"><span class="hljs-comment">/* selfdestruct           ,   */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* Ethereum              */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kill</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (msg.sender == owner) selfdestruct(owner); } } <span class="hljs-comment"><span class="hljs-comment">/* is   */</span></span> <span class="hljs-comment"><span class="hljs-comment">/*    contract_1 is contract_2, contract_3*/</span></span> contract greeter is mortal { string greeting; <span class="hljs-comment"><span class="hljs-comment">/*         -       "Hello, world!"*/</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">greeter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">string _greeting</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span></span>{ greeting = _greeting; } <span class="hljs-comment"><span class="hljs-comment">//       "Hello, world!" function greet() constant returns (string) { return greeting; } }</span></span></code> </pre> <br><p>  The language itself is pretty simple, here is its <a href="http://solidity.readthedocs.io/en/develop/">documentation</a> , many questions have already been discussed at <a href="http://ethereum.stackexchange.com/">ethereum.stackexchange.com</a> , in principle there is a chance to get answers in <a href="https://gitter.im/ethereum">gitter</a> . </p><br><h4 id="zagruzka-v-blokcheyn-i-zapusk-kontrakta">  Loading on the blockchain and launching a contract </h4><br><p>  After you selected the greeting contract, you specified "Hello, world" as the argument, clicked <b>Deploy</b> and entered a password, your contract only needs to be "minted" in the blockchain.  To do this, open a terminal with Geth enabled and a pair of mines (as described above).  Everything! </p><br><p>  Now going to the <b>Contracts</b> tab you will see a new contract with the name <b>GREETER 7D5D</b> , or something like that.  Click on it and enjoy the result.  If you wish, you can kill him by selecting the Kill function in the drop-down list on the right. </p><br><p>  <b>PS</b> My first article, scold strictly.  In the following parts, I think to write a cryptocurrency, tell about EVM nuances, show how to tie browser interfaces to Ethereum and maybe something else.  Sound criticism is welcome, thank you for your attention :) </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/312008/">https://habr.com/ru/post/312008/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311996/index.html">How Google Cloud breathed life into Pok√©mon GO</a></li>
<li><a href="../311998/index.html">Why you should not use finalizers</a></li>
<li><a href="../312002/index.html">Intel Software Guard Extensions, a series of educational materials. Part 1, Intel SGX Basics</a></li>
<li><a href="../312004/index.html">Higher Command Line Math - GNU Octave</a></li>
<li><a href="../312006/index.html">ZSON: PostgreSQL extension for transparent JSONB compression</a></li>
<li><a href="../312010/index.html">Google Online Conference: Progressive Web Apps Day (October 11)</a></li>
<li><a href="../312012/index.html">Oracle OpenWorld 2016: fundamentally new features of IaaS, PaaS and SaaS services</a></li>
<li><a href="../312016/index.html">Technocup. Again. Now cooler</a></li>
<li><a href="../312018/index.html">Analysis of tasks from the International Olympiad in Informatics IOI 2016</a></li>
<li><a href="../312020/index.html">We invite you to the Java-conference Joker 2016, which will be held on October 14 and 15 in St. Petersburg</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>