<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Another story about the home server, or the operation "silence"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, habrayuzer! 

 Surely every developer, sooner or later, is faced with the problem of the test environment. It is not very convenient t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Another story about the home server, or the operation "silence"</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, habrayuzer! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/600/4ff/bdd/6004ffbddb73aa5c1e005a34f4bdb843.jpg" alt="image" align="right">  Surely every developer, sooner or later, is faced with the problem of the test environment.  It is not very convenient to keep the PC turned on 24x7, and even fill it up with software for experiments to the eyeballs.  On the other hand, finding hosting on your own, not expensive either, is not an easy task.  What to do?  There is a solution - deploy the sandbox at home.  As I was convinced about this in more detail below, it is not expensive, it is convenient and very fascinating. <br><a name="habracut"></a><br>  <strong>Disclaimer: The</strong> <em>post is published at the request of <a href="https://habrahabr.ru/users/icepro/" class="user_link">icepro</a> , so do not rush to change karma to me, but rather help a good person with an invite.</em>  <em>You will not find revelations or unexpected solutions here, but going through a similar path you will be able to find everything you need in one place.</em> <br><br>  I will warn you in advance: article one, do not hit hard. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And now to the details.  I ask the bearded administrators and all the people competent in this topic in advance, do not grab the heart, fukat and rush to put minuses, because I‚Äôm just learning and didn‚Äôt deal with the administration.  But I hope the beginners can cut the path to Linux by a couple of steps and go through a quick acquaintance really quickly :) <br><br><h1>  Summary </h1><ol><li>  <a href="https://habr.com/ru/post/205120/">Filling</a> </li><li>  <a href="https://habr.com/ru/post/205120/">OS</a> </li><li>  <a href="https://habr.com/ru/post/205120/">Dev Environment</a> </li><li>  <a href="https://habr.com/ru/post/205120/">Backup</a> </li></ol><br><h1><a name="1"></a>  Filling </h1><hr>  So, the idea is, let's start to embody.  The most important criterion for me when choosing iron was the price, low energy consumption and the absence of noise (otherwise there was a risk that my wife would send my sandbox to the balcony, and even with me :)).  All this indicated that the form factor would be the target - MiniITX. <br><table><tbody><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/a9e/78c/e1e/a9e78ce1efdcf3ffda6cbe29086ff3eb.jpg" alt="image" align="left"></td><td><img src="https://habrastorage.org/getpro/habr/post_images/c28/5bc/47e/c285bc47e4538eaf24ec51c8f5119056.png" alt="image" align="right"></td></tr></tbody></table><br>  After wandering through online shopping, I found just such a motherboard: <b>Intel BOXD2500HN</b> . <br>  It is based on the <b>Intel Atom D2500 processor (1.86 GHz)</b> .  For me, this power was enough.  Energy consumption - 10 watts.  Price - about $ 70.  Passive cooling - no noise.  Also at home there was a 2 GB SO-DIMM memory and a semi-terabyte screw. <br>  Now about the case.  Again, I wanted less noise, and therefore the choice fell on the case with an external power supply <b>unit</b> - <b>DELUX E-2012 Black Mini-ITX</b> <br>  Total single cooler - 40 mm, placed above the hard drive (well, it was a regular place, so I decided to complete it completely). <br><br><h1><a name="2"></a>  OS </h1><hr>  The choice of OSes was not long.  Previously, I had to work with Ubuntu, so the choice fell on its foundation - Debian.  At the time of this writing, the latest version (which I installed) was 7.0 - Wheezy.  You can download it on offsite, where it is presented in several variations depending on the graphical shell.  I did not dare to install the bare console, and therefore I chose the most lightweight one among the options presented - LXDE. <br><br>  Immediately make a reservation - Debian struck me with the wealth of the software repository.  You can find anything in it.  In order to search by name the program of interest, we use the command: <br><pre><code class="bash hljs">sudo apt-cache search &lt; ,   &gt;</code> </pre>  for installation we perform <br><pre> <code class="bash hljs">sudo apt-get install &lt; &gt;</code> </pre><br>  Hereinafter, I will mention the installation of software, but you will already know how to do it. <br><br>  Installing Debian is not difficult.  Download the image and make a bootable USB flash drive ( <a href="http://www.linuxliveusb.com/">LinuxLive USB Creator</a> helps).  Next, boot from it and turn on the graphical installer (it will be easier).  Basically, the installation is similar to the installation of windows: click Next, Next, Next.  But some points are still there: <br>  - at the step of choosing markup, select individual sections <br>  - after the master of the automatic shredding of the disk shows you the intended structure - do not agree, increase the RootFS (the same "/") to at least a couple of gigabytes (I now have 512 MB and I have to keep a close eye on the partition) <br>  - the choice of software is left as is (daws on the "Desktop Environment" and "Standard System", the rest will be set later) <br>  If you still need step-by-step installation assistance, then I recommend to find on the Internet open spaces the Maunal "Web-server on Debian GNU_Linux for beginners". <br><br>  Next, several small system tweaks were produced: <br><ol><li><h3>  sudo </h3><br>  In order to be able to allow your user to execute commands on behalf of the superuser, you need to add it to the sudoer list.  Details of the settings can be found in the document I mentioned above, in the section ‚Äú1.2.1 Basic sudo setup‚Äù <br></li><li><h3>  Remote access </h3><br>  In order to be able to remote access, I'm not talking about ssh, but just the desktop, the VNC server was installed - x11vnc. <br>  The configuration is quite easy, first we generate the authorization file: <br><pre> <code class="bash hljs">x11vnc -storepasswd &lt;pass&gt; &lt;file&gt;</code> </pre><br>  and then add the VNC server to autoload (/ etc / xdg / lxsession / LXDE / autostart) <br><pre> <code class="bash hljs">@/usr/bin/x11vnc -dontdisconnect -display :0 -notruecolor -noxfixes -shared -forever -rfbport 5900 -<span class="hljs-built_in"><span class="hljs-built_in">bg</span></span> -o /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/x11vnc.log -rfbauth /home/ice/.vnc/passwd</code> </pre><br></li><li><h3>  Autologin </h3><br>  The motherboard is able to restore its state after the electricity was interrupted and resumed.  But if the monitor is not connected to the server and the system state is not visible, then after a power outage, the graphical environment will hang on the Login page after a reboot.  In order to eliminate this inconvenience we add the autologon feature for our user, for this we add the lines to the /etc/lightdm/lightdm.conf file: <br><pre> <code class="bash hljs">autologin-user=ice autologin-user-timeout=0</code> </pre><br></li><li><h3>  Hardware monitor </h3><br>  Monitor the equipment will help <br><pre> <code class="bash hljs">lshw lshw-gtk</code> </pre><br>  For temperature monitoring, I delivered lm-sensors and hddtemp. <br>  Team <br><pre> <code class="bash hljs">sensors</code> </pre>  shows information about MPs from available sensors. <br><br>  <i>Before using the utility, it is necessary that it detects all the sensors, for this it is necessary to run:</i> <br><pre> <code class="bash hljs">/usr/sbin/sensors-detect</code> </pre><br>  And the team <br><pre> <code class="bash hljs">hddtemp /dev/sda</code> </pre>  prompts to what temperature the hard drive has heated up. <br><br>  The first time I had a mania to check the temperature and other sensors, so I wrote a brief script for collecting and logging data: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash echo '################## TIME ##################' date echo '################# UP TIME ################' uptime echo '################# MB TEMP ################' sensors echo '################ HDD TEMP ################' sudo hddtemp /dev/sda echo echo</span></span></code> </pre><br>  Now we will create a script launch schedule, but first we will issue the right to execute it: <br><pre> <code class="bash hljs">visudo ice ALL=NOPASSWD: /home/ice/scripts/monitoring/temp.sh</code> </pre>  and now cron: <br><pre> <code class="bash hljs">sudo crontab -e -u ice */10 * * * * sudo /home/ice/scripts/monitoring/temp.sh &gt;&gt; /home/ice/scripts/monitoring/temp.log 2&gt;&amp;1</code> </pre><br>  Check that starts can be done with the command: <br><pre> <code class="bash hljs">grep CRON /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/syslog</code> </pre>  And one more thing - so that the logs do not accumulate, I set up their rotation.  To do this, install Logrotate <br><pre> <code class="bash hljs">sudo apt-get install logrotate</code> </pre><br>  And then we will create a configuration file in the /etc/logrotate.d/ folder.  My looks like this: <br><pre> <code class="bash hljs">/home/ice/scripts/monitoring/temp.log { <span class="hljs-comment"><span class="hljs-comment">#    daily #   missingok #      rotate 30 #   30   compress #    delaycompress #       (..  *.log.1   ,  *.log.2   ) notifempty #     create 640 ice ice #            }</span></span></code> </pre><br></li><li><h3>  Other stuff </h3><br><ul><li>  htop - advanced process monitor <br></li><li>  package for measuring system performance, the details here are <a href="http://packages.debian.org/ru/squeeze/sysstat">sysstat</a> , and the configuration here is <a href="http://www.leonardoborda.com/blog/how-to-configure-sysstatsar-on-ubuntudebian/">Permanent link / sar on Ubuntu / Debian</a> <br></li><li>  lynis is a utility that helps overcome the desire to "need more control and monitoring over the system", description - <a href="http://www.rootkit.nl/projects/lynis.html">lynis</a> <br></li><li>  rtorrent - a console torrent client (by the way, I also added a web-muzzle to it, very conveniently), details of the settings can be found here - <a href="http://blog.itradius.ru/%3Fp%3D15">Installing rtorent + rutorrent on Debian / Ubuntu</a> <br></li><li>  exim4 - mail server, configuration using GMail SMTP is described here - <a href="http://www.manu-j.com/blog/wordpress-exim4-ubuntu-gmail-smtp/75/">Configuring exim4 in Ubuntu to use GMail for SMTP</a> <br></li><li>  proftpd - FTP server (peeped on <a href="http://habrahabr.ru/post/48619/">setting up a home server based on Debian</a> ) <br></li><li>  samba - network file system (I wanted to try everything, I installed it here), the configuration can be found here - <a href="http://debiania.blogspot.com/2009/05/samba-debian-gnulinux-ubuntu-linux.html">Installing and configuring Samba on Debian GNU / Linux and Ubuntu Linux</a> <br>  For access, samba uses system users, you can add them to the SMB database using the command <br><pre> <code class="bash hljs">smbpasswd -a ice</code> </pre><br></li><li>  mc - useful file manager <br></li><li>  ssh - here without comments <br></li><li>  in the mount option (/ etc / fstab) added commit = 60 to combat excessive logging which the hard disk constantly tormented (jbd2 process) <br></li></ul><br></li></ol><br><br><h1><a name="3"></a>  Dev Environment </h1><hr>  So, now the most interesting thing is that I managed to cram it into this little box. <br><br>  <a href="https://habr.com/ru/post/205120/">LAMP</a> |  <a href="https://habr.com/ru/post/205120/">nginx</a> |  <a href="https://habr.com/ru/post/205120/">Node.js</a> |  <a href="https://habr.com/ru/post/205120/">MongoDB</a> |  <a href="https://habr.com/ru/post/205120/">Git</a> |  <a href="https://habr.com/ru/post/205120/">Java</a> |  <a href="https://habr.com/ru/post/205120/">Python</a> |  <a href="https://habr.com/ru/post/205120/">Ruby</a> |  <a href="https://habr.com/ru/post/205120/">.NET</a> |  <a href="https://habr.com/ru/post/205120/">Jenkins</a> <br><br><h2><a name="lamp"></a>  LAMP </h2><br>  Yes, I am an active web developer without hands on this platform.  Everything is put elementary: <br><pre> <code class="bash hljs">sudo apt-get update sudo apt-get upgrade sudo apt-get install apache2 apache2-doc php5 libapache2-mod-php5 php-pear sudo apt-get install mysql-server mysql-client php5-mysql sudo apt-get install php5-curl php5-gd php5-imagick php5-ldap php5-imap php5-memcache php5-common php5-mysql php5-ps php5-tidy imagemagick php5-xcache php5-xdebug php5-xmlrpc php5-xsl</code> </pre>  But immediately after the installation, I suffered a failure - php files did not want to be processed by apache in any way.  In order to fix this, I made the following manipulations: <br><pre> <code class="bash hljs">/etc/apache2$ sudo gedit apache2.con <span class="hljs-comment"><span class="hljs-comment">#     AddHandler application/x-httpd-php .php .php4 .php3 .html AddType application/x-httpd-php .html</span></span></code> </pre><br>  For convenient debug php, I installed and configured <b>xdebug</b> .  Installation is described in detail at the following links: <br>  - <a href="http://docs.joomla.org/Configuring_Xdebug_for_PHP_development/Linux">Configuring Xdebug for PHP development / Linux</a> <br>  - <a href="http://www.seocoder.org/2011/02/05/remote-xdebug-na-phpstorm/">Remote Xdebug on PhpStorm</a> <br><br>  <b>When creating virtual hosts do not forget to register them in hosts</b> <br><br><h2><a name="nginx"></a>  nginx </h2><br>  To increase Apache's performance, it is recommended to use it in conjunction with nginx with the following distribution of roles: apache - backend, nginx - frontend.  The article ‚Äú <a href="http://cname.org.ua/2010/04/%25D1%2583%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B0-%25D0%25B8-%25D0%25BD%25D0%25B0%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D0%25BA%25D0%25B0-nginx-nginx-frontend-apache-backend-%25D1%2583%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2/">Installation and configuration of Nginx‚Äù</a> describes how to perform such a configuration <a href="http://cname.org.ua/2010/04/%25D1%2583%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B0-%25D0%25B8-%25D0%25BD%25D0%25B0%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D0%25BA%25D0%25B0-nginx-nginx-frontend-apache-backend-%25D1%2583%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2/">.</a>  <a href="http://cname.org.ua/2010/04/%25D1%2583%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B0-%25D0%25B8-%25D0%25BD%25D0%25B0%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D0%25BA%25D0%25B0-nginx-nginx-frontend-apache-backend-%25D1%2583%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2/">Nginx frontend + Apache backend.</a> <br><br><h2><a name="node"></a>  Node.js </h2><br>  Excellent platform, especially for creating small client-server applications.  Only web-sockets are worth.  Well, okay, back to the installation.  Putting node.js is a little trivial, but not difficult - in a true way, that is, from the sources: <br><pre> <code class="bash hljs">sudo apt-get install python g++ make checkinstall mkdir ~/src &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> <span class="hljs-variable"><span class="hljs-variable">$_</span></span> wget -N http://nodejs.org/dist/node-latest.tar.gz tar xzvf node-latest.tar.gz &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> node-v* <span class="hljs-comment"><span class="hljs-comment">#  "v"       ./configure checkinstall sudo dpkg -i node_*</span></span></code> </pre><br>  A little more detailed installation is painted here - <a href="https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager">Installing Node.js</a> <br><br><h2><a name="mongo"></a>  MongoDB </h2><br>  Why not join the NoSQL community?  So I asked this question.  Well, maybe I did not plan to use NoSQL closely, but to touch it - why not? <br>  Install! <br><pre> <code class="bash hljs">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv 7F0CEB10 <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'deb http://downloads-distro.mongodb.org/repo/debian-sysvinit dist 10gen'</span></span> | sudo tee /etc/apt/sources.list.d/mongodb.list sudo apt-get update sudo apt-get install mongodb-10gen</code> </pre>  ... and run <br><pre> <code class="bash hljs">sudo /etc/init.d/mongodb start</code> </pre><br><h2><a name="git"></a>  Git </h2><br>  It has long been wanted to move out of the public repositories on github.  And now the time has come.  Git is not difficult to install, it is called git in the package repository, but it is a little more difficult to configure it for convenient operation, we need: <br>  - create a separate user - git <br>  - install giolite for administering repositories <br><br>  <i>This video helped overcome the situation when my keys generated in putty were ignored - <a href="http://www.youtube.com/watch%3Fv%3DBmpj-WdXllQ">How To Fix "Server Refused Our Key" Error That Caused By The RSA Public Key Generated By Puttygen</a></i> <br><br>  Next, we clone the giolite repository - ssh: //git@192.168.1.110: /gitolite-admin.git and voila, manage turnips. <br><br>  The following links helped to set up git + gitolite: <br>  - <a href="http://klen.github.io/gitolite-setup-ru.html">Server setup.</a>  <a href="http://klen.github.io/gitolite-setup-ru.html">Gitolite - hosting git repositories</a> <br>  - <a href="http://blog.publicfields.net/2010/09/git.html">Own git-server from scratch</a> <br><br>  For a convenient review of repositories from the browser exists - gitweb.  How to install it is described here - <a href="http://blog.gauner.org/blog/2010/02/03/setting-up-gitweb-on-debian/">Setting up Gitweb on Debian</a> . <br>  From myself I will add: <br><pre> <code class="bash hljs">usermod -a -G gitolite www-data</code> </pre>  in order that apach and gitolite make friends. <br><br><div class="spoiler">  <b class="spoiler_title">But setting up a virtual host (bit by bit collected from various sources has not worked yet)</b> <div class="spoiler_text"><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;VirtualHost *:81&gt;</span></span> <span class="hljs-attribute"><span class="hljs-attribute">ServerAdmin</span></span> webmaster@localhost ServerName git-web.loc SetEnv GITWEB_CONFIG /etc/gitweb.conf DocumentRoot /home/git/repositories Alias /static/gitweb.css /usr/share/gitweb/static/gitweb.css Alias /static/git-logo.png /usr/share/gitweb/static/git-logo.png Alias /static/git-favicon.png /usr/share/gitweb/static/git-favicon.png Alias /static/gitweb.js /usr/share/gitweb/static/gitweb.js Alias /git /home/git/repositories ScriptAlias /gitweb.cgi /usr/lib/cgi-bin/gitweb.cgi DirectoryIndex gitweb.cgi &lt;Directory /home/git/repositories/&gt; Allow from <span class="hljs-literal"><span class="hljs-literal">All</span></span> Options +ExecCGI AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> AuthType Basic AuthName <span class="hljs-string"><span class="hljs-string">"Private Repository"</span></span> AuthUserFile /home/ice/stuff/keys/.htpasswd-gitweb Require valid-user AddHandler cgi-script .cgi DirectoryIndex gitweb.cgi RewriteEngine <span class="hljs-literal"><span class="hljs-literal">On</span></span> RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{REQUEST_FILENAME}</span></span> !-f RewriteRule ^.* /gitweb.cgi/<span class="hljs-number"><span class="hljs-number">$0</span></span><span class="hljs-meta"><span class="hljs-meta"> [L,PT] &lt;/Directory&gt; SetEnv GIT_PROJECT_ROOT /home/git/repositories SetEnv GIT_HTTP_EXPORT_ALL ErrorLog ${APACHE_LOG_DIR}/git_web_error.log LogLevel warn CustomLog ${APACHE_LOG_DIR}/git_web_access.log combined &lt;/VirtualHost&gt;</span></span></code> </pre>  Basic authorization to taste, you can disable. <br></div></div><br><br><h2><a name="java"></a>  Java </h2><br>  Go to the java platform.  First, remove openjdk and install Java 7. <br><pre> <code class="bash hljs">sudo apt-get remove openjdk* su - <span class="hljs-comment"><span class="hljs-comment">#   java echo "deb http://ppa.launchpad.net/webupd8team/java/ubuntu precise main" | tee -a /etc/apt/sources.list echo "deb-src http://ppa.launchpad.net/webupd8team/java/ubuntu precise main" | tee -a /etc/apt/sources.list apt-key adv --keyserver keyserver.ubuntu.com --recv-keys EEA14886 apt-get update #   Oracle software license echo oracle-java7-installer shared/accepted-oracle-license-v1-1 select true | /usr/bin/debconf-set-selections #  Oracle JDK7 apt-get install oracle-java7-installer #    root exit #   java  java -version</span></span></code> </pre><br>  From above, I added the following software: <br>  - scala (just studying, why not practice on your server) <br>  - glassfish is one of the most actively developed (if not the most) application servers <br>  * if glassfish does not start due to the fact that port 8080 is busy (as it happened with me), then we will change the default port.  To do this, in GlassFish_Server \ glassfish \ domains \ domain1 \ config we find our port and set another one: <br> <code>&lt;network-listener name="http-listener-1" port="8081" protocol="http-listener-1" thread-pool="http-thread-pool" transport="tcp"&lt;/network-listener&gt;</code> <br> <br><h2><a name="python"></a>  Python </h2><br>  Next came python along with django.  Putting from the repository is pretty easy.  Here you can look at the ease of use - <a href="https://docs.djangoproject.com/en/dev/intro/tutorial01/">Writing your first Django app</a> <br><br><h2><a name="ruby"></a>  Ruby </h2><br>  Like a python, I chopped Ruby with my own framework - Rails.  Putting a little harder, so the drive instructions: <br><pre> <code class="bash hljs">apt-get install build-essential libapache2-mod-passenger ruby rdoc ruby-dev libopenssl-ruby rubygems gem install fastthread gem install rails --version 3.0.4</code> </pre>  And also do not forget to add rails in $ PATH: <br> <code>PATH=".../var/lib/gems/VERSION/bin"</code> <br>  Well, it's still as easy to use - <a href="http://guides.rubyonrails.org/getting_started.html">Getting Started with Rails</a> <br><br>  For internal needs, it was also decided to deploy a bug tracker, and it became - <b>Redmine</b> . <br>  Put like this: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#    aptitude install libmagickcode-dev aptitude install libmagickwand-dev aptitude install ruby1.9.1-dev aptitude install libmysqlclient-dev #    redmine cd /opt wget http://files.rubyforge.vm.bytemark.co.uk/redmine/redmine-2.3.1.tar.gz tar -zxvf redmine-2.3.1.tar.gz cd /var/www ln -s /redmine-2.3.1/public redmine chown -R www-data:www-data /opt/redmine-2.3.1</span></span></code> </pre><br>  Go to the mysql client and create a database and user: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span> redmine_default <span class="hljs-built_in"><span class="hljs-built_in">CHARACTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> utf8; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USER</span></span> <span class="hljs-string"><span class="hljs-string">'redmine'</span></span>@<span class="hljs-string"><span class="hljs-string">'localhost'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTIFIED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-string"><span class="hljs-string">'my-password'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">GRANT</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">PRIVILEGES</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> redmine_default.* <span class="hljs-keyword"><span class="hljs-keyword">TO</span></span> <span class="hljs-string"><span class="hljs-string">'redmine'</span></span>@<span class="hljs-string"><span class="hljs-string">'localhost'</span></span>;</code> </pre><br>  Create a base configuration <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /redmine-2.3.1/config cp database.yml.example database.yml vi database.yml</code> </pre>  and fill it up <br><pre> <code class="bash hljs">production: adapter: mysql2 database: redmine_default host: localhost username: redmine password: my-password encoding: utf8</code> </pre><br>  Create a configuration file: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /redmine-2.3.1/config cp configuration.yml.example configuration.yml vi configuration.yml</code> </pre>  and we are adjusted (the benefit in a config is full of comments). <br>  Now we put ruby ‚Äã‚Äãbundle <br><pre> <code class="bash hljs">gem install bundler bundle install --without development <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> postgresql sqlite rake generate_secret_token bundle install</code> </pre>  and prepare the database: <br><pre> <code class="bash hljs">RAILS_ENV=production rake db:migrate RAILS_ENV=production rake redmine:load_default_data</code> </pre><br>  After all this, you need to configure a virtual host in the Apache and you can use it. <br><br>  Configuration (getting information about the commit from the repository) is described here - <a href="http://www.redmine.org/projects/redmine/wiki/RedmineSettings">Redmine Settings</a> .  I chose the option in which the automatic polling of repositories is configured using Cron. <br><br><h2><a name="net"></a>  .NET </h2><br>  Do not forget about the .NET platform.  The main components are the actual mono platform and XSP (ASP.NET server) are put like this: <br><pre> <code class="bash hljs">sudo apt-get install mono-common mono-xsp4</code> </pre><br>  All, now almost all the delights of .NET are available to us. <br>  Details can be found here: <a href="http://mono-project.com/DistroPackages/Debian">Mono for Debian</a> . <br><br><h2><a name="jenkins"></a>  Jenkins </h2><br>  And crowning it all - CI server.  Let's take a look at how to put it and configure it for example for ... PHP: <br>  We put Jenkins <br><pre> <code class="bash hljs">sudo apt-get update sudo apt-get install php5-cli php5-xdebug php-pear ant git php -r <span class="hljs-string"><span class="hljs-string">'echo "Xdebug loaded? "; echo (extension_loaded("xdebug")) ? "yes" : "no"; echo chr(10);'</span></span> wget -q -O - http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key | sudo apt-key add - sudo bash -c <span class="hljs-string"><span class="hljs-string">"echo 'deb http://pkg.jenkins-ci.org/debian binary/' &gt; /etc/apt/sources.list.d/jenkins.list"</span></span> sudo apt-get update sudo apt-get install jenkins</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Add Plugins</b> <div class="spoiler_text"><pre> <code class="bash hljs">wget http://localhost:8080/jnlpJars/jenkins-cli.jar java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin checkstyle java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin cloverphp java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin dry java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin htmlpublisher java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin jdepend java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin plot java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin pmd java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin violations java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin xunit java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin git java -jar jenkins-cli.jar -s http://localhost:8080 safe-restart</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Install PHPUnit and additional tools.</b> <div class="spoiler_text"><pre> <code class="bash hljs">sudo pear upgrade PEAR sudo pear channel-discover pear.pdepend.org sudo pear channel-discover pear.phpmd.org sudo pear channel-discover pear.phpunit.de sudo pear channel-discover components.ez.no sudo pear channel-discover pear.symfony-project.com sudo pear install pdepend/PHP_Depend sudo pear install phpmd/PHP_PMD sudo pear install phpunit/phpcpd sudo pear install phpunit/phploc sudo pear install PHPDocumentor sudo pear install PHP_CodeSniffer sudo pear install --alldeps phpunit/PHP_CodeBrowser sudo pear install --alldeps phpunit/PHPUnit</code> </pre><br></div></div><br>  Configuring: <br>  - download /build.xml from <a href="http://jenkins-php.org/">http://jenkins-php.org/</a> and edit for your project <br>  - download the PMD rules <a href="http://phpmd.org/documentation/creating-a-ruleset.html">http://phpmd.org/</a> and put as / build / phpmd.xml in the project <br>  - optionally, you can add its rules <a href="http://pear.php.net/manual/en/package.php.php-codesniffer.annotated-ruleset.php">http://pear.php.net/</a> and put it as /build/phpcs.xml in the project <br>  - configure PHPUnit in / tests/phpunit.xml <br>  - download task template <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /var/lib/jenkins/<span class="hljs-built_in"><span class="hljs-built_in">jobs</span></span>/ sudo git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/sebastianbergmann/php-jenkins-template.git php-template sudo chown -R jenkins:nogroup php-template/ sudo /etc/init.d/jenkins stop sudo /etc/init.d/jenkins start</code> </pre>  - create a new task from the template, link it to the repository (you may have to add a plugin under your version control system) and rejoice. <br><br><h1><a name="4"></a>  Backup </h1><hr>  It is clear that you can not avoid equipment breakdowns, but completely different sensations arise at this thought when you have a backup copy of the data (and even fresh). <br><br>  The process itself is divided into 2 types: <br>  - full (I do selectively, when I feel that a lot of changes have passed in the system and need to be preserved) <br>  - partial (all nodes of the system that are subject to daily changes: bases, sources, etc.) <br><br>  I make a complete dump using the remastersys script. <br><div class="spoiler">  <b class="spoiler_title">View script</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #     start=`date +%s` echo '[FULL BACK UP Start]' DATE_NOW=`date +%F` echo '[FULL BACK UP Dump Creation]' #   sudo remastersys backup install-$DATE_NOW.iso echo '[FULL BACK UP Dump Saving]' #      sudo cp /home/remastersys/remastersys/install-$DATE_NOW.iso /home/backups/system-iso/install-$DATE_NOW.iso sudo cp /home/remastersys/remastersys/install-$DATE_NOW.iso.md5 /home/backups/system-iso/install-$DATE_NOW.iso.md5 echo '[FULL BACK UP Clean up]' #  tmp sudo remastersys clean echo '[FULL BACK UP End]' end=`date +%s` runtime=$((end-start)) echo 'Backup time =' $runtime 'sec(s)'</span></span></code> </pre><br></div></div><br>  Partial is done with scrutine in cron nightly. <br><div class="spoiler">  <b class="spoiler_title">View script</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash start=`date +%s` echo '[BACK UP Start]' DATE_PREF=`date +%F` echo '[BACK UP Config]' #     BACKUP_MYSQL_DIR=/home/backups/mysql/$DATE_PREF BACKUP_WWW_DIR=/home/backups/www/$DATE_PREF BACKUP_GIT_DIR=/home/backups/git/$DATE_PREF echo '[BACK UP Clean up]' #       find /home/backups/mysql/ -mtime +7 -print -mindepth 1 -delete &gt;/dev/null 2&gt;&amp;1 find /home/backups/www/ -mtime +7 -print -mindepth 1 -delete &gt;/dev/null 2&gt;&amp;1 find /home/backups/git/ -mtime +7 -print -mindepth 1 -delete &gt;/dev/null 2&gt;&amp;1 echo '[BACK UP Not Clened Items]' ls /home/backups/mysql/ ls /home/backups/www/ ls /home/backups/git/ echo '[BACK UP Back Up Hosts]' #   tar cpzf $BACKUP_WWW_DIR\-www.tgz /home/www/ &gt;/dev/null 2&gt;&amp;1 echo '[BACK UP Back Up Repositories]' #   tar cpzf $BACKUP_GIT_DIR\-git.tgz /home/git/ &gt;/dev/null 2&gt;&amp;1 echo '[BACK UP Back Up MySQL]' #    mysqldump -q -u root -p&lt;password&gt; -h localhost tt_rss | gzip -c &gt; $BACKUP_MYSQL_DIR\-tt_rss.sql.gz mysqldump -q -u root -p&lt;password&gt; -h localhost test | gzip -c &gt; $BACKUP_MYSQL_DIR\-test.sql.gz mysqldump -q -u root -p&lt;password&gt; -h localhost redmine | gzip -c &gt; $BACKUP_MYSQL_DIR\-redmine.sql.gz mysqldump -q -u root -p&lt;password&gt; -h localhost phpmyadmin | gzip -c &gt; $BACKUP_MYSQL_DIR\-phpmyadmin.sql.gz mysqldump -q -u root -p&lt;password&gt; --skip-lock-tables -h localhost performance_schema | gzip -c &gt; $BACKUP_MYSQL_DIR\-performance_schema.sql.gz mysqldump -q -u root -p&lt;password&gt; --skip-lock-tables -h localhost information_schema | gzip -c &gt; $BACKUP_MYSQL_DIR\-information_schema.sql.gz mysqldump -q -u root -p&lt;password&gt; --events -h localhost mysql | gzip -c &gt; $BACKUP_MYSQL_DIR\-mysql.sql.gz echo '[BACK UP New Items]' ls /home/backups/mysql/ | grep $DATE_PREF ls /home/backups/www/ | grep $DATE_PREF ls /home/backups/git/ | grep $DATE_PREF echo '[BACK UP End]' end=`date +%s` runtime=$((end-start)) echo 'Backup time =' $runtime 'sec(s)' echo '========================================================='</span></span></code> </pre><br>  As you can see - I keep the last 7 copies. <br></div></div><br><br>  Thank!  I hope it was interesting! <br><br>  <b>PS</b> If you have questions, I will be happy to help. <br>  <b>PPS</b> Give an invite, please. </div><p>Source: <a href="https://habr.com/ru/post/205120/">https://habr.com/ru/post/205120/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../205108/index.html">At the borders, applications are not object-oriented.</a></li>
<li><a href="../205110/index.html">The rover Curiosity has used a laser cannon spectrometer over 100,000 times</a></li>
<li><a href="../205114/index.html">Design Scent: Temporary Connectivity</a></li>
<li><a href="../205116/index.html">Quick sales start for internet business</a></li>
<li><a href="../205118/index.html">Writing Maven Plugin</a></li>
<li><a href="../205122/index.html">New GSM routers from OpenVox</a></li>
<li><a href="../205128/index.html">Report on events on Windows servers of the domain</a></li>
<li><a href="../205130/index.html">Working with PERL JSON</a></li>
<li><a href="../205132/index.html">DARPA launches 20-meter membrane telescope into geostationary orbit</a></li>
<li><a href="../205134/index.html">PyFence: Type Verification for Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>