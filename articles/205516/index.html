<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VIP service pattern</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous article we looked at a small pattern to simplify the code of users of services, in this article we will consider a special type of ser...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VIP service pattern</h1><div class="post__text post__text-html js-mediator-article">  In the previous <a href="http://habrahabr.ru/post/201908/">article</a> we looked at a small pattern to simplify the code of users of services, in this article we will consider a special type of service.  This pattern is used in architectures with layers, if the architecture in question has no layers, then the pattern may not have the desired effect or be harmful at all. <br><br><div class="spoiler">  <b class="spoiler_title">Architectural layers</b> <div class="spoiler_text">  Unfortunately on Habr√© there are no articles describing what layers are, but outside there is a habrauseur <a href="http://habrahabr.ru/users/primepix/" class="user_link">primepix</a> <a href="http://primepix.ru/blog/164/">article</a> </div></div><br>  The pattern is not tied to programming languages. <br><br>  <i>Update: Added an example from real practice.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Picture to attract attention: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b2/c05/f8b/9b2c05f8bd5f1fa1f85b96c9ddb4dbc8.png"></div><br><br><a name="habracut"></a><br><br>  Imagine a situation, we have a large project, which has already been formed and has passed the stage of rapid redesign.  The project has layers, everything is implemented technically correctly (yes, it happens) and the architecture allows you to implement a subset of the current functionality.  Development goes according to plans without excesses and crunches. <br><br>  But at some point, an idea or demand arises in one of the bright heads of designers / investors / creative directors or artists (underline the necessary).  This idea does not fit into the current architecture.  This may not necessarily be an idea as a new functionality, it may be, for example, support for the custom functionality / mode of one of the middleware vendors which gives some advantage, for example technical. <br><br>  What do designers / architects do in this situation?  The most correct decision is the rejection of new functionality by all available methods, because the most good code is code that is not written.  This code is easily maintained and contains the minimum number of bugs.  Impact methods can be different, from pressure by authority to the use of various tricks, for example, to <a href="http://www.xakep.ru/post/12860/">allow you to beat yourself in Quake</a> . <br><br>  The second solution, if the situation permits, in the working order is a revision of the architecture and, if necessary, redesign. <br><br>  If there is no time for evaluation and redesign, and the solution is required ‚Äúyesterday‚Äù, then we have to take ‚Äútechnical debt‚Äù.  The hardest case - the functionality must be thrown through several layers. <br><br><div class="spoiler">  <b class="spoiler_title">Forwarding functionality:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/042/ac2/883/042ac28831ec91d3e0b622c5a5de751b.png"></div></div><br><br>  The negative consequences of such decisions are known.  The upper layers become dependent on the details of the lower layers, services appear as intermediaries that are needed only to forward functionality, etc. <br><br>  This pattern serves to solve the problem of littering the architecture with oversights and their negative impact on the architecture as a whole.  The essence of the pattern is to encapsulate all the debts in a single service, or a chain of services.  This service will be a facade to all technical debts of the system. <br><br><div class="spoiler">  <b class="spoiler_title">Forbid Encapsulation:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/fd8/8cc/842/fd88cc842887c5e31fba93979507ca20.png"></div></div><br><br>  It is important to understand that this pattern is not part of the architecture and is needed only to encapsulate temporary solutions, allowing you to gain time for evaluation and redesign without destroying the current architecture. <br><br><div class="spoiler">  <b class="spoiler_title">Real life example</b> <div class="spoiler_text">  IMO game project.  Codebase about 3000 C # files.  The client is written in C #, OGRE (C ++) was used for rendering. <br><br><div class="spoiler">  <b class="spoiler_title">Fragment of client architecture</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/54b/7e9/adc/54b7e9adcd683614bc8c32f69a657d54.png"></div></div><br><br>  The bottommost ‚ÄúRender‚Äù layer is the implementation of the render, along with implementations of various effects (animation scenes, particles) and scene objects with animation support (skeletal, morph).  Everything related to the display in one form or another was implemented in this layer. <br><br>  The ‚ÄúRender facade‚Äù layer was the interface (facade) to the renderer and contained all the wrappers of the native code for use in C #. <br><br>  The ‚ÄúScene graph‚Äù layer was a place to simulate objects and their interaction. <br><br>  The ‚ÄúLogic‚Äù layer simulated objects and displayed logic on simulation objects. <br><br>  In this fragment, other systems that were in these layers are omitted, for example, there is no UI (which was also C # wrappers for C ++). <br><br>  The objects in the scene layer of the graph were the simplest objects that contained the position and orientation.  Supported hierarchy as well as managing abstract animation through identifiers (roughly speaking, start and stop by id). <br><br>  After the next burst of creativity, designers needed to change the colors of materials depending on the logic in runtime.  The motivation was the following - ‚ÄúThere is no time to explain, make us a change in the color of materials!‚Äù, However, in the game dev, this is a common practice (emoticon). <br><br>  To add such functionality, it was necessary to disfigure object interfaces by adding such a specific thing as material and to forward through all layers.  Moreover, not all objects in principle had material, for example, light sources and cameras or composite animation objects, for example, asteroid belts, etc. <br><br><div class="spoiler">  <b class="spoiler_title">Forward functionality (shown in red)</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/28f/287/51b/28f28751b574aea8a01e976e33ab88a0.png"></div></div><br><br>  There was not enough time for thinking and especially for experiments, so it was decided to temporarily arrange this functionality as an independent service.  In this case, even the object interface was not affected, a certain implementation of the extension methods only in a global context. <br><br><div class="spoiler">  <b class="spoiler_title">VIP service implementation</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/470/8f5/a89/4708f5a895abc7aed1ba3699b7f2efbd.png"></div></div><br><br>  At the same time, at every stage and in every chain of service, all kinds of paranoid checks were done so that the service data did not break the operation of the system or become a source of failures. <br><br>  Over time, various methods for very tricky widgets and other problem solutions appeared and disappeared in this service. <br><br>  And the functionality of the materials was removed from the service after the implementation of a full-fledged animation graph with support for all aspects of visualization.  And the designer pointed out the change of materials as part of the animation. <br><br></div></div><br><br>  Pros: <br><ul><li>  Functionality is available immediately. </li><li>  Gaining time to work out the right decision </li><li>  Technical debts do not spill over the system </li><li>  Quick access to all system debts (for assessing architectural problems) </li><li>  Solutions to a whole class of problems are possible, as solutions to specific problems are postponed. </li><li>  Direct gain if functionality is no longer needed. </li></ul><br><br>  Minuses: <br><ul><li>  The pattern does not apply everywhere </li></ul><br><br>  Thank you all for your understanding! </div><p>Source: <a href="https://habr.com/ru/post/205516/">https://habr.com/ru/post/205516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../205494/index.html">As an ordinary field, it has become an ultra-modern Google data center priced at one and a half billion dollars.</a></li>
<li><a href="../205496/index.html">Best recruiting videos of 2013</a></li>
<li><a href="../205508/index.html">Forwarding an iSCSI disk from NAS via the Internet on MAC OS X</a></li>
<li><a href="../205510/index.html">Codecademy released the first mobile application for learning programming</a></li>
<li><a href="../205512/index.html">Metasploit Penetration Testing Cookbook - Part 7</a></li>
<li><a href="../205520/index.html">Manned landing of a spacecraft</a></li>
<li><a href="../205522/index.html">EU warns Nokia against becoming a patent troll</a></li>
<li><a href="../205524/index.html">Bitcoin: basic principles of mining</a></li>
<li><a href="../205530/index.html">Bitcoin: development history, from CPU to FPGA</a></li>
<li><a href="../205532/index.html">pChart - we build graphs and diagrams in PHP. Practice</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>