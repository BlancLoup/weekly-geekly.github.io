<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Restore Active Directory Objects: Script Collection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Undoubtedly, many of you have repeatedly encountered this problem - removed user accounts. There are many articles on restoring accounts, and probably...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Restore Active Directory Objects: Script Collection</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage2/42a/b7e/2ef/42ab7e2ef3582dd728c0c72fedd9a08f.jpg"><br>  Undoubtedly, many of you have repeatedly encountered this problem - removed user accounts.  There are many articles on restoring accounts, and probably the best written by <a href="http://support.microsoft.com/kb/840001">Microsoft</a> , but all of them lack clarity.  We will try to overcome this drawback by reducing the procedure for recovering user accounts to simple steps. <br>  As you know, you can restore objects in different ways, each of which is best suited in a given situation. <br>  In this case, it is preferable to restore from tombstone objects.  There are several reasons for this: <br><br><ul><li>  no need to take the domain controller offline (all work, nothing is disabled) </li><li>  tombstone recovery is much better than simply recreating a new version of a remote object </li></ul><br><br>  Part of the attributes is deleted along with the deletion of the object - they can no longer be restored.  For example, membership in security groups. <br>  If you re-create an object, it will always have the new objectGUID and objectSid attributes (if it is a member of a security policy, such as a user).  As a result, any external object references, such as an ACL, will need to be updated to reflect the new object identifier.  This can be a very big problem. <br>  Therefore, in this post, we will first consider methods using tombstone objects, and only at the end provides information on forced recovery.  At the end of the post, the capabilities of the NetWrix Active Directory Object Restore Wizard will be reviewed.  The information for the post is taken from the document <a href="http://www.netwrix.com/ru/tracking/track.html%3Fcampaign%3DNWX_EMPACK_HABR_2012_08%26spot%3Dtext_up%26url%3Dru/ad_object_restore_pack.html">"Restore Active Directory Objects: a collection of scripts"</a> prepared by NetWrix.  We invite interested persons under cat. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What needs to be restored: an example </h4><br><br>  <b>Given:</b> <br>  OU Finance_Department with its Oleg and Dmitry accounts and its sub-account OU Admins, which contains the Sergey account, has been removed from the acme.com domain. <br>  <b>Task:</b> <br>  Restore the OU to all members (including the embedded OU) and attributes of the accounts. <br><br>  And this task will be solved in all possible ways. <br><br><h4>  1. Restore objects using ldp.exe </h4><br>  <i>Procedure:</i> <br>  1) Enable console display of deleted objects (CN = Deleted Objects) <br>  First, you need to make the deleted objects appear (and by default the container CN = Deleted Objects is not displayed. Use <b>ldp.exe</b> in Active Directory (requires Domain Admins membership). <br>  1. Run ldp.exe.  ( <i>Start - Run - ldp.exe</i> ) <br>  2. In the <b>Options</b> menu, select <b>Controls (Controls)</b> <br><br><img src="https://habrastorage.org/storage2/437/a4f/5fb/437a4f5fbb34a0beaee32dd717b312e7.png"><br><br>  3. In the dialog box that appears, select the menu <b>Load Predefined (Predefined reboot)</b> , select the item <b>Return deleted objects</b> in it and click <b>Ok</b> <br>  4. Check how the container of deleted objects is displayed: <br>  a.  To connect and bind to the server where the root domain of the Active Directory environment forest is located, in the <b>Connections</b> section, select <b>Connect</b> and click <b>Bind</b> . <br>  b.  Click the <b>Browse</b> button, select <b>Structure</b> and in the <b>Distinguished Name (DN)</b> field enter DC =, DC =. <br>  c.  In the console tree, double-click the distinguished name (DN) of the root domain and find the container CN = Deleted Objects, DC = acme, DC = com. <br><br>  <b>Restoring objects:</b> <br>  Consider the restoration of the example of the account Oleg, part of the OU Finance_Department. <br><br>  1) Run ldp.exe <br>  2) In the <b>Connections</b> section, select the <b>Connect option - Bind</b> Connect and bind to the server that hosts the root domain of the Active Directory environment forest <br><br><img src="https://habrastorage.org/storage2/aeb/268/2ad/aeb2682adda492ed18e47224f9d14d8b.png"><br><br>  3) In the console tree, go to the container <b>CN = Deleted Objects</b> (we also write DC = acme, DC = com for the example domain) <br><br><img src="https://habrastorage.org/storage2/29b/419/b98/29b419b98ad2efb7d4e3dc1b4691ae86.gif"><br><br>  searching results <br><br><img src="https://habrastorage.org/storage2/a7a/4b4/593/a7a4b4593b0f54e0a45e05b532c0c98d.gif"><br><br>  4) Find an object in the container <b>CN = Deleted Objects</b> that we want to restore, right-click on it and select the <b>Modify</b> item. <br>  5) In the <b>Modify</b> window, change the following parameters <br>  a.  In the <b>Edit Entry</b> field of the attribute, enter <b>isDeleted</b> <br>  b.  Leave the <b>Values</b> field empty. <br>  c.  In the <b>Operation</b> section, select <b>Delete</b> and press the <b>Enter</b> key. <br><br><img src="https://habrastorage.org/storage2/d09/f51/7cd/d09f517cdfc3795033a891e17bb951db.gif"><br><br>  d.  In the <b>Edit Entry Attribute</b> field, enter <b>distinguishedName</b> <br>  e.  In the <b>Values</b> field, enter the initial distinguished name (DN) of this Active Directory object. <br>  f.  In the section <b>Operation (Operation) we</b> select <b>Replace (to Replace)</b> <br>  g.  Select the <b>Extended</b> checkbox, press the <b>Enter</b> key, and then <b>Run.</b> <br><br><img src="https://habrastorage.org/storage2/fd6/369/ce7/fd6369ce7491158d7fbc88093528e438.gif"><br><br>  Account restored, but deactivated.  It will need to be enabled manually.  You also need to manually restore group membership and reset the password. <br>  We repeat the same actions for the remaining objects: <br>  OU Finance_Department <br>  Ou admins <br>  Account Dmitry <br>  Account Sergey <br><br>  <b>Total:</b> <b><br><br></b>  <b><i>You need to do a lot of actions before the object is restored.</i></b> <b><i><br></i></b>  <b><i>All actions will have to be repeated for each of the deleted objects.</i></b> <br><br><h4>  2. We use ADRESTORE </h4><br><br>  Restoring burial sites with LDP is simple.  However, uncomfortable and long.  For these purposes, there is <b><a href="">ADRESTORE</a></b> , which is designed specifically for restoring AD objects. <br><br>  The utility works in two modes: <br>  ‚Ä¢ <b>Run without parameters</b> .  It will list all the tombstone objects in the CN = Deleted Objects container of the default domain.  You can add a string to search in the command line to select objects to display: <br><br><pre><code class="vbscript hljs">C:\&gt; adrestore Finance_Department</code> </pre> <br><br>  All objects in the CN = Deleted Objects container that contain the string ‚ÄúFinance_Department‚Äù in the CN or OU attribute are displayed ‚Äî the LDAP search filter cn = * Finance_Department * and ou = * Finance_Department * is used.  The figure below shows the results of the search returned by the ADRESTORE program. <br><br><img src="https://habrastorage.org/storage2/810/287/b38/810287b3850589f82a68742d7b424f2b.gif"><br><br>  ‚Ä¢ <b>Restore objects</b> <br>  If you need to restore a tombstone, and not just find it, you must specify the ‚Äìr parameter along with an additional line, for example, like this: <br><br><pre> <code class="vbscript hljs">C:\&gt; adrestore ‚Äìr Finance_Department</code> </pre><br><br>  To restore accounts, use the following commands: <br><br><pre> <code class="vbscript hljs">C:\&gt; adrestore ‚Äìr Oleg C:\&gt; adrestore ‚Äìr Dmitry C:\&gt; adrestore ‚Äìr Admins C:\&gt; adrestore ‚Äìr Sergey</code> </pre><br><br>  The team will offer to restore each burial object that satisfies the condition.  The object is restored to the container specified by the <b>lastKnownParent</b> attribute of the <b>tombstone</b> object (and no other). <br>  This command will offer to restore every suitable burial object.  ADRESTORE always restores the object to the container indicated by the lastKnownParent attribute of the tombstone object; there is no way to specify another container. <br><br>  <b><i>Total:</i></b> <b><i><br><br></i></b>  <b><i>ADRESTORE is easier to use than LDP.</i></b> <b><i><br></i></b>  <b><i>The utility allows you to quickly restore objects, but again without the necessary attributes - group membership and passwords will have to be restored manually.</i></b>  <b><i>One of the most popular ways to restore objects.</i></b> <br><br><h4>  3. Using AD Recycle Bin (Windows Server 2008 R2) </h4><br><br>  In Windows Server 2008 R2, an <b>Active Directory Recycle Bin (AD RB)</b> basket has appeared. To activate it, you need the forest level to be Windows Server 2008 R2.  AD RB resembles an ordinary Windows recycle bin - an accidentally deleted object can be quickly and with all attributes restored.  Moreover, the object restored from AD RB immediately receives all its attributes.  By default, the life time of a remote object in AD RB is 180 days, after that it goes into the Recycle Bin Lifetime state, loses attributes and after some time is completely removed. <br>  In the simplest case, the object is restored using the Powershell cmdlets <b>Get-ADObject</b> and <b>Restore-ADObject</b> (if you know exactly what you need to restore).  The <b>Get-ADObject</b> cmdlet is used to retrieve a remote object, which is then passed through a pipeline to the <b>Restore-ADObject</b> cmdlet: <br><br>  1. Run as administrator <b>Active Directory Module for Windows PowerShell</b> . <br>  2. At the Active Directory module for Windows PowerShell command prompt, type the following command: <br><br><pre> <code class="vbscript hljs">PS C:\&gt; <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADObject -<span class="hljs-built_in"><span class="hljs-built_in">Filter</span></span> {displayName -eq <span class="hljs-string"><span class="hljs-string">"user"</span></span>} -IncludeDeletedObjects | Restore-ADObject</code> </pre><br><br>  In this example <br>  <b>-Filter {displayName -eq "user"}</b> indicates what information about the AD object needs to be obtained (in the example, about the object with the display name of the user ‚Äúuser), <br>  <b>-IncludeDeletedObjects</b> means that the search is carried out on remote objects <br>  <b>Restore-ADObject</b> directly restores the AD object. <br><br>  <b>Search for deleted objects</b> <br>  1. Run as administrator <b>Active Directory Module for Windows PowerShell.</b> <br>  2. In the Active Directory module for Windows PowerShell command line, enter the following commands to get the necessary information: <br><br>  <i>Displaying information about deleted objects in the acme.com domain</i> <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADObject -SearchBase <span class="hljs-string"><span class="hljs-string">"CN=Deleted Objects,DC=acme,DC=com"</span></span> ‚ÄìIncludeDeletedObjects</code> </pre><br><br>  <i>Get information about which OU the remote user was in</i> <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADObject -SearchBase <span class="hljs-string"><span class="hljs-string">"CN=Deleted Objects,DC=acme,DC=com"</span></span> -ldapFilter:<span class="hljs-string"><span class="hljs-string">"(msDs-lastKnownRDN=User)"</span></span> ‚ÄìIncludeDeletedObjects ‚ÄìProperties lastKnownParent</code> </pre><br>  Where <b>User</b> is the display name of the user. <br><br>  As a result, we obtain information about the belonging to the OU of the specified user (using <b>-Properties lastKnownParent</b> ) <br><br>  <i>Search for all deleted objects that belonged to this OU</i> <br><br>  As an example, take the distinguished name OU Finance_Department, which was obtained after the launch of the previous cmdlet (Finance_Department \\ 0ADEL: e954edda-db8c-41be-bbbd-599bef5a5f2a). <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADObject ‚ÄìSearchBase <span class="hljs-string"><span class="hljs-string">"CN=Deleted Objects,DC=acme,DC=com"</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">Filter</span></span> {lastKnownParent -eq <span class="hljs-comment"><span class="hljs-comment">'OU=Finance_Department\\0ADEL:e954edda-db8c-41be-bbbd-599bef5a5f2a,CN=Deleted Objects,DC=acme,DC=com'} -IncludeDeletedObjects -Properties lastKnownParent | ft</span></span></code> </pre><br><br>  <u>Attention!</u>  <u>If you have a nested OU, recovery is performed starting from the highest level of the hierarchy.</u>  <u>In this case, it is OU = Finance_Department.</u> <br><br>  <b>Object Recovery</b> <br><br>  1. Launch the <b>Active Directory Module for Windows PowerShell</b> <br>  2. Restore the Finance_Department subdivision by executing the following command on the command line: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADObject -ldapFilter:<span class="hljs-string"><span class="hljs-string">"(msDS-LastKnownRDN=Finance_Department)"</span></span> ‚ÄìIncludeDeletedObjects | Restore-ADObject</code> </pre><br><br>  3. We restore the accounts and OUs that are direct subsidiaries of the OU Finance_Department (remember that at this stage the distinguished name Finance_Department has already been restored to OU = Finance_Department, DC = acme, DC = com) <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADObject -SearchBase <span class="hljs-string"><span class="hljs-string">"CN=Deleted Objects,DC=acme,DC=com"</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">Filter</span></span> {lastKnownParent -eq <span class="hljs-string"><span class="hljs-string">"OU=Finance_Department,DC=acme,DC=com"</span></span>} -IncludeDeletedObjects | Restore-ADObject</code> </pre><br><br>  <b>Optional (restore nested OUs)</b> <br><br>  4. We restore the accounts included in the nested OU (for example, OU Admins, which is part of the OU Finance Department. The distinguished name in our example was restored to OU = Admins, OU = Finance_Department, DC = acme, DC = com) <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADObject -SearchBase <span class="hljs-string"><span class="hljs-string">"CN=Deleted Objects,DC=acme,DC=com"</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">Filter</span></span> {lastKnownParent -eq <span class="hljs-string"><span class="hljs-string">"OU=Admins,OU=Finance_Department,DC=acme,DC=com"</span></span>} -IncludeDeletedObjects | Restore-ADObject</code> </pre><br><br>  Detailed help on cmdlets and their parameters by calling the <b>Get-Help</b> cmdlet, for example, <b>Get-Help Get-ADObject</b> <br><br>  <b><i>Total:</i></b> <b><i><br></i></b>  <b><i>Objects will be restored to their original form - with all attributes.</i></b> <b><i><br></i></b>  <b><i>However, as we can see, this method is rather complicated when you have to work with a large number of objects.</i></b> <b><i><br></i></b>  <b><i>Also required, all servers in the forest must be Windows 2008 R2.</i></b> <b><i><br></i></b>  <b><i>To restore objects with attributes when the AD basket is enabled, you can use the LDP and AdRestore tools described above.</i></b> <br><br><h4>  4. Force recovery using NTDSUTIL </h4><br><br>  The standard way (but, however, not the most appropriate) is to force a restore from a backup in <b>Directory Service Restore Mode</b> .  It has serious drawbacks: you need to restart the server, and secondly, restore the state of the system from the backup and mark which objects will not be overwritten by the replication process. <br>  Restoration is performed using the <b>NTDSUTIL</b> command line <b>utility</b> .  The utility becomes available after installing the AD DS role.  Using it, you can restore both the OU with all its contents and a separate object. <br>  The utility is based on snapshots of Active Directory, which are made using VSS. <br><br>  <u>Attention!</u>  <u>During the forced recovery of AD, the internal version number of the objects being restored is increased.</u>  <u>After connecting the domain controller to the network, these objects will be replicated throughout the domain, and the restored version becomes globally active.</u> <br><br>  <b>Procedure:</b> <br>  1. We need to restore OU Finance_Department from the domain acme.com <br>  2. Boot into <b>DSRM</b> mode (in the boot menu, press F8) and register with the password, DSRM, set during <b>Dcpromo</b> .  AD does not load, the database is taken offline. <br><br>  <u>Attention!</u>  <u>Recovery cannot be performed if NTDS AD is stopped on Server 2008 and above domain controllers.</u> <br><br>  3. Restore the system state from the backup created before the accident. <br><br>  <u>Attention!</u>  <u>Do not restart the computer.</u> <br><br>  In the snapshot obtained using ntdsutil, there is both the object itself and its attributes.  The image can be mounted and mounted as a virtual LDAP server exporting objects.  Run <b>ntdsutil</b> : <br><br><pre> <code class="vbscript hljs">&gt; ntdsutil ntdsutil: snapshot</code> </pre><br><br>  View the list of available images: <br><pre> <code class="vbscript hljs">: list all</code> </pre><br><br>  <b>1: 2009/04/22: 23: 18 {8378f4fe-94c2-4479-b0e6-ab46b2d88225}</b> <b><br><br></b>  <b>2: C: {732fdf7f-9133-4e62-a7e2-2362227a8c8e}</b> <b><br><br></b>  <b>3: 2009/04/23: 00: 19 {6f7aca49-8959-4bdf-a668-6172d28ddde6}</b> <b><br><br></b>  <b>4: C: {cd17412a-387b-47d1-9d67-1972f49d6706}</b> <br><br>  Mount with <b>mount</b> command with number or {ID}: <br><br><pre> <code class="vbscript hljs">: mount <span class="hljs-number"><span class="hljs-number">4</span></span>  {cd17412a<span class="hljs-number"><span class="hljs-number">-387</span></span>b<span class="hljs-number"><span class="hljs-number">-47</span></span>d1<span class="hljs-number"><span class="hljs-number">-9</span></span>d67<span class="hljs-number"><span class="hljs-number">-1972</span></span>f49d6706}   C:\$SNAP_200904230019_VOLUMEC$\</code> </pre><br><br>  The picture is mounted. <br><br>  4. Run the command <br><br>  To restore Finance_Department <br><br><pre> <code class="vbscript hljs">&gt; ntdsutil <span class="hljs-string"><span class="hljs-string">"authoritative restore"</span></span> <span class="hljs-string"><span class="hljs-string">"restore subtree ou=Finance_Department,dc=acme,dc=com"</span></span> qq</code> </pre><br><br>  As a result, OU Finance_Department with its member accounts and OU Admins will be restored. <br>  To restore a separate account, for example, with the display name Oleg <br><br><pre> <code class="vbscript hljs">&gt; ntdsutil <span class="hljs-string"><span class="hljs-string">"authoritative restore"</span></span> <span class="hljs-string"><span class="hljs-string">"restore object cn=Oleg,ou=Finance_Department,dc=acme,dc=com"</span></span> qq</code> </pre><br><br>  5. You must confirm the safety warnings.  Then a message similar to that shown in Figure 3 will be displayed. Note the generated text and LDIF files. <br><br><img src="https://habrastorage.org/storage2/05f/994/83e/05f99483eef811a0e440be4bac94bbcc.jpg"><br><br>  Reboot the DC in the normal operating system startup mode. <br>  7. Log on to DC and open a command prompt.  Import the LDIF file exported in step 5 by executing <br><br><pre> <code class="vbscript hljs">ldifde -i -f ar_20110221<span class="hljs-number"><span class="hljs-number">-151131</span></span>_links_contoso.com.ldf</code> </pre><br><br>  where ar_20110221-151131_links_contoso.com.ldf is the name of the generated LDIF file. <br>  8. As a result, the values ‚Äã‚Äãof the associated attributes (such as group membership) for the restored objects will be imported. <br><br>  <u>Attention!</u>  <u>If the forest contains multiple domains, you must use the text file exported in step 6 to restore local group memberships of other domains.</u> <br><br>  <b><i>Total:</i></b> <b><i><br></i></b>  <b><i>Accounts and objects were restored, but the Active Directory database was unavailable for a certain period of time.</i></b>  <b><i>You also depend on the availability of up-to-date AD databases, relying on this recovery method.</i></b> <br><br><h4>  5. NetWrix Active Directory Object Restore Wizard </h4><br><br>  The process of restoring objects can be greatly simplified if you use the <b>NetWrix Active Directory Object Restore Wizard</b> . <br>  Just want to note that our company is constantly being contacted by administrators who have deleted AD objects and now want to restore them.  The solution we propose ‚Äî the NetWrix Active Directory Object Restore Wizard ‚Äî although it can simplify the process of restoring objects (for example, restore OU with all objects and their attributes in a couple of clicks), it still does not work wonders - the program should be installed in the domain and periodically snapshots AD.  Therefore, we recommend after reading the article still put the program to work (there is a free version with a recovery period for the last 4 days), so that next time you do not have such problems with the restoration of objects. <br>  The utility allows you to recover deleted objects in a couple of clicks, and if the program worked before deleting objects in the domain, then all the attributes are restored.  As a result, you get returned accounts in a couple of minutes without major disruptions in the organization.  Also note that the program allows you to recover deleted mailboxes. <br><br>  <b>Work with the program is reduced to the following steps:</b> <br>  1. The NetWrix Active Directory Object Restore Wizard starts. <br><br><img src="https://habrastorage.org/storage2/0b3/dd7/2ca/0b3dd72cae185e83bb23167bd8b18017.png"><br><br>  2. Select the recovery mode: <br>  ‚Ä¢ Only from tombstone objects (if the program has not been installed before in the domain) <br>  ‚Ä¢ Recovery using snapshots (if the program was installed and at least one snapshot was made) <br><br><img src="https://habrastorage.org/storage2/820/bce/025/820bce025be7d94f925ca1a884dc3be7.png"><br><br>  3. Based on the analysis results, a list of deleted objects with their original hierarchy and objects is displayed. <br><br><img src="https://habrastorage.org/storage2/e86/205/8fe/e862058feff79e7274dad1f159b518ae.png"><br><br>  4. Select those OU or objects that you want to restore, and click on <br>  5. Depending on whether the program was installed earlier or not: <br>  ‚Ä¢ If not, then you must manually restore group memberships and user passwords. <br>  ‚Ä¢ If the program was installed, then the recovery is complete and everything will work as if nothing had happened. <br><br><img src="https://habrastorage.org/storage2/1aa/e71/473/1aae7147379ed63cb548faca3599d6a7.png"><br><br>  As you can see, the restoration of objects takes much less time than using standard tools for repairing Active Directory objects. <br>  But the restoration of objects is only one of the sides of the program.  You can also roll back changes to objects - up to the value of a single attribute - the program is designed for this too. <br><br>  <b><i>Total:</i></b> <b><i><br></i></b>  <b><i>Restoring objects with attributes is reduced to a couple of simple steps.</i></b>  <b><i>It is possible not only to restore objects, but also to roll back only some of their values.</i></b> <br><br>  <i>All these recovery methods are listed in the ‚ÄúFirst Aid Kit for AD Object Recovery‚Äù, which you can <a href="http://www.netwrix.com/ru/tracking/track.html%3Fcampaign%3DNWX_EMPACK_HABR_2012_08%26spot%3Dtext_down%26url%3Dru/ad_object_restore_pack.html">download on our website.</a></i> </div><p>Source: <a href="https://habr.com/ru/post/150460/">https://habr.com/ru/post/150460/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150452/index.html">How much has your startup earned all the time?</a></li>
<li><a href="../150454/index.html">Cach√© + Java + Flex. Features of technology integration. Part 3</a></li>
<li><a href="../150455/index.html">SCOUT: now and the sea</a></li>
<li><a href="../150458/index.html">Coworking "Workstation" in Gorky Central Park of Culture and Rest</a></li>
<li><a href="../150459/index.html">Samsung does not want to abandon the Start button in Windows 8</a></li>
<li><a href="../150464/index.html">Sony mini-presentation at IFA 2012</a></li>
<li><a href="../150465/index.html">The problem of piracy from the point of view of utilitarianism or when it is profitable to use an unlicensed product</a></li>
<li><a href="../150467/index.html">IOS weather station</a></li>
<li><a href="../150469/index.html">Samsung UNPACKED: Report from the presentation, Galaxy Note II, Galaxy Camera, smart on Win7 and not only</a></li>
<li><a href="../150471/index.html">Your startup is not a startup, just a website.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>