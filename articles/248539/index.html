<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calculating the time of sunset and sunrise on the coordinates of the Android device using earthtools</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habr! 



 Once, the task was to develop an engine for calculating the start time of dusk and dawn, based on the location of the phone. 

 In addit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calculating the time of sunset and sunrise on the coordinates of the Android device using earthtools</h1><div class="post__text post__text-html js-mediator-article">  Hi Habr! <br><br><img src="https://habrastorage.org/files/1ee/caa/9d6/1eecaa9d6b6b498281490d5799a09a64.jpg" alt="image"><br><br>  Once, the task was to develop an engine for calculating the start time of dusk and dawn, based on the location of the phone. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In addition, in order to facilitate the work, I was loaded with anomalous mathematical formulas, from which nothing fit in my head.  So, I decided to look for an alternative to these hellish formulas. <br><a name="habracut"></a><br>  Having rummaged in Google, I found an interesting site: <a href="http://www.earthtools.org/">http://www.earthtools.org/</a> .  It provides several web services related to working with maps.  One of them was the service, which you give to the input latitude, longitude and date, and as a response you get the xml of the following content: <br><br><img src="https://habrastorage.org/files/47b/f33/12d/47bf3312d42b44868ff884b50a213c46.png"><br><br>  Based on this, the task is much simpler: <br><br>  1. Get device coordinates; <br>  2. To form a GET request; <br>  3. Submit a request; <br>  4. Get the response (our XML); <br>  5. Parse XML to get the necessary data; <br>  6. Display the result. <br><br>  I will immediately warn you that there will be no hardcore code here, just a simple engine. <br><br>  Getting started, to start the resolution in AndroidManifest.xml <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_COARSE_LOCATION"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_FINE_LOCATION"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_FINE_LOCATION"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><br>  Next we get the coordinates of the device.  I note right away that the exact coordinates in practice are absolutely not needed for tasks of this kind, so you can even use the coordinates that the cellular network gives us.  Since there is no super UI, but an extremely small engine, so the Activity has only the Update button, and below it is a TextView to display the results.  I also removed the names of the package and import. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionBarActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnClickListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextView helloWorld; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button update; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> LocationListener locationListener; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); initUI(); initLocationListener(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">requestLocationUpdate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ LocationManager locationManager = (LocationManager) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getSystemService(Context.LOCATION_SERVICE); List&lt;String&gt; allProviders = locationManager.getAllProviders(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String provider : allProviders) { helloWorld.append(provider + <span class="hljs-string"><span class="hljs-string">"\n"</span></span>); } String bestProvider = locationManager.getBestProvider(createGPSCriteria(), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); helloWorld.append(<span class="hljs-string"><span class="hljs-string">"Best: "</span></span> + bestProvider + <span class="hljs-string"><span class="hljs-string">"\n"</span></span>); locationManager.requestSingleUpdate(bestProvider, locationListener, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initLocationListener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ locationListener = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LocationListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onLocationChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Location location)</span></span></span><span class="hljs-function"> </span></span>{ Calendar calendar = Calendar.getInstance(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> day = calendar.get(Calendar.DATE); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> month = calendar.get(Calendar.MONTH) + <span class="hljs-number"><span class="hljs-number">1</span></span>; SunAsyncTask sunAsyncTask = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SunAsyncTask(location.getLatitude(), location.getLongitude(), day, month); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { HttpResponse response = sunAsyncTask.execute().get(); String stringEntity = EntityUtils.toString(response.getEntity()); SunXmlParser sunXmlParser = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SunXmlParser(stringEntity); helloWorld.append(<span class="hljs-string"><span class="hljs-string">"Sunset: "</span></span> + sunXmlParser.parse(SunXmlParser.SUNSET) + <span class="hljs-string"><span class="hljs-string">"\n"</span></span>); helloWorld.append(<span class="hljs-string"><span class="hljs-string">"Sunrise: "</span></span> + sunXmlParser.parse(SunXmlParser.SUNRISE) + <span class="hljs-string"><span class="hljs-string">"\n"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { e.printStackTrace(); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStatusChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String provider, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> status, Bundle extras)</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onProviderEnabled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String provider)</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onProviderDisabled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String provider)</span></span></span><span class="hljs-function"> </span></span>{ } }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initUI</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ helloWorld = (TextView) findViewById(R.id.hello_world); update = (Button) findViewById(R.id.update); update.setOnClickListener(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Criteria </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createGPSCriteria</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Criteria criteria = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Criteria(); criteria.setAccuracy(Criteria.ACCURACY_FINE); criteria.setPowerRequirement(Criteria.POWER_LOW); criteria.setCostAllowed(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> criteria; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View clickedView)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id = clickedView.getId(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (id == R.id.update) { requestLocationUpdate(); } } }</code> </pre><br>  Here, we first initialize the UI, then initialize the LocationListener, which will have to respond to the change of coordinates, namely when the position changes, it will launch AsyncTask, which will generate the request, send it and receive a response. <br><br>  After initialization, we need to choose a provider from which we will take the latitude and longitude of our location. <br><br>  There is nothing complicated here; there is a ready-made method getBestProvider, which does this according to the criteria that we pass to it in the first argument.  Criteria is the class in which we put the parameters of the provider we want to receive.  In this example, I set the criterion for selecting a free provider that would work even with a bad signal and with ‚Äúnormal‚Äù positioning accuracy. <br><br>  Well and, accordingly, by pressing the Update key from the provider, we request an update of the location to which LocationListener responds, calling AsynkTask about which I will tell you now. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SunAsyncTask</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AsyncTask</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpResponse</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> latitude; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> longitude; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> day; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> month; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SunAsyncTask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> latitude, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> longitude, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> day, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> month)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.latitude = latitude; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.longitude = longitude; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.day = day; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.month = month; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createUrl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// http://www.earthtools.org/sun/&lt;latitude&gt;/&lt;longitude&gt;/&lt;day&gt;/&lt;month&gt;/&lt;timezone&gt;/&lt;dst&gt; StringBuilder stringBuilder = new StringBuilder("http://www.earthtools.org/sun/"); stringBuilder.append(String.valueOf(latitude)).append("/"); stringBuilder.append(String.valueOf(longitude)).append("/"); stringBuilder.append(String.valueOf(day)).append("/"); stringBuilder.append(String.valueOf(month)).append("/"); stringBuilder.append("99").append("/"); stringBuilder.append("0"); Log.d("URL", stringBuilder.toString()); return stringBuilder.toString(); } @Override protected HttpResponse doInBackground(Void... params) { HttpResponse response = null; HttpClient client = new DefaultHttpClient(); HttpGet get = new HttpGet(createUrl()); try { response = client.execute(get); } catch (IOException e) { e.printStackTrace(); } return response; } }</span></span></code> </pre><br>  Here, too, everything is simple.  Let me remind you, as I have already said, to obtain time, you need the coordinates and date of the day of sunset and dawn, which we want to receive. <br><br>  The createUrl method generates a URL for a GET request, but there are a few more parameters than I wrote before.  Namely: timezone and dst.  So, everything is clear with the timezone, you can specify the time zone in which you want to calculate, but if you substitute "99" as a time zone, then it will be automatically determined based on the coordinates that you transmit.  Accordingly, I set 99. Well, dst is the accounting for summer time (0 - no, 1 - yes). <br><br>  So, it is assumed that we get the XML with the result.  Now it needs to be parsed.  We will use as usual XmlPullParser, who is not familiar, I advise you to read, as it has a number of "features".  Well, in fact, the class that parsit sunset and sunrise. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SunXmlParser</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String xmlString; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> XmlPullParser parser; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SUNRISE = <span class="hljs-string"><span class="hljs-string">"sunrise"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SUNSET = <span class="hljs-string"><span class="hljs-string">"sunset"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SunXmlParser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String xmlString)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> XmlPullParserException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.xmlString = xmlString; parser = Xml.newPullParser(); parser.setInput(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringReader(xmlString)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setXmlString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String xmlString)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> XmlPullParserException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.xmlString = xmlString; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String tag)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> XmlPullParserException, IOException </span></span>{ parser.setInput(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringReader(xmlString)); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> eventType = parser.getEventType(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (eventType != XmlPullParser.END_DOCUMENT) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(eventType == XmlPullParser.START_TAG &amp;&amp; parser.getName().equalsIgnoreCase(tag)) { parser.next(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parser.getText(); } eventType = parser.next(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Not found"</span></span>; } }</code> </pre><br>  That's all.  Problem solved, the result on the screen: <br><br><img src="https://habrastorage.org/files/92c/70f/5b9/92c70f5b90d34ae29d36b3832810b8b5.png"></div><p>Source: <a href="https://habr.com/ru/post/248539/">https://habr.com/ru/post/248539/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248525/index.html">Workflow in Document Approval System</a></li>
<li><a href="../248527/index.html">How to write great pull requests</a></li>
<li><a href="../248529/index.html">HP server conference online ‚Äî only 10 days to win 2 tablets</a></li>
<li><a href="../248531/index.html">Ubiquiti lightning protection. Recommendations for connecting devices without a grounding screw on the case</a></li>
<li><a href="../248535/index.html">10 reasons why you are not a tester</a></li>
<li><a href="../248541/index.html">Spring MVC 3, Hibernate Annotations, MySQL. Integration Tutorial</a></li>
<li><a href="../248543/index.html">Systemd author - Lennart Pottering game</a></li>
<li><a href="../248545/index.html">We write and debug the component for GWT and Vaadin</a></li>
<li><a href="../248547/index.html">(Tajikistan) Power and Efficiency: A New Generation of HP ProLiant Gen9 Servers</a></li>
<li><a href="../248553/index.html">How I wrote a game about SEO</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>