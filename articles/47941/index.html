<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sample Kohana Bulletin Board</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kohana is a fairly young PHP framework, fork CI, totally tied to OOP. The advantages of Kohana include the use of all the features of PHP5 at 100%, hi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sample Kohana Bulletin Board</h1><div class="post__text post__text-html js-mediator-article"><img src="http://kohanaphp.com/media/img/kohana.png"><br>  <a href="http://kohanaphp.ru/">Kohana</a> is a fairly young PHP framework, fork CI, totally tied to OOP.  The advantages of Kohana include the use of all the features of PHP5 at 100%, high speed, "lightness" and ease of both use and study.  Of the minuses, a small community clearly stands out, as a result, not very high quality documentation and a small number of modules and libraries. <br><br>  Not so long ago, I began my acquaintance with frameworks with Kohana and, I must say, I was surprised how easily he succumbed to me.  I thought it would be much more difficult.  But the lack of documentation and code samples was very significant.  Having dug in mana and source analysis, after a while, I filled in the gaps of interest to me regarding Kohana, and so I decided to write this article so that other people who find themselves in a similar situation should not get enough sleep at night and heal headaches. <br><br>  Under the cut is an example of a bulletin board, written with the help of Kohana, perhaps in some places it does not pretend to rationality and common sense, but still I hope to hear constructive criticism. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The article is intended for people who have the concept of MVC and OOP, but who have not, or who have had little to do, dealing with frameworks. <br><br><a name="habracut"></a><br><h3>  Let's start </h3><br>  Recently, I faced the task of writing a small bulletin board based on a news site, where users could post their ads for buying, selling and so on.  Write very quickly.  Honestly, prior to this incident, my whole experience with the frameworks was to install the symfony sandbox and then remove it.  And all I knew about frameworks is that most of them ‚Äúuse MVC‚Äù and that they <u>make life much easier</u> .  Because  at that time, I was already reading Habr, for some reason, <a href="http://habrahabr.ru/blogs/kohanaphp/38447/">one of the publications</a> , which claimed that the Kohana framework "was created to be lightweight, fast and easy to use," sank into my head.  I think that's why I chose it.  So, <br><br><h4>  What do we want to get as a result? </h4><br>  We want us to have such opportunities for users: <br><ul><li>  user authorization / registration </li><li>  view ads by all users; </li><li>  add ads can only registered; </li><li>  only authors and admins can edit / delete; </li></ul><br>  Conditions for categories: <br><ul><li>  there are major categories; </li><li>  there are sub-categories; </li><li>  sub-categories contain ads; </li></ul><br><br>  With what is needed from us, we have decided, now we will figure out how we will implement it. <br><br>  To register users, we will use the Auth module, which is included in the standard version of version 2.3.  To use it, create several tables in the database: <br><blockquote><code><font color="black"><font color="#777"><i>#       </i></font> &lt;br/&gt; <br> <font color="#0000ff">CREATE</font> <font color="#0000ff">TABLE</font> <font color="#0000ff">IF</font> <font color="#0000ff">NOT</font> <font color="#0000ff">EXISTS</font> `users` ( <br> `id` <font color="#0000ff">int</font> (11) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> auto_increment, <br> `username` <font color="#0000ff">varchar</font> (32) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> <font color="#0000ff">default</font> <font color="#A31515">''</font> , <br> `password` <font color="#0000ff">char</font> (50) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> <font color="#0000ff">default</font> <font color="#A31515">''</font> , <br> `email` <font color="#0000ff">varchar</font> (127) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> <font color="#0000ff">default</font> <font color="#A31515">''</font> , <br> ` <font color="#0000ff">join</font> ` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> <font color="#0000ff">default</font> <font color="#A31515">'0'</font> , <br> `last_login` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> <font color="#0000ff">default</font> <font color="#A31515">'0'</font> , <br> `logins` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> <font color="#0000ff">default</font> <font color="#A31515">'0'</font> , <br> <font color="#0000ff">PRIMARY</font> <font color="#0000ff">KEY</font> (`id`), <br> <font color="#0000ff">UNIQUE</font> <font color="#0000ff">KEY</font> `uniq_username` (`username`), <br> <font color="#0000ff">UNIQUE</font> <font color="#0000ff">KEY</font> `uniq_email` (`email`) <br> ) ENGINE=MyISAM <font color="#0000ff">DEFAULT</font> CHARSET=utf8 AUTO_INCREMENT=3; <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `users` (`id`, `username`, `password`, `email`, ` <font color="#0000ff">join</font> `, `last_login`, `logins`) <font color="#0000ff">VALUES</font> (1, <font color="#A31515">'admin'</font> , <font color="#A31515">'098f6bcd4621d373cade4e832627b4f6'</font> , <font color="#A31515">'example@example.com'</font> , 1215075372, 0, 0); <br> <br> <font color="#777"><i>#       </i></font> &lt;br/&gt; <br> <font color="#0000ff">CREATE</font> <font color="#0000ff">TABLE</font> <font color="#0000ff">IF</font> <font color="#0000ff">NOT</font> <font color="#0000ff">EXISTS</font> `roles` ( <br> `id` <font color="#0000ff">int</font> (4) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> auto_increment, <br> `name` <font color="#0000ff">varchar</font> (32) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> `description` <font color="#0000ff">varchar</font> (255) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> <font color="#0000ff">PRIMARY</font> <font color="#0000ff">KEY</font> (`id`), <br> <font color="#0000ff">UNIQUE</font> <font color="#0000ff">KEY</font> `uniq_name` (`name`) <br> ) ENGINE=MyISAM <font color="#0000ff">DEFAULT</font> CHARSET=utf8 AUTO_INCREMENT=3; <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `roles` (`id`, `name`, `description`) <font color="#0000ff">VALUES</font> (1, <font color="#A31515">'login'</font> , <font color="#A31515">''</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `roles` (`id`, `name`, `description`) <font color="#0000ff">VALUES</font> (2, <font color="#A31515">'admin'</font> , <font color="#A31515">''</font> ); <br> <br> <font color="#777"><i>#        </i></font> &lt;br/&gt; <br> <font color="#0000ff">CREATE</font> <font color="#0000ff">TABLE</font> <font color="#0000ff">IF</font> <font color="#0000ff">NOT</font> <font color="#0000ff">EXISTS</font> `roles_users` ( <br> `user_id` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> `role_id` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> <font color="#0000ff">PRIMARY</font> <font color="#0000ff">KEY</font> (`user_id`,`role_id`), <br> <font color="#0000ff">KEY</font> `fk_role_id` (`role_id`) <br> ) ENGINE=MyISAM <font color="#0000ff">DEFAULT</font> CHARSET=utf8; <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `roles_users` (`user_id`, `role_id`) <font color="#0000ff">VALUES</font> (1, 2); <br> <br> <font color="#777"><i># a      Auth    </i></font> &lt;br/&gt; <br> <font color="#0000ff">DROP</font> <font color="#0000ff">TABLE</font> <font color="#0000ff">IF</font> <font color="#0000ff">EXISTS</font> `d_user_tokens`; <br> <font color="#0000ff">CREATE</font> <font color="#0000ff">TABLE</font> <font color="#0000ff">IF</font> <font color="#0000ff">NOT</font> <font color="#0000ff">EXISTS</font> `user_tokens` ( <br> `id` <font color="#0000ff">int</font> (11) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> auto_increment, <br> `user_id` <font color="#0000ff">int</font> (11) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> `user_agent` <font color="#0000ff">varchar</font> (40) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> `token` <font color="#0000ff">varchar</font> (32) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> `created` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> `expires` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> <font color="#0000ff">PRIMARY</font> <font color="#0000ff">KEY</font> (`id`), <br> <font color="#0000ff">UNIQUE</font> <font color="#0000ff">KEY</font> `uniq_token` (`token`), <br> <font color="#0000ff">KEY</font> `user_id` (`user_id`) <br> ) ENGINE=MyISAM <font color="#0000ff">DEFAULT</font> CHARSET=utf8;</font> <br></code> </blockquote><br>  Next, create tables for categories and ads.  In this case, all categories will have a parent_id field, which will point to the id of the parent category whose parent_id will be 0. <br><blockquote> <code><font color="black"><font color="#0000ff">CREATE</font> <font color="#0000ff">TABLE</font> <font color="#0000ff">IF</font> <font color="#0000ff">NOT</font> <font color="#0000ff">EXISTS</font> `categories` ( <br> `id` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> auto_increment, <br> `parent_id` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> <font color="#0000ff">default</font> <font color="#A31515">'0'</font> , <br> `name` <font color="#0000ff">varchar</font> (150) <font color="#0000ff">character</font> <font color="#0000ff">set</font> utf8 <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> <font color="#0000ff">PRIMARY</font> <font color="#0000ff">KEY</font> (`id`), <br> <font color="#0000ff">KEY</font> `parent_id` (`parent_id`) <br> ) ENGINE=MyISAM <font color="#0000ff">DEFAULT</font> CHARSET=utf8 AUTO_INCREMENT=14; <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (1, 0, <font color="#A31515">''</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (2, 1, <font color="#A31515">''</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (3, 1, <font color="#A31515">''</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (4, 1, <font color="#A31515">', '</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (5, 0, <font color="#A31515">''</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (6, 5, <font color="#A31515">' '</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (7, 5, <font color="#A31515">', '</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (8, 5, <font color="#A31515">', '</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (9, 0, <font color="#A31515">''</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (10, 9, <font color="#A31515">' '</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (11, 9, <font color="#A31515">', '</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (12, 9, <font color="#A31515">'  '</font> ); <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `categories` (`id`, `parent_id`, `name`) <font color="#0000ff">VALUES</font> (13, 9, <font color="#A31515">' '</font> ); <br> <br> <font color="#0000ff">CREATE</font> <font color="#0000ff">TABLE</font> <font color="#0000ff">IF</font> <font color="#0000ff">NOT</font> <font color="#0000ff">EXISTS</font> `items` ( <br> `id` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> auto_increment, <br> `title` <font color="#0000ff">varchar</font> (250) <font color="#0000ff">character</font> <font color="#0000ff">set</font> utf8 <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> `category_id` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> <font color="#0000ff">default</font> <font color="#A31515">'0'</font> , <br> `content` text <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> `user_id` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> , <br> `datepub` <font color="#0000ff">int</font> (10) unsigned <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> <font color="#0000ff">default</font> <font color="#A31515">'0'</font> , <br> <font color="#0000ff">PRIMARY</font> <font color="#0000ff">KEY</font> (`id`), <br> <font color="#0000ff">KEY</font> `title` (`title`) <br> ) ENGINE=MyISAM <font color="#0000ff">DEFAULT</font> CHARSET=utf8 AUTO_INCREMENT=2; <br> <font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `items` (`id`, `title`, `category_id`, `content`, `user_id`, `datepub`) <font color="#0000ff">VALUES</font> (1, <font color="#A31515">' '</font> , 2, <font color="#A31515">'  .     '</font> , 1, 1229251545);</font></code> </blockquote> <br><br><h3>  Models </h3><br>  Models are part of MVC that presents data and responds to requests, being the final authority between the script and the database. <br><br>  Now about the models that we will use.  To work with users, we have standard models of the Auth module, to refer to articles and categories, create our own - create the file <b>/application/models/category.php</b> and write the following class in it: <br><blockquote> <code><font color="black"><font color="#0000ff">class</font> Category_Model <font color="#0000ff">extends</font> ORM_Tree{ <br> <font color="#0000ff">protected</font> $children = <font color="#A31515">'categories'</font> ; <br> <font color="#0000ff">protected</font> $has_many = array( <font color="#A31515">'items'</font> ); <br> } <br></font></code> </blockquote><br>  Now create another file <b>/application/models/item.php</b> with this class: <br><blockquote> <code><font color="black"><font color="#0000ff">class</font> Item_Model <font color="#0000ff">extends</font> ORM{ <br> <font color="#0000ff">protected</font> $has_one = array( <font color="#A31515">'user'</font> ); <br> <font color="#0000ff">protected</font> $belongs_to = array( <font color="#A31515">'category'</font> ); <br> }</font></code> </blockquote> <br>  Now in Russian - for the category model, we created an extended ORM (about this a little below) the class of the categories table with a tree structure (ORM_Tree), which records can have descendants in the form of records from the same table (protected $ children = `categories` , by default the parent is the `parent_id` field) and each entry of which can have many nested entries in the` items` table.  And for the ad model, we have a simple ORM class of the `items` table, which contains one entry from the` users` table and belongs to the `categories` table <br><br><blockquote>  I think it should be clarified that the names of models should be in a single number, i.e.  if the items table is used, then the model name should be Item_Model.  Also, the situation is with the declarations of model variables, if a set of objects is supposed ($ children, $ has_many), then the argument must be plural, if the object is one ($ has_one, $ belong_to), then the number is a single one. </blockquote><br><br><h3>  Controllers </h3><br>  It seems that they have figured out the models, now about the controllers - they serve to display information, being a layer between models and views. <br><br>  What controllers do we need?  I think these: <br><ol><li>  for the main page, at the same time and categories </li><li>  for sub-categories </li><li>  to view ads </li><li>  to log users </li><li>  for their registration </li></ol><br>  Since the first with the second, also the third with the fourth, are logically interconnected, combine them into one for each type and as a result we get three controllers - <strong>category.php</strong> , <strong>items.php</strong> and <strong>user.php</strong> . <br><br>  Then a lot of code, most of which is intuitive, and zanakom people working with ORM and MVC. <br><br><blockquote><h5>  What is ORM? </h5>  I think that if you have read to here, then you should not have any questions about MVC, but with regard to ORM they may well appear.  <a href="http://ru.wikipedia.org/wiki/ORM">Wikipedia tells us</a> that ORM is a programming technology that links databases with the concepts of object-oriented programming languages, creating a ‚Äúvirtual object database.‚Äù  What does it mean?  This means that by calling the factory method of the ORM class with a parameter, for example, 'table', we get an object, a projection of the `tables` table (I‚Äôve talked about plural numbers and singular numbers above), and the place for making SQL queries to the database through an extension, or some abstract class, we can access the methods and properties of the called class.  Those.  for example, the selection of records with id equal to 5 from the database will occur not the usual <i>$ db-&gt; query ('SELECT * FROM `table` WHERE (` id` = 5)')</i> , but by referring to the ORM projection - <i>ORM :: factory ('table ') -&gt; where (' id ', 5) -&gt; find_all ()</i> .  But unlike simple abstract access, ORM provides a lot of goodies that are difficult to understand without trying.  So, if we are talking about id, then the record can be obtained even easier - <i>ORM :: factory ('table', 5)</i> .  Using the example of our above-named models, we can get the name of the category in which the declaration is with id = 5 by calling <i>ORM :: factory ('item', 5) -&gt; category-&gt; name</i> , and not writing a bunch of SQL queries. </blockquote><br><br>  <b>category.php</b> : <br><blockquote> <code><font color="black"><font color="#0000ff">class</font> Category_Controller extends Template_Controller {&lt;br&gt; <font color="#0000ff">public</font> $template = <font color="#A31515">'index'</font> ;&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function index() { <font color="#008000">//  </font> &lt;br&gt;    $_result = <font color="#A31515">''</font> ;&lt;br&gt;    $_cats = array();&lt;br&gt;    $categories = ORM::factory( <font color="#A31515">'category'</font> )-&gt; <font color="#0000ff">where</font> ( <font color="#A31515">'parent_id'</font> , 0)-&gt;find_all();&lt;br&gt; <font color="#0000ff">foreach</font> ($categories <font color="#0000ff">as</font> $l) {&lt;br&gt;      $_tmp = <font color="#0000ff">new</font> View( <font color="#A31515">'category'</font> );&lt;br&gt;      $_tmp-&gt;id = $l-&gt;id;&lt;br&gt;      $_tmp-&gt;name = $l-&gt;name;&lt;br&gt;      $_tmp-&gt;children = $l-&gt;children;&lt;br&gt;      $_cats[] = $_tmp;&lt;br&gt;    }&lt;br&gt;    $_result = <font color="#0000ff">new</font> View( <font color="#A31515">'category'</font> );&lt;br&gt;    $_result-&gt;cats = $_cats;&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;template-&gt;content = $_result;&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function view($ <font color="#0000ff">params</font> ) { <font color="#008000">//  </font> &lt;br&gt;    $_result = <font color="#A31515">''</font> ;&lt;br&gt;    $categories = ORM::factory( <font color="#A31515">'category'</font> , $ <font color="#0000ff">params</font> )-&gt;children;&lt;br&gt; <font color="#0000ff">foreach</font> ($categories <font color="#0000ff">as</font> $l) {&lt;br&gt; <font color="#0000ff">foreach</font> ($l-&gt;items <font color="#0000ff">as</font> $n) {&lt;br&gt;        $_tmp = <font color="#0000ff">new</font> View( <font color="#A31515">'item'</font> );&lt;br&gt;        $_tmp-&gt;content = $n;&lt;br&gt;        $_result.= $_tmp;&lt;br&gt;      }&lt;br&gt;    }&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;template-&gt;content = $_result;&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function viewsub($ <font color="#0000ff">params</font> ) { <font color="#008000">//  -</font> &lt;br&gt;    $_result = <font color="#A31515">''</font> ;&lt;br&gt;    $categories = ORM::factory( <font color="#A31515">'category'</font> , $ <font color="#0000ff">params</font> );&lt;br&gt; <font color="#0000ff">foreach</font> ($categories-&gt;items <font color="#0000ff">as</font> $l) {&lt;br&gt;      $_tmp = <font color="#0000ff">new</font> View( <font color="#A31515">'item'</font> );&lt;br&gt;      $_tmp-&gt;content = $l;&lt;br&gt;      $_result.= $_tmp;&lt;br&gt;    }&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;template-&gt;content = $_result;&lt;br&gt;  }&lt;br&gt;}</font></code> </blockquote> <br>  In the <strong>index</strong> method, we collect an array of main categories with objects of subcategories in it and the number of declarations (count) in subcategories and output this whole thing through the <i>category</i> view, which will be described in the ‚ÄúViews‚Äù chapter. <br><br>  The <b>view</b> method shows us the contents of all subcategories of the category with the id passed in the parameter (how it gets there - in the ‚ÄúFinal Settings‚Äù chapter).  The <strong>viewsub</strong> method also works with the difference that it is applicable to subcategories. <br><br>  Now the ad controller, <strong>items.php</strong> : <br><blockquote> <code><font color="black"><font color="#0000ff">class</font> Items_Controller extends Template_Controller {&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> $template = <font color="#A31515">'index'</font> ;&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function index() { <font color="#008000">//   ,    </font> &lt;br&gt;    url::redirect( <font color="#A31515">'/index'</font> );&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function view($arg) { <font color="#008000">//    id = $arg</font> &lt;br&gt;    $_item = ORM::factory( <font color="#A31515">'item'</font> , $arg);&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;template-&gt;content = <font color="#0000ff">new</font> View( <font color="#A31515">'item'</font> );&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;template-&gt;content-&gt;content = $_item;&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function edit($arg) { <font color="#008000">//   c id = $arg</font> &lt;br&gt;    $_tmp = ORM::factory( <font color="#A31515">'item'</font> , $arg);&lt;br&gt;&lt;br&gt; <font color="#0000ff">if</font> (Auth::instance()-&gt;logged_in( <font color="#A31515">'admin'</font> ) || (Auth::instance()-&gt;get_user() &amp;&amp;&lt;br&gt;      (Auth::instance()-&gt;get_user()-&gt;id == $_tmp-&gt;user_id))) { <font color="#008000">//       </font> &lt;br&gt;      $category = array();&lt;br&gt; <font color="#008000">//   </font> &lt;br&gt; <font color="#0000ff">foreach</font> (ORM::factory( <font color="#A31515">'category'</font> )-&gt; <font color="#0000ff">where</font> ( <font color="#A31515">'parent_id'</font> , 0)-&gt;find_all() <font color="#0000ff">as</font> $l) {&lt;br&gt; <font color="#0000ff">foreach</font> ($l-&gt;children <font color="#0000ff">as</font> $n) {&lt;br&gt;          $category[$l-&gt;name][$n-&gt;id] = $n-&gt;name;&lt;br&gt;        }&lt;br&gt;      }&lt;br&gt; <font color="#008000">//      </font> &lt;br&gt;      $form = <font color="#0000ff">new</font> Forge(url::current());&lt;br&gt;      $form-&gt;set_attr( <font color="#A31515">'method'</font> , <font color="#A31515">'post'</font> );&lt;br&gt;      $form-&gt;input( <font color="#A31515">'title'</font> ) <font color="#008000">//   &lt;input id = 'title' /&gt;</font> &lt;br&gt;           -&gt;label( <font color="#A31515">''</font> ) <font color="#008000">//    &lt;label for='title'&gt;&lt;/label&gt;</font> &lt;br&gt;           -&gt;rules( <font color="#A31515">'required|length[3,40]'</font> ) <font color="#008000">//   - ,  3  40 </font> &lt;br&gt;           -&gt; <font color="#0000ff">value</font> ($_tmp-&gt;title); <font color="#008000">//      $_tmp-&gt;title</font> &lt;br&gt;      $form-&gt;textarea( <font color="#A31515">'addtext'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">''</font> )&lt;br&gt;           -&gt;rules( <font color="#A31515">'required'</font> )&lt;br&gt;           -&gt; <font color="#0000ff">value</font> ($_tmp-&gt;content);&lt;br&gt;      $form-&gt;dropdown( <font color="#A31515">'category'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">''</font> )&lt;br&gt;           -&gt;options($category)&lt;br&gt;           -&gt;selected($_tmp-&gt;category_id);&lt;br&gt;      $form-&gt;submit( <font color="#A31515">''</font> );&lt;br&gt;&lt;br&gt; <font color="#008000">//      </font> &lt;br&gt; <font color="#0000ff">if</font> ($form-&gt;validate()) {&lt;br&gt; <font color="#008000">//     ORM</font> &lt;br&gt;        $ <font color="#0000ff">new</font> = ORM::factory( <font color="#A31515">'item'</font> , $arg);&lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;title = $form-&gt;inputs[ <font color="#A31515">'title'</font> ]-&gt; <font color="#0000ff">value</font> ;&lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;content = $form-&gt;inputs[ <font color="#A31515">'addtext'</font> ]-&gt; <font color="#0000ff">value</font> ;&lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;category_id = $form-&gt;inputs[ <font color="#A31515">'category'</font> ]-&gt; <font color="#0000ff">value</font> ;&lt;br&gt; <font color="#008000">//   - </font> &lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;save();&lt;br&gt;        url::redirect( <font color="#A31515">'/'</font> );&lt;br&gt;      }&lt;br&gt; <font color="#008000">//   </font> &lt;br&gt;      $ <font color="#0000ff">this</font> -&gt;template-&gt;content = $form-&gt;render();&lt;br&gt;    } <font color="#0000ff">else</font> {&lt;br&gt;      $ <font color="#0000ff">this</font> -&gt;template-&gt;content = <font color="#A31515">"  "</font> ;&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function add() { <font color="#008000">//  </font> &lt;br&gt; <font color="#0000ff">if</font> (Auth::instance()-&gt;logged_in()) { <font color="#008000">//    </font> &lt;br&gt;      $category = array();&lt;br&gt; <font color="#0000ff">foreach</font> (ORM::factory( <font color="#A31515">'category'</font> )-&gt; <font color="#0000ff">where</font> ( <font color="#A31515">'parent_id'</font> , 0)-&gt;find_all() <font color="#0000ff">as</font> $l) {&lt;br&gt; <font color="#0000ff">foreach</font> ($l-&gt;children <font color="#0000ff">as</font> $n) {&lt;br&gt;          $category[$l-&gt;name][$n-&gt;id] = $n-&gt;name;&lt;br&gt;        }&lt;br&gt;      }&lt;br&gt;      $form = <font color="#0000ff">new</font> Forge(url::current());&lt;br&gt;      $form-&gt;set_attr( <font color="#A31515">'method'</font> , <font color="#A31515">'post'</font> );&lt;br&gt;      $form-&gt;input( <font color="#A31515">'title'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">''</font> )&lt;br&gt;           -&gt;rules( <font color="#A31515">'required|length[3,40]'</font> );&lt;br&gt;      $form-&gt;textarea( <font color="#A31515">'addtext'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">''</font> )&lt;br&gt;           -&gt;rules( <font color="#A31515">'required'</font> );&lt;br&gt;      $form-&gt;dropdown( <font color="#A31515">'category'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">''</font> )&lt;br&gt;           -&gt;options($category)&lt;br&gt;           -&gt;selected(0);&lt;br&gt;      $form-&gt;submit( <font color="#A31515">''</font> );&lt;br&gt; <font color="#0000ff">if</font> ($form-&gt;validate()) {&lt;br&gt;        $ <font color="#0000ff">new</font> = ORM::factory( <font color="#A31515">'item'</font> );&lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;title = $form-&gt;inputs[ <font color="#A31515">'title'</font> ]-&gt; <font color="#0000ff">value</font> ;&lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;content = $form-&gt;inputs[ <font color="#A31515">'addtext'</font> ]-&gt; <font color="#0000ff">value</font> ;&lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;category_id = $form-&gt;inputs[ <font color="#A31515">'category'</font> ]-&gt; <font color="#0000ff">value</font> ;&lt;br&gt; <font color="#008000">//     Auth     </font> &lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;user_id = Auth::instance()-&gt;get_user()-&gt;id;&lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;datepub = time();&lt;br&gt;        $ <font color="#0000ff">new</font> -&gt;save();&lt;br&gt;        url::redirect( <font color="#A31515">'/'</font> );&lt;br&gt;      }&lt;br&gt;      $ <font color="#0000ff">this</font> -&gt;template-&gt;content = $form-&gt;render();&lt;br&gt;    } <font color="#0000ff">else</font> {&lt;br&gt;      $ <font color="#0000ff">this</font> -&gt;template-&gt;content = <font color="#A31515">"  "</font> ;&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function delete($arg) { <font color="#008000">//  </font> &lt;br&gt;    $ <font color="#0000ff">new</font> = ORM::factory( <font color="#A31515">'item'</font> , $arg);&lt;br&gt; <font color="#0000ff">if</font> (Auth::instance()-&gt;logged_in( <font color="#A31515">'admin'</font> ) || (Auth::instance()-&gt;get_user() &amp;&amp;&lt;br&gt;      (Auth::instance()-&gt;get_user()-&gt;id == $ <font color="#0000ff">new</font> -&gt;user_id))) { <font color="#008000">//    </font> &lt;br&gt;      $ <font color="#0000ff">new</font> -&gt;delete();&lt;br&gt;      url::redirect( <font color="#A31515">'/'</font> );&lt;br&gt;    } <font color="#0000ff">else</font> {&lt;br&gt;      $ <font color="#0000ff">this</font> -&gt;template-&gt;content = <font color="#A31515">"  "</font> ;&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;}</font></code> </blockquote> <br>  I think the only class that we have not met before is the Forge.  It is used to facilitate working with forms, but, unfortunately, it is excluded from the standard delivery of Kohana.  Where to get it, I will tell below. <br><br>  Well, the user controller, <strong>user.php</strong> : <br><blockquote> <code><font color="black"><font color="#0000ff">class</font> User_Controller extends Template_Controller {&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> $template = <font color="#A31515">'index'</font> ;&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function login() { <font color="#008000">// </font> &lt;br&gt; <font color="#0000ff">if</font> (Auth::instance()-&gt;logged_in()) { <font color="#008000">//   ,   </font> &lt;br&gt;      url::redirect( <font color="#A31515">'/'</font> );&lt;br&gt;    } <font color="#0000ff">else</font> { <font color="#008000">//  </font> &lt;br&gt;      $form = <font color="#0000ff">new</font> Forge;&lt;br&gt;      $form-&gt;set_attr( <font color="#A31515">'method'</font> , <font color="#A31515">'post'</font> );&lt;br&gt;      $form-&gt;input( <font color="#A31515">'username'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">''</font> )&lt;br&gt;           -&gt;rules( <font color="#A31515">'required|length[4,32]'</font> );&lt;br&gt;      $form-&gt;password( <font color="#A31515">'password'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">''</font> )&lt;br&gt;           -&gt;rules( <font color="#A31515">'required|length[4,40]'</font> );&lt;br&gt;      $form-&gt;submit( <font color="#A31515">''</font> );&lt;br&gt; <font color="#0000ff">if</font> ($form-&gt;validate()) {&lt;br&gt;        $user = ORM::factory( <font color="#A31515">'user'</font> , $form-&gt;username-&gt; <font color="#0000ff">value</font> );&lt;br&gt; <font color="#008000">//   ,   </font> &lt;br&gt; <font color="#0000ff">if</font> (Auth::instance()-&gt;login($user, $form-&gt;password-&gt; <font color="#0000ff">value</font> )) {&lt;br&gt;          url::redirect( <font color="#A31515">'/'</font> );&lt;br&gt;        } <font color="#0000ff">else</font> {&lt;br&gt; <font color="#008000">//  ,   </font> &lt;br&gt;          $form-&gt;password-&gt;add_error( <font color="#A31515">'login_failed'</font> , <font color="#A31515">'  ,  .'</font> );&lt;br&gt;        }&lt;br&gt;      }&lt;br&gt;    }&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;template-&gt;content = $form-&gt;render();&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function logout() { <font color="#008000">// </font> &lt;br&gt; <font color="#0000ff">if</font> (Auth::instance()-&gt;logged_in()) {&lt;br&gt;      Auth::instance()-&gt;logout(TRUE);&lt;br&gt;    }&lt;br&gt;    url::redirect( <font color="#A31515">'/'</font> );&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> function register() { <font color="#008000">// </font> &lt;br&gt; <font color="#0000ff">if</font> (Auth::instance()-&gt;logged_in()) {&lt;br&gt;      url::redirect( <font color="#A31515">'/'</font> );&lt;br&gt;    } <font color="#0000ff">else</font> {&lt;br&gt;      $form = <font color="#0000ff">new</font> Forge(url::current(), <font color="#A31515">''</font> );&lt;br&gt;      $form-&gt;set_attr( <font color="#A31515">'method'</font> , <font color="#A31515">'post'</font> );&lt;br&gt;      $form-&gt;input( <font color="#A31515">'username'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">''</font> )&lt;br&gt; <font color="#008000">//     ,    '_'  '-'  4  32 </font> &lt;br&gt;           -&gt;rules( <font color="#A31515">'required|length[4,32]|valid_alpha_dash'</font> );&lt;br&gt;      $form-&gt;password( <font color="#A31515">'password'</font> )-&gt;label( <font color="#A31515">''</font> );&lt;br&gt;      $form-&gt;password( <font color="#A31515">'password2'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">' '</font> )&lt;br&gt;           -&gt;rules( <font color="#A31515">'required|length[6,40]|valid_alpha_dash'</font> )&lt;br&gt; <font color="#008000">//       'password'</font> &lt;br&gt;           -&gt;matches($form-&gt;password);&lt;br&gt;      $form-&gt;input( <font color="#A31515">'email'</font> )&lt;br&gt;           -&gt;label( <font color="#A31515">'E-Mail'</font> )&lt;br&gt;           -&gt;rules( <font color="#A31515">'required|valid_email'</font> );&lt;br&gt;      $form-&gt;submit( <font color="#A31515">''</font> );&lt;br&gt; <font color="#0000ff">if</font> ($form-&gt;validate()) {&lt;br&gt;        $user = ORM::factory( <font color="#A31515">'user'</font> , $form-&gt;username-&gt; <font color="#0000ff">value</font> );&lt;br&gt; <font color="#008000">// ,     </font> &lt;br&gt; <font color="#0000ff">if</font> (!$user-&gt;username_exists($form-&gt;username-&gt; <font color="#0000ff">value</font> )) {&lt;br&gt;          $user-&gt;username = $form-&gt;username-&gt; <font color="#0000ff">value</font> ;&lt;br&gt;          $user-&gt;password = $form-&gt;password-&gt; <font color="#0000ff">value</font> ;&lt;br&gt;          $user-&gt;email = $form-&gt;email-&gt; <font color="#0000ff">value</font> ;&lt;br&gt; <font color="#008000">//       </font> &lt;br&gt; <font color="#0000ff">if</font> ($user-&gt;save() &amp;&amp; $user-&gt;add(ORM::factory( <font color="#A31515">'role'</font> , <font color="#A31515">'login'</font> ))) {&lt;br&gt;            Auth::instance()-&gt;login($user, $form-&gt;password-&gt; <font color="#0000ff">value</font> );&lt;br&gt;            url::redirect( <font color="#A31515">'/'</font> );&lt;br&gt;          }&lt;br&gt;        }&lt;br&gt;      }&lt;br&gt;    }&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;template-&gt;content = $form-&gt;render();&lt;br&gt;  }&lt;br&gt;}</font></code> </blockquote> <br>  An interesting point when creating a registration form, namely the object's matches () method, which is returned by the Forge password method.  When accessing it, the parameter needs to specify another password object, if the values ‚Äã‚Äãdo not match, the script will generate an error. <br><br><h3>  Kinds </h3><br>  Views (views) are responsible for displaying information and are the final layer between the user and the application. <br>  Now a little about the types.  In total, in our engine, we used three types, alternately about each: <br><br>  <b>category.php</b> : <br><blockquote> <code><font color="black"><font color="#007000">&lt;?php foreach($cats as $content): ?&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">class</font> <font color="#0000ff">="category"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">h3</font> <font color="#0000ff">&gt;&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> ="/ <font color="#ff0000">category</font> / <font color="#007000">&lt;?php echo $content-&gt;id ?&gt;</font> " <font color="#0000ff">&gt;</font> <font color="#007000">&lt;?php echo $content-&gt;name ?&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">/</font> <font color="#800000">h3</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">ul</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#007000">&lt;?php foreach($content-&gt;children as $l): ?&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">li</font> <font color="#0000ff">&gt;&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> ="/ <font color="#ff0000">subcategory</font> / <font color="#007000">&lt;?php echo $l-&gt;id ?&gt;</font> " <font color="#0000ff">&gt;</font> <font color="#007000">&lt;?php echo $l-&gt;name ?&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">li</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#007000">&lt;?php endforeach; ?&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">ul</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#007000">&lt;?php endforeach; ?&gt;</font></font></code> </blockquote> <br>  As you remember, we passed an array with categories and subcategories to it, which it processes, in a loop, displaying them all. <br><br>  <b>index.php</b> : <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;!</font> <font color="#800000">DOCTYPE</font> <font color="#ff0000">html</font> <font color="#ff0000">PUBLIC</font> <font color="#0000ff">"-//W3C//DTD XHTML 1.0 Strict//EN"</font> <font color="#0000ff">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">html</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://www.w3.org/1999/xhtml"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">head</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> Kohana <font color="#0000ff">&lt;/</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">head</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">="enter"</font> <font color="#ff0000">style</font> <font color="#0000ff">="float:right"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff"><font color="#007000">&lt;?php if(Auth::instance()-&gt;logged_in()) { ?&gt;</font> &lt;br&gt;    , <font color="#0000ff">&lt;</font> <font color="#800000">b</font> <font color="#0000ff">&gt; <font color="#007000">&lt;?php echo Auth::instance()-&gt;get_user()-&gt;username ?&gt;</font> &lt;/</font> <font color="#800000">b</font> <font color="#0000ff">&gt;</font> ‚Ä¢ <font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> <font color="#0000ff">="/logout"</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#007000">&lt;?php } else { ?&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> <font color="#0000ff">="/login"</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> ‚Ä¢ <font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> <font color="#0000ff">="/register"</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#007000">&lt;?php } ?&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">='links'</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> <font color="#0000ff">="/"</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> <font color="#0000ff">="/add"</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">='content'</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#007000">&lt;?php echo $content ?&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">html</font> <font color="#0000ff">&gt;</font></font></font></code> </blockquote> <br>  This is a ‚Äúwrapper‚Äù for all pages that we display.  In the enter block, we have such a trigger, which, depending on the status of the user, either displays his name with a link to the output, or links to the input and registration. <br><br>  <b>item.php</b> : <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">class</font> <font color="#0000ff">="item"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#007000">&lt;?php  if(Auth::instance()-&gt;logged_in('admin') || (Auth::instance()-&gt;get_user() &amp;&amp;&lt;br&gt;           Auth::instance()-&gt;get_user()-&gt;id == $content-&gt;user_id))  { ?&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">span</font> <font color="#ff0000">style</font> <font color="#0000ff">="float:right"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> ="/ <font color="#ff0000">items</font> / <font color="#ff0000">edit</font> / <font color="#007000">&lt;?php echo $content-&gt;id ?&gt;</font> " <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> ="/ <font color="#ff0000">items</font> / <font color="#ff0000">delete</font> / <font color="#007000">&lt;?php echo $content-&gt;id ?&gt;</font> " <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">span</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#007000">&lt;?php } ?&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">h1</font> <font color="#0000ff">&gt; <font color="#007000">&lt;?php echo html::anchor('/' . $content-&gt;id, html::specialchars($content-&gt;title)) ?&gt;</font> &lt;/</font> <font color="#800000">h1</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">class</font> <font color="#0000ff">="other"</font> <font color="#0000ff">&gt;</font>  <font color="#007000">&lt;?php echo date("jMY ", $content-&gt;datepub) ?&gt;</font> &lt;br&gt;            <font color="#0000ff">&lt;</font> <font color="#800000">b</font> <font color="#0000ff">&gt; <font color="#007000">&lt;?php echo html::specialchars($content-&gt;&gt;user-&gt;username) ?&gt;</font> &lt;/</font> <font color="#800000">b</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">class</font> <font color="#0000ff">="news"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#007000">&lt;?php&lt;br&gt;  echo text::auto_p($content-&gt;content);&lt;br&gt; ?&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  This view shows us the ad itself, displaying links to delete and edit in case the user is admin or the author of the ad.  You can also notice the use of two helper - html and text.  html :: specialchars makes the string ‚Äúsafe‚Äù, html :: anchor makes a link ‚Äî the first parameter is the address, the second is the text, and text :: auto_p automatically adds paragraphs to the plain text, as stated in off.  documentation "nl2br () on steroids". <br><br><h3>  Final settings </h3><br>  Now we are a little tweaking our ‚Äúsystem‚Äù before launching. <br><br>  Create the database.php file in the / application / config / folder and put the following in it: <br><blockquote> <code><font color="black">$config[ <font color="#A31515">'default'</font> ][ <font color="#A31515">'connection'</font> ] = array( <br> <font color="#A31515">'type'</font> =&gt; <font color="#A31515">'mysql'</font> , <br> <font color="#A31515">'user'</font> =&gt; <font color="#A31515">''</font> , <br> <font color="#A31515">'pass'</font> =&gt; <font color="#A31515">''</font> , <br> <font color="#A31515">'host'</font> =&gt; <font color="#A31515">''</font> , <br> <font color="#A31515">'database'</font> =&gt; <font color="#A31515">' '</font> , <br> );</font></code> </blockquote> <br>  This, as you understood, is the settings for MySQL. <br><br>  Next, open the config.php file in the same folder and bring the $ config ['modules'] array to the form <br><blockquote> <code><font color="black">$config[ <font color="#A31515">'modules'</font> ] = array <br> ( <br> MODPATH. <font color="#A31515">'auth'</font> , <br> MODPATH. <font color="#A31515">'forge'</font> , <br> );</font></code> </blockquote> <br>  You should also change the $ config ['site_domain'] to '/', if the Kohana directories are in your site root.  And I highly recommend setting the value of $ config ['index_page'] to an empty string, otherwise Kohana will generate relative links with the insertion of /index.php/ in the URL (for <a href="http://site.com/index.php/mail">example</a> : <a href="http://site.com/index.php/mail">site.com/index.php/mail</a> ). <br><br>  And now create a file routes.php and write in it <br><blockquote> <code><font color="black">$config[ <font color="#A31515">'_default'</font> ] = <font color="#A31515">'category'</font> ; <br> $config[ <font color="#A31515">'category/([0-9]+)'</font> ] = <font color="#A31515">'category/view/$1'</font> ; <br> $config[ <font color="#A31515">'subcategory/([0-9]+)'</font> ] = <font color="#A31515">'category/viewsub/$1'</font> ; <br> $config[ <font color="#A31515">'add'</font> ] = <font color="#A31515">'items/add'</font> ; <br> $config[ <font color="#A31515">'items/([0-9]+)'</font> ] = <font color="#A31515">'items/view/$1'</font> ; <br> $config[ <font color="#A31515">'edit/([0-9]+)'</font> ] = <font color="#A31515">'items/edit/$1'</font> ; <br> $config[ <font color="#A31515">'delete/([0-9]+)'</font> ] = <font color="#A31515">'items/delete/$1'</font> ; <br> $config[ <font color="#A31515">'login'</font> ] = <font color="#A31515">'user/login'</font> ; <br> $config[ <font color="#A31515">'logout'</font> ] = <font color="#A31515">'user/logout'</font> ; <br> $config[ <font color="#A31515">'register'</font> ] = <font color="#A31515">'user/register'</font> ; <br> $co</font></code> </blockquote> </div><p>Source: <a href="https://habr.com/ru/post/47941/">https://habr.com/ru/post/47941/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../47936/index.html">Technical support</a></li>
<li><a href="../47937/index.html">Have an idea about legal service.</a></li>
<li><a href="../47938/index.html">Leopard is near</a></li>
<li><a href="../47939/index.html">Invite to zombobox.com</a></li>
<li><a href="../47940/index.html">UML - use case diagram (use case diagram)</a></li>
<li><a href="../47944/index.html">MapServer and Google Maps</a></li>
<li><a href="../47946/index.html">Binaural Beats</a></li>
<li><a href="../47947/index.html">Maps of internet traffic and underwater fiber.</a></li>
<li><a href="../47952/index.html">Packard Bell EasyNote BG46. Almost ideal for 16930r.</a></li>
<li><a href="../47953/index.html">Are there any web services for putting invisible watermarks on images?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>