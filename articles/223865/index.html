<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calling the function corresponding to the specified string</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 
 I did not know how to name the article more precisely, but I would like to make out one small puzzle, which sounds like this: 
 The input is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calling the function corresponding to the specified string</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br>  I did not know how to name the article more precisely, but I would like to make out one small puzzle, which sounds like this: <br><blockquote>  The input is a formatted string in which the name of the function, its arguments and the types of the arguments are indicated.  You need to be able to call the appropriate function handler, passing all arguments correctly. </blockquote><br>  For example, so <a href="http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7caf.html">ActionScript</a> tries to call the <u>test</u> function with three arguments <i>str</i> , <i>false</i> , <i>1.0</i> (respectively, the types of arguments: <i>String</i> , <i>Boolean</i> , <i>Number</i> ): <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">invoke</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">returntype</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xml"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>str<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">false</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span>1.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">invoke</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  I would like the corresponding function to be called from C ++: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::wstring&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> flag, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span></span>;</code> </pre><br><br>  Under the cut - the implementation using the new standard and, for comparison, the implementation using the old standard (and droplets of boost-a). <br><a name="habracut"></a><br>  Let's get started  First you need to somehow parse the string.  Since this is not the essence of the task, we will use <a href="http://www.boost.org/doc/libs/1_55_0/doc/html/property_tree.html">Boost.PropertyTree</a> to parse the xml.  We'll hide all this in the help class <code>InvokeParser</code> , which will store the <i>name of the function</i> and an array of pairs of <i>argument type ‚Äî its value</i> : <br><div class="spoiler">  <b class="spoiler_title">Invokeparser</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"boost/property_tree/ptree.hpp"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"boost/property_tree/xml_parser.hpp"</span></span></span><span class="hljs-meta"> namespace as3 { class InvokeParser { public: using ArgsContainer = std::vector</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; std::pair&lt; std::wstring, // Argument type std::wstring // Argument value &gt;&gt;; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); // Are 'invoke' tag attributes and 'arguments' tag exists? auto invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); auto arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; // Is 'name' exists ? auto name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(const auto&amp; arg_value_pair : *arguments_xml) { std::wstring arg_type = arg_value_pair.first; std::wstring arg_value = arg_value_pair.second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.emplace_back(arg_type, arg_value); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; }; } // as3</span></span></span></span></code> </pre><br></div></div><br><br>  Now we‚Äôll write a generic <code>Type</code> class that will have one parameter ‚Äî some C ++ ‚Äî the type into which you will need to turn the string, as well as learn the corresponding name from ActionScript.  For example: <br><pre> <code class="cpp hljs">Type&lt;<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>&gt;::convert(<span class="hljs-string"><span class="hljs-string">L"20"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  20,  short Type&lt;short&gt;::name(); // short  ActionScript  "number"</span></span></code> </pre><br>  Template <code>Type</code> Code: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> CppType&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Type</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::enable_if&lt; !<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::is_array&lt;CppType&gt;::value, TypeHelper&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::decay&lt;CppType&gt;::type&gt; &gt;::type { }; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> CppType&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Type</span></span></span><span class="hljs-class">&lt;CppType*&gt; {</span></span> };</code> </pre><br>  Here we see the minimum precautions for the reckless user of this template, for example, you cannot instantiate this template with a pointer to some type, since we do not use pointers (specifically for <i>ActionScript</i> , there are simply no pointers).  Of course, not all precautions are here, but you can easily add them. <br>  As you can see, the main robot is performed by another <code>TypeHelper</code> class.  <code>TypeHelper</code> instantiated by the ‚Äúnaked‚Äù type.  For example, for <code>const std::wstring&amp;</code> get <code>std::wstring</code> , etc.  This is done using <a href="http://en.cppreference.com/w/cpp/types/decay">decay</a> .  And this is done in order to remove the differences between functions that have signatures of type <code>f(const std::wstring&amp;)</code> and <code>f(std::wstring)</code> .  We also do some precaution for arrays, as in this case, an obedient <code>decay</code> will cope well with the robot and we will get not exactly what we wanted. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The main template <code>TypeHelper</code> .  It will serve to convert numbers.  In our case, it will work fine for <a href="http://en.cppreference.com/w/cpp/language/types">Arithmetic</a> types, although, in an amicable way, you would need to exclude all character types (it is not difficult to do this by slightly modifying <code>is_valid_type</code> with <code>std::is_same</code> ). <br><div class="spoiler">  <b class="spoiler_title">Typehelper</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> CppType&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TypeHelper</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { is_valid_type = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::is_arithmetic&lt;CppType&gt;::value }; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::enable_if&lt;is_valid_type, CppType&gt;::type Type; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::enable_if&lt;is_valid_type, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wstring&gt;::<span class="hljs-function"><span class="hljs-function">type </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">name</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">L"number"</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// Convert AS3 number type from string to @CppType static Type convert(const std::wstring&amp; str) { double value = std::stod(str); return static_cast&lt;Type&gt;(value); } };</span></span></code> </pre><br></div></div><br>  As you can see, the name of all numeric types, in the case of <i>ActionScript</i> - <u>number</u> .  To convert from a string, first accurately convert to <code>double</code> , and then to the type we need. <br>  We also need other processing for the <code>bool</code> , <code>std::wstring</code> and <code>void</code> types: <br><div class="spoiler">  <b class="spoiler_title">Full TypeHelper specializations for bool, std :: wstring, void</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TypeHelper</span></span></span><span class="hljs-class">&lt;bool&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> Type; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-function">wstring </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">name</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">L"bool"</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::wstring&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (str == <span class="hljs-string"><span class="hljs-string">L"true"</span></span>); } }; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TypeHelper</span></span></span><span class="hljs-class">&lt;std::wstring&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wstring Type; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-function">wstring </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">name</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">L"string"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-function">wstring </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::wstring&amp; str)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str; } }; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TypeHelper</span></span></span><span class="hljs-class">&lt;void&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Type; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-function">wstring </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">name</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">L"undefined"</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::wstring&amp; </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/*str*/</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ } };</code> </pre><br></div></div><br><br>  That's all, in fact!  It remains to carefully put everything together.  Since you need to have a convenient mechanism for creating handlers for the corresponding functions (storing all the handlers in a container, etc.), let's create an <code>IFunction</code> interface: <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IFunction</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> InvokeParser&amp; parser)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IFunction() { } };</code> </pre><br>  But the heir classes will already know what function to call for a particular case.  Again the pattern: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> ReturnType, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Args&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Function</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IFunction { Function(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wstring&amp; function_name, ReturnType (*f)(Args...)) : f_(f) , name_(function_name) { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> InvokeParser&amp; parser)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(name_ != parser.function_name()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> ArgsCount = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>...(Args); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ArgsCount != parser.arguments_count()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> indexes = <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> generate_sequence&lt;ArgsCount&gt;::type(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> args = parser.arguments(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!validate_types(args, indexes)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> call(args, indexes); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>... S&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">validate_types</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">array</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wstring, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>...(Args)&gt; cpp_types = { Type&lt;Args&gt;::name()... }; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">array</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wstring, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>...(S)&gt; as3_types = { args[S].first... }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (cpp_types == as3_types); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>... S&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</span></span></span><span class="hljs-function"> </span></span>{ f_(Type&lt;Args&gt;::convert(args[S].second)...); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::function&lt;ReturnType (Args...)&gt; f_; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wstring name_; }; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> ReturnType, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Args&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;IFunction&gt; make_function(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wstring&amp; as3_function_name, ReturnType (*f)(Args...)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_shared&lt;Function&lt;ReturnType, Args...&gt;&gt;(as3_function_name, f); }</code> </pre><br><br>  First show how to use: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::wstring&amp; str, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> flag, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wcout &lt;&lt; <span class="hljs-string"><span class="hljs-string">L"test: "</span></span> &lt;&lt; str &lt;&lt; <span class="hljs-string"><span class="hljs-string">L", "</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::boolalpha &lt;&lt; flag &lt;&lt; <span class="hljs-string"><span class="hljs-string">", "</span></span> &lt;&lt; n &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ as3::InvokeParser parser; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wstring str = <span class="hljs-string"><span class="hljs-string">L"&lt;invoke name=\"test\" returntype=\"xml\"&gt;"</span></span> <span class="hljs-string"><span class="hljs-string">L"&lt;arguments&gt;&lt;string&gt;str&lt;/string&gt;&lt;false/&gt;&lt;number&gt;1.0&lt;/number&gt;&lt;/arguments&gt;"</span></span> <span class="hljs-string"><span class="hljs-string">L"&lt;/invoke&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(parser.parse(str)) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> function = as3::make_function(<span class="hljs-string"><span class="hljs-string">L"test"</span></span>, test_handler); function-&gt;call(parser); } }</code> </pre><br>  We turn to the details.  First, there is an auxiliary function <code>as3::make_function()</code> , which helps not to think about the type of callback passed. <br>  Secondly, in order to go through (more correctly, unpack the ‚Äúpattern‚Äù, look at the <i>Parameter pack</i> link (below)) in the parameter package (how to translate? <a href="http://en.cppreference.com/w/cpp/language/parameter_pack">Parameter pack</a> ), the auxiliary structures <code>sequence</code> and <code>generate_sequence</code> : <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> N, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>... Sequence&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">generate_sequence</span></span></span><span class="hljs-class"> :</span></span> generate_sequence&lt;N - <span class="hljs-number"><span class="hljs-number">1</span></span>, N - <span class="hljs-number"><span class="hljs-number">1</span></span>, Sequence...&gt; { }; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>...&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sequence</span></span></span><span class="hljs-class"> {</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>... Sequence&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">generate_sequence</span></span></span><span class="hljs-class">&lt;0, Sequence...&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> sequence&lt;Sequence...&gt; type; };</code> </pre><br>  Peeped on <a href="http://stackoverflow.com/questions/7858817/unpacking-a-tuple-to-call-a-matching-function-pointer">stackoverflow</a> . <br>  In a nutshell, <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> <pre> <code class="hljs haskell"><code><span class="hljs-title"><span class="hljs-title">generate_sequence</span></span>    <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ... <span class="hljs-type"><span class="hljs-type">N</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span></code> ,  (: <span class="hljs-string"><span class="hljs-string">" "</span></span>)   <code>sequence</code> .     <i><span class="hljs-type"><span class="hljs-type">Pack</span></span> expansion</i> (   <span class="hljs-string"><span class="hljs-string">" "</span></span>). <br> : <br>      <code>typename... <span class="hljs-type"><span class="hljs-type">Args</span></span></code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... <span class="hljs-type"><span class="hljs-type">Args</span></span>&gt; struct <span class="hljs-type"><span class="hljs-type">Test</span></span> { template&lt;int... <span class="hljs-type"><span class="hljs-type">S</span></span>&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;<span class="hljs-type"><span class="hljs-type">S</span></span>...&gt;) { f_(<span class="hljs-type"><span class="hljs-type">Type</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Args</span></span>&gt;::convert(args[<span class="hljs-type"><span class="hljs-type">S</span></span>].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(<span class="hljs-type"><span class="hljs-type">Args</span></span>)&gt;::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">())</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-class">test</span></span></code><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Args</span></span></span><span class="hljs-class"> = &lt;int, float&gt;</span></span></code><span class="hljs-class"><span class="hljs-class">   : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">f_(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;float&gt;::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">))</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    ! </span></span><br><span class="hljs-class"><span class="hljs-class">  - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">::validate_types</span></span></code><span class="hljs-class"><span class="hljs-class">   .     </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++</span></span></i><span class="hljs-class"><span class="hljs-class"> -  </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ActionScript</span></span></span><span class="hljs-class">-</span></span></i><span class="hljs-class"><span class="hljs-class"> ,   -  ,   .     -     !     .     ! </span></span><br><span class="hljs-class"><span class="hljs-class">   - </span></span><code><span class="hljs-class"><span class="hljs-class">call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sequence</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class">...&gt;)</span></span></code><span class="hljs-class"><span class="hljs-class">  ,    ,    . </span></span><br><span class="hljs-class"><span class="hljs-class">  -   </span></span><code><span class="hljs-class"><span class="hljs-class">make_function()</span></span></code><span class="hljs-class"><span class="hljs-class">    ,      </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> ,      (   )        . </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,      ,         </span></span><code><span class="hljs-class"><span class="hljs-class">boost::function_traits</span></span></code><span class="hljs-class"><span class="hljs-class">    </span></span><code><span class="hljs-class"><span class="hljs-class">mpl</span></span></code><span class="hljs-class"><span class="hljs-class"> :) </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">class </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vector</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pair</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value_type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">() : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">() , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">() { } bool parse(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wistringstream</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">read_xml</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xmlattr</span></span></span><span class="hljs-class">&gt;"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> || !</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class"> = *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reserve</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">()); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const_iterator</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">begin</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">; ++</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_value</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">""); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">") || (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">")) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } arguments_.push_back(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class">)); } return true; } catch(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml_parser_error</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parse_exc</span></span></span><span class="hljs-class">*/) { } catch(...) { } return false; } std::wstring function_name() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">; } size_t arguments_count() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">(); } const </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; arguments() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">; } private: std::wstring invoke_name_; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class"> arguments_; };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arithmetic</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">are</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">http</span></span></span><span class="hljs-class">://</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cppreference</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">w</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cpp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">language</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class">. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Need</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">exclude</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Character</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class"> // (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">has</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">and_</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_arithmetic</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unsigned</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">signed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">We</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">can</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">equivalent</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">only</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">above</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> number </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> from string to @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) static </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from_string</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TODO</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Use</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cast</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static_cast</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;bool&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> boolean value from string to our bool static bool convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">"); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;std::wstring&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">"; } static std::wstring convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nothing</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;void&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">.. </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">undefined</span></span></span><span class="hljs-class">"; } static void convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">*/) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Oops</span></span></span><span class="hljs-class">.. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Can</span></span></span><span class="hljs-class">'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">"); } }; // @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> provides implementation // only for "number" </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arithmetic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">characters</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">), bool, string and void. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> any other </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> will be empty. // decay is used for removing cv-qualifier. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">But</span></span></span><span class="hljs-class"> it's not what we want for arrays. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">That's</span></span></span><span class="hljs-class"> why using enable_if template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class"> : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt; typename std::tr1::decay&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">&gt; &gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> { }; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Partial</span></span></span><span class="hljs-class"> specialization for pointers // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">There</span></span></span><span class="hljs-class"> is no conversion from </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> to </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ pointer.. template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">*&gt; { // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">assert</span></span></span><span class="hljs-class"> };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,     - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> - </span></span><u><span class="hljs-class"><span class="hljs-class"> ....</span></span></u><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;int </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">N</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">*/, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Provide</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;0&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;1&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 1 arg f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;2&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 2 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;3&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 3 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;4&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[3]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 4 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) = 0; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> ~</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">() { } }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> : public </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">) { } bool call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remove_pointer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enum</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arity</span></span></span><span class="hljs-class"> }; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function name", false); </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_count</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function arguments count", false); return </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class">&gt;::template call&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">() #if defined(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , name_ #endif ); } protected: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> f_; std::wstring name_; }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">* </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CreateFunction</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">); }</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   ! </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UPD</span></span></span><span class="hljs-class">:</span></span></i><span class="hljs-class"><span class="hljs-class">   -   , , 14  () </span></span><a href="http://en.cppreference.com/w/cpp/utility/integer_sequence"><span class="hljs-class"><span class="hljs-class">std::make_index_sequence</span></span></a><span class="hljs-class"><span class="hljs-class"> ,     ,   </span></span><code><span class="hljs-class"><span class="hljs-class">generate_sequence</span></span></code><span class="hljs-class"><span class="hljs-class"> .</span></span></code> </pre> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> <pre> <code class="hljs haskell"><code class="cpp"><code><span class="hljs-title"><span class="hljs-title">generate_sequence</span></span>    <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ... <span class="hljs-type"><span class="hljs-type">N</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span></code> ,  (: <span class="hljs-string"><span class="hljs-string">" "</span></span>)   <code>sequence</code> .     <i><span class="hljs-type"><span class="hljs-type">Pack</span></span> expansion</i> (   <span class="hljs-string"><span class="hljs-string">" "</span></span>). <br> : <br>      <code>typename... <span class="hljs-type"><span class="hljs-type">Args</span></span></code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... <span class="hljs-type"><span class="hljs-type">Args</span></span>&gt; struct <span class="hljs-type"><span class="hljs-type">Test</span></span> { template&lt;int... <span class="hljs-type"><span class="hljs-type">S</span></span>&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;<span class="hljs-type"><span class="hljs-type">S</span></span>...&gt;) { f_(<span class="hljs-type"><span class="hljs-type">Type</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Args</span></span>&gt;::convert(args[<span class="hljs-type"><span class="hljs-type">S</span></span>].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(<span class="hljs-type"><span class="hljs-type">Args</span></span>)&gt;::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">())</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-class">test</span></span></code><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Args</span></span></span><span class="hljs-class"> = &lt;int, float&gt;</span></span></code><span class="hljs-class"><span class="hljs-class">   : </span></span><br><span class="hljs-class"><span class="hljs-class"> f_(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;float&gt;::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)) </span></span><br><span class="hljs-class"><span class="hljs-class">    ! </span></span><br><span class="hljs-class"><span class="hljs-class">  - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">::validate_types</span></span></code><span class="hljs-class"><span class="hljs-class">   .     </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++</span></span></i><span class="hljs-class"><span class="hljs-class"> -  </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ActionScript</span></span></span><span class="hljs-class">-</span></span></i><span class="hljs-class"><span class="hljs-class"> ,   -  ,   .     -     !     .     ! </span></span><br><span class="hljs-class"><span class="hljs-class">   - </span></span><code><span class="hljs-class"><span class="hljs-class">call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sequence</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class">...&gt;)</span></span></code><span class="hljs-class"><span class="hljs-class">  ,    ,    . </span></span><br><span class="hljs-class"><span class="hljs-class">  -   </span></span><code><span class="hljs-class"><span class="hljs-class">make_function()</span></span></code><span class="hljs-class"><span class="hljs-class">    ,      </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> ,      (   )        . </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,      ,         </span></span><code><span class="hljs-class"><span class="hljs-class">boost::function_traits</span></span></code><span class="hljs-class"><span class="hljs-class">    </span></span><code><span class="hljs-class"><span class="hljs-class">mpl</span></span></code><span class="hljs-class"><span class="hljs-class"> :) </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">class </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vector</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pair</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value_type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">() : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">() , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">() { } bool parse(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wistringstream</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">read_xml</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xmlattr</span></span></span><span class="hljs-class">&gt;"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> || !</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class"> = *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reserve</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">()); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const_iterator</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">begin</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">; ++</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_value</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">""); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">") || (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">")) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } arguments_.push_back(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class">)); } return true; } catch(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml_parser_error</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parse_exc</span></span></span><span class="hljs-class">*/) { } catch(...) { } return false; } std::wstring function_name() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">; } size_t arguments_count() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">(); } const </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; arguments() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">; } private: std::wstring invoke_name_; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class"> arguments_; };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arithmetic</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">are</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">http</span></span></span><span class="hljs-class">://</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cppreference</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">w</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cpp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">language</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class">. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Need</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">exclude</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Character</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class"> // (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">has</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">and_</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_arithmetic</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unsigned</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">signed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">We</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">can</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">equivalent</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">only</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">above</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> number </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> from string to @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) static </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from_string</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TODO</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Use</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cast</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static_cast</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;bool&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> boolean value from string to our bool static bool convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">"); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;std::wstring&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">"; } static std::wstring convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nothing</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;void&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">.. </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">undefined</span></span></span><span class="hljs-class">"; } static void convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">*/) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Oops</span></span></span><span class="hljs-class">.. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Can</span></span></span><span class="hljs-class">'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">"); } }; // @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> provides implementation // only for "number" </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arithmetic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">characters</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">), bool, string and void. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> any other </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> will be empty. // decay is used for removing cv-qualifier. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">But</span></span></span><span class="hljs-class"> it's not what we want for arrays. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">That's</span></span></span><span class="hljs-class"> why using enable_if template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class"> : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt; typename std::tr1::decay&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">&gt; &gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> { }; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Partial</span></span></span><span class="hljs-class"> specialization for pointers // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">There</span></span></span><span class="hljs-class"> is no conversion from </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> to </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ pointer.. template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">*&gt; { // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">assert</span></span></span><span class="hljs-class"> };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,     - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> - </span></span><u><span class="hljs-class"><span class="hljs-class"> ....</span></span></u><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;int </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">N</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">*/, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Provide</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;0&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;1&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 1 arg f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;2&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 2 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;3&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 3 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;4&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[3]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 4 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) = 0; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> ~</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">() { } }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> : public </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">) { } bool call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remove_pointer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enum</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arity</span></span></span><span class="hljs-class"> }; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function name", false); </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_count</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function arguments count", false); return </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class">&gt;::template call&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">() #if defined(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , name_ #endif ); } protected: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> f_; std::wstring name_; }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">* </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CreateFunction</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">); }</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   ! </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UPD</span></span></span><span class="hljs-class">:</span></span></i><span class="hljs-class"><span class="hljs-class">   -   , , 14  () </span></span><a href="http://en.cppreference.com/w/cpp/utility/integer_sequence"><span class="hljs-class"><span class="hljs-class">std::make_index_sequence</span></span></a><span class="hljs-class"><span class="hljs-class"> ,     ,   </span></span><code><span class="hljs-class"><span class="hljs-class">generate_sequence</span></span></code><span class="hljs-class"><span class="hljs-class"> .</span></span></code></code> </pre> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> <div class="spoiler"> <code><b class="spoiler_title"><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> InvokeParser <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</b></code> <div class="spoiler_text"> <pre> <code class="hljs haskell"><code><span class="hljs-title"><span class="hljs-title">generate_sequence</span></span>    <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ... <span class="hljs-type"><span class="hljs-type">N</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span></code> ,  (: <span class="hljs-string"><span class="hljs-string">" "</span></span>)   <code>sequence</code> .     <i><span class="hljs-type"><span class="hljs-type">Pack</span></span> expansion</i> (   <span class="hljs-string"><span class="hljs-string">" "</span></span>). <br> : <br>      <code>typename... <span class="hljs-type"><span class="hljs-type">Args</span></span></code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... <span class="hljs-type"><span class="hljs-type">Args</span></span>&gt; struct <span class="hljs-type"><span class="hljs-type">Test</span></span> { template&lt;int... <span class="hljs-type"><span class="hljs-type">S</span></span>&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;<span class="hljs-type"><span class="hljs-type">S</span></span>...&gt;) { f_(<span class="hljs-type"><span class="hljs-type">Type</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Args</span></span>&gt;::convert(args[<span class="hljs-type"><span class="hljs-type">S</span></span>].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(<span class="hljs-type"><span class="hljs-type">Args</span></span>)&gt;::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">())</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-class">test</span></span></code><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Args</span></span></span><span class="hljs-class"> = &lt;int, float&gt;</span></span></code><span class="hljs-class"><span class="hljs-class">   : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">f_(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;float&gt;::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">))</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    ! </span></span><br><span class="hljs-class"><span class="hljs-class">  - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">::validate_types</span></span></code><span class="hljs-class"><span class="hljs-class">   .     </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++</span></span></i><span class="hljs-class"><span class="hljs-class"> -  </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ActionScript</span></span></span><span class="hljs-class">-</span></span></i><span class="hljs-class"><span class="hljs-class"> ,   -  ,   .     -     !     .     ! </span></span><br><span class="hljs-class"><span class="hljs-class">   - </span></span><code><span class="hljs-class"><span class="hljs-class">call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sequence</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class">...&gt;)</span></span></code><span class="hljs-class"><span class="hljs-class">  ,    ,    . </span></span><br><span class="hljs-class"><span class="hljs-class">  -   </span></span><code><span class="hljs-class"><span class="hljs-class">make_function()</span></span></code><span class="hljs-class"><span class="hljs-class">    ,      </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> ,      (   )        . </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,      ,         </span></span><code><span class="hljs-class"><span class="hljs-class">boost::function_traits</span></span></code><span class="hljs-class"><span class="hljs-class">    </span></span><code><span class="hljs-class"><span class="hljs-class">mpl</span></span></code><span class="hljs-class"><span class="hljs-class"> :) </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">class </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vector</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pair</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value_type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">() : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">() , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">() { } bool parse(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wistringstream</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">read_xml</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xmlattr</span></span></span><span class="hljs-class">&gt;"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> || !</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class"> = *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reserve</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">()); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const_iterator</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">begin</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">; ++</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_value</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">""); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">") || (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">")) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } arguments_.push_back(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class">)); } return true; } catch(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml_parser_error</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parse_exc</span></span></span><span class="hljs-class">*/) { } catch(...) { } return false; } std::wstring function_name() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">; } size_t arguments_count() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">(); } const </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; arguments() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">; } private: std::wstring invoke_name_; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class"> arguments_; };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arithmetic</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">are</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">http</span></span></span><span class="hljs-class">://</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cppreference</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">w</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cpp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">language</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class">. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Need</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">exclude</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Character</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class"> // (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">has</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">and_</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_arithmetic</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unsigned</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">signed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">We</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">can</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">equivalent</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">only</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">above</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> number </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> from string to @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) static </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from_string</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TODO</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Use</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cast</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static_cast</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;bool&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> boolean value from string to our bool static bool convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">"); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;std::wstring&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">"; } static std::wstring convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nothing</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;void&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">.. </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">undefined</span></span></span><span class="hljs-class">"; } static void convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">*/) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Oops</span></span></span><span class="hljs-class">.. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Can</span></span></span><span class="hljs-class">'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">"); } }; // @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> provides implementation // only for "number" </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arithmetic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">characters</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">), bool, string and void. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> any other </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> will be empty. // decay is used for removing cv-qualifier. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">But</span></span></span><span class="hljs-class"> it's not what we want for arrays. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">That's</span></span></span><span class="hljs-class"> why using enable_if template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class"> : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt; typename std::tr1::decay&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">&gt; &gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> { }; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Partial</span></span></span><span class="hljs-class"> specialization for pointers // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">There</span></span></span><span class="hljs-class"> is no conversion from </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> to </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ pointer.. template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">*&gt; { // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">assert</span></span></span><span class="hljs-class"> };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,     - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> - </span></span><u><span class="hljs-class"><span class="hljs-class"> ....</span></span></u><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;int </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">N</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">*/, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Provide</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;0&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;1&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 1 arg f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;2&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 2 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;3&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 3 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;4&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[3]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 4 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) = 0; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> ~</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">() { } }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> : public </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">) { } bool call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remove_pointer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enum</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arity</span></span></span><span class="hljs-class"> }; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function name", false); </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_count</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function arguments count", false); return </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class">&gt;::template call&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">() #if defined(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , name_ #endif ); } protected: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> f_; std::wstring name_; }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">* </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CreateFunction</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">); }</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   ! </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UPD</span></span></span><span class="hljs-class">:</span></span></i><span class="hljs-class"><span class="hljs-class">   -   , , 14  () </span></span><a href="http://en.cppreference.com/w/cpp/utility/integer_sequence"><span class="hljs-class"><span class="hljs-class">std::make_index_sequence</span></span></a><span class="hljs-class"><span class="hljs-class"> ,     ,   </span></span><code><span class="hljs-class"><span class="hljs-class">generate_sequence</span></span></code><span class="hljs-class"><span class="hljs-class"> .</span></span></code> </pre> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> </div></div> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> <div class="spoiler"> <code><b class="spoiler_title"><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> TypeHelper <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</b></code> <div class="spoiler_text"> <pre> <code class="hljs haskell"><code><span class="hljs-title"><span class="hljs-title">generate_sequence</span></span>    <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ... <span class="hljs-type"><span class="hljs-type">N</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span></code> ,  (: <span class="hljs-string"><span class="hljs-string">" "</span></span>)   <code>sequence</code> .     <i><span class="hljs-type"><span class="hljs-type">Pack</span></span> expansion</i> (   <span class="hljs-string"><span class="hljs-string">" "</span></span>). <br> : <br>      <code>typename... <span class="hljs-type"><span class="hljs-type">Args</span></span></code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... <span class="hljs-type"><span class="hljs-type">Args</span></span>&gt; struct <span class="hljs-type"><span class="hljs-type">Test</span></span> { template&lt;int... <span class="hljs-type"><span class="hljs-type">S</span></span>&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;<span class="hljs-type"><span class="hljs-type">S</span></span>...&gt;) { f_(<span class="hljs-type"><span class="hljs-type">Type</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Args</span></span>&gt;::convert(args[<span class="hljs-type"><span class="hljs-type">S</span></span>].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(<span class="hljs-type"><span class="hljs-type">Args</span></span>)&gt;::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">())</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-class">test</span></span></code><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Args</span></span></span><span class="hljs-class"> = &lt;int, float&gt;</span></span></code><span class="hljs-class"><span class="hljs-class">   : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">f_(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;float&gt;::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">))</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    ! </span></span><br><span class="hljs-class"><span class="hljs-class">  - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">::validate_types</span></span></code><span class="hljs-class"><span class="hljs-class">   .     </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++</span></span></i><span class="hljs-class"><span class="hljs-class"> -  </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ActionScript</span></span></span><span class="hljs-class">-</span></span></i><span class="hljs-class"><span class="hljs-class"> ,   -  ,   .     -     !     .     ! </span></span><br><span class="hljs-class"><span class="hljs-class">   - </span></span><code><span class="hljs-class"><span class="hljs-class">call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sequence</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class">...&gt;)</span></span></code><span class="hljs-class"><span class="hljs-class">  ,    ,    . </span></span><br><span class="hljs-class"><span class="hljs-class">  -   </span></span><code><span class="hljs-class"><span class="hljs-class">make_function()</span></span></code><span class="hljs-class"><span class="hljs-class">    ,      </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> ,      (   )        . </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,      ,         </span></span><code><span class="hljs-class"><span class="hljs-class">boost::function_traits</span></span></code><span class="hljs-class"><span class="hljs-class">    </span></span><code><span class="hljs-class"><span class="hljs-class">mpl</span></span></code><span class="hljs-class"><span class="hljs-class"> :) </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">class </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vector</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pair</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value_type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">() : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">() , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">() { } bool parse(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wistringstream</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">read_xml</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xmlattr</span></span></span><span class="hljs-class">&gt;"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> || !</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class"> = *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reserve</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">()); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const_iterator</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">begin</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">; ++</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_value</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">""); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">") || (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">")) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } arguments_.push_back(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class">)); } return true; } catch(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml_parser_error</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parse_exc</span></span></span><span class="hljs-class">*/) { } catch(...) { } return false; } std::wstring function_name() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">; } size_t arguments_count() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">(); } const </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; arguments() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">; } private: std::wstring invoke_name_; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class"> arguments_; };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arithmetic</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">are</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">http</span></span></span><span class="hljs-class">://</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cppreference</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">w</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cpp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">language</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class">. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Need</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">exclude</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Character</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class"> // (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">has</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">and_</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_arithmetic</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unsigned</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">signed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">We</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">can</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">equivalent</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">only</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">above</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> number </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> from string to @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) static </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from_string</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TODO</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Use</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cast</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static_cast</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;bool&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> boolean value from string to our bool static bool convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">"); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;std::wstring&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">"; } static std::wstring convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nothing</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;void&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">.. </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">undefined</span></span></span><span class="hljs-class">"; } static void convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">*/) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Oops</span></span></span><span class="hljs-class">.. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Can</span></span></span><span class="hljs-class">'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">"); } }; // @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> provides implementation // only for "number" </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arithmetic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">characters</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">), bool, string and void. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> any other </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> will be empty. // decay is used for removing cv-qualifier. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">But</span></span></span><span class="hljs-class"> it's not what we want for arrays. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">That's</span></span></span><span class="hljs-class"> why using enable_if template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class"> : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt; typename std::tr1::decay&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">&gt; &gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> { }; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Partial</span></span></span><span class="hljs-class"> specialization for pointers // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">There</span></span></span><span class="hljs-class"> is no conversion from </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> to </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ pointer.. template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">*&gt; { // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">assert</span></span></span><span class="hljs-class"> };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,     - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> - </span></span><u><span class="hljs-class"><span class="hljs-class"> ....</span></span></u><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;int </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">N</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">*/, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Provide</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;0&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;1&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 1 arg f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;2&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 2 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;3&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 3 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;4&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[3]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 4 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) = 0; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> ~</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">() { } }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> : public </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">) { } bool call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remove_pointer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enum</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arity</span></span></span><span class="hljs-class"> }; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function name", false); </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_count</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function arguments count", false); return </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class">&gt;::template call&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">() #if defined(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , name_ #endif ); } protected: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> f_; std::wstring name_; }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">* </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CreateFunction</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">); }</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   ! </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UPD</span></span></span><span class="hljs-class">:</span></span></i><span class="hljs-class"><span class="hljs-class">   -   , , 14  () </span></span><a href="http://en.cppreference.com/w/cpp/utility/integer_sequence"><span class="hljs-class"><span class="hljs-class">std::make_index_sequence</span></span></a><span class="hljs-class"><span class="hljs-class"> ,     ,   </span></span><code><span class="hljs-class"><span class="hljs-class">generate_sequence</span></span></code><span class="hljs-class"><span class="hljs-class"> .</span></span></code> </pre> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> </div></div> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> <div class="spoiler"> <code><b class="spoiler_title"><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> FunctionCaller <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</b></code> <div class="spoiler_text"> <pre> <code class="hljs haskell"><code><span class="hljs-title"><span class="hljs-title">generate_sequence</span></span>    <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ... <span class="hljs-type"><span class="hljs-type">N</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span></code> ,  (: <span class="hljs-string"><span class="hljs-string">" "</span></span>)   <code>sequence</code> .     <i><span class="hljs-type"><span class="hljs-type">Pack</span></span> expansion</i> (   <span class="hljs-string"><span class="hljs-string">" "</span></span>). <br> : <br>      <code>typename... <span class="hljs-type"><span class="hljs-type">Args</span></span></code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... <span class="hljs-type"><span class="hljs-type">Args</span></span>&gt; struct <span class="hljs-type"><span class="hljs-type">Test</span></span> { template&lt;int... <span class="hljs-type"><span class="hljs-type">S</span></span>&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;<span class="hljs-type"><span class="hljs-type">S</span></span>...&gt;) { f_(<span class="hljs-type"><span class="hljs-type">Type</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Args</span></span>&gt;::convert(args[<span class="hljs-type"><span class="hljs-type">S</span></span>].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(<span class="hljs-type"><span class="hljs-type">Args</span></span>)&gt;::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">())</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-class">test</span></span></code><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Args</span></span></span><span class="hljs-class"> = &lt;int, float&gt;</span></span></code><span class="hljs-class"><span class="hljs-class">   : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">f_(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;float&gt;::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">))</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    ! </span></span><br><span class="hljs-class"><span class="hljs-class">  - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">::validate_types</span></span></code><span class="hljs-class"><span class="hljs-class">   .     </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++</span></span></i><span class="hljs-class"><span class="hljs-class"> -  </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ActionScript</span></span></span><span class="hljs-class">-</span></span></i><span class="hljs-class"><span class="hljs-class"> ,   -  ,   .     -     !     .     ! </span></span><br><span class="hljs-class"><span class="hljs-class">   - </span></span><code><span class="hljs-class"><span class="hljs-class">call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sequence</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class">...&gt;)</span></span></code><span class="hljs-class"><span class="hljs-class">  ,    ,    . </span></span><br><span class="hljs-class"><span class="hljs-class">  -   </span></span><code><span class="hljs-class"><span class="hljs-class">make_function()</span></span></code><span class="hljs-class"><span class="hljs-class">    ,      </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> ,      (   )        . </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,      ,         </span></span><code><span class="hljs-class"><span class="hljs-class">boost::function_traits</span></span></code><span class="hljs-class"><span class="hljs-class">    </span></span><code><span class="hljs-class"><span class="hljs-class">mpl</span></span></code><span class="hljs-class"><span class="hljs-class"> :) </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">class </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vector</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pair</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value_type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">() : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">() , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">() { } bool parse(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wistringstream</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">read_xml</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xmlattr</span></span></span><span class="hljs-class">&gt;"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> || !</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class"> = *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reserve</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">()); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const_iterator</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">begin</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">; ++</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_value</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">""); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">") || (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">")) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } arguments_.push_back(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class">)); } return true; } catch(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml_parser_error</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parse_exc</span></span></span><span class="hljs-class">*/) { } catch(...) { } return false; } std::wstring function_name() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">; } size_t arguments_count() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">(); } const </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; arguments() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">; } private: std::wstring invoke_name_; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class"> arguments_; };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arithmetic</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">are</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">http</span></span></span><span class="hljs-class">://</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cppreference</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">w</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cpp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">language</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class">. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Need</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">exclude</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Character</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class"> // (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">has</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">and_</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_arithmetic</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unsigned</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">signed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">We</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">can</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">equivalent</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">only</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">above</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> number </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> from string to @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) static </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from_string</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TODO</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Use</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cast</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static_cast</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;bool&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> boolean value from string to our bool static bool convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">"); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;std::wstring&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">"; } static std::wstring convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nothing</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;void&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">.. </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">undefined</span></span></span><span class="hljs-class">"; } static void convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">*/) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Oops</span></span></span><span class="hljs-class">.. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Can</span></span></span><span class="hljs-class">'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">"); } }; // @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> provides implementation // only for "number" </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arithmetic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">characters</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">), bool, string and void. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> any other </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> will be empty. // decay is used for removing cv-qualifier. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">But</span></span></span><span class="hljs-class"> it's not what we want for arrays. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">That's</span></span></span><span class="hljs-class"> why using enable_if template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class"> : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt; typename std::tr1::decay&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">&gt; &gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> { }; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Partial</span></span></span><span class="hljs-class"> specialization for pointers // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">There</span></span></span><span class="hljs-class"> is no conversion from </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> to </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ pointer.. template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">*&gt; { // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">assert</span></span></span><span class="hljs-class"> };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,     - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> - </span></span><u><span class="hljs-class"><span class="hljs-class"> ....</span></span></u><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;int </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">N</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">*/, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Provide</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;0&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;1&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 1 arg f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;2&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 2 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;3&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 3 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;4&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[3]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 4 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) = 0; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> ~</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">() { } }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> : public </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">) { } bool call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remove_pointer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enum</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arity</span></span></span><span class="hljs-class"> }; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function name", false); </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_count</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function arguments count", false); return </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class">&gt;::template call&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">() #if defined(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , name_ #endif ); } protected: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> f_; std::wstring name_; }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">* </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CreateFunction</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">); }</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   ! </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UPD</span></span></span><span class="hljs-class">:</span></span></i><span class="hljs-class"><span class="hljs-class">   -   , , 14  () </span></span><a href="http://en.cppreference.com/w/cpp/utility/integer_sequence"><span class="hljs-class"><span class="hljs-class">std::make_index_sequence</span></span></a><span class="hljs-class"><span class="hljs-class"> ,     ,   </span></span><code><span class="hljs-class"><span class="hljs-class">generate_sequence</span></span></code><span class="hljs-class"><span class="hljs-class"> .</span></span></code> </pre> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> </div></div> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> <div class="spoiler"> <code><b class="spoiler_title"><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> Function <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</b></code> <div class="spoiler_text"> <pre> <code class="hljs haskell"><code><span class="hljs-title"><span class="hljs-title">generate_sequence</span></span>    <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ... <span class="hljs-type"><span class="hljs-type">N</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span></code> ,  (: <span class="hljs-string"><span class="hljs-string">" "</span></span>)   <code>sequence</code> .     <i><span class="hljs-type"><span class="hljs-type">Pack</span></span> expansion</i> (   <span class="hljs-string"><span class="hljs-string">" "</span></span>). <br> : <br>      <code>typename... <span class="hljs-type"><span class="hljs-type">Args</span></span></code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... <span class="hljs-type"><span class="hljs-type">Args</span></span>&gt; struct <span class="hljs-type"><span class="hljs-type">Test</span></span> { template&lt;int... <span class="hljs-type"><span class="hljs-type">S</span></span>&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;<span class="hljs-type"><span class="hljs-type">S</span></span>...&gt;) { f_(<span class="hljs-type"><span class="hljs-type">Type</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Args</span></span>&gt;::convert(args[<span class="hljs-type"><span class="hljs-type">S</span></span>].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(<span class="hljs-type"><span class="hljs-type">Args</span></span>)&gt;::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">())</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-class">test</span></span></code><span class="hljs-class"><span class="hljs-class">  </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Args</span></span></span><span class="hljs-class"> = &lt;int, float&gt;</span></span></code><span class="hljs-class"><span class="hljs-class">   : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">f_(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&lt;float&gt;::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">))</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">    ! </span></span><br><span class="hljs-class"><span class="hljs-class">  - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">::validate_types</span></span></code><span class="hljs-class"><span class="hljs-class">   .     </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++</span></span></i><span class="hljs-class"><span class="hljs-class"> -  </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ActionScript</span></span></span><span class="hljs-class">-</span></span></i><span class="hljs-class"><span class="hljs-class"> ,   -  ,   .     -     !     .     ! </span></span><br><span class="hljs-class"><span class="hljs-class">   - </span></span><code><span class="hljs-class"><span class="hljs-class">call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sequence</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class">...&gt;)</span></span></code><span class="hljs-class"><span class="hljs-class">  ,    ,    . </span></span><br><span class="hljs-class"><span class="hljs-class">  -   </span></span><code><span class="hljs-class"><span class="hljs-class">make_function()</span></span></code><span class="hljs-class"><span class="hljs-class">    ,      </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> ,      (   )        . </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,      ,         </span></span><code><span class="hljs-class"><span class="hljs-class">boost::function_traits</span></span></code><span class="hljs-class"><span class="hljs-class">    </span></span><code><span class="hljs-class"><span class="hljs-class">mpl</span></span></code><span class="hljs-class"><span class="hljs-class"> :) </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">class </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vector</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pair</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value_type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">() : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">() , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">() { } bool parse(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namespace</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wistringstream</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">read_xml</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stream</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xmlattr</span></span></span><span class="hljs-class">&gt;"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">&amp;&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_child_optional</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class"> || !</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_attribs</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_optional</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">"); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class"> = *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reserve</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">()); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wptree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const_iterator</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">begin</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_xml</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class"> != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">; ++</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value_pair</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_value</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">""); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">") || (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">")) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } arguments_.push_back(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg_value</span></span></span><span class="hljs-class">)); } return true; } catch(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property_tree</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml_parser_error</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parse_exc</span></span></span><span class="hljs-class">*/) { } catch(...) { } return false; } std::wstring function_name() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">invoke_name_</span></span></span><span class="hljs-class">; } size_t arguments_count() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">size</span></span></span><span class="hljs-class">(); } const </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; arguments() const { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_</span></span></span><span class="hljs-class">; } private: std::wstring invoke_name_; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class"> arguments_; };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arithmetic</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">are</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">http</span></span></span><span class="hljs-class">://</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">en</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cppreference</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">w</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cpp</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">language</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types</span></span></span><span class="hljs-class">. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Need</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">exclude</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Character</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">types'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class"> // (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type'</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">has</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">and_</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_arithmetic</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unsigned</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mpl</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not_</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is_same</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">signed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">char</span></span></span><span class="hljs-class">&gt; &gt; &gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class">: // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">We</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">can</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">equivalent</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">only</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">above</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Get</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enable_if</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> number </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> from string to @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">see</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ValidCppType</span></span></span><span class="hljs-class">) static </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from_string</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">double</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">); // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TODO</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Use</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cast</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static_cast</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;bool&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boolean</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class">"; } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Convert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> boolean value from string to our bool static bool convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class"> == </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">"); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;std::wstring&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">"; } static std::wstring convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nothing</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt;void&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class">; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">.. </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">undefined</span></span></span><span class="hljs-class">"; } static void convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">str</span></span></span><span class="hljs-class">*/) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Oops</span></span></span><span class="hljs-class">.. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Can</span></span></span><span class="hljs-class">'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sring</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">"); } }; // @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> provides implementation // only for "number" </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arithmetic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">characters</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">), bool, string and void. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">For</span></span></span><span class="hljs-class"> any other </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class"> will be empty. // decay is used for removing cv-qualifier. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">But</span></span></span><span class="hljs-class"> it's not what we want for arrays. // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">That's</span></span></span><span class="hljs-class"> why using enable_if template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class"> : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; &gt;, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeHelper</span></span></span><span class="hljs-class">&lt; typename std::tr1::decay&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class">&gt; &gt;::</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> { }; // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Partial</span></span></span><span class="hljs-class"> specialization for pointers // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">There</span></span></span><span class="hljs-class"> is no conversion from </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AS3</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> to </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">++ pointer.. template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CppType</span></span></span><span class="hljs-class">*&gt; { // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">assert</span></span></span><span class="hljs-class"> };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> ,     - </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> - </span></span><u><span class="hljs-class"><span class="hljs-class"> ....</span></span></u><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">template&lt;int </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">N</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">*/, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Provide</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">full</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">specialization</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">given</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;0&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; /*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">*/ #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">without</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">(); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;1&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 1 arg f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;2&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 2 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;3&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 3 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } }; template&lt;&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;4&gt; { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsContainer</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class"> #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> ) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlashType</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4_type</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[0]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[1]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[2]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TypeValuePair</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">[3]; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">((</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">) || (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">() != </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">)) { #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">defined</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) ::</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OutputDebugStringW</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Sprintf</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wchar_t</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">: \"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\":\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">" </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class">"%</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class"> -&gt; %</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dbg_function_name</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">(), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">first</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">c_str</span></span></span><span class="hljs-class">()); #</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">, "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatch</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">); } // </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Call</span></span></span><span class="hljs-class"> function with 4 args f(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg1</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">convert</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg1</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg2</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg2</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg3</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg3</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Arg4</span></span></span><span class="hljs-class">::convert(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arg4</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">second</span></span></span><span class="hljs-class">)); return true; } };</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   </span></span><code><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></code><span class="hljs-class"><span class="hljs-class"> : </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><b class="spoiler_title"><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span></span></b><span class="hljs-class"><span class="hljs-class"> </span></span><code class="cpp"><span class="hljs-class"><span class="hljs-class">struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) = 0; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">virtual</span></span></span><span class="hljs-class"> ~</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">() { } }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; struct </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class"> : public </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">) { } bool call(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">InvokeParser</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typedef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remove_pointer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enum</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">boost</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_traits</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arity</span></span></span><span class="hljs-class"> }; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name_</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function_name</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function name", false); </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ASSERT_MESSAGE_AND_RETURN_VALUE</span></span></span><span class="hljs-class">( </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class"> == </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments_count</span></span></span><span class="hljs-class">(), "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Incorrect</span></span></span><span class="hljs-class"> function arguments count", false); return </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionCaller</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ArgsCount</span></span></span><span class="hljs-class">&gt;::template call&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionType</span></span></span><span class="hljs-class">&gt;( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f_</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parser</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">() #if defined(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DEBUG</span></span></span><span class="hljs-class">) , name_ #endif ); } protected: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> f_; std::wstring name_; }; template&lt;typename </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IFunction</span></span></span><span class="hljs-class">* </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CreateFunction</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wstring</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Function</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FunctionPointer</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">); }</span></span></code><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class">   ! </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><br><span class="hljs-class"><span class="hljs-class"> </span></span><i><span class="hljs-class"><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UPD</span></span></span><span class="hljs-class">:</span></span></i><span class="hljs-class"><span class="hljs-class">   -   , , 14  () </span></span><a href="http://en.cppreference.com/w/cpp/utility/integer_sequence"><span class="hljs-class"><span class="hljs-class">std::make_index_sequence</span></span></a><span class="hljs-class"><span class="hljs-class"> ,     ,   </span></span><code><span class="hljs-class"><span class="hljs-class">generate_sequence</span></span></code><span class="hljs-class"><span class="hljs-class"> .</span></span></code> </pre> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> </div></div> <code><code>generate_sequence    0, 1, 2, ... N - 1</code> ,  (: " ")   <code>sequence</code> .     <i>Pack expansion</i> (   " "). <br> : <br>      <code>typename... Args</code>   <code>f</code> .    <code>f</code> ,      ,       <code>f</code> : <br> <code class="cpp">template&lt;typename... Args&gt; struct Test { template&lt;int... S&gt; static bool test(const std::vector&lt;pair&lt;int, float&gt;&gt;&amp; args, sequence&lt;S...&gt;) { f_(Type&lt;Args&gt;::convert(args[S].second)...); return true; } }; // -   test(args, typename generate_sequence&lt;sizeof...(Args)&gt;::type())</code> <br>  <code>test</code>  <code>Args = &lt;int, float&gt;</code>   : <br> <code class="cpp">f_(Type&lt;int&gt;::convert(args[0].second), Type&lt;float&gt;::convert(args[1].second))</code> <br>    ! <br>  - <code>Function::validate_types</code>   .     <i>C++</i> -  <i>ActionScript-</i> ,   -  ,   .     -     !     .     ! <br>   - <code>call(const InvokeParser::ArgsContainer&amp; args, sequence&lt;S...&gt;)</code>  ,    ,    . <br>  -   <code>make_function()</code>    ,      <code>IFunction</code> ,      (   )        . <br> <br> ,      ,         <code>boost::function_traits</code>    <code>mpl</code> :) <br> <br> <b class="spoiler_title">InvokeParser</b> <code class="cpp">class InvokeParser { public: typedef std::vector&lt;std::pair&lt;std::wstring, std::wstring&gt; &gt; ArgsContainer; typedef ArgsContainer::value_type TypeValuePair; public: InvokeParser() : invoke_name_() , arguments_() { } bool parse(const std::wstring&amp; str) { using namespace boost; using namespace boost::property_tree; try { std::wistringstream stream(str); wptree xml; read_xml(stream, xml); optional&lt;wptree&amp;&gt; invoke_attribs = xml.get_child_optional(L"invoke.&lt;xmlattr&gt;"); optional&lt;wptree&amp;&gt; arguments_xml = xml.get_child_optional(L"invoke.arguments"); if(!invoke_attribs || !arguments_xml) return false; optional&lt;std::wstring&gt; name = invoke_attribs-&gt;get_optional&lt;std::wstring&gt;(L"name"); if(!name) return false; invoke_name_ = *name; arguments_.reserve(arguments_xml-&gt;size()); for(wptree::const_iterator arg_value_pair = arguments_xml-&gt;begin(), end = arguments_xml-&gt;end(); arg_value_pair != end; ++arg_value_pair) { std::wstring arg_type = arg_value_pair-&gt;first; std::wstring arg_value = arg_value_pair-&gt;second.get_value(L""); if((arg_type == L"true") || (arg_type == L"false")) { arg_value = arg_type; arg_type = L"bool"; } arguments_.push_back(TypeValuePair(arg_type, arg_value)); } return true; } catch(const boost::property_tree::xml_parser_error&amp; /*parse_exc*/) { } catch(...) { } return false; } std::wstring function_name() const { return invoke_name_; } size_t arguments_count() const { return arguments_.size(); } const ArgsContainer&amp; arguments() const { return arguments_; } private: std::wstring invoke_name_; ArgsContainer arguments_; };</code> <br> <br> <b class="spoiler_title">TypeHelper</b> <code class="cpp">template&lt;typename CppType&gt; struct TypeHelper { private: // Arithmetic types are http://en.cppreference.com/w/cpp/language/types. // Need to exclude 'Character types' from this list // (For 'Boolean type' this template has full specialization) typedef boost::mpl::and_&lt; boost::is_arithmetic&lt;CppType&gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, wchar_t&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, unsigned char&gt; &gt;, boost::mpl::not_&lt;boost::is_same&lt;CppType, signed char&gt; &gt; &gt; ValidCppType; public: // We can get C++ type name equivalent for AS3 "number" type only if // C++ type @CppType is @ValidCppType(see above) typedef typename boost::enable_if&lt; ValidCppType, CppType&gt;::type Type; // Get AS3 type name for given @CppType(see @ValidCppType) static typename boost::enable_if&lt; ValidCppType, std::wstring&gt;::type name() { return L"number"; } // Convert AS3 number type from string to @CppType(see @ValidCppType) static Type convert(const std::wstring&amp; str) { double value = from_string&lt;wchar_t, double&gt;(str); // TODO: Use boost type cast return static_cast&lt;Type&gt;(value); } }; template&lt;&gt; struct TypeHelper&lt;bool&gt; { typedef bool Type; // AS3 type name for boolean type static std::wstring name() { return L"bool"; } // Convert AS3 boolean value from string to our bool static bool convert(const std::wstring&amp; str) { return (str == L"true"); } }; template&lt;&gt; struct TypeHelper&lt;std::wstring&gt; { typedef std::wstring Type; static std::wstring name() { return L"string"; } static std::wstring convert(const std::wstring&amp; str) { // Ok, do nothing return str; } }; template&lt;&gt; struct TypeHelper&lt;void&gt; { typedef void Type; // AS3 type name for void type.. static std::wstring name() { return L"undefined"; } static void convert(const std::wstring&amp; /*str*/) { // Oops.. ASSERT_MESSAGE(false, "Can't convert from sring to void"); } }; // @TypeHelper provides implementation // only for "number" type(arithmetic, without characters type), bool, string and void. // For any other type @TypeHelper will be empty. // decay is used for removing cv-qualifier. But it's not what we want for arrays. // That's why using enable_if template&lt;typename CppType&gt; struct FlashType : boost::enable_if&lt; boost::mpl::not_&lt; boost::is_array&lt;CppType&gt; &gt;, TypeHelper&lt; typename std::tr1::decay&lt;CppType&gt;::type&gt; &gt;::type { }; // Partial specialization for pointers // There is no conversion from AS3 type to C++ pointer.. template&lt;typename CppType&gt; struct FlashType&lt;CppType*&gt; { // static assert };</code> <br> <br> <br> ,     - <code>FunctionCaller</code> - <u> ....</u> : <br> <b class="spoiler_title">FunctionCaller</b> <code class="cpp">template&lt;int N&gt; struct FunctionCaller { template&lt;typename Function&gt; static bool call(Function /*f*/, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { ASSERT_MESSAGE_AND_RETURN_VALUE( false, "Provide full FunctionCaller specialization for given arguments count", false); } }; template&lt;&gt; struct FunctionCaller&lt;0&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; /*args*/ #if defined(DEBUG) , const std::wstring&amp; /*dbg_function_name*/ #endif ) { // Call function without args f(); return true; } }; template&lt;&gt; struct FunctionCaller&lt;1&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; const InvokeParser::TypeValuePair&amp; arg = args[0]; if(Arg1::name() != arg.first) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 1 arg f(Arg1::convert(arg.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;2&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 2 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;3&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 3 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second)); return true; } }; template&lt;&gt; struct FunctionCaller&lt;4&gt; { template&lt;typename Function&gt; static bool call(Function f, const InvokeParser::ArgsContainer&amp; args #if defined(DEBUG) , const std::wstring&amp; dbg_function_name #endif ) { typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg1_type&gt; Arg1; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg2_type&gt; Arg2; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg3_type&gt; Arg3; typedef FlashType&lt;typename boost::function_traits&lt;Function&gt;::arg4_type&gt; Arg4; const InvokeParser::TypeValuePair&amp; arg1 = args[0]; const InvokeParser::TypeValuePair&amp; arg2 = args[1]; const InvokeParser::TypeValuePair&amp; arg3 = args[2]; const InvokeParser::TypeValuePair&amp; arg4 = args[3]; if((Arg1::name() != arg1.first) || (Arg2::name() != arg2.first) || (Arg3::name() != arg3.first) || (Arg4::name() != arg4.first)) { #if defined(DEBUG) ::OutputDebugStringW(Sprintf&lt;wchar_t&gt;( L"Function: \"%s\":\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n" L"%s -&gt; %s\n", dbg_function_name.c_str(), Arg1::name().c_str(), arg1.first.c_str(), Arg2::name().c_str(), arg2.first.c_str(), Arg3::name().c_str(), arg3.first.c_str(), Arg4::name().c_str(), arg4.first.c_str()).c_str()); #endif ASSERT_MESSAGE_AND_RETURN_VALUE(false, "Type mismatch", false); } // Call function with 4 args f(Arg1::convert(arg1.second), Arg2::convert(arg2.second), Arg3::convert(arg3.second), Arg4::convert(arg4.second)); return true; } };</code> <br> <br> <br>   <code>Function</code> : <br> <b class="spoiler_title">Function</b> <code class="cpp">struct IFunction { virtual bool call(const InvokeParser&amp; parser) = 0; virtual ~IFunction() { } }; template&lt;typename FunctionPointer&gt; struct Function : public IFunction { Function(const std::wstring&amp; function_name, FunctionPointer f) : f_(f) , name_(function_name) { } bool call(const InvokeParser&amp; parser) { typedef typename boost::remove_pointer&lt;FunctionPointer&gt;::type FunctionType; enum { ArgsCount = boost::function_traits&lt;FunctionType&gt;::arity }; ASSERT_MESSAGE_AND_RETURN_VALUE( name_ == parser.function_name(), "Incorrect function name", false); ASSERT_MESSAGE_AND_RETURN_VALUE( ArgsCount == parser.arguments_count(), "Incorrect function arguments count", false); return FunctionCaller&lt;ArgsCount&gt;::template call&lt;FunctionType&gt;( f_, parser.arguments() #if defined(DEBUG) , name_ #endif ); } protected: FunctionPointer f_; std::wstring name_; }; template&lt;typename FunctionPointer&gt; IFunction* CreateFunction(const std::wstring&amp; name, FunctionPointer f) { return new Function&lt;FunctionPointer&gt;(name, f); }</code> <br> <br> <br>   ! <br> <br> <i>UPD:</i>   -   , , 14  () <a href="http://en.cppreference.com/w/cpp/utility/integer_sequence">std::make_index_sequence</a> ,     ,   <code>generate_sequence</code> .</code> </div><p>Source: <a href="https://habr.com/ru/post/223865/">https://habr.com/ru/post/223865/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../223853/index.html">Home Security System</a></li>
<li><a href="../223857/index.html">Production of key components ITER has begun.</a></li>
<li><a href="../22386/index.html">Apple, Steve Jobs and rental housing</a></li>
<li><a href="../223861/index.html">GOkey: data cable, battery, USB flash drive and key detector in one bottle</a></li>
<li><a href="../223863/index.html">Comparing Azure Queues and Service Bus Queues services</a></li>
<li><a href="../223867/index.html">Vibrating Insoles - wearable technology that you did not expect. (concept)</a></li>
<li><a href="../223869/index.html">MBLOK Wireless Storage on Kickstarter</a></li>
<li><a href="../22387/index.html">Toshiba's cute and intelligent robot ApriPoko</a></li>
<li><a href="../223871/index.html">IBM specialists have discovered a new class of durable self-healing polymers</a></li>
<li><a href="../223873/index.html">Distribution of scientific software. Is free</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>