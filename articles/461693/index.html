<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cross-compiling OpenCV 4 for Raspberry Pi and BeagleBone Black</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. 

 When I wanted to install OpenCV on my raspberry for one project, I was very disappointed with the result. It turned out that for new version...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cross-compiling OpenCV 4 for Raspberry Pi and BeagleBone Black</h1><div class="post__text post__text-html js-mediator-article">  Hello. <br><br>  When I wanted to install OpenCV on my raspberry for one project, I was very disappointed with the result.  It turned out that for new versions of Raspbian images with support for Python3.7 it is impossible to install the library from the repository with the familiar pip install command. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">The reasons</b> <div class="spoiler_text">  pip install opencv-python returned an unexpected result for me: "Could not find a version that satisfies the requirement ...".  Just recently, in this way I installed this library on my main computer, and the result was positive. <br><br>  When I double-checked myself for curvature and made sure that I was still able to correctly type a command of 25 characters without typos, it was time to find out what else could affect the result. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The official opencv-python page at pypi.org has clarified a lot: <br><blockquote>  ... Note that the wheel (especially manylinux) format does not currently support properly ARM architecture so there are no packages for ARM based platforms in PyPI.  However, opencv-python packages for Raspberry Pi can be found from <a href="https://www.piwheels.org/">www.piwheels.org</a> . <br><br>  <i>... Please note that the wheel format (especially manylinux) currently does not properly support the ARM architecture, so PyPI does not have packages for ARM-based platforms.</i>  <i>However, opencv-python packages for the Raspberry Pi can be found at <a href="https://www.piwheels.org/">www.piwheels.org</a> .</i> <br></blockquote>  Ok ... <br><br>  I checked that raspberry was pulling packets from the correct source, but the last block of the site put everything in its place: <br><blockquote>  Wheels provided support all Raspberry Pi models (Pi 3, Pi 2, Pi 1 and Pi Zero).  Wheels are provided for Raspbian Jessie (Python 3.4) and Raspbian Stretch (Python 3.5).  We plan to add support for Raspbian Buster (Python 3.7) in due course. <br><br>  <i>The provided wheels support all Raspberry Pi models (Pi 3, Pi 2, Pi 1 and Pi Zero. Wheel support Raspbian Jessie (Python 3.4) and Raspbian Stretch (Python 3.5). We plan to add support for Raspbian Buster (Python 3.7) in due time.</i> <br></blockquote>  I was already ready for a sleepless night with compilation of OpenCV on a raspberry, but I remembered <a href="https://habr.com/ru/post/430906/">an article</a> about cross-compiling a library (it was not for nothing that the teachers at the institute suggested we make a laboratory instead of manuals).  Having slightly changed the parameters from the article (it was necessary to add import for python3 and check if all the libraries are for OpenCV 4.1.0), I could achieve the result I desired. <br><br>  However, laziness took up, and I began to look for ready-made solutions to such a problem.  So I came across this article.  Following her, I collected everything the first time without dancing with tambourines and other shamanistic rituals.  I think this article will be useful to others. <br></div></div><br>  I present my free translation of the article ‚Äú <a href="https://solarianprogrammer.com/2018/12/18/cross-compile-opencv-raspberry-pi-raspbian/">Cross compiling OpenCV 4 for Raspberry Pi and BeagleBone Black</a> ‚Äù by Paul Silisteanu.  Perhaps someone will save minutes or hours that can be spent on a more interesting lesson than playing a detective story. <br><br>  From myself, I added some notes to the translation, which I considered important: [ <i>they are highlighted in the text</i> ]. <br><br>  Enjoy reading! <br><br><h3>  Cross-compiling OpenCV 4 for Raspberry Pi and BeagleBone Black </h3><br>  In this article, I will show you how to install the latest version of <a href="https://opencv.org/">OpenCV</a> for Raspberry Pi and BeagleBone Black using cross-compilation.  At the time of this writing [ <i>its update at the time of translation is July 17, 2019</i> ], the latest version of OpenCV is 4.1.0, and the version shipped with standard OSs was 3.2.0.  Of course, it is possible to compile OpenCV from source directly to Raspberry or BeagleBone Black, but this can take several hours.  And cross-compiling OpenCV for armhf is a process lasting 20-30 minutes.  And, depending on the speed of your computer, it may be even faster. <br><br>  I recommend building on a <a href="https://www.debian.org/">Debian Buster</a> virtual machine or in a <a href="https://hub.docker.com/_/debian/">Docker</a> container so as not to clutter up your main OS.  If you decide to install Buster on a virtual machine, be sure to use the <a href="https://www.debian.org/CD/netinst/">minimum build</a> [ <i>I recommend doing just that - I checked it on my own skin</i> ].  It is very important to start with a simple system, because we need to install the armhf executables and libraries.  Using a minimal system, we avoid potential conflicts with native x86-64 versions. <br><br>  The article describes working only on Raspberry PI with the Raspbian system, but if you use BeagleBone Black, everything should work exactly the same. <br><br>  I assume that you already have a clean <a href="https://www.raspberrypi.org/downloads/raspbian/">Raspbian</a> installed.  I used the image of the latest available desktop version.  In fact, you can follow the article on Raspbian Lite, but I did all my tests using the GUI version. <br><br>  First, let's make sure our virtual machine or container is updated: <br><br><pre><code class="bash hljs">sudo apt update sudo apt upgrade</code> </pre> <br>  Next, you need to connect the armhf architecture. <br><br><pre> <code class="bash hljs">sudo dpkg --add-architecture armhf sudo apt update sudo apt install qemu-user-static</code> </pre><br>  At this point, you can install libraries and applications for armhf on your system and run them. <br><br>  We are going to build OpenCV with support for Python and C ++.  Let's install <a href="https://www.python.org/">Python2 and Python3</a> , as well as the <a href="http://www.numpy.org/">NumPy</a> pact for them: <br><br><pre> <code class="bash hljs">sudo apt-get install python3-dev sudo apt-get install python3-numpy sudo apt-get install python-dev sudo apt-get install python-numpy</code> </pre><br>  We will also need libpython for armhf architecture: <br><br><pre> <code class="bash hljs">sudo apt-get install libpython2-dev:armhf sudo apt-get install libpython3-dev:armhf</code> </pre><br>  Next, we will install libgtk-3 to be able to write simple programs with a graphical interface.  If you plan to use OpenCV exclusively in offline mode, you can safely ignore the following two libraries: <br><br><pre> <code class="bash hljs">$ sudo apt install libgtk-3-dev:armhf libcanberra-gtk3-dev:armhf</code> </pre><br>  We also need to install several other libraries necessary for OpenCV (support for various image and video formats): <br><br><pre> <code class="bash hljs">sudo apt install libtiff-dev:armhf zlib1g-dev:armhf sudo apt install libjpeg-dev:armhf libpng-dev:armhf sudo apt install libavcodec-dev:armhf libavformat-dev:armhf libswscale-dev:armhf libv4l-dev:armhf sudo apt-get install libxvidcore-dev:armhf libx264-dev:armhf</code> </pre><br>  Next, we are going to install cross-compilers for Debian, which can be used to create armhf binaries for the Raspberry Pi: <br><br><pre> <code class="bash hljs">sudo apt install crossbuild-essential-armhf sudo apt install gfortran-arm-linux-gnueabihf</code> </pre><br>  At the time of this writing, the toolkit above is based on GCC version 8.3, which is the same as in Raspbian. <br><br>  Finally, we will install <a href="https://cmake.org/">Cmake</a> , <a href="https://git-scm.com/">git</a> , <a href="https://www.freedesktop.org/wiki/Software/pkg-config/">pkg-config</a> and wget: <br><br><pre> <code class="bash hljs">sudo apt install cmake git pkg-config wget</code> </pre><br>  Next, we can download the current version of OpenCV.  I will show you how to install the full version of OpenCV (default and contrib libraries): <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ mkdir opencv_all &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> opencv_all wget -O opencv.tar.gz https://github.com/opencv/opencv/archive/4.1.0.tar.gz tar xf opencv.tar.gz wget -O opencv_contrib.tar.gz https://github.com/opencv/opencv_contrib/archive/4.1.0.tar.gz tar xf opencv_contrib.tar.gz rm *.tar.gz</code> </pre><br>  We need to temporarily change two system variables needed to successfully build GTK + support: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> PKG_CONFIG_PATH=/usr/lib/arm-linux-gnueabihf/pkgconfig:/usr/share/pkgconfig <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> PKG_CONFIG_LIBDIR=/usr/lib/arm-linux-gnueabihf/pkgconfig:/usr/share/pkgconfig</code> </pre><br>  At the moment, we can use Cmake to generate OpenCV build scripts: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> opencv-4.1.0 mkdir build &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> build cmake -D CMAKE_BUILD_TYPE=RELEASE \ -D CMAKE_INSTALL_PREFIX=/opt/opencv-4.1.0 \ -D CMAKE_TOOLCHAIN_FILE=../platforms/linux/arm-gnueabi.toolchain.cmake \ -D OPENCV_EXTRA_MODULES_PATH=~/opencv_all/opencv_contrib-4.1.0/modules \ -D OPENCV_ENABLE_NONFREE=ON \ -D ENABLE_NEON=ON \ -D ENABLE_VFPV3=ON \ -D BUILD_TESTS=OFF \ -D BUILD_DOCS=OFF \ -D PYTHON2_INCLUDE_PATH=/usr/include/python2.7 \ -D PYTHON2_LIBRARIES=/usr/lib/arm-linux-gnueabihf/libpython2.7.so \ -D PYTHON2_NUMPY_INCLUDE_DIRS=/usr/lib/python2/dist-packages/numpy/core/include \ -D PYTHON3_INCLUDE_PATH=/usr/include/python3.7m \ -D PYTHON3_LIBRARIES=/usr/lib/arm-linux-gnueabihf/libpython3.7m.so \ -D PYTHON3_NUMPY_INCLUDE_DIRS=/usr/lib/python3/dist-packages/numpy/core/include \ -D BUILD_OPENCV_PYTHON2=ON \ -D BUILD_OPENCV_PYTHON3=ON \ -D BUILD_EXAMPLES=OFF ..</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Description of parameters</b> <div class="spoiler_text">  CMAKE_INSTALL_PREFIX - Directory where the collected data will be located <br>  CMAKE_TOOLCHAIN_FILE - Parameter showing Cmake what cross-compilation will be <br>  OPENCV_EXTRA_MODULES_PATH - Path to additional OpenCV modules <br>  OPENCV_ENABLE_NONFREE = ON - Include patented algorithms in the assembly <br>  Please note that the use of SIFT and SURF algorithms is subject to patent restrictions.  And if you are planning on assembling for commercial use, think about whether you need them and check out the limitations. <br>  ENABLE_NEON = ON - Enable NEON instructions for optimization for ARM <br>  ENABLE_VFPV3 = ON - Enable VFPv3-D32 instructions for optimization for ARM <br>  BUILD_TESTS = OFF - Disable rules for building tests (it will be faster) <br>  BUILD_DOCS = OFF - Disable rules for building documentation <br>  PYTHON2_INCLUDE_PATH - Path to python2.7 <br>  PYTHON2_LIBRARIES - Path to the previously downloaded libpython2 library <br>  PYTHON2_NUMPY_INCLUDE_DIRS - Path to NumPy for python2.7 <br>  PYTHON3_INCLUDE_PATH - Path to python3 <br>  PYTHON3_LIBRARIES - Path to the previously downloaded libpython3 library <br>  PYTHON3_NUMPY_INCLUDE_DIRS - Path to NumPy for python3 <br>  BUILD_OPENCV_PYTHON2 = ON - Include rules for python2 in the assembly <br>  BUILD_OPENCV_PYTHON3 = ON - Include python4 rules in the assembly <br>  BUILD_EXAMPLES = OFF - Disable rules for assembling all examples <br></div></div><br>  If you did not have errors, then as a result you will receive a Makefile in the assembly folder.  Now we can start the actual build: <br><br><pre> <code class="bash hljs">make -j16</code> </pre><br>  [ <i>The article indicates 16 parallel processes during assembly, but this parameter will need to be selected for your host OS</i> ] <br><br>  After the build phase is complete, we can install the library: <br><br><pre> <code class="bash hljs">sudo make install/strip</code> </pre><br>  Then we need to change the name of the library, which the installer mistakenly called the x86_64 library, although in fact it is armhf: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /opt/opencv-4.1.0/lib/python3.7/dist-packages/cv2/python-3.7/ sudo cp cv2.cpython-37m-x86_64-linux-gnu.so cv2.so</code> </pre><br>  Let's compress the installation folder and save the archive in the home directory: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /opt tar -cjvf ~/opencv-4.1.0-armhf.tar.bz2 opencv-4.1.0 <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~</code> </pre><br>  To make our life easier, I also prepared a simple pkg-config settings file called opencv.pc.  You can download it this way: <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://gist.github.com/sol-prog/ed383474872958081985de733eaf352d opencv_cpp_compile_settings <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> opencv_cpp_compile_settings cp opencv.pc ~ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~</code> </pre><br>  [ <i>Actually, it is not necessary to do this on the host machine.</i>  <i>You can download the file directly to Raspberry.</i>  <i>But the author wished to do it in this order</i> ] <br><br><div class="spoiler">  <b class="spoiler_title">opencv.pc</b> <div class="spoiler_text">  <i>Since the file is relatively small, let me insert it into the text of the article:</i> <br><br><pre> <code class="plaintext hljs">libdir = /opt/opencv-4.1.0/lib includedir = /opt/opencv-4.1.0/include/opencv4 Name: OpenCV Description: OpenCV (Open Source Computer Vision Library) is an open source computer vision and machine learning software library. Version: 4.1.0 Libs: -L${libdir} -lopencv_aruco -lopencv_bgsegm -lopencv_bioinspired -lopencv_calib3d -lopencv_ccalib -lopencv_core -lopencv_datasets -lopencv_dnn_objdetect -lopencv_dnn -lopencv_dpm -lopencv_face -lopencv_features2d -lopencv_flann -lopencv_freetype -lopencv_fuzzy -lopencv_gapi -lopencv_hfs -lopencv_highgui -lopencv_imgcodecs -lopencv_img_hash -lopencv_imgproc -lopencv_line_descriptor -lopencv_ml -lopencv_objdetect -lopencv_optflow -lopencv_phase_unwrapping -lopencv_photo -lopencv_plot -lopencv_quality -lopencv_reg -lopencv_rgbd -lopencv_saliency -lopencv_shape -lopencv_stereo -lopencv_stitching -lopencv_structured_light -lopencv_superres -lopencv_surface_matching -lopencv_text -lopencv_tracking -lopencv_videoio -lopencv_video -lopencv_videostab -lopencv_xfeatures2d -lopencv_ximgproc -lopencv_xobjdetect -lopencv_xphoto Cflags: -I${includedir}</code> -lopencv_bgsegm -lopencv_bioinspired -lopencv_calib3d -lopencv_ccalib -lopencv_core -lopencv_datasets -lopencv_dnn_objdetect -lopencv_dnn -lopencv_dpm -lopencv_face -lopencv_features2d -lopencv_flann -lopencv_freetype -lopencv_fuzzy -lopencv_gapi -lopencv_hfs -lopencv_highgui -lopencv_imgcodecs -lopencv_img_hash -lopencv_imgproc <code class="plaintext hljs">libdir = /opt/opencv-4.1.0/lib includedir = /opt/opencv-4.1.0/include/opencv4 Name: OpenCV Description: OpenCV (Open Source Computer Vision Library) is an open source computer vision and machine learning software library. Version: 4.1.0 Libs: -L${libdir} -lopencv_aruco -lopencv_bgsegm -lopencv_bioinspired -lopencv_calib3d -lopencv_ccalib -lopencv_core -lopencv_datasets -lopencv_dnn_objdetect -lopencv_dnn -lopencv_dpm -lopencv_face -lopencv_features2d -lopencv_flann -lopencv_freetype -lopencv_fuzzy -lopencv_gapi -lopencv_hfs -lopencv_highgui -lopencv_imgcodecs -lopencv_img_hash -lopencv_imgproc -lopencv_line_descriptor -lopencv_ml -lopencv_objdetect -lopencv_optflow -lopencv_phase_unwrapping -lopencv_photo -lopencv_plot -lopencv_quality -lopencv_reg -lopencv_rgbd -lopencv_saliency -lopencv_shape -lopencv_stereo -lopencv_stitching -lopencv_structured_light -lopencv_superres -lopencv_surface_matching -lopencv_text -lopencv_tracking -lopencv_videoio -lopencv_video -lopencv_videostab -lopencv_xfeatures2d -lopencv_ximgproc -lopencv_xobjdetect -lopencv_xphoto Cflags: -I${includedir}</code> -lopencv_reg -lopencv_rgbd -lopencv_saliency -lopencv_shape -lopencv_stereo -lopencv_stitching -lopencv_structured_light -lopencv_superres -lopencv_surface_matching -lopencv_text -lopencv_tracking -lopencv_videoio -lopencv_video -lopencv_videostab -lopencv_xfeatures2d -lopencv_ximgproc -lopencv_xobjdetect <code class="plaintext hljs">libdir = /opt/opencv-4.1.0/lib includedir = /opt/opencv-4.1.0/include/opencv4 Name: OpenCV Description: OpenCV (Open Source Computer Vision Library) is an open source computer vision and machine learning software library. Version: 4.1.0 Libs: -L${libdir} -lopencv_aruco -lopencv_bgsegm -lopencv_bioinspired -lopencv_calib3d -lopencv_ccalib -lopencv_core -lopencv_datasets -lopencv_dnn_objdetect -lopencv_dnn -lopencv_dpm -lopencv_face -lopencv_features2d -lopencv_flann -lopencv_freetype -lopencv_fuzzy -lopencv_gapi -lopencv_hfs -lopencv_highgui -lopencv_imgcodecs -lopencv_img_hash -lopencv_imgproc -lopencv_line_descriptor -lopencv_ml -lopencv_objdetect -lopencv_optflow -lopencv_phase_unwrapping -lopencv_photo -lopencv_plot -lopencv_quality -lopencv_reg -lopencv_rgbd -lopencv_saliency -lopencv_shape -lopencv_stereo -lopencv_stitching -lopencv_structured_light -lopencv_superres -lopencv_surface_matching -lopencv_text -lopencv_tracking -lopencv_videoio -lopencv_video -lopencv_videostab -lopencv_xfeatures2d -lopencv_ximgproc -lopencv_xobjdetect -lopencv_xphoto Cflags: -I${includedir}</code> </pre><br></div></div><br>  Copy opencv-4.1.0-armhf.tar.bz2 and opencv.pc from your home folder into RPi. <br><br>  In the next part of the article, I assume that you <b>are already doing</b> everything <b>on your Raspberry Pi</b> . <br><br>  Make sure that your RPi has all the development libraries we used.  As before, if you do not plan to use GTK +, ignore the first line of the following commands.  Most of these libraries should already be installed if you are using the full version of Raspbian: <br><br><pre> <code class="bash hljs">sudo apt install libgtk-3-dev libcanberra-gtk3-dev sudo apt install libtiff-dev zlib1g-dev sudo apt install libjpeg-dev libpng-dev sudo apt install libavcodec-dev libavformat-dev libswscale-dev libv4l-dev sudo apt-get install libxvidcore-dev libx264-dev</code> </pre><br>  Unzip and move the library to the / opt folder of your RPi: <br><br><pre> <code class="bash hljs">tar xfv opencv-4.1.0-armhf.tar.bz2 sudo mv opencv-4.1.0 /opt</code> </pre><br>  If you wish, you can delete the archive: <br><br><pre> <code class="bash hljs">rm opencv-4.1.0-armhf.tar.bz2</code> </pre><br>  Next, let's also move opencv.pc to a folder where pkg-config can find it: <br><br><pre> <code class="bash hljs">sudo mv opencv.pc /usr/lib/arm-linux-gnueabihf/pkgconfig</code> </pre><br>  So that the operating system can find the OpenCV libraries, we need to add them to the library path: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'export LD_LIBRARY_PATH=/opt/opencv-4.1.0/lib:$LD_LIBRARY_PATH'</span></span> &gt;&gt; .bashrc <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> .bashrc</code> </pre><br>  Log out and log in or restart the Terminal. <br><br>  Next, create some symbolic links that will allow Python to load the newly created libraries: <br><br><pre> <code class="bash hljs">sudo ln -s /opt/opencv-4.1.0/lib/python2.7/dist-packages/cv2 /usr/lib/python2.7/dist-packages/cv2 sudo ln -s /opt/opencv-4.1.0/lib/python3.7/dist-packages/cv2 /usr/lib/python3/dist-packages/cv2</code> </pre><br>  At this point, you can use the OpenCV library from C ++ or Python. <br>  You can find several test programs in C ++ and Python in the <a href="https://github.com/sol-prog/raspberry-pi-opencv">repository</a> for this article.  You can download the code on your Pi using the commands: <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/sol-prog/raspberry-pi-opencv.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> raspberry-pi-opencv/tests</code> </pre><br>  There are two standalone tests you can use even if you don‚Äôt have a display connected to your RPi: cli_cpp_test.cpp and cli_python_test.py.  I also included two graphics tests that require display: gui_cpp_test.cpp and gui_python_test.py. <br><br>  You can create and run C ++ tests as follows: <br><br><pre> <code class="bash hljs">g++ cli_cpp_test.cpp -o cli_cpp_test `pkg-config --cflags --libs opencv` ./cli_cpp_test</code> </pre><br>  And, if you have a display connected to your RPi: <br><br><pre> <code class="bash hljs">g++ gui_cpp_test.cpp -o gui_cpp_test `pkg-config --cflags --libs opencv` ./gui_cpp_test</code> </pre><br>  Here is a screenshot of the C ++ GUI test running on my Pi: <br><br><img src="https://habrastorage.org/webt/wu/fx/jt/wufxjtxgrqa-mymc6evbxj1jbx4.jpeg"><br><br>  For Python tests, use: <br><br><pre> <code class="bash hljs">python3 cli_python_test.py</code> </pre><br>  or <br><br><pre> <code class="bash hljs">python3 gui_python_test.py</code> </pre><br>  As a note, it is also possible to cross-compile C ++ programs using OpenCV on your Debian x86-64 system and run binary on your RPi. <br><br>  [ <i>Further in the article, the author recommends reading Derek Molloy‚Äôs book on programming for RaspberryPi.</i>  <i>You can find the referral link to the book in the original article</i> ]. <br>  <a href="https://solarianprogrammer.com/2018/12/18/cross-compile-opencv-raspberry-pi-raspbian/">Link to the original article</a> <br><br><div class="spoiler">  <b class="spoiler_title">A small addition from myself</b> <div class="spoiler_text">  I prepared a Dockerfile that will allow you to perform all the steps from the article without having to deploy a virtual machine. <br><br>  Installation process: <br>  Create a Dockerfile. <br><br><pre> <code class="bash hljs">mkdir opencv &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> opencv &amp;&amp; mkdir armhf_opencv touch armhf_opencv/Dockerfile nano armhf_opencv/Dockerfile</code> </pre><br>  Next, we paste the code into the Dockerfile and after that we start the assembly of the image. <br><br><pre> <code class="bash hljs">docker image build armhf_opencv/</code> </pre><br>  After the build is complete, you should see the identifier of the assembled image: <br><br><pre> <code class="bash hljs">&gt;&gt;&gt; Successfully built babdc99ba2d8</code> </pre><br>  We use this identifier to set the tag for the image and run it: <br><br><pre> <code class="bash hljs">docker tag babdc99ba2d8 armhf_opencv:latest docker run armhf_opencv</code> </pre><br>  After starting the container, it is necessary to pump out the assembled archive and the opencv.pc file from it.  To do this, we need its identifier: <br><br><pre> <code class="bash hljs">docker container ls --all &gt;&gt;&gt; CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES &gt;&gt;&gt; 369dff5a0a9b armhf_opencv <span class="hljs-string"><span class="hljs-string">"bash"</span></span> 9 seconds ago Exited (0) 7 seconds ago affectionate_wu</code> </pre><br>  Copy the files we need to the current directory: <br><br><pre> <code class="bash hljs">docker cp 369dff5a0a9b:/root/opencv-4.1.0-armhf.tar.bz2 ./ docker cp 369dff5a0a9b:/root/opencv.pc ./</code> </pre><br>  After that, I recommend deleting the image, since it takes up 2.5GB of space. <br><br>  Building through docker on my i59600K with 16GB took about 30-40 minutes, and a lot of time was spent downloading data from the repository. <br><br>  Further, the installation process on the Raspberry Pi is no different from that described in the article. <br><br>  Dockerfile itself: <br><br><pre> <code class="plaintext hljs">FROM debian:buster USER root RUN apt update &amp;&amp; apt upgrade RUN dpkg --add-architecture armhf &amp;&amp; \ apt update &amp;&amp; apt install -y qemu-user-static RUN apt install -y python3-dev python3-numpy python-dev python-numpy RUN apt install -y libpython2-dev:armhf libpython3-dev:armhf \ libgtk-3-dev:armhf libcanberra-gtk3-dev:armhf \ libtiff-dev:armhf zlib1g-dev:armhf \ libjpeg-dev:armhf libpng-dev:armhf \ libavcodec-dev:armhf libavformat-dev:armhf \ libswscale-dev:armhf libv4l-dev:armhf \ libxvidcore-dev:armhf libx264-dev:armhf RUN apt install -y crossbuild-essential-armhf gfortran-arm-linux-gnueabihf RUN apt install -y cmake git pkg-config wget RUN mkdir opencv_all &amp;&amp; cd opencv_all &amp;&amp; \ wget -O opencv.tar.gz https://github.com/opencv/opencv/archive/4.1.0.tar.gz &amp;&amp; \ tar -xf opencv.tar.gz -C /tmp &amp;&amp; \ wget -O opencv_contrib.tar.gz https://github.com/opencv/opencv_contrib/archive/4.1.0.tar.gz &amp;&amp; \ tar -xf opencv_contrib.tar.gz -C /tmp &amp;&amp; \ rm *.tar.gz &amp;&amp; \ export PKG_CONFIG_PATH=/usr/lib/arm-linux-gnueabihf/pkgconfig:/usr/share/pkgconfig &amp;&amp; \ export PKG_CONFIG_LIBDIR=/usr/lib/arm-linux-gnueabihf/pkgconfig:/usr/share/pkgconfig &amp;&amp; \ cd /tmp/opencv-4.1.0 &amp;&amp; mkdir build &amp;&amp; cd build &amp;&amp; \ cmake -D CMAKE_BUILD_TYPE=RELEASE \ -D CMAKE_INSTALL_PREFIX=/opt/opencv-4.1.0 \ -D CMAKE_TOOLCHAIN_FILE=../platforms/linux/arm-gnueabi.toolchain.cmake \ -D OPENCV_EXTRA_MODULES_PATH=/tmp/opencv_contrib-4.1.0/modules \ -D OPENCV_ENABLE_NONFREE=ON \ -D ENABLE_NEON=ON \ -D ENABLE_VFPV3=ON \ -D BUILD_TESTS=OFF \ -D BUILD_DOCS=OFF \ -D PYTHON2_INCLUDE_PATH=/usr/include/python2.7 \ -D PYTHON2_LIBRARIES=/usr/lib/arm-linux-gnueabihf/libpython2.7.so \ -D PYTHON2_NUMPY_INCLUDE_DIRS=/usr/lib/python2/dist-packages/numpy/core/include \ -D PYTHON3_INCLUDE_PATH=/usr/include/python3.7m \ -D PYTHON3_LIBRARIES=/usr/lib/arm-linux-gnueabihf/libpython3.7m.so \ -D PYTHON3_NUMPY_INCLUDE_DIRS=/usr/lib/python3/dist-packages/numpy/core/include \ -D BUILD_OPENCV_PYTHON2=ON \ -D BUILD_OPENCV_PYTHON3=ON \ -D BUILD_EXAMPLES=OFF .. &amp;&amp; \ make -j6 &amp;&amp; make install/strip RUN cd /opt/opencv-4.1.0/lib/python3.7/dist-packages/cv2/python-3.7/ &amp;&amp; \ cp cv2.cpython-37m-x86_64-linux-gnu.so cv2.so RUN cd /opt &amp;&amp; tar -cjvf /root/opencv-4.1.0-armhf.tar.bz2 opencv-4.1.0 RUN git clone https://gist.github.com/sol-prog/ed383474872958081985de733eaf352d opencv_cpp_compile_settings &amp;&amp; \ cd opencv_cpp_compile_settings &amp;&amp; \ cp opencv.pc /root/</code> </pre><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/461693/">https://habr.com/ru/post/461693/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461679/index.html">Electronic Arts Libraries of Almost Good Quality</a></li>
<li><a href="../461685/index.html">LED therapy, or ‚Äúyouthful apples‚Äù of the 21st century</a></li>
<li><a href="../461687/index.html">Docker + Laravel + RoadRunner = ‚ù§</a></li>
<li><a href="../461689/index.html">Developer IoT Identification</a></li>
<li><a href="../46169/index.html">Normal debug in NetBeans</a></li>
<li><a href="../461695/index.html">VFX Internship</a></li>
<li><a href="../461697/index.html">Beer intelligence</a></li>
<li><a href="../461699/index.html">Volcanic Piglet, or do-it-yourself SQL</a></li>
<li><a href="../4617/index.html">Inventors of asymmetric cryptography</a></li>
<li><a href="../46170/index.html">BikeCamp 2008 Minibar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>