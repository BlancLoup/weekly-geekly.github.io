<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Can I trust my Chrome and Firefox synchronization passwords?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I recently wrote about the lack of protection of locally stored passwords in Firefox . As some readers rightly pointed out, an attacker with physical ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Can I trust my Chrome and Firefox synchronization passwords?</h1><div class="post__text post__text-html js-mediator-article">  I recently wrote about the <a href="https://palant.de/2018/03/10/master-password-in-firefox-or-thunderbird-do-not-bother">lack of protection of locally stored passwords in Firefox</a> .  As some readers rightly pointed out, an attacker with physical access to your device is not the main threat.  So let's take a look at how browser developers protect your passwords when they are transferred to the cloud.  Both Chrome and Firefox provide a synchronization service that can load not only stored passwords, but also cookies and browsing history.  How safe is this service? <br><br>  <b>TL; DR:</b> currently the answer is "no."  Both services have security weaknesses.  However, some of these shortcomings are worse than others. <br><a name="habracut"></a><br><h1>  Chrome sync </h1><br>  I'll start with Chrome sync, where the answer is more predictable.  In the end, several things indicate that this service is designed more for convenience than for privacy.  For example, a password to protect your data from Google is <a href="https://support.google.com/chrome/answer/165139">optional</a> .  In the settings there is no warning like "Hey, do you care that we can look into your data?  Better set the password. ‚Äù  Instead, the user must take the initiative.  Another sign is that Google allows <a href="https://passwords.google.com/">access to passwords through a webpage</a> .  Probably the idea is that you can open this web page from someone else's computer, for example, from an Internet cafe.  A good idea?  Hardly. <br><br>  In any case, what happens after setting the password?  It will be used to obtain (among other things) the encryption key - and your data is encrypted with this key.  Of course, the big question here is: if someone gets your encrypted data from the server, how is the password protected from brute force?  It turns out that Chrome uses PBKDF2-HMAC-SHA1 with 1003 iterations. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What does this mean?  Here again, for reference, I will cite the figures from <a href="https://blog.codinghorror.com/hacker-hack-thyself/">this article</a> : with these iterations, one Nvidia GTX 1080 graphics card can calculate 3.2 million hashes of PBKDF2-HMAC-SHA1 per second.  This is 3.2 million guessed passwords per second.  That is, 1.5 billion passwords known from various website leaks are counted in less than 8 minutes.  What about a strong password with a 40-bit entropy, which <a href="http://research.microsoft.com/pubs/74164/www2007.pdf">these experts</a> consider the average password of people?  Probably, experts overestimate the ability of people to choose good passwords, but in about two days this password will be picked up. <br><br>  In fact, the situation is even worse.  The salt that Chrome uses to get the key is a constant.  This means that the same password for different Chrome users corresponds to the same encryption keys.  In turn, this means that if there is a large amount of data from different users, it is possible to carry out an attack on everyone at once.  Thus, in four days, a password will be selected for any account where a password with entropy up to 40 bits is used.  Keep in mind that Google itself has enough equipment to do this work in a few minutes, if not seconds.  I'm talking about those intruders who do not want to spend more than $ 1,000 on equipment. <br><br>  I registered this bug in the tracker with the <a href="https://bugs.chromium.org/p/chromium/issues/detail%3Fid%3D820976">number 820976</a> , stay tuned. <br><br>  <i>Note.</i>  Special thanks to Chrome for their creativity in wasting CPU resources.  This function drives PBKDF2 four times, although one pass is sufficient.  The first run gets the salt on behalf of the host and username (in the case of synchronization, Chrome is a constant).  This is pretty pointless: salt should not be a secret, it just has to be unique.  So combining values ‚Äã‚Äãor running SHA-256 on them has the same effect.  The following three runs generate three different keys from identical input data using a different number of iterations.  One PBKDF2 call with data generation for all three keys would obviously be more efficient. <br><br><h1>  Firefox sync </h1><br>  Firefox sync uses the <a href="https://github.com/mozilla/fxa-auth-server/wiki/onepw-protocol">well-documented Firefox Accounts protocol</a> to set encryption keys.  Although the various parameters and the operations performed there may be confusing, it seems that this is a well thought out approach.  If someone gains access to the data stored on the server, they will have to deal with <a href="https://en.wikipedia.org/wiki/Scrypt">scrypt-</a> based keys.  Busting scrypt on specialized equipment is much more complicated than PBKDF2, if only because each scrypt call requires 64 MB of memory - if you take into account the parameters that Mozilla uses. <br><br>  However, there is a significant drawback: scrypt runs on the Firefox Accounts server, and not on the client side.  On the client side, this protocol uses PBKDF2-HMAC-SHA256 with only 1000 iterations.  And although the received password hash is not stored on the server, but if someone intercepts it during transmission to the server, it can relatively easily find the password.  In this case, one Nvidia GTX 1080 video card will check 1.2 million hashes per second.  Although each account will have to restart the operation, checking 1.5 billion known passwords will take 20 minutes.  And a password with 40-bit entropy will guess on average in five days.  Depending on the content of the account, such a waste of resources can pay off. <br><br>  Highlight: Mozilla paid for the Firefox Accounts security audit, and this audit <a href="https://blog.mozilla.org/security/2017/07/18/web-service-audits-firefox-accounts/">indicated key generation on the client side as a key flaw</a> .  Thus, Mozilla knows about the problem for at least 18 months, and even published this information 8 months ago.  What's the matter?  Apparently, the problem was not considered too important.  Perhaps this is partly due to the fact that the auditor incorrectly assessed the risk: <br><br><blockquote>  <i>The attack involves a very strong attacker who is able to bypass TLS.</i> </blockquote>  Of course, one of the possible ways to conduct an attack would be to obtain a valid certificate for api.accounts.firefox.com and redirect traffic to your own server.  But it is more likely that the security of the api.accounts.firefox.com server itself will be compromised.  Even if the server is not hacked, there is always a chance that a Mozilla or Amazon employee (the server is hosted on AWS) decides to look at someone's data.  What if the American authorities knock on Mozilla? <br><br>  I originally reported this bug as <a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1444866">1444866</a> .  Now it is marked as a duplicate of bug <a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1320222">1320222</a> - I could not find it, because it was marked as ‚Äúimportant in terms of security‚Äù (security sensitive), although it does not contain any new information. </div><p>Source: <a href="https://habr.com/ru/post/354558/">https://habr.com/ru/post/354558/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354546/index.html">DevConf: from shawarma to symfony or legacy migration</a></li>
<li><a href="../354548/index.html">Introduction to complex numbers</a></li>
<li><a href="../354550/index.html">Animations in the world of states</a></li>
<li><a href="../354552/index.html">Accelerating Angular Applications</a></li>
<li><a href="../354554/index.html">2nd generation Infortrend EonStor DS2024 storage system review and testing</a></li>
<li><a href="../354560/index.html">Conference BLACK HAT USA. ‚ÄúHow the feds caught the Russian mega-carder Roman Seleznev‚Äù</a></li>
<li><a href="../354562/index.html">Forms should be simple and declarative.</a></li>
<li><a href="../354564/index.html">Matching problems and how to deal with them</a></li>
<li><a href="../354566/index.html">How Netflix evacuates from AWS in seven minutes</a></li>
<li><a href="../354568/index.html">TON: Telegram Open Network. Part 2: Blockchains, Sharding</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>