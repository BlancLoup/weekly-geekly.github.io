<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Speed ‚Äã‚Äãhashing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="High-speed hashing based on a new cryptographic algorithm 
 Unfortunately, mathematicians are poorly versed in the intricacies of programming, they in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Speed ‚Äã‚Äãhashing</h1><div class="post__text post__text-html js-mediator-article"><h2>  High-speed hashing based on a new cryptographic algorithm </h2><br>  Unfortunately, mathematicians are poorly versed in the intricacies of programming, they invent something, and then the programmer has to implement it in the program code.  It is not always possible to implement their algorithms efficiently. <br><br>  This is especially evident in the recent Russian symmetric cryptography, Striborg and Grasshopper ... These algorithms cannot be effectively implemented in x86 / 64 software codes, a specialized crypto processor is needed. <br><br>  Let's do the opposite and see what happens. <br><a name="habracut"></a><br>  A programmer who knows how a modern x86 / 64 processor works will develop the most efficient symmetric encryption algorithm, and mathematicians, as in the good old days, let them do their main work, the cryptanalysis of the resulting solution. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Remembering that "the best is the enemy of good", let us take as a basis the "good" - GOST 28147-89.  Then, following the medical principle ‚ÄúDo no harm‚Äù, we will strengthen it with the methods of multi-threaded calculations. <br><br>  The following has been done: <br><br><ul><li>  Increased key size to 256 bytes. </li><li>  Increased data block size to 256 bytes. </li><li>  The substitution operation is replaced by a permutation operation. </li><li>  In the cyclic shift introduced the operation of inverting groups of bits. </li><li>  The keys are entered in the form of permutation bits. </li><li>  The Feistel network is modified into a ring network of eight segments. </li><li>  The gamming mode is used with feedback, in two passes on the encrypted data. </li><li>  Passages are made with different permutations and ring shifts with the same keys. </li><li>  Before encryption, redundancy is removed from the encrypted text using a compressor. </li></ul><br><h2>  Test implementation </h2><br>  The algorithm is implemented, and the first thing that is tested is its statistical parameters when generating a pseudo-random sequence (the compressor is turned off), this is how they look: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9cb/f41/7b9/9cbf417b94fe0ea9939c0cb6fbdd57be.png" alt="image"><br><br>  This is a typical result of NIST tests of new crypto-transformation.  The results of tests on any random keys and initial fillings always fit into the statistical parameters of a random sequence. <br><br>  The statistical parameters obtained in experiments on the norms of the 8-byte block cipher for a block cipher with a block size of 256 bytes are fantastic. <br><br>  This is the same as, for example, throwing a coin 12 times and receiving an equal loss of "eagle" and "nutlets", to demand that the cube, also thrown 12 times, fall on each face twice a time ... <br><br>  This is theoretically possible only with very high differential entropy between adjacent blocks and characterizes the level of complexity of the block cipher. <br><br>  These gamma parameters are obtained with one round of conversion.  The algorithm has a peculiarity - the speed of gamming depends on the performance of the RAM and cache, and not on the speed of the processor. <br><br><h2>  Russian Roulette, 2018 and its application </h2><br>  Recently, cryptographic algorithms have begun to receive sonorous names, such as "Magma", "Grasshopper", "Stribog", we will continue this tradition. <br><br>  We will call this block cipher <b>"Russian Roulette"</b> or abbreviated as <b>RU2</b> , in honor of the first purely Russian generator of random binary sequences, the rotating drum of a revolver ... <br><br>  Well, besides that, crypto-transformation is built on rotations (ring shifts) of binary sequences.  Such shifts there are only explicitly <b>192</b> pieces per round. <br>  So the direct analogy with the drum of a revolver is obvious. <br><br>  Previously, when introducing a parallel method for implementing GOST 28147-89 on XMM / YMM registers, we had to fully describe it, since it was officially certified by the FSB. <br>  Now the situation is different, no official status is expected.  Therefore, there will be no detailed description of the ‚ÄúRussian Roulette‚Äù algorithm, this is a kind of copyright protection.  In short, the ‚ÄúRussian Roulette‚Äù algorithm will be proprietary for the time being and, accordingly, its full designation is <b>Russian Roulette, 2018</b> or abbreviated <b>RU2</b> . <br><br>  The encryption algorithm, closed from research, is of course nonsense, since there is no confidence in the encryption reliability. <br><br>  But nothing prevents the use of the <b>RU2</b> algorithm to convert the encrypted text into a sequence of pseudo- <b>randomness</b> satisfying the requirements. <br><br>  Then, the obtained pseudo-random sequence can be encrypted using well-known and ‚Äúreliable‚Äù algorithms, in fact, all serious cryptographic systems are built. <br>  In the meantime, ‚ÄúRussian Roulette‚Äù is used for high-speed hashing with an arbitrary size of the result of the hash function.  This is important in backup and integrity control tasks. <br>  Standard feedback gamma is turned into a Hash function if you make the second pass through the encrypted data.  This is how the algorithm <b>RU2</b> was originally implemented. <br>  Double feedback gammaging was not previously considered as an embodiment of the hash function apparently due to the low speed of operation, although it has more reliable convolution parameters.  This applies primarily to the avalanche effect, it affects not only the subsequent rounds of convolution, but also the previous ones. <br><br>  Moreover, the obtained characteristics of the hash function are reliably verified by statistical tests, because all the received ciphertext, which is a reliable pseudo-random gamut, becomes a hash. <br><br>  From this range, arbitrary chunks can be cut to store the hash value.  A block with a size of 1024Bytes is now used, it is much more reliable than a block of 64Bytes in the most ‚Äúadvanced‚Äù standard SHA3-512. <br><br>  Hashing <b>RU2</b> protects data from viewing / modification, but until cryptographers are convinced that the algorithm is <b>strong,</b> we will consider it as password data protection for access restriction. <br><br><h2>  Practical implementation of RU2 </h2><br>  The Russian Roulette algorithm is built into the forensic duplicator of HDD and SDD drives.  The algorithm is used there to create differential backups, integrity control, password-based access restriction and information compression. <br><br>  A compressor for removing redundancy has already been written earlier in the article ‚Äú <a href="https://www.securitylab.ru/analytics/496423.php">New algorithm for high-speed data compression,‚Äù</a> hashing is used to confirm the integrity of copied data, and in the case of entering a password, also for ‚Äúpassword protection‚Äù of the received dumps from viewing / modification. <br><br>  Here are the speed characteristics of <b>RU2</b> obtained in real work on the creation of a differential backup: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/38b/d30/35c/38bd3035c8d28a7c2fca035c8e482563.png" alt="image"><br><br>  Copying speed is limited by the parameters of the reader, a USB 3.0-SATA bridge cannot provide greater speed reading the SSD disk. <br><br>  At an input stream speed of 360MegaBytes / sec.  <b>RU2</b> algorithm loads the processor by only 5% at a reduced frequency of 1.4GHz.  This ensures the compression of information, its hashing and encryption (password protection) dump. <br><br>  Traditional hashing systems cannot provide such performance.  For comparison, here‚Äôs how the hashing system built into Acronis works when creating a differential backup of the same disk: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/704/397/456/7043974564b3e9d898112a4d44dd3929.png" alt="image"><br><br>  The processor hashes the input data stream at a speed of 340 MegaBytes / sec., While running at a frequency of 3.8GigHz, and is loaded at 28%. <br><br>  If we convert the obtained results into the limiting parameters for a dual-core processor operating at a frequency of 3.8GHz, then the Acronis hashing system can provide a throughput of 1.4Gbytes / sec. <br><br>  Much more loaded with tasks (hashing + compression + "password protection") the "Russian Roulette" algorithm provides a speed of 21Gbytes / sec. <br><br>  In other words, <b>RU2</b> hashing works an order of magnitude faster than standard hashing implemented in Acronis. <br><br>  In addition, Russian Roulette provides the pseudo-random number generation rate of 12 GBytes per second.  This is the fastest generator of pseudo-random sequences known to meet the requirements of the official NIST tests. <br><br>  Generation of random numbers, hashing, password protection, while this is enough for Russian Roulette. <br><br>  "... But what about cryptography ?, - and cryptography later ...". </div><p>Source: <a href="https://habr.com/ru/post/435362/">https://habr.com/ru/post/435362/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435348/index.html">Simple MCerver - a small shell for Minecraft server</a></li>
<li><a href="../435352/index.html">Conference DEFCON 18. Practical espionage using a mobile phone. Part 2</a></li>
<li><a href="../435354/index.html">Conference DEFCON 18. Practical espionage using a mobile phone. Part 1</a></li>
<li><a href="../435358/index.html">Antiquities: Minidisk in the Age of Ipod</a></li>
<li><a href="../435360/index.html">Snippet vs Clover - we beat the most popular quiz in real time</a></li>
<li><a href="../435364/index.html">Customizing dependency resolver in Spring</a></li>
<li><a href="../435368/index.html">Pathological anatomy at work</a></li>
<li><a href="../435372/index.html">A couple of words about FastPath and FastTrack in MikroTik</a></li>
<li><a href="../435374/index.html">The math in Gamedev is simple. Triangulation and Triangle.Net in Unity</a></li>
<li><a href="../435376/index.html">Space 2019: manned spacecraft, new missiles and lunar probes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>