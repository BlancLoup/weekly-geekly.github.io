<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Porting your own OS to Xen</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A couple of years ago, a student project on the transformation of Embox into an ideal platform for the cloud so fashionable was taking place on Mat-Me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Porting your own OS to Xen</h1><div class="post__text post__text-html js-mediator-article"><img width="350" src="https://habrastorage.org/webt/md/pz/ym/mdpzymxwfni5atchyklka2sm-gw.png" align="right">  A couple of years ago, a student project on the transformation of Embox into an ideal platform for the cloud so fashionable was taking place on Mat-Meh.  One of the obvious parts of this task was porting to some virtualization platform, and the choice fell on Xen.  In this article I will talk about the process of porting by students OS under Xen, adding a new platform to Embox, and, of course, why all this was started at all. <br><a name="habracut"></a><br>  The idea behind the ideal cloud platform is: <br>  There is the concept of <a href="https://en.wikipedia.org/wiki/Unikernel">unikernel</a> .  In short, the developer of a single application chooses the right set of functionality to work with.  Only this functionality is included in the operating system, which is linked into a single image along with the application.  With this approach, resources are obviously saved.  Of course, this is the only application that does not have very large functionality, but if you put a lot of different applications in the cloud (in fact, services), you can get very broad functionality. <br><br><h2>  Porting to Xen </h2><br><h3>  Xen Health Check </h3><br>  Any porting of anything to anything is worth starting with checking existing solutions.  Under Xen, quite a lot of operating systems are already running.  Of course, we are primarily interested in open Linux.  Xen has one feature: before you launch something, you must first learn how to create and manage instances of this platform.  In other words, you need to learn how to create separate virtual machines (domains). <br><br>  To work with Xen, you need to install the appropriate packages: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs swift">sudo apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> install xen-hypervisor-<span class="hljs-number"><span class="hljs-number">4.8</span></span>-amd64 xen-tools</code> </pre> <br>  After that, you need to reboot and at boot time select the version of your OS on Xen (usually by default). <br><br>  To verify that we are now running the hypervisor, it suffices to verify that the output of the command <code>cat /proc/cpuinfo | grep hypervisor</code>  <code>cat /proc/cpuinfo | grep hypervisor</code> not empty.  Similarly, you can verify the output of the command <code>virt-what</code> , it should contain the domain xen-dom0 <br><br>  Another verification option is to use the ‚Äúxl‚Äù command that we will need in the future. <br><br>  The <code>sudo xl list</code> command should display something like this: <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">Name</span></span> ID Mem VCPUs State <span class="hljs-type"><span class="hljs-type">Time</span></span>(s) <span class="hljs-keyword"><span class="hljs-keyword">Domain</span></span><span class="hljs-number"><span class="hljs-number">-0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">945</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> r<span class="hljs-comment"><span class="hljs-comment">----- 11.3</span></span></code> </pre> <br><h3>  Domain Management </h3><br>  There are several ways to create and manage virtual machines in Xen. <br>  The first is installation using third-party programs (for example, virt-manager or oVirt).  Usually they have a graphical interface, and the program itself ‚Äúdigs up‚Äù in the files of the system, making the necessary changes. <br><br>  The second way is to work in the console. <br><br>  In the case of Linux virtualization, we will use xen-tools + xl (or xm).  This is convenient because many Linux distributions are already prepared for paravirtualization. <br><br>  The parameters with which new virtual machines are created are located in the <code>/etc/xen-tools/xen-tools.conf</code> file and can be overridden.  All parameters can also be overridden when creating the machine. <br><br><h3>  Network setup </h3><br>  There are several ways to organize a network between domains.  Choose the simplest - Bridge Network (virtual machines will be visible on the local network as physical devices along with dom0). <br><br>  Install the packages: <br><br><pre> <code class="hljs swift">sudo apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> install bridge-utils</code> </pre> <br>  Next, edit the file <code>/etc/network/interfaces</code> <br>  It was <br><br><pre> <code class="hljs pgsql"># The loopback network interface auto lo iface lo <span class="hljs-type"><span class="hljs-type">inet</span></span> loopback # The <span class="hljs-keyword"><span class="hljs-keyword">primary</span></span> network interface allow-hotplug enp5s0 iface enp5s0 <span class="hljs-type"><span class="hljs-type">inet</span></span> dhcp</code> </pre> <br>  It became <br><br><pre> <code class="hljs pgsql"># The loopback network interface auto lo iface lo <span class="hljs-type"><span class="hljs-type">inet</span></span> loopback # The <span class="hljs-keyword"><span class="hljs-keyword">primary</span></span> network interface allow-hotplug enp5s0 iface enp5s0 <span class="hljs-type"><span class="hljs-type">inet</span></span> manual auto xenbr0 iface xenbr0 <span class="hljs-type"><span class="hljs-type">inet</span></span> dhcp bridge_ports enp5s0</code> </pre> <br><br><h3>  Create a virtual machine image. </h3><br>  An example of creating a virtual machine with Ubuntu: <br><br><pre> <code class="hljs bash">sudo xen-create-image --hostname <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> --dhcp --pygrub --dist precise --mirror=<span class="hljs-string"><span class="hljs-string">"http://mirror.yandex.ru/ubuntu"</span></span> --dir /srv/xen/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span></code> </pre> <br>  The <code>--pygrub</code> flag indicates that the PyGrub boot loader will be used in the virtual machine, allowing each virtual machine to use its own kernel instead of the dom0 kernel.  The <code>--dir</code> parameter indicates that you want to use the directory for images, and not a separate partition of a previously broken disk. <br><br><div class="spoiler">  <b class="spoiler_title">The conclusion is approximately as follows:</b> <div class="spoiler_text">  General information <br>  - Hostname: test <br>  Distribution: precise <br>  Mirror: <a href="http://mirror.yandex.ru/ubuntu">mirror.yandex.ru/ubuntu</a> <br>  Partitions: swap 512M (swap) <br>  / 4G (ext4) <br>  Image type: sparse <br>  Memory size: 256M <br>  Bootloader: pygrub <br><br>  Networking information <br>  - IP Address: DHCP [MAC: 00: 16: 3E: 8E: 3C: E0] <br><br>  Creating partition image: /srv/xen/test/domains/test/swap.img <br>  Done <br><br>  Creating swap on /srv/xen/test/domains/test/swap.img <br>  Done <br><br>  Creating partition image: /srv/xen/test/domains/test/disk.img <br>  Done <br><br>  Creating ext4 filesystem on /srv/xen/test/domains/test/disk.img <br>  Done <br>  Installation method: debootstrap <br>  Done <br><br>  Running hooks <br>  Done <br><br>  No role scripts were specified.  Skipping <br><br>  Creating Xen configuration file <br>  Done <br><br>  No role scripts were specified.  Skipping <br>  Setting up root password <br>  Generating a password for the new guest. <br>  All done <br><br>  Logfile produced at: <br>  /var/log/xen-tools/test.log <br><br>  Installation Summary <br>  - Hostname: test <br>  Distribution: precise <br>  MAC Address: 00: 16: 3E: 8E: 3C: E0 <br>  IP Address (es): dynamic <br>  SSH Fingerprint: SHA256: H49PEnPv0k0tw2faq1CStkR6KFlHF0GkUOWvYaeiqOU (DSA) <br>  SSH Fingerprint: SHA256: 5gIsrTAriqEiwdkVCygOtLOi9uOd2DJWFBlJKxdJfUw (ECDSA) <br>  SSH Fingerprint: SHA256: SB + bTbkIUr2Qn019xT8AFtAKO5f6xlkbt8juVBq6zTE (RSA) <br>  Root Password: RJpaLfBFseH9YJX77ScxRwP <br></div></div><br>  You can make sure that the image is created using the command: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sudo</span></span> xen-list-images</code> </pre> <br>  In my case, the team issued <br><br><pre> <code class="hljs cmake">Name: <span class="hljs-keyword"><span class="hljs-keyword">test</span></span> Memory: <span class="hljs-number"><span class="hljs-number">256</span></span> MB Config: /etc/xen/<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>.cfg</code> </pre> <br><h3>  Start (car creation) </h3><br><pre> <code class="hljs pgsql">sudo xl <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> /etc/xen/test.cfg</code> </pre> <br>  Now virtualka test will appear when calling the command ‚Äúsudo xl list‚Äù: <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">Name</span></span> ID Mem VCPUs State <span class="hljs-type"><span class="hljs-type">Time</span></span>(s) <span class="hljs-keyword"><span class="hljs-keyword">Domain</span></span><span class="hljs-number"><span class="hljs-number">-0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">15356</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> r<span class="hljs-comment"><span class="hljs-comment">----- 4283.8 test 2 256 1 -b---- 1.5</span></span></code> </pre> <br>  It remains to connect to its console: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sudo</span></span> xl console test</code> </pre> <br>  Exit from the console of the virtual machine by the combination <code>"ctrl + ]"</code> <br><br><div class="spoiler">  <b class="spoiler_title">The resulting conclusion</b> <div class="spoiler_text"><pre> <code class="hljs vhdl">[ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Initializing cgroup subsys cpuset [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Initializing cgroup subsys cpu [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Linux version <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">126</span></span>-virtual (buildd@lcy01-<span class="hljs-number"><span class="hljs-number">11</span></span>) (gcc version <span class="hljs-number"><span class="hljs-number">4.6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> (Ubuntu/Linaro <span class="hljs-number"><span class="hljs-number">4.6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>ubuntu5) ) #<span class="hljs-number"><span class="hljs-number">169</span></span>-Ubuntu SMP Fri Mar <span class="hljs-number"><span class="hljs-number">31</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span> UTC <span class="hljs-number"><span class="hljs-number">2017</span></span> (Ubuntu <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">126.169</span></span>-virtual <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">79</span></span>) [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Command <span class="hljs-literal"><span class="hljs-literal">line</span></span>: root=/dev/xvda2 ro elevator=noop root=/dev/xvda2 ro [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] KERNEL supported cpus: [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Intel GenuineIntel [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] AMD AuthenticAMD [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Centaur CentaurHauls [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] ACPI <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unprivileged domain disabled [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Released <span class="hljs-number"><span class="hljs-number">0</span></span> pages <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> unused memory [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Set <span class="hljs-number"><span class="hljs-number">0</span></span> page(s) <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span> mapping [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] BIOS-provided physical RAM <span class="hljs-keyword"><span class="hljs-keyword">map</span></span>: [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Xen: <span class="hljs-number"><span class="hljs-number">0000000000000000</span></span> - <span class="hljs-number"><span class="hljs-number">00000000000</span></span>a0000 (usable) [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Xen: <span class="hljs-number"><span class="hljs-number">00000000000</span></span>a0000 - <span class="hljs-number"><span class="hljs-number">0000000000100000</span></span> (reserved) [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Xen: <span class="hljs-number"><span class="hljs-number">0000000000100000</span></span> - <span class="hljs-number"><span class="hljs-number">0000000010000000</span></span> (usable) [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] NX (Execute Disable) protection: active [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] DMI <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> present <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> invalid. [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] No AGP bridge found [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] last_pfn = <span class="hljs-number"><span class="hljs-number">0</span></span>x10000 max_arch_pfn = <span class="hljs-number"><span class="hljs-number">0</span></span>x400000000 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] init_memory_mapping: <span class="hljs-number"><span class="hljs-number">0000000000000000</span></span>-<span class="hljs-number"><span class="hljs-number">0000000010000000</span></span> [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] RAMDISK: <span class="hljs-number"><span class="hljs-number">0205</span></span>c000 - <span class="hljs-number"><span class="hljs-number">02</span></span>c43000 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] NUMA turned off [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Faking a node at <span class="hljs-number"><span class="hljs-number">0000000000000000</span></span>-<span class="hljs-number"><span class="hljs-number">0000000010000000</span></span> [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Initmem setup node <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0000000000000000</span></span>-<span class="hljs-number"><span class="hljs-number">0000000010000000</span></span> [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] NODE_DATA [<span class="hljs-number"><span class="hljs-number">000000000</span></span>fffb000 - <span class="hljs-number"><span class="hljs-number">000000000</span></span>fffffff] [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Zone PFN ranges: [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] DMA <span class="hljs-number"><span class="hljs-number">0</span></span>x00000010 -&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>x00001000 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] DMA32 <span class="hljs-number"><span class="hljs-number">0</span></span>x00001000 -&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>x00100000 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Normal empty [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Movable zone start PFN <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> each node [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] early_node_map[<span class="hljs-number"><span class="hljs-number">2</span></span>] active PFN ranges [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>x00000010 -&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>x000000a0 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>x00000100 -&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>x00010000 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] SFI: Simple Firmware Interface v0.<span class="hljs-number"><span class="hljs-number">81</span></span> http://simplefirmware.org [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] SMP: Allowing <span class="hljs-number"><span class="hljs-number">1</span></span> CPUs, <span class="hljs-number"><span class="hljs-number">0</span></span> hotplug CPUs [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] No local APIC present [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] APIC: disable apic facility [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] APIC: switched <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> apic NOOP [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] PM: Registered nosave memory: <span class="hljs-number"><span class="hljs-number">00000000000</span></span>a0000 - <span class="hljs-number"><span class="hljs-number">0000000000100000</span></span> [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Allocating PCI resources starting at <span class="hljs-number"><span class="hljs-number">10000000</span></span> (gap: <span class="hljs-number"><span class="hljs-number">10000000</span></span>:f0000000) [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Booting paravirtualized kernel <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> Xen [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Xen version: <span class="hljs-number"><span class="hljs-number">4.8</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-pre (preserve-AD) [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] setup_percpu: NR_CPUS:<span class="hljs-number"><span class="hljs-number">64</span></span> nr_cpumask_bits:<span class="hljs-number"><span class="hljs-number">64</span></span> nr_cpu_ids:<span class="hljs-number"><span class="hljs-number">1</span></span> nr_node_ids:<span class="hljs-number"><span class="hljs-number">1</span></span> [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] PERCPU: Embedded <span class="hljs-number"><span class="hljs-number">27</span></span> pages/cpu @ffff88000fc00000 s78848 r8192 d23552 u2097152 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Built <span class="hljs-number"><span class="hljs-number">1</span></span> zonelists <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Node order, mobility grouping <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>. Total pages: <span class="hljs-number"><span class="hljs-number">64395</span></span> [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Policy zone: DMA32 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Kernel command <span class="hljs-literal"><span class="hljs-literal">line</span></span>: root=/dev/xvda2 ro elevator=noop root=/dev/xvda2 ro [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] PID hash table entries: <span class="hljs-number"><span class="hljs-number">1024</span></span> (order: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">8192</span></span> bytes) [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] xsave/xrstor: enabled xstate_bv <span class="hljs-number"><span class="hljs-number">0</span></span>x7, cntxt size <span class="hljs-number"><span class="hljs-number">0</span></span>x340 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Checking aperture... [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] No AGP bridge found [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Memory: <span class="hljs-number"><span class="hljs-number">228408</span></span>k/<span class="hljs-number"><span class="hljs-number">262144</span></span>k available (<span class="hljs-number"><span class="hljs-number">6617</span></span>k kernel code, <span class="hljs-number"><span class="hljs-number">448</span></span>k absent, <span class="hljs-number"><span class="hljs-number">33288</span></span>k reserved, <span class="hljs-number"><span class="hljs-number">6579</span></span>k data, <span class="hljs-number"><span class="hljs-number">932</span></span>k init) [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] SLUB: Genslabs=<span class="hljs-number"><span class="hljs-number">15</span></span>, HWalign=<span class="hljs-number"><span class="hljs-number">64</span></span>, Order=<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">3</span></span>, MinObjects=<span class="hljs-number"><span class="hljs-number">0</span></span>, CPUs=<span class="hljs-number"><span class="hljs-number">1</span></span>, Nodes=<span class="hljs-number"><span class="hljs-number">1</span></span> [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Hierarchical RCU implementation. [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] RCU dyntick-idle grace-period acceleration <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> enabled. [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] NR_IRQS:<span class="hljs-number"><span class="hljs-number">4352</span></span> nr_irqs:<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Console: colour dummy device <span class="hljs-number"><span class="hljs-number">80</span></span>x25 [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] console [tty0] enabled [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] console [hvc0] enabled [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] allocated <span class="hljs-number"><span class="hljs-number">2097152</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> page_cgroup [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] please try <span class="hljs-symbol"><span class="hljs-symbol">'cgroup_disable</span></span>=memory' option <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you don<span class="hljs-symbol"><span class="hljs-symbol">'t</span></span> want memory cgroups [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] installing Xen timer <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> CPU <span class="hljs-number"><span class="hljs-number">0</span></span> [ <span class="hljs-number"><span class="hljs-number">0.000000</span></span>] Detected <span class="hljs-number"><span class="hljs-number">3194.398</span></span> MHz processor. [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Calibrating delay <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> (skipped), value calculated using timer frequency.. <span class="hljs-number"><span class="hljs-number">6388.79</span></span> BogoMIPS (lpj=<span class="hljs-number"><span class="hljs-number">12777592</span></span>) [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] pid_max: <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-number"><span class="hljs-number">32768</span></span> minimum: <span class="hljs-number"><span class="hljs-number">301</span></span> [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Security Framework initialized [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] AppArmor: AppArmor initialized [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Yama: becoming mindful. [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Dentry cache hash table entries: <span class="hljs-number"><span class="hljs-number">32768</span></span> (order: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">262144</span></span> bytes) [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Inode-cache hash table entries: <span class="hljs-number"><span class="hljs-number">16384</span></span> (order: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">131072</span></span> bytes) [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Mount-cache hash table entries: <span class="hljs-number"><span class="hljs-number">256</span></span> [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Initializing cgroup subsys cpuacct [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Initializing cgroup subsys memory [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Initializing cgroup subsys devices [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Initializing cgroup subsys freezer [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Initializing cgroup subsys blkio [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] Initializing cgroup subsys perf_event [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] CPU: Physical Processor ID: <span class="hljs-number"><span class="hljs-number">0</span></span> [ <span class="hljs-number"><span class="hljs-number">0.004000</span></span>] CPU: Processor Core ID: <span class="hljs-number"><span class="hljs-number">0</span></span> [ <span class="hljs-number"><span class="hljs-number">0.006575</span></span>] SMP alternatives: switching <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> UP code [ <span class="hljs-number"><span class="hljs-number">0.034623</span></span>] Freeing SMP alternatives: <span class="hljs-number"><span class="hljs-number">24</span></span>k freed [ <span class="hljs-number"><span class="hljs-number">0.034647</span></span>] ftrace: allocating <span class="hljs-number"><span class="hljs-number">26699</span></span> entries <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">105</span></span> pages [ <span class="hljs-number"><span class="hljs-number">0.036061</span></span>] cpu <span class="hljs-number"><span class="hljs-number">0</span></span> spinlock event irq <span class="hljs-number"><span class="hljs-number">17</span></span> [ <span class="hljs-number"><span class="hljs-number">0.036079</span></span>] Performance Events: [ <span class="hljs-number"><span class="hljs-number">0.036082</span></span>] no APIC, boot <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the <span class="hljs-string"><span class="hljs-string">"lapic"</span></span> boot <span class="hljs-keyword"><span class="hljs-keyword">parameter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">force</span></span>-enable it. [ <span class="hljs-number"><span class="hljs-number">0.036086</span></span>] no hardware sampling interrupt available. [ <span class="hljs-number"><span class="hljs-number">0.036094</span></span>] Broken PMU hardware detected, using software events only. [ <span class="hljs-number"><span class="hljs-number">0.036207</span></span>] NMI watchdog disabled (cpu0): hardware events <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> enabled [ <span class="hljs-number"><span class="hljs-number">0.036229</span></span>] Brought up <span class="hljs-number"><span class="hljs-number">1</span></span> CPUs [ <span class="hljs-number"><span class="hljs-number">0.036343</span></span>] devtmpfs: initialized [ <span class="hljs-number"><span class="hljs-number">0.036844</span></span>] EVM: security.selinux [ <span class="hljs-number"><span class="hljs-number">0.036848</span></span>] EVM: security.SMACK64 [ <span class="hljs-number"><span class="hljs-number">0.036851</span></span>] EVM: security.capability [ <span class="hljs-number"><span class="hljs-number">0.037364</span></span>] Grant table initialized [ <span class="hljs-number"><span class="hljs-number">0.037410</span></span>] print_constraints: dummy: [ <span class="hljs-number"><span class="hljs-number">0.057265</span></span>] RTC <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>: <span class="hljs-number"><span class="hljs-number">165</span></span>:<span class="hljs-number"><span class="hljs-number">165</span></span>:<span class="hljs-number"><span class="hljs-number">165</span></span>, date: <span class="hljs-number"><span class="hljs-number">165</span></span>/<span class="hljs-number"><span class="hljs-number">165</span></span>/<span class="hljs-number"><span class="hljs-number">65</span></span> [ <span class="hljs-number"><span class="hljs-number">0.057318</span></span>] NET: Registered protocol family <span class="hljs-number"><span class="hljs-number">16</span></span> [ <span class="hljs-number"><span class="hljs-number">0.057508</span></span>] Extended Config Space enabled <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> nodes [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] PCI: setting up Xen PCI frontend stub [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] bio: create slab &lt;bio-<span class="hljs-number"><span class="hljs-number">0</span></span>&gt; at <span class="hljs-number"><span class="hljs-number">0</span></span> [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] ACPI: Interpreter disabled. [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] xen/balloon: Initialising balloon driver. [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] xen-balloon: Initialising balloon driver. [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] vgaarb: loaded [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] i2c-core: driver [aat2870] using legacy suspend method [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] i2c-core: driver [aat2870] using legacy resume method [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] SCSI subsystem initialized [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] usbcore: registered <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> interface driver usbfs [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] usbcore: registered <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> interface driver hub [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] usbcore: registered <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> device driver usb [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] PCI: System does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> support PCI [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] PCI: System does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> support PCI [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] NetLabel: Initializing [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] NetLabel: domain hash size = <span class="hljs-number"><span class="hljs-number">128</span></span> [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] NetLabel: protocols = UNLABELED CIPSOv4 [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] NetLabel: unlabeled traffic allowed by <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> [ <span class="hljs-number"><span class="hljs-number">0.057542</span></span>] Switching <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> clocksource xen [ <span class="hljs-number"><span class="hljs-number">0.061230</span></span>] AppArmor: AppArmor Filesystem Enabled [ <span class="hljs-number"><span class="hljs-number">0.061253</span></span>] pnp: PnP ACPI: disabled [ <span class="hljs-number"><span class="hljs-number">0.062521</span></span>] NET: Registered protocol family <span class="hljs-number"><span class="hljs-number">2</span></span> [ <span class="hljs-number"><span class="hljs-number">0.065648</span></span>] IP route cache hash table entries: <span class="hljs-number"><span class="hljs-number">2048</span></span> (order: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">16384</span></span> bytes) [ <span class="hljs-number"><span class="hljs-number">0.065807</span></span>] TCP established hash table entries: <span class="hljs-number"><span class="hljs-number">8192</span></span> (order: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">131072</span></span> bytes) [ <span class="hljs-number"><span class="hljs-number">0.065861</span></span>] TCP bind hash table entries: <span class="hljs-number"><span class="hljs-number">8192</span></span> (order: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">131072</span></span> bytes) [ <span class="hljs-number"><span class="hljs-number">0.065881</span></span>] TCP: Hash tables configured (established <span class="hljs-number"><span class="hljs-number">8192</span></span> bind <span class="hljs-number"><span class="hljs-number">8192</span></span>) [ <span class="hljs-number"><span class="hljs-number">0.065885</span></span>] TCP reno registered [ <span class="hljs-number"><span class="hljs-number">0.065889</span></span>] UDP hash table entries: <span class="hljs-number"><span class="hljs-number">128</span></span> (order: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4096</span></span> bytes) [ <span class="hljs-number"><span class="hljs-number">0.065895</span></span>] UDP-Lite hash table entries: <span class="hljs-number"><span class="hljs-number">128</span></span> (order: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4096</span></span> bytes) [ <span class="hljs-number"><span class="hljs-number">0.065934</span></span>] NET: Registered protocol family <span class="hljs-number"><span class="hljs-number">1</span></span> [ <span class="hljs-number"><span class="hljs-number">0.065967</span></span>] platform rtc_cmos: registered platform RTC device (no PNP device found) [ <span class="hljs-number"><span class="hljs-number">0.066094</span></span>] Trying <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> unpack rootfs image as initramfs... [ <span class="hljs-number"><span class="hljs-number">0.072210</span></span>] audit: initializing netlink socket (disabled) [ <span class="hljs-number"><span class="hljs-number">0.190742</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>=<span class="hljs-number"><span class="hljs-number">2000</span></span> audit(<span class="hljs-number"><span class="hljs-number">1518793913.856</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>): initialized [ <span class="hljs-number"><span class="hljs-number">0.209702</span></span>] Freeing initrd memory: <span class="hljs-number"><span class="hljs-number">12188</span></span>k freed [ <span class="hljs-number"><span class="hljs-number">0.213726</span></span>] VFS: Disk quotas dquot_6.<span class="hljs-number"><span class="hljs-number">5.2</span></span> [ <span class="hljs-number"><span class="hljs-number">0.213770</span></span>] Dquot-cache hash table entries: <span class="hljs-number"><span class="hljs-number">512</span></span> (order <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4096</span></span> bytes) [ <span class="hljs-number"><span class="hljs-number">0.213950</span></span>] hugetlbfs: disabling because there are no supported hugepage sizes [ <span class="hljs-number"><span class="hljs-number">0.214050</span></span>] fuse init (API version <span class="hljs-number"><span class="hljs-number">7.17</span></span>) [ <span class="hljs-number"><span class="hljs-number">0.214104</span></span>] msgmni has been set <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">469</span></span> [ <span class="hljs-number"><span class="hljs-number">0.214342</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">Block</span></span> layer SCSI <span class="hljs-keyword"><span class="hljs-keyword">generic</span></span> (bsg) driver version <span class="hljs-number"><span class="hljs-number">0.4</span></span> loaded (major <span class="hljs-number"><span class="hljs-number">253</span></span>) [ <span class="hljs-number"><span class="hljs-number">0.214362</span></span>] io scheduler noop registered (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>) [ <span class="hljs-number"><span class="hljs-number">0.214367</span></span>] io scheduler deadline registered [ <span class="hljs-number"><span class="hljs-number">0.214386</span></span>] io scheduler cfq registered [ <span class="hljs-number"><span class="hljs-number">0.214439</span></span>] pci_hotplug: PCI Hot Plug PCI Core version: <span class="hljs-number"><span class="hljs-number">0.5</span></span> [ <span class="hljs-number"><span class="hljs-number">0.214454</span></span>] pciehp: PCI Express Hot Plug Controller Driver version: <span class="hljs-number"><span class="hljs-number">0.4</span></span> [ <span class="hljs-number"><span class="hljs-number">0.214460</span></span>] acpiphp: ACPI Hot Plug PCI Controller Driver version: <span class="hljs-number"><span class="hljs-number">0.5</span></span> [ <span class="hljs-number"><span class="hljs-number">0.214672</span></span>] Serial: <span class="hljs-number"><span class="hljs-number">8250</span></span>/<span class="hljs-number"><span class="hljs-number">16550</span></span> driver, <span class="hljs-number"><span class="hljs-number">32</span></span> ports, IRQ sharing enabled [ <span class="hljs-number"><span class="hljs-number">0.215413</span></span>] Linux agpgart interface v0.<span class="hljs-number"><span class="hljs-number">103</span></span> [ <span class="hljs-number"><span class="hljs-number">0.216235</span></span>] brd: module loaded [ <span class="hljs-number"><span class="hljs-number">0.216618</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>: module loaded [ <span class="hljs-number"><span class="hljs-number">0.217745</span></span>] blkfront device/vbd/<span class="hljs-number"><span class="hljs-number">51714</span></span> num-ring-pages <span class="hljs-number"><span class="hljs-number">1</span></span> nr_ents <span class="hljs-number"><span class="hljs-number">32</span></span>. [ <span class="hljs-number"><span class="hljs-number">0.218925</span></span>] blkfront device/vbd/<span class="hljs-number"><span class="hljs-number">51713</span></span> num-ring-pages <span class="hljs-number"><span class="hljs-number">1</span></span> nr_ents <span class="hljs-number"><span class="hljs-number">32</span></span>. [ <span class="hljs-number"><span class="hljs-number">0.219299</span></span>] Fixed MDIO <span class="hljs-keyword"><span class="hljs-keyword">Bus</span></span>: probed [ <span class="hljs-number"><span class="hljs-number">0.219322</span></span>] tun: Universal TUN/TAP device driver, <span class="hljs-number"><span class="hljs-number">1.6</span></span> [ <span class="hljs-number"><span class="hljs-number">0.219329</span></span>] tun: (C) <span class="hljs-number"><span class="hljs-number">1999</span></span>-<span class="hljs-number"><span class="hljs-number">2004</span></span> Max Krasnyansky &lt;maxk@qualcomm.com&gt; [ <span class="hljs-number"><span class="hljs-number">0.219390</span></span>] PPP <span class="hljs-keyword"><span class="hljs-keyword">generic</span></span> driver version <span class="hljs-number"><span class="hljs-number">2.4</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> [ <span class="hljs-number"><span class="hljs-number">0.219430</span></span>] Initialising Xen virtual ethernet driver. [ <span class="hljs-number"><span class="hljs-number">0.222394</span></span>] ehci_hcd: USB <span class="hljs-number"><span class="hljs-number">2.0</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'Enhanced</span></span>' Host Controller (EHCI) Driver [ <span class="hljs-number"><span class="hljs-number">0.222413</span></span>] ohci_hcd: USB <span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'Open</span></span>' Host Controller (OHCI) Driver [ <span class="hljs-number"><span class="hljs-number">0.222423</span></span>] uhci_hcd: USB Universal Host Controller Interface driver [ <span class="hljs-number"><span class="hljs-number">0.222459</span></span>] usbcore: registered <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> interface driver libusual [ <span class="hljs-number"><span class="hljs-number">0.222477</span></span>] i8042: PNP: No PS/<span class="hljs-number"><span class="hljs-number">2</span></span> controller found. Probing ports directly. [ <span class="hljs-number"><span class="hljs-number">1.223457</span></span>] i8042: No controller found [ <span class="hljs-number"><span class="hljs-number">1.223625</span></span>] mousedev: PS/<span class="hljs-number"><span class="hljs-number">2</span></span> mouse device common <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> mice [ <span class="hljs-number"><span class="hljs-number">1.263475</span></span>] rtc_cmos rtc_cmos: rtc core: registered rtc_cmos as rtc0 [ <span class="hljs-number"><span class="hljs-number">1.263520</span></span>] rtc_cmos: probe <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> rtc_cmos failed <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-literal"><span class="hljs-literal">error</span></span> -<span class="hljs-number"><span class="hljs-number">38</span></span> [ <span class="hljs-number"><span class="hljs-number">1.263601</span></span>] device-mapper: uevent: version <span class="hljs-number"><span class="hljs-number">1.0</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> [ <span class="hljs-number"><span class="hljs-number">1.263654</span></span>] device-mapper: ioctl: <span class="hljs-number"><span class="hljs-number">4.22</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>-ioctl (<span class="hljs-number"><span class="hljs-number">2011</span></span>-<span class="hljs-number"><span class="hljs-number">10</span></span>-<span class="hljs-number"><span class="hljs-number">19</span></span>) initialised: dm-devel@redhat.com [ <span class="hljs-number"><span class="hljs-number">1.263664</span></span>] EFI Variables Facility v0.<span class="hljs-number"><span class="hljs-number">08</span></span> <span class="hljs-number"><span class="hljs-number">2004</span></span>-May-<span class="hljs-number"><span class="hljs-number">17</span></span> [ <span class="hljs-number"><span class="hljs-number">1.263886</span></span>] TCP cubic registered [ <span class="hljs-number"><span class="hljs-number">1.263952</span></span>] NET: Registered protocol family <span class="hljs-number"><span class="hljs-number">10</span></span> [ <span class="hljs-number"><span class="hljs-number">1.264555</span></span>] NET: Registered protocol family <span class="hljs-number"><span class="hljs-number">17</span></span> [ <span class="hljs-number"><span class="hljs-number">1.264564</span></span>] Registering the dns_resolver key <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> [ <span class="hljs-number"><span class="hljs-number">1.264668</span></span>] registered taskstats version <span class="hljs-number"><span class="hljs-number">1</span></span> [ <span class="hljs-number"><span class="hljs-number">1.273569</span></span>] blkfront: xvda2: flush diskcache: enabled [ <span class="hljs-number"><span class="hljs-number">1.274605</span></span>] blkfront: xvda1: flush diskcache: enabled [ <span class="hljs-number"><span class="hljs-number">1.368068</span></span>] Magic number: <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">252</span></span>:<span class="hljs-number"><span class="hljs-number">3141</span></span> [ <span class="hljs-number"><span class="hljs-number">1.368107</span></span>] /build/linux-JvAKgs/linux-<span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/drivers/rtc/hctosys.c: unable <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> rtc device (rtc0) [ <span class="hljs-number"><span class="hljs-number">1.368118</span></span>] BIOS EDD facility v0.<span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">2004</span></span>-Jun-<span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> devices found [ <span class="hljs-number"><span class="hljs-number">1.368121</span></span>] EDD information <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> available. [ <span class="hljs-number"><span class="hljs-number">1.368534</span></span>] Freeing unused kernel memory: <span class="hljs-number"><span class="hljs-number">932</span></span>k freed [ <span class="hljs-number"><span class="hljs-number">1.368687</span></span>] Write protecting the kernel read-only data: <span class="hljs-number"><span class="hljs-number">12288</span></span>k [ <span class="hljs-number"><span class="hljs-number">1.373188</span></span>] Freeing unused kernel memory: <span class="hljs-number"><span class="hljs-number">1556</span></span>k freed [ <span class="hljs-number"><span class="hljs-number">1.373812</span></span>] Freeing unused kernel memory: <span class="hljs-number"><span class="hljs-number">1172</span></span>k freed Loading, please <span class="hljs-keyword"><span class="hljs-keyword">wait</span></span>... <span class="hljs-keyword"><span class="hljs-keyword">Begin</span></span>: Loading essential drivers ... done. [ <span class="hljs-number"><span class="hljs-number">1.402645</span></span>] udevd[<span class="hljs-number"><span class="hljs-number">82</span></span>]: starting version <span class="hljs-number"><span class="hljs-number">175</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Begin</span></span>: Running /scripts/init-premount ... done. <span class="hljs-keyword"><span class="hljs-keyword">Begin</span></span>: Mounting root <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> system ... <span class="hljs-keyword"><span class="hljs-keyword">Begin</span></span>: Running /scripts/local-top ... done. <span class="hljs-keyword"><span class="hljs-keyword">Begin</span></span>: Running /scripts/local-premount ... done. [ <span class="hljs-number"><span class="hljs-number">1.506696</span></span>] JBD2: Unrecognised features <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> journal [ <span class="hljs-number"><span class="hljs-number">1.506706</span></span>] EXT4-fs (xvda2): <span class="hljs-literal"><span class="hljs-literal">error</span></span> loading journal mount: mounting /dev/xvda2 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> /root failed: Invalid argument <span class="hljs-keyword"><span class="hljs-keyword">Begin</span></span>: Running /scripts/local-bottom ... done. done. <span class="hljs-keyword"><span class="hljs-keyword">Begin</span></span>: Running /scripts/init-bottom ... mount: mounting /dev <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> /root/dev failed: No such <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> directory done. mount: mounting /sys <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> /root/sys failed: No such <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> directory mount: mounting /proc <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> /root/proc failed: No such <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> directory Target filesystem doesn<span class="hljs-symbol"><span class="hljs-symbol">'t</span></span> have requested /sbin/init. No init found. Try passing init= bootarg. BusyBox v1.<span class="hljs-number"><span class="hljs-number">18.5</span></span> (Ubuntu <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">1.18</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>ubuntu4) built-<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> shell (ash) Enter <span class="hljs-symbol"><span class="hljs-symbol">'help</span></span>' <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a list <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> built-<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> commands. (initramfs)</code> </pre> <br></div></div><br>  Let's see what this image is: <br><br><pre> <code class="hljs delphi">(initramfs) uname -a Linux (none) <span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">126</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> <span class="hljs-string"><span class="hljs-string">#169</span></span>-Ubuntu SMP Fri Mar <span class="hljs-number"><span class="hljs-number">31</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span> UTC <span class="hljs-number"><span class="hljs-number">2017</span></span> x86_64 GNU/Linux (initramfs)</code> </pre> <br><h2>  Run a small OS (Mini-OS) </h2><br>  From the previous part, it became clear that to work you need to create a domain (instance).  It is created using the xl utility based on the configuration file. <br><br><div class="spoiler">  <b class="spoiler_title">But if we look at the configuration file</b> <div class="spoiler_text"><pre> <code class="hljs mel"># # Configuration <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the Xen <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> test, created # by xen-tools <span class="hljs-number"><span class="hljs-number">4.7</span></span> on Fri Feb <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">35</span></span> <span class="hljs-number"><span class="hljs-number">2018.</span></span> # # # Kernel + <span class="hljs-keyword"><span class="hljs-keyword">memory</span></span> <span class="hljs-keyword"><span class="hljs-keyword">size</span></span> # bootloader = <span class="hljs-string"><span class="hljs-string">'/usr/lib/xen-4.8/bin/pygrub'</span></span> vcpus = <span class="hljs-string"><span class="hljs-string">'1'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">memory</span></span> = <span class="hljs-string"><span class="hljs-string">'256'</span></span> # # Disk device(s). # root = <span class="hljs-string"><span class="hljs-string">'/dev/xvda2 ro'</span></span> disk = [ <span class="hljs-string"><span class="hljs-string">'file:/srv/xen/test/domains/test/disk.img,xvda2,w'</span></span>, <span class="hljs-string"><span class="hljs-string">'file:/srv/xen/test/domains/test/swap.img,xvda1,w'</span></span>, ] # # Physical volumes # # # Hostname # name = <span class="hljs-string"><span class="hljs-string">'test'</span></span> # # Networking # dhcp = <span class="hljs-string"><span class="hljs-string">'dhcp'</span></span> vif = [ <span class="hljs-string"><span class="hljs-string">'mac=00:16:3E:8E:3C:E0'</span></span> ] # # Behaviour # on_poweroff = <span class="hljs-string"><span class="hljs-string">'destroy'</span></span> on_reboot = <span class="hljs-string"><span class="hljs-string">'restart'</span></span> on_crash = <span class="hljs-string"><span class="hljs-string">'restart'</span></span></code> </pre> <br></div></div><br>  Then we will see that it requires the presence of disk images, there is a network, and so on.  Most likely, it is too difficult for our purposes.  But Xen supports other operating systems.  The base is the so-called <a href="https://wiki.xenproject.org/wiki/Mini-OS">Mini-OS</a> .  And it is designed for those who want to <a href="https://wiki.xenproject.org/wiki/Mini-OS-DevNotes">port their operating systems to XEN</a> , that is, this is just our option. <br>  <a href="http://xenbits.xenproject.org/gitweb/%3Fp%3Dmini-os.git">The git code</a> is separate from XEN. <br><br>  Let's do the instructions from the README right away. <br><br><pre> <code class="hljs swift">make sudo xl create -<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> domain_config</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">We get a conclusion</b> <div class="spoiler_text"><pre> <code class="hljs sql">Parsing config from domain_config Xen Minimal OS (pv)! start_info: 0x7d000(VA) nr_pages: 0x2000 shared_inf: 0xdee73000(MA) pt_base: 0x80000(VA) nr_pt_frames: 0x5 mfn_list: 0x6d000(VA) mod_start: 0x0(VA) mod_len: 0 flags: 0x0 cmd_line: stack: 0x2c6a0-0x4c6a0 MM: Init _text: 0(VA) _etext: 0x18484(VA) _erodata: 0x1f000(VA) _edata: 0x1f252(VA) stack <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>: <span class="hljs-number"><span class="hljs-number">0x2c6a0</span></span>(VA) _end: <span class="hljs-number"><span class="hljs-number">0x6cfd8</span></span>(VA) start_pfn: <span class="hljs-number"><span class="hljs-number">85</span></span> max_pfn: <span class="hljs-number"><span class="hljs-number">2000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Mapping</span></span> <span class="hljs-keyword"><span class="hljs-keyword">memory</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> <span class="hljs-number"><span class="hljs-number">0x85000</span></span> - <span class="hljs-number"><span class="hljs-number">0x2000000</span></span> setting <span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-0x1f000</span></span> readonly skipped <span class="hljs-number"><span class="hljs-number">1000</span></span> MM: Initialise page allocator <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">93000</span></span>(<span class="hljs-number"><span class="hljs-number">93000</span></span>)<span class="hljs-number"><span class="hljs-number">-2000000</span></span>(<span class="hljs-number"><span class="hljs-number">2000000</span></span>) Adding <span class="hljs-keyword"><span class="hljs-keyword">memory</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> <span class="hljs-number"><span class="hljs-number">94000</span></span><span class="hljs-number"><span class="hljs-number">-2000000</span></span> MM: done <span class="hljs-keyword"><span class="hljs-keyword">Demand</span></span> <span class="hljs-keyword"><span class="hljs-keyword">map</span></span> pfns <span class="hljs-keyword"><span class="hljs-keyword">at</span></span> <span class="hljs-number"><span class="hljs-number">100000000000</span></span><span class="hljs-number"><span class="hljs-number">-108000000000.</span></span> Initialising timer <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> Initialising console ... done. gnttab_table mapped <span class="hljs-keyword"><span class="hljs-keyword">at</span></span> <span class="hljs-number"><span class="hljs-number">0x100000000000</span></span>. Initialising scheduler <span class="hljs-keyword"><span class="hljs-keyword">Thread</span></span> <span class="hljs-string"><span class="hljs-string">"Idle"</span></span>: pointer: <span class="hljs-number"><span class="hljs-number">0x0</span></span>x96078, stack: <span class="hljs-number"><span class="hljs-number">0x0</span></span>xa0000 <span class="hljs-keyword"><span class="hljs-keyword">Thread</span></span> <span class="hljs-string"><span class="hljs-string">"xenstore"</span></span>: pointer: <span class="hljs-number"><span class="hljs-number">0x0</span></span>x960d8, stack: <span class="hljs-number"><span class="hljs-number">0x0</span></span>xb0000 xenbus initialised <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> irq <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Thread</span></span> <span class="hljs-string"><span class="hljs-string">"shutdown"</span></span>: pointer: <span class="hljs-number"><span class="hljs-number">0x0</span></span>x96138, stack: <span class="hljs-number"><span class="hljs-number">0x0</span></span>xc0000 kernel.c: dummy <span class="hljs-keyword"><span class="hljs-keyword">main</span></span>: par=<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br></div></div><br>  Exit from the console, as usual, ctrl +] <br><br>  Check that we have started some kind of car <br><br><pre> <code class="hljs pgsql">sudo xl list <span class="hljs-type"><span class="hljs-type">Name</span></span> ID Mem VCPUs State <span class="hljs-type"><span class="hljs-type">Time</span></span>(s) <span class="hljs-keyword"><span class="hljs-keyword">Domain</span></span><span class="hljs-number"><span class="hljs-number">-0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">15455</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> r<span class="hljs-comment"><span class="hljs-comment">----- 5117.7 Mini-OS 2 32 1 -b---- 0.0</span></span></code> </pre> <br>  To return to the console <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sudo</span></span> xl console Mini-OS</code> </pre> <br>  To delete a domain <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sudo</span></span> xl destroy Mini-OS</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Well, let's look at the contents of domain_config in the root of the project.</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"># -*- mode: python; -*- #============================================================================ # Python <span class="hljs-keyword"><span class="hljs-keyword">configuration</span></span> setup <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-string"><span class="hljs-string">'xm create'</span></span>. # This script sets the parameters used <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">domain</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> created <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-string"><span class="hljs-string">'xm create'</span></span>. # You use a separate script <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> <span class="hljs-keyword"><span class="hljs-keyword">domain</span></span> you want <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">create</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> # you can <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> the parameters <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">domain</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the xm command <span class="hljs-type"><span class="hljs-type">line</span></span>. #============================================================================ #<span class="hljs-comment"><span class="hljs-comment">---------------------------------------------------------------------------- # Kernel image file. kernel = "mini-os.gz" # Initial memory allocation (in megabytes) for the new domain. memory = 32 # A name for your domain. All domains must have different names. name = "Mini-OS" on_crash = 'destroy'</span></span></code> </pre> <br></div></div><br>  It can be seen that you can specify not disks, but directly the image using the parameter <i>kernel</i> , and also not specify network settings and other parameters that we do not need in the first stage. <br><br><h2>  Porting Embox to Xen </h2><br><h3>  Creating a configuration file </h3><br>  To begin with, to launch a domain with Embox, we will make a configuration file in the image of Mini-OS. <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">name</span></span> = "embox" memory = <span class="hljs-number"><span class="hljs-number">256</span></span> kernel = "/tmp/xen_embox"</code> </pre> <br><h3>  Adding Architecture to Embox </h3><br>  Embox has a diploma from Anton Kozlov ( <a href="https://habrahabr.ru/users/antonkozlov/" class="user_link">antonkozlov</a> ) about transferring it to a new platform <a href="http://se.math.spbu.ru/SE/diploma/2013/s/KozlovAnton_thesis.pdf">‚ÄúPorting an operating system with a modular HAL to user mode‚Äù</a> .  More precisely, the diploma was not about transferring Embox, but about the organization of operating systems in general, and Embox was used as a guinea pig.  Specifically about Xen, there is Andrei Golikov‚Äôs coursework <a href="https://trello-attachments.s3.amazonaws.com/5451fe127808086e8b6b483e/59f9a81ab118815f971f1186/47d3744c3bfa9637a0e8011efc3ab757/%25D0%25BA%25D1%2583%25D1%2580%25D1%2581%25D0%25BE%25D0%25B2%25D0%25B0%25D1%258F.pdf">‚ÄúPorting Embox operating system to Xen platform‚Äù</a> .  In order not to retell the diploma and coursework, I will confine myself to several important and Xen-specific parts. <br><br>  All the necessary information, as you probably guessed, can be obtained from the <a href="https://wiki.xenproject.org/wiki/Mini-OS-DevNotes">Mini-OS</a> . <br><br>  One of the first things porting begins with is a memory card (no, not an SD card, which you might have thought of, but a different memory map about different regions of memory), traditionally described in the lds script.  The linker needs to specify where the program code, data, entry point to the program, and so on should lie.  In our case, this also adds the fact that before downloading the image, some features must be read from the ‚Äú.note.Xen‚Äù sections, more precisely, the header in the ELF PT_NOTE format.  A memory card with features described <a href="https://wiki.xenproject.org/wiki/X86_Paravirtualised_Memory_Management">here</a> . <br><br>  The following is added to the Embox linker script for Xen: <br><br><pre> <code class="hljs ruby">PHDRS { xen PT_NOTE; } SECTIONS { .note : { *(.note) } <span class="hljs-symbol"><span class="hljs-symbol">:xen</span></span> }</code> </pre> <br>  Well, an assembly file was added that contains the content for this header. <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;xen/elfnote.h&gt; .section ".note", "a" #define ELFNOTE(type, desc) \ .p2align 2; \ .long 1f - 0f; \ .long 3f - 2f; \ .long type; \ 0: .asciz "Xen"; \ 1: .p2align 2; \ 2: desc; \ 3: .p2align 2; ELFNOTE(XEN_ELFNOTE_XEN_VERSION, .asciz "xen-3.0") ELFNOTE(XEN_ELFNOTE_LOADER, .asciz "generic") ELFNOTE(XEN_ELFNOTE_PAE_MODE, .asciz "yes") ELFNOTE(XEN_ELFNOTE_VIRT_BASE, .long 0x100000) ELFNOTE(XEN_ELFNOTE_PADDR_OFFSET, .long 0x100000) ELFNOTE(XEN_ELFNOTE_HYPERCALL_PAGE, .long 0x100000)</span></span></span></span></code> </pre><br>  In addition, there are a couple of structures needed for interaction between the image and Xen struct start_info and struct shared_info. <br>  struct start_info is needed if we want to receive information about the machine when starting an image, that is, without it, in principle, we can do. <br><br><pre> <code class="cpp hljs">* * `incontents <span class="hljs-number"><span class="hljs-number">200</span></span> startofday_shared Start-of-day shared data structure * Xen/kernel shared data -- pointer provided in start_info. * * This structure is defined to be both smaller than a page, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> the * only data on the shared page, but may vary in actual size even within * compatible Xen versions; guests should <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> rely on the size * of <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> structure remaining constant. */ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shared_info</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vcpu_info</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vcpu_info</span></span></span><span class="hljs-class">[</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XEN_LEGACY_MAX_VCPUS</span></span></span><span class="hljs-class">];</span></span> <span class="hljs-comment"><span class="hljs-comment">/* * A domain can create "event channels" on which it can send and receive * asynchronous event notifications. There are three classes of event that * are delivered by this mechanism: * 1. Bi-directional inter- and intra-domain connections. Domains must * arrange out-of-band to set up a connection (usually by allocating * an unbound 'listener' port and avertising that via a storage service * such as xenstore). * 2. Physical interrupts. A domain with suitable hardware-access * privileges can bind an event-channel port to a physical interrupt * source. * 3. Virtual interrupts ('events'). A domain can bind an event-channel * port to a virtual interrupt source, such as the virtual-timer * device or the emergency console. * * Event channels are addressed by a "port index". Each channel is * associated with two bits of information: * 1. PENDING -- notifies the domain that there is a pending notification * to be processed. This bit is cleared by the guest. * 2. MASK -- if this bit is clear then a 0-&gt;1 transition of PENDING * will cause an asynchronous upcall to be scheduled. This bit is only * updated by the guest. It is read-only within Xen. If a channel * becomes pending while the channel is masked then the 'edge' is lost * (ie, when the channel is unmasked, the guest must manually handle * pending notifications as no upcall will be scheduled by Xen). * * To expedite scanning of pending notifications, any 0-&gt;1 pending * transition on an unmasked channel causes a corresponding bit in a * per-vcpu selector word to be set. Each bit in the selector covers a * 'C long' in the PENDING bitfield array. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xen_ulong_t</span></span> evtchn_pending[<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">xen_ulong_t</span></span>) * <span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">xen_ulong_t</span></span> evtchn_mask[<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">xen_ulong_t</span></span>) * <span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/* * Wallclock time: updated only by control software. Guests should base * their gettimeofday() syscall on this wallclock-base value. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> wc_version; <span class="hljs-comment"><span class="hljs-comment">/* Version counter: see vcpu_time_info_t. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> wc_sec; <span class="hljs-comment"><span class="hljs-comment">/* Secs 00:00:00 UTC, Jan 1, 1970. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> wc_nsec; <span class="hljs-comment"><span class="hljs-comment">/* Nsecs 00:00:00 UTC, Jan 1, 1970. */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arch_shared_info</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arch</span></span></span><span class="hljs-class">;</span></span> };</code> </pre><br>  <code>struct shared_info</code> , as can be seen, contains information about the interaction, that is, through it we will receive events: interrupts, data has come, and so on. <br>  This structure is located with an offset of 4kb. <br><br>  And our linker script looks like this. <br><br><pre> <code class="hljs pgsql">SECTIONS { .text : { . = ALIGN(<span class="hljs-number"><span class="hljs-number">0x1000</span></span>); hypercall_page = .; . += <span class="hljs-number"><span class="hljs-number">0x1000</span></span>; xen_shared_info = .; . += <span class="hljs-number"><span class="hljs-number">0x1000</span></span>; _traps_text_start = .; *(.traps.*) _traps_text_end = .; *(.text) *(.text.*) } }</code> </pre> <br>  Actually, I would like to finish this, since the analysis of the entire code is clearly beyond the scope of one article.  Let me just say that at the moment the students implemented the launch of the machine with a debug output. <br>  To make sure of this, it is enough to do the following in Embox; <br><br><pre> <code class="hljs go"><span class="hljs-built_in"><span class="hljs-built_in">make</span></span> confload-xen/debug <span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./scripts/xen/run_xen</code> </pre> <br>  The domain will be created, and the output of Embox will go.  Exit the console, as always, ctrl +] and then do not forget to remove the machine: <code>sudo destroy embox</code> . <br><br>  Naturally, you first need to set the environment.  But for simplicity, we, not students, have already added the ability to put everything through vagrand.  This is described on the <a href="https://github.com/embox/embox/wiki/Xen-port-workflow">wiki</a> .  You only need VirtualBox and vagrand.  You do not need to install under Xen. <br><br>  In the end I would like to again address the topic of training in IT.  As I already wrote in the article: <a href="https://habrahabr.ru/company/embox/blog/347898/">‚ÄúHow to catch a programmer on cheating and whether it is worth doing this,‚Äù</a> in our project we are promoting diving students into a real project.  In this case, students get much more experience than when performing learning tasks, albeit fairly large-scale ones.  And most importantly, they are not only learning a particular language, but learning how to create products, solve problems on their own and simply be able to think.  As an example, I refer to the author of the idea of ‚Äã‚Äãthe ideal cloud platform, Anton Kozlov ( <a href="https://habrahabr.ru/users/antonkozlov/" class="user_link">antonkozlov</a> ), because I referred to his diploma earlier.  As a result of his studies, he was able not only to write code, but also to propose his own ideas, implement them, break the task up into components and train students.  We have many such examples. <br><br>  PS: Video from that conference is available <a href="http://0x1.tv/Category:OSEDUCONF-2018">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/349526/">https://habr.com/ru/post/349526/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349516/index.html">Dagaz: Faster, Better, Smarter ...</a></li>
<li><a href="../349518/index.html">A new version of RMM-solution Panda Systems Management has been released.</a></li>
<li><a href="../349520/index.html">What it is - BPM, and how companies build it</a></li>
<li><a href="../349522/index.html">Quick Start Guide: Linking ASP.NET Core Web API + Angular 5</a></li>
<li><a href="../349524/index.html">School of information security. Yandex Experience and Practice</a></li>
<li><a href="../349528/index.html">Telegram-bot "Easy Win" - check the history of the car by VIN or state. number</a></li>
<li><a href="../349530/index.html">How to better understand people</a></li>
<li><a href="../349532/index.html">Html page through the eyes of an application developer. Part 2: "Implementation"</a></li>
<li><a href="../349538/index.html">More Free Feedback on Freelance - More Money</a></li>
<li><a href="../349542/index.html">How to use gamification in analytics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>