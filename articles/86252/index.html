<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using the Builder pattern when we encounter a designer with many parameters</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article presents a free translation of a chapter from the book Effective Java, Second Edition by Joshua Bloch. 

 The article discusses 3 alterna...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using the Builder pattern when we encounter a designer with many parameters</h1><div class="post__text post__text-html js-mediator-article">  This article presents a free translation of a chapter from the book <a title="Effective Java Second Edition by Joshua Bloch" href="http://java.sun.com/docs/books/effective/">Effective Java, Second Edition by Joshua Bloch.</a> <br><br>  The article discusses 3 alternative approaches to simplifying the use of a class, with a constructor with many parameters. <br><br><a name="habracut"></a><br>  Consider the case when we have a class that provides an inscription on the packaging of food.  This inscription is responsible for the chemical composition of the product.  This inscription has several required fields: the serving size, the number of servings per container, the caloric content of one serving and about twenty additional fields: total fats, saturated fats, trans fats, the amount of cholesterol, the amount of sodium, and so on.  Most products have nonzero values ‚Äã‚Äãfor only a few of these additional fields. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <br><h1>  First Alternative (Telescoping Constructor Pattern) </h1><br><br>  Traditionally, programmers used the Telescoping Constructor pattern.  The essence of this pattern is that you provide several constructors: a constructor with required parameters, a constructor with one additional parameter, a constructor with two additional parameters, and so on.  Let us demonstrate how it will look in practice.  For brevity, we will use only 4 additional parameters. <br><br><br><blockquote><code><font color="black"><font color="#008000">// Telescoping constructor pattern -  !</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> NutritionFacts { <br> <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> servingSize; <font color="#008000">//  </font> <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> servings; <font color="#008000">//  </font> <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> calories; <font color="#008000">//  </font> <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> fat; <font color="#008000">//  </font> <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> sodium; <font color="#008000">//  </font> <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> carbohydrate; <font color="#008000">//  </font> <br> <br> <font color="#0000ff">public</font> NutritionFacts( <font color="#0000ff">int</font> servingSize, <font color="#0000ff">int</font> servings) { <br> <font color="#0000ff">this</font> (servingSize, servings, 0); <br> } <br> <br> <font color="#0000ff">public</font> NutritionFacts( <font color="#0000ff">int</font> servingSize, <font color="#0000ff">int</font> servings, <font color="#0000ff">int</font> calories) { <br> <font color="#0000ff">this</font> (servingSize, servings, calories, 0); <br> } <br> <br> <font color="#0000ff">public</font> NutritionFacts( <font color="#0000ff">int</font> servingSize, <font color="#0000ff">int</font> servings, <font color="#0000ff">int</font> calories, <font color="#0000ff">int</font> fat) { <br> <font color="#0000ff">this</font> (servingSize, servings, calories, fat, 0); <br> } <br> <br> <font color="#0000ff">public</font> NutritionFacts( <font color="#0000ff">int</font> servingSize, <font color="#0000ff">int</font> servings, <font color="#0000ff">int</font> calories, <font color="#0000ff">int</font> fat, <br> <font color="#0000ff">int</font> sodium) { <br> <font color="#0000ff">this</font> (servingSize, servings, calories, fat, sodium, 0); <br> } <br> <br> <font color="#0000ff">public</font> NutritionFacts( <font color="#0000ff">int</font> servingSize, <font color="#0000ff">int</font> servings, <font color="#0000ff">int</font> calories, <font color="#0000ff">int</font> fat, <br> <font color="#0000ff">int</font> sodium, <font color="#0000ff">int</font> carbohydrate) { <br> <font color="#0000ff">this</font> .servingSize = servingSize; <br> <font color="#0000ff">this</font> .servings = servings; <br> <font color="#0000ff">this</font> .calories = calories; <br> <font color="#0000ff">this</font> .fat = fat; <br> <font color="#0000ff">this</font> .sodium = sodium; <br> <font color="#0000ff">this</font> .carbohydrate = carbohydrate; <br> } <br> }</font> <br> <br></code> </blockquote><br><br>  When you want to create an object of this class, you use a constructor with the necessary list of parameters: <br><br><br><blockquote> <code><font color="black">NutritionFacts cocaCola = <font color="#0000ff">new</font> NutritionFacts(240, 8, 100, 0, 35, 27);</font> <br> <br></code> </blockquote><br><br>  Usually, to call a constructor, you will need to pass many parameters that you do not want to set, but in any case you are forced to pass a value for them.  In our case, we set the value to 0 for the <code>fat</code> field.  Since we only have six parameters, it may not seem so bad.  But it starts to deliver huge problems when the number of parameters increases. <br><br><br>  In short, using the Telescoping Constructor pattern, it becomes difficult to write client code when there are many parameters, and even harder to read this code.  The reader can only guess what all these values ‚Äã‚Äãmean and you need to carefully calculate the position of the parameter to find out which field it belongs to.  Long sequences of equally typed parameters can cause subtle errors.  If the client accidentally confuses two of these parameters, the compilation will be successful, but the program will not work correctly. <br><br><br><h1>  Second Alternative (JavaBeans Pattern) </h1><br><br>  The second option, when you encounter a multi-parameter constructor, is the JavaBeans pattern.  You call a parameterless constructor to create an object, and then call setters to set the required and optional parameters of interest: <br><br><br><blockquote> <code><font color="black"><font color="#008000">// JavaBeans Pattern - allows inconsistency, mandates mutability</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> NutritionFacts { <br> <font color="#008000">//     </font> <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> servingSize = -1; <font color="#008000">// </font> <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> servings = -1; <font color="#008000">// </font> <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> calories = 0; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> fat = 0; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> sodium = 0; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> carbohydrate = 0; <br> <br> <font color="#0000ff">public</font> NutritionFacts() { <br> } <br> <br> <font color="#008000">// </font> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> setServingSize( <font color="#0000ff">int</font> val) { <br> servingSize = val; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> setServings( <font color="#0000ff">int</font> val) { <br> servings = val; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> setCalories( <font color="#0000ff">int</font> val) { <br> calories = val; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> setFat( <font color="#0000ff">int</font> val) { <br> fat = val; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> setSodium( <font color="#0000ff">int</font> val) { <br> sodium = val; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> setCarbohydrate( <font color="#0000ff">int</font> val) { <br> carbohydrate = val; <br> } <br> }</font> <br> <br></code> </blockquote><br><br>  This approach does not have the disadvantages of a Telescoping Constructor pattern (The object is easy to create and the resulting code is easy to read): <br><br><br><blockquote> <code><font color="black">NutritionFacts cocaCola = <font color="#0000ff">new</font> NutritionFacts(); <br> cocaCola.setServingSize(240); <br> cocaCola.setServings(8); <br> cocaCola.setCalories(100); <br> cocaCola.setSodium(35); <br> cocaCola.setCarbohydrate(27);</font> <br> <br></code> </blockquote><br><br>  Unfortunately, the JavaBeans pattern is not without serious flaws.  Because construction is divided between multiple calls, a JavaBean may be in an unstable state partially passing through construction.  Attempting to use an object if it is in an unstable state can lead to errors that are far from the code containing the error, hence difficult to debug.  Also, the JavaBeans pattern eliminates the ability to make a class immutable, which requires additional effort from the programmer to ensure security in a multi-threaded environment. <br><br><br><h1>  Third alternative (Builder pattern) </h1><br><br>  Fortunately, there is a third alternative that combines the security of the Telescoping Constructor pattern with the readability of the JavaBeans pattern.  It is a form of the <a title="Builder" href="http://en.wikipedia.org/wiki/Builder_pattern">Builder</a> pattern.  Instead of directly creating the desired object, the client calls the constructor (or a static factory) with all the necessary parameters and gets the builder object.  The client then calls the <em>setter-like</em> methods on the builder object to set each additional parameter.  Finally, the client calls the <code>build()</code> method to generate an object that will be immutable.  The builder is a static inner class in the class that he builds.  Here is how it looks in practice: <br><br><br><blockquote> <code><font color="black"><font color="#008000">//  Builder</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> NutritionFacts { <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> servingSize; <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> servings; <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> calories; <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> fat; <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> sodium; <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> carbohydrate; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> Builder { <br> <font color="#008000">//  </font> <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> servingSize; <br> <font color="#0000ff">private</font> final <font color="#0000ff">int</font> servings; <br> <font color="#008000">//   -    </font> <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> calories = 0; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> fat = 0; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> carbohydrate = 0; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> sodium = 0; <br> <br> <font color="#0000ff">public</font> Builder( <font color="#0000ff">int</font> servingSize, <font color="#0000ff">int</font> servings) { <br> <font color="#0000ff">this</font> .servingSize = servingSize; <br> <font color="#0000ff">this</font> .servings = servings; <br> } <br> <br> <font color="#0000ff">public</font> Builder calories( <font color="#0000ff">int</font> val) { <br> calories = val; <br> <font color="#0000ff">return</font> <font color="#0000ff">this</font> ; <br> } <br> <br> <font color="#0000ff">public</font> Builder fat( <font color="#0000ff">int</font> val) { <br> fat = val; <br> <font color="#0000ff">return</font> <font color="#0000ff">this</font> ; <br> } <br> <br> <font color="#0000ff">public</font> Builder carbohydrate( <font color="#0000ff">int</font> val) { <br> carbohydrate = val; <br> <font color="#0000ff">return</font> <font color="#0000ff">this</font> ; <br> } <br> <br> <font color="#0000ff">public</font> Builder sodium( <font color="#0000ff">int</font> val) { <br> sodium = val; <br> <font color="#0000ff">return</font> <font color="#0000ff">this</font> ; <br> } <br> <br> <font color="#0000ff">public</font> NutritionFacts build() { <br> <font color="#0000ff">return</font> <font color="#0000ff">new</font> NutritionFacts( <font color="#0000ff">this</font> ); <br> } <br> } <br> <br> <font color="#0000ff">private</font> NutritionFacts(Builder builder) { <br> servingSize = builder.servingSize; <br> servings = builder.servings; <br> calories = builder.calories; <br> fat = builder.fat; <br> sodium = builder.sodium; <br> carbohydrate = builder.carbohydrate; <br> } <br> }</font> <br></code> </blockquote><br><br>  Note that NutritionFacts is immutable, and that all default parameter values ‚Äã‚Äãare in the same place.  The builder's setter methods return this builder himself.  Therefore, calls can be chained.  This is what the client code looks like: <br><br><br><blockquote> <code><font color="black">NutritionFacts cocaCola = <font color="#0000ff">new</font> NutritionFacts.Builder(240, 8).calories(100).sodium(35).carbohydrate(27).build();</font> <br></code> </blockquote><br><br>  This client code is easy to write and, more importantly, easy to read.  The Pattern Builder simulates the named extra parameters that are used in Ada and Python. <br><br><br>  <b>UPDATE</b> <br>  According to the <a href="http://habrahabr.ru/blogs/java/86252/">commentary it is</a> proposed: <br>  for the considered NutritionFacts class, it is logical to provide getters for immutable fields.  Otherwise, it turns out that we will construct the object, but we cannot use it. <br>  It is more logical to call the Builder's fields in accordance with the JavaBeans convention, namely setXXX ().  Since this method is already the de facto standard for Java, this approach will improve the readability of the code. <br><br>  ps  My first post on Habr√©.  Do not kick much;) <br><br></div><p>Source: <a href="https://habr.com/ru/post/86252/">https://habr.com/ru/post/86252/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../86245/index.html">Novell want to buy</a></li>
<li><a href="../86246/index.html">How ideas are born. The story of a startup - part I</a></li>
<li><a href="../86248/index.html">Cinavia DRM</a></li>
<li><a href="../86249/index.html">Google Analytics tracking _trackPageView</a></li>
<li><a href="../86251/index.html">Adding the VK instant messaging panel in Opera</a></li>
<li><a href="../86253/index.html">Amateur addon to "Space Rangers 2: Reboot" - "KR2: Revolution" [version 2.0 / R4]</a></li>
<li><a href="../86254/index.html">Typical questions at the interview and recommendations to the candidate</a></li>
<li><a href="../86255/index.html">Design Pattern "Decorator" / "Decorator"</a></li>
<li><a href="../86257/index.html">Microsoft opens U-prove</a></li>
<li><a href="../86258/index.html">Redirect after POST request</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>