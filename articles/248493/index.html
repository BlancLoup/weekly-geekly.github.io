<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Non-recursive permutation generation algorithm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The non-recursive algorithm proposed below is somewhat different from those described in the book by Lipsky [1] and found by me in the Russian segment...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Non-recursive permutation generation algorithm</h1><div class="post__text post__text-html js-mediator-article">  The non-recursive algorithm proposed below is somewhat different from those described in the book by Lipsky [1] and found by me in the Russian segment of the Internet.  I hope it will be interesting. <br><a name="habracut"></a><br>  Briefly setting the problem.  There is a lot of dimension N. You need to get all N!  possible permutations. <br>  Further, for simplicity, we use integers (1..N) as the set.  Instead of numbers, you can use any objects, because  there are no operations to compare the elements of a set in the algorithm. <br>  To store intermediate data, we will form the following data structure: <br><pre><code class="vbscript hljs">type dtree ukaz as integer <span class="hljs-comment"><span class="hljs-comment">'      spisok() as integer '    end type</span></span></code> </pre> <br>  and fill it with the original values <br><pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> masiv(N-) As dtree <span class="hljs-comment"><span class="hljs-comment">'   = N-1 For ii = 1 To N - 1 masiv(ii).ukaz = 1 ReDim masiv(ii).spisok(N + 1 - ii) '    For kk = 1 To (N + 1 - ii) masiv(ii).spisok(kk) = kk + ii - 1 Next Next</span></span></code> </pre><br>  The element number in the masiv array will be referred to as the level below. <br>  In the list of the first level we enter all the elements of the set  At the first level, the list dimension is N and the list itself does not change throughout the course of the algorithm.  During the initial filling, all pointers in the array are set to the first item in the list. <br>  At each next level, its list is formed based on the list of the previous level, but without one element, which is marked with a pointer.  At the penultimate level (N-2), the list contains three elements.  At the last level (N-1), the list contains two elements.  The list of the lower level is formed as a list of the previous level without an element pointed to by the pointer of the previous level. <br>  As a result of the initial filling, the first two permutations were obtained. This is a common array formed at the upper levels (1 ... (N-2)) from the list elements that are pointed to by pointers. <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">For</span></span> ii = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> N<span class="hljs-number"><span class="hljs-number">-2</span></span> massiv(ii).spisok(ukaz) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span></code> </pre><br>  and from the list of the last level - two pairs of elements in a different order (two tails 1 2 and 2 1) <br><pre> <code class="vbscript hljs">+ massiv(N<span class="hljs-number"><span class="hljs-number">-1</span></span>).spisok(<span class="hljs-number"><span class="hljs-number">1</span></span>) + massiv(N<span class="hljs-number"><span class="hljs-number">-1</span></span>).spisok(<span class="hljs-number"><span class="hljs-number">2</span></span>) + massiv(N<span class="hljs-number"><span class="hljs-number">-1</span></span>).spisok(<span class="hljs-number"><span class="hljs-number">2</span></span>) + massiv(N<span class="hljs-number"><span class="hljs-number">-1</span></span>).spisok(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  All further permutations are also formed, always from the penultimate level (N-2), <br>  The order of obtaining subsequent permutations is that, being at the penultimate level (N-2) and having formed two permutations, we are trying to increase the pointer of the selected element by 1. <br>  If this is possible, then at the last level we change the list and repeat. <br>  If it is not possible to increase the pointer at the penultimate level (all possible options have been enumerated), then we rise to the level at which increasing the pointer (moving to the right) is possible.  Algorithm end condition - the pointer at the first level goes beyond N. <br>  After moving the pointer to the right, we change the list below it and move down to the penultimate level (N-2), also updating the lists and setting the pointers of the selected item to 1. <br>  The operation of the algorithm is presented more clearly and clearly in the figure below (for the dimension of the set N = 5).  The number in the picture corresponds to the level in the description.  It is even possible that apart from the picture, nothing is needed to understand the algorithm. <br><img src="https://habrastorage.org/files/c2e/9c9/8f6/c2e9c98f662b41b788af25007d85e521.png"><br>  Of course, when implementing the algorithm, it was possible to use the usual two-dimensional array, especially since for small N the gain of the memory capacity does not give anything, and for large N we can not wait for the algorithm to finish. <br>  One way to implement the algorithm on VBA is below.  To start it, you can create an Excel workbook with macros, create a module on the VB developer tab, and copy the text into the module.  After running generate (), all permutations will be displayed on Sheet1. <br><br><div class="spoiler">  <b class="spoiler_title">VBA for Excel</b> <div class="spoiler_text"><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Option</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Explicit</span></span> Type dtree tek_elem_ukaz As Integer spisok() As Integer <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Type <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> masiv() As dtree <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> start_print As Integer <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> N As Integer <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> generate() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> ii As Integer, kk As Integer, jj As Integer <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> uroven As Integer <span class="hljs-number"><span class="hljs-number">1.</span></span>Cells.Clear N = <span class="hljs-number"><span class="hljs-number">5</span></span> start_print = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ReDim</span></span> masiv(N - <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment">'   For ii = 1 To N - 1 masiv(ii).tek_elem_ukaz = 1 ReDim masiv(ii).spisok(N + 1 - ii) For kk = 1 To (N + 1 - ii) masiv(ii).spisok(kk) = kk + ii - 1 Next Next uroven = N - 2 Do '  Call print_rezult(uroven) '       If masiv(uroven).tek_elem_ukaz &lt;= (N - uroven) Then '    '    masiv(uroven).tek_elem_ukaz = masiv(uroven).tek_elem_ukaz + 1 '    Call zap_niz(uroven) Else '      ,     Do While uroven &gt; 1 And masiv(uroven).tek_elem_ukaz &gt; (N - uroven) uroven = uroven - 1 Loop If uroven = 1 And masiv(1).tek_elem_ukaz = N Then MsgBox "stop calc" Exit Sub '   End If '         masiv(uroven).tek_elem_ukaz = masiv(uroven).tek_elem_ukaz + 1 Call zap_niz(uroven) '    Do While uroven &lt; N - 2 uroven = uroven + 1 masiv(uroven + 1).tek_elem_ukaz = 1 '    For kk = 2 To N - uroven + 1 masiv(uroven + 1).spisok(kk - 1) = masiv(uroven).spisok(kk) Next Loop End If Loop End Sub Sub print_rezult(ukaz As Integer) Dim ii As Integer For ii = 1 To ukaz With masiv(ii) 1.Cells(start_print, ii) = .spisok(.tek_elem_ukaz) 1.Cells(start_print + 1, ii) = .spisok(.tek_elem_ukaz) End With Next With masiv(ukaz + 1) 1.Cells(start_print, ukaz + 1) = .spisok(1) 1.Cells(start_print, ukaz + 2) = .spisok(2) start_print = start_print + 1 1.Cells(start_print, ukaz + 1) = .spisok(2) 1.Cells(start_print, ukaz + 2) = .spisok(1) start_print = start_print + 1 End With End Sub Sub zap_niz(ukaz As Integer) '    Dim ii As Integer, wsp1 As Integer '    wsp1 = masiv(ukaz).tek_elem_ukaz masiv(ukaz + 1).tek_elem_ukaz = 1 '    For ii = 1 To wsp1 - 1 masiv(ukaz + 1).spisok(ii) = masiv(ukaz).spisok(ii) Next For ii = wsp1 + 1 To N - ukaz + 1 masiv(ukaz + 1).spisok(ii - 1) = masiv(ukaz).spisok(ii) Next End Sub</span></span></code> </pre><br></div></div><br>  References: <br>  [1] V.Lipsky.  Combinatorics for programmers.  -Moscow, Mir publishing house, 1988. </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/248493/">https://habr.com/ru/post/248493/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248477/index.html">Video reports from GDG DevFest Voronezh 2014</a></li>
<li><a href="../248479/index.html">Development experience for Android Wear</a></li>
<li><a href="../248481/index.html">Open source projects: Media Player Classic and SharpDevelop. First impressions</a></li>
<li><a href="../248483/index.html">Delegation: personal experience</a></li>
<li><a href="../248485/index.html">Explore the performance of SQL SERVER 2014 databases using PowerEdge R630 with HDD and SSD drives</a></li>
<li><a href="../248497/index.html">The influence of cables on the parameters of the systems "amplifier-speaker" and "microphone-mixer"</a></li>
<li><a href="../248501/index.html">Why do we need an understandable language?</a></li>
<li><a href="../248503/index.html">JetBrains products at last year's prices</a></li>
<li><a href="../248505/index.html">Repository pattern. Basics and explanations</a></li>
<li><a href="../248507/index.html">WebSocket RPC or how to write a live web browser application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>