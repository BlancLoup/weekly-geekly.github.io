<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How it works: CAPTCHA</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How many years Habr has existed - so many years posts on the regular captcha regularly appear on it - be it a script for generating a picture, a new c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How it works: CAPTCHA</h1><div class="post__text post__text-html js-mediator-article"> How many years Habr has existed - so many years posts on the regular captcha regularly appear on it - be it a script for generating a picture, a new captcha idea with cats and the like.  The most <a href="http://habrahabr.ru/post/175079/">recent example</a> of what a person does not quite understand is how a captcha should work (see the text of the post and the last comments), but at the same time shares its errors with the community.  One gets the impression that captcha is such a <i>terra incognita</i> for most developers, both for those who simply fasten it to the next form in the hope that it will work out of the box, and for those who come up with captcha like those on which you need to choose a picture with a cat from several photos. <br><br>  The article contains useful information for those who use captcha on their server, instead of trusting to a third-party service like reCaptcha. <br><br>  And for the seed, if you think that such a captcha test will work: <br> <code>if($_POST['captcha'] == $_SESSION['captcha']) return true;</code>  (example from practice) <br>  then you are deeply mistaken. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Captcha </h3><br>  According to its definition, captcha is an automated public Turing test (a test that a person can pass, but not a computer).  In this article I will look at captcha properties on the example of its most common form - the text in the picture, although almost everything written is equally applicable to any kind of captcha. <br><br><h3>  The two main properties of captcha </h3><br>  Any captcha should have two properties, without which it will not work: <br><br>  <b>Recognition resistance</b> is a property that protects a captcha from recognition by an algorithm ‚Äî for example, a text recognition system.  Ensures that a person can read the text in the picture, but the computer does not. <br>  An anti-example: the standard captcha of the phpBB 2.x forums didn‚Äôt have such a property - because of the relative simplicity of recognition, scripts appeared that spammed all forums in a row, forcing webmasters to change the captcha to more persistent ones. <br><br>  <b>Resistance to guessing</b> is a captcha property, which does not allow guessing its value in a small number of attempts (less than 1000).  If the set of possible captcha values ‚Äã‚Äãis small, the program will not be difficult to guess by its selection instead of recognition. <br>  Anti-example: arithmetic captcha like ‚Äú1 + 2‚Äù (enumeration of numbers from 1 to 20 will soon result). <br>  Anti-example: choose from several pictures the one on which the cat is depicted. <br><br><h3>  Captcha Check </h3><br>  <b>The value for verification should be stored on the server, and not transmitted along with the image to the browser.</b>  To match the visitor and the correct value of the captcha it is necessary to use a certain key that is transmitted along with the captcha (session ID, captcha number, etc.) <br>  Anti-example: if you transfer the captcha itself and the value to check it (including encrypted), then a person needs to recognize such a captcha once and then use the combination ‚Äúanswer‚Äù - ‚Äúvalue for check‚Äù in his script (by reference at the beginning of the post) such a case) <br><br>  <b>Before checking the answer - you need to make sure that it is not empty.</b>  Otherwise, an attacker can, without downloading a picture or deleting the identifier of the current session, pass an empty value and pass the captcha, because  two empty lines will be compared (in PHP, a non-existent value is an empty string). <br>  Anti-example: the code I have already mentioned is <code>if($_POST['captcha'] == $_SESSION['captcha']) return true;</code> <br>  Moreover, this code was written by an experienced programmer. <br><br>  <b>After verification, the saved captcha value must be deleted.</b>  If you do not, the attacker will be able to use this value again an unlimited number of times.  Yes, when updating the page with the form, the captcha is updated (either when generating the form or when generating a picture), only the script may not load the form again (it should be mentioned that it is not relevant if the site uses disposable csrf tokens for the forms). <br>  Anti-example: a hypothetical login form, in which it is enough to enter a captcha once correctly, and then select the password with a script, avoiding captcha regeneration on the server. <br><br><h3>  Bulletproof captcha </h3><br>  <b>Protection against brute force.</b>  If your captcha is resistant to recognition, but not very resistant to iteration (for example, you need to read only 3-4 figures on it), it is advisable to limit the number of incorrect answers ‚Äúfrom one ip‚Äù / ‚Äúfor one login‚Äù / etc.  Such restrictions must be checked BEFORE checking the captcha itself (that is, even in the case of a correctly entered captcha, if there is a restriction, it should not be considered as passed) otherwise it will not interfere with busting. <br><br>  <b>DoS protection.</b>  When generating captcha on your server, you need to understand that this is a convenient vector for DoS attacks (which, unlike DDoS, any student can arrange).  For protection, you can limit the number of captcha generation for one ip, captcha caching, etc.  <a href="http://habrahabr.ru/post/144427/">More about this</a> <br><br>  <b>Protection against recognition.</b>  If you choose a captcha, or suddenly you are going to write it yourself, it is advisable to understand which captcha is more protected from recognition.  There are ready-made universal captcha recognition scripts that operate on the <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D0%25BF%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B5_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D0%25BE%25D0%25B7%25D0%25BD%25D0%25B0%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5_%25D1%2581%25D0%25B8%25D0%25BC%25D0%25B2%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25B2">OCR</a> principle, and if your site is interesting for spammers, there is a risk that they will use / write the script specifically for your captcha.  The latter truth relates more to the Yandex or vk level sites, but it is advisable to provide a variant with protection against banal OCR. <br><br>  <b>Protection against antigate.</b>  Formally speaking, captcha as a Turing test is not obliged to protect you from antigates, since in this case a person will recognize it.  From the practical point of view, this question is highly relevant and it is necessary to defend ourselves somehow. <br>  There is not and cannot be a ‚Äúgold standard‚Äù (for in this case, antigates will introduce its support), so you are free to supplement the captcha with any tricks to make its recognition through antigate impossible.  For example: <br>  - non-standard captcha (puzzle collection, image rotation, click on the area in the photo, etc.); <br>  - Cyrillic captcha is the simplest solution, but has a number of drawbacks: only suitable for projects with a Russian-speaking audience, there are anti-gates with Cyrillic support; <br>  - use the virtual keyboard next to the captcha to enter non-standard characters or shapes (it may be inconvenient for mobile users); <br><br><h3>  Usability </h3><br>  Do not ask for a captcha if you have already seen that you are in front of you.  Here, however, you need to be careful that the form cannot be used by the script an unlimited number of times after a single person has entered a captcha. <br>  Example: registration form.  If I register somewhere, and forgot to enter the field "zip code", but correctly entered the captcha - no need to show me a new one.  Spend 10 minutes to save somewhere in your home, that a living person is trying to fill this particular form now. <br><br>  To facilitate human recognition: do not use letters and numbers in the captcha at the same time, do not use uppercase and lowercase letters at the same time, exclude similar symbols. <br><br><h3>  Refuse to use captcha </h3><br>  The best captcha is no captcha.  Where you can refuse to use it - it must be done.  You may need to implement additional limits and checks, but users will thank you. <br>  But here we must be very careful.  For example: a registration form without a captcha, with an email field to which an email arrives with activation.  Without additional means of protection, such a form can fill up with ‚Äúleft‚Äù addresses, and your site will be included in the black lists of postal services.  In this case, you can do without captcha, but only if you have another line of defense, such as the ip limit. <br><br>  To whom the information in this topic will seem obvious, but if I had not encountered examples of a lack of understanding of these simple principles in life, including among experienced fellow developers, I would not waste time writing this text. </div><p>Source: <a href="https://habr.com/ru/post/175461/">https://habr.com/ru/post/175461/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../175449/index.html">How to tie a BitTorrent tracker to a Python site: integration with XBT Tracker</a></li>
<li><a href="../175451/index.html">GPS monitoring auto or homework for the evening</a></li>
<li><a href="../175453/index.html">Using design patterns in javaScript: Spawning patterns</a></li>
<li><a href="../175457/index.html">Admin in 10 minutes</a></li>
<li><a href="../175459/index.html">Data migration from MySQL to PostgreSQL</a></li>
<li><a href="../175465/index.html">M in MVC: why models are misunderstood and undervalued (translation)</a></li>
<li><a href="../175467/index.html">Intel plans for the release of new processors in 2013</a></li>
<li><a href="../175469/index.html">Firefox: private tabs, various APIs and extensions that do not require restarting</a></li>
<li><a href="../175475/index.html">ActionScript - Yes / No Future?</a></li>
<li><a href="../175479/index.html">How we increase the loyalty of users Surfingbird</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>