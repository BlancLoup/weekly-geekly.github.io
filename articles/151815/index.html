<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Application Cache API - new features and problems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gradually, the concept of the standard HTML5 become a reality. Browsers are starting to support new features that were so lacking. But with new opport...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Application Cache API - new features and problems</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/d45/e60/032/d45e60032540aa92ce3d37aea1a042a0.jpg" alt="Naked woman.  Joke" align="left">  Gradually, the concept of the standard HTML5 become a reality.  Browsers are starting to support new features that were so lacking.  But with new opportunities, new challenges are emerging. <br>  This article discusses the Application Cache API - a set of functions that provide advanced caching of web-application resources, and with which you can view previously downloaded websites without connecting to the Internet.  I paid special attention to the practical use and problems of Application Cache. <br><a name="habracut"></a><br>  Further under the article, the words ‚Äúcache‚Äù and its derivatives mean Application Cache and work with it.  The standard browser cache is referred to as ‚Äústandard cache‚Äù. <br><br><h4>  General scheme of work Application Cache </h4><br>  At first glance, the operation mechanism of Application Cache is simple.  When a user first uses the site, pages are stored in the browser cache.  Then, on subsequent visits, as well as when the Internet connection is lost, previously saved data is used in a special ‚Äústorage‚Äù.  Control over site caching is done using a special file called manifest.  Some articles use .apppcache instead of .manifest.  This article uses .manifest.  Although you can use your name. <br><br><h4>  Storage </h4><br>  ‚ÄúStorage‚Äù is a conditional name used in browsers to indicate the storage location of Application Cache.  The mechanisms of application cache and standard browser cache are different, therefore, require separate placement.  The differences in the working mechanisms between the two types of caching are as follows: <br><ul><li>  The data placed in the standard cache can be automatically, without a command from the user or server, deleted when it is filled or the action flow specified in the file headers expires.  Data placed in the Application Cache repository can be deleted only at the command of the user or server. </li><li>  Only files that are loaded during the page view are included in the standard cache.  You can place any files downloaded from the server according to the manifest instruction into the Application Cache. </li></ul><br>  These differences have a significant impact on caching mechanisms, which will be discussed in detail at the end of the article. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Connect the file .manifest </h4><br>  Initially, you need to "enable" Application Cache.  This is done by pointing the browser to the .manifest file using the manifest attribute in the html tag: <br><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">manifest</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cache.manifest"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  There are two features here: <br><ul><li>  Application Cache only works if the browser treats the page as an HTML5 document.  Therefore, it is desirable to specify the DOCTYPE.  Without the specified DOCTYPE, there may be problems in irrelevant versions of browsers. </li><li>  The file name can be arbitrary. </li></ul><br>  After that, it is enough just to provide the user with the first .manifest file, but here we have two important points: <br><ul><li>  You need to define the MIME type for the .manifest file.  To do this, in the .htaccess file on your server, you need to add a line that defines a new file type: <br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">AddType</span></span> text/cache-manifest .manifest</code> </pre></li><li>  The Mozilla FireFox browser has a problem with updating the contents of the manifest file, so especially for it you need to add a construct in .htaccess: <br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;IfModule mod_expires.c&gt;</span></span> <span class="hljs-attribute"><span class="hljs-attribute">ExpiresActive</span></span> <span class="hljs-literal"><span class="hljs-literal">On</span></span> ExpiresByType text/cache-manifest <span class="hljs-string"><span class="hljs-string">"access plus 0 seconds"</span></span> &lt;/IfModule&gt;</code> </pre></li></ul><br>  Having done these operations, we can deal with the contents of the .manifest file. <br><br><h4>  .Manifest file </h4><br>  Here is an example of such a file: <br><br><pre> <code class="php hljs">CACHE MANIFEST <span class="hljs-comment"><span class="hljs-comment">#  1 images/logo.png CACHE: css/default.css NETWORK: index.php FALLBACK: / /offline.html</span></span></code> </pre><br><br>  The first line contains the text CACHE MANIFEST - it means that this file is a manifest file.  She is required. <br>  Comments in the file are indicated by the hash symbol #. <br>  Blank lines or lines with spaces are ignored and are used only for logical separation. <br>  In the example, the commentary is followed by the so-called ‚Äúexplicit entry‚Äù (images / logo.png) - an analogue of the CACHE section.  It can be used, as well as in conjunction with this section, and replacing it. <br>  Each rule (resource) must be written on a separate line. <br>  Three sections follow.  The section names, like the text CACHE MANIFEST, must be uppercase.  Each section performs its functions.  The order of the sections is not important.  There must be at least one section.  Sections may be empty. <br>  Let's break down each section. <br><br><h4>  CACHE section </h4><br>  This section is the default section, i.e.  if there are no headers in the .manifest file (‚Äúexplicit entry‚Äù), then the content of this file is taken as the content of the CACHE section.  Inside this section are paths or URIs to cached resources.  There are the following features: <br><ul><li>  Specifies a specific resource (file), i.e.  You cannot write a line like / images / * in this section </li><li>  The page containing the definition of the .manifest file (page c) is automatically cached.  You can add the manifest attribute to all pages to cache the entire site without listing them in the .manifest file.  Note: Mozilla Firefox does not cache a dynamically generated page (.php) with the manifest attribute. </li></ul><br><br><h4>  NETWORK section </h4><br>  This section contains the paths to the files that must be downloaded from the Internet.  In this section, you can use patterns, i.e.  You can write this structure: <br><pre> <code class="php hljs">CACHE MANIFEST NETWORK: *</code> </pre><br>  This will allow the download of all files that do not have a saved copy.  If you need any restrictions on the download, you can specify specific files (for example, index.php) and directories (for example, / images / *). <br><br><h4>  FALLBACK section </h4><br>  This section indicates that the browser in offline mode display when accessing pages that have not been cached.  The rules are written according to the following principle: <br> <code>_ _</code> <br>  You can separate the paths and spaces and tabs. <br>  Regarding this section, I have the following features: <br><ul><li>  You can use patterns to specify the requested page.  In the original example, we set the display of the page offline.html for all non-cached files: <br><pre> <code class="php hljs"> CACHE MANIFEST FALLBACK: / /offline.html</code> </pre><br>  You can use the instructions for specific files or files with a specific extension (for example, * .html /offline.html), which is very convenient. </li><li>  Displayed pages are cached automatically and you do not need to specify them in the CACHE section. </li></ul><br><br><h4>  Notes on NETWORK and FALLBACK sections </h4><br>  There are three comments that cannot be omitted: <br><ul><li>  All files that are not marked in the NETWORK and FALLBACK sections and that do not have saved copies in the Application Cache repository will not be loaded, even if there are copies of resources in the standard browser cache.  Therefore, if you do not use common patterns (* or /), then do not forget to specify all the files necessary for the application, otherwise you will not be able to work with them.  It is enough to use the general pattern in one of the sections. </li><li>  The NETWORK and FALLBACK section rules do not overlap the CACHE (‚Äúexplicit entry‚Äù) section rules, that is, when working without a network, the cached data is loaded first, and only then the policy regarding the resources specified in these two sections is determined.  In practice, this leads to the complexity of the application structure. </li><li>  The rules in these sections do not affect the page containing the definition of the .manifest file ‚Äî it is always automatically cached. </li></ul><br><br><h4>  Application cache API </h4><br>  When declaring the manifest attribute, we have the opportunity to work with the cache management object for this document window.applicationCache.  The set of functions and methods of working with this object form the Application Cache API. <br>  Consider this object in detail. <br><br><h4>  Methods of the applicationCache Object </h4><br>  Appeal to the object is as follows: <br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.applicationCache</code> </pre><br>  Now the methods themselves. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.applicationCache.status</code> </pre><br>  The method returns a numeric value corresponding to the status of the cache.  The following statuses are possible: <br><ul><li>  UNCACHED - the cache has not yet been initialized (numeric value 0); </li><li>  IDLE - no actions are performed with the cache (numeric value 1); </li><li>  CHECKING ‚Äî checks the .manifest file (numeric value 2); </li><li>  DOWNLOADING ‚Äî resources are loaded to cache them (numeric value 3); </li><li>  UPDATEREADY - loading of necessary resources is completed and their initialization is required using the swapCache () method (numeric value 4); </li><li>  OBSOLETE - the current cache is obsolete (numeric value 5). </li></ul><br>  Also, state constants are defined in the applicationCache object (for example, cache.IDLE is 1).  So it‚Äôs not necessary to remember numeric values. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.applicationCache.update()</code> </pre><br>  The method initiates the process of checking the .manifest file and the subsequent download of the required resources. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.applicationCache.swapCache()</code> </pre><br>  The method switches the browser to use new cached files instead of old ones.  The page is not redrawn, only upon subsequent access to the cached files, they are taken from the updated cache. <br>  A simple alternative to the method is to reload the page, for example, using location.reload (). <br><br><h4>  ApplicationCache Object Events </h4><br>  The following events are associated with the applicationCache object: <br><ul><li>  cached - occurs when the first cache is formed in the storage; </li><li>  checking - occurs when sending a request to receive a .manifest file; </li><li>  downloading - occurs when downloading resources to the cache; </li><li>  progress - occurs when loading each resource separately; </li><li>  error - an error occurred while accessing the resource files or the .manifest file; </li><li>  noupdate - occurs when confirming that the .manifest file has not been updated; </li><li>  obsolete - occurs upon confirmation that the cache in the storage is outdated and will be deleted; </li><li>  updateready - occurs when the update of the updated cache is finished. </li></ul><br><br><h4>  Detailed Application Cache </h4><br>  Everything seems to be well and smoothly, but how does it work in reality?  Now we will deal with this issue. <br>  The first thing to consider is the efficient, step-by-step scheme of Application Cache: <br><ul><li>  When the browser first loads the document with the manifest attribute, an additional request occurs and the .manifest file (the checking event) is received.  On the first visit, when the cache of this document does not yet exist, all files are loaded into the cache according to the rules specified in the file .manifest (downloading event).  Files can be loaded from the standard browser cache, which is effective when rules are changed.  As a result, the first data store of the cache manifest (cached event) is created. </li><li>  When you re-access the same document, it is loaded from the cache, as it was previously cached (documents with the manifest attribute are always cached).  Access to the server at this moment does not occur.  The cache management object for this document, window.applicationCache, after loading the document, initiates a check of the change in the .manifest file and sends a request to the server (the checking event).  The server is responding about the change. </li><li>  If the .manifest file has not changed (the noupdate event), then the download is complete and the application will continue to work in the intended direction.  Requests to the server to receive cached files are not made. </li><li>  If the .manifest file has changed, then the standard loading of the document is performed and the background cache loading begins (downloading event).  After the download (updateready event), the page is not redrawn.  Updated cache data will only be used the next time the document is loaded. </li><li>  If an error occurred while loading the .manifest file or it contains errors, for example, a link to a nonexistent file (error event), then the download will be performed in normal mode using saved copies of the resources.  In this case, the cache is not affected and the browser does not use it. </li></ul><br><br><h4>  Cache update </h4><br>  Separately, it is necessary to consider updating (clearing) the cache.  From the analysis of the detailed Application Cache operation scheme, it can be seen that a change on the data server does not automatically update this data in the cache.  You can update the cache in the following ways: <br><ul><li>  The user manually deletes the old cache data. <br>  It should be understood that Application Cache and the standard browser cache are not the same.  As mentioned above, both caching mechanisms differ in their work algorithms, functionality and storage.  After clearing the standard cache, we will not affect Application Cache.  To clean the Application Cache, you need to use the ‚ÄúStorage‚Äù cleaning functions - a new settings item in modern browsers. <br>  How to clear the storage in the Mozilla Firefox browser can be found here - <a href="http://support.mozilla.com/ru/kb/okno-nastrojki-panel-dopolnitelnye">support.mozilla.com/ru/kb/okno-nastrojki-panel-dopolnitelnye#w_ahaalaklai-eaulikioi</a> . <br>  How it is done in Opera - <a href="http://help.opera.com/Windows/11.50/ru/storage.html">help.opera.com/Windows/11.50/ru/storage.html</a> . <br>  In Google Chrome, clearing the cache is not possible in simple ways.  To do this, use the chrome: // appcache-internals / management page. <br>  Safari clears the cache along with the standard browser cache.  See help. </li><li>  Making changes to the .manifest file.  Any changes initiate the download of all cache resources and its subsequent update.  Changes will take effect after the next page reload.  For example, you can do this by changing a few commented characters (we changed the version of our original example): <br><pre> <code class="php hljs"> CACHE MANIFEST <span class="hljs-comment"><span class="hljs-comment">#  2</span></span></code> </pre></li><li>  Software update using Application Cache API.  This method will be discussed below in the example. </li></ul><br>  Only the last two methods are suitable for use in real projects, which would be quite convenient if it were not for the ‚Äúaggressive caching‚Äù of Mozilla Firefox browser. <br><br><h4>  Hidden update problem </h4><br>  Mozilla Firefox browser has a ‚Äúpeculiar‚Äù cache update mechanism known as ‚Äúaggressive caching‚Äù.  The problem manifests itself when we combine standard caching and Application Cache, and we need to combine them if we want to have caching in older browsers. <br>  The fact is that when updating Application Cache in Mozilla Firefox, the data is also taken from the standard cache without checking for changes on the server.  This leads to the fact that obsolete data from the standard cache can get into the updated Application Cache, i.e.  The update will be performed, but old versions of the files will be in the cache.  This fact puts all the advantages of working with Application Cache into question. <br>  The correct ways to update the cache in this situation are: <br><ul><li>  change file name; </li><li>  2-step update. </li></ul><br>  In the first case, we simply change the name of the changed file in all resources where it is mentioned, including the .manifest file.  The file with the original name should not exist (!).  As a result, during the next change check, there will be an error loading the nonexistent file, and the cache resources will be loaded from the server. <br>  If the option of changing the file name is not suitable for one reason or another, then you need to use a 2-step cache update. <br>  At the first stage of the update, we exclude the modified file from the CACHE section of the .manifest file and set the expiration date in the header of the given file: <br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">header</span></span></span></span>('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); header('Cache-Control: no-store, no-cache, must-revalidate'); header('Pragma: no-cache');</code> </pre><br>  As a result, for active users, this file will be updated in the standard cache, and it will be removed from Application Cache. <br>  In the second stage, we already include the modified file in the CACHE section, and it is successfully cached.  Unfortunately, this update will only affect active users, so try to use file renaming. <br><br><h4>  Domain Binding </h4><br>  Another important point that needs to be mentioned is that the cache is linked to the domain, and not to the page where the .manifest file is declared.  Cached resources will be used for all pages of this domain, even if they do not have a link to the .manifest file.  It is quite convenient - you can determine cached resources on the start page, and then do not worry about caching them on other pages. <br>  If we use several different .manifest files for different pages of the same domain, they will overlap each other.  Only those resources that were specified in the last downloaded .manifest file will be stored in the cache. <br>  Also, when using multiple .manifest files, you can create a situation where the saved pages cyclically cache each other.  The occurrence of such a situation leads the application to a non-working state.  Given the above written, it should be noted that using several .manifest files is impractical and risky, although this possibility exists. <br>  Domain binding also shows that Application Cache works in frames using the frame's domain cache.  This moment should be appreciated by game developers. <br><br><h4>  Work offline </h4><br>  Another undoubted advantage of Application Cache is the ability to work in offline mode.  Just imagine - the client has temporarily stopped working the network, but he can still work with your resource. <br>  But even here everything is not smooth.  Recall one feature of Application Cache - the page on which the file is declared. Manifest always gets into the cache.  The result is that the page will be loaded, guided by the section CACHE, and not FALLBACK.  That is, the application will behave as if there is a connection.  But how to determine that the connection is missing? <br>  For this, the HTML5 specification defines two events, online and offline, which are triggered when creating and breaking a connection, respectively.  As the bolk <a href="https://habrahabr.ru/users/bolk/" class="user_link">habrauser</a> prompted, these events work in Safari 6 and Chrome 21. In other browsers, they most likely are not implemented. <br>  You can also use the online property of the navigator object: <br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.navigator.onLine</code> </pre><br>  This property returns true if there is a connection and false if it is missing.  It turns out that during the initialization of the page, you need to check this property and then build the work based on its value.  Currently, the navigator.onLine property is supported by Mozilla Firefox 2 browsers, Internet Explorer 4 and later. <br>  Usage example: <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ru"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">manifest</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cache.manifest"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content-Type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Application Cache Test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> html {font-family: "DejaVu Sans", "Geneva CY", "Verdana"; background: #FFFFFF; OVERFLOW: hidden; ; border: 0;} body {width: 880px; height: 600px; position: relative; background: #999999; margin: 20px auto; box-shadow: 0 0 15px 10px #999999; -webkit-box-shadow: 0 0 15px 10px #999999; -moz-box-shadow: 0 0 15px 10px #999999;} /*  */ .progressbar {display:none; position:absolute; left:0px; top:0px; width:880px; height:600px; background-color:#333333; z-index:256; border:1px solid #333333;} .progressbar #progresstext {position:absolute; left:0px; top:200px; width:880px; color:#66FF00; text-align:center; font-size:36px; text-shadow:0 0 0.8em #AAFF00, 0 0 0.8em #AAFF00;} .progressbar #progress {position:absolute; left:100px; top:300px; width:600px; height:40px;} /*  */ .flash {position:absolute; left:0px; top:0px; width: 880px; height: 600px; background-color:#666666; z-index:51; border: 1px solid #333333;} </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progressbar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progressbar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progresstext"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">progress</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progress"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">progress</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js/jquery-1.5.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-comment"><span class="actionscript"><span class="hljs-comment">//   var progress_value = 0; var progress_max = 1; $(function() { //   if (navigator.onLine) { alert(' '); } else { alert('    '); } //   Application Cache cache = window.applicationCache; if (cache) { //    //   .   . cache.addEventListener('cached', function(e) {ProgressHide();}, false); //   . progress_max -  .    cache.addEventListener('downloading', function(e) {ProgressShow(); progress_max = 3;}, false); //   .    cache.addEventListener('progress', function(e) {ProgressChange();}, false); //  .   .  .  . cache.addEventListener('updateready', function(e) {ProgressHide(); window.applicationCache.swapCache(); location.reload();}, false); } }); //     $(document).keyup(function(event){ //   shift+1     if (event.shiftKey &amp;&amp; event.keyCode == 49) { window.applicationCache.update(); } return false; }); //-------------------     ----------------// function ProgressShow() { $("#progressbar").show(300); progress_value = 0; } function ProgressChange() { progress_value++; $("#progress").attr({max: progress_max, value: progress_value}); } function ProgressHide() { $("#progressbar").hide(300); } //-------------------------------------------------------------------------// </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><h4>  Possibilities and problems of using Application Cache </h4><br>  The information described above is sufficient to understand how Application Cache works.  You can make the first conclusions about the possibilities and difficulties. <br>  The features and benefits of Application Cache include: <br><ul><li>  Increasing the speed of loading pages, due to the fact that you do not need to spend time downloading files that have been cached. </li><li>  Reducing the load on the server, because instead of numerous requests to resources (meaning the data cached on the client) to check their changes, we have only one request to the .manifest file. </li><li>  Ability to cache files according to predefined rules. </li><li>  Permanent file storage, with tight change control. </li><li>  Ability to work with the application in offline mode. </li><li>  The cache works in frames. </li></ul><br>  Problems with using Application Cache include: <br><ul><li>  When documents are first loaded after the landing page is displayed, the background download of cached documents automatically begins.  On a weak channel, active work with the application after the first boot can turn into a ‚Äúnightmare‚Äù.  Especially if the volume and number of files is large. </li><li>        .         ,    .    .         . </li><li>          .    ,      .manifest       . </li><li>      ,      NETWORK  FALLBACK   ,     . </li><li>     .manifest           . </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The rules of the FALLBACK section for working in offline mode do not overlap the rules of the CACHE section. </font><font style="vertical-align: inherit;">In practice, this leads to the complication of the structure of the application to work offline.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The page containing the definition of the .manifest file is automatically cached. </font><font style="vertical-align: inherit;">That does not allow it to be easily replaced in offline mode.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> You should also pay attention to the following nuances: </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Resources received by a POST request are not cached and are not taken from the cache. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By default, the size of the cached data is limited to 50 MB. </font><font style="vertical-align: inherit;">For older versions of Mozilla Firefox and Google Chrome, the limit is 5 MB. </font><font style="vertical-align: inherit;">Also in Opera browser, the size of the possible cache can be increased in the settings.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The encoding of the file .manifest can be any, but if you do not want problems with Cyrillic characters, you should use the utf-8 encoding. </font></font></li><li>     Application Cache  . Application Cache   Google Chrome 4.0, Mozilla Firefox 3.5, Internet Explorer 10, Opera 10.6, Opera Mobile 11, Safari 4  . </li><li>            Application Cache         ¬´¬ª.    Application Cache     .        Mozilla Firefox. </li><li> Application Cache      , ,  Cache-Control: no-store. </li></ul><br><h4>       ? </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Despite a whole bunch of usage problems, Application Cache is a powerful optimization mechanism for loaded systems. </font><font style="vertical-align: inherit;">It will be especially useful for games and interactive applications that use FullAjax. </font><font style="vertical-align: inherit;">Proper use of Application Cache will not only increase the speed of loading pages for users and reduce the amount of traffic, but also reduce the load on your server, because </font><font style="vertical-align: inherit;">cached pages are not loaded from the server, but from local storage. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I hope that this article will allow you to discover the full power of Application Cache.</font></font></div><p>Source: <a href="https://habr.com/ru/post/151815/">https://habr.com/ru/post/151815/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151810/index.html">iOS 6 is available in iTunes</a></li>
<li><a href="../151811/index.html">The illusion of effective development: design</a></li>
<li><a href="../151812/index.html">Transcend Library 4: Introduction</a></li>
<li><a href="../151813/index.html">Office, which make holidays!</a></li>
<li><a href="../151814/index.html">Practical tips for efficient code inspection</a></li>
<li><a href="../151816/index.html">Such a dangerous Internet Explorer ...</a></li>
<li><a href="../151818/index.html">How to restore data in Storelab</a></li>
<li><a href="../151820/index.html">Indie Gala 9</a></li>
<li><a href="../151821/index.html">Million particle. Part 1</a></li>
<li><a href="../151822/index.html">New edition of the changes in the Civil Code: open licenses, providers responsibility and other interesting points</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>