<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write your php framework for the evening</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Periodically, there is a task to write some small functional, to use for this a large framework like Zend / Yii / CI / Kohana, etc., either you don‚Äôt ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write your php framework for the evening</h1><div class="post__text post__text-html js-mediator-article">  Periodically, there is a task to write some small functional, to use for this a large framework like Zend / Yii / CI / Kohana, etc., either you don‚Äôt feel like it or you don‚Äôt have the opportunity. <br><br>  Some time ago, I had the task to write a small web application, it was not possible to install the above framework.  I decided to write my own, which works according to the <a href="http://ru.wikipedia.org/wiki/Model-view-controller">MVC</a> principle, 1 evening went to the base, twisting and optimization went on the course of development. <br><br>  It can seem to the beginning web developers that it is difficult, I will try to make this article understand that it is not. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To begin with, we will define the requirements: <br><ul><li>  MVC approach </li><li>  CNC </li><li>  Ease of use </li></ul><br><br>  To implement the CNC, we will use mod_rewrite, the url will look like this: mysite.com/controller_name/ controller_action / param_name_1 / param_value_1 / param_name_2 / param_value_2 <br><br>  We need to create the base classes of the model, view, controller. <br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CBaseObject</span></span></span><span class="hljs-class"> ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">abstract</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CModel</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CBaseObject</span></span></span><span class="hljs-class"> ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CView</span></span></span><span class="hljs-class"> ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CViewSmarty</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Smarty</span></span></span><span class="hljs-class"> ...</span></span></code> </pre> <br>  All requests will be processed by index.php, the settings will be stored in config.php as a regular array. <br>  part of config.php <br><pre> <code class="php hljs"> $config[<span class="hljs-string"><span class="hljs-string">'SYSPATH'</span></span>] = <span class="hljs-string"><span class="hljs-string">"system"</span></span>; $config[<span class="hljs-string"><span class="hljs-string">'APPPATH'</span></span>] = <span class="hljs-string"><span class="hljs-string">"application"</span></span>; $config[<span class="hljs-string"><span class="hljs-string">'BASEPATH'</span></span>] = <span class="hljs-string"><span class="hljs-string">"/projects/savage"</span></span>;</code> </pre><br><br>  It will also require autoloading classes. <br><pre> <code class="php hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">autoload_classes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($param)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(<span class="hljs-string"><span class="hljs-string">"config.php"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strtolower(substr($param, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)) == <span class="hljs-string"><span class="hljs-string">"m"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">include_once</span></span> ($config[<span class="hljs-string"><span class="hljs-string">'APPPATH'</span></span>] . <span class="hljs-string"><span class="hljs-string">"/models/"</span></span> . strtolower($param) . <span class="hljs-string"><span class="hljs-string">".php"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strtolower(substr($param, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)) == <span class="hljs-string"><span class="hljs-string">"c"</span></span>) { $part_path = strtolower($param) . <span class="hljs-string"><span class="hljs-string">".php"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file_exists($config[<span class="hljs-string"><span class="hljs-string">'SYSPATH'</span></span>] . <span class="hljs-string"><span class="hljs-string">"/classes/"</span></span> . $part_path)) { $file = $config[<span class="hljs-string"><span class="hljs-string">'SYSPATH'</span></span>] . <span class="hljs-string"><span class="hljs-string">"/classes/"</span></span> . $part_path; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $file = $config[<span class="hljs-string"><span class="hljs-string">'APPPATH'</span></span>] . <span class="hljs-string"><span class="hljs-string">"/controllers/"</span></span> . $part_path; } <span class="hljs-keyword"><span class="hljs-keyword">include_once</span></span> $file; } } spl_autoload_register(<span class="hljs-string"><span class="hljs-string">'autoload_classes'</span></span>);</code> </pre><br><br>  index.php will be responsible for calling the controller's methods, while checking whether the first parameter is the controller identifier or the default controller method (so that you can write like this: mysite.com/mycontroller/myaction and so mysite.com/myaction) <br><br>  Let us turn to the implementation of the controller, its task is the implementation of logic, deciding which representation to use. <br>  For the methods used in url, we will prefix: action_ (familiar to ci / kohana users). <br><pre> <code class="php hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CMain</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">action_index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $widgets = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CWidgets(); $prm_data = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'widget_login'</span></span> =&gt; $widgets-&gt;widget_login(), ); $view = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CView(); $view-&gt;assign($prm_data); $view-&gt;display(<span class="hljs-string"><span class="hljs-string">"index"</span></span>); } ...</code> </pre><br><br>  We also need to work with data, for this we create a model, and the model may not necessarily work with the database, sometimes it is enough to store an array.  In my example, the usual array is used, if necessary, you can work with the database (via PDO). <br><pre> <code class="php hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MUsers</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CModel</span></span></span><span class="hljs-class"> </span></span>{ ... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_list</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">1</span></span>; $i &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>; $i++) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;data[] = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $i, <span class="hljs-string"><span class="hljs-string">'login'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'user '</span></span> . $i, <span class="hljs-string"><span class="hljs-string">'pw'</span></span> =&gt; ($i * <span class="hljs-number"><span class="hljs-number">2</span></span> + $i)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;data; } } <span class="hljs-comment"><span class="hljs-comment">//!        PDO //!      IP public function check_login($params) { $prm_data = array(':id' =&gt; $params['suid'], ':ip' =&gt; $_SERVER['REMOTE_ADDR']); $data = self::fetch_all("select id from ##_log where id = :id and ip = :ip", $prm_data); if (count($data) &gt; 0) { return TRUE; } else { return FALSE; } }</span></span></code> </pre><br><br>  Representation, there are many ways to implement the display, someone prefers to use native php template maker, someone likes Smarty or something. <br>  I liked Smarty, so I did the basic presentation methods like in Smatry. <br><br>  That's all, the framework is ready, but it is not as powerful as brands, but for a number of tasks it is optimal. <br><br>  Watch a demo <a href="http://itpath.ru/projects/savage/">here</a> , <a href="">download without Smarty</a> , <a href="">download from Smarty</a> . </div><p>Source: <a href="https://habr.com/ru/post/141714/">https://habr.com/ru/post/141714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141707/index.html">Maps in the browser without a network</a></li>
<li><a href="../141709/index.html">Plesiochronous digital hierarchy and E1 stream</a></li>
<li><a href="../141710/index.html">Cleaning infected site files from malicious code</a></li>
<li><a href="../141712/index.html">The correct keyboard for information terminals</a></li>
<li><a href="../141713/index.html">1-wire smart home network and FreeBSD</a></li>
<li><a href="../141715/index.html">Setup of data exchange between WebAsyst and 1C UT 11</a></li>
<li><a href="../141717/index.html">Once again about the responsibility of providers for violation of intellectual rights</a></li>
<li><a href="../141718/index.html">Once again about the templates</a></li>
<li><a href="../141719/index.html">Creating msi-packages and installing any software by means of Windows group policies</a></li>
<li><a href="../141720/index.html">New reports at PHDays 2012: from vulnerabilities in smart cards to hacking SAP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>