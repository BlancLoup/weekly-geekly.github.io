<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using MapXtreme .Net</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! I want to share with you my experience with the SDK such as MapXtreme .Net from Pitney Bowes. As stated on their website:  MapInfo MapXtreme fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using MapXtreme .Net</h1><div class="post__text post__text-html js-mediator-article">  Hello!  I want to share with you my experience with the SDK such as MapXtreme .Net from Pitney Bowes.  As stated on their website: <blockquote>  MapInfo MapXtreme for .Net is a GIS software development kit in the Microsoft .Net environment that allows you to embed cartographic and GIS functions in business applications. </blockquote><a name="habracut"></a><br><h2>  Installation </h2><br>  The first step was setting the machine to work.  We install MS VisualStudio 2015 from the <a href="https://www.microsoft.com/ru-ru/SoftMicrosoft/vs2015Community.aspx">developer's</a> site (it works on MSVS2010, did not try to be lower than the version). <br><br>  Download the installation package from the <a href="http://www.pbinsight.com/support/product-downloads/for/mapxtreme">developer's</a> site.  A trial version 7.1 is available for download on the portal for 60 days (version 8 is available for purchase, the difference between them is palpable, but affects the architecture of MapXtreme. Basic operations remained unchanged). <br><br>  It is also necessary to download a map of the world, otherwise why do we need a GIS at all, right?  For MapXtreme, the <a href="http://www.adcworldmap.com/">ADC WorldMap Version 7.1</a> is suitable. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Put in exactly this order, as MapXtreme requires .Net. <br><br><h2>  Documentation </h2><br>  The library is very large with lots of features, but to get to them you need documentation, and MapXtreme has problems with it.  After installation in the directory with the SDK you can find <blockquote>  MapXtreme Developers Reference </blockquote><blockquote>  MapXtreme Version 8.0 Developer Guide </blockquote><br>  The materials themselves contain examples at the level of the captain obvious, or are absent altogether.  On the Internet, this library also does not contain many explanatory resources.  The best was on the site of the <a href="http://www.pbinsight.com/support/knowledge-base/">developer</a> .  However, about six months ago, they closed access to it and began to send everyone to tech support. <br><br>  By the way, a few words about her darling: <br><br><div style="text-align:center;"><img src="http://s2.quickmeme.com/img/44/4463d682735d1cb300ce7e5032c9128e3dd4a553f5a2fc44273e07f8a3ae07bd.jpg" alt="image"></div><br>  There were 3-4 appeals to them for help, and all times they told me: <br><blockquote>  ‚ÄúWe passed your request to our developers‚Äù <br></blockquote><blockquote>  ‚ÄúSend your source code to us, we do not understand your problem‚Äù, etc. </blockquote><br>  For the card there is also a guide, which is useful.  It describes all the tags and values ‚Äã‚Äãthat can be set. <br><br><h2>  Development </h2><br>  If you installed everything correctly, VisualStudio when creating a new project you will have the MapXtreme project type (I have version 8.0, because we bought a license). <br><br><div style="text-align:center;"><img src="http://clip2net.com/clip/m497549/88ae3-clip-20kb.png" alt="image"></div><br>  Choose a Windows Form App.  If no new items appear in the ToolBox, open the menu item <br><blockquote>  Tools ‚Üí Choose ToolBox Items ... </blockquote><br>  And in the window that appears, choose the tools we need: <br><br><div style="text-align:center;"><img src="http://clip2net.com/clip/m497549/5b3c1-clip-23kb.png?nocache=1" alt="image"></div><br>  So, we all installed, configured and ready to write code MapXtreme provides ready-made components for creating an application.  You can immediately make the MapXteme toolbar by adding a ToolStrip component to the main form, which stores the buttons we need. <br><br><div style="text-align:center;"><img src="http://clip2net.com/clip/m497549/8c757-clip-31kb.png" alt="image"></div><br>  To use the buttons that we selected for the MapControl property, we write the name of our element of the type MapControl.  My name is mapControl1, yours may be different.  Or in the form designer to write <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Form1_Load</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { addrectangleToolStripButton1.MapControl = mapControl1; .... }</code> </pre> <br>  If everything is done correctly, then you should get this: <br><br><div style="text-align:center;"><img src="http://clip2net.com/clip/m497549/79b93-clip-10kb.png" alt="image"></div><br><blockquote>  <i>‚ÄúI did everything right, I chose a drawing tool, but nothing works out for me!</i>  <i>Why?"</i> </blockquote><br>  To solve this problem, you must select the layer on which we will draw and make it changeable.  By default, all layers on mapControl are immutable. <br><br>  We can solve our problem with MapXtreme by clicking the ‚ÄúLayer Control‚Äù button and ticking the right places. <br><br><div style="text-align:center;"><img src="http://clip2net.com/clip/m497549/af0c2-clip-11kb.png" alt="image"></div><br>  Or do it right in the code: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> layerTemp = mapControl1.Map.Layers[<span class="hljs-string"><span class="hljs-string">"wldcty25"</span></span>]; LayerHelper.SetInsertable(layerTemp, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);<span class="hljs-comment"><span class="hljs-comment">//      LayerHelper.SetEditable(layerTemp, true); //   </span></span></code> </pre><br>  I note that you can only draw on the "upper" layer, that is, in order to draw an object, we need to move our "wldcty25" layer up: <br><br><div style="text-align:center;"><img src="http://clip2net.com/clip/m497549/95c1f-clip-7kb.png" alt="image"></div><br>  Or write in the code: <br><br><pre> <code class="cs hljs">mapControl1.Map.Layers.Move(lastPosition, nextPosition);</code> </pre><br>  As a result, our first object is drawn: <br><br><div style="text-align:center;"><img src="http://clip2net.com/clip/m497549/81847-clip-36kb.png" alt="image"></div><br><blockquote>  As I said earlier, any setting can be specified via the interface.  However, the customer is often fastidious and he needs more flexible / accessible configuration elements, so I‚Äôll not talk about how to configure something through MapXtreme components.  I will show how to do this through code. </blockquote><br>  I want to start with the style.  The main class responsible for the design is <i>CompositeStyle</i> .  In MapXtreme, we can style the layer and the object.  I note that the layer style overlaps the style of the object. <br><br><pre> <code class="cs hljs">SimpleLineStyle border;<span class="hljs-comment"><span class="hljs-comment">//   border= new SimpleLineStyle(&lt;    MapXtreme&gt;, &lt;  &gt;, &lt; &gt;) SimpleInterior interior;//    interior = new SimpleInterior(&lt; &gt;, &lt;  &gt;,&lt; &gt;) AreaStyle polygon;//          polygon = new AreaStyle(border, interior); SimpleLineStyle line;//   line = new SimpleLineStyle(&lt;    MapXtreme&gt;, &lt;  &gt;, &lt; &gt;) BasePointStyle point;//   point = new SimpleVectorPointStyle(&lt; &gt;, &lt; &gt;, &lt; &gt;) CompositeStyle compStyle;//    compStyle = CompositeStyle(polygon, line, null, point);</span></span></code> </pre><br>  Apply this style to the layer: <br><br><pre> <code class="cs hljs">FeatureOverrideStyleModifier fosm; fosm = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FeatureOverrideStyleModifier(parStyleName, parStyleAlias, compStyle); myLayer.Modifiers.Append(featureOverrideStyleModifier);</code> </pre><br>  Apply the received style to the object: <br><br><pre> <code class="cs hljs">Feature feature = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; feature = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Feature(&lt;   &gt;, compStyle);</code> </pre><br><h4>  Object creation </h4><br>  To create a multiline or multipolygon, we first create the source data: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//    DPoint[] pts1 = new DPoint[5]; pts1[0] = new DPoint(-20, 10);//      pts1[1] = new DPoint(10, 15); pts1[2] = new DPoint(15, -10); pts1[3] = new DPoint(-10, -10); pts1[4] = new DPoint(-20, 10); //    DPoint[] pts2 = new DPoint[5]; pts2[0] = new DPoint(-40, 50); pts2[1] = new DPoint(60, 45); pts2[2] = new DPoint(65, -40); pts2[3] = new DPoint(25, 20); pts2[4] = new DPoint(-40, 50); //LineString     DPoint LineString lineString1 = new LineString(coordSys, pts1); LineString lineString2 = new LineString(coordSys, pts2);</span></span></code> </pre><br>  Using the code above create: <br><br>  - multipolygon <br><br><pre> <code class="hljs pgsql">//Ring     coordSys   LineString Ring ring1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Ring(coordSys, lineString1); Ring ring2 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Ring(coordSys, lineString2); Ring[] rng1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Ring[<span class="hljs-number"><span class="hljs-number">2</span></span>]; rng1[<span class="hljs-number"><span class="hljs-number">0</span></span>] = ring2; rng1[<span class="hljs-number"><span class="hljs-number">1</span></span>] = ring1; //MultiPolygon    Ring MultiPolygon multiPol = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MultiPolygon(coordSys, rng1);</code> </pre><br>  - multiline <br><br><pre> <code class="hljs pgsql">//Curve     coordSys   LineString Curve curve4 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Curve(coordSys, lineString1); Curve curve5 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Curve(coordSys, lineString2); Curve[] crv = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Curve[<span class="hljs-number"><span class="hljs-number">2</span></span>]; crv[<span class="hljs-number"><span class="hljs-number">0</span></span>] = curve5; crv[<span class="hljs-number"><span class="hljs-number">1</span></span>] = curve4; //MultiCurve    Curve MultiCurve mc = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MultiCurve(coordSys, crv);</code> </pre><br><h4>  Work with map projection </h4><br>  Receiving: <br><br><pre> <code class="cs hljs">CoordSys oordSys= mapControl1.Map.GetDisplayCoordSys();</code> </pre> <br>  Creating and changing the current coordinate system: <br><br><pre> <code class="cs hljs">CoordSys cs = Session.Current.CoordSysFactory.CreateCoordSys(<span class="hljs-string"><span class="hljs-string">"EPSG:3395"</span></span>, CodeSpace.Epsg); mapControl1.Map.SetDisplayCoordSys(cs);</code> </pre><br>  In fact, there are a lot of overloaded constructors, but usually two are enough, since in practical tasks work in three or four coordinate systems is necessary. <br><br>  I have not said anything about working with bitmaps.  She is here as well.  However, if you change the coordinate system, then your image is unlikely to be transformed if you do not register a trace.  line: <br><br><pre> <code class="cs hljs">mapControl1.Map.RasterReprojectionMethod = ReprojectionMethod.Always; <span class="hljs-comment"><span class="hljs-comment">/** *ReprojectionMethod    * None = 0, //    * Always = 1,//  * Optimized = 2//     ,         *  */</span></span></code> </pre><br>  Personally, I only worked with GeoTiff.  MapXtreme does not work directly with images.  In order for everything to be good, the system needs a * .tab file that will contain a description of the raster, the coordinate system, the coordinates of the corners. <br><br>  How to do * .tab for a raster using MapXtreme means I didn‚Äôt find it, the Internet didn‚Äôt give any hints either, and I had to write the method myself that would create this file: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateTabFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">List&lt;DoublePoint&gt; parImageCoordinate</span></span></span><span class="hljs-function">)</span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//   { NumberFormatInfo nfi = new CultureInfo("en-US", false).NumberFormat; var ext = m_fileName.Split(new Char[] { '.' }); var fileExt = ext[ext.GetLength(0) - 1]; string fileTabName = m_fileName.Substring(0, m_fileName.Length - fileExt.Length) + "TAB"; StreamWriter sw = new StreamWriter(fileTabName); string header = "!table\n!version 300\n!charset WindowsCyrillic\n \n"; sw.WriteLine(header); string definitionTables = "Definition Table\n "; definitionTables += "File \"" + m_fileName + "\"\n "; definitionTables += "Type \"RASTER\"\n "; for (var i = 0; i &lt; parImageCoordinate.Count; i++) { definitionTables += "(" + parImageCoordinate[i].Longitude.ToString("N", nfi) + "," + parImageCoordinate[i].Latitude.ToString("N", nfi) + ") "; definitionTables += "(" + parImageCoordinate[i].PixelColumn.ToString() + "," + parImageCoordinate[i].PixelRow.ToString() + ") "; definitionTables += "Label \" " + (i + 1).ToString() + " \",\n "; } definitionTables = definitionTables.Substring(0, definitionTables.Length - 4); definitionTables += "\n "; definitionTables += "CoordSys Earth Projection 1, 104\n "; definitionTables += "Units \"degree\"\n"; sw.WriteLine(definitionTables); string metaData = "begin_metadata\n"; metaData += "\"\\IsReadOnly\" = \"FALSE\"\n"; metaData += "\"\\MapInfo\" = \"\"\n"; string hash; using (MD5 md5Hash = MD5.Create()) { hash = GetMd5Hash(md5Hash, m_fileName); } metaData += "\"\\MapInfo\\TableID\" = \"" + hash + "\"\n"; metaData += "end_metadata\n"; sw.WriteLine(metaData); sw.Close(); return fileTabName; }</span></span></span></span></code> </pre><br>  The <i>GetMd5Hash</i> method <i>is</i> taken from <a href="https://msdn.microsoft.com/ru-ru/library/s02tk69a(v%3Dvs.110).aspx">MSDN</a> .  So now our mapControl1 is ready to work with a raster. <br><br>  All for now.  It turned out and volume, I guess.  Why decided to write?  Because I did not find any good content on this issue either in Habr√© or in the Internet segment of the Internet. </div><p>Source: <a href="https://habr.com/ru/post/331590/">https://habr.com/ru/post/331590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331576/index.html">Creating a 3D printer shader effect</a></li>
<li><a href="../331582/index.html">Teach the bot! - marking of emotions and semantics of the Russian language</a></li>
<li><a href="../331584/index.html">Optimization history of one IoC container</a></li>
<li><a href="../331586/index.html">Design of the city based on data. Lecture in Yandex</a></li>
<li><a href="../331588/index.html">Compressing photos without apparent loss of quality: the Yelp experience</a></li>
<li><a href="../331594/index.html">GUI on Grafana for mgstat - system monitoring utilities on InterSystems Cach√©, Ensemble or HealthShare</a></li>
<li><a href="../331596/index.html">Level editor for three in a row</a></li>
<li><a href="../331598/index.html">Phoenix Framework - Webpack instead of Brunch, deploy using Distillery and a little systemd</a></li>
<li><a href="../331600/index.html">Two in one: how to use vim and nano?</a></li>
<li><a href="../331604/index.html">How to create visual effects for games</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>