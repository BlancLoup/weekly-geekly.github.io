<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deep learning to identify paintings</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! Today I want to talk about how deep learning helps us better understand art. The article is divided into parts in accordance with the tasks ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deep learning to identify paintings</h1><div class="post__text post__text-html js-mediator-article"><p>  Hi, Habr!  Today I want to talk about how deep learning helps us better understand art.  The article is divided into parts in accordance with the tasks that we solved: </p><br><ol><li>  search for a picture in the database of a photo taken by a mobile phone; </li><li>  <a href="https://habr.com/company/singularis/blog/422357/">definition of the style and genre of the picture, which is not in the database.</a> </li></ol><br><p>  All this was to be part of the <a href="https://artchive.ru/">Arthive DB service</a> and its mobile applications. </p><br><p>  The task of identifying the paintings was to find the corresponding picture in the database, coming from the mobile application, in less than one second.  Processing entirely in the mobile device was excluded at the stage of the pre-project study.  In addition, it turned out that <s>it</s> is <s>impossible</s> to guarantee the separation of the picture from the background in real conditions of shooting on a mobile device.  Therefore, we decided that our service would accept a photo from the mobile phone as a whole, with all distortions, noises and possible partial overlapping. </p><br><img src="https://habrastorage.org/webt/cn/if/2y/cnif2ycyblx3ytn1e66pngunngq.jpeg"><br><p>  Will we help Dasha find these pictures in a database of more than 200,000 images? </p><a name="habracut"></a><br><p>  The artwork base of <a href="https://artchive.ru/">Arthive</a> includes almost 250,000 images, along with various metadata.  The base is continuously updated - from tens to hundreds of images per day.  Even downloaded with limited resolution (no more than 1400 pixels on most of the sides) images occupy more than 80 gigabytes.  Unfortunately, the base is ‚Äúdirty‚Äù: there are broken or too small files, unaligned and unprocessed images, duplicate images.  However, this is generally good data. </p><br><h2>  Comparison of pictures </h2><br><p>  Let's see how the images look in the database: <br></p><table><tbody><tr><td align="center"> <a href="https://artchive.ru/artists/6510~Mark_Rotko/works/481701~Oranzhevoe_krasnoe_zheltoe"><img src="https://habrastorage.org/webt/sz/1q/rz/sz1qrz48kric62h7miqopl9lj1u.jpeg"><br></a>  <a href="https://artchive.ru/artists/6510~Mark_Rotko/works/481701~Oranzhevoe_krasnoe_zheltoe">Mark Rothko</a> <a href="https://artchive.ru/artists/6510~Mark_Rotko/works/481701~Oranzhevoe_krasnoe_zheltoe"><br></a>  <a href="https://artchive.ru/artists/6510~Mark_Rotko/works/481701~Oranzhevoe_krasnoe_zheltoe">Orange, Red, Yellow</a> <br></td><td align="center"> <a href="https://artchive.ru/artists/567~Ilja_Efimovich_Repin/works/32846~Monakhinja"><img src="https://habrastorage.org/webt/2s/2j/fi/2s2jfinlqycohujkfvv9khkcv2q.jpeg"><br></a>  <a href="https://artchive.ru/artists/567~Ilja_Efimovich_Repin/works/32846~Monakhinja">Ilya Repin</a> <a href="https://artchive.ru/artists/567~Ilja_Efimovich_Repin/works/32846~Monakhinja"><br></a>  <a href="https://artchive.ru/artists/567~Ilja_Efimovich_Repin/works/32846~Monakhinja">Nun</a> <br></td><td align="center"> <a href="https://artchive.ru/artists/1851~David_Davidovich_Burljuk/works/26734~Zhenschiny_iz_tropikov"><img src="https://habrastorage.org/webt/9l/ri/v0/9lriv0ga3emv589y3yrsbkxzwji.jpeg"><br></a>  <a href="https://artchive.ru/artists/1851~David_Davidovich_Burljuk/works/26734~Zhenschiny_iz_tropikov">David Burliuk</a> <a href="https://artchive.ru/artists/1851~David_Davidovich_Burljuk/works/26734~Zhenschiny_iz_tropikov"><br></a>  <a href="https://artchive.ru/artists/1851~David_Davidovich_Burljuk/works/26734~Zhenschiny_iz_tropikov">Tropic women</a> <br></td></tr></tbody></table><br><p>  Basically, in the base of the image are aligned, cropped along the edges of the canvas, the colors are saved. </p><br><p>  This is how requests from mobile devices might look like: </p><br><p><img src="https://habrastorage.org/webt/1p/iv/ej/1pivejjuiwsrqmhrh1yjonxeu-c.jpeg"></p><br><p>  The colors are almost always distorted - there is a complex lighting, there are highlights, there are even reflections of other paintings in the glass.  The images themselves are perspective distorted, may be partially cropped or, alternatively, occupy less than half of the image, may be partially closed, for example, by people. </p><br><p>  In order to identify pictures you need to be able to compare images from queries with images in the database. </p><br><p>  To compare images prone to perspective distortion and color distortion, we use the mapping of key points.  To do this, we find key points with descriptors on the images, find their correspondence, and then a homographic mapping of the corresponding points using the RANSAC method.  This is done as a whole in the same way as described in the <a href="https://docs.opencv.org/3.1.0/d7/dff/tutorial_feature_homography.html">OpenCV</a> example.  If the number of ‚Äúgood points‚Äù (inlier) found by RANSAC is large enough, and the homographic transformation found looks quite plausible (does not have strong scaling or rotations), then we can assume that the desired images are the same picture, subject to perspective distortions . </p><br><p>  Example of matching key points: </p><br><p><img src="https://habrastorage.org/webt/jg/vq/df/jgvqdfnkcmhe9-ohvbubeyajiua.jpeg"></p><br><div class="spoiler">  <b class="spoiler_title">Negative mapping example</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q_/8b/yz/q_8byzpsh8rizjhgsol2z1nye4g.jpeg"></div></div><br><div class="spoiler">  <b class="spoiler_title">Comparison of pictures from the example above</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/df/qb/ff/dfqbffq4ibpvjz1qh4_xhjhejvm.jpeg"><br><img src="https://habrastorage.org/webt/l4/b9/5a/l4b95adleete923jqu8leqc_gr4.jpeg"><br><img src="https://habrastorage.org/webt/sw/zc/os/swzcosr49hcjkuqc98lux5cwces.jpeg"><br><img src="https://habrastorage.org/webt/cn/hi/rr/cnhirrksz5srhe81bc3i0mc1exc.jpeg"><br><img src="https://habrastorage.org/webt/4r/y5/uf/4ry5ufekvsefkbba9allszpesro.jpeg"><br><img src="https://habrastorage.org/webt/70/oj/jy/70ojjy-ovr6eouymbnx7h0jel9i.jpeg"></div></div><br><p>  Of course, the search for key points is usually quite a slow process, but to search the database you can find the key points of all the pictures in advance and save some of them.  In our experiments, we came to the conclusion that less than 1000 points are enough for a confident search for pictures.  When using 64 bytes per point (coordinates + AKAZE descriptor), 64 Kb for each image or about 15 GB for the entire base is enough to store 1024 points. </p><br><p>  Comparison of pictures on key points in our case took about 15 ms, that is, for a complete search of the base of 250,000 pictures, it takes about 1 hour.  It's a lot. </p><br><p>  On the other hand, if we learn how to quickly select several (say, 100) most likely candidates from the entire base, we will meet the target time of 1 second per request. </p><br><h2>  Ranking pictures by similarity </h2><br><p>  Deep convolutional networks have proven to be a good way to search for similar images.  The network is used to extract features and compute a descriptor based on them, which has the property that the distance (Euclidean, cosine or other) between similar image descriptors will be less than for different images. </p><br><p>  It is possible to train the network in such a way that for the image of a picture from the base and its distorted image from a photo it gives out similar descriptors, and for different pictures - more distant ones.  Further, this network is used to calculate the descriptors of all images in the database and photo descriptors in the requests.  Quickly enough, you can select the nearest images and arrange them according to the distance between the descriptors. <br></p><p>  The basic way to train a network to calculate a descriptor is to use the Siamese network. </p><br><p><img src="https://habrastorage.org/webt/eh/1l/xi/eh1lxi3gh88kjrqucs6kc2a4lpq.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>,</mo><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.261ex" height="2.419ex" viewBox="0 -780.1 1404.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-62" x="974" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> a, b </script>  - input images <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.416ex" height="2.298ex" viewBox="0 -728.2 2332.1 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-31" x="1831" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2"> y = 1 </script>  , if a <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.455ex" viewBox="0 -520.7 529.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> a </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> b </script>  - one class <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.937ex" viewBox="0 -728.2 500.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-30" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-5"> 0 </script>  if different <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mi>D</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><msup><mi>R</mi><mi>d</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.995ex" height="2.901ex" viewBox="0 -935.7 7317.3 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="1469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="1859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-66" x="2304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="2854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-62" x="3244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="3673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-44" x="4063" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-69" x="5141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6E" x="5487" y="0"></use><g transform="translate(6087,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-64" x="1074" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mi>D</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><msup><mi>R</mi><mi>d</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-6"> f (a), f (b) D \ in R ^ d </script>  - image descriptors <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.847ex" height="2.66ex" viewBox="0 -832 9406.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="1442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-62" x="1887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="2317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-3D" x="2984" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-64" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="4564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-66" x="4953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="5504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="5893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="6423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="6812" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-66" x="7257" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="7808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-62" x="8197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="8627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="9016" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> d (a, b) = d (f (a), f (b)) </script>  - distance between a pair of feature vectors <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>y</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>i</mi><mi>n</mi><mo>&amp;#x2212;</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="59.256ex" height="2.66ex" viewBox="0 -832 25512.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-73" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-73" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-3D" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-79" x="3057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-63" x="3804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-64" x="4238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6F" x="4761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-74" x="5247" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-64" x="5608" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="6132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="6521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="7051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-62" x="7496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="7925" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2B" x="8537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="9538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-31" x="9927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2212" x="10650" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-79" x="11651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="12148" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-63" x="12788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-64" x="13221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6F" x="13745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-74" x="14230" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6D" x="14592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="15470" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-78" x="16000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="16572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-30" x="16962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="17462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6D" x="17907" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="18786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-72" x="19315" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-67" x="19767" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-69" x="20247" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6E" x="20593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2212" x="21416" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-64" x="22416" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="22940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="23329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="23859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-62" x="24304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="24733" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="25123" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>y</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><mi>y</mi><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>i</mi><mi>n</mi><mo>‚àí</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8"> loss = y \ cdot d (a, b) + (1 - y) \ cdot max (0, margin - d (a, b)) </script>  - objective function </p><br><p> To build such an architecture, the network that calculates the descriptor (Feature Extractor) is used in the model 2 times with common weights.  A couple of images are fed to the network.  The Network's Feature Extractor calculates image descriptors, then the network calculates the distance according to a given metric (the Euclidean or cosine distance is usually used).  The objective function of network learning is constructed in such a way that for positive pairs (images of one picture) the distance decreases, and for negative pairs (images of different pictures) it increases.  To reduce the effect of negative pairs, the distance between them is limited by the margin value. </p><br><p>  Thus, it can be said that in the process of learning the network tends to calculate descriptors of similar images inside a hypersphere with a radius of margin, and descriptors of different images push it out of this sphere. </p><br><p>  For example, this is how a two-dimensional descriptor training with the help of a Siamese network on the MNIST dataset can look like. </p><br><p><img src="https://habrastorage.org/webt/vs/5y/7n/vs5y7nggt4cvqls3ohka9v8qmqi.jpeg"></p><br><div class="spoiler">  <b class="spoiler_title">Learning animation</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hl/-u/fv/hl-ufvknsfliuuxpfvaqrynkusm.gif"></div></div><br><p>  To train the Siamese network, you need to input a pair of pictures and a label that is equal to 1 if the pictures belong to the same class, or 0 if they are different.  There is the problem of choosing the proportion of positive and negative pairs.  Ideally, of course, all the possible combinations of pairs from the training set should be submitted to the network training, but this is technically impossible.  And the number of negative pairs in this case significantly exceeds the number of positive ones, which is also not very good for the learning process. </p><br><p>  Part of the problem with choosing the proportion of pairs for training is solved by using the triplet architecture. </p><br><p><img src="https://habrastorage.org/webt/u4/a5/yz/u4a5yzgvxnum6zlvbugpj9japvm.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.862ex" height="1.817ex" viewBox="0 -520.7 2523.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-70" x="974" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="1478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6E" x="1923" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> a, p, n </script>  - input images: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>,</mo><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.433ex" height="1.817ex" viewBox="0 -520.7 1478.2 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-70" x="974" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> a, p </script>  - one picture <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> n </script>  - another <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>i</mi><mi>n</mi><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.161ex" height="2.66ex" viewBox="0 -832 18152.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-73" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-73" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-3D" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6D" x="3057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="3935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-78" x="4465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="5037" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-64" x="5427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="5950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="6340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="6869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-70" x="7314" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="7818" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2212" x="8429" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-64" x="9430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-28" x="9954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="10343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="10873" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6E" x="11318" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="11918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2B" x="12530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6D" x="13531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-61" x="14409" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-72" x="14939" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-67" x="15390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-69" x="15871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMATHI-6E" x="16216" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-2C" x="16817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-30" x="17262" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;xid=17259,15700002,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhpw0P5fZJkf5kZMDUvZLz7ekDmTg#MJMAIN-29" x="17762" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>i</mi><mi>n</mi><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12"> loss = max (d (a, p) - d (a, n) + margin, 0) </script>  - objective function </p><br><p>  At the entrance of such a network, 3 pictures are immediately served, which form positive and negative pairs. </p><p></p><p>  In addition, almost all researchers agree that the choice of negative pairs is crucial for network learning.  The objective function for many samples (pairs for siamese, triples for triplet) is equal to 0, if they do not violate the margin limit, therefore, such samples do not participate in network training.  Over time, the learning process slows down even more, as samples with a non-zero value of the objective function become smaller.  To solve this problem, negative pairs are not chosen by chance, but by using hard case mining.  In practice, several candidates of negatives are selected for this, for each of which a descriptor is calculated using the latest version of the weights of the network (from the previous era or even the current one).  Having a descriptor, you can choose a negative in each of the three that produces a deliberately non-zero loss. </p><br><p>  To search for similar images from the network, they separate Feature Extractor and use it to calculate descriptors.  For images in the database descriptors are calculated in advance when they are added.  Thus, the task of searching for similar images is to calculate the image descriptor in the query and search for the descriptors in the database that are closest in a given metric. </p><br><p>  The feature extractor of our network is based on the Inception v3 architecture.  Experimentally, one of the intermediate layers was chosen, on the basis of the output of which a descriptor of 512 real numbers is calculated. </p><br><p><img src="https://habrastorage.org/webt/0q/w2/mz/0qw2mzgdztu_zyr9fxxsijznzrw.png"></p><br><h2>  Data augmentation </h2><br><p>  It would be nice if we could put each picture in a different frame, on different walls and take a picture each time from a different angle on different phones.  In practice, this is of course impossible.  Therefore it is necessary to generate training data. </p><br><p>  To generate data, about 500 photographs of various pictures with different backgrounds under different lighting were collected.  For each photo 4 points were selected, corresponding to the corners of the canvas of the picture.  For four points, we can arbitrarily enter any image into the frame, thereby replacing the image and receiving an almost random perspective distortion of the picture from the database.  Complementing this process with random crops, noises and color distortions, we are able to generate perfectly suitable images that imitate photographs of paintings. </p><br><p><img src="https://habrastorage.org/webt/fi/ad/wg/fiadwgwcbv0bqqgbfiphnthicm8.jpeg" alt="Artification"></p><br><h2>  Separating the painting from the background </h2><br><p>  The quality of work and patterns of identification of paintings, and models of classification of genres / styles largely depends on how well the picture is separated from the background.  Ideally, before you feed the picture into the model, you need to find the 4 corners of its canvas and map it perspectively to the square.  In practice, it was very difficult to implement an algorithm to do this with guarantee.  On the one hand, there is a significant variety of backgrounds, frames and objects that can get into the frame near the picture.  On the other hand, there are paintings, inside of which there are quite noticeable outlines of rectangular shapes (windows, facades of buildings, picture-in-picture).  As a result, it is often very difficult to say where the picture ends and its environment begins. </p><br><p>  Ultimately, we stopped at a simple implementation based on classical methods of computer vision (border detection + morphological filtering + analysis of connected components), which allows you to confidently cut off monochromatic backgrounds, but not to lose some of the picture. </p><br><h2>  Work speed </h2><br><p>  The query processing algorithm consists of the following basic steps: </p><br><ol><li>  preparation - the simplest detector of the picture is actually implemented, which works well if the image contains a plain background; </li><li>  the calculation of the picture descriptor using a deep network; </li><li>  ranking of pictures by distance to the descriptors in the database; </li><li>  search for key points in the picture; </li><li>  check candidates in order of ranking. </li></ol><br><p>  We tested the speed of the network on 200 requests, we got the following processing time for each of the stages (time in seconds): <br></p><table><thead><tr><th>  stage </th><th>  min </th><th>  Max </th><th>  the average </th></tr></thead><tbody><tr><td>  Preparation (search picture) </td><td>  0.008 </td><td>  0.011 </td><td>  0.016 </td></tr><tr><td>  Handle Calculation (GPU) </td><td>  0.082 </td><td>  0.092 </td><td>  0.088 </td></tr><tr><td>  KNN (k &lt;500, CPU, brute force) </td><td>  0.199 </td><td>  <strong>0.820</strong> </td><td>  0.394 </td></tr><tr><td>  Search key points </td><td>  0.031 </td><td>  0.432 </td><td>  0.156 </td></tr><tr><td>  Check key points </td><td>  0.007 </td><td>  <strong>9.844</strong> </td><td>  2.585 </td></tr><tr><td>  <strong>Total Request Time</strong> </td><td>  0.358 </td><td>  10.386 </td><td>  3.239 </td></tr></tbody></table><br><p>  Since the check of candidates stops immediately, as the picture will be found with sufficient confidence, we can assume that the minimum request processing time corresponds to the pictures found among the first candidates.  The maximum request time is obtained for pictures that were not found at all - the check is terminated after 500 candidates. </p><br><p>  It can be seen that most of the time is spent on the selection of candidates and their verification.  It is worth noting that the implementation of these steps has been done very suboptimally and has great potential for acceleration. </p><br><h2>  Duplicate search </h2><br><p>  Having built a complete index of the database of paintings, we applied it to search for duplicates in the database.  After about 3 hours of viewing the database, it was found that at least 13657 images are repeated in the database two times (and some three). </p><br><p>  At the same time, very interesting cases were found that are not duplicates. </p><br><img src="https://habrastorage.org/webt/hj/nh/kr/hjnhkregrx0th9cdshhzvf79b9y.jpeg"><br><br>  <a href="https://artchive.ru/artists/302~Adolf_fon_Mentsel/works/19376~Serija_Opyty_v_oforte_18_Dvor_s_vygrebnoj_jamoj_shestoe_sostojanie">One</a> , <a href="https://artchive.ru/artists/302~Adolf_fon_Mentsel/works/19425~Serija_Opyty_v_oforte_17_Dvor_s_vygrebnoj_jamoj_pervoe_sostojanie">Two</a> .  It seems that these are two stages of one work. <br><br><img src="https://habrastorage.org/webt/eo/0o/qd/eo0oqdq2yip70qungxv6gttad3k.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://artchive.ru/artists/754~Vasilij_Dmitrievich_Polenov/works/25958~Na_Tiveriadskom_Genisaretskom_ozere">One</a> , <a href="https://artchive.ru/artists/754~Vasilij_Dmitrievich_Polenov/works/17240~Na_Tiveriadskom_Genisaretskom_ozere_Pozdnee_povtorenie_odnoimennoj_kartiny">Two</a> , <a href="https://artchive.ru/artists/754~Vasilij_Dmitrievich_Polenov/works/404466~Na_Tiveriadskom_Genisaretskom_ozere">Three</a> .  Do not pay attention to the name - all three paintings are different. <br><br>  As well as an example of incorrect triggering of identification by key points. <br><br><img src="https://habrastorage.org/webt/5t/gr/cr/5tgrcrmewazx_lqxd_po9cqd5v4.jpeg"><br><br>  <a href="https://artchive.ru/artists/65144~Tomas_Khadson/works/356076~Portret_damy">One</a> , <a href="https://artchive.ru/artists/237~Vladimir_Lukich_Borovikovskij/works/366225~Portret_VI_Arsenevoj">Two</a> . <br><br><div class="spoiler">  <b class="spoiler_title">matching key points</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/y1/ug/7i/y1ug7idfof7szcvsbmsbr64h7fy.jpeg"></div></div><br><h2>  Instead of conclusion </h2><br><p>  In general, we are satisfied with the result of the service. </p><br><p>  On test kits, identification accuracy in excess of 80% is achieved.  In practice, it often turns out that if a picture is not found the first time, then it is enough to photograph it from a different angle, and it is located.  Errors, when there is an incorrect image, practically do not occur. </p><br><p>  All together, the solution was wrapped in a docker container and given to the customer.  Now the identification of pictures by photo is available in applications using the Arthive service, for example, the ‚ÄúPushkin Museum‚Äù available in the Play Market (however, there is a separation of the picture from the background, which requires the background to be light, which sometimes makes photographing difficult). </p></div><p>Source: <a href="https://habr.com/ru/post/421187/">https://habr.com/ru/post/421187/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../421173/index.html">Custom Google Search View</a></li>
<li><a href="../421175/index.html">Monitoring Kubernetes Cluster with Prometheus</a></li>
<li><a href="../421177/index.html">How to attract a data analyst when your company does not even have a website</a></li>
<li><a href="../421179/index.html">HashMap internal work in Java</a></li>
<li><a href="../421183/index.html">IBM patents drones that recognize emotions and carry coffee to people. And what else to write on Friday?</a></li>
<li><a href="../421189/index.html">Moving the database to an older version of MS SQL Server</a></li>
<li><a href="../421191/index.html">How easy it is for an artisan to dream with a 3D core</a></li>
<li><a href="../421193/index.html">Audi PB18 e-tron</a></li>
<li><a href="../421195/index.html">Artificial intelligence</a></li>
<li><a href="../421197/index.html">Russia is developing a neuro headset for people with speech and motor impairments</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>