<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Everything gets better when there is Bluetooth</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have long wanted to write about Bluetooth LE (4.0-4.1) kit ( CY8CKIT-042-BLE ) from Cypress Semiconductor. 
 In fact, the plans were to write in mor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Everything gets better when there is Bluetooth</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/778/f69/54f/778f6954f6434f08b018ea085d6cceec.jpg"><br>  I have long wanted to write about Bluetooth LE (4.0-4.1) kit ( <a href="http://www.cypress.com/%3FrID%3D102636">CY8CKIT-042-BLE</a> ) from Cypress Semiconductor. <br>  In fact, the plans were to write in more detail another whale, a superficial review of which I published earlier.  But he did not collect his thoughts, and then something more interesting appeared. <br><a name="habracut"></a><br>  I will not describe the ordering and delivery process, firstly, it is in the old article, secondly, there were no surprises. <br>  So, I will try to briefly describe the kit itself and examples of its use. <br><br><h4>  Hardware </h4><br>  I could not get an sensible photo; I‚Äôll confine myself to a picture from a press release: <br><img src="https://habrastorage.org/files/2e0/f24/241/2e0f242410a84ca88d492fb9e962d795.jpg"><br>  Contents of delivery: <br><ul><li>  Motherboard </li><li>  Board (module) with CY8CKIT-142 PSoC 4 BLE </li><li>  Board (module) with CY5671 PRoC BLE </li><li>  USB-BLE dongle (more about it further) </li><li>  Cable set </li><li>  Battery </li><li>  Instructions </li><li>  USB cable </li></ul><br>  That is, two modules are included with similar but still different chips. <br>  It is worth noting that a dongle can only be used with Cypress software, OS tools cannot do it with it, well, except to use the UART in some way. <br>  Each of the modules can be used either independently or used together with the motherboard, which is also a programmer. <br><br><h5>  CY8CKIT-142 PSoC 4 BLE </h5><br>  This module is interesting because there are more analog and digital peripherals (excerpts from the press release): <br><ul><li>  48-MHz ARM Cortex-M0 CPU </li><li>  128 KB Flash and 16 KB SRAM </li><li>  Bluetooth LE (Smart) connectivity with Bluetooth 4.1 (2.4-GHz Bluetooth LE radio; -92-dBm Rx sensitivity, up to + 3-dBm Tx power) </li><li>  Programmable analog (4 x Op-amps; 1 x 12-bit, 1-Msps SAR ADC; 2 x Low-Power Comparators; 1 x Cypress CapSense touch controller with SmartSense Auto-Tuning) </li><li>  Programmable digital (4 x universal digital blocks; 4 x 16-bit configurable Timer / Counter / PWM blocks; 2 x configurable serial communication blocks) </li><li>  Flexible Low Power Modes: (1.3-ŒºA Deep-Sleep Current; 150-nA Hibernate Current; 60-nA Stop Current </li><li>  Wide Operating Range 1.7 - 5.5 V (Radio 1.9 V onwards) </li><li>  56-QFN (7 x 7 x 0.6 mm), 68-ball WLCSP (3.9 x 3.5 x 0.55 mm) </li></ul><br>  I was more interested in the following module: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  CY5671 PRoC BLE </h5><br>  For me, he was interested in the fact that with him it was possible to use the library for recognizing gestures on the panel of capacitive touchpad, which, by the way, is not included: <br><ul><li>  48-MHz ARM Cortex-M0 CPU </li><li>  128 KB Flash and 16 KB SRAM </li><li>  Bluetooth LE (Smart) connectivity with Bluetooth 4.1 (2.4-GHz Bluetooth LE radio; -92-dBm Rx sensitivity, up to + 3-dBm Tx power) </li><li>  Flexible Low Power Modes: (1.3-ŒºA Deep-Sleep Current; 150-nA Hibernate Current; 60-nA Stop Current </li><li>  Analog and digital peripherals (One 12-bit, 1-Msps SAR ADC; Four 16-bit TCPWM blocks; Two SCBs, configurable as I2C, SPI or UART; I2S for audio input) </li><li>  <b>Integrated library support for one- and two-finger gestures</b> </li><li>  56-QFN (7 x 7 x 0.6 mm), 68-ball WLCSP (3.9 x 3.5 x 0.55 mm) </li></ul><br>  The cost of a whale is $ 49 plus shipping. <br><br><h4>  Application Development </h4><br>  As I already wrote, Cypress Semiconductor provides a free IDE - PSoC Creator.  Separately, I would like to dwell on the part that helps to get what is needed from BLE, in other words, configure the BLE Stack + Application layer.  Now I do not want to delve into what Bluetooth Low Energy is (aka BLE).  There is a lot of information about it, including on the habr. <br><br><h5>  PSoC Creator </h5><br>  The current version at the moment - 3.2 is available for download at the office.  website: <a href="http://www.cypress.com/psoccreator/">www.cypress.com/psoccreator</a> after registration.  The development environment has not undergone significant changes since the writing of the last <a href="http://habrahabr.ru/post/208180/">article</a> , so I don‚Äôt see any point in deepening, just to remind you that the entire development is based on the concept of components - libraries that implement this or that functionality. <br><br><h5>  BLE stack (component BLE) </h5><br>  Here I would like to elaborate in more detail on the description not of the BLE component itself, but rather on the examples that are available in PSoC Creator: <br><img src="https://habrastorage.org/files/953/66c/973/95366c9733324ff3965a392c9b61488d.png"><br>  Each of these examples is a simple project that shows the implementation of a particular profile.  For this article, I planned to use BLE_HID_Mouse, but for a number of reasons, the main one being that I do not have a touchpad that I could use to do without simulation (in the example, the cursor simply ‚Äúdraws‚Äù a square) I decided to use the example BLE_HID_Keyboard.  Looking ahead, I will say that there is also a "simulation" of the keyboard, but so much more clearly. <br><br>  So, let's open the example BLE_HID_Keyboard: <br><br><img src="https://habrastorage.org/files/67a/6e4/83b/67a6e483bde34c6888922aaeef05f972.png"><br><br>  The project itself contains a DAC (battery level measurement), a COM port for debugging, LED indicators (a 3-color LED on the whale board), and a watchdog in the normal timer mode. <br><br>  Open the configuration of the BLE components: <br><br><img src="https://habrastorage.org/files/69d/def/d35/69ddefd350504908b38bd56470e31f68.png"><br><br>  Profile Configuration Tab: <br><br><img src="https://habrastorage.org/files/357/029/120/357029120713489c87ed7b74e19bfaa6.png"><br><br>  In addition to the keyboard profile, there are also services BAS (Battery Service), DIS (Device Information Service), SCPS (Scan Parameter Service).  In principle, if you wish, you can add any service, both standard and your own: <br><br><img src="https://habrastorage.org/files/c84/20a/faf/c8420afaf7f44ae8bdba23841ff80188.png"><br><br>  After that, all characteristics and service descriptors will be entered into the GATT database, moreover, if the service is standard, APIs will be generated for it. <br><br>  Each of the services can be configured, for example, a DIS service, a field with the name of the manufacturer: <br><br><img src="https://habrastorage.org/files/c32/3ba/439/c323ba439a0d481dad023badf3064f66.png"><br><br>  Or device name: <br><br><img src="https://habrastorage.org/files/5e3/ddb/4f8/5e3ddb4f8775439a89e4e74e120b3535.png"><br><br>  Let's try to program the whale and enable the BLE 4.0-compatible adapter to start searching for new devices: <br><br><img src="https://habrastorage.org/files/ab4/9db/a84/ab49dba847ca41a7bfd22a7890f81b31.png"><br><br>  The same with the phone: <br><br><img src="https://habrastorage.org/files/818/b08/772/818b087729d2428c983fb7f169853731.PNG"><br><br>  Well, if you connect to the device from the "keyboard" data will begin to come: <br><br><img src="https://habrastorage.org/files/7e6/1d1/eb3/7e61d1eb31274018a904f23716b4e374.png"><br><br><img src="https://habrastorage.org/files/369/244/762/36924476295442d2ade307ce46153fae.PNG"><br><br><img src="https://habrastorage.org/files/a2c/a0c/37d/a2ca0c37def94f7288b7a038d762712f.png"><br><br><img src="https://habrastorage.org/files/331/2cd/da3/3312cdda38ed45bba81d0a3544a487aa.png"><br><br><img src="https://habrastorage.org/files/242/005/25e/24200525edcf4635a6cc3d61c7434e74.png"><br><br><h4>  Why am i </h4><br><br>  Well, first of all, how simple and easy it is to plunge into the world of BLE.  There were articles and described solutions from Nordic, TI, but there was no mention of Cypress Semiconductor, so I decided to fix it.  I was also interested in the fact that it is relatively simple, you can make yourself a device that will not only have a wireless connection, but will also be supported by modern OS ‚Äúout of the box‚Äù and without extra crutches. <br><br>  Secondly, I would like to try to make a remote control for the PC on my own.  Actually for this, I ordered a whale and began to deal with it.  On what was determined with the whale, but the question about the touchpad is open.  As a viriant, order another whale from Cypress with such a shield.  Well, or try to dissolve yourself, but this is not the fact that there is enough enthusiasm and knowledge.  Who knows any other options, write in the comments.  Need a shield for capacitive touchpad at least 5x5. <br>  Another interesting whale that would probably fit my goals more: <br>  <a href="http://www.cypress.com/%3FrID%3D102638">CY5672 PRoC BLE Remote Control Reference Design Kit (RDK)</a> <br>  But in my opinion it is much more interesting to do it myself, especially when there is an opportunity to do everything slowly, in pleasure. </div><p>Source: <a href="https://habr.com/ru/post/261287/">https://habr.com/ru/post/261287/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../261273/index.html">Such amazing semaphores</a></li>
<li><a href="../261275/index.html">Key trends in the development of mobile applications, which is worth remembering in 2015</a></li>
<li><a href="../261277/index.html">Detailed App Store Optimization Guide for 2015 - Part 2: Google Play Store</a></li>
<li><a href="../261279/index.html">How does the program work with all these errors?</a></li>
<li><a href="../261285/index.html">C ++ User Group, meeting in Nizhny Novgorod</a></li>
<li><a href="../261291/index.html">Entity Framework or Why I Implement Repository</a></li>
<li><a href="../261293/index.html">Effective logo design, part 1: symbols, metaphors and intuition capabilities</a></li>
<li><a href="../261295/index.html">Commercial VPN service in opensource</a></li>
<li><a href="../261301/index.html">SSL / TLS traffic analysis in Wireshark</a></li>
<li><a href="../261305/index.html">The digest of interesting materials for the mobile # 109 developer (June 22-28)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>