<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attackers use CVE-2014-6332</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently we wrote about a new dangerous vulnerability CVE-2014-6332 in Windows, which was present (MS14-064) in the OleAut32.dll library, or rather, i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attackers use CVE-2014-6332</h1><div class="post__text post__text-html js-mediator-article">  Recently we <a href="http://habrahabr.ru/company/eset/blog/243281/">wrote</a> about a new dangerous vulnerability CVE-2014-6332 in Windows, which was present (MS14-064) in the OleAut32.dll library, or rather, in the <i>OleAut32! SafeArrayRedim function</i> .  This function is used by the VBScript engine (vbscript.dll) for run-time resizing of the array in the SAFEARRAY format.  <i>SafeArrayRedim</i> itself contained a vulnerability that allowed modifying the array size field inside the function and then returning the result of the operation failure, which led to an increase in the buffer size from the point of view of the structure itself.  See more <a href="http://securityintelligence.com/ibm-x-force-researcher-finds-significant-vulnerability-in-microsoft-windows">here</a> . <br><br><img src="https://habrastorage.org/files/735/b53/311/735b533113b246389d159fad77d1c8de.jpeg"><br><br>  Due to the fact that the exploit for this vulnerability (Windows OLE Automation Array Remote Code Execution Vulnerability), in fact, can operate directly on the memory, due to damage to the buffer header structure by the OS function, it does not need to resort to <i>use-after-vulnerability operations free</i> , the entire operation is reduced to the sequential execution of several functions that help start the process from a VBScript function, bypassing DEP &amp; ASLR. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Analysts at our anti-virus lab found exploitation of this vulnerability in-the-wild.  This is a compromise of the harmful content of the website of a popular Bulgarian news agency.  We observed one of the web pages of this site that was compromised and redirected visitors to install malware using CVE-2014-6332.  The appearance of this compromised web page is shown below in the screenshot. <br><br><img src="https://habrastorage.org/files/5e0/4f0/50e/5e04f050ecab4faa80f2b00827e84012.png"><br><br>  The source HTML code of this web page contains a malicious iframe that points to the exploit installation page. <br><br><img src="https://habrastorage.org/files/5c8/a31/1a1/5c8a311a189e4434ba3619db44425e63.png"><br><br>  As seen in the screenshot above, the exploit is placed on a web page belonging to the natmasla domain [.] Ru.  It is detected by ESET AV products as <b>Win32 / Exploit.CVE-2014-6332.A</b> .  The discovered exploit is based on a proof-of-concept code, which was published by a Chinese editor.  In the PoC indicated his data. <br><br><img src="https://habrastorage.org/files/e17/0f5/1a1/e170f51a1e634ea9a660104b995e14dd.png"><br><br>  It was easy for an attacker to modify the original PoC to install its malicious software into the system. <br><br>  Oddly enough, the malicious page itself contains the exploit code twice.  In the first case, the payload is a set of instructions from the Windows command interpreter (cmd.exe).  They are listed in the screenshot below. <br><br><img src="https://habrastorage.org/files/c4f/65e/1df/c4f65e1dfd164cf4b2ab0b0d632b6cd3.png"><br><br>  As you can see, in this set of commands there is one group of them with the [at] echo prefix, which is intended for writing special instructions to a text file (KdFKkDls.txt, the file name may be different for different modifications of the exploit).  These instructions are intended for the ftp application, which runs with the special key -s (take commands to execute from a file).  Special ftp instructions are written to the file. They are used to connect to a remote server with the specified username and password, then the executable file is loaded and launched. <br><br>  In the case of the second payload, it looks like the following instructions. <br><br><img src="https://habrastorage.org/files/6a7/394/853/6a7394853ff445028984041cb1a84e5f.png"><br><br>  It can be seen that this time <a href="https://ru.wikipedia.org/wiki/Windows_PowerShell">PowerShell is</a> used to download the executable file from a remote server. <br><br>  Malware downloaded in this way is detected by ESET AV products as <b>Win32 / IRCBot.NHR</b> .  It has a number of features in its arsenal, including the organization of DDoS attacks and the opening of remote access to a computer for intruders. </div><p>Source: <a href="https://habr.com/ru/post/244115/">https://habr.com/ru/post/244115/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244105/index.html">DD-WRT and SSL certificates</a></li>
<li><a href="../244107/index.html">PIN code when paying by card - dots above i</a></li>
<li><a href="../244109/index.html">A few thoughts about analyzing other people's opinions</a></li>
<li><a href="../244111/index.html">Setting up a server with Chef (Quick and easy)</a></li>
<li><a href="../244113/index.html">PHPixie Amalgama - Internationalization in PHPixie</a></li>
<li><a href="../244117/index.html">Multiple PHP Versions Under One Apache on Windows</a></li>
<li><a href="../244119/index.html">eBay API: Step Two</a></li>
<li><a href="../244121/index.html">How-to: How the hosting provider infrastructure is built</a></li>
<li><a href="../244127/index.html">14 effective tips for content marketing for small businesses (part 2)</a></li>
<li><a href="../244129/index.html">Search for a site for hackathon. HackDay Experience</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>