<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to optimally calculate the amount of "iron": Sizing model of the EFS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="More than a hundred teams participate in the development of the Sberbank Unified Frontal System Program. Each team creates and develops a specific pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to optimally calculate the amount of "iron": Sizing model of the EFS</h1><div class="post__text post__text-html js-mediator-article">  More than a hundred teams participate in the development of the Sberbank Unified Frontal System Program.  Each team creates and develops a specific product or service component.  Each new initiative requires an estimate of the amount of hardware that will be required to develop and implement this initiative.  And this is a large stream of requests for evaluation.  How we solve this problem, read under a cat. <br><br><img src="https://habrastorage.org/web/361/5cb/4c3/3615cb4c36d449bdb18d426c3369bac1.jpg"><br><a name="habracut"></a><br>  Evaluation is required at the start - for budget reservation and financial justification of the initiative.  As a rule, we have a preliminary architecture and estimates from the business for the planned load, as well as estimates from the technologist for the load on the integration interactions.  The total number and composition of positions can be adjusted in the course of design and implementation, or according to the results of load testing.  That is, everything is complicated by the fact that the input data is small and "this is not accurate." <br><br>  But there are smoothing factors.  Despite the fact that the calculation is carried out separately, all reserved iron falls into the common reserve pool of the ESF Program.  This allows in many places to use the "average temperature in the hospital" - if in fact in one case the load was greater, it is leveled in the other.  An additional smoothing factor is that the presence in the reserve pool does not mean direct costs, since the equipment park is centrally managed and the physical reserve is common to the entire bank.  For us, it is more important to minimize the system error than the error in a particular sizing. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This means that the classic approach to sizing, which implies the development of a sizing model for each initiative, multiple input parameters and a separate calculation for each component, is not suitable here.  Fortunately, we still have a single system, there are three or four typical architectures, assembled from typical ‚Äúcubes‚Äù.  Therefore, we managed to reduce all the complexity and variability into a general sizing model. <br><br><h2>  What is a sizing model in the ESF? </h2><br>  Sizing model is a template of several sections.  Consider each of them in more detail. <br><br><h3>  Section 1. Input </h3><br>  We minimized the amount of input data, leaving only those that significantly affect the assessment of "iron", and at the same time can be obtained from the product team at an early stage.  The key input parameter is the peak number of business transactions per hour. <br>  We separate the input for remote channels and the internal network. <br><br>  In both cases, we receive an estimate from the customer: <br><br><ol><li>  Peak number of business transactions per hour.  This indicator is key and affects the required processing capacity. <br></li><li>  The average number of business transactions per day.  Specifies the amount of stored data. <br></li></ol><br>  We also get the number of requests through MQ (Messages Queue) integration with external systems. <br><br><table><tbody><tr><td colspan="2">  <b>Internal network</b> <br></td></tr><tr><td>  <b>Name</b> <br></td><td>  <b>Comment</b> <br></td></tr><tr><td>  Peak number of business transactions per hour <br></td><td>  Taken from business requirements or calculated: operations per day / 10 <br></td></tr><tr><td>  Average number of business transactions per day <br></td><td>  Taken from business requirements or calculated: operations per hour * 10 <br></td></tr><tr><td>  Peak number of requests via MQ per second (direct integration with external systems) <br></td><td>  The amount of the interactions point-to-point through MQ <br></td></tr></tbody></table><br><table><tbody><tr><td colspan="2">  <b>External network</b> <br></td></tr><tr><td>  <b>Name</b> <br></td><td>  <b>Comment</b> <br></td></tr><tr><td>  Peak number of business transactions per hour <br></td><td>  Taken from business requirements or calculated: operations per day / 10 <br></td></tr><tr><td>  Average number of business transactions per day <br></td><td>  Taken from business requirements or calculated: operations per hour * 10 <br></td></tr></tbody></table><br>  The ‚Äúmagic number‚Äù 10, connecting the peak volume per hour and average per day, is used when the customer cannot estimate both parameters himself.  It is based on the experience of industrial operation of Sberbank systems and is determined by the following features of its business: <br><br><ol><li>  In Russia, 12 time zones, offices and customers are distributed in all time zones, the time of the offices - 10-12 hours a day. <br></li><li>  The largest number of users and operations are concentrated in the time zone of Moscow, this zone determines the peak load. <br></li><li>  The load distribution on the clock has two peaks - in the morning and in the afternoon, generally the same for all time zones, taking into account the time shift. <br></li></ol><br>  <b>Model Parameters</b> <br><br><img src="https://habrastorage.org/web/9e1/dfc/9e4/9e1dfc9e49de4d7a890359144e42c07f.png"><br><br>  See <a href="">larger</a> diagram <a href="">.</a> <br><br>  <b>Figure 1. Simplified architecture of the ESF</b> <br><br>  The architecture of the ESF is based on the classical three-tier architecture. <br><br><ol><li>  Presentation layer.  Most often - just nginx with statics, in special cases an application server is added. <br></li><li>  Application server with business logic. <br></li><li>  Database. <br></li></ol><br><h3>  Section 2. Model parameters </h3><br>  Parameters are divided into three groups: <br><br><ul><li>  parameters depending on the implemented functionality. </li></ul><br>  They are almost always modified by the architect for a particular sizing.  The key parameters are the coefficients connecting the number of business transactions with the number of incoming http requests.  It also turns on / off typical ‚Äúcubes‚Äù and determines the distribution of request flows between them. <br><br><ul><li>  parameters that <i>may</i> vary for a particular sizing. </li></ul><br>  These are typical performance parameters, suitable for most cases. <br><br><ul><li>  fixed parameters. </li></ul><br>  Typical parameters of iron productivity in our conditions.  For example, we take MQ performance with persistence disabled, since we do not use persistent messages. <br>  <b>Model parameters:</b> <br><br><img src="https://habrastorage.org/web/bf2/6a7/836/bf26a783634d4cdcb2e3e3ecb72f0783.png"><br><br>  <b>Estimated coefficients</b> <br><br>  The table contains a description of the coefficients for which we have developed values.  If interested, ask questions in the comments - share expert assessments. <br><br><img src="https://habrastorage.org/web/fe7/eb0/27e/fe7eb027e68b404ca4126fa70c62d164.png"><br><br><h3>  Section 3. Calculation Model </h3><br>  A calculation model with calculation formulas that displays input data and parameters in the final estimates for each position. <br><br>  We describe a simplified sizing model.  It reduced the set of positions and does not reflect the multiblock organization of the industrial environment.  Simplifications are made in order not to overload the article with aspects that are not interesting if your business does not have Sberbank scales.  Multi-block architecture is a topic for a separate article - we will talk about it in other posts. <br><br>  Application servers and web servers are allocated for each application service.  We do not combine different application services in order to exclude mutual influence on failures or during maintenance.  Databases are common and are considered for financial justification and forecasting. <br><br>  Below are the formulas that we use for the calculation. <br><br><ul><li>  Peak number of requests per second on the internal network: <br></li></ul><br><img src="https://habrastorage.org/web/85d/9d9/b6f/85d9d9b6f3d44dd08ade1d73fa6580d6.png"><br><br>  It is considered as a multiplication of the peak number of users by the number of requests per second. <br><br><ul><li>  Peak number of requests per second on the external network: <br></li></ul><br><img src="https://habrastorage.org/web/f90/a00/d75/f90a00d755d540599c10ab200dfb7c8b.png"><br><br><ul><li>  Calculate the number of web servers. <br></li></ul><br>  This calculation includes the distribution of statics, query routing and caching for the internal network. <br><br>  Number of intranet web servers <br><br><img src="https://habrastorage.org/web/0c6/85d/678/0c685d67806c4bfbb592cd56fe5192b7.png"><br><br><ul><li>  Number of Web servers on the external network <br></li></ul><br><img src="https://habrastorage.org/web/47b/f08/bf2/47bf08bf2ab64051a20fdac359821231.png"><br><br><ul><li>  Mobile External Gateway <br></li></ul><br><img src="https://habrastorage.org/web/46f/2af/c02/46f2afc02b4c4b10ba59cbf2b375eebf.png"><br><ul><li>  Presentation logic in the external network <br></li></ul><br><img src="https://habrastorage.org/web/901/939/7b7/9019397b71424720a439197191c0f7d4.png"><br><br><ul><li>  Presentation logic in the internal network <br></li></ul><br><img src="https://habrastorage.org/web/257/f45/b10/257f45b10113497393d6407ee3314663.png"><br><br><ul><li>  Calculation of application servers for business logic <br></li></ul><br><img src="https://habrastorage.org/web/855/b3e/5f3/855b3e5f3c474f48b917b7533feee20a.png"><br><br><ul><li>  MQ (audit + logging + point-to-point integration) <br></li></ul><br><img src="https://habrastorage.org/web/58e/227/802/58e2278024cd49369a60c1295ffa271f.png"><br><br><ul><li>  Distributed internal cache <br></li></ul><br><img src="https://habrastorage.org/web/d9d/301/209/d9d301209e9b453c933ec068020a9f98.png"><br><br><ul><li>  DBMS Calculation <br></li></ul><br><ul><li>  The number of CPU DB <br></li></ul><br><img src="https://habrastorage.org/web/732/231/a30/732231a30a7245cba3fb8149e59cee29.png"><br><br><ul><li>  RAM DB number <br></li></ul><br><img src="https://habrastorage.org/web/ae9/73b/78d/ae973b78def248048feea0b33653476d.png"><br><ul><li>  DB size <br></li></ul><br><img src="https://habrastorage.org/web/9c9/d26/10b/9c9d2610b4bd46df93b058a8b1cd54b6.png"><br><br>  At the output of the sizing model, we get an estimate of "iron" for the industrial environment. <br>  In world practice, there are three main models of sizing: <br><br><ul><li>  Custom model <br></li></ul><br>  Model based on the analysis of the number of simultaneously working users in the system and their behavior.  This model is focused on companies that have general information about the number of users and their behavior in the information system. <br><br><ul><li>  Transactional model <br></li></ul><br>  Model based on the analysis of transactions, the amount of data in the IP, which accounts for one user or group of users.  This model is focused on companies that have accurate data on the quantitative characteristics of employees in the IS.  This means that the company has an IT infrastructure, the company is at the stage of implementing a system for automating business processes or improving them. <br><br><ul><li>  Test model <br></li></ul><br>  Model based on performance tests.  This model is focused on companies that have a clear plan for the implementation of business applications with a detailed study of the details.  These are mainly companies that have already implemented any system for automating business processes, but wish to expand the functionality of the system.  Or the existing IT infrastructure does not withstand the current load. <br><br>  In the EFS program, we have a combo from the ‚ÄúTransactional Model‚Äù and ‚ÄúTest Model‚Äù.  Since we have information about the amount of peak load of business operations, but also we are guided by the indicators obtained from the conducted load testing.  But there are special cases when new functionality is introduced in the ESF, which was not in other systems, and we receive the expected data at the entrance, then we act by analogy with the ‚ÄúUser Model‚Äù. <br><br>  Let's talk, and what model do you use? </div><p>Source: <a href="https://habr.com/ru/post/337676/">https://habr.com/ru/post/337676/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337666/index.html">How to meet the requirements of the quality management system according to ISO 9001: 2015</a></li>
<li><a href="../337668/index.html">How to use Java with CryptoPro to sign a PDF document</a></li>
<li><a href="../337670/index.html">Interserver WebRTC</a></li>
<li><a href="../337672/index.html">Getting the text of requests from SoapHttpClientProtocol</a></li>
<li><a href="../337674/index.html">Kindergarten, pants with straps: where do programmers come from</a></li>
<li><a href="../337678/index.html">The practice of forming requirements in IT projects from A to Z. Part 6. System behavior. Excellence requirements</a></li>
<li><a href="../337680/index.html">Plugin for HANA Database project in Visual Studio</a></li>
<li><a href="../337682/index.html">Oracle actually eliminates Sun</a></li>
<li><a href="../337688/index.html">Docker Compose advanced configuration (translation)</a></li>
<li><a href="../337690/index.html">Yandex. Blitz. Why and what algorithmic problems need to be able to solve, working in the search</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>