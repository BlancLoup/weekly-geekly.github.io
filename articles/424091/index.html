<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WiX.Py: we assemble MSI package ‚Äúin three lines‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No time and no desire to learn kilometer WiX files to build an MSI installer for your project while plunging into the abysses of MSDN? Want to build t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WiX.Py: we assemble MSI package ‚Äúin three lines‚Äù</h1><div class="post__text post__text-html js-mediator-article"><p>  No time and no desire to learn kilometer WiX files to build an MSI installer for your project while plunging into the abysses of MSDN?  Want to build the installer, describing it in simple and understandable terms, in a few lines?  Is there a clinical propensity for cross-platform and Linux &amp; Docker builds?  Well then to you under kat! </p><a name="habracut"></a><br><h2 id="razrabotchiki-ponevole">  Reluctant developers </h2><br><p>  As a matter of fact, it was with these "Wishlist" that <a href="https://sk1project.net/">our project of a</a> cross-platform vector graphics editor came across a couple of months ago. </p><br><p>  We knew about the WiX Toolset (Windows Installer XML), but even a cursory viewing of tutorials on the official website brought sadness and gloom - without serious immersion in the XML description of the installers is indispensable.  Used more simple MakeMsi, but in it there was a mass of defects.  And again, all these tools were not suitable for building MSI under Linux. </p><br><p>  The search led to <a href="https://wiki.gnome.org/msitools">the wixl project</a> , which compiled MSI on Linux, but suffered a serious flaw in terms of functionality and required the same XML files of monstrous proportions as WiX. </p><br><p>  As a result, in order to acquire the necessary tool for the assembly, we reimplement the wixl logic in python, correcting many shortcomings and adding the necessary functionality, and made the project cross-platform.  This is how WIX.Py appeared - an MSI collector with a very low threshold of entry. </p><br><h2 id="kak-wixpy-rabotaet">  How WiX.Py works </h2><br><p>  The process of creating an MSI package is simplified to the limit: </p><br><ol><li><p> In an arbitrary folder (for example, <code>build</code> ), we create the contents for installation in the form in which it will be on the target computer. </p><br></li><li><p>  Fill in a small JSON file.  For example: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: <span class="hljs-string"><span class="hljs-string">"MyApp"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"UpgradeCode"</span></span>: <span class="hljs-string"><span class="hljs-string">"3AC4B4FF-10C4-4B8F-81AD-BAC3238BF690"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Version"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Manufacturer"</span></span>: <span class="hljs-string"><span class="hljs-string">"My Company"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Description"</span></span>: <span class="hljs-string"><span class="hljs-string">"MyApp 0.1 Installer"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Comments"</span></span>: <span class="hljs-string"><span class="hljs-string">"Licensed under GPLv3+"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Keywords"</span></span>: <span class="hljs-string"><span class="hljs-string">"wxs, xml, build"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Win64"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_CheckX64"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_AppIcon"</span></span>: <span class="hljs-string"><span class="hljs-string">"resources/myapp.ico"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_ProgramMenuFolder"</span></span>: <span class="hljs-string"><span class="hljs-string">"My Company"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_Shortcuts"</span></span>: [ {<span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: <span class="hljs-string"><span class="hljs-string">"MyApp"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Description"</span></span>: <span class="hljs-string"><span class="hljs-string">"MyApplication"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Target"</span></span>: <span class="hljs-string"><span class="hljs-string">"myapp.exe"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"AddOnDesktop"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"OpenWith"</span></span>: [<span class="hljs-string"><span class="hljs-string">".xml"</span></span>, <span class="hljs-string"><span class="hljs-string">".wxs"</span></span>, <span class="hljs-string"><span class="hljs-string">".yml"</span></span>] } ], <span class="hljs-attr"><span class="hljs-attr">"_SourceDir"</span></span>: <span class="hljs-string"><span class="hljs-string">"build/"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_InstallDir"</span></span>: <span class="hljs-string"><span class="hljs-string">"myapp-0.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_OutputName"</span></span>: <span class="hljs-string"><span class="hljs-string">"myapp-0.1_win64.msi"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_OutputDir"</span></span>: <span class="hljs-string"><span class="hljs-string">"./"</span></span> }</code> </pre> <br></li><li><p>  We generate the MSI package with the command: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">wix</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.py</span></span> &lt;_&gt;<span class="hljs-selector-class"><span class="hljs-selector-class">.json</span></span></code> </pre> <br></li></ol><br><p>  Yes, this is a fully working example of the MSI package, which will check before installation that Windows 64bit, install the application in <code>Program Files</code> , add the application to the program menu and to the desktop, and link the specified file formats to the application to be installed.  No magic and shamanism with the register. </p><br><p>  It is possible to further reduce the example to 5-6 lines, but then the installer's functionality will be quite short. </p><br><p>  Using WiX.Py, MSI can be assembled both in Windows and Linux, incl.  in docker containers.  Since the base libmsi can be compiled on many other UNIX systems (for example, macOS), formally WiX.Py can be used on them, it does not carry any practical sense. </p><br><p>  A description of the various nuances can be found in the <a href="https://wix.sk1project.net/docs.php">project documentation</a> . </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  If WiX.Py is right for you to solve problems in creating MSI packages, but you don‚Äôt have any functionality, go to our website <a href="https://wix.sk1project.net/">https://wix.sk1project.net</a> and create a request for expanding the functionality.  The same goes for detected bugs - report and we will deal with them.  In the same place on the site you will find the source code and ready packages for different platforms. </p><br><p>  If there is a desire to compare with WiX, then on Habr√© there were more than once articles on WiX: <a href="https://habr.com/post/68616/">1</a> , <a href="https://habr.com/post/69129/">2</a> , <a href="https://habr.com/post/70616/">3</a> , <a href="https://habr.com/post/253819/">4</a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/424091/">https://habr.com/ru/post/424091/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../424081/index.html">RESS - New architecture for mobile applications</a></li>
<li><a href="../424083/index.html">Service for trading on the stock exchange Robinhood accused of selling data on user requests to high-frequency traders</a></li>
<li><a href="../424085/index.html">We develop the NIOS II processor module for IDA Pro</a></li>
<li><a href="../424087/index.html">The machine on the Arduino, controlled by an Android device via Bluetooth, is a full cycle (part 1)</a></li>
<li><a href="../424089/index.html">Conference for evil. Or good?</a></li>
<li><a href="../424093/index.html">From antique radio to DIY speakers: 12 channels on YouTube about acoustics devices</a></li>
<li><a href="../424095/index.html">By 2024, a cellular network for officials and security officials will appear in the Russian Federation</a></li>
<li><a href="../424099/index.html">Determine the ripeness of watermelon with the help of Keras: a full cycle, from idea to program on Google Play</a></li>
<li><a href="../424103/index.html">Silicon Valley "unforgivable" refers to its employees since the 1970s</a></li>
<li><a href="../424105/index.html">NASA knows how to make Mars green again.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>