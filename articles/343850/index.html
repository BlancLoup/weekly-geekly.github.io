<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>On the results of the MERC-2017 contest: winners and comments</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The first machine learning competition MERC-2017 from the Neurodata Lab , held on its own site Datacombats (we will soon present an updated, full-fled...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>On the results of the MERC-2017 contest: winners and comments</h1><div class="post__text post__text-html js-mediator-article"> The first machine learning competition MERC-2017 from the <a href="http://www.neurodatalab.com/">Neurodata Lab</a> , held on its own site <a href="http://www.datacombats.com/">Datacombats</a> (we will soon present an updated, full-fledged version of the platform), is announced to be closed and closed.  Time to sum up some and comment on the results.  With the visualization of statistics you can find in the <a href="https://habrahabr.ru/company/neurodatalab/blog/342990/">previous post of</a> our blog. <br><img src="https://habrastorage.org/webt/5r/-j/qn/5r-jqnqk9ioegl8b8dnwc_kevu4.png" alt="image"><br><a name="habracut"></a><br>  <b>How did the idea of ‚Äã‚Äãthe competition</b> <br><br>  Our laboratory, due to the nature and specifics of the emotional data we deal with, is engaged in machine learning, or more precisely, in the technology of recognition of emotions in audio and video streams.  This is an area that is not too well studied - on average only two to five specialized articles are published per year, and the accuracy of state-of-the-art approaches is far from acceptable.  And if in the images (photos) of people basic emotions are recognized as a whole not bad, then everything is more complicated with speech.  In addition, there were almost no adequate attempts to use body language and eye movements, although these are very informative sources.  The problem of combining several channels is also not encouraging - nothing is better than naively putting together all the available features (features) or predictions of individual models. <br>  Another problem that is urgent for us is that in real life not all data is available to us.  For example, we cannot see a person‚Äôs face behind the scenes, or there are technical failures in the movements of a person‚Äôs close-up hands: we suppose that the microphone is spoiling, creating serious interference and noise. <br>  Both problems involve a huge number of hypotheses to help solve them.  To test each physically difficult.  That is why we decided to organize a competition and appeal to the collective mind. <br><br>  <b>Task setting and proposed data</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We have our own laboratory-type, labeled emotional dataset - <a href="http://www.neurodatalab.com/projects/RAMAS/">RAMAS</a> .  It consists of about 7 hours of video, in which various pairs of actors play scenes from real life, adhering to the contour of a scenario that allows for a high degree of improvisation and variation in the presentation of the material.  Each study is marked by external annotators (5-6 people min for one episode) on the subject of manifestation of any emotions in it.  Actually, they had to be predicted by the features that we considered for the video. <br><br>  We did not give the participants the video files themselves, in order to avoid a possible situation with the newly done manual markup on their part, therefore we limited ourselves to signs.  Here we faced the first pitfall - it was necessary to explain to people why we considered these features and how.  If in the case of sound, body and eyes, reference can be made to reference articles, which was done, then a different approach was required with the person.  We had two working options.  The first is to highlight 68 key points on the face.  In this case, it is clear what is responsible for what, you can even successfully visualize, and even more so it is easy to explain why this is so, but our internal experiments have shown that a significant amount of information is lost with this approach.  We abandoned it in favor of the following scheme: select faces on all frames in the video, run them through the pre-trained neural network, take the output from the penultimate fully connected layer, and then reduce the dimension using <a href="https://habrahabr.ru/post/304214/">the principal component method</a> .  We covered this and other technical aspects in more detail in the contest <a href="http://www.datacombats.com/challenge/overview/">description</a> . <br><br>  Of course, we wanted to reduce the probability of cheating (brute force, griddle, fitting) to a minimum (but the probability of trees falling to a minimum was not reduced, but more on that below).  To do this, to put it simply, we renamed the feature plates so that the participants did not retrain for specific actors, entered the final decision check on the sample that was not available during the competition and demanded that the model be the same at two stages. <br><br>  <b>Solutions</b> <br><br>  By the end of the first stage, we got about twenty solutions.  This is quite a bit, and among them about half overcame 52.5% accuracy on a public test sample (52.5% is the accuracy of our solution, where we all naively put it into an lstm grid).  At the second stage, we laid out the private part of the test sample. <br>  We asked participants to send us predictions + the model itself + a small report with leading questions about what the model consists of, what was done with features, etc.  The leader in the public part of the sample quickly laid out his decision and maintained his position at the end of the competition.  We opened the received document with the hope of finding out what we did not know ourselves. <br><br>  It turned out that the channels should be combined in the forehead, the gaps in the data should be replaced with the median value, and as a model, use xgboost with a magic number of trees.  Immediately checked on both test samples, everything came together.  In our own experiments, for example, we taught the generative networks to predict gaps in the other channels (it turned out relatively poorly), and the casket just opened.  All the better.  Anyway, work with features and postprocessing was done a lot, but I wanted more in terms of working with gaps and channel linking. <br>  At the second stage of the presented solutions, two were obviously wrong, because the metrics on the public and private tests differed by 0.3.  The rest made us a company for the next week, we dismantled them completely.  It was necessary to analyze the reports, run the scripts and compare the results of the launch on our side with the sent predictions. <br><br>  <b>Decision checking</b> <br><br>  The analysis of the methods was not difficult: the solutions differed from each other by the preprocessing of features, model architectures and some trifles.  Almost all solutions run out of the box exactly as needed.  Curiously, the third and fourth positions are reversed.  In this case, work with signs turned out to be more efficient than optimization of the neural network architecture.  The fourth place winner, apparently, retrained on a public test sample, which resulted in -6% on a private one. <br>  But the juice was to check the second place.  The team‚Äôs decision consisted of an ensemble of 22 heavy LSTM nets.  From the first time, the results could not be repeated, but from about the fifth, the puzzle was formed.  Next time, of course, we will add a limit on the speed of the algorithms. <br><br>  The final rating and prizes were distributed as follows: <br><img src="https://habrastorage.org/webt/6i/sb/xf/6isbxfj5nybwf5qaf5xugzyx0kw.png" alt="image"><br>  It's funny that two completely different approaches for the first and second places differ only in the fourth decimal place.  This, of course, is an accident, not a sign of high competition, but nonetheless. <br>  On the other hand, our expectations about the fight against passes and the association of channels did not materialize.  Participants almost did not pay attention to this problem, optimizing the processing of features and architecture.  And yet this is an invaluable experience that will be taken into account in all the nuances when preparing our next contests. <br><br>  <b>Summary of winning solutions:</b> <br><br>  I place: tEarth <br>  Model: lightXGB <br>  Channel aggregation: feature-level <br>  Processing gaps: replaced by the average. <br>  Features: for each second, medians of signs are calculated, the model is trained on such data + post-processing of predictions + training on very consistent data (aas&gt; = 0.8). <br><br>  II place: 10011000 <br>  Model: ensemble lstm models, trained with different parameters, a total of 22 pieces <br>  Channel aggregation: decision-level <br>  Processing passes: filled 0 <br>  Features: the calculation of predictions takes more than a day for each of the tests (~ 30 times slower than real time). <br><br>  III place: lechatnoir <br>  Model: ordinary lstm <br>  Channel consolidation: eyes and face are combined, some features of the kinekt are rejected, further decision-level <br>  Processing passes: filled 0 <br><br>  <b>Jury members comments</b> <br><br>  <a href="http://www.ifmo.ru/ru/viewperson/495/potapov_aleksey_sergeevich.htm">Alexey Potapov</a> , Doctor of Technical Sciences, Professor at the Department of Computer Photonics and Video Informatics at ITMO: <br>  ‚ÄúFirst, I note that the simplicity of the methods used by the participants (XGBoost, LSTM ensemble) is in fact relative - some time ago they might have seemed quite complicated.  So I would say that these are just modern, well-run methods, the use of which does not require excessive efforts on R &amp; D, for which the participants did not have time in these conditions.  Even at longer competitions this result is quite typical.  In this sense, it is quite natural, although a ‚Äúmiracle‚Äù could have happened in the form of an original model.  It should be emphasized that the result obtained does not mean that the given methods in such a configuration of the problem are really close to optimal (this is also not excluded, although it is doubtful). <br>  As for the approximately equal accuracy of the first two places, this is curious, although the difference in the fourth sign seems to be an accident.  It may be due to the property of the data itself - in principle, no noticeable improvement can be achieved due to the inseparability of classes on the provided features.  But I a priori do not believe in it.  For example, on ImageNet, the best solutions until the successful application of convolutional networks in 2012 were very close, but then the deep networks beat all these solutions by a large margin.  It seems to me that in this problem a similar situation is also possible.  Perhaps, with the help of the same generative models, it will be possible to achieve this (although it is somewhat optimistic to expect such a breakthrough in the month-long competition).  But why such different models still give similar results in quality, I still find it difficult to answer. <br>  What other methods could be used?  It is obvious that other blocks of recurrent networks (GRU, pseudo-recurrent networks, etc.);  convolutional networks again, although, of course, it would be more promising to develop original models. ‚Äù <br><br>  <a href="http://faculty.skoltech.ru/people/pavelprihodko">Pavel Prikhodko</a> , Ph.D., Skolkovo Institute of Science and Technology, IITP RAS: <br>  ‚ÄúThe fact that the leading solutions do not show much retraining is a good sign.  As far as they are generalized - the question is open, you need to try (at least on somehow plagued or modified source data).  Most likely, a gain in accuracy could be obtained if the end-to-end problem is solved with calculating features of a convolutional network from video and using them in LSTM (especially since features were already generated by convolutional grids).  In addition, the marking of emotions, strictly speaking, depends on the expert, each of which may have its own threshold for determining emotions.  There are areas of feature space where different people can hear different emotions.  It seems to me that this is an essential feature of the problem, and it is worth considering a formulation with multiple labels.  First of all, I would consider generative models or other approaches (for example, varying the speaker‚Äôs parameters) as a way to greatly increase the size of the training set and increase the model‚Äôs resilience to data disturbances.  7 hours is still not a big start-up dataset in terms of volume, which means an increase in its size by an order of magnitude can give a noticeable increase in quality. ‚Äù <br><br>  Over the text worked: <br>  Gregory Sterling, a mathematician, an expert in machine learning and data analysis of the <a href="http://www.neurodatalab.com/">Neurodata Lab</a> </div><p>Source: <a href="https://habr.com/ru/post/343850/">https://habr.com/ru/post/343850/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343840/index.html">Renga development team: how we reached the idyll, working without managers</a></li>
<li><a href="../343842/index.html">WD (Western Digital) plans to create a 40 TB disk, but is this enough?</a></li>
<li><a href="../343844/index.html">How programmers with PVS-Studio looked for project errors</a></li>
<li><a href="../343846/index.html">.Net Core bots for Telegram, Slack and Facebook</a></li>
<li><a href="../343848/index.html">Gifts from M.Video: what's under the hood?</a></li>
<li><a href="../343852/index.html">Interfaces in C #</a></li>
<li><a href="../343854/index.html">ASO Monthly # 16: August 2017</a></li>
<li><a href="../343856/index.html">ITSM Digest: 20 materials on optimizing IT processes</a></li>
<li><a href="../343858/index.html">Virtual desktop service overview</a></li>
<li><a href="../343860/index.html">One-stop digital marketing: dismantling SAS cloud products</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>