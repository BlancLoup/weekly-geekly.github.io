<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deep Learning: Combining Deep Convolutional Neural Network with Recurrent Neural Network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We present to you the final article from the Deep Learning cycle, in which the results of the work of teaching the GNSS for images from certain areas ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deep Learning: Combining Deep Convolutional Neural Network with Recurrent Neural Network</h1><div class="post__text post__text-html js-mediator-article">  We present to you the final article from the Deep Learning cycle, in which the results of the work of teaching the GNSS for images from certain areas are reflected on the example of recognition and tagging of clothing items.  You will find the previous parts under the cut. <br><br><img src="https://habrastorage.org/files/1f5/82f/e2d/1f582fe2da224004a93f85733f6df77e.jpg"><br><a name="habracut"></a><br><h2>  The series of articles "Deep Learning" </h2><br>  1. <a href="https://habrahabr.ru/company/microsoft/blog/313318/">Comparison of frameworks for symbolic deep learning</a> . <br>  2. <a href="https://habrahabr.ru/company/microsoft/blog/314934/">Transfer learning and fine tuning of deep convolutional neural networks</a> . <br>  3. A <a href="https://habrahabr.ru/company/microsoft/blog/316456/">combination of a deep convolutional neural network with a recurrent neural network</a> . <br><br>  <i>Note: further narration will be conducted on behalf of the author.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Introduction </h2><br>  If we talk about the role of clothing in society, the recognition of things can have many applications.  For example, the <a href="https://scholar.google.com/citations%3Fview_op%3Dview_citation%26hl%3Den%26user%3DbqV8WoIAAAAJ%26citation_for_view%3DbqV8WoIAAAAJ:Tyk-4Ss8FVUC">work of Liu and other authors</a> on identifying and searching for unmarked items of clothing in images will help identify the most similar elements in an e-commerce database.  <a href="http://www.ece.northwestern.edu/~mya671/mypapers/ICIP11_Yang_Yu.pdf">Young and Yu look</a> at the process of recognizing the elements of clothing from the other side: they believe that this information can be used in the context of video surveillance to identify suspects in crimes. <br><br>  In this article, based on the materials of <a href="http://www.ics.uci.edu/~yyang8/research/cnn-rnn/cnn-rnn-cvpr2016.pdf">Wang</a> and <a href="https://arxiv.org/pdf/1411.4555v2.pdf">Vinyasa</a> , we will create an optimized model for the classification of clothing items, a brief description of the images and the prediction of tags to them. <br><br>  I was inspired by recent improvements in machine translation, the task of which is to translate individual words or sentences.  Now it is possible to translate much faster using recurrent neural networks (PHC), while achieving high speed.  The PHC coder reads the source tag or tag and converts it into a fixed-length vector representation, which, in turn, is used as the initial hidden state of the PHC decoder, which forms the tag or tag.  We propose to follow the same path using the deep convolutional neural network (GNSS) instead of the RNS coder.  In recent years, it has become clear that the GNSS networks can create a sufficient representation of the input image by embedding it in a vector of fixed length that can be used for various tasks.  It is possible to naturally use the GNSS as an image encoder: to do this, you first need to conduct preliminary training on the task of classifying images using the hidden layer as an input to the PHC decoder, which generates tags. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6bf/f72/646/6bff72646fd04f5d8e5b6568cb1bd4de.png"></div><br>  <i>RNS-SNS model for creating clothing image tags</i> <br><br>  In this work, the GoogLeNet model, previously trained in ImageNet, will be used to extract the SNA components from the DR data set.  Then, the functions of the SNA for teaching the PHC model with a long short-term memory for predicting the DR tags. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3f8/a31/27f/3f8a3127ffe947eca584aa21f669f8b7.png"></div><br>  <i>GoogLeNet architecture</i> <br><br><h2>  Data </h2><br>  Use the <a href="http://people.ee.ethz.ch/~lbossard/projects/accv12/index.html">DR data set</a> : full pipeline to recognize and classify people's clothing in vivo.  This solution can be applied in various fields, for example, in e-commerce, in events, in Internet advertising and so on.  The pipeline consists of several stages: recognition of body parts, various channels and visual attributes.  The PD defines 15 classes of clothing and enters a reference set of estimates for its classification, consisting of more than 80,000 images.  We also use the DR data set to predict clothing tags for images that have not previously been analyzed. <br><br>  Images from training and test datasets have completely different indicators: resolution, aspect ratio, colors, and so on.  Neural networks need input data of a fixed size, so we transferred all the images to the format: 3 √ó 224 √ó 224. <br><br>  One of the drawbacks of irregular neural networks is their excessive flexibility: they are equally well trained in recognizing both garment details and interferences, which increase the likelihood of over-fitting.  We apply Tikhonov's regularization (or L2 regularization) to avoid this.  However, even after that, there was a significant performance gap between learning and verifying DR images, indicating an over-fit during the fine-tuning process.  To eliminate this effect, we apply data addition to a set of image data DR. <br><br>  There are many ways to complement data, for example, mirroring horizontally, random cropping, changing colors.  Since the color information of these images is very important, we apply only the rotation of the images to different angles: 0, 90, 180 and 270 degrees. <br><br><img src="https://habrastorage.org/files/bf3/5d6/3c4/bf35d63c4ffb4dc9b5f404033c45148a.png"><br>  Augmented images of DR <br><br><h2>  Tweaking GoogleNet for DR </h2><br>  To deal with the problem of predicting the DR tags, we follow the tweaking script from the <a href="https://habrahabr.ru/company/microsoft/blog/314934/">previous section</a> .  The GoogLeNet model we used was initially trained on the ImageNet dataset.  The ImageNet dataset contains about 1 million natural images and 1000 tags / categories.  Our tagged DR data set contains about 80,000 images belonging to the clothing category, and 15 tags / categories.  The data set of PD is not enough to train such a complex network as GoogLeNet.  Therefore, we use weight data from the GoogLeNet model trained in the ImageNet data set.  We carry out fine-tuning of all levels of a previously trained GoogLeNet model through continuous back propagation. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/db2/d2f/59f/db2d2f59f2fd47c98a165740b4b3a119.png"></div><br>  <i>Replacing the input layer of the pre-trained GoogLeNet network with DR images</i> <br><br><h2>  Learning PH with long-term short-term memory </h2><br>  In this paper, we use the PHC model with long-term short-term memory, which has high performance when performing sequential tasks.  The basis of this model is a memory cell encoding knowledge about the observed input data at each time point.  The behavior of the cell is controlled by valves, in the role of which the layers used multiplicatively are used.  It uses three shutters: <br><br><ul><li>  forget the current value of the cell (forget the shutter f), </li><li>  read the input cell value (enter gate i), </li><li>  output new cell value (output gate o). </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/files/832/af7/b06/832af7b0602c40899e00b95cc80001ca.png"></div><br>  <i>Recurrent neural network with long-term short-term memory</i> <br><br>  The memory block contains a cell "c", controlled by three gates.  Recurrent connections are shown in blue: the output ‚Äúm‚Äù at the moment of time (t ‚Äì 1) is fed back to the memory at the time ‚Äút‚Äù through three shutters;  the cell value is fed back through the ‚Äúforget‚Äù gate;  The predicted word at the time point (t ‚Äì 1) is fed back in addition to the memory output ‚Äúm‚Äù at the time point ‚Äút‚Äù in Softmax to predict the tag. <br><br>  A model with a long short-term memory is trained to predict the main tags for each image.  As an input, the GNSS DR functions (obtained using GoogLeNet) are used.  Then, the model is trained with a long-term short-term memory (LSTM) based on combinations of these functions of GNSS and labels for pre-processed images. <br><br>  A copy of the LSTM memory is created for each LSTM image and for each label in such a way that all LSTM use the same parameters.  The (m) √ó (t ‚àí 1) LSTM output at time (t ‚Äì1) is fed to the LSTM at time (t).  All recurrent connections are converted to proactive connections in the final version.  We have seen that feeding the image at each time step as an additional input yields unsatisfactory results, since the network perceives noise in the images and produces an excessive fit.  Losses are reduced in relation to all parameters of LSTM, the upper level of the convolutional neural network of embedding images and embedding tags. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4d2/261/0ce/4d22610cefda437fbdeb20086073fcf1.png"></div><br>  <i>GNSS-RNS architecture for predicting DR tags</i> <br><br><h2>  results </h2><br>  We use the model described above to predict DR tags.  The accuracy of tag predictions in this model increases rapidly in the first part of the iterations and stabilizes after approximately 20,000 iterations. <br><br>  Each image in the DR data set consists only of unique types of clothing, there are no images that combine different types of clothing.  Despite this, when testing images with several types of clothing, our trained model rather accurately creates tags for these previously untreated test images (accuracy was about 80%). <br><br>  Below is an example of the output of our prediction: on the test image you see a person in a suit and a person in a T-shirt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a1c/209/c9d/a1c209c9dcde4f549a913604e81fc05d.png"></div><br>  <i>Test image not previously analyzed</i> <br><br>  The figure below shows the prediction of GoogLeNet tags using the GoogLeNet model with ImageNet training. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f11/ab2/d86/f11ab2d860c1472f8e3d1f4b338b92b5.png"></div><br>  <i>Predicting GoogLeNet tags for a test image using the GoogLeNet model with ImageNet training</i> <br><br>  As you can see, the prediction for this model is not very accurate, since the test image receives the "Windsor Tie" tag.  The figure below shows the prediction of the DR tags using the RNS-GNSS model described above with long-term short-term memory.  As you can see, the prediction for this model is very accurate, since our test image receives the tags ‚Äúshirt, T-shirt, upper body, suit‚Äù. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d0e/e45/448/d0ee454487964b9ea3d6293ddfb060b0.png"></div><br>  <i>Prediction of GoogLeNet tags for a test image using the RNS-GNSS model with long-term short-term memory</i> <br><br>  Our goal is to develop a model capable of predicting tags of clothing categories for clothing images with high accuracy. <br><br><h2>  Conclusion </h2><br>  In this paper, we compare the accuracy of prediction of the GoogLeNet model tags and the RNS-GNSS model with long-term short-term memory.  The accuracy of the prediction tags of the second model is much higher.  For her training, a relatively small number of training iterations, of the order of 10,000, was used. The accuracy of the predictions of the second model quickly increases with the number of training iterations and stabilizes after approximately 20,000 iterations.  For this work, we used only one GP. <br><br>  Thanks to the fine-tuning, you can apply advanced models of GPSN in new areas.  In addition, the combined model of the GNSS-RNS helps to expand the trained model to solve completely different tasks, such as the formation of tags for images of clothes. <br><br>  I hope this series of publications will help you to train the GNSS for images from certain areas and to reuse already trained models. <br><br>  <i>If you see an inaccuracy of the translation, please let us know in your private messages.</i> </div><p>Source: <a href="https://habr.com/ru/post/316456/">https://habr.com/ru/post/316456/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316440/index.html">Attackers send phishing SMS messages on behalf of Apple</a></li>
<li><a href="../316444/index.html">ee javascript (run ReactOS in browser)</a></li>
<li><a href="../316448/index.html">Learning the gameplay cycle on the example of runners</a></li>
<li><a href="../316450/index.html">Overview of conferences we attended in 2016</a></li>
<li><a href="../316452/index.html">What is Microsoft Office 365 and how can it help the company?</a></li>
<li><a href="../316458/index.html">Queues and locks. Theory and practice</a></li>
<li><a href="../316460/index.html">We write our programming language without moms, dads and bison. Part 0: Theory</a></li>
<li><a href="../316462/index.html">Development for Sailfish OS: Work with D-Bus</a></li>
<li><a href="../316464/index.html">Another method to reduce the volume of SPA applications (webpack)</a></li>
<li><a href="../316466/index.html">Microsoft encourages linux developers to try out Windows 10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>