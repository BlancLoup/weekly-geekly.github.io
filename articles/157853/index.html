<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cackle - Single Sign On</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article we will talk about a single authentication, which can be useful for sites with an existing database of registered users. 

 Single sig...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cackle - Single Sign On</h1><div class="post__text post__text-html js-mediator-article">  In this article we will talk about a single authentication, which can be useful for sites with an existing database of registered users. <br><br>  <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D1%2585%25D0%25BD%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25B8%25D1%258F_%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25B2%25D1%2585%25D0%25BE%25D0%25B4%25D0%25B0">Single sign-on (Single Sign-On)</a> allows existing site users to leave comments through the <a href="http://cackle.me/">Cackle</a> widget on behalf of a user account on the site without the need for authorization in the widget using a social network (OAuth) or an OpenID provider. <br><a name="habracut"></a><br><br><h4>  How does this happen? </h4><br>  To set up a single authorization, the variable mcSSOAuth is added to the widget code, the value of which is the encrypted user data and the secret key of the widget.  In case of successful key verification, the data is saved in the system, and the user is authorized. <br>  The value of a variable must be formed on the server and be equal to: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>&lt;JSON    Base64&gt;&lt;&gt;&lt;MD5  &gt;&lt;&gt;&lt;   &gt; <br></code> <br><br>  JSON user data includes the following attributes: <br><ul><li>  id - unique user ID </li><li>  name - username </li><li>  email (optional) - email address </li><li>  avatar (optional) - link to avatar </li><li>  www (optional) - link to web site </li></ul><br>  MD5 request signature is configured as: <br> <code><a href="http://www.example.org/"></a> <a href=""></a> <code class="php">md5(&lt;JSON    Base64&gt;&lt;   &gt;) <br> <br> <br> Site API Key -       API.         "",   WordPress . <br> <br></code>  <br>   ,  JSON  ,    JSON  {}. <br> <br>   <br>      www.example.org.      Freeman.  ,  Freeman      Cackle   ,   .       ,   Freeman           . <br> <br>     -       Freeman   : <br>   id - 7, email - freeman@example.org, avatar - example.org/freeman.png, Site API Key  - 123456789,   is_user_logged_in()       . <br> <br> function cackle_auth(){ $timestamp = time(); $siteApiKey = 123456789; if (is_user_logged_in()){ $user = array( 'id' =&gt; '7', 'name' =&gt; 'Freeman', 'email' =&gt; 'freeman@example.org', 'avatar' =&gt; 'http://example.org/freeman.png' ); $user_data = base64_encode(json_encode($user)); } else{ $user = '{}'; $user_data = base64_encode($user); } $sign = md5($user_data . $siteApiKey . $timestamp); return "$user_data $sign $timestamp"; }</code> <pre> <code class="hljs php"><code class="php"><a href="http://www.example.org/"></a> <a href=""></a> md5(&lt;JSON    Base64&gt;&lt;   &gt;) <br> <br> <br> Site API Key -       API.         <span class="hljs-string"><span class="hljs-string">""</span></span>,   WordPress . <br> <br>  <br>   ,  JSON  ,    JSON  {}. <br> <br>   <br>      www.example.org.      Freeman.  ,  Freeman      Cackle   ,   .       ,   Freeman           . <br> <br>     -       Freeman   : <br>   id - <span class="hljs-number"><span class="hljs-number">7</span></span>, email - freeman@example.org, avatar - example.org/freeman.png, Site API Key  - <span class="hljs-number"><span class="hljs-number">123456789</span></span>,   is_user_logged_in()       . <br> <br> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cackle_auth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ $timestamp = time(); $siteApiKey = <span class="hljs-number"><span class="hljs-number">123456789</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_user_logged_in()){ $user = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Freeman'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'freeman@example.org'</span></span>, <span class="hljs-string"><span class="hljs-string">'avatar'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'http://example.org/freeman.png'</span></span> ); $user_data = base64_encode(json_encode($user)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ $user = <span class="hljs-string"><span class="hljs-string">'{}'</span></span>; $user_data = base64_encode($user); } $sign = md5($user_data . $siteApiKey . $timestamp); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"$user_data $sign $timestamp"</span></span>; }</code></code> <h5> <code class="hljs php"><a href="http://www.example.org/"></a> <a href=""></a> <code class="php">md5(&lt;JSON    Base64&gt;&lt;   &gt;) <br> <br> <br> Site API Key -       API.         <span class="hljs-string"><span class="hljs-string">""</span></span>,   WordPress . <br> <br></code>  <br>   ,  JSON  ,    JSON  {}. <br> <br>   <br>      www.example.org.      Freeman.  ,  Freeman      Cackle   ,   .       ,   Freeman           . <br> <br>     -       Freeman   : <br>   id - <span class="hljs-number"><span class="hljs-number">7</span></span>, email - freeman@example.org, avatar - example.org/freeman.png, Site API Key  - <span class="hljs-number"><span class="hljs-number">123456789</span></span>,   is_user_logged_in()       . <br> <br> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cackle_auth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ $timestamp = time(); $siteApiKey = <span class="hljs-number"><span class="hljs-number">123456789</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_user_logged_in()){ $user = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Freeman'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'freeman@example.org'</span></span>, <span class="hljs-string"><span class="hljs-string">'avatar'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'http://example.org/freeman.png'</span></span> ); $user_data = base64_encode(json_encode($user)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ $user = <span class="hljs-string"><span class="hljs-string">'{}'</span></span>; $user_data = base64_encode($user); } $sign = md5($user_data . $siteApiKey . $timestamp); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"$user_data $sign $timestamp"</span></span>; }</code> </h5> <code class="hljs php"><a href="http://www.example.org/"></a> <a href=""></a> <code class="php">md5(&lt;JSON    Base64&gt;&lt;   &gt;) <br> <br> <br> Site API Key -       API.         <span class="hljs-string"><span class="hljs-string">""</span></span>,   WordPress . <br> <br></code>  <br>   ,  JSON  ,    JSON  {}. <br> <br>   <br>      www.example.org.      Freeman.  ,  Freeman      Cackle   ,   .       ,   Freeman           . <br> <br>     -       Freeman   : <br>   id - <span class="hljs-number"><span class="hljs-number">7</span></span>, email - freeman@example.org, avatar - example.org/freeman.png, Site API Key  - <span class="hljs-number"><span class="hljs-number">123456789</span></span>,   is_user_logged_in()       . <br> <br> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cackle_auth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ $timestamp = time(); $siteApiKey = <span class="hljs-number"><span class="hljs-number">123456789</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_user_logged_in()){ $user = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Freeman'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'freeman@example.org'</span></span>, <span class="hljs-string"><span class="hljs-string">'avatar'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'http://example.org/freeman.png'</span></span> ); $user_data = base64_encode(json_encode($user)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ $user = <span class="hljs-string"><span class="hljs-string">'{}'</span></span>; $user_data = base64_encode($user); } $sign = md5($user_data . $siteApiKey . $timestamp); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"$user_data $sign $timestamp"</span></span>; }</code> <h4> <code class="hljs php"><a href="http://www.example.org/"></a> <a href=""></a> <code class="php">md5(&lt;JSON    Base64&gt;&lt;   &gt;) <br> <br> <br> Site API Key -       API.         <span class="hljs-string"><span class="hljs-string">""</span></span>,   WordPress . <br> <br></code>  <br>   ,  JSON  ,    JSON  {}. <br> <br>   <br>      www.example.org.      Freeman.  ,  Freeman      Cackle   ,   .       ,   Freeman           . <br> <br>     -       Freeman   : <br>   id - <span class="hljs-number"><span class="hljs-number">7</span></span>, email - freeman@example.org, avatar - example.org/freeman.png, Site API Key  - <span class="hljs-number"><span class="hljs-number">123456789</span></span>,   is_user_logged_in()       . <br> <br> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cackle_auth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ $timestamp = time(); $siteApiKey = <span class="hljs-number"><span class="hljs-number">123456789</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_user_logged_in()){ $user = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Freeman'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'freeman@example.org'</span></span>, <span class="hljs-string"><span class="hljs-string">'avatar'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'http://example.org/freeman.png'</span></span> ); $user_data = base64_encode(json_encode($user)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ $user = <span class="hljs-string"><span class="hljs-string">'{}'</span></span>; $user_data = base64_encode($user); } $sign = md5($user_data . $siteApiKey . $timestamp); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"$user_data $sign $timestamp"</span></span>; }</code> </h4> <code class="hljs php"><a href="http://www.example.org/"></a> <a href=""></a> <code class="php">md5(&lt;JSON    Base64&gt;&lt;   &gt;) <br> <br> <br> Site API Key -       API.         <span class="hljs-string"><span class="hljs-string">""</span></span>,   WordPress . <br> <br></code>  <br>   ,  JSON  ,    JSON  {}. <br> <br>   <br>      www.example.org.      Freeman.  ,  Freeman      Cackle   ,   .       ,   Freeman           . <br> <br>     -       Freeman   : <br>   id - <span class="hljs-number"><span class="hljs-number">7</span></span>, email - freeman@example.org, avatar - example.org/freeman.png, Site API Key  - <span class="hljs-number"><span class="hljs-number">123456789</span></span>,   is_user_logged_in()       . <br> <br> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cackle_auth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ $timestamp = time(); $siteApiKey = <span class="hljs-number"><span class="hljs-number">123456789</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_user_logged_in()){ $user = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Freeman'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'freeman@example.org'</span></span>, <span class="hljs-string"><span class="hljs-string">'avatar'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'http://example.org/freeman.png'</span></span> ); $user_data = base64_encode(json_encode($user)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ $user = <span class="hljs-string"><span class="hljs-string">'{}'</span></span>; $user_data = base64_encode($user); } $sign = md5($user_data . $siteApiKey . $timestamp); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"$user_data $sign $timestamp"</span></span>; }</code> </pre><br>  The cackle_auth function returns the string to be placed in the location of the widget code: <br><pre> <code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mcSSOAuth = <span class="hljs-string"><span class="hljs-string">'&lt;?php echo cackle_auth(); ?&gt;'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   &lt;/script&gt;</span></span></code> </pre><br><br>  Incidentally, in the <a href="http://wordpress.org/extend/plugins/cackle">new version of the plugin for WordPress</a> , a single authorization has already been implemented.  You can turn it on by checking the settings. </div><p>Source: <a href="https://habr.com/ru/post/157853/">https://habr.com/ru/post/157853/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../157833/index.html">Listen to music on your smartphone: review of music players for Android</a></li>
<li><a href="../157843/index.html">Social Commerce: Dedicated to Lazy Customers</a></li>
<li><a href="../157845/index.html">IT in the region. Ulyanovsk. We leave from the twilight</a></li>
<li><a href="../157847/index.html">Let's clean up the mess!</a></li>
<li><a href="../157851/index.html">The impact of the Megaupload case on storing data in the cloud</a></li>
<li><a href="../157855/index.html">Association of accounts on "Freelance"</a></li>
<li><a href="../157857/index.html">How to make Sphinx friends with OpenShift for ThinkingSphinx under Rails</a></li>
<li><a href="../157861/index.html">PBX in 5 minutes</a></li>
<li><a href="../157863/index.html">VGA adapter on FPGA Altera Cyclone III</a></li>
<li><a href="../157867/index.html">Synology¬Æ Announces DiskStation DS713 + Release</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>