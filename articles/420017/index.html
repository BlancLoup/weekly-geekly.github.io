<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The art of picking someone else's passwords</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the cult film of the beginning of the two thousandth ‚ÄúPassword‚Äú Swordfish ‚Äù, a talented hacker needs to pick up a password within one minute. In th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The art of picking someone else's passwords</h1><div class="post__text post__text-html js-mediator-article"><p>  In the cult film of the beginning of the two thousandth ‚ÄúPassword‚Äú Swordfish ‚Äù, a talented hacker needs to pick up a password within one minute.  In this he is helped by a friend who carefully holds a pistol at his temple and a temperamental blonde hiding under the table.  What if there are no such friends nearby, and you need to pick a password?  For example, during penetration testing ... </p><br><img src="https://habrastorage.org/webt/1n/o1/ib/1no1ibtq8-rbfe7tyqsfsc6zubc.png"><br><p>  <em>A small but important warning: if the approach proposed in the article is not used in security testing projects, then your actions can easily fall under Article 272 of the Criminal Code of the Russian Federation (Illegal access to computer information).</em> </p><a name="habracut"></a><br><p>  In order to come up with an effective password selection strategy, an ethical hacker must try to get into the heads of users and administrators. </p><br><h2 id="kakie-zhe-faktory-vliyayut-na-nash-vybor-paroley">  What factors influence our choice of passwords? </h2><br><p>  You can name at least the following three: </p><br><ul><li>  ease of memorization; </li><li>  restrictions on the choice of password imposed by the system; </li><li>  the number of people using this password in their activities. </li></ul><br><p>  <strong>What can users easily remember?</strong> </p><br><p>  Consider the things that are easiest for us to remember: </p><br><p>  1) The, that before eyes. </p><br><p>  Before our eyes most often appear trademarks of monitors, laptops, computer mice and keyboards, the inscription "password:".  It is said that the choice of such a trivial password as ‚Äúpassword‚Äù by the head of the election campaign of Hilary Clinton had a disastrous effect on the results of the American elections. </p><br><p>  2) What is important. </p><br><p>  For a person are important: </p><br><ul><li>  pleasant memories and related dates: for example, wedding date; </li><li>  relationship: the name of the beloved.  Napoleon would choose a cute josephine; </li><li>  Property: car make.  James Bond would not have changed himself and chose aston, and if he had, he would have changed bmw; </li><li>  affection: pet name.  Emil from Lenneberg would perpetuate the name of his little friend: svinushok; </li><li>  dream: vacation in a particular place.  The temperamental girl from the movie would surely choose a wonderful bali; </li><li>  Work: the name of the organization or its type.  The Lehman brothers would make an unequivocal choice - the bank. </li><li>  Hobbies: sports, collecting, music.  Well who doesn't love beatles? </li></ul><br><p>  3) What the fingers remember: </p><br><ul><li>  geometric shape on the keyboard: qwerty; </li><li>  character sequence: 12345678. </li></ul><br><p>  4) What is the system / site: </p><br><ul><li>  system name; </li><li>  words associated with the business process that it automates.  For example, in the summer of 2015, there was a leakage of passwords from users of amateurs going to the left, searching for hot companions and companions through the site Ashley Madison.  Among the passwords often come across options like: 67lolita, 68cougar, love69pussies, lovesex. </li></ul><br><p>  In 2014, there was a big leak of Gmail, Yandex and Mail.ru passwords.  The password lists were analyzed by <a href="https://habr.com/users/varagian/" class="user_link">varagian</a> in the article <a href="https://habrahabr.ru/post/236759/">"Analysis of the lost passwords of Gmail, Yandex and Mail.Ru"</a> and you can see that users choose passwords according to the considered scheme. </p><br><h2 id="kak-ogranicheniya-parolnoy-zaschity-vliyayut-na-vybor-paroley-polzovatelyami">  How do password protection restrictions affect the choice of passwords by users? </h2><br><p>  To protect users in many systems, developers have a password policy mechanism, which, unfortunately (fortunately for ethical hackers), is not always used.  Consider the limitations and how they are performed / treated by creative users. <br>  Typical restrictions on password policy: </p><br><ul><li>  password length (usually at least 8); </li><li>  use of characters in different registers; </li><li>  the use of combinations of letters and numbers; </li><li>  use of special characters; </li><li>  ban on using the previous password. </li></ul><br><p>  To come up with a password longer than 8 characters is not difficult, but to use characters in different registers is already difficult, as you need to remember for which character in its password the upper case was chosen.  The most obvious and likely solution: choose the first or last character. </p><br><p>  If the system forces you to add numbers, then here users are slightly more inventive: </p><br><ul><li>  Add numbers to the beginning or end.  As a rule, from one to 4.  Accordingly, it can be just one digit, as in the common password ‚ÄúPassword1‚Äù, if two, then the user will most likely select a year or age, as in the password ‚Äú68cougar‚Äù from our erotic example.  If there are three digits, then they may simply be the sequence "123".  In case the user wants to add 4 digits, then it will be already a year in full spelling: "Alexander2018". </li><li>  Replace the letters with similar numbers: A = 4, E = 3, I = 1, O = 0. Particularly creative users can fully use <a href="https://ru.wikipedia.org/wiki/Leet">l33t</a> <br>  In the case of the need to use special characters, users usually use one of the most well-known special characters, as can be seen in the following illustration: </li></ul><br><img src="https://habrastorage.org/webt/ss/6w/wi/ss6wwihayw9lxuascl8oqz979oi.png"><br><br>  Nothing is as annoying as a ban on using the old password, and users have learned to bypass this restriction by making minimal changes, for example, increasing the number at the end of their password by 1: it was ‚ÄúAlexander2018‚Äù, it became ‚ÄúAlexander2019‚Äù. <br><p>  Understanding these small tricks of users, it is quite simple for an ethical hacker to narrow down the list of candidate words for a password. </p><br><h2 id="kolichestvo-polzovateley-parolya">  Number of password users </h2><br><p>  If the password will be used by many users, for example, system administrators or students in the classroom, then it is usually specifically made not very difficult (for example, coinciding with the account name), and is often left as it was set by the vendor default. </p><br><h2 id="strategiya-podbora-parolya">  Password selection strategy </h2><br><p>  Having dealt with the nuances of choosing a password by users, we can develop a password guessing strategy during penetration testing. <br>  Fix the initial conditions: </p><br><ul><li>  Perform penetration testing (purely ethical hacking) </li><li>  there are systems with an authentication mechanism for the login-password pair; </li><li>  we want to compromise the maximum number of user accounts in the maximum number of systems; </li><li>  We consider only online password selection (we do not consider hacking hashes). </li></ul><br><h4 id="shag-1-opredelenie-imen-uchetnyh-zapisey-polzovateley">  Step 1. Determine user account names </h4><br><p>  To successfully authorize a single password, as a rule, is not enough, you also need to know the name of the account.  We will figure out how to get it. </p><br><p>  <em>Option 1. Getting a list of accounts using a vulnerability in the system.</em> <br>  For example, a Windows domain controller can be configured to allow an anonymous user to get a list of user accounts. <br>  Anyone can check their domain controller for this opportunity, for example, using the command line utility rpcclient from the <a href="https://scaner-vs.ru/trial/">‚ÄúScanner-VS‚Äù</a> : </p><br><ol><li>  Connect to the domain controller and when prompted to enter the password, just press Enter: <br>  rpcclient -U "" ip_domain_address_address </li><li>  Run the built-in command enumdomusers <br>  rpcclient $&gt; enumdomusers </li></ol><br><p>  <em>Option 2. Formation of the list on the basis of ‚Äúintelligence‚Äù and analysis.</em> </p><br><p>  User names, even in small organizations, are defined by administrators based on some standard.  The most common options are: the first letter of the name + surname: adorofeev, the same, but through the dot a.dorofeev, the full name + surname: alexander.dorofeev.  Also, the names of internal accounts often coincide with the e-mail account. Accordingly, the rule of forming a user name can be determined simply by ‚Äúrunning‚Äù the addresses of employees lit up on the Internet, and a complete list can be generated based on the list of employees that can be obtained from the internal telephone directory, as well as social networks.  In a pinch, you can form combinations of the most common first and last names using the most common rules for forming account names. </p><br><p>  <em>Option 3. The most common accounts and default entries.</em> </p><br><p>  Many systems have default accounts.  At a minimum, this is admin or administrator.  There are a lot of them in some systems, so in Oracle you can find SYSTEM, SYS, ANONYMOUS, CTXSYS, DBSNMP, LBACSYS, MDSYS, OLAPSYS, ORDPLUGINS, ORDSYS, OUTLN, SCOTT, WKSYS, WMSYS, XDB.  Accordingly, it makes sense to look into the manuals of system administrators that you want to test. </p><br><p> Often, there are accounts in the systems that are very easy to calculate, for example, if the company has a training class, then the probability of having a teacher and student accounts is quite high.  And how many systems in which, someone did not create an account test? </p><br><h4 id="shag-2-pervichnyy-podbor-paroley">  Step 2. Primary password selection </h4><br><p>  Understanding which accounts in which systems in the tested IT infrastructure we plan to compromise, we can determine the sequence of systems to attack: </p><br><table><tbody><tr><th>  No </th><th>  System class </th><th>  Accounts </th><th>  Passwords </th></tr><tr><td align="center">  one </td><td>  Domain controller </td><td>  Employee accounts, administrative, typical. </td><td>  The most common. </td></tr><tr><td align="center">  2 </td><td>  Business applications </td><td>  Employee accounts, administrative, typical. </td><td>  The most common. </td></tr><tr><td align="center">  3 </td><td>  DBMS </td><td>  Employee Accounts, Administrative, Sample, Default. </td><td>  The most common, default <br></td></tr><tr><td align="center">  four </td><td>  Special systems and services: backup, ftp, etc. </td><td>  Administrative, default. </td><td>  The most common, default. </td></tr><tr><td align="center">  five </td><td>  Active network equipment </td><td>  Administrative, default. </td><td>  The most common, default. </td></tr></tbody></table><br><p>  If in the systems account locking is turned on after several unsuccessful attempts (as a rule, the number 5 is chosen), and testing time is limited, and we cannot set a timeout between attempts to reset the counter, it makes sense to run through all users checking the following likely passwords: </p><br><ul><li>  qwerty; </li><li>  matching account name; </li><li>  empty. </li></ul><br><h4 id="shag-3-rasshirenie-zony-vliyaniya">  Step 3. Expanding the zone of influence </h4><br><p>  Having picked up passwords for accounts, the first thing an ethical hacker has to do is log in and see what he has access to. <br>  If access is received to the file system, then the following files should be searched: </p><br><ul><li>  configuration files that may contain information about IP addresses and accounts; </li><li>  backup systems, OS images for ‚Äúrolling in‚Äù on new machines.  Often, password hashes can be extracted; </li><li>  SQL scripts that also often contain useful information. <br>  Selected passwords and accounts for one system need to be checked for others as well, since users, including administrators, like to use the same passwords in different systems. </li></ul><br><p>  An ethical hacker to note: in large organizations often there are environments for testing that use data recovered from a not very old backup copy of a combat system database.  At the same time, test environments are usually poorly protected, for example, there may be several administrative administrator accounts and simple passwords.  Compromising such a system results in testing specialists gaining access to user password hashes, which are often relevant to the combat system. </p><br><h2 id="instrumenty-i-slovari-dlya-onlayn-podbora-paroley">  Tools and dictionaries for online password recovery </h2><br><p>  The <a href="https://github.com/vanhauser-thc/thc-hydra">thc-hydra</a> command line utility is a classic tool for online password <a href="https://github.com/vanhauser-thc/thc-hydra">guessing</a> , and for ethical hackers and administrators who love comfort, this functionality with an intuitive interface is available in our <a href="https://scaner-vs.ru/trial/">Scanner-VS complex</a> : </p><br><p><img src="https://habrastorage.org/webt/eq/bl/-w/eqbl-wvwuqg13wdddlpp_ngol0y.png"><br><br><img src="https://habrastorage.org/webt/ia/wb/uu/iawbuusderrl_t0n5lyxwq06f2s.png"><br></p><br><p>  Also, a key factor in the successful selection of a password is the availability of well-composed dictionaries, but with this there are problems.  Dictionaries supplied with modern domestic security analysis tools do not always contain really useful sets of words.  For example, include a standard dictionary distributed with one free utility.  The solution, of course, is simple, but not very effective.  Is it possible to imagine a Russian user who chose passwords such as: soccer, cutiepie, maganda or mustang.  How many on average Russian city of lucky owners of a Ford Mustang?  Sometimes they include a great dictionary, based mostly on passwords left by default, but they completely forget about regular users and their favorite passwords. </p><br><p>  We decided to correct this annoying situation and compiled our password lists, which are now available not only to users of our Scanner-VS security testing suite, but also to everyone on the website of our solution in the <a href="https://scaner-vs.ru/trial/">Passwords section</a> : </p><br><p>  Password Lists: </p><br><ol><li>  <a href="">TOP-157</a> </li><li>  <a href="">TOP-25</a> </li><li>  <a href="">Numeric sequences</a> </li><li>  <a href="">Dates</a> </li><li>  <a href="">Keyboard sequences</a> </li><li>  <a href="">Common Male Names</a> </li><li>  <a href="">Common female names</a> </li></ol><br><p>  Account Lists: </p><br><ol><li>  <a href="">Custom mens: first letter of the name + surname</a> </li><li>  <a href="">Custom masculine: first letter of name + dot + last name</a> </li><li>  <a href="">Custom men: name + dot + last name</a> </li><li>  <a href="">Custom women: the first letter of the name + surname</a> </li><li>  <a href="">Custom women: first letter of name + dot + last name</a> </li><li>  <a href="">Custom women: name + dot + last name</a> </li></ol><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Hacker from the movie "Password" Swordfish "was lucky and, despite the distractions and the chaotic style of work, he was able to pick up a password and stay alive.  Using a structured approach, ethical hackers increase their chances of success in penetration testing and rely less on luck.  This approach will work until passwords are chosen by people. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/420017/">https://habr.com/ru/post/420017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420007/index.html">FidgetPen, strange lamp and splitter cubes: getting to know Allocacoc</a></li>
<li><a href="../420009/index.html">Subtleties of product design</a></li>
<li><a href="../420011/index.html">How to choose a 3D printer: a guide for beginners</a></li>
<li><a href="../420013/index.html">Search by MAC address on Juniper switches</a></li>
<li><a href="../420015/index.html">How to measure the speed of the Internet channel and stop looking like a fool in the eyes of your provider</a></li>
<li><a href="../420019/index.html">Client-server interaction in a new mobile PvP-shooter and game server device: problems and solutions</a></li>
<li><a href="../420021/index.html">Why do you need Splunk? IoT and industrial data</a></li>
<li><a href="../420023/index.html">State saving in android applications</a></li>
<li><a href="../420025/index.html">Smart farm. What will it be?</a></li>
<li><a href="../420029/index.html">As we in 1C: Enterprise, we solve systems of algebraic equations</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>