<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IncrediBuild to check a large project with PVS-Studio</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PVS-Studio is a static analyzer that detects errors in the source code of C / C ++ applications. Like the compiler, the analyzer traverses the file be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IncrediBuild to check a large project with PVS-Studio</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8e/85e/e14/a8e85ee14853c3c5fe2dc1cf51c46266.png"></div><br>  PVS-Studio is a static analyzer that detects errors in the source code of C / C ++ applications.  Like the compiler, the analyzer traverses the file behind the file in the directory with the project sources, performing its task.  But without the use of external tools, the assembly of some projects may take several hours.  Static analysis of such a project will take even more time.  To build large projects, some developers have resorted to using a distributed assembly using the IncrediBuild tool.  This article will not discuss the details of the integration of PVS-Studio into IncrediBuild, but will be told about checking a large project, measuring time and other interesting facts. <br><a name="habracut"></a><br><h2>  About PVS-Studio and IncrediBuild tools </h2><br>  <a href="http://www.viva64.com/ru/pvs-studio/">PVS-Studio</a> performs analysis of C / C ++ code and prompts the programmer where possible errors are located, or points to areas of code that may cause problems in the future. <br><br>  The analyzer consists of several parts, and the PVS-Studio.exe process (the core of the analyzer) performs the verification of each source file.  Further, I will use the term ‚Äústream‚Äù, meaning that one process PVS-Studio.exe is launched in one thread to check one source project file.  And there will be a lot of files ... <br><br>  <a href="https://www.incredibuild.com/">IncrediBuild</a> is a distributed computing software that makes it easy to use multiple computers and speed up your applications.  You do not need to worry about the dependencies that are present in parallelized processes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We will use IncrediBuild to perform project analysis in multiple threads using additional computers. <br><br><h2>  About the checked project </h2><br>  The project under review wished to be unnamed, but it has about 7 million lines of source code.  The size of the code base is 300 MB, and about 9000 files.  Verification of this project with the PVS-Studio analyzer on a computer with an Intel Core i7-4770 3.40 GHz processor and 16 GB of RAM in 8 threads takes about 6 hours.  Then I will tell you how with the help of the IncrediBuild tool and several computers it was possible to greatly accelerate the time of project analysis. <br><br><h2>  results </h2><br>  In all tests, computers of approximately one configuration were used, allowing analysis to be performed in 8 threads on each of them. <br><br>  When you configure IncrediBuild on computers, one of them is configured as a coordinator, the rest are configured as agents that connect to the coordinator.  Since  The project check was started on the agent, then on this computer in the settings it was set to load only 1 stream, so that the excessive load did not interfere with the collection of results.  For the coordinator, it was also set to perform calculations only in 1 thread. <br><br><h3>  First test </h3><br>  For the first test launch of PVS-Studio, 5 computers were available: <ul><li>  Coordinator (1 thread); </li><li>  Agent N1 (1 thread, it launched an analysis); </li><li>  Agent N2 (8 threads); </li><li>  Agent N3 (8 threads); </li><li>  Agent N4 (8 threads). </li></ul>  Total 1 + 1 + 8 + 8 + 8 = 26 streams for parallel launch of the analyzer for 26 files simultaneously. <br><br>  Figure 1 shows the verification of the project by the analyzer in 26 streams. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/02c/d98/4dd/02cd984ddc5117bb9718d8495b7fa784.png"></a> <br><br>  <font color="#999999"><i>Figure 1 - Verification of the project by the analyzer in 26 threads</i></font> <br><br>  For readers who are not familiar with IncrediBuild, I will explain that the green bar indicates 1 process that has successfully worked on a computer with the name that is written on the left.  The strip is the name of the process.  And on the timeline below you can determine at what point in time the process started and ended, thus the duration of any distributed process is immediately visible. <br><br>  The image above captures the scan of rather large source files.  Parallelization is performed very evenly and efficiently when loading streams for a long time. <br><br>  Figure 2 shows an analysis of source code files of different sizes. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/5e6/165/270/5e6165270e7c1afee4faf961516eba71.png"></a> <br><br>  <font color="#999999"><i>Figure 2 - Checking small and large project files in 26 streams</i></font> <br><br>  As we see, the rapid termination of threads leads to the overhead of creating new threads and there is a slight idleness of some computers.  But in general, the parallelization is very good.  The project analysis was completed in 2 hours and 10 minutes instead of 6 hours, very well. <br><br><h3>  Second test </h3><br>  For the second test run of PVS-Studio, 7 computers were available: <ul><li>  Coordinator (1 thread); </li><li>  Agent N1 (2 threads, the analysis was launched on it); </li><li>  Agent N2 (8 threads); </li><li>  Agent N3 (8 threads); </li><li>  Agent N4 (8 threads); </li><li>  Agent N5 (8 threads); </li><li>  Agent N6 (8 threads). </li></ul>  Total 1 + 2 + 8 + 8 + 8 + 8 + 8 = 43 threads for parallel launch of the analyzer for 43 files simultaneously. <br><br>  Figure 3 shows the verification of the project by the analyzer in 43 threads. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/f6a/ff6/bc8/f6aff6bc88e5a94f180d3571ebb0fd35.png"></a> <br><br>  <font color="#999999"><i>Figure 3 - Verification of the project by the analyzer in 43 threads.</i></font> <br><br>  The list of 43 threads cannot be seen in its entirety, but it is clearly seen how the idleness of computers increased when checking small files.  But it still looks very cool, considering that the total analysis time was already 1 hour and 24 minutes instead of 6 hours, and the only effort was to install IncrediBuild on the right computers.  To configure PVS-Studio, it was necessary to change only 1 item in the settings - set the number of threads. <br><br><h2>  Conclusion </h2><br>  Using the IncrediBuild tool, which is usually present for assembling very large projects, we were able to speed up the project analysis time using PVS-Studio 4.2 times, using several development computers that were sitting nearby.  All IncrediBuild settings were used by default, and there are quite a lot of them.  Surely you can achieve even greater performance, but we were interested in a ‚Äúquick start‚Äù. <br><br>  <b>Once again, it took us to quickly check the project with PVS-Studio:</b> <ol><li>  Install IncrediBuild on the right computers. </li><li>  Increase the number of threads in the settings of PVS-Studio. </li><li>  Run the analysis from the IncrediBuild console. </li></ol>  <b>Results:</b> <ol><li>  Check on 1 computer - 6 hours. </li><li>  Check in 26 threads - 2 hours 10 minutes. </li><li>  Check in 43 threads - 1 hour 24 minutes. </li></ol><br>  You can read about how to use PVS-Studio and IncrediBuild in your project in the article: " <a href="http://habrahabr.ru/company/pvs-studio/blog/263369/">Integration of PVS-Studio with the IncrediBuild distributed assembly system</a> ". <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35e/064/ddf/35e064ddf91f5d99b620384893909ff7.png"></div><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Svyatoslav Razmyslov.  <a href="http://www.viva64.com/en/b/0339/">Using IncrediBuild to Assist Analysis of a Large Project by PVS-Studio</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="http://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/263449/">https://habr.com/ru/post/263449/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263435/index.html">OData REST API - minor tricks (part 3)</a></li>
<li><a href="../263441/index.html">Print service support in ReactOS - very soon</a></li>
<li><a href="../263443/index.html">Internet Explorer 11 Bookmarklets: Storage Format, Limits and Silent Rules, Treacherous Bug</a></li>
<li><a href="../263445/index.html">TIS-100 - a puzzle about a multithreaded assembler that no one expected</a></li>
<li><a href="../263447/index.html">Nested Intervals and their implementation under Yii2</a></li>
<li><a href="../263451/index.html">Survey: What data to open the tax office?</a></li>
<li><a href="../263453/index.html">Creating a game on Blend4Web. Scene and surroundings</a></li>
<li><a href="../263455/index.html">Emoticons for API Vkontakte</a></li>
<li><a href="../263457/index.html">R and Python - worthy rivals?</a></li>
<li><a href="../263459/index.html">Personal data: how realistic is it to get tested by Roskomnadzor?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>