<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Design patterns for Android development. Part 1 - Introduction</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Writing programs for smartphones is my hobby. It all started with the fact that I bought my first smartphone Nokia E51 on Symbian and I really liked t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Design patterns for Android development. Part 1 - Introduction</h1><div class="post__text post__text-html js-mediator-article">  Writing programs for smartphones is my hobby.  It all started with the fact that I bought my first smartphone Nokia E51 on Symbian and I really liked that its functionality could be expanded through the installation of additional programs. <br>  But once I did not find the necessary program and decided to write it myself.  So began my passion for programs for smartphones. <br><br>  After the head of Nokia said that the days of Symbian are numbered, I decided to explore the Android platform. <br><br>  For better learning, I decided to write a useful program, at least for myself.  But to write it is not childish, when pieces of primitive code are copied from the documentation, but on an adult with the development of architecture, and the use of modern programming technologies TDD, MVP and IoC. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Formulation of the problem </h4><br>  My first Android app is T-Alarm.  You can find it on the Android Market by name.  At the moment, there is no design in the program and it looks a bit awkward, but soon the design will appear. <br><br>  This is just an alarm program, but with one function that is not found in other programs. <br><br>  I usually get up at 6:45 am, but a couple of times a week I have to get up at another time, for example, for a morning run.  To do this, you need to change the time in the alarm clock for tomorrow, and also do not forget to return the schedule to the original one later.  All other alarms on Android do not allow you to quickly change the time for tomorrow, for this you need to go a long way through the settings, and neither of them returns the time to its original state after triggered by the changed one. <br>  Therefore, I decided that the main feature of my program will be the possibility of a one-time change of the next trigger time, as well as the general principle that to make changes to the schedule, you should spend as little time as possible wandering around the settings. <br><br>  Moreover, the alarm clock is an excellent task to learn more about the Andorid platform.  Here are affected such parts as: <br>  - User interface.  It is necessary to make several windows for setting. <br>  - play music files.  You can explore the capabilities of the built-in media player. <br>  - Save the schedule in the database.  Now I know how to use SQLIte database on Android. <br>  - The implementation of services to work out the alarm.  At the onset of the hour X, it is necessary to program the next moment of operation, taking into account several dozes (snooze), and play a wake-up call.  A great reason to figure out what services are in Android and which one should be used. <br>  - Receiving various signals from the OS.  The alarm service should be triggered by the system alarm and when the smartphone is loaded. <br><br>  With this article I open a number of articles where I want to share my development experience.  And I want to focus on using MVP and TDD when developing my application.  On the Internet, I found all this piece by piece and was able to put it all together.  This allowed me to make an application in which all the basic algorithms were tested using UnitTest, as well as I provided several other goodies that would be of interest to Andorid developers. <br><br><h4>  General project architecture and applications </h4><br>  From the very beginning, I wanted to figure out how to use modern approaches and design patterns when developing applications for Android, and therefore it took me a lot of time to study various frameworks.  It seems that the Android SDK already has JUnit built in for organizing tests and there are many articles on the Internet on how to use it, but how it comes to a real project is the pitfalls immediately appear.  I will talk about how to overcome them in this series of articles. <br><br>  So, I decided to use TDD in order to be sure that all the basic algorithms of my application have been tested.  So I settled on the MVP pattern when designing the user interface. <br><br><h4>  Project organization </h4><br>  My sources are divided into two projects - the main project with sources and a test project with tests. <br><br>  The source project consists of several packages.  As a rule, one package is one architectural link, that is, one form or service. <br><br>  Each link consists of a presenter (Presenter), a view (View) and, at times, of auxiliary classes, as a rule, for organizing several streams.  I want to note that the presentation is not always the user interface, sometimes these are classes for working with system services, but in order to be able to simulate these system services, I carried them out to View, which has an interface, and this interface is easy to simulate in tests. <br><br>  The project with tests is also divided into packages.  Each package contains several tests for the corresponding application link. <br><br><h4>  Application architecture </h4><br>  Since my application is small, there are no layers in it, but there are only a few links: <br><br>  1. Main window <br>  2. Edit alarm window <br>  3. Ringtone selection window <br>  4. Window when calling <br>  5. The data model, in my case, is a list of alarms, and a repository for saving the model in the database. <br>  6. Service for processing system messages: the onset of hour X and the loading of a smartphone. <br><br>  All windows and service work only with the model, which is obtained from the repository.  This results in an architecture consisting of loosely coupled links.  Each link can be tested separately from others by simulating a model. <br><br>  Also, the model itself contains the complex logic of calculating the next alarm clock, but the model is also easily tested, since it does not depend on other links. <br><br>  In this architecture, only views remain untested.  But the code in them is usually extremely simple.  This is just a mapping of method parameters to form controls.  As a rule, this code is tested using the ‚Äúgaze‚Äù method.  And errors are easily detected when you see that some kind of control is not filled in the form. <br><br>  In the following articles, I will focus more on the features of the implementation of individual links, as well as tell you what tools that facilitate the life of the developer, I also used. <br><br><h4>  Read in other articles. </h4><br>  - Introduction <br>  - <a href="http://habrahabr.ru/blogs/android_development/131446/">MVP and Unit tests.</a>  <a href="http://habrahabr.ru/blogs/android_development/131446/">Jedi Way</a> <br>  - <a href="http://habrahabr.ru/blogs/android_development/131652/">User Interface, Testing, AndroidMock</a> <br>  - <a href="http://habrahabr.ru/blogs/android_development/132646/">Saving data.</a>  <a href="http://habrahabr.ru/blogs/android_development/132646/">Domain Model, Repository, Singleton and BDD</a> <br>  - Server side implementation, RoboGuice, testing <br>  - Small tasks, settings, logging, ProGuard </div><p>Source: <a href="https://habr.com/ru/post/131369/">https://habr.com/ru/post/131369/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../131361/index.html">"Oh brave new world" or dreams of EDS-future</a></li>
<li><a href="../131363/index.html">Announcement of the creation of the jQuer Standard Group</a></li>
<li><a href="../131364/index.html">Microsoft for Mac</a></li>
<li><a href="../131366/index.html">The history of Losharik</a></li>
<li><a href="../131367/index.html">Electronic signature of an individual (part 1)</a></li>
<li><a href="../131370/index.html">Who is stronger - a whale or an elephant?</a></li>
<li><a href="../131371/index.html">Productivity Future Vision (2011)</a></li>
<li><a href="../131372/index.html">How to use C ++ AMP from C #</a></li>
<li><a href="../131374/index.html">Acer Iconia Tab A100 - video review of the first 7-ki on Honeycomb</a></li>
<li><a href="../131376/index.html">Presentation of Samsung Galaxy Nexus and Android 4.0 (Russian translation)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>