<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The malicious program Retefe is used to compromise online banking users.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A malicious program called Retefe specializes in compromising users of various banks, including Tesco Bank. Customers of this bank have recently been ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The malicious program Retefe is used to compromise online banking users.</h1><div class="post__text post__text-html js-mediator-article">  A malicious program called Retefe specializes in compromising users of various banks, including Tesco Bank.  Customers of this bank have recently been subjected to massive account compromise.  Retefe is used by cybercriminals to steal online banking data, which can then be used to perform fraudulent transactions. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/612/ac6/94b/612ac694bd76485dad8bbc1ea6c11e82.jpeg"></div><br>  According to the <a href="http://www.bbc.com/news/business-37907441">BBC</a> news portal, over the weekend there were about 40 thousand suspicious banking transactions, and half of them accounted for the illegal withdrawal of funds.  Later, representatives of Tesco Bank <a href="http://corporate.tescobank.com/25/news/news-releases/tesco-bank-announces-full-service-has-resumed-for-customers/%3Fnewsid%3D291">confirmed</a> that as a result of the compromise, about 9 thousand bank customers suffered. <br><a name="habracut"></a><br>  Security experts Tesco Bank decided to temporarily block the possibility of conducting transactions using online banking.  At the same time, such functions of the bank‚Äôs clients as cash withdrawals, payments using the card chip and its PIN code, as well as other operations related to the payment of bills remained active. <br><br>  Analysis of malware instances by ESET analysts shows that it is aimed at compromising banks from a rather long list of different countries of the world.  Note that the malicious campaign began, at least as early as February 2016. Please note that the Retefe malware has been actively used by attackers before this campaign, but the attackers used other methods to spread it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the case of an attempt to connect a user to an online banking system from a malware list on a compromised system, Retefe modifies the webpage of the online banking site and tries to steal confidential login data. <br><br>  The initial malware infection occurs through a file that is written in JavaScript and is detected by ESET antivirus products as <b>JS / Retefe</b> .  The attackers chose the attachment method of e-mail messages as a mechanism for its distribution, disguising it as an invoice, order notification, etc. After launch, it installs several of its components into the system, including the Tor anonymous network service.  These malicious components are used to configure a proxy server when working with banking websites. <br><br>  When a user attempts to access an online banking site, he is secretly redirected to a fake copy of this website.  Retefe also adds to the system a fake root digital certificate that is disguised as legitimate.  For disguise, fake information is used that the certificate was issued and confirmed by a well-known Comodo certification authority.  This technique greatly complicates the detection of malicious activity by the user.  It is obvious that this problem has nothing to do with the security of a particular bank. <br><br><img src="https://habrastorage.org/files/5b9/5f8/118/5b95f81184ad484194889c8d11c5dce4.png"><br><br>  Malware code can successfully compromise all major web browsers, including Internet Explorer, Mozilla Firefox and Google Chrome.  In some cases, Retefe tried to convince the user to install a mobile component that is detected by ESET antivirus products like <b>Android / Spy.Banker.EZ</b> .  This mobile component is used to bypass two-factor 2FA authentication.  Below are screenshots of this mobile component. <br><br><img src="https://habrastorage.org/files/161/d1b/e7d/161d1be7dc3147f79b7495fbb15058e6.png"><br><br><img src="https://habrastorage.org/files/365/d40/862/365d40862fd141bd8922a98bc747e14e.png"><br><br><img src="https://habrastorage.org/files/e19/64e/d6a/e1964ed6aca4457fbc58e20e939a15c5.png"><br><br>  ESET analysts have also analyzed another variant of the malware, which is detected as <b>JS / Retefe.B</b> .  This modification uses a rather cumbersome method of accessing the Tor anonymous network.  It consists not in using the Tor network directly, but through the Tor2Web service. <br><br>  Retefe was under the lens of antivirus researchers earlier, when at the beginning of this year the malware was actively used to compromise UK banks.  Since then, the authors have added a mobile component to it, and also expanded the list of goals. <br><br><h3>  Checking the system for infection </h3><br>  Users of online banking services that are listed below are recommended to manually check for the following indicators of compromise by malware, or use the <a href="https://www.eset.com/int/retefe-malware-checker/">following</a> ESET web page for verification. <br><br>  One indicator of compromise is the presence of a fake root digital certificate that was allegedly issued by a Comodo certification authority.  In this case, the e-mail address of the issuing organization corresponds to the address me@myhost.mydomain. <br><br>  For the Mozilla Firefox web browser, open <a href="https://support.mozilla.org/en-US/questions/999481">the certificate manager</a> . <br><br><img src="https://habrastorage.org/files/440/c8e/059/440c8e059e68476ca5584abd7b26af2e.png"><br><br>  For other web browsers, the presence of the certificate can be checked using the Microsoft Management Console (MMC). <br><br><img src="https://habrastorage.org/files/100/9cc/fc1/1009ccfc18f24aa4aff4de62b434e099.png"><br><br>  We observed two such fake certificates, information about which is presented below. <br><br><blockquote>  Serial number: 00: A6: 1D: 63: 2C: 58: CE: AD: C2 <br>  Valid from: Tuesday, July 05, 2016 <br>  Expires: Friday, July 03, 2026 <br>  Issuer: me@myhost.mydomain, COMODO Certification Authority </blockquote><br><blockquote>  Serial number: 00: 97: 65: C4: BF: E0: AB: 55: 68 <br>  Valid from: Monday, February 15, 2016 <br>  Expires: Thursday, February 12, 2026 <br>  Issuer: me@myhost.mydomain, COMODO Certification Authority </blockquote><br>  Another indicator of compromise is the presence in the system of a malicious script <a href="https://blogs.msdn.microsoft.com/ieinternals/2013/10/11/understanding-web-proxy-configuration/">Proxy Automatic Configuration (PAC)</a> , which points to the next .onion domain. <br><br><blockquote>  hxxp: //%onionDomain%/%random%.js? ip =% publicIP% </blockquote><br>  In this case, the% onionDomain% variable is an onion domain, arbitrarily selected from the configuration file.  The variable% random% is a string of eight characters from the alphabet A-Za-z0-9.  % publicIP% indicates a public address.  An example of such a link is presented below. <br><br><blockquote>  hxxp: //e4loi7gufljhzfo4.onion.link/xvsP2YiD.js? ip = 100.10.10.100 </blockquote><br><div style="text-align:center;"><img src="https://habrastorage.org/files/aeb/948/01b/aeb94801b2264107a24aaa5388369eb9.png"></div><br>  Indicator of compromise is also the presence on the device running Android malware <b>Android / Spy.Banker.EZ</b> . <br><br>  In the event that a Retefe malware infects a system, the following steps must be taken to eliminate this infection. <br><br>  <b>1.</b> If you used one of the online banking systems that the malware was aimed at compromising, change your password to access the online banking account, and also check for the presence of illegitimate transactions with your bank account. <br><br>  <b>2.</b> Remove the <a href="https://blogs.msdn.microsoft.com/ieinternals/2013/10/11/understanding-web-proxy-configuration/">Proxy Automatic Configuration (PAC)</a> script from the system. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/09b/076/058/09b076058a264da4be8cc3b420080012.png"></div><br>  <b>3.</b> Remove the above-mentioned digital certificate from the system. <br><br>  <b>4.</b> As a proactive protection, use a reliable <a href="https://www.eset.com/int/home/internet-security/">security tool</a> with the function of ensuring the security of online banking operations. <br><br>  Below is a list of online banking websites that Retefe aims to compromise. <br><br><blockquote>  * .facebook.com <br>  * .bankaustria.at <br>  * .bawag.com <br>  * .bawagpsk.com <br>  * .bekb.ch <br>  * .bkb.ch <br>  * .clientis.ch <br>  * .credit-suisse.com <br>  * .easybank.at <br>  * .eek.ch <br>  * .gmx.at <br>  * .gmx.ch <br>  * .gmx.com <br>  * .gmx.de <br>  * .gmx.net <br>  * .if.com <br>  * .lukb.ch <br>  * .onba.ch <br>  * .paypal.com <br>  * .raiffeisen.at <br>  * .raiffeisen.ch <br>  * .static-ubs.com <br>  * .ubs.com <br>  * .ukb.ch <br>  * .urkb.ch <br>  * .zkb.ch <br>  * abs.ch <br>  * baloise.ch <br>  * barclays.co.uk <br>  * bcf.ch <br>  * bcj.ch <br>  * bcn.ch <br>  * bcv.ch <br>  * bcvs.ch <br>  * blkb.ch <br>  * business.hsbc.co.uk <br>  * cahoot.com <br>  * cash.ch <br>  * cic.ch <br>  * co-operativebank.co.uk <br>  * glkb.ch <br>  * halifax-online.co.uk <br>  * halifax.co.uk <br>  * juliusbaer.com <br>  * lloydsbank.co.uk <br>  * lloydstsb.com <br>  * natwest.com <br>  * nkb.ch <br>  * nwolb.com <br>  * oberbank.at <br>  * owkb.ch <br>  * postfinance.ch <br>  * rbsdigital.com <br>  * sainsburysbank.co.uk <br>  * santander.co.uk <br>  * shkb.ch <br>  * smile.co.uk <br>  * szkb.ch <br>  * tescobank.com <br>  * ulsterbankanytimebanking.co.uk <br>  * valiant.ch <br>  * wir.ch <br>  * zuercherlandbank.ch <br>  accounts.google.com <br>  clientis.ch <br>  cs.directnet.com <br>  e-banking.gkb.ch <br>  eb.akb.ch <br>  ebanking.raiffeisen.ch <br>  hsbc.co.uk <br>  login.live.com <br>  login.yahoo.com <br>  mail.google.com <br>  netbanking.bcge.ch <br>  onlinebusiness.lloydsbank.co.uk <br>  tb.raiffeisendirect.ch <br>  uko.ukking.co.uk <br>  urkb.ch <br>  wwx.banking.co.at <br>  wwx.hsbc.co.uk <br>  wwx.oberbank-banking.at <br>  wwwsec.ebanking.zugerkb.ch </blockquote></div><p>Source: <a href="https://habr.com/ru/post/315100/">https://habr.com/ru/post/315100/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315078/index.html">"Browser War" Google Chrome continues - news from the fields</a></li>
<li><a href="../315080/index.html">Lectures Tehnotreka. Basics of web development (spring 2016)</a></li>
<li><a href="../315084/index.html">Console in the robot on Arduin</a></li>
<li><a href="../315086/index.html">Installing PROXMOX 4.3 on Soft-RAID 10 GPT</a></li>
<li><a href="../315098/index.html">Nginx build: CentOS 6.8, documents and rake</a></li>
<li><a href="../315102/index.html">Setting up a FullMesh network on Mikrotik via EoIP tunnels</a></li>
<li><a href="../315106/index.html">From zero to one. How I went from freelance to chief designer for the year</a></li>
<li><a href="../315108/index.html">Representing SAP R / 3 data in Oracle Database using the SAP Java Connector</a></li>
<li><a href="../315110/index.html">About my LIR2032 and CR2032 tester, the batteries themselves and accumulated experience</a></li>
<li><a href="../315112/index.html">Is it easy to teach people how to make websites?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>