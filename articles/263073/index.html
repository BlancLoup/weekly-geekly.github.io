<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Steal for 9 characters</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I will tell you a story about a vulnerability that has existed in the same Internet bank for many years. Its operation was so elementary, and th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Steal for 9 characters</h1><div class="post__text post__text-html js-mediator-article"> Today I will tell you a story about a vulnerability that has existed in the same Internet bank for many years.  Its operation was so elementary, and the danger was not so obvious that no one paid attention to it. <br><br>  With this bank, I had an agreement on finding vulnerabilities and all my actions were sanctioned.  That evening, I had already spent a decent time searching for more or less critical vulnerabilities and, having found nothing worthwhile, I was already desperate.  But then my view caught on one parameter in a series of requests to the server at the time of authorization.  By the way, this bank used an advanced and very reliable authorization technology, namely two-factor authorization via SMS.  So, the GET parameter of the request, to which I paid attention, looked like: <code>go=/path/to/some/page <br></code> <code>go=/path/to/some/page <br></code>  and was formed on the server side for further forwarding.  But the problem was that the redirect path was relative and was added to the site domain and therefore I ignored this request in my previous research.  In addition, in order for potential vulnerability to exist in it, a number of factors had to exist, namely: <br>  one).  possibility using the <code>go <br></code> parameter value <code>go <br></code>  provide redirection to a third-party domain <br>  2).  opportunity on the client to set the value of this parameter <br>  3).  and finally, after authorization, when redirecting to a third-party domain, some valuable information should be transmitted <br><br>  As a result, with little hope for any result, I began to look for ways to exploit potential vulnerabilities. <br><a name="habracut"></a><br>  After some thought, I found the solution to the first of the three problems listed above.  I suggest the reader also think about this task.  At first glance, we have a relative path <code>/path/to/some/page, <br></code> <code>/path/to/some/page, <br></code>  which is added to the site domain <code><a href="https://internet-bank.com/"></a> internet-bank.com <br></code>  and the result is the address <code><a href="https://internet-bank.com/path/to/some/page"></a> internet-bank.com/path/to/some/page. <br></code>  How do we create a URL with a third-party domain?  Who has guessed, can put himself a plus for ingenuity.  Who wants to know the answer, read on.  So, if we instead of <code>/path/to/some/page <br></code> <code>/path/to/some/page <br></code>  add <code>.some.domain.com, <br></code> <code>.some.domain.com, <br></code>  then get a link to redirect the view <code><a href="https://internet-bank.com.some.domain.com/"></a> internet-bank.com.some.domain.com <br></code> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Thus, the first item from the three listed above is completed, we formed the name of a third-party domain to which there is a potential opportunity to redirect the user.  There are 2 more points left. <br><br>  To perform step 2, I tried to log in to the Internet bank not from the address <code><a href="https://internet-bank.com/"></a> internet-bank.com, <br></code>  and with <code><a href="https://internet-bank.com/%3Fgo%3D/path/to/some/page"></a> internet-bank.com?go=/path/to/some/page. <br></code>  And lo and behold, the server produced two-factor authentication and eventually redirected me to the address first <code><a href="https://internet-bank.com/path/to/some/page/%3Ftoken%3D37C853F2CA868D819BD9514C3CCEB"></a> internet-bank.com/path/to/some/page/?token=37C853F2CA868D819BD9514C3CCEB, <br></code>  and then on <code><a href="https://internet-bank.com/path/to/some/page"></a> internet-bank.com/path/to/some/page. <br></code>  I have to log out and authorize from the address <br> <code><a href="https://internet-bank.com/%3Fgo%3D.some.domain.com"></a> internet-bank.com?go=.some.domain.com. <br></code>  Having done this, I was thrown to the address <code><a href="https://internet-bank.com.some.domain.com/%3Ftoken%3D37C853F2CA868D819BD9514C3CCEB"></a> internet-bank.com.some.domain.com?token=37C853F2CA868D819BD9514C3CCEB,</code>  <code><a href="https://internet-bank.com.some.domain.com/%3Ftoken%3D37C853F2CA868D819BD9514C3CCEB"></a> internet-bank.com.some.domain.com?token=37C853F2CA868D819BD9514C3CCEB,</code> so point 3 was executed automatically.  Why this token was used in redirects for authorization, I did not understand, but in the end I had the opportunity to link <code><a href="https://internet-bank.com/%3Ftoken%3D37C853F2CA868D819BD9514C3CCEB"></a> internet-bank.com?token=37C853F2CA868D819BD9514C3CCEB <br></code>  Log in from any computer without entering your login, password and SMS. <br><br>  Mission completed. <br><br>  What's next?  And then register a second-level domain, for example <code>como.wtf</code> , distribute the link on the Internet <code><a href="https://internet-bank.com/%3Fgo%3Do.wtf"></a> internet-bank.com?go=o.wtf <br></code>  and get access to other accounts in the Internet bank due to the transfer of authorization tokens to <code><a href="https://internet-bank.como.wtf/"></a> internet-bank.como.wtf <br></code> <br><br>  In the end, it turns out that in order to be able to hijack someone else's account, we just need to add to the completely safe Internet bank site address only 9 characters of the malicious code: <b>"? Go = o.wtf"</b> <br><br>  And for myself, I made the following conclusion: if there is even the slightest probability of a potential vulnerability, it should be eliminated. </div><p>Source: <a href="https://habr.com/ru/post/263073/">https://habr.com/ru/post/263073/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263061/index.html">7 rules for creating beautiful interfaces. Part 2</a></li>
<li><a href="../263063/index.html">What else can a browser know about you?</a></li>
<li><a href="../263065/index.html">Release of InterSystems Cach√© 2015.2 DBMS</a></li>
<li><a href="../263067/index.html">About Burali-Forti, Poincar√© and the very definition of a unit</a></li>
<li><a href="../263069/index.html">UINavigationController and what it eats with: basic principles, subclassing, protection against double transitions and much more</a></li>
<li><a href="../263075/index.html">Protecting PHP Script Domain Name Paths</a></li>
<li><a href="../263077/index.html">Under the hood of ATM software</a></li>
<li><a href="../263079/index.html">6 things I would like to know before developing my first Android application</a></li>
<li><a href="../263081/index.html">We clean the home Internet from very annoying ads (Ad's blocker for OpenWRT)</a></li>
<li><a href="../263083/index.html">Build docker containers with docker containers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>