<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bypassing the detection of virtual machine programs in VMWare</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Virus software developers and developers who simply do not want to reverse their program, during the launch or installation phase, carry out checks on...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bypassing the detection of virtual machine programs in VMWare</h1><div class="post__text post__text-html js-mediator-article">  Virus software developers and developers who simply do not want to reverse their program, during the launch or installation phase, carry out checks on the virtual machine, and in case of its detection they refuse to work, or even self-destruct.  Under the cat described a way to try to solve this problem. <br><a name="habracut"></a><br>  I used VMWare Fusion for Mac, but it works just as well in Workstation for Win. <br><br>  <strong>1)</strong> To work, you need a newly installed system, how to make changes to an existing one - did not find it. <br><br>  Prepare a virtual disk, specify the system, as you usually do, and in the settings for the installed machine, I have this item called Isolation, turn off any data exchange with the host OS. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>2)</strong> Next, you need to find the VMX configuration file created during the creation of the machine in VMWare, and add lines to the end: <br><br><blockquote>  <i>isolation.tools.getPtrLocation.disable = "TRUE"</i> <i><br></i>  <i>isolation.tools.setPtrLocation.disable = "TRUE"</i> <i><br></i>  <i>isolation.tools.setVersion.disable = "TRUE"</i> <i><br></i>  <i>isolation.tools.getVersion.disable = "TRUE"</i> <i><br></i>  <i>monitor_control.disable_directexec = "TRUE"</i> <i><br></i>  <i>monitor_control.disable_chksimd = "TRUE"</i> <i><br></i>  <i>monitor_control.disable_ntreloc = "TRUE"</i> <i><br></i>  <i>monitor_control.disable_selfmod = "TRUE"</i> <i><br></i>  <i>monitor_control.disable_reloc = "TRUE"</i> <i><br></i>  <i>monitor_control.disable_btinout = "TRUE"</i> <i><br></i>  <i>monitor_control.disable_btmemspace = "TRUE"</i> <i><br></i>  <i>monitor_control.disable_btpriv = "TRUE"</i> <i><br></i>  <i>monitor_control.disable_btseg = "TRUE"</i> </blockquote><br>  These options prevent programs from detecting the virtual environment through such complex checks as tracking the address space of the memory counters. <br><br>  <b>Important!</b>  <b>If during installation setup there is an option like ‚ÄúExpress install‚Äù, ‚ÄúQuick install‚Äù - turn them off.</b>  <b>Also, do not install VMWare Tools in the installed system, because</b>  <b>Some software also includes the presence of this package.</b> <br><br>  <strong>3)</strong> Save the file, specify the ISO for the boot with the installer of the system, install the OS as usual. <br><br>  <strong>4)</strong> Despite the fact that the overwhelming majority of programs that do not like the virtual environment, do not go beyond the checks that we cut off in step 2, some particularly persistent ones go further and try to look for, for example, everything that looks like the name of virtual controllers drives. <br><br>  To defeat them in Windows, go to the registry editor in the branch HKLM \ SYSTEM \ CurrentControlSet \ Services \ Disk \ Enum.  As you can see, there is a very obvious reference to the fact that the disk is virtual. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dba/a3f/a28/dbaa3fa287ac4d51a47db3931279d7de.png"></div><br>  We need to change it by removing VMware, Virtual, Ven, etc. from the parameter, and save it. <br><br>  It also makes sense to replace the search in the registry for VMware / Virtual on any Intel or IBM all that changes, not just disk variables. <br><br>  Then try to run your stubborn experiment object - in 70 percent of cases, the described steps will help pass the tests for a virtual environment. <br><br>  <b>Important!</b>  <b>The value in HKLM \ SYSTEM \ CurrentControlSet \ Services \ Disk \ Enum is overwritten after each reboot, so it needs to be changed after each new system startup.</b> <br><br><blockquote>  <i>UPD from <a href="https://habrahabr.ru/users/Dinisoid/">@Denisoid</a> :</i> <i><br><br></i>  <i>Naturally, this is not an exhaustive guide; some software may also attempt to determine the virtual system by the following methods:</i> <i><br><br></i>  <i>1) Check the range of MAC addresses (just replaced in the settings of the virtual network adapter before starting the virtual machine)</i> <i><br></i>  <i>2) Via WinAPI by polling the OS configuration and other system information (FirmwareTable)</i> <i><br></i>  <i>3) Low-level tricks.</i> </blockquote><br>  You can check how much you have protected yourself against detection, as well as familiarize yourself with other means of sandboxing and virtual women detection that are popular with developers, using the Pafish tool. <br><br><img src="https://habrastorage.org/files/8bb/1bd/60c/8bb1bd60ca784b77a4146d7513d5dfb6.png"><br><br>  Despite the fact that there are places where you can betray yourself, the proposed method leads to outwit most software that does not want to work in a virtual environment, in this case, in VMWare. <br><br>  As you can see, stealth can also be improved by allocating more system resources to the virtual machine.  As for the memory, choose values ‚Äã‚Äãthat are multiples of 1024. <br><br>  Thanks to everyone who mastered the article and helped in complementing it with sensible comments! </div><p>Source: <a href="https://habr.com/ru/post/311492/">https://habr.com/ru/post/311492/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311476/index.html">Paul Graham: The Other Side of "Masterpieces on Time"</a></li>
<li><a href="../311480/index.html">How to calculate permutations. Lecture in Yandex</a></li>
<li><a href="../311482/index.html">Happy together: Getting feedback from customers makes them loyal</a></li>
<li><a href="../311486/index.html">Why are successful games in China do not get popular in the West?</a></li>
<li><a href="../311490/index.html">Becoming a leader (in terms of appointment) and being him (in fact) is a task of varying complexity</a></li>
<li><a href="../311494/index.html">Random non-randomness in games</a></li>
<li><a href="../311496/index.html">The difference between eastern and western games of the "three in a row" genre</a></li>
<li><a href="../311500/index.html">Routing in the clojure web application</a></li>
<li><a href="../311502/index.html">As I read the sensor readings via SNMP (Python + AgentX + systemd + Raspberry Pi) and built another monitor.</a></li>
<li><a href="../311506/index.html">Writing an extension using the php-cpp library for php7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>