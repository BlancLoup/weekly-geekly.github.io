<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing your own time base database on Junos devices</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In connection with the event that awaits us soon: the day, or rather nights, ‚Äúno transition to winter time‚Äù, I would like to tell you about updating t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing your own time base database on Junos devices</h1><div class="post__text post__text-html js-mediator-article">  In connection with the event that awaits us soon: the day, or rather nights, ‚Äúno transition to winter time‚Äù, I would like to tell you about updating the base of time zones on Juniper Networks, Inc. equipment.  executing the Junos operating system. <br><br>  The procedure itself is beautifully described in the documentation presented on the company's website, in the document: " <a href="http://www.juniper.net/techpubs/en_US/junos9.5/information-products/topic-collections/swconfig-system-basics/time-zone-custom-configuring.html">Setting a Custom Time Zone on Routers Running JUNOS Software</a> ".  I will only talk about it in my native language and clarify certain details. <br><a name="habracut"></a><br>  The developers of the operating system were sightedly noticed that the update of the time zone database may occur more often than the update of the operating system itself.  And they provided the opportunity to use the database, personally modified by the administrators operating their equipment. <br><br>  How to do it? <br><ul><li>  First, we need to get and upload the latest time zone database to the device.  Junos developers use a completely standard " <a href="http://www.iana.org/time-zones">Time Zone Database</a> " used in many other operating systems.  Its current version is available on the IANA website. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I dare to assume that you, as an administrator, have access to equipment via the SSH protocol.  And, accordingly, you can use the SCP to transfer the base obtained from IANA to the device. <br><br>  Run from the admin station: <br><br>  <u>&gt;</u> scp tzdata2011m.tar.gz admin-name@junos-host.domain.tld: <br><br>  In this case, we put the archive we need into the user's home directory ‚Äúadmin-name‚Äù, located on the device with the DNS name ‚Äújunos-host.domain.tld‚Äù.  This is just one of the possible ways.  Another, I will describe later. <br><br></li><li>  Second, we need to log in to the updatable device with Junos, using the SSH protocol.  And get a shell on it using the "start shell" command <br><br>  <u>- JUNOS 10.2R3.10 built 2010-10-16 20:36:59 UTC</u> <u><br></u>  <u>admin-name @ junos-host&gt;</u> start shell <br>  <u>%</u> <br><br>  You will find yourself in the home directory of the user under which you registered.  If you used the same username when copying the time zone database file, you will be able to see this file by executing the ‚Äúls -lh‚Äù command.  You can find out the current location within the file system using the ‚Äúpwd‚Äù command. <br><br></li><li>  Let's return to the first point and I will tell about one more way to receive the file with archive of temporary zones on the device.  This method may be suitable if you have access to the Internet from your device.  You can use the fetch command and download the file directly from the IANA site while in shell mode on the device. <br><br>  <u>%</u> fetch <a href="">www.iana.org/time-zones/repository/releases/tzdata2011m.tar.gz</a> <br><br></li><li>  Third, unpack the contents of the time zone database archive file into the recommended directory in the documentation. <br><br>  <u>%</u> mkdir -p / var / tmp / tz &amp;&amp; cd / var / tmp / tz &amp;&amp; rm * <br>  <u>%</u> tar xzvf /var/home/admin-name/tzdata*.gz <br><br>  Notice that we have made the directory "/ var / tmp / tz" current.  And it unpacked the contents of the archive file located in the home directory of the user, under whose name you registered on the device.  If you executed the ‚Äúpwd‚Äù command described in clause two, you noticed that the path to the home directory shown at that moment and the path used in the ‚Äútar‚Äù command are different.  You can use any of the options.  Junos simply creates symbolic links for the respective directories. <br><br>  If necessary, at the moment, you can modify the database files, which are plain text files, using, for example, the text editor "vi" available in the system. <br><br>  <u>%</u> vi europe <br><br></li><li>  Fourth.  To execute the following items, you need to get the ‚Äúroot‚Äù user privileges on the device.  This can be done using the ‚Äúsu‚Äù program. <br><br>  <u>%</u> su <br>  <u>Password:</u> <u><br></u>  <u>root @ junos-host%</u> <br><br>  A legitimate question arises: ‚ÄúWhere can I get the password for the root user‚Äù?  Well, of course, if you do not know him.  The password is stored in the device configuration, section system. <br><br><pre>  system {
     root-authentication {
         encrypted-password "$ 1 $ z.GrqhbO $ aveIsL2fd4sUbADBrE8Y9 /";  ## SECRET-DATA
     }
 } </pre><br>  If necessary, you can change it: <br><br>  <u>admin-name @ junos-host&gt;</u> edit <br>  <u>Entering configuration mode</u> <u><br><br></u>  <u>[edit]</u> <u><br></u>  <u>admin-name @ junos-host #</u> set system root-authentication plain-text-password <br>  <u>New password:</u> <u><br></u>  <u>Retype new password:</u> <u><br><br></u>  <u>[edit]</u> <u><br></u>  <u>admin-name @ junos-host #</u> commit <br>  <u>commit complete</u> <br><br></li><li>  The fifth.  To compile the user time zone database, we will use the ‚Äúcompile-tz‚Äù script.  In it, in fact, there is only a call to the application "zic" with preset parameters. <br><br>  <u>%</u> / usr / libexec / ui / compile-tz europe <br><br>  As parameters of the script, we pass the name of the source file or several files, or any parameters valid for the "zic" command. <br><br>  The resulting compiled time zone database files will be placed in the directory: "/ var / db / zoneinfo /". <br><br></li><li>  The sixth.  How to apply the resulting database?  You just need to specify the use of imported time zone database (use-imported-time-zones) and set the time zone correctly (time-zone). <br><br>  <u>[edit]</u> <u><br></u>  <u>admin-name @ junos-host #</u> set system use-imported-time-zones <br><br>  <u>[edit]</u> <u><br></u>  <u>admin-name @ junos-host #</u> set system time-zone Europe / Moscow <br><br>  <u>[edit]</u> <u><br></u>  <u>admin-name @ junos-host #</u> commit <br>  <u>commit complete</u> <br><br></li><li>  Seventh.  You can check the result with the command: <br><br>  <u>admin-name @ junos-host&gt;</u> show system uptime <br></li></ul></div><p>Source: <a href="https://habr.com/ru/post/132274/">https://habr.com/ru/post/132274/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132254/index.html">Bible design. Part two. Crutches, exile from paradise, Cain, Abel, and again from scratch</a></li>
<li><a href="../132255/index.html">Features testing Flex UI components using FlexUnit 4</a></li>
<li><a href="../132257/index.html">Coworking in an Internet cafe: Start</a></li>
<li><a href="../132262/index.html">DIY backups for dummies</a></li>
<li><a href="../132272/index.html">On the fixing of negotiations of cellular subscribers</a></li>
<li><a href="../132276/index.html">Life without patents - for and against</a></li>
<li><a href="../132277/index.html">Working Pull to refresh</a></li>
<li><a href="../132279/index.html">Crossbrowser APNG</a></li>
<li><a href="../132281/index.html">Mail.Ru does not like Yandex and Google or an interesting feature of the work of Mail.ru Agent</a></li>
<li><a href="../132283/index.html">CSS3 and HTML5 tooltips</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>