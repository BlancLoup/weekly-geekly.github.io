<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hardware accelerated rendering in Chrome browser</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 For most web developers, the fundamental representation of web browsers is the DOM. While the process of converting this representation...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hardware accelerated rendering in Chrome browser</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  For most web developers, the fundamental representation of web browsers is the DOM.  While the process of converting this representation to an image on the screen (hereinafter referred to as rendering) is often covered with a veil of misunderstanding.  In recent years, browser developers have been actively optimizing this process, shifting some of the work onto the shoulders of graphics processors: what is called ‚Äúhardware acceleration‚Äù.  We will consider rendering in the context of regular pages, excluding Canvas2D and WebGL.  This article will try to shed light on the fundamental concept of using hardware acceleration when generating an image of web content in the Chrome browser. <br><a name="habracut"></a><br><br><h5>  A warning </h5><br>  Here we will talk only about the WebKit engine, or to be more precise about its fork in Chromium.  This article covers implementation details in Chrome, which are not documented in any way in the standards.  Therefore, there is no guarantee that anything described in this article will apply to other browsers.  Nevertheless, knowledge of these subtleties will help you to conduct fine debugging and improve performance. <br><br>  Also, take into account that the rendering engine in Chrome is evolving in swift steps.  And there is no guarantee that everything described here will be valid in the same six months. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It is important to keep in mind that at the moment Chrome supports two rendering mechanisms: hardware and old software.  At the time of this writing, all pages are rendered using hardware acceleration in Windows, ChromeOS and Chrome on Android.  On MacOS and Linux, only pages containing compositional elements are dumped into this mode (we will talk about this below), but this will be fixed very soon. <br><br>  Ultimately, we consider only the top of the renderer engine, paying attention to those things that are designed to significantly improve performance.  Practicing on your own site will help you better understand the layer model.  But you shouldn't mindlessly multiply their number, it can bring in extra overhead for the entire graphic stack. <br><br><h4>  Path from DOM to screen </h4><br><h5>  Concept of layers </h5><br>  When the page is loaded and processed in the browser, it turns into what everyone knows as DOM.  The page rendering process proceeds through a series of intermediate transformations directly inaccessible to the developer.  The most important of the structures generated in the process is the layer. <br><br>  There are two types of layers in Chrom: RenderLayers, which contain DOM subtrees, and GraphicsLayers, which contain previous subtrees.  Now the latter are of more interest to us, since the Graphics Layers are what are sent to the graphics processor as textures.  Hereinafter, wherever the word ‚Äúlayer‚Äù occurs, I mean precisely the Graphic Layer. <br><br>  Slightly distract the terminology on the GPU and try to figure out what texture is? <br>  Think of it as a bitmap portion of a graphic object (bitmap) that is transferred from the main memory (RAM) to the memory of the graphics processor (VRAM).  When a texture falls into the hands of a GPU, it can pull it onto a polygonal mesh ‚Äî in video games, this technique is used to stretch the ‚Äúskin‚Äù onto three-dimensional objects.  Chrome uses textures to transfer portions of the page‚Äôs content to the GPU so that it can subsequently impose them on a simple square grid and do any 3D transformations with it.  This is how 3D CSS works and it also has a great effect on page scrolling performance - but first things first. <br><br>  Let's look at a couple of examples to more clearly demonstrate the concept of layers. <br><br>  There is a very useful tool for understanding layers in Chrome - the ‚Äúshow composited layer borders‚Äù option in the ‚Äúrendering‚Äù section of the developer toolbar's settings window.  This option simply highlights the borders of the layers on the screen in orange.  Let's turn it on.  All screenshots for examples were taken in Chrome Canary, Chrome 27 at the time of this writing. <br><br><h6>  Example 1: Single Layer <a href="http://www.html5rocks.com/en/tutorials/speed/layers/basic.html">Page</a> </h6><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>I am a strange root.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/34d/031/e75/34d031e75cf01a932a71cf0233965bda.png" alt="image"><br><br>  This page has a single layer.  The blue grid represents the boundaries of the tiles - the parts of the layer that Chrome uses to break up a large layer and send them to the GPU.  Now they are not of much interest to us. <br><br><h6>  <a href="http://www.html5rocks.com/en/tutorials/speed/layers/onelayer.html">Example 2</a> : Element in its own layer </h6><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"-webkit-transform: rotateY(30deg) rotateX(-30deg); width: 200px;"</span></span></span><span class="hljs-tag">&gt;</span></span> I am a strange root. <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/83d/3e0/3b0/83d3e03b0adbfba14c3ffd79baebdaa2.png" alt="image"><br><br>  By setting a 3D CSS property to an element that rotates it, we can see that its own layer is highlighted: pay attention to the orange frame, which wraps it in the screenshot above.  (This is done so that each layer can be rendered independently of the others) <br><br><h5>  Layer Creation Conditions </h5><br>  What other elements can get your layer?  Chrome's heuristics have been developing in this direction lately, but at the moment any of the following conditions leads to the creation of a layer: <br><ul><li>  the CSS element has properties of three-dimensional transformations </li><li>  <code>&lt;video \&gt;</code> element that uses hardware acceleration when decoding video </li><li>  <code>&lt;canvas \&gt;</code> in 3D (WebGL) context or 2D accelerated </li><li>  third-party plug-ins (including Flash) </li><li>  elements that use CSS transparency animation or transform animation </li><li>  elements using CSS filters enable hardware acceleration </li><li>  elements that have descendants with their own composition layers </li><li>  the presence of the element of a brother (sisterly element) with a lower z-index, which itself has its own layer (in other words, if the element is rendered on top of the composition) </li></ul><br><br><h5>  Practical Application: Animation </h5><br>  We know that by animating the CSS transformation, the element will fall into its own layer.  And the layers are very good for animation. <br><br><h6>  <a href="http://www.html5rocks.com/en/tutorials/speed/layers/animatedlayer.html">Example 3</a> : Animated layers </h6><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">div</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation-duration</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">5s</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation-name</span></span></span><span class="css">: slide; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation-iteration-count</span></span></span><span class="css">: infinite; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation-direction</span></span></span><span class="css">: alternate; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">200px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">height</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">200px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">margin</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">100px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">background-color</span></span></span><span class="css">: gray; } @-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">webkit</span></span></span><span class="css">-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">keyframes</span></span></span><span class="css"> slide { </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">from</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-transform</span></span></span><span class="css">: </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">rotate</span></span></span><span class="css">(0deg); } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">to</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-transform</span></span></span><span class="css">: </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">rotate</span></span></span><span class="css">(120deg); } } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>I am a strange root.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  In the simplest case, Chrome will programmatically draw the contents of the layer and send it to the graphic processor as a texture.  If this content does not change in the future, then there is no need to redraw it.  And this is good: redrawing takes time that can be spent, for example, on working out scripts.  And if redrawing takes a lot of time, it can lead to annoying defects in the form of a drop in the frame rate and delays in the animation. <br><br>  You can make sure that in the timeline of the developers panel there are not any redraw operations, as long as the layer rotates here and there. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/444/b71/408/444b71408194d790d98e937ae3842d49.png" alt="image"><br><br><h5>  Caution!  Repainting </h5><br>  But if you change the contents of the layer, it will redraw it. <br><br><h6>  <a href="http://www.html5rocks.com/en/tutorials/speed/layers/animatedinvalidation.html">Example 4</a> : Redraw Layers </h6><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">div</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation-duration</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">5s</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation-name</span></span></span><span class="css">: slide; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation-iteration-count</span></span></span><span class="css">: infinite; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation-direction</span></span></span><span class="css">: alternate; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">200px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">height</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">200px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">margin</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">100px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">background-color</span></span></span><span class="css">: gray; } @-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">webkit</span></span></span><span class="css">-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">keyframes</span></span></span><span class="css"> slide { </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">from</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-transform</span></span></span><span class="css">: </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">rotate</span></span></span><span class="css">(0deg); } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">to</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-transform</span></span></span><span class="css">: </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">rotate</span></span></span><span class="css">(120deg); } } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"foo"</span></span></span><span class="hljs-tag">&gt;</span></span>I am a strange root.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"paint"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùrepaint‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> w = </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">200</span></span></span><span class="javascript">; </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'paint'</span></span></span><span class="javascript">).onclick = </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'foo'</span></span></span><span class="javascript">).style.width = (w++) + </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'px'</span></span></span><span class="javascript">; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Each time the button is pressed, the rotating element will add a pixel in width.  This will redraw the entire element, which in this case is in a separate layer. <br><br>  An easy way to see which parts of the page are redrawn is to enable the ‚Äúshow paint rects‚Äù option, all in the same section ‚ÄúRendering‚Äù of the developer panel settings window.  After switching on, pay attention to both the animated element and the button are flashing red when you click on the button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1a5/d11/60c/1a5d1160c4102b0f9a4ea1737ea57244.png" alt="image"><br><br>  Redraw events can also be seen on the timeline.  A keen eye will notice a duplication of redraw events: one for the layer itself, the other for changing the display of the button state. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b3/a2c/2d6/5b3a2c2d6fcbc1b64ee22de6d6cdc7f9.png" alt="image"><br><br>  Notice that Chrome doesn't always redraw the layer completely.  It tries to be selective and to redraw only those fragments of the layer (the very tiles marked with blue borders) in which the DOM has undergone a change.  In our case, there is only one element for the entire layer, but in most real-life projects, elements per layer are much more. <br><br>  The following question arises: what causes DOM to become outdated and to be redrawn?  It is difficult in a few sentences to cover all cases that may lead to the disability of DOM.  In most cases, this is damage to DOM by changing CSS styles and dynamically generating visible content at runtime.  Tony Gentilkor described them in his <a href="http://gent.ilcore.com/2011/03/how-not-to-trigger-layout-in-webkit.html">blog</a> , and Stoian Stoyanof also wrote a very detailed <a href="http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/">article</a> , but it is limited to a description of the redrawing without details of this new thing we are trying to talk about - composition by means of the video subsystem. <br><br><h4>  Add it all together: DOM on the screen </h4><br>  So how does Chrome turn DOM into an image on the screen?  Conceptually, the following steps can be distinguished: <br><ol><li>  Takes the DOM and breaks it into layers, following the criteria outlined above. </li><li>  Programmatically draws each of the layers separately </li><li>  Sends them to the GPU as textures. </li><li>  On the graphics subsystem assembles all layers into the final image </li></ol><br><br>  This is what happens when drawing the first frame of a page.  But there are several ways to reduce the overhead of rendering the next frame: <br><ul><li>  Not all changes to CSS styles lead to redrawing.  Chome can just re-link existing layers of GPUs already in memory.  This can be achieved by changing only the compositional properties (because transformations, transparency, filters). </li><li>  If part of the layer is changed, it will be redrawn and re-sent to the GPU.  If you leave the content unchanged, and change only the compositional properties (transformation or transparency), Chrome can leave them in video memory and re-link it to generate the next frame. </li></ul><br><br>  As we should have understood, the layer-based compositional model has a great advantage for rendering performance.  Compositioning is a cheaper way to render compared to full redrawing.  Therefore, an attempt to avoid layer redrawing, pulling only the compositional properties of elements is a good way to optimize performance.  Sensible developers will take note of the list of properties that activate composition, in order to be able to force the creation of layers at the right moment.  But be careful in creating layers - this is not free: they need system memory and video memory subsystem (which is limited on mobile devices). <br><br>  That's all! </div><p>Source: <a href="https://habr.com/ru/post/202358/">https://habr.com/ru/post/202358/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202340/index.html">Google rolled out a replacement Javascript - Dart language</a></li>
<li><a href="../202344/index.html">MVC 5 Owin authorization on the example of Vkontakte</a></li>
<li><a href="../202348/index.html">Scripts for managing virtual hosts on a Debian web server</a></li>
<li><a href="../202350/index.html">The history of the startup and its subsequent transformation into an outsourcing office</a></li>
<li><a href="../202354/index.html">How to assess the quality of user experience in data transfer?</a></li>
<li><a href="../202360/index.html">Sony PlayStation 4 Full review</a></li>
<li><a href="../202362/index.html">Comet ISON broke out, time to get binoculars</a></li>
<li><a href="../202364/index.html">The classic post-apocalyptic RPG Wasteland is now on Steam and GOG</a></li>
<li><a href="../202366/index.html">DOM MutationObserver - reacting to a change in DOM without killing browser performance</a></li>
<li><a href="../202368/index.html">Personal cryptography: a story about one useful vulnerability</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>