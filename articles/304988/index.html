<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Signals and slots in PHP. Same as in Qt. Almost</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Signals and slots is an approach used in some programming languages ‚Äã‚Äãand libraries (for example, Boost and Qt) which allows for the implementation of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Signals and slots in PHP. Same as in Qt. Almost</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  Signals and slots is an approach used in some programming languages ‚Äã‚Äãand libraries (for example, Boost and Qt) which allows for the implementation of the ‚Äúobserver‚Äù pattern, minimizing the writing of repetitive code.  The concept is that a component (often a widget) can send signals containing information about an event (for example: the text ‚Äúword‚Äù was highlighted, the second tab was opened).  In turn, other components can receive these signals through special functions - slots.  A signal and slot system is well suited for describing a graphical user interface.  Also, the signal / slot mechanism can be applied to asynchronous I / O (including sockets, pipe, devices with a serial interface, etc.) or event notifications.  In the Qt library, thanks to the Meta-Object Compiler (English) Russian.  there is no need to write a registration / deregistration / call code, since these sample code sections are generated automatically. </blockquote>  Wikipedia tells us. <a name="habracut"></a><br><br>  There is no event loop in php applications.  Received a request, answered.  And that's it.  However, between ‚Äúreceived a request‚Äù and ‚Äúanswered‚Äù there is some kind of application life cycle, respectively, all is not lost and you can try to apply this mechanism in web applications.  As a student I was <a href="https://habrahabr.ru/post/216003/">programming in C ++ / Qt</a> and I really liked the implementation of signals and slots then.  Great idea.  The closest relative is the Observer pattern.  The goal is the same, but the implementation is completely different.  I got the idea to implement this mechanism for php in the form of a small library. <br><br><h4>  Signals and Slots </h4><br>  A signal is something that can inform an external World about the internal state of an object.  The phone can call, the cat can "meow."  Calls and "meow" are signals of the telephone and the cat, respectively.  They tell us about the change in the internal state of the objects: the phone from the state of rest has switched to the state of ‚Äúyou are ringing‚Äù, the cat has moved from the state of ‚Äúfed cat‚Äù to the state of ‚Äúhungry cat‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You can respond to these signals in some way.  For example: pick up the phone or finally feed your cat.  Your responses to signals are slots. <br><br>  In programming, there are exactly the same situations when we need to respond to a change in the state of an object.  For this purpose, the signals and slots mechanism is used to ensure communication between objects.  In my opinion, unlike the ‚ÄúObserver‚Äù template, it is simpler and much more transparent in use (although the ‚ÄúObserver‚Äù itself is also a very simple template). <br><br>  A little thought, I wrote a <a href="https://github.com/pavelfluffy/connector">connector</a> library for php, which implements the mechanism of signals and slots.  Look at her? <br><br><h4>  Installation </h4><br>  Connector is available as a composer package, respectively, for installation, you must perform <br><pre><code class="bash hljs">composer require fluffy/connector</code> </pre> <br>  or add a dependency to the library in your composer.json file <br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"require"</span></span>: { ... <span class="hljs-string"><span class="hljs-string">"fluffy/connector"</span></span>: <span class="hljs-string"><span class="hljs-string">"^1.0"</span></span> }</code> </pre><br>  and execute <br><pre> <code class="bash hljs">composer update</code> </pre><br><br><h4>  Using </h4><br><h5>  1. Signals </h5><br>  If we want the object to emit signals, then we need to implement the <code>SignalInterface</code> interface and use the corresponding SignalTrait <code>SignalTrait</code> .  For example, we have a logger class and we want it to send a signal <code>somethingIsLogged</code> whenever it finishes logging: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@file</span></span></span><span class="hljs-comment"> * Contains definition of Logger class. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Fluffy</span></span>\<span class="hljs-title"><span class="hljs-title">Connector</span></span>\<span class="hljs-title"><span class="hljs-title">Signal</span></span>\<span class="hljs-title"><span class="hljs-title">SignalInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Fluffy</span></span>\<span class="hljs-title"><span class="hljs-title">Connector</span></span>\<span class="hljs-title"><span class="hljs-title">Signal</span></span>\<span class="hljs-title"><span class="hljs-title">SignalTrait</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class Logger. */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Logger</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SignalInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">SignalTrait</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Do logging stuff. ... // Emit signal about successfull logging. $this-&gt;emit('somethingIsLogged', 'Some useful data'); } }</span></span></code> </pre><br>  In order to send a signal, you must call the <code>emit</code> method and pass two parameters: the name of the signal and the data that will be transmitted by this signal.  You can transfer any type of data: string, number, array, or object.  It's all.  Now the object logger is able to send signals to the outside world.  But as long as no one is connected to this signal, no one will know that this object reports something useful.  Let's fix it. <br><br><h5>  2. Slots </h5><br>  A slot is an ordinary class method.  Let's create a class with a slot. <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@file</span></span></span><span class="hljs-comment"> * Contains definition of Receiver class. */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * Class Receiver. */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Receiver</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">slotReactOnSignal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($dataFromSignal)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Received data: $dataFromSignal"</span></span>; } }</code> </pre><br><br><h5>  3. Signal Slot Connections </h5><br>  So, we have a <code>Logger</code> class with a signal and a <code>Receiver</code> class with a slot.  In order to respond to a signal, you need to connect a slot to it. <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Fluffy</span></span>\<span class="hljs-title"><span class="hljs-title">Connector</span></span>\<span class="hljs-title"><span class="hljs-title">ConnectionManager</span></span>; $logger = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Logger(); $receiver = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Receiver(); ConnectionManager::connect($logger, <span class="hljs-string"><span class="hljs-string">'somethingIsLogged'</span></span>, $receiver, <span class="hljs-string"><span class="hljs-string">'slotReactOnSignal'</span></span>); $logger-&gt;log();</code> </pre><br>  By calling <code>ConnectionManager::connect($sender, $signalName, $receiver, $slotName)</code> we thereby connected the signal of the logger object to the slot of the receiver object.  This means that every time <code>$logger-&gt;log()</code> is called, a <code>$logger-&gt;log()</code> signal <code>somethingIsLogged</code> will be sent, to which the <code>slotReactOnSignal</code> slot of the <code>slotReactOnSignal</code> object will respond.  We can define as many signal slot connections as we need.  All possible types of connections work: <br><ul><li>  One signal to one slot </li><li>  One signal to multiple slots </li><li>  Multiple signals to multiple slots </li><li>  Multiple signals to one slot </li></ul><br>  Moreover, it does not matter whether they are signals from one object or from different objects, whether they are slots of a single object or different ones. <br><br><h5>  4. Types of compounds </h5><br>  By default, the <code>ConnectionManager::connect()</code> method creates a permanent connection.  This means that the connection will not be broken after the first signal is sent.  However, it is possible to create a one-time connection by passing a constant to the fifth parameter ‚Äî the type of connection.  For example: <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Fluffy</span></span>\<span class="hljs-title"><span class="hljs-title">Connector</span></span>\<span class="hljs-title"><span class="hljs-title">ConnectionManager</span></span>; $logger = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Logger(); $receiver = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Receiver(); ConnectionManager::connect($logger, <span class="hljs-string"><span class="hljs-string">'somethingIsLogged'</span></span>, $receiver, <span class="hljs-string"><span class="hljs-string">'slotReactOnSignal'</span></span>, ConnectionManager::CONNECTION_ONE_TIME); $logger-&gt;log(); <span class="hljs-comment"><span class="hljs-comment">// Log once again. $logger-&gt;log();</span></span></code> </pre><br>  After the second call to <code>Logger::log()</code> nothing will happen as the slot will be disconnected from the signal after its first expulsion. <br><br><h5>  5. Disconnect </h5><br>  If we don‚Äôt want to listen to a certain signal anymore, then we simply disconnect from it. <br><pre> <code class="php hljs">ConnectionManager::disconnect($logger, <span class="hljs-string"><span class="hljs-string">'somethingIsLogged'</span></span>, $receiver, <span class="hljs-string"><span class="hljs-string">'slotReactOnSignal'</span></span>);</code> </pre><br>  If we need to reset all existing connections, then we need to call <br><pre> <code class="php hljs">ConnectionManager::resetAllConnections()</code> </pre><br><br><h5>  What is it for? </h5><br><ul><li>  I just like the signals and slots mechanism and its implementation in Qt.  There was a desire to implement something similar for php. </li><li>  It is more convenient than the "observer". </li></ul><br><br>  Project repository: <a href="https://github.com/pavelfluffy/connector">fluffy / connector</a> <br><br>  I hope it was interesting to get to this line.  Criticism and thoughts in hearing are welcome. <br><br><h4>  <b>UPD</b> </h4><br><ul><li>  As noted by <a href="https://habrahabr.ru/users/symbix/" class="user_link">symbix,</a> using inheritance to implement signal functionality is not convenient.  Taken into account.  Now implemented on track (see point 1) </li><li>  As noted <a href="https://habrahabr.ru/users/oxidmod/" class="user_link">oxidmod</a> does not make much sense to limit the naming of slots (the keyword "slot").  Now the slot can be a method with any name (see clause 2) </li></ul></div><p>Source: <a href="https://habr.com/ru/post/304988/">https://habr.com/ru/post/304988/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304926/index.html">Machine learning instead of DPI. Building a traffic classifier</a></li>
<li><a href="../304932/index.html">Data Protection - Modern Security Challenges</a></li>
<li><a href="../304934/index.html">Important aspects of the browser for developers. Part 2</a></li>
<li><a href="../304936/index.html">About tasty and healthy food ESP8266 from batteries</a></li>
<li><a href="../304982/index.html">Sparrowdo is a simple configuration management tool.</a></li>
<li><a href="../304998/index.html">We play mp3 in our program and what can prevent it</a></li>
<li><a href="../305000/index.html">We are looking for vulnerabilities in code: theory, practice and prospects of SAST</a></li>
<li><a href="../305002/index.html">CMYK closed-loop search algorithm on a two-dimensional matrix</a></li>
<li><a href="../305006/index.html">Wired: How blockchain threatens the financial market, and why companies on Wall Street develop this technology</a></li>
<li><a href="../305014/index.html">Review of Quanta servers: interesting solutions, rack-sized blade baskets, microserver hives and HPC farms</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>