<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Never write long ifs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Errors in the conditions allowed a great many. For example, you can take any post from the PVS-studio blog, each has errors related to inattentive han...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Never write long ifs</h1><div class="post__text post__text-html js-mediator-article">  Errors in the conditions allowed a great many.  For example, you can take any post from the <a href="https://habrahabr.ru/company/pvs-studio/">PVS-studio</a> blog, each has errors related to inattentive handling of conditions.  Indeed, it is not easy to see the error in the condition that the code looks like this (an example from <a href="https://habrahabr.ru/company/pvs-studio/blog/331638/">this post</a> ): <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ParseNumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tx)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(tx) &gt;= <span class="hljs-number"><span class="hljs-number">4</span></span> &amp;&amp; (<span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"%eps"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"+%pi"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"-%pi"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"+Inf"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"-Inf"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"+Nan"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"-Nan"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"%nan"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"%inf"</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> )) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(tx) &gt;= <span class="hljs-number"><span class="hljs-number">3</span></span> &amp;&amp; (<span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"+%e"</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"-%e"</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">strncmp</span></span>(tx, <span class="hljs-string"><span class="hljs-string">"%pi"</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">// &lt;= || strncmp(tx, "Nan", 3) == 0 || strncmp(tx, "Inf", 3) == 0 || strncmp(tx, "%pi", 3) == 0)) // &lt;= { return 3; } .... }</span></span></code> </pre> <a name="habracut"></a><br>  Such conditions are a universal phenomenon, I came across them absolutely in all projects with which I dealt.  This <a href="https://habrahabr.ru/post/208692/">post on Habr√© perfectly illustrates the zoo established in the programmer‚Äôs world</a> of how to ‚Äúwrite‚Äù conditions for if-else, and each approach is well-reasoned and cool, generally spaces are driving, tabulation sucks and all that.  The funny thing is that it begins with the words ‚ÄúThe conditional operator in its usual form is a source of problems is relatively rare,‚Äù referring again to the PVS-studio blog and your own bitter experience to confirm the reverse. <br><br>  I noticed that lately, when writing if-else blocks, I began to use the approach that I formalized just now and I wanted to share with you.  In general, it coincides with the one described <a href="https://habrahabr.ru/post/208692/">in the first comment to the above post</a> , but more radically and with a clear idea.  I use this technique in general in all conditions, no matter if they are complex or simple. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the most general form, the rule is: <b>if there is more than one logical operator in the condition, you need to think about its refactoring.</b>  <b>When naming variables, choose names that correspond to business logic, and not formal checks that are obvious from the code</b> . <br><br>  In truth, the second is even more important.  If there is a condition about what to say, besides what is explicitly written in it, you need to think whether it can be expressed by the name of a variable.  Compare two pseudocode: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (model.user &amp;&amp; model.user.id) { doSomethingWithUserId(model.user.id); ... }</code> </pre> <br>  and <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> userExistsAndValid = model.user &amp;&amp; model.user.id; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (userExistsAndValid) { doSomethingWithUser(model.user); ... }</code> </pre> <br>  In the first case, we have a purely formal check of values, we need user.id and we check if it is there, everything can be left as is.  In the second case, we need a valid model and we explain this in the name of the variable through terms of business logic. <br><br>  This approach also has advantages in refactoring: if the verification is needed further in the method again and / or the validity conditions expand (it will be necessary for the user to have an email) - the changes will be minimal. <br><br>  Let's take an example about the user too, but more difficult, which I encountered just a few days ago and refactored in this style.  It was: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.profile.firstName &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.profile.lastName &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.password || !!_.find(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.serviceAccounts, a =&gt; a.provider === <span class="hljs-string"><span class="hljs-string">'slack'</span></span> &amp;&amp; a.accountId)) { .... }</code> </pre> <br>  It became: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hasSlack = !!_.find(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.serviceAccounts, a =&gt; a.provider === <span class="hljs-string"><span class="hljs-string">'slack'</span></span> &amp;&amp; a.accountId); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hasSomeLoginCredentials = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.password || hasSlack; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hasPersonalData = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.profile.firstName &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.profile.lastName; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hasPersonalData &amp;&amp; hasSomeLoginCredentials) { .... }</code> </pre> <br>  Of course there are cases when some elements of the condition need to be fulfilled only if the previous ones were successful and other exceptions, but still: if there is more than one logical operator in the condition, you need <b>to think</b> about its refactoring.  Most of these moments can be resolved, by the way, with ternary expressions or local functions, but as far as these tools are more readable than long ifs, everyone decides for himself. <br><br>  For me, shortcuts are on the list of exceptions, obviously, if you just need to express something like: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err || !result || !result.length === <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> callback(err);</code> </pre> <br>  It makes no sense to introduce variables. </div><p>Source: <a href="https://habr.com/ru/post/332060/">https://habr.com/ru/post/332060/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../332050/index.html">Security Week 26: ExPetr is not an extortionist, Intel PT allows you to bypass PatchGuard, in the Malware Protection Engine again RCE</a></li>
<li><a href="../332052/index.html">Symfony: Webpack Encore - plugin for resource management</a></li>
<li><a href="../332054/index.html">VK Streaming API Contest</a></li>
<li><a href="../332056/index.html">How to become a team leader and not explode</a></li>
<li><a href="../332058/index.html">Petya and others. ESET discloses cyber attacks on corporate networks</a></li>
<li><a href="../332062/index.html">Who is Mr. Hacker?</a></li>
<li><a href="../332064/index.html">How to confuse the analyst. Part Two: What is domain modeling?</a></li>
<li><a href="../332066/index.html">Probabilistic and informational analysis of measurement results in Python</a></li>
<li><a href="../332068/index.html">Automation blocking Petya / NonPetya</a></li>
<li><a href="../332070/index.html">We answer readers' questions: what is the IBM Watson cognitive system, and how does it work?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>