<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deploy Nginx Flask Application Using Gunicorn</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Suppose you have Ubuntu in which you need to deploy Nginx with a Flask application. You need to use a WSGI server, such as Gunicorn. Gunicorn (Green U...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deploy Nginx Flask Application Using Gunicorn</h1><div class="post__text post__text-html js-mediator-article">  Suppose you have Ubuntu in which you need to deploy Nginx with a Flask application.  You need to use a WSGI server, such as Gunicorn.  Gunicorn (Green Unicorn) - WSGI HTTP server in Python for UNIX systems.  I present a free translation of the article Onur G√ºzel <a href="http://www.onurguzel.com/how-to-run-flask-applications-with-nginx-using-gunicorn/">How to Run Flask Applications with Nginx Using Gunicorn</a> , where the process of deployment is shown step by step. <br><a name="habracut"></a><hr><br><h2>  Step 0: Requirements </h2><br>  We will use virtualenv to work with a virtual Python environment and pip to work with Python packages.  Install them by entering the following command in the terminal: <br><br><pre><code class="bash hljs">sudo apt-get install python-virtualenv python-pip</code> </pre> <br>  Create a virtual environment and activate it: <br><br><pre> <code class="bash hljs">virtualenv hello <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> hello/bin/activate</code> </pre><br>  We note that our prompt now begins with the name of the virtual environment. <br><hr><br><h2>  Step 1: Application </h2><br>  Install Flask: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">pip install Flask</code> </pre><br>  After installing Flask using pip, you can write the following code in <i>hello.py</i> and run it: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask app = Flask(__name__) @app.route(<span class="hljs-string"><span class="hljs-string">'/'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Hello world!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: app.run()</code> </pre><br>  Flask has a built-in web server that allows you to run applications.  However, it is not scalable and is not suitable for production.  On the other hand, there is Gunicorn, which is ready to use for production and provides scalability. <br><hr><br><h2>  Step 2: Gunicorn </h2><br>  Install Gunicorn: <br><br><pre> <code class="bash hljs">pip install gunicorn</code> </pre><br>  In order for our Flask application to work with Gunicorn, you need to add 2 and 9 lines from the code to <i>hello.py</i> : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> werkzeug.contrib.fixers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ProxyFix app = Flask(__name__) @app.route(<span class="hljs-string"><span class="hljs-string">'/'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Hello world!"</span></span> app.wsgi_app = ProxyFix(app.wsgi_app) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: app.run()</code> </pre><br>  Now we can run the application with Gunicorn: <br><br><pre> <code class="bash hljs">gunicorn hello:app</code> </pre><br>  Where <i>hello</i> is the name of the python file (without the extension).  And the <i>app</i> is the name of the Flask object. <br><hr><br><h2>  Step 3: Nginx </h2><br>  Create a new server configuration and save the file to: <br>  <i>/etc/nginx/sites-available/hello.conf</i> <br>  <i>Hello.conf</i> content: <br><br><pre> <code class="nginx hljs"><span class="hljs-section"><span class="hljs-section">server</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">listen</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">server_name</span></span> hello.itu24.com; <span class="hljs-attribute"><span class="hljs-attribute">root</span></span> /path/to/hello; <span class="hljs-attribute"><span class="hljs-attribute">access_log</span></span> /path/to/hello/logs/access.log; <span class="hljs-attribute"><span class="hljs-attribute">error_log</span></span> /path/to/hello/logs/error.log; <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> / { <span class="hljs-attribute"><span class="hljs-attribute">proxy_set_header</span></span> X-Forward-For <span class="hljs-variable"><span class="hljs-variable">$proxy_add_x_forwarded_for</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_set_header</span></span> Host <span class="hljs-variable"><span class="hljs-variable">$http_host</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_redirect</span></span> <span class="hljs-literal"><span class="hljs-literal">off</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (!-f <span class="hljs-variable"><span class="hljs-variable">$request_filename</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> http://127.0.0.1:8000; break; } } }</code> </pre><br>  Create a symbolic link for the sites-enabled directory: <br><br><pre> <code class="bash hljs">sudo ln -s /etc/nginx/sites-available/hello.conf /etc/nginx/sites-enabled/</code> </pre><br>  Check the configuration for errors: <br><br><pre> <code class="bash hljs">nginx -t</code> </pre><br>  If everything is fine with the configuration, you can restart Nginx and get a deployed application. </div><p>Source: <a href="https://habr.com/ru/post/267097/">https://habr.com/ru/post/267097/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267085/index.html">How to optimize the online store. Part 1. Automatic calling of incoming leads</a></li>
<li><a href="../267087/index.html">FP on Scala: Invariant Functor</a></li>
<li><a href="../267091/index.html">The evolution of network communication methods. Part I</a></li>
<li><a href="../267093/index.html">Microsoft has released a major update for Windows RT</a></li>
<li><a href="../267095/index.html">Nginx: protect url one-time password</a></li>
<li><a href="../267099/index.html">Malware Odlanor specializes in compromising poker players</a></li>
<li><a href="../267103/index.html">Corporate VPN with ACCEL-PPP + IPsec and authorization with Freeradius via AD</a></li>
<li><a href="../267105/index.html">UrbanAirship - push without creating a server</a></li>
<li><a href="../267107/index.html">Log Analysis with Hadoop / Python</a></li>
<li><a href="../267109/index.html">In the Norwegian abandoned mine will build the largest data center in Europe</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>