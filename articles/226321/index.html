<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Speedran on 13 vulnerabilities on sites. Basic concepts and means of protection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I collected a kind of lecture on web security for my work, got acquainted with the well-known rating of OWASP 2013 , but was surprised to fi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Speedran on 13 vulnerabilities on sites. Basic concepts and means of protection</h1><div class="post__text post__text-html js-mediator-article">  Recently, I collected a kind of lecture on web security for my work, got acquainted with the well-known rating of <a href="https://owasp.org/index.php/Top_10_2013-Top_10">OWASP 2013</a> , but was surprised to find that there was very little information in Russian, or there was practically no information available. <br><br>  This, in fact, was the reason to write an article in which the main vulnerabilities, causes, examples and solutions will be described. <br><br>  Some of the vulnerabilities in the list are already painted and more than once is a known fact, but without them the list would be incomplete.  Therefore, I will immediately give a small content of the post: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <a href="https://habr.com/ru/post/226321/">SQL Injection</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Incorrect authentication and session management</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Cross-site scripting (XSS)</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Insecure direct object links</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Insecure configuration</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Sensitive data leak</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Lack of access control to the functional level</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Cross-site request forgery (CSRF)</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Using components with known vulnerabilities</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Unvalidated Redirects</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Clickjacking</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Phishing</a> </li><li>  <a href="https://habr.com/ru/post/226321/">Include</a> </li></ul><a name="habracut"></a><a name="SQLInj"></a><br><h4>  1. SQL Injection </h4><br>  <a href="http://habrahabr.ru/search/%3Fq%3DSQL%2B%25D0%25B8%25D0%25BD%25D1%258A%25D0%25B5%25D0%25BA%25D1%2586%25D0%25B8%25D0%25B8">There is</a> plenty of <a href="http://habrahabr.ru/search/%3Fq%3DSQL%2B%25D0%25B8%25D0%25BD%25D1%258A%25D0%25B5%25D0%25BA%25D1%2586%25D0%25B8%25D0%25B8">material on the site</a> , I personally liked <a href="http://habrahabr.ru/post/148701/">this</a> article. <br><a name="NAUS"></a><br><h4>  2. Incorrect authentication and session management </h4><br>  By default, the identifier of the created session is saved in the browser‚Äôs cookie, except in cases when the browser‚Äôs cookies are disabled.  In this case, they will be automatically substituted into each URL by the server itself. <br><br><pre><code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">index</span></span>.php?PHPSESSID=jf843jgk4ogkfdjfgomg84o4og54mg</code> </pre> <br>  As you can see, the ID is transmitted in clear text, while with cookies it is hidden in the header of the HTTP request. <br>  For this, we have provided for setting a ban on session transfer via a URL: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">php</span></span>.ini session.use_trans_sid=0; session.use_only_cookies=1; .htaccess php_flag session.use_trans_sid <span class="hljs-literal"><span class="hljs-literal">Off</span></span> php_flag session.use_only_cookies <span class="hljs-literal"><span class="hljs-literal">On</span></span></code> </pre><br><h5>  Use encryption </h5><br>  If confidential information (money, wallet numbers, health status) is to be stored / transmitted on your site, then you should use encrypted protocols with an SSL certificate. <br>  When setting the cookie, set the sixth parameter to <i>secure</i> = <b>1</b> . <br><br><pre> <code class="php hljs">setcookie (<span class="hljs-string"><span class="hljs-string">'example'</span></span>, <span class="hljs-string"><span class="hljs-string">'content'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><br>  If you store the password in a $ _SESSION variable or database, then you should not store it in clear text.  It can only be a hash from it, or a ciphered version. <br><br>  Actually, it‚Äôs easy to steal a session ID from a URL, and a little more difficult to do it with cookies. <br><br><h5>  Ways of protection: </h5><br><ol><li>  Avoid sessions without cookies </li><li>  Avoid third-party server authentication solutions. </li><li>  Check IP </li><li>  For particularly important actions, request a password again </li><li>  SSL certificate </li><li>  Complete sessions on time and often enough </li></ol><br>  A reliable way is to store the IP in the session, and if it suddenly became different for some reason, stop outputting anything on the page, you can even forcibly end the session. <br><br>  However, there are drawbacks - the hacker and the user can sit at the firewall from the same IP, or the user can simply have a dynamic IP change right during the session. <br><br>  Using SSL means that all transmitted data, including cookies, will be encrypted, which makes direct hijacking impossible.  Minus - cookies can still be hijacked physically, so other methods of protection are also required. <br><br>  About the completion of sessions - their life time should be set to the minimum, and always have a button to exit the account on the site. <br><br>  Conclusion - this vulnerability is the second most common among web services, and using all of the above methods of struggle you can effectively protect clients from such hacking.  After all, it is enough for a hacker to have a session ID, and he no longer needs a password or username to appear in his image. <br><br><a name="XSS"></a><h4>  3. XSS </h4><br>  Exhaustive and wonderful article: <a href="http://habrahabr.ru/post/149152/">habrahabr.ru/post/149152</a> <br><br>  ... but from myself I would like to add something. <br><br><h6>  HTTP headers: </h6><br> <code>X-Content-Type-Options: nosniff</code> <br>  Blocks loading of scripts not confirmed by attribute.  (type = "text / javascript", type = "text / css") <br><br> <code>X-Frame-Options: DENY</code> <a name="XFrame"></a> <br>  Forbids to embed this page in iframe <br><br> <code>Strict-Transport-Security: max-age=expireTime</code> <br>  <s>Prohibit the download of anything over an unencrypted protocol (HTTP)</s> <br>  <b>BeLove comment</b> : <br><blockquote>  This header tells the browser that it is only necessary to work with the resource via HTTPS, i.e.  sent on the first redirect from HTTP to HTTPS (to exclude mitm over HTTP. Naturally, it does not protect if the resource is visited for the first time for the browser). </blockquote><br><br>  An important note regarding this and the previous topic is the httpOnly cookie. <br>  This standard was introduced a long time ago, but is forgotten or ignored by many.  It makes the following: makes cookies inaccessible by other means besides HTTP.  Its installation means that they can not be obtained by means of JavaScript. <br><br><pre> <code class="javascript hljs">alert(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.cookie);</code> </pre><br>  httpOnly is the <i>seventh</i> parameter of the setcookie () function in PHP. <br><br><a name="NPSO"></a><h4>  4. Insecure Direct Object Links </h4><br>  This vulnerability is manifested when the developer specifies a direct link to an internal object, such as a file, directory or database entry, as a parameter in the URL.  This allows an attacker to gain unauthorized access to the system by manipulating this parameter. <br><br>  Here it is easier to immediately give examples: <br><ul><li>  Direct link to a private photo in a closed album </li><li>  Open wallet number in GET request </li><li>  AJAX request-response by userID, which returns all user data in JSON, which are filtered on the client <i>(funny, I met myself)</i> </li><li>  Unclosed view / edit, for example, your profile.  In the example below, the user with ID 3 can go to the profile page ID 1, and edit it </li></ul><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">http</span></span>://site.com/profile/3 http://site.com/profile/1</code> </pre><br>  You can not just forget to check whether the user is in front of us or not. <br>  This also includes a simple protection for the number of incorrect password entry attempts. <br><br><a name="WrongConf"></a><h4>  5. Insecure configuration </h4><br>  Simply put, this is not enough or incorrectly configured server configuration file / PHP / ... <br>  These include: <br><ul><li>  Open logs </li><li>  Not closed development mode (open query profiling, stack trace) </li><li>  Open config.  Not main.php, for example, but main.inc </li><li>  Do not have admin / admin accounts.  Even on the router in the office. </li><li>  Open access to the images folder.  Closed with .htaccess or empty index.html </li><li>  And open folders like .git or .svn </li></ul><br>  Immunity will give: <br><ul><li>  Actual versions of software used (frameworks, libs) </li><li>  Less modules and plugins </li><li>  Closing all sorts of exceptions with skittles in order to avoid the reading of code fragments or even the files responsible for a particular operation. </li></ul><br>  Prevention - this includes setting different passwords on different areas (SSH, MySQL, backends, hoster panel) and their regular replacement <br>  Also, the application must have a strict architecture, where everyone understands - the project should not have the following: <br><blockquote>  And what is this folder that lies at the root of our third month? </blockquote><br><a name="UCD"></a><h4>  6. Leakage of sensitive data </h4><br>  As a rule, this vulnerability is already arising as a result of hacking the site, during which data was stolen that was easily readable. <br><br>  Vulnerability Test: <br><ul><li>  Do we have any data about money / wallet numbers / state of health in the database in the open form? </li><li>  Also, in what form is this data transmitted over the network? </li><li>  Are the software versions fresh? </li><li>  Is the encryption algorithm strong enough and is it updated frequently? </li></ul><br>  Example # 1: The application encrypts credit card numbers in the database using default encryption.  This means that when data is received, they can be quietly decoded again.  The information must be encrypted with handwritten methods using a single public key, and so that only special backend applications can decrypt it using their private key. <br><br>  Example # 2: A simple site that does not use SSL on all its pages.  It is enough that the certificate collapsed somewhere once, so that the attacker could steal the session ID while tracking data traffic. <br><br>  Example # 3: Store non-salted passwords in the database. <br><br>  It is recommended not to autocomplete such information, and not to cache pages with it. <br><br><a name="OKD"></a><h4>  7. Lack of access control to the functional level </h4><br>  The header implies restricted access to certain functions of the application. <br><br><ul><li>  Do not leave links for those who are not allowed to go there. </li><li>  Immunity will default on the withdrawal of access for everyone and from all - the principle of a white sheet and deny (*). </li><li>  Also, checking in important places of the code during the execution of an action will not interfere - when calling a function / method, put the check again. </li></ul><br>  This will also include the simplest vulnerability, such as selecting a URL for the admin and a response from this directory.  It‚Äôs bad if the hacker finds the admin folder and sees the login form.  In such cases, it is appropriate to close directories by IP, or by session and redirects. <br><br> <code>site.com/admin &lt; site.com/highlevel</code> <br> <br><a name="CSRF"></a><h4>  8. Cross-site request forgery (CSRF) </h4><br>  One of the most subtle types of vulnerabilities for developers.  Alone, as a rule, does not bear much harm, most often the damage from it can be felt in conjunction with other vulnerabilities (XSS, unvalidated redirects) <br><br>  In fact, this is my favorite method of hacking the site, and deserves a whole article with details, but what is it then speedr? <br>  I will give a link to a wonderful description of the hole on <a href="http://www.securitylab.ru/analytics/292473.php">securitylab.ru</a> <br><br><a name="xxx"></a><h4>  9. Using components with known vulnerabilities </h4><br>  Here everything is extremely simple, keep all connected parts of the project up to date, update to the latest stable versions, and not use any less popular or amateur modules.  If there is a choice - do not use them in principle. <br><a name="redir"></a><br><h4>  10. Unvalidated redirects </h4><br>  The bottom line is that users trusting your site can follow any links.  You often met a message like "You leave our site by clicking on the link ...", so this is nothing but the simplest protection from this kind of vulnerabilities.  An attacker can take advantage of this kind of redirects through your website to the pages he likes. <br><br><h5>  Prevention </h5><br><ul><li>  Do not abuse redirects. </li><li>  If you had to, do not use user data in the request (like success.php&amp;user_mail=eeee@eee.com) </li><li>  It is recommended to rewrite URLs by server means. </li></ul><br>  For example, instead of contacts.php? Act = index / site -&gt; contacts / index / site <br>  Such links are easier to validate. <br><br><a name="Clk"></a><h4>  11. Clickjacking </h4><br>  From the name - "hijacking clicks."  Above the attacker's website is a transparent iframe, with the help of the notorious <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BE%25D1%2586%25D0%25B8%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B8%25D0%25BD%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B5%25D1%2580%25D0%25B8%25D1%258F">social engineering, the</a> hacker forces the user to take several specific actions.  It seems to the user that he clicks the buttons / forms on one site, in fact everything is set up so that all actions are performed on the page inside the iframe.  This is achieved by creating the same coordinates of buttons / forms on the attacking site and the victim site. <br>  The peculiarity is that the user himself does not know that he enters the data "not there".  To prevent this, use the tag <code>X-Frame-Options: DENY</code> <a href="https://habr.com/ru/post/226321/">(see above)</a> , and a simple captcha or re-enter the password. <br><br><a name="fsh"></a><h4>  12. Phishing </h4><br>  Popular method to extract the username / password from the victim.  As a rule, E-Mail newsletters are sent to special victim databases, where the user, on behalf of this site, is prompted to proceed to the site. <br>  For example, instead of <i>yandex.ru</i> it will be <i>yandx.ru</i> , <i>uandex.ru</i> , <i>yandex.nk.me</i> and so on. <br>  Outwardly, it looks exactly the same as our website, on which the user is logged out.  Again, by any means soc.  engineering, the attacker asks the victim to log in (on his website), and simply receives a login / password.  As a rule, after entering something like an authorization error message is issued, and nothing else happens. <br><br>  Even browsers are now protected against phishing, as well as a large number of anti-viruses, but the problem remains relevant.  In order to avoid the ‚Äúrutania‚Äù of your users account, ask them to enter the password for particularly important operations (money transfer), or ask to confirm the account using SMS. <br><br><a name="Include"></a><h4>  13. PHP Include </h4><br>  Already, perhaps, unlisted method of capturing the site. <br>  It lies in the incorrect logic of the application, which allows you to connect any file on the server (with the <a href="https://habr.com/ru/post/226321/">wrong configuration</a> , again). <br><br>  In the address bar we see the query: <br> <code><a href="http://site.com/index.php%3Fp%3Dcontacts.php"></a> site.com/index.php?p=contacts.php</code> <br>  Already clearer clear, huh?  As a rule, something like the following is inside: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>($_GET[<span class="hljs-string"><span class="hljs-string">'file'</span></span>]); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  Then your imagination can play as long as you want: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">site</span></span>.com/index.php?file=../../etc/passwd<span class="hljs-number"><span class="hljs-number">%00</span></span> #   redc0de:     5.3.4 site.com/index.php?file=../apache/error.log #      &lt;?shell_exec($_GET['z'])?&gt; site.com/index.php?file=index.php #   site.com/index.php?file=images/2014/06/15/12.jpg #            </code> </pre><br>  To avoid many of these errors, remember that <b>GET</b> is only for receiving data, for everything else there is a <s>Master</s> <b>POST</b> . <br><br>  Most of the recommendations are taken <a href="https://www.owasp.org/index.php/Top_10_2013-Top_10">from here</a> , translated and supplemented by me. </div><p>Source: <a href="https://habr.com/ru/post/226321/">https://habr.com/ru/post/226321/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../226309/index.html">Declarative data binding in WinJS</a></li>
<li><a href="../226311/index.html">Steel printer</a></li>
<li><a href="../226313/index.html">The use of a homemade thermal imager based on the Arduino in the study of energy saving</a></li>
<li><a href="../226315/index.html">How the kernel manages memory</a></li>
<li><a href="../226317/index.html">Small network single board computer for 20 USD</a></li>
<li><a href="../226323/index.html">Waterfall and Agile: and yet, where does the effect come from?</a></li>
<li><a href="../226325/index.html">An interesting task for the interview, currying and partial application of the function</a></li>
<li><a href="../226327/index.html">What should "PHP Junior Developer without experience" know?</a></li>
<li><a href="../226329/index.html">Apple Metal API: what's the trick?</a></li>
<li><a href="../226331/index.html">Setting up a remote interpreter on Pycharm for Django</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>