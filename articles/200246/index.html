<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Serialization of Judy integer arrays in PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you know, a variable in PHP is not only valuable data, but a whole zval container. And the array of such variables takes up too much space in the m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Serialization of Judy integer arrays in PHP</h1><div class="post__text post__text-html js-mediator-article">  As you know, a variable in PHP is not only valuable data, but a whole zval container.  And the array of such variables takes up too much space in the memory. <br>  In PHP, there is an implementation of <a href="http://php.net/manual/en/intro.judy.php">Judy</a> arrays ‚Äî fast, associative, and consuming an order of magnitude less memory.  But, unfortunately, there are no serialization / deserialization methods for them. <br><a name="habracut"></a><br>  I was interested in the serialization of only integer arrays, i.e.  as the array index, and its value only integers.  I implemented it by adding the necessary methods to the source code of the extension.  The principle of serialization is simple: <br>  The array (200 =&gt; 0, 300 =&gt; -5000, -100 =&gt; 2000) turns into a string <br>  "+ c8 + 0 + 12c-1388-64 + 7d0" <br><br>  There are two places where you can get the source: <br><ul><li>  <a href="http://pecl.php.net/package/judy">pecl.php.net/package/judy</a> </li><li>  <a href="https://github.com/orieg/php-judy">github.com/orieg/php-judy</a> </li></ul><br>  Was selected the second.  All changes are made in php_judy.c <br>  The bold lines show the added lines. <br><br><ol><li>  We declare serialization support: <br> <code>/* implements some interface to provide access to judy object as an array */ <br> zend_class_implements(judy_ce TSRMLS_CC, 1, zend_ce_arrayaccess, zend_ce_iterator); <br></code> <br> <b><code>zend_class_implements(judy_ce TSRMLS_CC, 1, zend_ce_serializable); <br></code></b> <br> <code>judy_ce-&gt;ce_flags |= ZEND_ACC_FINAL_CLASS; <br></code> <br></li><li>  We declare methods: <br> <code>PHP_METHOD(judy, memoryUsage);</code> <br> <b><code>PHP_METHOD(judy, serialize);</code> <br> <code>PHP_METHOD(judy, unserialize);</code></b> <br> <code>PHP_METHOD(judy, count);</code> <br> </li><li>  Input parameters for unserialize: <br><pre> <code class="php hljs">ZEND_BEGIN_ARG_INFO_EX(arginfo_judy_unserialize, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) ZEND_ARG_INFO(<span class="hljs-number"><span class="hljs-number">0</span></span>,str) ZEND_END_ARG_INFO()</code> </pre><br></li><li>  Descriptions of visible methods: <br> <code>PHP_ME(judy, memoryUsage, NULL, ZEND_ACC_PUBLIC)</code> <br> <b><code>PHP_ME(judy, serialize, NULL, ZEND_ACC_PUBLIC)</code> <br> <code>PHP_ME(judy, unserialize, arginfo_judy_unserialize, ZEND_ACC_PUBLIC)</code></b> <br> <code>PHP_ME(judy, count, arginfo_judy_count, ZEND_ACC_PUBLIC)</code> <br> </li><li>  The methods themselves and one auxiliary function: <br><pre> <code class="php hljs">PHP_METHOD(judy, serialize) { JUDY_METHOD_GET_OBJECT <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( intern-&gt;type == TYPE_INT_TO_INT ) { long int index = <span class="hljs-number"><span class="hljs-number">0</span></span>, i = <span class="hljs-number"><span class="hljs-number">0</span></span>, l; long int * PValue; char * s; Word_t idx1 = <span class="hljs-number"><span class="hljs-number">0</span></span>, idx2 = <span class="hljs-number"><span class="hljs-number">-1</span></span>, Rc_word; JLC(Rc_word, intern-&gt;array, idx1, idx2); l = <span class="hljs-number"><span class="hljs-number">64</span></span> + ( Rc_word &lt;&lt; <span class="hljs-number"><span class="hljs-number">3</span></span> ); s = emalloc ( l ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( s == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> ) RETURN_NULL(); JLF ( PValue, intern-&gt;array, index ); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( PValue != <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> &amp;&amp; PValue != PJERR ) { JLG ( PValue, intern-&gt;array, index ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( index &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( *PValue &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ) sprintf ( s+i, <span class="hljs-string"><span class="hljs-string">"-%x-%x"</span></span>, -index, -*PValue ); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> sprintf ( s+i, <span class="hljs-string"><span class="hljs-string">"-%x+%x"</span></span>, -index, *PValue ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( *PValue &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ) sprintf ( s+i, <span class="hljs-string"><span class="hljs-string">"+%x-%x"</span></span>, index, -*PValue ); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> sprintf ( s+i, <span class="hljs-string"><span class="hljs-string">"+%x+%x"</span></span>, index, *PValue ); } i += strlen ( s+i ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( i &gt; l - <span class="hljs-number"><span class="hljs-number">50</span></span> ) { l &lt;&lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; s = erealloc ( s, l ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( s == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> ) RETURN_NULL(); } JLN ( PValue, intern-&gt;array, index ); } *(s+i) = <span class="hljs-number"><span class="hljs-number">0</span></span>; RETURN_STRING ( s, <span class="hljs-number"><span class="hljs-number">0</span></span> ); } RETURN_NULL(); } long int Hex2Int ( char * s, long int * j, long int l ) { long int v = <span class="hljs-number"><span class="hljs-number">0</span></span>; char sym; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( s[*j] == <span class="hljs-string"><span class="hljs-string">'+'</span></span> ) { (*j)++; sym = s[*j]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( sym != <span class="hljs-string"><span class="hljs-string">'+'</span></span> &amp;&amp; sym != <span class="hljs-string"><span class="hljs-string">'-'</span></span> &amp;&amp; *j &lt; l ) { v &lt;&lt;= <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (( sym &gt;= <span class="hljs-string"><span class="hljs-string">'0'</span></span> ) &amp;&amp; ( sym &lt;= <span class="hljs-string"><span class="hljs-string">'9'</span></span> )) v += ( sym - <span class="hljs-string"><span class="hljs-string">'0'</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> v += ( sym - <span class="hljs-string"><span class="hljs-string">'a'</span></span> + <span class="hljs-number"><span class="hljs-number">10</span></span> ); (*j)++; sym = s[*j]; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { (*j)++; sym = s[*j]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( sym != <span class="hljs-string"><span class="hljs-string">'+'</span></span> &amp;&amp; sym != <span class="hljs-string"><span class="hljs-string">'-'</span></span> &amp;&amp; *j &lt; l ) { v &lt;&lt;= <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (( sym &gt;= <span class="hljs-string"><span class="hljs-string">'0'</span></span> ) &amp;&amp; ( sym &lt;= <span class="hljs-string"><span class="hljs-string">'9'</span></span> )) v -= ( sym - <span class="hljs-string"><span class="hljs-string">'0'</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> v -= ( sym - <span class="hljs-string"><span class="hljs-string">'a'</span></span> + <span class="hljs-number"><span class="hljs-number">10</span></span> ); (*j)++; sym = s[*j]; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v; } PHP_METHOD(judy, unserialize) { JUDY_METHOD_GET_OBJECT intern-&gt;counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; intern-&gt;type = TYPE_INT_TO_INT; intern-&gt;array = (Pvoid_t) <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; char * s; long int l, j = <span class="hljs-number"><span class="hljs-number">0</span></span>; Word_t * PValue, index, value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, <span class="hljs-string"><span class="hljs-string">"s"</span></span>, &amp;s, &amp;l) == FAILURE) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( l &lt; <span class="hljs-number"><span class="hljs-number">4</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( j &lt; l ) { index = Hex2Int ( s, &amp;j, l ); value = Hex2Int ( s, &amp;j, l ); JLI ( PValue, intern-&gt;array, index ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( PValue == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> || PValue == PJERR ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; *PValue = value; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; }</code> </pre><br></li><li>  Compile: <br><pre> <code class="bash hljs">phpize ./configure make make install</code> </pre><br></li><li>  Do not forget to register in php.ini <br> <code>extension=judy.so</code> <br> </li></ol><br><h5>  A small test \ benchmark </h5><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitArray</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( &amp;$ar, $init_srand, $max )</span></span></span><span class="hljs-function"> </span></span>{ srand ( $init_srand ); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( $i = -$max; $i &lt; $max; $i++ ) { $index = rand ( -$max, $max ); $value = rand ( <span class="hljs-number"><span class="hljs-number">-1000</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span> ); $ar[$index] = $value; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShowTime</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $st, $text )</span></span></span><span class="hljs-function"> </span></span>{ printf ( <span class="hljs-string"><span class="hljs-string">"$text in %.2f sec.\n"</span></span>, microtime ( <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ) - $st ); } $init_srand = time (); $max = <span class="hljs-number"><span class="hljs-number">500000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"srand = $init_srand, max = $max\n"</span></span>; $init_mem = memory_get_usage(); $st = microtime ( <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); $a = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> (); InitArray ( $a, $init_srand, $max ); ShowTime ( $st, <span class="hljs-string"><span class="hljs-string">"Initialized std. array"</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Elements in std. array: "</span></span> , count ( $a ) , <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Used memory: "</span></span> , (memory_get_usage()-$init_mem) , <span class="hljs-string"><span class="hljs-string">" bytes\n\n"</span></span>; $st = microtime ( <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); $j = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Judy(Judy::INT_TO_INT); InitArray ( $j, $init_srand, $max ); ShowTime ( $st, <span class="hljs-string"><span class="hljs-string">"Initialized Judy array"</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Elements in Judy array: "</span></span> , count ( $j ) , <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Used memory: "</span></span> , $j-&gt;memoryUsage() , <span class="hljs-string"><span class="hljs-string">" bytes\n\n"</span></span>; $st = microtime ( <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); $a_ser = serialize ( $a ); ShowTime ( $st, <span class="hljs-string"><span class="hljs-string">"Serialized std. array"</span></span> ); $st = microtime ( <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); $j_ser = serialize ( $j ); ShowTime ( $st, <span class="hljs-string"><span class="hljs-string">"Serialized Judy array"</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Serialized std. length: "</span></span> , strlen ( $a_ser ) , <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Serialized Judy length: "</span></span> , strlen ( $j_ser ) , <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>; $st = microtime ( <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); $a_unser = unserialize ( $a_ser ); ShowTime ( $st, <span class="hljs-string"><span class="hljs-string">"Unserialized std. array"</span></span> ); $st = microtime ( <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); $j_unser = unserialize ( $j_ser ); ShowTime ( $st, <span class="hljs-string"><span class="hljs-string">"Unserialized Judy array"</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count ( $j_unser ) != count ( $a )) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span> ( <span class="hljs-string"><span class="hljs-string">"ERROR: arrays size mismatch\n"</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ( $a <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $index =&gt; $value ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( $j_unser[$index] != $value ) { <span class="hljs-keyword"><span class="hljs-keyword">die</span></span> ( <span class="hljs-string"><span class="hljs-string">"ERROR: arrays data mismatch\n"</span></span> ); } } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"OK: std. array and unserialized Judy array are identical\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the output we get <br><pre> <code class="bash hljs">srand = 1348822174, max = 500000 Initialized std. array <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.76 sec. Elements <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> std. array: 632067 Used memory: 49703784 bytes Initialized Judy array <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.98 sec. Elements <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Judy array: 632067 Used memory: 3247108 bytes Serialized std. array <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.33 sec. Serialized Judy array <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.18 sec. Serialized std. length: 9904186 Serialized Judy length: 6061744 Unserialized std. array <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.13 sec. Unserialized Judy array <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.08 sec. OK: std. array and unserialized Judy array are identical</code> </pre><br><h5>  A couple of notes </h5><ol><li>  Of course, you can change the algorithm for allocating memory for a string with serialized data. </li><li>  Currently, there is a bug in the foreach iterator implementation for Judy: <br>  If the array simultaneously contains indices 0 and -1, then foreach enters an infinite loop. <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $j = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Judy(Judy::INT_TO_INT); $j[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">456</span></span>; $j[<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-number"><span class="hljs-number">123</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ( $j <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $index =&gt; $value ) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"$index $value\n"</span></span>; } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  The query <a href="https://github.com/orieg/php-judy/issues/3">‚Äúforeach [0] [-1]‚Äù was created</a> .  If desired, it is easily corrected. <br></li></ol><br><br>  <b>PS</b> This post was written over a year ago - in September 2012 and all this time was lying in the sandbox.  As I have just found out, serialization has been implemented on a githaba in a separate thread 3 months ago. <br><blockquote>  So I went ahead and I‚Äôve gotten the negative keys support in the process. </blockquote>  . <br>  <a href="https://github.com/orieg/php-judy/issues/13">github.com/orieg/php-judy/issues/13</a> <br>  <a href="https://github.com/tony2001/php-judy/tree/serialize">github.com/tony2001/php-judy/tree/serialize</a> </div><p>Source: <a href="https://habr.com/ru/post/200246/">https://habr.com/ru/post/200246/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../200232/index.html">COLT 1.2.4 released with LESS / SASS support, CoffeeScript</a></li>
<li><a href="../200234/index.html">Cisco will release the open source implementation of H.264, which will be included in Firefox</a></li>
<li><a href="../200236/index.html">Children's launcher and parental control</a></li>
<li><a href="../200238/index.html">We use the tablet as a second monitor to develop</a></li>
<li><a href="../200244/index.html">Using Docker Containers as Jenkins Nod</a></li>
<li><a href="../200248/index.html">Designing a secure messaging application together.</a></li>
<li><a href="../200252/index.html">Counts for the smallest: BFS</a></li>
<li><a href="../200254/index.html">Vertica again on HighLoad ++</a></li>
<li><a href="../200256/index.html">Candid photos of Jennifer Lawrence and dozens of other celebrities leaked through iCloud</a></li>
<li><a href="../200260/index.html">We extend security updates for Windows XP for another 5 years.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>