<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The first step to hardware accelerators of neural networks for programmers is through learning the basics of HDL, RTL and a lab on FPGA</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kazan University Innopolis as an experiment teaches computer programmers how to develop hardware. Moreover, the development of a hardware means not pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The first step to hardware accelerators of neural networks for programmers is through learning the basics of HDL, RTL and a lab on FPGA</h1><div class="post__text post__text-html js-mediator-article"> Kazan University Innopolis as an experiment teaches computer programmers how to develop hardware.  Moreover, the development of a hardware means not programming microcontrollers inside, say robots, but designing digital circuits at the register transfer level (RTL), using hardware description languages ‚Äã‚Äã(HDL) and laboratory classes on programmable logic integrated circuits (FPGA / FPGA - Field Programmable Gate Array). <br><br>  Why do programmers need it?  After all, electronics is taught at (much less popular) electronics departments, where a student first studies the physics of electricity, analog circuits, makes a couple of labs with multiplexers, after which all of this is forgotten and goes to work as a programmer. <br><br>  One of the reasons why digital circuitry is for a programmer is the recent boom of neural networks.  If you want complex network training to take not weeks / days / hours, but hours / minutes / seconds, you cannot do without hardware accelerators.  Only a specialized hardware will perform in parallel a large number of small precision multiplications with simultaneous transactions to the ocean of memory.  In the future, we are waiting for specialized ASIC (application-specific integrated circuits) for AI, and everywhere.  They will have both a traditional processor and large AI blocks on board, with the possibility of partial reconfiguration. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      From Google and Microsoft to Skolkovo and Innopolis, there is a growing understanding that we need specialists who can build such co-processors.  They should own a hardware microarchitecture, along with an understanding of the software ecosystem and algorithms.  And possession of micro-architecture is based on understanding the level of register transfers.  How it is implemented now in Innopolis: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f73/db2/08c/f73db208c1c0042cf63736e8b9522acd.png"><br><a name="habracut"></a><br>  The course of computer architecture in Innopolis is developed by his rector Alexander Tormasov, along with foreign specialists invited to Kazan: Italian professor Giancarlo Succi, who works as a dean in Innopolis, and Muhammad Fahim, who before Innopolis worked at universities in South Korea and Pakistan. <br><br>  Rector Tormasov before Innopolis worked as the head of the department of computer science at MIPT and headed the advanced development department of SWsoft (later Parallels), where he was engaged in virtualization.  Paralells is one of the few Russian companies widely known in America - at least a couple of American engineers were surprised when I told them that Parallels is a Russian company, they thought it was an American company.  In addition, Tormasov heads the Russian branch of the IEEE Computer Society. <br><br>  Tormasov liked to introduce all sorts of newfangled things 30 years ago - then he taught MIPT students how to use Unix, shell, awk, etc.  Linux was not there yet, and Unix was on Australian Labtam computers with a National Semicondustor NS32000 processor.  Before Tormasov, students worked on BESM-6 with FORTRAN and punched cards. <br><br>  So, recently Tormasov asked me to skype a couple of lectures on HDL, RTL and FPGA for his computer architecture course.  He has more than 200 students attending these lectures, so the experiment has a good sample.  Lectures Tormasov asked to read in English, apparently because 1) there are foreign students in Innopolis 2) Giancarlo Succi and Muhammad Fahim also read English and 3) students need to train comprehension, including my heavy Ukrainian accent. <br><br>  The purpose of the first lecture was to give students enough information so that they could simulate the simplest scheme on a software simulator, as well as synthesize this scheme and configure the FPGA with it.  It was also necessary to visually show that the scheme is not a program: <br><br>  <a href="http://www.silicon-russia.com/public_materials/2018_01_29_yuri_panchul_intro_to_rtl_1_innopolis/yuri_panchul_intro_to_rtl_1_innopolis_2018_01_29.pdf">Slides of the first lecture in PDF format.</a> <br><br>  The purpose of the second lecture was to give an overview of what awaits them if they want to dig deeper into the topic of digital logic.  They need to understand the concept of a D-flip-flop, sequential logic, a finite state machine, and a pipeline.  Then they can make interesting schemes that repeat actions, transmit information from sensors, etc.  - right up to the processor cores and beyond. <br><br>  <a href="http://www.silicon-russia.com/public_materials/2018_02_14_yuri_panchul_intro_to_rtl_2_innopolis/yuri_panchul_intro_to_rtl_2_innopolis_2018_02_14.pdf">Slides of the second lecture in PDF format.</a> <br><br>  Several key slides.  The difference between schemes and programs.  Programming languages ‚Äã‚Äã(for example, C) are compiled into chains of instructions that the processor selects from memory.  Hardware description languages ‚Äã‚Äã(for example, Verilog) are synthesized into a graph from logical elements, which ultimately turn into transistors and tracks on a microcircuit, which is baked at the factory: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e5b/79b/342/e5b79b34253aad82965c09fe3f8c8181.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/820/684/f58/820684f5887cc8156862a6d56f1e6b95.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/786/9e8/06d/7869e806de8a80c463478e1d929b6f0e.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5d6/c01/a46/5d6c01a467362b3a78129ca0686943e6.png"><br><br>  How the FPGA / FPGA works - a matrix of logic elements, the function of which can be changed using multiplexers connected to the bits of the configuration memory: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/50b/82c/fa5/50b82cfa530e791cddd109a4852604db.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/9e7/bb4/1d0/9e7bb41d0833e73ed8904241baf32c2c.png"><br><br>  The simplest scheme.  Combination logic - we put some data on the input, after some time (with a propagation delay) we get the answer at the output. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b71/905/7de/b719057de2564a4b084fbde80400fd9c.png"><br><br>  The Huffman model is convenient for introducing sequential logic.  Combination logic connects to registers - memory elements. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/48d/261/893/48d261893298aee5899de2856f0d3e99.png"><br><br>  Sequential logic allows computing devices to do non-trivial things.  Without it, only on combinational logic, we could only calculate tables of functions, the values ‚Äã‚Äãof which are uniquely determined from the arguments.  Sequential logic adds a current state to the schema, as a result of which we can count, wait for events, repeat operations based on old and new data, etc.  Here I refer to the ‚ÄúChinese room‚Äù - a popular paradox that emerges when discussing the topic ‚ÄúCan a car think?‚Äù The Chinese room is in fact one of the implementations of the Huffman model, the generalization of the finite state machine: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/565/9b7/925/5659b7925a2365066c828a0675d9b102.png"><br><br>  The main concept that you need to understand in the introductory course of digital circuitry is the function of the D-flip-flop, the basic state element.  If the logical elements AND-OR-NOT can, in principle, be explained even to children in kindergarten, then with D-triggers, students have a mental barrier.  And not only among schoolchildren, but also programmers with experience who are prevented from understanding digital logic by the mental model of program execution as chains of instructions that have firmly grown into their brains.  Instead, you need to use a mental model in which many events occur simultaneously, for example, simultaneous recording of thousands or millions of D-flip-flops. <br><br>  A D-flip-flop is a device that stores 1 bit of information during one clock cycle.  It has three main external signals - a clock signal (clock, CLK), an input for recording (D) and an output for reading (Q).  At the output Q, the stored state of the D-flip-flop is output, and the D-flip-flop ignores the input D for almost the entire cycle.  Input D is recorded in the current state during a short blink of the aperture (aperture), when the clock signal CLK changes from zero to one.  By the time of the aperture, when the clock frequency is correctly selected, at the input of the D-flip-flop there is a settled calculation result of the combinational logic.  Until that moment, any garbage may be at the entrance, since the calculations in the equipment do not occur instantaneously. <br><br>  From D-triggers are built registers, storage for sets in several bits.  At the output of the register, the whole cycle is the value written to it in the previous cycle.  If you put the registers one by one, the output from this combination will be the value from the previous-previous cycle: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2c7/43f/6d8/2c743f6d8b37ebe3678545d305f64e4f.png"><br><br>  If you combine the combinational adder and register, you get a counter.  In this animation, X means ‚Äúuntapped value‚Äù.  The frequency of the clock signal is chosen so that writing to the register takes place when the addition with the unit is guaranteed to end, and you need to write the amount into the register.  This amount will be used as one of the following in the following cycle: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f50/2d4/47e/f502d447e1f13078e82f6fa4738c1d47.gif"><br><br>  Then there are slides about the state machines that I made on the basis of the Digital Circuit Design and Computer Architecture books.  David M. Harris, Sarah L. Harris.  And then a few slides about the principle of conveyor processing. <br><br>  Conveyor is one of the key concepts of modern digital electronics development.  The pipeline arises not only in the design of the processor (execution pipe), but also in anything: in the design of the arithmetic unit, in the block for transactions to the memory, in the processing of packets inside the router chip, and in the shaders for three-dimensional graphics.  The easiest way to explain the basic idea of ‚Äã‚Äãa pipeline is by the example of an arithmetic unit, for example, a block for exponentiation. <br><br>  We take some operation that can be divided into several successive steps.  Now, instead of performing all the steps in one cycle, we put registers between the steps.  Although now the operation is performed not in one cycle, but in several, but: <br><br>  1) the circuit can operate at a higher clock frequency; <br>  2) while the operands for the new calculation can be fed to the input immediately after the first cycle of the previous calculation, without waiting for the end of all cycles of the previous calculation; <br>  3) therefore, the total capacity of the block will be higher than that of the block in which the calculations are performed in one cycle: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c8b/696/554/c8b6965544ec46595ca1053f7c9a849c.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c9/9e1/4d1/1c99e14d13c500ddca06913c32f43b1f.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/137/005/f9b/137005f9b3886d318b9bb263ba3ce200.png"><br><br>  Video of the second lecture: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Kvl6NSJY42k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Now about the boards for laboratory work.  Since the course was only introduced as an experiment, the budget for the FPGA board in Innopolis was not allocated.  I lent Innopolis 10 fees that I bought for my money, but there is a catastrophic shortage of fees (there are 210 students in the course).  ‚ÄúGive more circuit boards!‚Äù Is the most frequent feedback from students on labs with FPGA. <br><br>  In principle, teachers are distributed by Intel / Altera boards, less frequently by Xilinx, but in small quantities.  Universities buy fees from Xilinx and Altera and for their money, but quite often this is due to bureaucracy and red tape.  Kiev Polytechnic Institute in the face of Yevgeny Korotky recently bought FPGA boards for a grant from the Kiev municipality to train FPGA schoolchildren.  Zelenograd enterprise Elvis-NeoTek, Moscow company NauTech, St. Petersburg Macro Group and California MIPS allocated FPGA boards to universities for educational needs (MSU, MIET, ITMO, MEI, KPI, and others).  But in order to update all programs in central and regional universities and make RTL understanding part of general education in high-tech (as it is done in American universities and as Chinese people in China do it quickly), you need two orders of magnitude more fees.  On the one hand, this is a problem, but on the other hand, the opportunity for regional companies and individuals to engage in charity work in relation to their local universities and physical education schools.  Mass ownership of these technologies can have far-reaching consequences for Russia and other countries in the region - something like the introduction of computer science in Soviet schools in 1985 led to Yandex and other developed Russian software companies in the 21st century. <br><br>  Virtually any boards (Xilinx, Altera, Lattice, etc.) are suitable for basic exercises in the development of digital logic at the register transfer level. In Innopolis, we are now using the Terasic DE10-Lite board.  It is inexpensive and is suitable even for the synthesis of small industrial processor cores (if you want to experiment with this, this is the next level): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/873/5f9/326/8735f9326be81d4eb3024af5317a1f99.png"><br><br>  But if you buy hundreds of motherboards in the conditions of lack of money, then one of the solutions is to take payments from Ali Express with not the latest FPGAs.  True, for some of them, it will be necessary to use not the latest version of software for synthesis, but by and large it does not matter.  Also, they are not the most convenient switches and they are few, but they cost around twenty dollars (thousands of rubles).  For Intel / Altera FPGA boards, you need a USB Blaster adapter, and it‚Äôs better to buy it separately - some USB Blaster on AliExpress work with the latest Intel Quartus software, version 17.1, but others are only compatible with 2013 version 13.0sp1. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bff/2fc/744/bff2fc744becd91be89bb3317d7e358b.png"><br><br>  Even cheaper is to buy FPGA boards without peripherals.  This can be interesting for schoolchildren, especially if they have all kinds of sensors, range finders, LED arrays, speakers and other devices that can be connected to the FPGA board and make attractive projects on it.  For schoolchildren, it may be interesting to do the same project first with chips of a small degree of integration, then with FPGA, then with a microcontroller. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fad/924/ea4/fad924ea478c42251c5857cbee58740b.png"><br><br>  Finally, in addition to Terasic, Digilent and other Asian, American and European manufacturers of motherboards, there are also Russian ones: the Mars rover and the FPGA manufacturing plant in Voronezh.  On the site of the Rover there are quite good instructions for educational projects.  They can develop into one of the centers of the Russian community in this area.  FPGAs from Voronezh are expensive, but if the Voronezh plant distributes them to universities, then you can also do all these exercises on them. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/050/12c/f60/05012cf60d35de4df3b808c43c6932b8.png"></div><p>Source: <a href="https://habr.com/ru/post/349750/">https://habr.com/ru/post/349750/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349740/index.html">On the use of person (characters) users in product development</a></li>
<li><a href="../349742/index.html">Game development for NES in C. Chapters 14-16. Working with sound</a></li>
<li><a href="../349744/index.html">How to make a recognizable and memorable logo</a></li>
<li><a href="../349746/index.html">Design should be for people, not for designers</a></li>
<li><a href="../349748/index.html">Database Reliability Engineering Book Review</a></li>
<li><a href="../349752/index.html">Get started with Google Go in Azure</a></li>
<li><a href="../349754/index.html">Security Week 5: Literacy at the expense of security; mining at the highest level; site is not for people</a></li>
<li><a href="../349756/index.html">Asynchronous circuits. Calculation of logical functions directly on the event graph. Part 1</a></li>
<li><a href="../349758/index.html">Linux in one file for Macbook</a></li>
<li><a href="../349760/index.html">Bylina about how I worked in a startup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>