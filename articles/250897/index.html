<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Konva.js - HTML5 2d canvas framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings. Introducing the community project Konva.js . 

 Konva.js is a framework that allows you to work on canvas 2d in object style with event sup...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Konva.js - HTML5 2d canvas framework</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/004/251/e36/004251e3628f32af82302dccf625aa0e.png" alt="image"><br><br>  Greetings.  Introducing the community project <a href="http://konvajs.github.io/">Konva.js</a> . <br><br>  Konva.js is a framework that allows you to work on canvas 2d in object style with event support. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Briefly, the list of features looks like this: <br><ol><li>  Object API </li><li>  Nested objects and ‚Äúascent‚Äù of events </li><li>  Support for multiple layers (multiple canvas elements) </li><li>  Object caching </li><li>  Animation support </li><li>  Customizable drag &amp; drop </li><li>  Filters </li><li>  Ready-to-use objects, including rectangle, circle, image, text, line, SVG path, .. </li><li>  Easy creation of your own shapes </li><li>  Event architecture that allows developers to subscribe to event changes in attributes, drawing, and so on </li><li>  Serialization and deserialization </li><li>  Advanced search using stage.get ('# foo') and layer.get ('. Bar') selectors </li><li>  Desktop and Mobile Events </li><li>  Built-in support for HDPI devices </li><li>  and many more </li></ol><br><br>  Next, we will take a closer look at the capabilities of the framework with code examples. <br><a name="habracut"></a><br><h2>  Introduction </h2><br>  It all starts with a Stage, which combines custom layers (Layer). <br>  Each layer (Layer) is one canvas element on a page and can contain shapes, groups of shapes, or groups of groups. <br><br>  Each element can be stylized and transformed. <br><br>  Once you have configured the Stage and layers, added shapes, you can subscribe to events, change the properties of the elements, start the animation, create filters. <br><br>  Minimum code example <a href="http://konvajs.github.io/downloads/code/shapes/Circle.html">[Result]</a> : <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    var stage = new Konva.Stage({ container: 'container', //  div  width: 500, height: 500 }); //    var layer = new Konva.Layer(); //   var circle = new Konva.Circle({ x: stage.width() / 2, y: stage.height() / 2, radius: 70, fill: 'red', stroke: 'black', strokeWidth: 4 }); //     layer.add(circle); //   stage.add(layer);</span></span></code> </pre> <br><br><img src="https://habrastorage.org/files/728/fee/6ff/728fee6ff8c14f6b965f8ba5bbc27cb4"><br><br><h2>  Basic shapes </h2><br>  Konva.js supports the following shapes: rectangle (Rect), circle (Circle), oval (Ellipse), line (Line), image (Image), text (Text), text path (TextPath), star (Star), label ( Label), svg path (Path), regular polygon (RegularPolygon).  You can also create <a href="http://konvajs.github.io/docs/shapes/Custom.html">your own shape</a> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> triangle = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Konva.Shape({ <span class="hljs-attr"><span class="hljs-attr">drawFunc</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) </span></span>{ context.beginPath(); context.moveTo(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>); context.lineTo(<span class="hljs-number"><span class="hljs-number">220</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>); context.quadraticCurveTo(<span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">260</span></span>, <span class="hljs-number"><span class="hljs-number">170</span></span>); context.closePath(); <span class="hljs-comment"><span class="hljs-comment">//   KonvaJS context.fillStrokeShape(this); }, fill: '#00D2FF', stroke: 'black', strokeWidth: 4 });</span></span></code> </pre><br><br><img src="https://habrastorage.org/files/71f/19c/135/71f19c135c3645a6a16f6843c5e75546"><br><br><h2>  Styles </h2><br>  Each shape supports the following style properties: <br><ul><li>  Fill (fill) - supports solid color, gradients and images </li><li>  Contour (stroke, strokeWidth) </li><li>  Shadow (shadowColor, shadowOffset, shadowOpacity, shadowBlur) </li><li>  Transparency (opacity) </li></ul><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pentagon = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Konva.RegularPolygon({ <span class="hljs-attr"><span class="hljs-attr">x</span></span>: stage.getWidth() / <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: stage.getHeight() / <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">sides</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">radius</span></span>: <span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-attr"><span class="hljs-attr">stroke</span></span>: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, <span class="hljs-attr"><span class="hljs-attr">strokeWidth</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">shadowOffsetX</span></span> : <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-attr"><span class="hljs-attr">shadowOffsetY</span></span> : <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-attr"><span class="hljs-attr">shadowBlur</span></span> : <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-attr"><span class="hljs-attr">opacity</span></span> : <span class="hljs-number"><span class="hljs-number">0.5</span></span> });</code> </pre><br><br>  Result: <br><br><img src="https://habrastorage.org/files/642/01e/a70/64201ea709ef4f2c85e6f3c60e5e76da"><br><br><h2>  Developments </h2><br>  Using Konva.js, you can easily subscribe to input events (click, dblclick, mouseover, tap, dbltap, touchstart, and so on), attribute change events (scaleXChange, fillChange), and drag &amp; drop events (dragstart, dragmove, dragend) . <br><br><pre> <code class="javascript hljs">circle.on(<span class="hljs-string"><span class="hljs-string">'mouseout touchend'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'user input'</span></span>); }); circle.on(<span class="hljs-string"><span class="hljs-string">'xChange'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'position change'</span></span>); }); circle.on(<span class="hljs-string"><span class="hljs-string">'dragend'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'drag stopped'</span></span>); });</code> </pre><br><br>  <a href="http://konvajs.github.io/docs/events/Binding_Events.html">Work code + demo</a> <br><br><h2>  DRAG AND DROP </h2><br>  Frameworks has built-in drag support.  At the moment there is no support for drop events (drop, dragenter, dragleave, dragover), but they are quite simply implemented <a href="http://konvajs.github.io/docs/drag_and_drop/Drop_Events.html">by the framework</a> . <br><br>  In order to drag an element, it is enough to set the properties draggable = true. <br><br><pre> <code class="javascript hljs">shape.draggable(<span class="hljs-string"><span class="hljs-string">'true'</span></span>);</code> </pre><br><br>  At the same time, you can subscribe to drag &amp; drop events and set movement restrictions.  <a href="http://konvajs.github.io/docs/drag_and_drop/Complex_Drag_and_Drop.html">[Demo]</a> . <br><br><h2>  Filters </h2><br>  Konva.js includes many filters: blur, inversion, sepia, noise and so on.  A complete list of available filters can be found in the <a href="http://konvajs.github.io/api/Konva.Filters.html">filters documentation API</a> . <br><br>  Filter example: <br><br><pre> <code class="javascript hljs">image.cache(); image.filters([Konva.Filters.Invert]);</code> </pre><br><img src="https://habrastorage.org/files/356/11a/e29/35611ae2923b49a2bca20a0efc4754ab"><br><br><h2>  Animation </h2><br>  You can create an animation in two ways: <br><br>  1. Through the object "Animation": <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> anim = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Konva.Animation(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">frame</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> time = frame.time, timeDiff = frame.timeDiff, frameRate = frame.frameRate; <span class="hljs-comment"><span class="hljs-comment">// update stuff }, layer); anim.start();</span></span></code> </pre><br>  <a href="http://konvajs.github.io/docs/animations/Moving.html">[Demo]</a> <br><br>  2. Through the ‚ÄúTween‚Äù object: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tween = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Konva.Tween({ <span class="hljs-attr"><span class="hljs-attr">node</span></span>: rect, <span class="hljs-attr"><span class="hljs-attr">duration</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">x</span></span>: <span class="hljs-number"><span class="hljs-number">140</span></span>, <span class="hljs-attr"><span class="hljs-attr">rotation</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.PI * <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">opacity</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">strokeWidth</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> }); tween.play();</code> </pre><br>  <a href="http://konvajs.github.io/docs/tweens/Linear_Easing.html">[Demo]</a> <br><br><h2>  Selectors </h2><br>  When building a large application, it is extremely convenient to use the search by created elements.  Konva.js allows you to search for objects using selectors using the methods find (returns a collection) and findOne (returns the first element of a collection): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> circle = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Konva.Circle({ <span class="hljs-attr"><span class="hljs-attr">radius</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-attr"><span class="hljs-attr">id</span></span> : <span class="hljs-string"><span class="hljs-string">'face'</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span> : <span class="hljs-string"><span class="hljs-string">'red circle'</span></span> }); layer.add(circle); <span class="hljs-comment"><span class="hljs-comment">//    //     layer.find('Circle'); //   //   id layer.findOne('#face'); //    (  css ) layer.find('.red')</span></span></code> </pre><br><br><h2>  Serialization and deserialization </h2><br>  You can save all created objects in JSON format, for example, to save to a server or local storage: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> json = stage.toJSON();</code> </pre><br>  And also create elements from JSON: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> json = <span class="hljs-string"><span class="hljs-string">'{"attrs":{"width":578,"height":200},"className":"Stage","children":[{"attrs":{},"className":"Layer","children":[{"attrs":{"x":100,"y":100,"sides":6,"radius":70,"fill":"red","stroke":"black","strokeWidth":4},"className":"RegularPolygon"}]}]}'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stage = Konva.Node.create(json, <span class="hljs-string"><span class="hljs-string">'container'</span></span>);</code> </pre><br><br><h2>  Performance </h2><br>  Konva.js has a lot of tools to significantly improve performance. <br><br>  1. Caching allows you to draw some element in the buffer canvas and then draw it from there.  This can significantly improve the rendering performance of complex objects, such as text or objects with shadows and outlines. <br><br><pre> <code class="javascript hljs">shape.cache();</code> </pre><br>  <a href="http://konvajs.github.io/docs/performance/Shape_Caching.html">[Demo]</a> <br><br>  2. Work with layers.  Since the framework supports several canvas elements, you can distribute objects at your discretion.  Suppose an application consists of a complex background with a text and several moveable shapes.  It will be logical to transfer the background and text to one layer, and the shapes to another.  In this case, when updating the position of the figures, the background layer can be not redrawn. <br><br>  <a href="http://konvajs.github.io/docs/performance/Layer_Management.html">[Demo]</a> <br><br>  A more comprehensive list of performance tips is available here: <a href="http://konvajs.github.io/docs/performance/All_Performance_Tips.html">http://konvajs.github.io/docs/performance/All_Performance_Tips.html</a> <br><br><h2>  Conclusion </h2><br>  GitHub: <a href="https://github.com/konvajs/konva">https://github.com/konvajs/konva</a> <br>  Homepage: <a href="http://konvajs.github.io/">http://konvajs.github.io/</a> <br>  Documentation with examples: <a href="http://konvajs.github.io/docs/">http://konvajs.github.io/docs/</a> <br>  Full API: <a href="http://konvajs.github.io/api/Konva.html">http://konvajs.github.io/api/Konva.html</a> <br><br>  This project is a fork of the famous <a href="https://github.com/ericdrowell/KineticJS">KineticJS</a> library, which is no longer supported by the author. <br>  The list of changes from the latest official version of KineticJS can be seen <a href="">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/250897/">https://habr.com/ru/post/250897/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../250885/index.html">Translit for JavaScript and GOST-7.79-2000</a></li>
<li><a href="../250887/index.html">Do not be evil</a></li>
<li><a href="../250891/index.html">Communication scripts from different browser tabs</a></li>
<li><a href="../250893/index.html">What is 1C. On a complex system in simple words</a></li>
<li><a href="../250895/index.html">DotNext Conference returns to Moscow - with new forces and updated name</a></li>
<li><a href="../250899/index.html">We do call tracking</a></li>
<li><a href="../250901/index.html">HTTP / 2 ready</a></li>
<li><a href="../250903/index.html">IBM Watson for Oncology: helping the cognitive system to fight cancer</a></li>
<li><a href="../250907/index.html">Custom login button on the Twitter SDK (Fabric kit)</a></li>
<li><a href="../250911/index.html">New Journal "Mathematical Modeling and Numerical Methods"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>