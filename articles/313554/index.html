<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to DPI: System Composition and Connection Diagrams</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! We at VAS Experts specialize in the creation and implementation of services in the field of monitoring and analyzing Internet traffic. In ou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to DPI: System Composition and Connection Diagrams</h1><div class="post__text post__text-html js-mediator-article">  <i>Hi, Habr!</i>  <i>We at <a href="http://vasexperts.ru/index.php">VAS Experts</a> specialize in the creation and implementation of services in the field of monitoring and analyzing Internet traffic.</i>  <i>In our blog, we will share our own experience and talk about how these or other technologies related to our field of work are arranged.</i> <br><br> <a href="https://habrahabr.ru/company/vasexperts/blog/313554/"><img src="https://habrastorage.org/files/886/195/919/88619591911242e58c62fb3e6f7326c9.jpg"></a> <br>  <i>/ Flickr / <a href="https://www.flickr.com/photos/andrewfhart/">Andrew Hart</a> / <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC</a></i> <br><br>  The global market for in-depth traffic analysis (DPI) in 2013 was estimated at almost $ 742 million.  According to analysts, by 2020 it will grow by more than 6 times and will be <a href="https://www.linkedin.com/pulse/global-deep-packet-inspection-dpi-market-size-2020-anurag-sharma">estimated</a> at 4.7 billion. DPI-systems are mainly used by Internet providers and telecom operators, who seek to protect their subscribers and optimize the bandwidth to the client through filters, priorities and caches. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      DPI analyzes all packets passing through it <a href="http://japan.proceranetworks.com/deep-packet-inspection">up</a> to the 7th level of the OSI model and recognizes applications that do not use previously known headers and structures for data exchange.  However, the DPI system alone does not solve the problems and tasks described above.  It interacts with other devices and services of the data transmission network of the operator.  About this today and talk. <br><a name="habracut"></a><br><h3>  Interaction with other systems </h3><br>  Standards and specifications for mobile networks are not developed by each operator separately, the 3GPP (3rd Generation Partnership Project), <a href="https://en.wikipedia.org/wiki/3GPP">created</a> in 1998, deals with this. <br><br>  The central concept of 3GPP networks is the PCC (Policy and Charging Control).  Decisions of this class allow to personalize services, actively manage traffic and quality of service, using PCC rules for making PCC decisions.  <a href="http://www.6wind.com/blog/deep-packet-inspection-in-pcef-systems/">Implements the</a> application of these PCC rules to the PCEF (Policy and Charging Enforcement Function) function.  DPI systems are part of the PCEF, scanning all passing traffic and applying the required policies to it. <br><br>  However, there are <a href="http://www.slideshare.net/bijuvrindavan/pcrfpolicy-charging-systemfunctional-analysis">other</a> elements in the scheme, for example, the Policy Control and Charging Rules Function (PCRF) is the decision to apply subscriber service policies to establish QoS parameters and charging rules depending on various conditions.  There is also an OCS (Online Charging System), which bills services and controls the subscriber‚Äôs balance. <br><br>  The billing system, which stores the subscriber balance database and provides it to the OCS server, and the UDR (User Data Repository) repository, which stores user data (services available to the subscriber, QoS parameters, and others), should be noted.  A complete list of the components involved can be found in our <a href="http://blog.vasexperts.ru/%3Fp%3D55">blog</a> . <br><br><h3>  DPI wiring diagrams </h3><br>  There are two main <a href="http://blog.vasexperts.ru/%3Fp%3D107">schemes for</a> connecting the device for in-depth analysis of traffic to the operator‚Äôs equipment - the so-called ‚Äúbreak‚Äù installation (active circuit) and traffic mirroring (passive circuit). <br><br>  <b>Installation setup "break"</b> <br><br>  This type of connection is used to implement the functionality of any DPI system.  In this case, the traffic analysis system is connected to the uplink after the border router. <br><br><img src="https://habrastorage.org/files/a4c/f1b/f9c/a4cf1bf9c4f544508b180df160e02554.jpeg"><br><br>  The advantage of this scheme is that absolutely all traffic passes through DPI.  This allows prioritization, as well as setting up notifications, caching, and other functions.  However, this type of connection has a significant drawback: the DPI device becomes a point of failure - if it fails, the connection is completely broken. <br><br>  But there are ways to solve this problem: <br><br><ul><li>  Use a bypass device as part of the DPI system, which, in the event of a failure of the main frontend, will begin to ‚Äúdrive‚Äù traffic through itself (traffic analysis will not be carried out). </li><li>  Use a backup DPI platform, which would filter traffic in case of failure of the main one. </li></ul><br>  <b>Traffic mirroring scheme</b> <br><br>  Traffic <a href="https://vasexperts.ru/docs/SCAT-Datasheet-en.pdf">is</a> mirrored through SPAN ports or optical splitters.  With this scheme, it is possible to analyze the history of visits in real time, redirect requests for blocking, caching and work with bonus programs. <br><br><img src="https://habrastorage.org/files/74c/9a8/081/74c9a8081f0b40059b924cbb397d5247.jpeg"><br><br>  The advantages of this connection option are minimal changes in the structure of the existing network and the absence of the need to use a bypass card.  In this case, it is possible to remove analytics from the traffic, connect the cache server and ‚Äúmirror‚Äù the traffic to the SORM equipment, but all the functionality of the DPI system will not work. <br><br>  Note that both connection options are supported by our SCAT DPI solution, which allows you to limit the size of the band occupied by protocol groups, control the priority of packets passing through it, block advertising content, etc. You can find more detailed information about the system <a href="http://vasexperts.ru/product-skat.php">here</a> . <br><br><h3>  Instead of conclusion </h3><br>  DPI-systems, which appeared as a result of combining several younger packet filtering systems (if you are interested, you can find the origin history of DPI and information about predecessors of the solution <a href="http://www.infosectoday.com/Articles/Deep_Packet_Inspection_Technologies.htm">here</a> and <a href="https://www.christopher-parsons.com/Main/wp-content/uploads/2013/02/DPI-and-Its-Predecessors-3.5.pdf%3Fd527f6">here</a> ), simplified the processes of support and administration of networks and sites, increased the security of the latter from all sorts of attacks and <a href="http://www.techrepublic.com/blog/data-center/deep-packet-inspection-what-you-need-to-know/">expanded the</a> scope of applicability of traffic analysis technologies. <br><br>  Details on how to apply DPI, we will talk in our next article.  We welcome your suggestions on topics for further consideration in the blog. </div><p>Source: <a href="https://habr.com/ru/post/313554/">https://habr.com/ru/post/313554/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../313542/index.html">Paul Graham's strategic speech at Defcon 2005: ‚ÄúInequality and Risk‚Äù</a></li>
<li><a href="../313544/index.html">Simple, powerful, forever. Elecard CodecWorks 990 - Live Software Transcoder for AVC and HEVC</a></li>
<li><a href="../313546/index.html">Researchers have created an exploit to get root-access to Android-based smartphones using the Rowhammer vulnerability</a></li>
<li><a href="../313550/index.html">Customize business processes web studio in CRM</a></li>
<li><a href="../313552/index.html">Kerio Operator 2.5 improves audio and video communications for small and medium businesses</a></li>
<li><a href="../313556/index.html">Introduction to DPI: System Usage Scenarios</a></li>
<li><a href="../313558/index.html">Deep Packet Inspection: Equipment and Application</a></li>
<li><a href="../313562/index.html">A little about the types of DDoS-attacks and methods of protection</a></li>
<li><a href="../313564/index.html">Installing Jenkins and Bonobo Git Server under Windows for building Android applications</a></li>
<li><a href="../313566/index.html">Automatic Relevance Determination or machine learning when there is very little data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>