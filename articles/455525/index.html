<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zimbra and protection from mail bombing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mail bombing is one of the oldest forms of cyber attacks. At its core, it resembles the usual DoS attack, only instead of a wave of requests from diff...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zimbra and protection from mail bombing</h1><div class="post__text post__text-html js-mediator-article">  Mail bombing is one of the oldest forms of cyber attacks.  At its core, it resembles the usual DoS attack, only instead of a wave of requests from different ip-addresses, a shaft of emails is sent to the server, which in large quantities arrive at one of the email addresses, due to which the load on it increases significantly.  Such an attack can lead to the inability to use the mailbox, and sometimes even can lead to the failure of the entire server.  The long history of this type of cyber attack has led to a number of positive and negative consequences for system administrators.  Positive factors include well-studied mail bombing and the availability of simple ways to defend against such an attack.  The negative factors include a large number of publicly available software solutions for conducting these types of attacks and the ability for an attacker to reliably protect against detection. <br><br><img src="https://habrastorage.org/web/524/a74/d9d/524a74d9dc834ae581c7893fc079c693.png" alt="image"><a name="habracut"></a><br><br>  An important feature of this cyber attack is that it is almost impossible to use for profit.  Well, the attacker sent an e-mail shaft to one of the mailboxes, he didn‚Äôt give the person to use e-mail properly, the attacker hacked someone‚Äôs corporate e-mail and started sending thousands of letters to the whole GAL, which caused the server to crash or slow down so that it became impossible to use it, and then what?  It is almost impossible to convert such a cybercrime into real money, therefore, just mail bombing is now quite a rare phenomenon and system administrators in infrastructure design may simply not recall the need to protect against such a cyber attack. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Nevertheless, despite the fact that mail bombing itself is rather meaningless from a commercial point of view, it is often part of other, more complex and multi-stage cyber attacks.  For example, when hacking mail and using it to hijack an account in a public service, attackers often ‚Äúbomb‚Äù the victim‚Äôs mailbox with meaningless letters so that the confirmation letter gets lost in their stream and goes unnoticed.  Also, mail bombing can be used as a means of economic pressure on the enterprise.  Thus, the active bombardment of the public mailbox of an enterprise for which applications from customers are received may seriously hamper work with them and, as a result, may lead to equipment downtime, unfulfilled orders, as well as loss of reputation and loss of profits. <br><br>  That is why the system administrator should not forget about the likelihood of mail bombing and always take the necessary measures to protect against this threat.  If we take into account that this can be done at the stage of building the postal infrastructure, as well as the fact that it takes up a little time and labor from the system administrator, there are no objective reasons for not providing your infrastructure with protection from mail-bombing .  Let's look at how protection against this cyber attack is implemented in the Zimbra Collaboration Suite Open-Source Edition. <br><br>  At the heart of Zimbra is Postfix - one of the most reliable and functional Mail Transfer Agent open source software at the moment.  And one of the main advantages of its openness is that it supports a wide variety of third-party solutions for extending functionality.  In particular, Postfix fully supports cbpolicyd, an advanced utility for ensuring the cybersecurity of the mail server.  In addition to spam protection and the creation of white, black and gray lists, cbpolicyd allows the Zimbra administrator to configure SPF signature verification, as well as set limits on the reception and sending of emails or data.  They can both provide reliable protection against spam and phishing emails, as well as protect the server from mail-bombing. <br><br>  The first thing that the system administrator needs is to activate the cbpolicyd module, which is pre-installed in the Zimbra Collaboration Suite OSE on the infrastructure MTA server.  This is done with the command zmprov ms `zmhostname` + zimbraServiceEnabled cbpolicyd.  After that, you will need to activate the web interface in order to be able to comfortably manage cbpolicyd.  To do this, you need to allow connections on the web port number 7780, create a symbolic link using the command <b>ln -s / opt / zimbra / common / share / webui / opt / zimbra / data / httpd / htdocs / webui</b> , and then edit the settings file using the command nano <b>/opt/zimbra/data/httpd/htdocs/webui/includes/config.php</b> where you need to write the following lines: <br><br><blockquote>  $ DB_DSN = "sqlite: /opt/zimbra/data/cbpolicyd/db/cbpolicyd.sqlitedb"; <br>  $ DB_USER = "root"; <br>  $ DB_TABLE_PREFIX = ""; </blockquote><br>  After that, it remains only to restart the Zimbra and Zimbra Apache services using the zmcontrol restart and zmapachectl restart commands.  After that, you will have access to the web interface at <b><a href="http://example.com/">example.com</a> : 7780 / webui / index.php</b> .  The main nuance is that the entrance to this web interface is not protected at all, and in order to prevent unauthorized persons from entering it, you can simply close the connections on port 7780 after each login to the web interface. <br><br>  Email quotas that can be set by cbpolicyd allow you to protect yourself from the flow of emails coming from the internal network.  Such quotas allow you to set a limit on the maximum number of letters that can be sent from one mailbox per unit of time.  For example, if the managers of your enterprise send on average 60-80 emails per hour, then you can, given the small margin, set them a quota of 100 emails per hour.  In order to exhaust such a quota, managers will have to send one letter every 36 seconds.  On the one hand, this is enough to fully work, and on the other hand, with such a quota, attackers who have access to the mail of one of your managers will not arrange mail bombing or mass spam attacks in the enterprise. <br><br>  In order to establish such a quota, you need to create a new mail restriction policy in the web interface and specify that it act both on letters sent within the domain and on letters acting to external addresses.  This is done as follows: <br><br><img src="https://habrastorage.org/webt/zm/or/di/zmordik447h-uqiny4eab7aprki.png"><br><br>  After that, it will be possible to specify in more detail the restrictions associated with sending letters, in particular, set a time interval, after which the restrictions will be updated, as well as a message that will be received by the user who has exceeded his limit.  After that, you can set the very restriction on sending letters.  It can be specified both as the number of outgoing letters and as the number of bytes of information transmitted.  In this case, with letters that are sent above the designated limit, do differently.  For example, you can simply delete them immediately, or you can save them so that they go immediately after updating the limit for sending messages.  The second option can be used during the detection of the optimal limit value for sending emails by employees. <br><br>  In addition to the restrictions on sending emails, cbpolicyd allows you to configure a limit on how to receive emails.  Such a restriction, at first glance, is an excellent solution for protection against mail-bombing, but in fact setting such a limit, even a large one, is fraught with the fact that in certain conditions an important letter may not reach you.  That is why it is not recommended to include any restrictions for incoming mail.  However, if you still decide to take a risk, you need to approach the setting of the limit of incoming messages with special attention.  For example, you can limit the number of incoming letters from trusted counterparties, so that if their mail server is compromised, it will not spam your company. <br><br>  In order to protect against the shaft of incoming messages when mail-bombing, the system administrator should undertake something smarter than a simple restriction of incoming mail.  Such a solution could be the use of gray lists.  The principle of their operation lies in the fact that the first attempt to deliver a message from an unreliable sender, the connection with the server is abruptly interrupted, which is why the delivery of the letter fails.  However, if, during a certain period, an unreliable server again attempts to send the same letter, the server does not terminate the connection and its delivery is successful. <br><br>  The point of all these actions is that the programs for automatically sending mass e-mails usually do not check the success of the delivery of the sent message and do not attempt to send it a second time, while the person will surely make sure whether his letter was sent to the address or not. <br><br>  You can also enable graylists in the cbpolicyd web interface.  In order for everything to work, you need to create a policy that would contain all incoming emails addressed to users on our server, and then, based on this policy, create a Greylisting rule where you can configure an interval during which cbpolicyd will wait for a second response from an unfamiliar the sender.  It is usually 4-5 minutes.  At the same time, gray lists can be configured so that all successful and unsuccessful attempts to deliver letters from different senders are taken into account and, based on their number, the decision was made to automatically add the sender to the white or black lists. <br><br>  We draw your attention to the fact that the use of gray lists is worth looking with maximum responsibility.  It would be best if the use of this technology will go hand in hand with the constant maintenance of white and black lists, in order to exclude the possibility of losing the letters that are really important for the enterprise. <br><br>  In addition, adding SPF, DMARC, and DKIM checks can help protect against mail bombing.  Often letters that arrive in the process of mail bombing such checks do not pass.  How to do this was described <a href="https://habr.com/ru/company/zimbra/blog/339296/">in one of our previous articles</a> . <br><br>  Thus, it is quite simple to protect yourself from such a threat as mail-bombing, and this can be done even during the construction phase of the Zimbra infrastructure for your enterprise.  However, it is important to constantly ensure that the risks of using such protection never exceed the benefits you receive. </div><p>Source: <a href="https://habr.com/ru/post/455525/">https://habr.com/ru/post/455525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../455513/index.html">The explosion and the global conspiracy: the story of the creation of lithium-ion batteries</a></li>
<li><a href="../455517/index.html">A graduate of the course of Netology "Data Science" about his work in the banking sector</a></li>
<li><a href="../455519/index.html">How we implemented the onboarding of new developers</a></li>
<li><a href="../45552/index.html">Sunset Web?</a></li>
<li><a href="../455523/index.html">Implementing the OpenStack LBaaS user interface</a></li>
<li><a href="../455527/index.html">What is written in this? Hacking JavaScript Objects</a></li>
<li><a href="../45553/index.html">That means what they do there! Mosaic in google.spreadsheets</a></li>
<li><a href="../455533/index.html">Bubble Physics: Search for a Foam Breakdown Mechanism</a></li>
<li><a href="../455535/index.html">Managing SSL / TLS certificates in clouds and containers is not human work.</a></li>
<li><a href="../455537/index.html">Search optimization in width: how to handle a graph with 10 billion states</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>