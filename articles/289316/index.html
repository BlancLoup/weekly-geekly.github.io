<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Do it yourself How I did a collection service for collecting prices for tours</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Work - work, but sometimes you want to relax. Suppose you are going on vacation in hot lands. You immediately have several questions, the main of whic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Do it yourself How I did a collection service for collecting prices for tours</h1><div class="post__text post__text-html js-mediator-article">  Work - work, but sometimes you want to relax.  Suppose you are going on vacation in hot lands.  You immediately have several questions, the main of which are: <br><br>  <b>1) Where to go to rest</b> <br>  Indeed, you need to re-read a lot of sources to determine where it is now (or when you gathered there) warmly, whether you need a visa to enter the country, how much is a ticket, etc. <br><br>  <b>2) When to go to rest</b> <br>  Suppose you know that you want to spend your vacation in Egypt, but do not know when.  The most important question for many is when is it cheaper to go there?  It is also important to know what the weather is like there, etc. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/cd3/1cf/039/cd31cf039276471588de333c7c084e73.png" alt="image"><br><a name="habracut"></a><br><h1>  How it works </h1><br><h2>  Loading </h2><br>  Many tour operators have so-called xml-gateways for downloading prices.  Through these gateways you can get prices for certain tourist products.  Unfortunately, to access this data, an agreement with a tour operator is often required.  So just do the export will not work.  To do this, we had to register as a legal entity and suffer through the signing of many documents. <br><br>  The data supplied by tour operators looks like this: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tour_date</span></span></span><span class="hljs-tag">&gt;</span></span>18.11.2014<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tour_date</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">aircompany</span></span></span><span class="hljs-tag">&gt;</span></span> (  / )<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">aircompany</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">town</span></span></span><span class="hljs-tag">&gt;</span></span> / Paphos<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">town</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">room</span></span></span><span class="hljs-tag">&gt;</span></span>STANDARD Inland View BB<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">room</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dt</span></span></span><span class="hljs-tag">&gt;</span></span>18.11.2014<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dt</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id_hotel</span></span></span><span class="hljs-tag">&gt;</span></span>102610001680<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id_hotel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id_ns</span></span></span><span class="hljs-tag">&gt;</span></span>104610415895<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id_ns</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">duration</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">duration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">o_duration</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">o_duration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">quota</span></span></span><span class="hljs-tag">&gt;</span></span>9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">quota</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id_price</span></span></span><span class="hljs-tag">&gt;</span></span>121132934133<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id_price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amount</span></span></span><span class="hljs-tag">&gt;</span></span>435<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amount</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RUR</span></span></span><span class="hljs-tag">&gt;</span></span>25435<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RUR</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ag</span></span></span><span class="hljs-tag">&gt;</span></span>14+, 14+<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ag</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id_vr</span></span></span><span class="hljs-tag">&gt;</span></span>102510005340<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id_vr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">entry</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Once a week, the built-in Java scheduler begins the process of building information.  In one pass, more than 4,000 hotels in 21 countries of the world are viewed. <br><br>  Data collection is carried out with more than 100 tour operators. <br><br>  Data carefully fit into the database on demand. <br><br>  New hotels are also added automatically.  This solves the problem of changing the name of the hotel or its closure. <br><br>  The collection of additional information is also automatically carried out. <br><br>  The approximate scheme of the database clearly demonstrates many parameters: <br><br><img src="https://habrastorage.org/files/30a/03b/079/30a03b07932b428690d4baf521d6330e.png"><br><br>  Currently, the Apache Derby database contains approximately 2 GB of data. <br><br><h2>  Where to go to rest </h2><br>  We start from the fact that the user knows some criteria for his future journey, but does not know his destination. <br><br>  Based on statistical data on prices, as well as using auxiliary data, namely: <br>  - Dates and a brief description of the holidays; <br>  - Excursions, prices, a brief description and type (cognitive, extreme, review); <br>  - The need for a visa to a particular country, as well as an approximate price, production time and place of its receipt; <br>  - flight time; <br>  - Dining at the hotel; <br>  can be calculated as a percentage of how each of the 21 countries offered by the service fits. <br><br>  All parameters are equilibrium, so applying a not very tricky formula you can get an interesting result: <br><br><img src="https://habrastorage.org/files/f28/929/246/f289292465e74d6fbdaa1416a73bc233.png" alt="image"><br><br><h2>  When to go to rest </h2><br>  In this case, the user knows where he wants to go and just wants to see how the price and weather have changed, as well as additional parameters of the country. <br><br>  In this case, we simply display the so-called "Country card", which will reflect a lot of useful information: <br><br><img src="https://habrastorage.org/files/8d8/b1b/7fd/8d8b1b7fd3fc4bff9a2b34703a8bc847.png" alt="image"><br><br><h1>  History of creation </h1><br>  The idea originated at the 3rd course (distant 2010) of my university (thanks to SPbSPU). <br>  I wanted to go on vacation somehow, but a problem arose - it was not clear when it was cheaper and where it was warmer to rest. <br>  On the forums they write different, sometimes contradictory information, but I have not found any sites with real statistics. <br>  As is customary in the IT sphere, if you have not found a solution, write it yourself. <br><br>  <b>The first step</b> was manual data collection.  There was a table in Excel and a couple of functions that built graphs from the data.  After a while, it became lazy (or simply forgot) to add data. <br><br>  <b>The second step</b> was learning C ++.  Almost at the university, we began to learn the C ++ language and make simple projects on it.  I immediately wanted to automate the data collection process and I wrote a service that collects data from several tour operators.  He put the data into a file and there was no talk about any databases or web servers.  Crown service started on a home computer. <br><br>  <b>The third step</b> was the complete rewriting of the project in Java with the simultaneous study of EJB (Java EE), the addition of a relational DBMS and a web server to display data to the user (table view). <br><br>  Later I added various js-libraries for graphing, improved performance, fixed errors and so on. <br>  Transferred the service to the "real" server from my home computer <br>  I ordered the site design from my colleague from one of the past works. <br><br><h1>  Why all this? </h1><br>  In fact, everything is simple - the project was designed exclusively for its own use.  I just wanted to get information for the cheapest and most enjoyable stay. <br><br>  Then I wanted to share information with the world so that everyone could find useful information for themselves. <br><br>  Now it is a hobby, from time to time I deal with its development.  I do not make special investments of money, except hosting, domain, certificates, design and time (time is money). <br><br>  There may be errors in the layout or other minor problems - please do not judge strictly. <br><br>  Sheyring welcome <br>  <a href="https://protury.info/">protury.info</a> </div><p>Source: <a href="https://habr.com/ru/post/289316/">https://habr.com/ru/post/289316/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../289300/index.html">Team solidarity: success or failure?</a></li>
<li><a href="../289304/index.html">Paid Traffic vs. Organic: 5 Reasons Why Both Are Important</a></li>
<li><a href="../289306/index.html">Global problems online chat and a new model of communication users</a></li>
<li><a href="../289310/index.html">Nikita Mikhalkov proposes to the Internet community "to draw a joint scheme" of the implementation of the author's collection</a></li>
<li><a href="../289312/index.html">Yandex: 72.3 million people use the Internet in Russia</a></li>
<li><a href="../289318/index.html">DIY time management system for freelancer based on KPI</a></li>
<li><a href="../289320/index.html">Interesting weekend events</a></li>
<li><a href="../289322/index.html">Turkey blocks social media</a></li>
<li><a href="../289324/index.html">Google will not rejoice at VP9</a></li>
<li><a href="../289326/index.html">Android OS in 2014 gave the Internet 64% of traffic</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>