<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Convenient library for working with media tags</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings to all habravchan. One fine evening I had the idea to sort out my gigabytes of music. And to be more precise, I simply wanted to delete all ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Convenient library for working with media tags</h1><div class="post__text post__text-html js-mediator-article">  Greetings to all habravchan.  One fine evening I had the idea to sort out my gigabytes of music.  And to be more precise, I simply wanted to delete all the tracks with a low bit rate, so as not to irritate the ears and how much they did not take the place.  One could, of course, do everything manually, but, first, laziness, and second, it would take several weeks, if not months.  Anyway, I'm a programmer or where?  With such plain reasoning, I came to the conclusion that it would be worth automating the process.  The question of the language in which the automation will be made was not particularly: I write at work on C #, at home there is also an express version of Visual Studio, which means so.  It remains only to find out how with the help of these very sharps and studios to find out the bitrate of the files, so as not to remove anything superfluous.  A short but productive googleg led me to one wonderful library. <br><a name="habracut"></a><br><h5>  Short description </h5><br>  So, our library is called Taglib-sharp and, as the name implies, is designed to work with media tags (video, audio and photo).  The project is open source and distributed free of charge under the LGPL.  Download the library (for example, <a href="">from here</a> or <a href="http://download.banshee.fm/taglib-sharp/">from here</a> ), add a link to it in our project, register TagLib in using and now we are ready to start. <br>  Below is a small example of obtaining information from the tags.  The example is not complete, the rest can be easily found in the library help. <br><br><pre><code class="hljs tex">//     .      . var audioFile = TagLib.File.Create(@"C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Users</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Ethiopian</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Music</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Feindbild</span></span></span></span>.mp3"); //      Console.WriteLine(": {0}<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">n</span></span></span></span>: {1}<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">n</span></span></span></span>: {2}<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">n</span></span></span></span>: {3}<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">n</span></span></span></span>: {4}" , audioFile.Tag.Album , String.Join(", ", audioFile.Tag.Performers) , audioFile.Tag.Title , audioFile.Tag.Year , audioFile.Properties.Duration.ToString("mm<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>:ss"));</code> </pre> <br><br>  As a result of executing the code above, the console will produce something like: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="dos hljs">: Gotterdammerung : Megaherz : Feindbild : <span class="hljs-number"><span class="hljs-number">2002</span></span> : <span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span></code> </pre><br><br>  Well, at the very least, they learned how to get information, it's time to use it. <br><br><h5>  Practical use </h5><br>  After playing with the library, it‚Äôs time to return to the original task.  What did we want to do there?  Aha  Delete all entries with a low bit rate.  And this is where the .Properties.AudioBitrate property, which is ideally suited for us, comes onto the scene.  On it we also will filter out unusable files. <br>  For our modest goals, the usual console utility will be quite enough; as a parameter, we will pass the path to the folder with files, and it will already rake files by tags and delete unnecessary ones.  The removal method itself turned out this: <br><br><pre> <code class="hljs pgsql">private static <span class="hljs-type"><span class="hljs-type">void</span></span> RemoveBadAudio(string foldPath) { //     ,     . DirectoryInfo dir = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> DirectoryInfo(foldPath); //         <span class="hljs-type"><span class="hljs-type">int</span></span> deletedCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> savedCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; //  mp3    <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (FileInfo file <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dir.GetFiles("*.mp3")) { //  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TagLib.File.<span class="hljs-keyword"><span class="hljs-keyword">Create</span></span>(file.FullName).Properties.AudioBitrate &lt; <span class="hljs-number"><span class="hljs-number">320</span></span>) { file.<span class="hljs-keyword"><span class="hljs-keyword">Delete</span></span>(); deletedCounter++; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { savedCounter++; } } Console.WriteLine("\n\ : {0} \n : {1}", deletedCounter, savedCounter); }</code> </pre><br><br>  Well, that's it, the program works, it performs its task.  Please do not kick for the code, the main task was to do it quickly and ‚Äúso that it worked‚Äù. <br><br>  <b>UPD:</b> After the article was published, I received one rather important question from my friend: ‚ÄúWhat about the subdirectories?‚Äù. <br>  Indeed, the originally presented method works only with files lying in the root of a given directory.  To capture files in subdirectories, you can use the method: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveBadFilesInSubDirectories</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> foldPath</span></span></span><span class="hljs-function">)</span></span> { DirectoryInfo parentDirectory = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DirectoryInfo(foldPath); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (DirectoryInfo dir <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> parentDirectory.GetDirectories()) { <span class="hljs-comment"><span class="hljs-comment">//      ,  . //   ,           ,   dir. } }</span></span></code> </pre><br><br><h5>  Finally </h5><br>  We considered one of the possible applications of the Taglib-sharp library and simultaneously saved our ears from low-quality mp3 recordings.  Of course, this is not the only application of this library.  For example, you can automate the renaming of files by tags or the sorting of files by artist folders.  Yes, a lot of things, the main thing to start and not be afraid.  And for this, let me leave.  Hope to see you soon. </div><p>Source: <a href="https://habr.com/ru/post/177795/">https://habr.com/ru/post/177795/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../177781/index.html">Where is the market of electronic payment systems in Russia? Part 2. Plastic cards</a></li>
<li><a href="../177785/index.html">Fidonet's arrival on Android</a></li>
<li><a href="../177789/index.html">Impressions after prolonged use of Microsoft Surface RT</a></li>
<li><a href="../177791/index.html">A radical approach to application development</a></li>
<li><a href="../177793/index.html">Capture video from the camera and transmit it over the network</a></li>
<li><a href="../177797/index.html">Organization of storage of intermediate tables for the CART algorithm</a></li>
<li><a href="../177799/index.html">I want to write tests</a></li>
<li><a href="../177801/index.html">Yandex.Maps-Time.Lapse</a></li>
<li><a href="../177803/index.html">Just add meat or embedding on mode</a></li>
<li><a href="../177805/index.html">Creating a graphic captcha with a choice of extra</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>