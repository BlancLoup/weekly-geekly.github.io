<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Chat bot gains hearing, or suffering amateur</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, I presented a syntactic chat bot named Vanya Reasonable ( "Creating AI using the" cool kuzdra "method. Intellectual odyssey" ). The s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Chat bot gains hearing, or suffering amateur</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/id/5_/zw/id5_zwk_kojd3umbecntoql6kvw.jpeg"><br><br>  Not so long ago, I presented a syntactic chat bot named Vanya Reasonable ( <a href="https://habr.com/post/420197/">"Creating AI using the" cool kuzdra "method. Intellectual odyssey"</a> ).  The subsequent obvious stage, which, like the other creators of the artificial mind, wanted to go through - to give the child a voice.  It would seem, what is easier? <br><br>  It was necessary, however, to suffer.  Some problems could not be solved, certainly due to dilettantism.  And yet, I doubt that it is also interesting for professionals to solve the accompanying problems.  No one is interested, so I did not want to.  I was hoping to quickly fasten the sound and move on to the next idea ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But first things first. <br><br>  (I am writing in the hope that my sufferings in the field of voice acting will help some of the lovers like me. This bison doesn‚Äôt help this bison). <br><a name="habracut"></a><br>  It is clear that the task of sounding is divided into two unrelated sections: <br><br><ol><li>  Text synthesis </li><li>  Speech recognition. </li></ol><br>  I take the first point as the lightest.  Immediately stumble on the code for beginners, just a few lines. <br><br><div class="spoiler">  <b class="spoiler_title">Preset voice synthesis</b> <div class="spoiler_text"><pre><code class="java hljs">using System.Speech.Synthesis; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSpeech</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string text)</span></span></span><span class="hljs-function"> </span></span>{ SpeechSynthesizer speaker = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpeechSynthesizer(); speaker.SetOutputToDefaultAudioDevice(); string selectedVoice = Properties.Settings.Default.Voice; speaker.SelectVoice(<span class="hljs-string"><span class="hljs-string">"Microsoft Irina Desktop"</span></span>); speaker.Rate = <span class="hljs-number"><span class="hljs-number">1</span></span>; speaker.Volume = <span class="hljs-number"><span class="hljs-number">100</span></span>; speaker.Speak(text); speaker.Dispose(); }</code> </pre> <br></div></div><br>  I insert into the source, and imagine, the machine says!  I am a little crazy with joy.  So simple?!!! <br><br>  It remains nonsense: to attach a male voice.  Unfortunately, in Windows one Russian voice is preinstalled - female: ‚ÄúMicrosoft Irina Desktop‚Äù.  And I have a chat bot boy, not a girl, I do not plan to do a sex change operation for him. <br><br>  I google again, after a while, I am convinced that there are few male Russian voices.  It means free voices, because paid services are not for my singing love romances of finance.  But there are free male voices, for example the voice ‚ÄúAlexander‚Äù of the Russian RHVoice library.  Well, let it be Alexander. <br><br>  Unfortunately, the installation (for me) is somehow complicated.  But there are ready-made assembly.  I download one of the assemblies, install it, climb into the settings of the Windows (Speech Recognition / Text-to-Speech) and - lo and behold!  - I find the voice ‚ÄúAleksandr‚Äù next to ‚ÄúMicrosoft Irina Desktop‚Äù.  With a sinking heart, I launch ... <br><br>  Everything works in Windows! <br><br>  I replace the source code "Microsoft Irina Desktop" with "Aleksandr" and ... Not a damn thing anymore!  Sad but not deadly.  Right now, correct. <br><br>  I am studying the RHVoice project, in particular the description of the configuration file, experimenting this way and that ... The result is the same: instead of sounds, Alexander makes an indiscriminate growl or nothing at all, despite the fact that Irina tells me how to be a TV announcer. <br><br>  A couple of days I hope for something else and fumble, but then give up.  Yes, my hands are crooked.  Well, I don‚Äôt know why Aleksandr refuses to talk, I don‚Äôt know, and there is no answer on the forums. <br><br>  All right, I study other free voices, the blessing them no more than ten. <br><br>  Here it comes to me that if I wish that the users of Vanya the Reasonable hear the same voice that I hear, then I will have to install a voice installer in the package.  This is beyond my power, and even reluctant to do, so the first paragraph, "Text-to-speech synthesis," ends with shameful capitulation. <br><br>  I take a decision in principle: <br><br><ol><li>  All go to hell!  Let the chat bot users install the voices they want and choose from the list.  Attaching a list of preset voices is a feasible task. </li><li>  I am voicing Vanya Reasonable in a female voice, because Vanya is young and his voice has not yet broken.  ‚ÄúAnd not at all because my hands are growing out of my ass,‚Äù I persuade myself in the manner of psychotherapy. </li></ol><br>  With a pure heart, I turn to point number 2: Speech recognition. <br><br>  The second point is decisive.  Who needs a chat bot, who can play his own phrases in a voice, but does not understand the interlocutor's voice?  In the event of failure, the voice-over idea collapses. <br><br>  Again googling, this time ecstatic, on the last breath. <br><br>  What turns out?  The options are mostly paid: free are available, but for the Russian language their units. <br><br>  SpeechKit from Yandex appears as the simplest one in the network, but I save it for later, if more complex options do not work.  I prefer to get the recognition offline. <br><br>  Here is a completely free solution from CMUSphinx.  Studying reviews: <br><br><ul><li>  First of all, no romping cries are heard: brothers, everything works! </li><li>  secondly, the description of the installation for me is completely abstruse.  It seems that after installation the library is also necessary to train! </li></ul><br>  It disappears. <br><br>  Further.  Microsoft Speech Platform, free. <br><br>  I google and find a <a href="https://www.youtube.com/watch%3Fv%3D-qpVafFnthU">link</a> with an available description plus the source code of the example.  I download the source, compile.  I say ‚ÄúOne, Two,‚Äù and the program displays the recognized text.  Rabo-o-otaet! .. <br><br>  It is a little embarrassing that the text is not recognized by itself, but must be added to the dictionary first.  But it's not scary: instead of ‚Äúone, two‚Äù I attach a large file with spelling. <br><br>  I transfer the code from the source code of the example to my source code, I try to achieve the same effect ... It does not compile, it falls out into the action. <br><br>  Then I read the comments with my left eye and find that the solution is suitable for recognizing commands, but does not allow working with continuous text.  Checking the original example.  Aha, ‚Äúone, two‚Äù recognizes, and ‚Äúone, two, three‚Äù is not completely: he cannot hear the three.  With my right eye, I find something like ‚ÄúContinuous text is recognized for a fee‚Äù in comments, and the Microsoft Speech Platform ceases to exist for me. <br><br>  I heard that Google provides its recognition for free for a year, it would be necessary to check. <br><br>  I check.  Already not, as far as I can judge. <br><br><img src="https://habrastorage.org/webt/cb/9g/uz/cb9guz-qrvrpf6gjtgw2xs6p_dk.png"><br><br>  I do not exclude that Google was wrong, but do not blame me: I share the personal experience I have gained with beginners. <br><br>  I'm going to give in to Yandex.  Here, the exclamations "Brothers, everything works!"  I can connect to SpeechKit via API, instructions are available. <br><br>  I come to give up and what I see?  The company has just presented Yandex.Oblako, where it transferred the service of speech technologies.  I am not proud, I will register in the Cloud: probably there everything is the same as it was before ... <br><br>  And here I am waited by the terrible bummer: <br><br><ol><li>  First, the free use of the signer is no longer heard.  True, give a grant that you can pay for the service for some time.  Okay, keep on registering ... </li><li>  And what is this thing ?!  To work with the service, they require me to specify the details of a bank card.  An excerpt from a letter sent to me as the creator of a Cloud profile: </li></ol><br><img src="https://habrastorage.org/webt/qa/24/pd/qa24pdt_ia6oih1igwiltui-qii.png"><br><br>  Somewhere I saw this: in my opinion, in Google.  Therefore, Yandex took an example from a senior comrade. <br><br>  I am surprised at the absence of indignant posts on Habr√©.  They‚Äôre not just demanding money for services, but asking for the key to the apartment, where the money is!  It infuriates me that for some time the bank may not give out my own money according to the decision of the bank manager, and here the second uncle demands essentially the same right.  Moreover, before I agreed to switch to the paid version.  I have not yet concluded any agreement with this uncle, but already give the keys to the apartment, just in case.  Ay, what a kind and prudent! <br><br>  You know, Uncle Yandex, I have nothing against you, and I use your services with pleasure, but, excuse me, until I have a choice, you will not receive a password from my bank card.  And especially for you to draw up a card with two rubles is not enough for me, and it is expensive. <br><br>  Here comes the eye on the imperfection of speech recognition technologies.  The meaning is that at the moment nothing good has been done in the field of speech recognition, and you should not use it.  I curse and humble myself with the thought that in the near future Vanya Reasonable will not speak. <br><br>  The paragraph below is the following article about speech recognition online services.  Online services are not suitable, of course.  Well, I recognize the sound in winforms, and not on the site ... Without the slightest hope, click on the link and ... <br><br>  The next day, the chat bot finds voice. <br><br>  Introducing the magic wand: <a href="https://speechpad.ru/">speechpad.ru</a> .  I warn you that the service only works in Chrome.  It does not stop me: I use any Chrome.  And his engine is from Google: apparently, some unknown opportunities for me to use the service for free remain. <br><br>  Speechpad has a simple, but quite a workable interface: <br><br><img src="https://habrastorage.org/webt/7u/ox/wj/7uoxwjgsbkpduvdsaloxjwlj55k.png"><br><br>  Connecting the recognizer takes minimum time. <br><br>  After reading the instructions, the first thing I do is integrate the service with the OS.  True, the integration is paid, but 100 rubles a month regardless of the recognition volume - this is another matter!  These are not draconian tariffs for every recognized piece.  Especially since a trial period of two days is given. <br><br>  I register on the site, press the power button to turn on the test period, for a minute I install a couple of the instructions mentioned in the instructions, and everything works.  The principle of action - the recognized text is added to the location of the cursor.  Really recognized and truly added.  Recognized not without errors, but, from my point of view, satisfactorily. <br><br>  After a couple of hours of testing, I come to the conclusion that it is more rational to use the clipboard, and this feature is free.  Here, of course, an amateur: <br><br><ul><li>  When integrated with OS, the cursor must be on a specific chat bot field.  During testing, I‚Äôve forgotten several times and switched from the chat bot to VS, with the result that the recognized text is driven into the source code; </li><li>  when using the clipboard, it is accordingly forbidden to use the clipboard, otherwise the text copied from the third-party program to the clipboard will instantly appear in the chat bot.  A couple of times I also come across this, but I‚Äôm getting used to it soon. </li></ul><br>  In the end, I stop on the clipboard. <br><br>  Everything, the problem is solved. <br><br>  It takes more time than connecting a speech reader to recognize the phrases uttered by the chat bot.  Pretty sweaty until it reaches me that it's easiest to turn off the microphone.  I'm pushing the mute code for the microphone. <br><br><div class="spoiler">  <b class="spoiler_title">Microphone On / Off Code</b> <div class="spoiler_text"><pre> <code class="java hljs">using NAudio.CoreAudioApi; <span class="hljs-comment"><span class="hljs-comment">//-  public static void Mute(bool start) { CoreAudioMicMute CAMM = new CoreAudioMicMute(); CAMM.SetMute(start); } internal class CoreAudioMicMute { private MMDevice[] rgMicDevice; //      int MaxMicro = 0; public CoreAudioMicMute() { try { MMDeviceEnumerator DevEnum = new MMDeviceEnumerator(); MMDeviceCollection devices = DevEnum.EnumerateAudioEndPoints(DataFlow.Capture, DeviceState.Active); // DataFlow.Capture - (     ), //DeviceState.Active -   //   (  ) MaxMicro = 0; for (int i = 0; i &lt; devices.Count; i++) // devices.Count -  ( ) { MMDevice deviceAt = devices[i]; if (deviceAt.DataFlow == DataFlow.Capture &amp;&amp; deviceAt.State == DeviceState.Active) // - (     ,   //"if(...",      deviceAt,   - DeviceFriendlyName //  FriendlyName,       ( //   .) { ++MaxMicro; } } //    () () ()   (,   ) rgMicDevice = new MMDevice[MaxMicro]; MaxMicro = 0; for (int i = 0; i &lt; devices.Count; i++) { MMDevice deviceAt = devices[i]; if (deviceAt.DataFlow == DataFlow.Capture &amp;&amp; deviceAt.State == DeviceState.Active) //   () { MaxMicro++; rgMicDevice[MaxMicro - 1] = deviceAt; } } } catch (Exception) { } } public void SetMute(bool mute) //,       private MMDevice[] rgMicDevice { try { for (int i = 0; i &lt; MaxMicro; i++) { rgMicDevice[i].AudioEndpointVolume.Mute = mute; //= true -   (  ) } } catch (Exception) { } } }</span></span></code> </pre> <br><br>  <i>* - comments are not mine, but scattered.</i>  <i>I do not give the link, as its owner admits that he himself has google the code in the depths of the English-language Internet.</i> <i><br></i>  <i>** - I made minor changes to the code.</i> <br></div></div><br>  Before the chat bot phrase I turn off the microphone, turn on the microphone after the phrase, as a result, the service hears only my phrases, but does not hear the chat bot. <br><br>  Here is the final result: <br><div class="oembed">  <a href="https://yadi.sk/i/kyoV-qoc6qXARQ">https://yadi.sk/i/kyoV-qoc6qXARQ</a> </div><br>  For completeness of impressions I look through a dozen more sites with speech recognition.  In principle, everyone is like each other, and the engines are mostly from Google, but the ability to explicitly receive text on the clipboard is not.  Judging by the comments, here and there there is a possibility of voice acting sites, but I don‚Äôt dwell on this topic.  As they say, they are not looking for good from the good. <br><br>  Now another problem: I think it would be nice to fasten an animation that pronounces a spoken speech.  I want something simpler: a library for C # with a choice of character.  But I was told that there is no such thing in .NET ... <br><br>  Actually, everything is on it.  The young man has a female voice, but in general the voice mode is functioning. <br><br>  I hope in the near future to present Vanya Razumnogo in a more presentable form.  Since then, it has been greatly refreshed and has become more intelligent: it has switched from Access to PostgreSQL, the algorithms have improved, it was possible to connect dictionaries, chop up the initial base of typical answers - another person, in short. </div><p>Source: <a href="https://habr.com/ru/post/433974/">https://habr.com/ru/post/433974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433958/index.html">TDD applications on Spring Boot: working with a database</a></li>
<li><a href="../433964/index.html">ECMAScript Modules in Node.js: New Plan</a></li>
<li><a href="../433966/index.html">Christmas card from Mars. The ESA showed a large accumulation of ice on the surface of the red planet.</a></li>
<li><a href="../433968/index.html">Maximum degenerate game of communication</a></li>
<li><a href="../433972/index.html">HolyJS 2018 Moscow through the eyes of the participant</a></li>
<li><a href="../433980/index.html">China launched more rockets into orbit in 2018 than any other country</a></li>
<li><a href="../433982/index.html">Artificial Intelligence thinks as a group of people that causes anxiety.</a></li>
<li><a href="../433984/index.html">Russian students are expected at the international competition of Microsoft in AI</a></li>
<li><a href="../433986/index.html">Create a Vuex Undo / Redo plugin for VueJS</a></li>
<li><a href="../433990/index.html">VimpelCom, Megaphone and Tele2 will raise tariffs at the beginning of the year, the Ministry of Communications proposes to cancel roaming with Belarus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>