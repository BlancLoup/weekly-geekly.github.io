<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Open source extensions for yii from 2GIS commands</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last time we talked about layered architecture in the yii framework, and now we want to share the code. 

 In our work, we actively use open source so...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Open source extensions for yii from 2GIS commands</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage1/3da2bde5/1fdfdd79/0ca39180/94ca50b6.png">  Last time we talked about <a href="http://habrahabr.ru/company/2gis/blog/130162/">layered architecture</a> in the yii framework, and now we want to share the code. <br><br>  In our work, we actively use open source solutions, and therefore we decided to share our own developments that can be useful to the community.  Today, these are extensions for probably the world's best PHP framework <a href="http://www.yiiframework.com/">yii</a> : <br><ul><li>  DGSphinxSearch </li><li>  AMQP (RabbitMQ) </li><li>  MQLogRouter </li><li>  DGPinbaLogRoute </li><li>  DGApiClient </li></ul>  Consider these extensions in order. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  DGSphinxSearch </h4><br>  Sphinx is a high-performance, full-text search engine that you probably know well.  The extension allows you to implement both procedural and object-oriented approach to the formation of queries and work with data.  The extension is fully integrated into yii and allows you to monitor your work using standard framework tools.  To work on servers where C ++ is not installed - an extension for PHP, the mode of operation through a script library is supported. <br><br>  For example, let's try to find no more than 30 entries among users named Vasily: <br><br><pre><code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$userlist</span></span> = Yii::App()-&gt;sphinx-&gt;select(<span class="hljs-string"><span class="hljs-string">'name'</span></span>)-&gt;from(<span class="hljs-string"><span class="hljs-string">'users'</span></span>)-&gt;<span class="hljs-built_in"><span class="hljs-built_in">where</span></span>(<span class="hljs-string"><span class="hljs-string">''</span></span>)-&gt;<span class="hljs-built_in"><span class="hljs-built_in">limit</span></span>(0, 30)-&gt;search();</code> </pre> <br>  It has become significantly smaller than when using the original library for Sphinx. <br><br>  Details are on the extension page on the yii website: <a href="http://www.yiiframework.com/extension/dgsphinxsearch/">www.yiiframework.com/extension/dgsphinxsearch</a> <br><br><h4>  AMQP </h4><br>  RabbitMQ is a fast messaging server written in the Erlang fault-tolerant language. <br><br>  The extension simplifies not only with RabbitMQ, but also with any MQ servers that support the AMQP protocol, and allows you to send and receive messages from the server, and also supports debugging mode of operation when there is no direct connection to the server. <br><br>  To send a message to the outbox, we do: <br><br><pre> <code class="bash hljs">Yii::App()-&gt;rabbitMQ-&gt;exchange(<span class="hljs-string"><span class="hljs-string">'outbox'</span></span>)-&gt;publish(<span class="hljs-string"><span class="hljs-string">'!'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>);</code> </pre><br>  To receive a message from the inbox queue, which is subscribed to the outbox, we do: <br><br><pre> <code class="bash hljs">Yii::App()-&gt;rabbitMQ-&gt;queue(<span class="hljs-string"><span class="hljs-string">'inbox'</span></span>)-&gt;get();</code> </pre><br><br>  Extension page: <a href="http://www.yiiframework.com/extension/amqp/">www.yiiframework.com/extension/amqp</a> <br><br><h4>  MQLogRouter </h4><br>  A very convenient logging and profiling system is built into yii.  In the base delivery, it allows you to save logs to the file system, to the database, or output to the browser.  We added a special LogRoute, which sends logs to the MQ server. <br><br>  The convenience of the solution is manifested when there is a need to analyze the interaction of several separate applications interacting through REST or SOAP interface and leading logs on different servers. <br><br>  <a href="http://www.yiiframework.com/extension/cmqlogroute/">www.yiiframework.com/extension/cmqlogroute</a> - the connection instruction is quite simple and comes down to configuring the application config. <br><br><h4>  DGPinbaLogRoute </h4><br>  <a href="http://pinba.org/">Pinba</a> is a server monitoring and code profiling tool.  Due to the fact that the packets to the server are sent asynchronously, the transfer does not affect the performance of your application.  Pinba itself collects summary statistics on the execution of each script and allows it to be used in real time. <br><br>  To send logs to Pinba, it is enough to connect DGPinbaLogRoute as a yii-logger and call the usual ones for yii: <br><br><pre> <code class="bash hljs">Yii::beginProfile(); ‚Ä¶..; Yii::endProfile();</code> </pre><br>  Learn more here: <a href="http://www.yiiframework.com/extension/dgpinbalogroute">www.yiiframework.com/extension/dgpinbalogroute</a> <br><br>  We see the next step in the visualization of the collected statistics and plan to share the corresponding module. <br><br><h4>  DGApiClient </h4><br>  APIClient is a PHP wrapper for our <a href="http://api.2gis.ru/">API 2GIS</a> product.  The product itself allows applications to receive 2GIS reference data for more than 1 million organizations and create local search services on their basis or use them on already existing city portals, thematic sites and other projects. <br><br>  The extension facilitates integration tasks and allows the developer to abstract from the implementation of REST requests and work with the API directly from PHP code.  Consider an example of how to use it. <br><br>  For example, here we get a list of 10 geo-objects 100 meters from the point 82.901886,54.991984 in the xml-format: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$list</span></span> = Yii::App()-&gt;apiClient-&gt;geoSearch(array( <span class="hljs-string"><span class="hljs-string">'q'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'82.901886,54.991984'</span></span>, <span class="hljs-string"><span class="hljs-string">'radius'</span></span> =&gt; 100, <span class="hljs-string"><span class="hljs-string">'limit'</span></span> =&gt; 10, ), <span class="hljs-string"><span class="hljs-string">'xml'</span></span>);</code> </pre><br>  And now we are looking for 10 companies for the request "beer" in the vicinity of the Arbat in Moscow: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$list</span></span> = Yii::App()-&gt;apiClient-&gt;search(array( <span class="hljs-string"><span class="hljs-string">'where'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'what'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'limit'</span></span> =&gt; 10, ), <span class="hljs-string"><span class="hljs-string">'xml'</span></span>);</code> </pre><br>  If we want to receive the answer in the form of objects, it is enough to replace 'xml' with 'object'. <br>  The full list of methods is given in the API documentation on <a href="http://api.2gis.ru/">api.2gis.ru</a> <br><br>  * * * <br><br>  A complete list of yii extensions that our development teams post can be found on the framework's framework for the 2GIS tag: <a href="http://www.yiiframework.com/extensions/%3Ftag%3D2GIS">www.yiiframework.com/extensions/?tag=2GIS</a> <br><br>  Of course, this is not all that we would like to share.  In the future, we plan to lay out an extension for ActiveRecord, which can work with several database servers at the same time, and a task manager, which allows you to run various tasks, controlling their order and number.  If the applications described are in demand, we will continue to make our small contribution to the large and important Open Source movement. </div><p>Source: <a href="https://habr.com/ru/post/132029/">https://habr.com/ru/post/132029/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132024/index.html">Solid Limestone Column by Audiomasons</a></li>
<li><a href="../132025/index.html">Mobile application for Windows Phone 7 for Tech ‚àô Ed Russia 2011 conference visitors</a></li>
<li><a href="../132026/index.html">Linux Mint distribution ranked first in the DistroWatch rating</a></li>
<li><a href="../132027/index.html">Vkontakte went to meet the owners?</a></li>
<li><a href="../132028/index.html">Anonymous attacked the computers of the Government of Israel</a></li>
<li><a href="../132031/index.html">Regression Testing Layout. Idea of ‚Äã‚Äãautomation</a></li>
<li><a href="../132032/index.html">PayPal or "Pay, my friend"</a></li>
<li><a href="../132033/index.html">Windows Azure support in ABBYY products for developers</a></li>
<li><a href="../132034/index.html">GAZ Compiler - replacement for standard BAT-files in the Windows operating system</a></li>
<li><a href="../132036/index.html">Google has started advertising under search results.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>