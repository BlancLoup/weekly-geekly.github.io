<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Amazing USB flash drive device Kingston DataTraveler DT6000 and recovery of information lost due to failure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings dear Habrovchan. I am Artem Makarov aka Robin, a leading engineer at Hardmaster, for many years specializing in data recovery from a variety...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Amazing USB flash drive device Kingston DataTraveler DT6000 and recovery of information lost due to failure</h1><div class="post__text post__text-html js-mediator-article">  <b>Greetings dear Habrovchan.</b>  I am Artem Makarov aka Robin, a leading engineer at Hardmaster, for many years specializing in data recovery from a variety of media.  Today I would like to share with you the history of file recovery from one very curious flash drive.  I hope to get feedback on your blog in the comments. <br><br>  In spite of the fact that there was a huge pile of devices, I had never encountered a task like the one described below. <br><a name="habracut"></a><br><h3>  Preamble </h3><br>  So, Kingston DT6000 USB Flash Disk, declared by the manufacturer, as a reliable file storage, using the crypto-resistant algorithm AES256 FIPS140-2 Level 3. <br><br>  Logically, the flash is arranged as follows: a section of 68 megabytes formatted in FAT16 is kind of bootable.  When the device is connected to the PC, autorun is triggered (or the user is prompted to start the executable): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/bf1/b12/c35/bf1b12c3528045b7aad07297390dfccf.jpg"><br><br>  After that, the following window comes to the fore: <br><br><img src="https://habrastorage.org/files/455/bde/b1a/455bdeb1adb64024856ec06f81208bc8.jpg"><br><br>  Enter the password, voila - mounted hidden section with carefully hidden photos and videos of known content. <br><br>  But the user got into trouble one bad day, inserted a flash drive, and the ‚Äúbootloader‚Äù was empty.  With a password, it turned out that it was stupid not to be able to enter this password anywhere.  Brought the disk to the diagnosis to us. <br><br>  First of all, by connecting the drive to a test PC and opening WinHEX‚Äôs favorite hex editor, I went to the list of physical disks.  So there are two volumes.  The first one is empty, and, most importantly, in ‚Äúread only‚Äù mode!  Second unavailable.  Removed the image from the first section, analyzed.  Both copies of the FAT tables in normal form are missing. <br><br><img src="https://habrastorage.org/files/68a/f96/c05/68af96c05f424c74aad3dfc9f2c26e45.jpg"><br><br>  That is, with the ability to get from the ‚Äúboot partition‚Äù files with names and structure, you can say goodbye.  ‚ÄúDraft recovery‚Äù or recovery from known file headers (it‚Äôs also raw recovery) managed to pull out a certain zip archive and pdf-ku.  From the content of the latter, it became clear how everything was arranged, and what was missing on the boot partition. <br><br>  Considering that the producer is locked to the partition, it was clear that there could be no random formatting by the user‚Äôs speech, in this case, the most likely reason for ‚Äúnulling‚Äù the partition is a failure in the field of NAND processing translation tables, as a result part of the correct blocks was replaced by ‚Äúalternative‚Äù. <br><br>  This effect is called a ‚Äúpseudo-logical problem with a flash drive‚Äù and looks like a glitch at the file system level, in fact being a malfunction, in fact, a hardware one.  So, most likely, you will have to transfer the flash drive to the pathoanatomical table and subject it to an autopsy, in order to solder the memory chip (s) and try to collect something meaningful from the read images. <br><br>  About encryption and how to collect dumps with encrypted content in general, at that time I didn‚Äôt bother with the head. <br><br>  Problems are supposed to be solved as they appear, so the first thing you had to do was find DT6000_Launcher with the whole environment.  On the manufacturer's website, the corresponding product download section was empty.  It is logical - it makes sense to upload files if you are supposed to be unable to record them (see the locked record)?  Threw a cry to colleagues.  The necessary files have been sent.  The next problem is to tell the launcher where we have encrypted. <br><br>  Attempts to unlock the FAT16 partition on the flash drive itself with OS tools and write a launcher to it were not successful.  Attempts to launch the launcher from another medium and set the studied flash drive on the same way were unsuccessful.  Further hardware intervention in the interior of Date Traveler became inevitable. <br><br><h3>  ‚ÄúWell, today we will have several sensations ...‚Äù (c) </h3><br>  After removing the outer plastic case, the investigator‚Äôs inquiring gaze revealed this: <br><br><img src="https://habrastorage.org/files/ec1/785/fca/ec1785fcad37446f856efb35d28c30e4.jpg"><br><br>  With the exception of the USB connector, everything is filled with plastic.  It was possible to remove it with the help of a thermoair soldering station, heating the region after the region to a temperature of about 150 ¬∞ C, after which the plastic began to slowly bend and break off in small pieces.  Wielding dental hooks and a scalpel, feeling like an archaeologist, cleaned one side of the plastic.  Saw the following: <br><br><img src="https://habrastorage.org/files/b99/54a/c3e/b9954ac3e80241cc9c6a13aa30316d04.jpg"><br><br>  ARM-controller LPC3131FET180, pliska 3s500e (it is PLISS, PLD is a programmable logic integrated circuit) from XILINX, ROSETTA crypto module from Spyrus and Atmelovskaya ROM-card 25DF081A.  It is necessary to take up the second half, because the desired NAND memory has not yet been found. <br><br>  I start to clean the second side.  Something brilliant appears.  Quartz?  Does not look like it.  Another pair of sweeping blows of a sledgehammer and a chisel, an optics - a card reader! <br><br><img src="https://habrastorage.org/files/59d/1a5/cfb/59d1a5cfb0d540f9aff16ee0df39eeef.jpg"><img src="https://habrastorage.org/files/787/166/db2/787166db28744b3c9d00dd6de6bb59f1.jpg"><br><br>  Looks crisis hit and Kingston.  In order not to bother with the hardware implementation of a full-fledged flash drive, the eagles from the Kingston corporation purchased a batch of MicroSD from Uncle Liao at a reasonable price and hung up a cryptographic bar, richly filling everything with fast-setting plastic.  So that no one guessed it.  Given the impressive price list for which this DT6000 is being sold on the same YandexMarket, the manufacturer‚Äôs profit is obvious. <br><br>  Vykupuvaem micro-sshku, everything is filled with plastic and glued on all sides.  We clean the leftovers, except for the strapping there is nothing more to look at. <br><br><img src="https://habrastorage.org/files/7bc/5f4/e2b/7bc5f4e2b2e9437ca549b6f431814878.jpg"><img src="https://habrastorage.org/files/4b3/17b/51a/4b317b51a9d54e8e918dd43ca3a130c0.jpg"><br><br><h3>  Finish line </h3><br>  I insert the microSD plastic removed from the rubble into the card reader.  A flash drive is defined for all its 16 gigs.  From the zero sector, white noise is characteristic for encryption. <br><br><img src="https://habrastorage.org/files/3da/eb0/a34/3daeb0a346ee4985a00a16c84e9da54e.jpg"><br><br>  Approximately from the middle - zeros.  I look down the drain.  Oops - here comes our ‚Äúboot‚Äù section!  I determined the beginning and ending of the section, compared it with the previously removed image, when the rootless MicroSD was still thoroughbred Kingston DataTraveler - no differences were found. <br><br><img src="https://habrastorage.org/files/2c3/e93/df7/2c3e93df73f245eea0668c3afe3d8d21.jpg"><br><br>  In view of the additional circumstances that have opened up, the initial hypothesis of block substitution in the NAND translation table is assigned the status ‚Äúuntenable‚Äù, and the workplace is replaced with an assumption of a cryptographic code glitch, which is also the builder of the presentation of the logical markup micro-SD on the DT6000 USB interface. <br><br>  I take a live 32-gigovy USB flash drive.  I prescribe, for the purity of the experiment, in the same WinHack with its zeros from top to bottom.  I start writing a previously bent section.  On it I write down the hard-won launcher, dt6000.zip and manifest.xml.  I start, enter the password, a message stating that the encrypted partition was not found or is damaged. <br><br>  In the sector following the last sector of the ‚Äúboot‚Äù partition I enter the image of the entire encrypted MicroSD in its entirety. <br>  I launch the launcher, enter the password.  Bingo!  Encrypted partition found, mounted, <br><br><img src="https://habrastorage.org/files/666/5bd/a25/6665bda253b046e598c17cabe773613e.jpg"><br><br>  All user files in place - you can copy. </div><p>Source: <a href="https://habr.com/ru/post/250327/">https://habr.com/ru/post/250327/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../250315/index.html">Microsoft released a set of updates for its products, February 2015</a></li>
<li><a href="../250319/index.html">Eliminate spaces, learn Android</a></li>
<li><a href="../250321/index.html">Programming on PureData. Part 0</a></li>
<li><a href="../250323/index.html">Debugging with XDebug and PhpStorm (addition)</a></li>
<li><a href="../250325/index.html">Deploying Windows Server 2012 R2 to Dell servers in BARE-METAL mode. Part 2</a></li>
<li><a href="../250329/index.html">Visualization and decoding of data from magnetic ATM cards</a></li>
<li><a href="../250331/index.html">Non-standard top security news: January</a></li>
<li><a href="../250333/index.html">Digest of good educational programs for IT-specialists and sympathizers: in Moscow and online</a></li>
<li><a href="../250335/index.html">How does ABAP Secure Storage work in SAP?</a></li>
<li><a href="../250337/index.html">We are forbidden to even talk about cryptocurrency?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>