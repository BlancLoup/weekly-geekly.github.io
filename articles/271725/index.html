<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Yandex announces its own weather forecasting technology Meteum. Accurate to home</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we are announcing a new technology Meteum - now with its help Yandex.Pogoda will build its own weather forecast, and not rely only on the data o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Yandex announces its own weather forecasting technology Meteum. Accurate to home</h1><div class="post__text post__text-html js-mediator-article">  Today we are announcing a new technology <a href="https://pogoda.yandex.ru/meteum">Meteum</a> - now with its help Yandex.Pogoda will build its own weather forecast, and not rely only on the data of partners, as it was before. <br><br>  Moreover, the forecast will be calculated separately for each point from which you request it, and recalculated every time you look at it, to be as up-to-date as possible. <br><br> <a href="http://habrahabr.ru/company/yandex/blog/271725/"><img src="https://habrastorage.org/files/67f/c53/3f6/67fc533f66d54e688619ff8fb2c24c0e.jpg"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this post I want to tell a little about how the world of weather models is arranged in our time, how our approach differs from the usual ones, why we decided to build our own forecast and why we believe that we will succeed better than everyone else. <br><br>  We built our own forecast using the traditional atmospheric model and the most detailed grid, but also tried to collect all possible sources of data on atmospheric conditions, statistics on how the weather behaves in practice, and applied machine learning to this data to reduce the likelihood of errors. <br><br>  Now in the world there are several basic models that predict the weather.  For example, the open source <a href="https://en.wikipedia.org/wiki/Weather_Research_and_Forecasting_Model"><abbr title="Weather Research and Forecast">model WRF</abbr></a> , the GFS model, which was originally an American development.  Now <a href="http://www.noaa.gov/"><abbr title="National Ocean and Atmospheric Administration">NOAA</abbr></a> is engaged in its development. <br><a name="habracut"></a><br>  The WRF model is supported and developed by scientists around the world, but it also has an official version ‚Äî its development and support is handled by the American scientific institute <a href="http://ncar.ucar.edu/"><abbr title="National Center For Atmospheric Research">NCAR</abbr></a> , located in Boulder, Colorado.  Initially, the WRF developed as two parallel branches - <abbr title="Advanced Research WRF">ARW</abbr> and <abbr title="Nonhydrostatic Mesoscale Model">NMM</abbr> , now abolished.  GFS and WRF models have a slightly different development vector (GFS distributes global and US-oriented products).  WRF is primarily a local model that can be customized for a specific terrain. <br><br><h1>  Part 1. About classical meteorology </h1><br>  At its core, WRF is an open source program written in Fortran (see box) and reflecting the current understanding by scientists of the laws of physics and the dynamics of the atmosphere and, accordingly, the weather.  Like any self-respecting representative of open source software, WRF does not work out of the box.  That is, probably, most linuksoids will be able to run it, but only after a fair amount of time spent on reading manuals and compiling.  In this case, the quality of weather predictions using the raw version can be unpleasantly surprising.  WRF was created to describe a complex dynamic system - the atmosphere of the Earth, and therefore needs to be carefully tuned. <br><br><blockquote>  <b>Lyrical digression about FORTRAN</b> <br>  It is clear that FORTRAN is probably not the best choice for building large open source systems.  But there are two good reasons not to rewrite WRF into other languages.  The first - the code, as they say, is time tested: more than one generation of scientists contributed to the formation of a physical model.  In addition, this code is widely supported by scientific groups around the world.  The second reason is that describing such a complex system as the environment around us requires considerable computational resources.  Modern compilers, such as Intel Fortran, allow you to build executable files so that they run with maximum performance. </blockquote><br>  The whole process of the model can be divided into two conditional parts: the prediction of physics and the prediction of dynamics.  The WRF physical modules track the amount of heat that is released and absorbed in the atmosphere, as well as the formation of precipitation at the right time and place.  Dynamics is the movement of air masses, the wind rose, the formation of cyclones and so on.  For physics, there is a set of semi-empirical models, one for one process or another, for dynamics, a parameterized version of <a href="https://en.wikipedia.org/wiki/Euler_equations_(fluid_dynamics)">the Euler equation</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/046/9bb/4f0/0469bb4f06ea1063e478f1af7507ff2d.gif" alt="image"><br><br>  The picture shows a slice of the calculated model grid.  The results of the temperature calculations are displayed in the color of the cells and are mainly the result of physical processes ‚Äî heating and cooling.  The arrows show the transfer of air masses, that is, the result of the calculation of the dynamics. <br><br>  The Euler equation is a partial differential equation.  It is clear that a computer cannot solve partial differential equations without help.  Help in this case is to decompose the equations of the mathematical model into finite-difference schemes.  That is, by representing the derivatives as differences, you can get the most correct solution to the equation. <br><br>  The difficulty, however, is not only to bring the numerical solution as closely as possible to the analytical one that has not yet been found.  It is also to adequately parameterize the processes that control the atmosphere from the outside.  Solar radiation, thermal radiation of the soil, the influence of greenhouse gases, phase transitions of water vapor - this is an incomplete list of all that needs to be taken into account when trying to predict the weather. <br><br>  Probably, this task would be very very heavy, if not for observation.  During the years in which humanity was interested in future weather conditions (and this is a long time), some experience in conducting atmospheric measurements has accumulated.  Such things as weather stations, satellite spectrometers, aircraft instruments, radars, lidars were invented - but what else could it be.  The amount of data that is minimally needed to make a forecast at an accuracy level that meets modern standards should use all available information sources: more than 10,000 weather stations around the world, more than 80 satellites in near-earth orbit, about 1,500 stations of radiological sensing. <br><br><img src="https://habrastorage.org/files/126/ec0/fab/126ec0fab37d410ea0227d6e41406187.png"><br><br>  Now, observations of the atmosphere around the globe, taken at one fixed point in time, are terabytes of station observations, radar scans and satellite imagery.  They are few in order to fully describe the current state of the atmosphere, but they can be used to refine the initial conditions of the model. <br><br><img src="https://habrastorage.org/files/480/224/045/4802240451f044289649343460b0c86e.png"><br>  <i>Some of the atmospheric observation methods available to mankind</i> <br><br>  Since the accuracy of solving differential equations depends largely on the accuracy of the initial conditions, all observational data are used to compile the most accurate field of atmospheric parameters.  To reconcile model calculations and isolated experimental data, there is a data assimilation technology that inherits a sophisticated mathematical apparatus from control theory and <a href="https://en.wikipedia.org/wiki/Calculus_of_variations">calculus of variations</a> .  Thus, in addition to numerical models, the data of synchronous observations from orbit and ground stations help us in weather forecasting. <br><br>  Now our system of computational areas of the numerical model is designed to cover the territory of our vast country with two types of predictions - on a grid with a rough resolution (6 by 6 km) and on a grid with a fine resolution (2 on 2 km).  These grids are nested in each other and interact, passing between the data on the boundary and initial conditions. <br><br>  To calculate, process and store the parameters of the atmosphere on such a scale, huge computational power is needed.  The daily volume of incoming forecasts to the repository is more than 10 TB.  The weather forecast for 48 hours with a given level of detail for the Moscow region even on Yandex clusters takes about 6 hours. <br><br>  The weather forecast is calculated every time a user accesses the service.  This is dictated not only by the desire to give the most accurate current weather forecast specifically for the coordinates of the user, but also by severe necessity.  The fact is that the amount of high-resolution weather data is so large that it will take several hours to predict such a forecast over the territory of our entire country, and not a single runtime base will be able to respond to requests in a reasonable time.  This is also true not only for the results of Meteum, but also for some models that are included in its composition.  For example, the GFS and WRF models transmit so much information that microservice was organized for their transfer to the API, which, unlike many databases, stores, updates and sends data directly from the memory of machines included in the microservice. <br><br><img src="https://habrastorage.org/files/8de/296/c9a/8de296c9a1dd4b12a2e817467229a5cb.jpg"><br><br>  So at one of the early stages of the work, the location of the calculated areas in the central region of the Russian Federation looked like.  Red - external domain with a grid of 6 to 6 km, blue - nested areas with higher resolution (2 to 2 km) <br><br>  The system of receiving, processing and analyzing data, model calculations and their combination in the data assimilation algorithm is a chain of many links.  In addition to the correct processing of incoming data, it is necessary to properly configure their assimilation in the initial conditions for differential equations.  The theory of data assimilation, the science of the correct combination of observations with predictions of mathematical models, is responsible for the development and physical justification of these algorithms.  However, observations of the state of the atmosphere, which we obtain from various sources, may be useful for other purposes. <br><br><h1>  Part 2. About machine learning </h1><br>  WRF is the standard of the weather forecasting industry, however there are other models: we receive forecasts made using them from our partners.  Despite all the knowledge of mankind about atmospheric processes, satellites and supercomputers, all these models, as you know, are mistaken.  It is interesting that in their forecasts there are systematically replicable patterns. <br><br>  In addition to the WRF model itself, which is calculated on Yandex clusters, we get forecasts for 12,000 cities around the world, made by one of our partners, Foreca.  More detailed information about the global state of the atmosphere comes to us from the US model of the <a href="https://en.wikipedia.org/wiki/Global_Forecast_System">Global Forecast System</a> , which is considered one of the most accurate global models in the world and has a resolution of 0.25 degrees. <br><br><img src="https://habrastorage.org/files/903/efe/bcf/903efebcf6f54e41b9e7f4c5b74b72b5.png"><br><br>  The behavior of these models in different meteorological situations allows Meteum to more accurately assess the adjustments that need to be made to the forecast and optimally select a combination of source data. <br><br>  Some of the models of the weather forecast overstate the amount of precipitation on the earth, others lower the night-time temperature within the city.  Having at our disposal an archive of model predictions, one can single out a lot of such regularities, including much less obvious than those I mentioned above.  It is quite difficult for a person to do this because of the huge amounts of data, but the machine learning algorithms do a great job with this.  To identify patterns and relationships between model predictions and the actual meteorological situation, we use the Matriksnet machine learning algorithm that you know. <br><br>  Matrixnet accepts the input of specially processed archives of weather forecasts and compares them with data on the real meteorological situation.  Observations obtained at thousands of professional weather stations around the world are used as real weather data. <br><br>  As a result of such comparisons, a forecast adjustment formula is obtained, which, depending on the meteorological situation, constitutes the optimal combination of forecasts from the given models provided by our suppliers. <br><br><img src="https://habrastorage.org/files/4c3/96a/a85/4c396aa85ee54c46b87dad1f4e2efe8f.png"><br><br>  Meteum uses a huge amount of data, and this is just the beginning.  For example, in some regions of Russia, accurate meteorological measurements are quite rare. <br><br><img src="https://habrastorage.org/files/443/407/71c/44340771c8704389bc0b8734b508b731.jpg"><br><br>  They are not enough to build a hyperlocal forecast.  Therefore, Meteum is able to use a large amount of data indirectly pointing to meteorological conditions.  We already use Yandex.Maps data that help us take into account the terrain landscape.  I will give one more example.  Many phone models have barometers built-in.  They are not as accurate as in weather stations, but there are millions of them.  And they are distributed where people live.  Next year we will start using their data to clarify the actual state of the atmosphere. <br><br><img src="https://habrastorage.org/files/de0/716/c1b/de0716c1bc0e4a6987b0b3b347f2a962.png"><br><br>  In addition, right now in the Yandex.Pogoda applications there is an opportunity to tell you about the weather right now where you are.  We initially created Meteum expandable for various classes of data that indirectly indicate the weather, so we can take into account your observations. <br><br><h1>  Part 3. Behind blue eyes </h1><br>  Habr's readers, probably, are especially clearly aware that behind the processes described above, there should be an appropriately designed infrastructure. <br><br>  Real-time model predictions needed for Meteum operation are collected from several different sources.  The forecasts of WRF and GFS in microservice weigh more than 60 GB and are updated every minute.  And they do it atomically, in large pieces.  Such requirements made it impossible to use traditional runtime databases.  Foreca's forecasts are stored in PostgreSQL, since their volumes and update frequency are much lower.  After processing and displaying to the user, the results of the formula, along with the component parts (supplier forecasts and other factors transferred to Matrixnet), are sent to the MapReduce cluster.  This data is subsequently used to verify and further customize the operation of Meteum. <br><br><h1>  Part 4. Total Runtime </h1><br>  All those processes that we described above occur every time a user logs in to Yandex. Weather.  When making a request, you send your geographic coordinates to Meteum.  It collects all the data necessary for forecasting, analyzes the meteorological situation, the type of underlying surface and, based on this data, makes its own forecast specifically for your position. <br><br><img src="https://habrastorage.org/files/9a5/4ae/c47/9a54aec477ce4b80b6440fc5035871d8.png"><br><br><h1>  Part 5. What happened </h1><br>  According to our own estimates (alas, there are no independent meters in this area yet), for today our weather forecast is more accurate than all the competitors we know.  For example, the temperature forecast for 24 hours, we are mistaken for 35% less than the nearest competitor. <br><br>  But we understand that the ideal is still far away, and we hope that after a while we will be able to further increase the accuracy, thanks to data from users of the application, as well as additional sources of information about the atmosphere. </div><p>Source: <a href="https://habr.com/ru/post/271725/">https://habr.com/ru/post/271725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271713/index.html">"Darknet Weekdays" - video materials for training on information security</a></li>
<li><a href="../271717/index.html">Social engineering first hand</a></li>
<li><a href="../271719/index.html">Spring MVC / Security, REST, Hibernate, Liquibase run in two lines</a></li>
<li><a href="../271721/index.html">Biometrics: Time Attendance + Fujitsu PalmSecure</a></li>
<li><a href="../271723/index.html">Writing FEM calculator in less than 180 lines of code</a></li>
<li><a href="../271727/index.html">Draw, draw, draw: Inkscape 0.92 coming soon</a></li>
<li><a href="../271729/index.html">PythonDigest - issue number 100 and other great news</a></li>
<li><a href="../271731/index.html">OOP in 1C do it yourself. How to simulate your classes and objects, and why it is needed</a></li>
<li><a href="../271733/index.html">Why would a developer scoff at his own code</a></li>
<li><a href="../271735/index.html">Writing data to Teradata using DML</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>