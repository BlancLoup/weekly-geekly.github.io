<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Informational messages in 1C. How can I do that</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. 
 Today we will discuss the implementation of the subsystem of issuing information messages to the user. The standard way to inform a user abou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Informational messages in 1C. How can I do that</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a84/e44/3a0/a84e443a0ce74e80b5833bc74660d3f5.jpg"><br>  Hello. <br>  Today we will discuss the implementation of the subsystem of issuing information messages to the user.  The standard way to inform a user about something is to use the ‚Äú <b>Report</b> ‚Äù procedure.  However, in some cases, I want to create a separate list that will not trash its output with the main list of platform messages.  It is also desirable to be able to highlight different messages in color (depending on their type, for example).  In general, I will tell you how I did it.  The solution given in the article can be embedded in your program without any adaptation. <br><a name="habracut"></a><br><h1>  Prehistory </h1><br>  At one time, while working with the <a href="https://ru.wikipedia.org/wiki/Perforce">Perforce</a> version control system, namely with its graphic clients, I noticed a convenient interface element - a multi-line message output field at the bottom of the main program window.  After the user made any calls to the server of the system, text messages were added to this field describing the process of interaction between the client and the server (what actions were performed and the result of their execution).  I don‚Äôt know why Perforce made such an impression on me, although I watched absolutely the same system before and after in various graphic IDEs (Delphi, C ++, etc.) - the message window of that console program (compiler or version control client) ), which serves as a shell graphic program.  But however, the article is not about Perforce at all, I just think that a convenient way to multiline output messages in the process of doing some lengthy work.  To get a large list of messages is much better (more informative) than a single MessageBox at the very end of this work.  By the way, we see a similar approach in antivirus programs. <br><br>  To create my own message subsystem, I was prompted to implement a program that performs a relatively long data processing process (i.e., the user pressed the ‚Äú <i>Run</i> ‚Äù button, and then, relatively speaking, can wait for a few minutes while the process is running).  Similar programs (processing) are in typical 1C configurations (mainly, these are different unloading-loading).  The standard message window of the platform (where the information is displayed by the ‚Äú <b>Report</b> ‚Äù procedure) did not suit me.  I wanted the messages related to my processing to be grouped, and not mixed with any other messages.  I also wanted the list of messages to be somehow saved just in case (to a text file, as is done in antiviruses).  Well and most importantly, I planned to make different types of messages (information, warnings, error messages).  Well, respectively, paint them in different colors. <br><br>  In this example, the table of the message output ( <b>Tabular field</b> interface element) looks like this: <br><img src="https://habrastorage.org/files/eba/c01/180/ebac011801a145979913236e346bd309.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Description of implementation. </h1><br>  In general, I will describe here what happened.  For implementation, I will again use my own technology ‚ÄúOOP in 1C‚Äù (the method is described in detail <a href="https://habrahabr.ru/post/271731/">here</a> ).  Accordingly, a ‚Äúclass‚Äù will be created: ‚Äú <i>Messages</i> ‚Äù. <br>  In the following explanations, we will assume that we are doing external processing. <br><br>  We need icons to display message statuses.  Let's load from the corresponding BMP-files (are attached to this article) into resources (‚ÄúBinary data‚Äù type layouts) <br><table><tbody><tr><th>  Picture </th><th>  Source file name </th><th>  Layout Name </th></tr><tr><td><img src="https://habrastorage.org/files/2d6/42a/001/2d642a0013aa44789b19f169d6ae04e2.jpg"></td><td>  statok.bmp </td><td>  PictureMessageStatus </td></tr><tr><td><img src="https://habrastorage.org/files/3a3/2a1/35f/3a32a135fa244a6bb16e445760eb34ca.jpg"></td><td>  statwarning.bmp </td><td>  PictureMessageStatusWarning </td></tr><tr><td><img src="https://habrastorage.org/files/5a9/e4d/782/5a9e4d7825ec419e803645f53c511b77.jpg"></td><td>  staterror.bmp </td><td>  ImageMessageStatusError </td></tr></tbody></table><br>  Then you will need to somehow upload these pictures for use - turn them into resources. <br>  In the main module, we define the global variable ‚ÄúCollection of Pictures‚Äù in the form of a structure from objects of the standard class ‚ÄúPicture‚Äù.  We will write the subprogram ‚ÄúCreate a Collection of Pictures‚Äù, which will initialize the collection.  We will call this subroutine in the initialization section of the module. <br><br>  Also, our messages will have some numeric types - levels.  The level number will affect the number of indents from the whitespace characters on the left when displaying a message in the interface or file (as if we clearly show the level of nesting of the messages into each other). <br><table><tbody><tr><th>  Title </th><th>  Description </th><th>  Numerical value </th></tr><tr><td>  TIPSOBNG_NEWRED </td><td>  Indefinite value </td><td>  0 </td></tr><tr><td>  TIPSOOLER_LEVER1 </td><td>  Nesting level 1 </td><td>  one </td></tr><tr><td>  TIPSOOLER_LEVER_2 </td><td>  Nesting level 2 </td><td>  2 </td></tr><tr><td>  TIPSOOBT_LEVER3 </td><td>  Nesting level 3 </td><td>  3 </td></tr></tbody></table><br>  Each message has a specific status indicating what the message is. <br><table><tbody><tr><th>  Title </th><th>  Description </th><th>  Numerical value </th></tr><tr><td>  STATSGET_NEWR </td><td>  Indefinite value </td><td>  0 </td></tr><tr><td>  STATSMOB_G </td><td>  Nesting level 1 </td><td>  one </td></tr><tr><td>  STATSMOBSH_PRODUPR </td><td>  Nesting level 2 </td><td>  2 </td></tr><tr><td>  STATSGEND_ERVISION </td><td>  Nesting level 3 </td><td>  3 </td></tr></tbody></table><br>  Imagine types and statuses as numeric constants, as is done in C / C ++ ( <b>#define</b> ) or Pascal ( <b>const</b> ).  In 1C, we will simulate the constants by inserting them into the global variable structure (the key of the structure element is the symbolic name of the constant, and the value of the structure element is the numerical value of the constant). <br><pre><code class="1c hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword"></span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title"></span></span></span><span class="hljs-function">()</span></span>  = <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-type"><span class="hljs-type"></span></span>; <span class="hljs-comment"><span class="hljs-comment">//   .("_", 0); //   .("_1", 1); //   1 .("_2", 2); //   2 .("_3", 3); //   3 //   .("_", 0); //   .("_", 1); //  "" .("_", 2); //  "" .("_", 3); //  ""   </span></span></code> </pre> <br>  We will also need to get the current time in milliseconds.  We use for this the JavaScript machine as a global variable of the COM object. <br><br>  Here‚Äôs what happened in the main module: <br><div class="spoiler">  <b class="spoiler_title">Source text</b> <div class="spoiler_text"><pre> <code class="1c hljs"><span class="hljs-comment"><span class="hljs-comment">//////////////////////////////////////////////////////////////////////////////// //     ; //      ; //    //////////////////////////////////////////////////////////////////////////////// //    JavaScript; //     JavaScript /////////////////////////////////////////////////////////////////////////////////////////////////// // //                                  // /////////////////////////////////////////////////////////////////////////////////////////////////// //      // // : // . // // : //    -    //  ()  =  ; //   .("_", 0); //   .("_1", 1); //   1 .("_2", 2); //   2 .("_3", 3); //   3 //   .("_", 0); //   .("_", 1); //  "" .("_", 2); //  "" .("_", 3); //  ""    //   ,   ,    //  . // // : // . // // : //    -       //  ()  =  ; .("",  ((""))); .("",  ((""))); .("",  (("")));    /////////////////////////////////////////////////////////////////////////////////////////////////// // //                                              // /////////////////////////////////////////////////////////////////////////////////////////////////// //   JavaScript       //   ,   ,    //  . // // : // . // // : //    JavaScript  ,     //  JavaScript()  = ;   =  COM("MSScriptControl.ScriptControl"); .Language = "javascript";  ;    /////////////////////////////////////////////////////////////////////////////////////////////////// // //                             // /////////////////////////////////////////////////////////////////////////////////////////////////// //      ,    // // : //  -   //  - -       // : //   //  (, )  = ;  =  - ();   &gt; 0   = " " + ;  =  - 1 ;    //      ,    // // : //  -   //  - -       // : //   //  (, )  = ;  =  - ();   &gt; 0   =  + " ";  =  - 1 ;    //        // // : //  // : //    0,      //  ()   = 0;  JavaScript &lt;&gt;    = JavaScript.Eval("new Date().getTime()"); ;  ;  //////////////////////////////////////////////////////////////////////////////// //    -   //   //     = (); //    = (); //    //   JavaScript JavaScript = JavaScript();</span></span></code> </pre><br></div></div><br>  A set of messages exists in the form of a table of values ‚Äã‚Äã(standard Table of Values ‚Äã‚Äãclass) with the following columns: <br><table><tbody><tr><th>  Column name </th><th>  Data type </th><th>  Purpose </th></tr><tr><td>  TypeCommun </td><td>  Number </td><td>  Message type (level) - one of the constants TIPSOOBSH_ </td></tr><tr><td>  StatusMessage </td><td>  Number </td><td>  Message status - one of the constants </td></tr><tr><td>  Report Text </td><td>  Line </td><td>  The main text of the message.  Here we usually indicate which action is being performed by a long process at the moment. </td></tr><tr><td>  CommentMessage </td><td>  Line </td><td>  Additional message text.  Here we usually indicate the result of performing the action described in the TextCommon column.  If the action failed, then the error message is given in the same column. </td></tr></tbody></table><br>  This table of values ‚Äã‚Äãcan already be displayed in some user interface elements (for example, in the <b>Table Field</b> object). <br><br>  A set of messages will be implemented as a class with the following methods: <br><table><tbody><tr><th>  Method header </th><th>  Description </th></tr><tr><td>  Function Messages_Constructor () </td><td>  The initial creation of the object.  Returns an object of the class "Messages". </td></tr><tr><td>  Procedure Messages_MostAtrib (Mess, Form, TabField, TabSnach) </td><td>  Set object attributes.  Need to pass: <br>  - link to the form (Form), which will display a list of messages; <br>  - a form element of the Tabular Field type (Tab Field) in which messages will be displayed; <br>  - Table of Values ‚Äã‚Äã(Tab), in which the actual list of messages will be stored. <br></td></tr><tr><td>  Message Procedure Initialization (Messag) </td><td>  A Table of Values ‚Äã‚Äãwill be initialized (previously set by the Messages_Astrib Message procedure) </td></tr><tr><td>  Procedure Messages_Update (Messag) </td><td>  Performs a forced drawing of a list of messages on a form (previously established by the Messages_Atatrib procedure) </td></tr><tr><td>  Function Messages_Add (Messaging, MessageType, Message Text, StatusMess = Undefined, CommentComment = Undefined) </td><td>  Adds a new message to the set with the appropriate attributes.  Returns the message identifier with which, this message can be accessed later. </td></tr><tr><td>  Message Procedure_Change (Messaging, Message ID, Message Type = Undefined, Message Text = Undefined, Status Message = Undefined, Comment Message = Undefined) </td><td>  Changes the attributes of an already existing message with the specified id. </td></tr><tr><td>  Procedure Messages_Remove (Messag, IDSoobsch) </td><td>  Delete the previously added message with the corresponding identifier. </td></tr><tr><td>  Procedure Messages_Clear (Messag.) </td><td>  Delete all messages set. </td></tr><tr><td>  Function Messages_GetType (Messag., IdSobsch) </td><td>  Get the attribute "Type" for an existing message with the specified identifier. </td></tr><tr><td>  Procedure Messages_InstallType (Messag, IdCommun, TypeCommun) </td><td>  Set the attribute "Type" for an existing message with the specified identifier. </td></tr><tr><td>  Function Messages_ReceiveStatus (Messag., IdA Report) </td><td>  Get the ‚ÄúStatus‚Äù attribute for an existing message with the specified id. </td></tr><tr><td>  Procedure Messages_InstallStatus (Messag, IdMessages, StatusMessages) </td><td>  Set the attribute "Status" for an existing message with the specified identifier. </td></tr><tr><td>  The function Messages_ReceiveText (Messag., IdMessage) </td><td>  Get the Message Text attribute for an existing message with the specified id. </td></tr><tr><td>  Procedure Messages_InstallText (Messaging, IdMess, TextMess) </td><td>  Set the attribute "Message text" for an existing message with the specified identifier. </td></tr><tr><td>  Function Messages_ReceiveComment (Messag., IdA Report) </td><td>  Get the attribute ‚ÄúComment‚Äù for an existing message with the specified id. </td></tr><tr><td>  Procedure Messages_Install a Comment (Soobs, IdCommun, CommentCommun) </td><td>  Set the attribute "Comment" for an existing message with the specified identifier. </td></tr><tr><td>  Function Messages_ColorText (Message Type, Status Message) </td><td>  Define the text color for the specified status.  Used when coloring messages in the interface. </td></tr><tr><td>  MessageColorCommentMessages Function (TypeCommun, StatusMess) </td><td>  Define the color of the additional text (comment) of the message for the specified status.  Used when coloring messages in the interface. </td></tr><tr><td>  Function Messages_Picture (TypeCommun, StatusMess) </td><td>  Define an icon for a message with the specified status.  Used when displaying messages in the interface. </td></tr><tr><td>  Function Messages_SaveFile (Messaging) </td><td>  Save a set of messages to a text file (the file name asks the user). </td></tr></tbody></table><br>  So, the full text of the main processing module: <br><div class="spoiler">  <b class="spoiler_title">Module text</b> <div class="spoiler_text"><pre> <code class="1c hljs"><span class="hljs-comment"><span class="hljs-comment">//////////////////////////////////////////////////////////////////////////////// //     ; //      ; //    //////////////////////////////////////////////////////////////////////////////// //    JavaScript; //     JavaScript /////////////////////////////////////////////////////////////////////////////////////////////////// // //                                  // /////////////////////////////////////////////////////////////////////////////////////////////////// //      // // : // . // // : //    -    //  ()  =  ; //   .("_", 0); //   .("_1", 1); //   1 .("_2", 2); //   2 .("_3", 3); //   3 //   .("_", 0); //   .("_", 1); //  "" .("_", 2); //  "" .("_", 3); //  ""    //   ,   ,    //  . // // : // . // // : //    -       //  ()  =  ; .("",  ((""))); .("",  ((""))); .("",  (("")));    /////////////////////////////////////////////////////////////////////////////////////////////////// // //                                              // /////////////////////////////////////////////////////////////////////////////////////////////////// //   JavaScript       //   ,   ,    //  . // // : // . // // : //    JavaScript  ,     //  JavaScript()  = ;   =  COM("MSScriptControl.ScriptControl"); .Language = "javascript";  ;    /////////////////////////////////////////////////////////////////////////////////////////////////// // //                             // /////////////////////////////////////////////////////////////////////////////////////////////////// //      ,    // // : //  -   //  - -       // : //   //  (, )  = ;  =  - ();   &gt; 0   = " " + ;  =  - 1 ;    //      ,    // // : //  -   //  - -       // : //   //  (, )  = ;  =  - ();   &gt; 0   =  + " ";  =  - 1 ;    //        // // : //  // : //    0,      //  ()   = 0;  JavaScript &lt;&gt;    = JavaScript.Eval("new Date().getTime()"); ;  ;  //      COMSafeArray    // // : // COMSafeArray -      COMSafeArray // (    1) // : //    "",      //  COMSafeArray(COMSafeArray)   = "";  (COMSafeArray) = ("COMSafeArray")  (COMSafeArray.GetDimensions() = 1)  (COMSafeArray.GetLength(0) &gt; 0)   = COMSafeArray.();        () = ("")  //    Windows-1251  UTF-8  ( &gt;= 192)  ( &lt;= 223)  //  -   =  + 848  ( &gt;= 224)  ( &lt;= 239)  //  -   =  + 848  ( &gt;= 240)  ( &lt;= 255)  //  -   =  + 848  ( = 184)  //   = 1105  ( = 168)  //   = 1025  ( = 185)  // ‚Ññ  = 8470 ; //      =  + ()   ;    /////////////////////////////////////////////////////////////////////////////////////////////////// // //                       // /////////////////////////////////////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////////////////// //    () //      . // // : // . // : //    //  _()   =  ; //    .("", ); //     .("", ); //     .("", ); //     .("", ); //  . . ,  (INT)  ;  //   . // // : //  // : // () -     //  _()   = _();  ;  //    -  . // // : //  -    //  _()   //      . // // : //  -    //  -   ,       //  -        //  -     //  _(, , , )  . = ; . = ; . =   //   .    // // : //  -    //  _()   . &lt;&gt;    =  (10, 0);  =  ();  =  ; .((""));  =  (, , ,); .(); .((""));  =  (, , ); //  ""  ...("") =   ...("", , "", 30) ; //  ""  ...("") =   ...("", , "", 30) ; //  ""  ...("") =   ...("", , "", 200) ; //  ""  ...("") =   ...("", , "", 200)    //   ,      //     . //      ,  // // : //  -    //  _()   . &lt;&gt;    = 500; //   ( ),   = ();  (. = )  (. = 0)  ( - . &gt;= )  //   . = ; ..()    //       // // : //  -   ; //  -   ; //  -   ; //  -   ; //  -     // : //    .         //  .          . //  _(, , , =, =)   = ;  (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= ._1)  ( &lt;= ._3)  ( &lt;&gt; )   = ..(); . = ; //     = ._1    = ._2   = " " +    = ._3   = " " +  ; //   . = ;  ( &lt;&gt; )  ( &gt;= ._)  ( &lt;= ._)  . = ;  . = ._; ; . = ;  . &lt;&gt;   //       , //   ,        .. = ; ; _();  = ..(); ;    //      . ,    "" // // : //  -   ; //  -   (  ); //  -   ; //  -   ; //  -   ; //  -     //  _(, , =, =, =, =)   (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())   = ; //  ,  -  (  )   &lt;&gt;    ( &lt;&gt; .[].)  ( &gt;= ._1)  ( &lt;= ._3)  .[]. = ;  =   ;   &lt;&gt;     &lt;&gt; .[].  //    .[]. = ._1   .[]. = ._2   = " " +   .[]. = ._3   = " " +  ; //   .[]. = ;  =   ;   &lt;&gt;     &lt;&gt; .[].   ( &lt;&gt; )  ( &gt;= ._)  ( &lt;= ._)  .[]. = ;  .[]. = ._; ;  =   ;   &lt;&gt;     &lt;&gt; .[].  .[]. = ;  =   ;   =   // ,     _()    //      // // : //  -    //  -   (  ) //  _(, )   (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())  ..(); _()   //      // // : //  -    //  _()   (. &lt;&gt; )  (..() &gt; 0)  ..(); _()   //       // // : //  -    //  -   (  ) // : //    ,     //  _(, )   = ;  (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())   = .[]. ;    //       // // : //  -    //  -   (  ) //  -   //  _(, , )   (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())  ( &lt;&gt; .[].)  ( &gt;= ._1)  ( &lt;= ._3)  .[]. = ; _() ;  //       // // : //  -    //  -   (  ) // : //    ,     //  _(, )   = ;  (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())   = .[]. ;    //       // // : //  -    //  -   (  ) //  -   //  _(, , )   (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())  ( &lt;&gt; .[].)   ( &lt;&gt; )  ( &gt;= ._)  ( &lt;= ._)  .[]. = ;  .[]. = ._; ; _()   //       // // : //  -    //  -   (  ) // : //    ,     //  _(, )   = ;  (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())   = .[]. ;    //       // // : //  -    //  -   (  ) //  -   ; //  _(, , )   (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())  ( &lt;&gt; )  ( &lt;&gt; .[].)  //    .[]. = ._1   .[]. = ._2   = " " +   .[]. = ._3   = " " +  ; //   .[]. = ; _()   //        // // : //  -    //  -   (  ) // : //    ,     //  _(, )   = ;  (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())   = .[]. ;    //        // // : //  -    //  -   (  ) //  -    //  _(, , )   (. &lt;&gt; )  ( &lt;&gt; )  ( &gt;= 0)  ( &lt; ..())  ( &lt;&gt; .[].)  .[]. = ; _()   //            // // : //  -   //  -   // : //    //  _(, )   = ;   = ._1   = Web.   = ._2   = Web.   = ._3   = Web. ;    //            // // : //  -   //  -   // : //    //  _(, )   = ;   = ._   = Web.   = ._   = Web.   = ._   = Web. ;    //            // // : //  -   //  -   // : //    //  _(, )   = ;   = ._   = .   = ._   = .   = ._   = . ;    //           // // : //  -    // : // ,      -    //  _()   = ; //      . =   //     ; //         =  (.); . = "  (*.txt)|*.txt" + "|  (*.*)|*.*"; . = " "; . = ; . = ; . = "txt"; . = 0; . = ;  .()  //    //    =  (., .ANSI); //        //        = 0;  = 0;     .   = (.);   &gt;    = ; ;  = (.);   &gt;    = ; ; ; //        .   = " "; //     = ""; //       (. &lt;&gt; )  (. &lt;&gt; ._)   = "";  . = ._   = "";  . = ._   = "";  . = ._   = ""; ;   &lt;&gt; ""   =  +  ;  =  + (, 14); ; //       (. &lt;&gt; )  (. &lt;&gt; "")    &lt;&gt; ""   =  +  ;  =  + (., ); ; //       (. &lt;&gt; )  (. &lt;&gt; "")    &lt;&gt; ""   =  +  ;  =  + (., ); ; //       &lt;&gt; ""  .()  ; //   .();  =  //     //    ("  :" + . + ().);  ;    //////////////////////////////////////////////////////////////////////////////// //    -   //   //     = (); //    = (); //    //   JavaScript JavaScript = JavaScript();</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Please note that when performing a lengthy process in a loop, the user interface is blocked, and therefore the fact of adding or changing messages will not be visible to the user - no drawing will be made. </font><font style="vertical-align: inherit;">To force the drawing to work, you must call the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Update ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method of the </font><font style="vertical-align: inherit;">form that displays the messages. </font><font style="vertical-align: inherit;">But the frequent call of this method will slow down the work, therefore, it is necessary to call it only occasionally (albeit with a small interval so that the user does not notice lags - in this implementation, the update interval is no more than once every 0.5 seconds). </font><font style="vertical-align: inherit;">To implement the update, use the class method </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Messages_Update</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> An example of use. </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this example, the form that displays a set of messages looks like this: </font></font><br><img src="https://habrastorage.org/files/b2a/31f/7cb/b2a31f7cb8eb46778f50011481a3c598.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instead of the ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Start Process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù </font><font style="vertical-align: inherit;">button </font><font style="vertical-align: inherit;">, in reality there should be something more useful - some kind of user interface. The ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Start Process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù </font><font style="vertical-align: inherit;">button </font><font style="vertical-align: inherit;">simulates filling in the list of messages, demonstrating how messages could be displayed during the actual execution of a long-term operation. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">table of values</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ‚ÄúMessages‚Äù was </font><font style="vertical-align: inherit;">created as the details of the form </font><font style="vertical-align: inherit;">. We do not initialize it at all, but simply pass as parameters to the corresponding methods of the class ‚ÄúMessages_‚Äù, and they are already creating the necessary columns:</font></font><br><pre> <code class="1c hljs"> = _(); _(, , ., ); _();</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To display the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table of Meaning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "Messages", on the form is placed a visual component of the type " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TabularField</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " - "TabularFieldMessages". </font><font style="vertical-align: inherit;">When creating columns in the Tabular Field, we take into account the following columns of the Table of Values ‚Äã‚Äã(described earlier): </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TypeCommun</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StatusMess</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text Message</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CommentMess</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The text of the main processing form module (display messages):</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Form module text</font></font></b> <div class="spoiler_text"><pre> <code class="1c hljs"><span class="hljs-comment"><span class="hljs-comment">//////////////////////////////////////////////////////////////////////////////// //     ; //       .  .  .  //////////////////////////////////////////////////////////////////////////////// //    //  -   " " .   //    ,    . // // : // . //  () //         = _(); _(, , ., ); _();  //  -   " " .   //    . //   . // // : // . //  () //       _()  //  -   ""  . //  ,      . // // : //  - . //  () //       =  ();  = .(1, 100); //        = ("  ?", ., , , " ");   = .  //      ErrMsg = ""; _(); //     _(, ._1, "***    ***");  = ;  = 0;  //     =1    //    ,      2 = _(, ._2, "  " + (, "=0; =''")); // ****************************** //          .(0, ) &gt; 0  // ,         =   // ,          =  ; // ****************************** //           = ._;  = "";    //     = ._;  = ""  //      = ._;  = "" ; _(, 2, , , , ); //         //  -    ;  =  + 1   //   -  ErrMsg = ().;  =  ; //        //    _(, ._1, "***    ***");  //   _(, ._1, "***    ***", ._, ErrMsg) ; //       = "";     = "  "   = "   " ;  =  + .;  =  + " " + (, "=0; =''") + " ."; (, , " ")   //  -   ""   // .       . // // : //  -  ; //  -      //  -     . //  (, , ) //   "" ... = ;  = _(., .);   &lt;&gt;   ... = ; ... = ; ; //   ""  (. &lt;&gt; )  (. &lt;&gt; "")   = _(., .);   &lt;&gt;   ... =   ; //   ""  (. &lt;&gt; )  (. &lt;&gt; "")   = _(., .);   &lt;&gt;   ... =     //  -   ""  . //       . // // : //  - . //  ()  = .("", ); .ShowMessagesDlg()  //  -   ""  . //      . // // : //  - . //  () _(); </span></span></code> </pre><br></div></div><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The form for viewing messages. </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is also a separate window for viewing the list of messages (corresponding to the Table of Values). </font><font style="vertical-align: inherit;">It is designed so that you can more conveniently analyze a large list (since in the main Tabular dialog box, the message field cannot be stretched much in height - other interface elements will interfere). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The form looks something like this: </font></font><br><img src="https://habrastorage.org/files/421/57e/a90/42157ea907084cca80c155c515681e96.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code for the form module is quite simple. </font><font style="vertical-align: inherit;">Here is this:</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Form module text</font></font></b> <div class="spoiler_text"><pre> <code class="1c hljs"><span class="hljs-comment"><span class="hljs-comment">//////////////////////////////////////////////////////////////////////////////// //          ; //      //////////////////////////////////////////////////////////////////////////////// //    //  -   ""   . //      . // // : //  -  . //  () _();  //  -   ""   // .       . // // : //  -  ; //  -      //  -     . //  (, , ) //   "" ... = ;  = _(., .);   &lt;&gt;   ... = ; ... = ; ; //   ""  (. &lt;&gt; )  (. &lt;&gt; "")   = _(., .);   &lt;&gt;   ... =   ; //   ""  (. &lt;&gt; )  (. &lt;&gt; "")   = _(., .);   &lt;&gt;   ... =     //////////////////////////////////////////////////////////////////////////////// //    //      // // : //  -     . //  ShowMessagesDlg() ;   &lt;&gt;   //      = ; .. = .; //   .()  </span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download the source texts of the message subsystem and the considered example (processing for 1C 8.2) </font></font><a href="https://yadi.sk/d/YOsuUaCSps7VF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  That's all.  Good luck to all.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> See you. </font></font><br><br><h1>  PS </h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the next article I plan to talk about working with the FireBird server (databases) from 1C. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will find out: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- how to properly connect to the server (database) and disconnect; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- how to perform requests: send and receive data; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- how to work with binary fields and strings in different encoding; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- how to call stored procedures and get the results of their work; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- how to get around such a nuisance as an automatic disconnection of the client connection from the server side of FireBird (a simple and understandable method, which for some reason is not described anywhere on the Internet). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will create separate and portable sets of subroutines ("classes"): </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- to connect to the database (we will be able to connect to the server, the database and execute queries);</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - to work with query parameters (it will be possible to set and set parameters almost as in Delphi); </font></font><br>  And: <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- to work with sets of integers and strings (it is convenient to set multiple parameters for queries); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- convenient storage of connection profiles to various FireBird databases, as well as a user interface (form for editing a set of connection profiles) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, I think it will be interesting. </font><font style="vertical-align: inherit;">Once again, good luck ...</font></font></div><p>Source: <a href="https://habr.com/ru/post/278521/">https://habr.com/ru/post/278521/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278503/index.html">JS testing. Karmic webpack</a></li>
<li><a href="../278507/index.html">Usability Lynch: looking for interface vulnerabilities in CMS Diafan</a></li>
<li><a href="../278511/index.html">Third Beta Candidate - Vivaldi 1.0.403.20</a></li>
<li><a href="../278513/index.html">Meet linear models</a></li>
<li><a href="../278519/index.html">March 8, moms and programming</a></li>
<li><a href="../278523/index.html">The threshold for entry into Angular 2 - theory and practice</a></li>
<li><a href="../278527/index.html">Correct work with date and time</a></li>
<li><a href="../278533/index.html">(La) TeX on Habrahabr</a></li>
<li><a href="../278535/index.html">libuniset2 is a library for creating ACS. It is better to see once ... Part 1</a></li>
<li><a href="../278537/index.html">libuniset2 is a library for creating ACS. It is better to see once ... Part 2 (Running the simulator)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>