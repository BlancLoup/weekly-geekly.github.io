<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We learn MS SQL Server Reporting Services 2008 R2 to show HTML in reports</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Problem 
 I recently encountered the need to show HTML tables stored in a database in a SSRS 2008 R2 report. 
 And here on the stage extras bring care...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We learn MS SQL Server Reporting Services 2008 R2 to show HTML in reports</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/16a/a44/953/16aa449538a319c817216f5745d72b4e.png"><br><br><h4>  Problem </h4><br>  I recently encountered the need to show HTML tables stored in a database in a SSRS 2008 R2 report. <br>  And here on the stage extras bring carefully prepared "rakes".  The thing is that Report Manager in SSRS 2008 R2 supports only a limited number of HTML tags, and tabular ones are not included. <a name="habracut"></a><br>  According to official documentation, only the following tags are supported: <br><ul><li>  Links: A HREF </li><li>  Font: FONT </li><li>  Headers, block elements: H {n}, DIV, SPAN, P, LI </li><li>  Text Formatting: B, I, U, S </li><li>  Listings: OL, UL, LI </li></ul><br>  The list of CSS attributes is also heavily trimmed. <br><br>  After a long search on the Internet, it became clear that none of the options offered by the developer community would suit me. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Study </h4><br>  Options offered are as follows: <br><ul><li>  Render HTML into a server side image using a specially developed component (Custom Report Items) </li><li>  Replace tags with tables supported with table simulation (you need to write a script in the report itself) </li></ul><br>  In one of the discussions, I came across a hint - Javascript on the client side.  There was no ready solution. <br>  I started by trying to analyze what code is executed on the client side when displaying a report.  I looked into the report code in the browser and found the embedded <b>ReportingServices.js</b> script: <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"JScript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/Reports_SQLEXPRESS/js/ReportingServices.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/Javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The script itself on my server was lying here: <br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">c:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Program</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Files</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Microsoft</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SQL</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Server</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MSRS10_50.SQLEXPRESS</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Reporting</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Services</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReportManager</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">js</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReportingServices.js</span></span></span></span></code> </pre> <br>  I found a couple of articles on the topic of Javascript injection using this script, but the main problem was that my modifications were performed only once when the first page of the report was displayed, and when going to the next pages, the interface elements were not redrawn (AJAX). <br>  Attempts to gain a deeper understanding of how SSRS works continued by studying the code snippets of the main DLL servers using DevExtras CodeReflect and preparing reports in IE9 developer tool / Opera Dragonfly. <br>  As a result, found the following: <br><ul><li>  For WebForms that use Ajax, there are a number of events defining the page life cycle. </li><li>  One of these events, Load, is called every time the page loads and all Ajax calls. </li><li>  Details in the Ajax Client Life-Cycle Events article: <a href="http://msdn.microsoft.com/en-us/library/bb386417.aspx">http://msdn.microsoft.com/en-us/library/bb386417.aspx</a> </li></ul>  In order to add your handler, you need to create a pageLoad JS function that will be automatically executed when the Load event occurs: <pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pageLoad</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sender, args</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  ,  alert("!"); }</span></span></code> </pre>  I insert this construction at the very beginning of the <b>ReportingServices.js</b> script.  Works! <br><br><h4>  Decision </h4><br>  Actually, further the puzzle has already gathered and the following solution has turned out: <br><ol><li>  Add the following function to the beginning of the <b>% SSRS Install Dir% \ Reporting Services \ ReportManager \ js \ ReportingServices.js</b> script: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pageLoad</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toDecode = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">"div"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   DIV for (var i = 0; i &lt; toDecode.length; ++i){ //  if(toDecode[i].innerHTML.indexOf("HTMLInject:") == 0){ // DIV  ? Decoded = toDecode[i].innerText || toDecode[i].textContent; //  IE, Opera, FF toDecode[i].innerHTML = Decoded.slice(11); //   &amp; TXT --&gt; HTML } } }</span></span></code> </pre><br></li><li>  Now, to display the field as HTML, in the properties of the placeholder in the field Value you need to write the following: <br><pre> <code class="vbscript hljs">=<span class="hljs-string"><span class="hljs-string">"HTMLInject:"</span></span>+Fields!FieldName.Value</code> </pre>  where FieldName is the name of the dataset field containing HTML. <br><img src="https://habrastorage.org/storage2/46b/408/99f/46b40899fe67e6bf826ecb20bacaf59b.png"><br><br>  In this case, the property ‚ÄúGeneral \ Markup type‚Äù of the field itself must be set to the value " <b>None - Plain text only</b> ". <br><br><img src="https://habrastorage.org/storage2/b58/46f/37e/b5846f37ebd156b2cffefe1a8214221d.png"></li><li>  If you need to change the HTML styles, you can make changes to this CSS: <b>% SSRS Install Dir% \ ReportingServices \ ReportManager \ Styles \ ReportingServices.css</b> However, I was lucky and my HTML tables were formatted with classes, which I added to the CSS file. </li></ol><br><h4>  And now examples </h4><br>  This is the default display of the field ("None - Plain text only"): <br><img src="https://habrastorage.org/storage2/59f/899/0e5/59f8990e526e242af3912fc2210d446a.png"><br><br>  So shows the table, if the markup type to put in the "HTML - Interpret HTML tags as styles": <img src="https://habrastorage.org/storage2/fec/1fc/a78/fec1fca787e873ffedc6f75193ded860.png"><br><br>  My version: <br><img src="https://habrastorage.org/storage2/5b6/4c1/be2/5b64c1be2ff61207043ab11b18ce292d.png"><br><br><h4>  Pro / contra of such a decision </h4><br>  Advantages: <br><ul><li>  Works </li><li>  Easy and quick to do </li></ul><br>  Disadvantages: <br><ul><li>  It works only when displaying reports in the web interface.  In other report formats (Excel, PDF, Word ...), all HTML with tags is displayed.  As a workaround, you can use multiple columns for one field and the " <b>Show or hide based on an expression</b> " visibility flag with the formula " <b>= Globals! RenderFormat.Name</b> " (that is, show only one column, depending on the report format).  Further, in reports for other formats, it is already possible to develop a function for the placeholder in order to somehow brush the HTML (for example, by replacing with supported tags, or by displaying them as pictures). </li><li>  The report menu (DocumentMap) flies ‚Äî that is, the anchors in the document are placed incorrectly and for rendered elements in HTML an offset can occur by an amount that makes up the difference between how our field was going to show SSRS and how it showed. </li><li>  Performance on complex reports and slow clients </li><li>  Xss </li></ul><br><h4>  findings </h4><br>  So, with the help of simple devices, you can teach SSRS to show HTML ... But why ?! <br>  Hundreds of posts, from confused to angry, overwhelm the Internet because of such trifles. <br>  Even <a href="http://www.eclipse.org/birt">BIRT</a> has been able to do this for a long time, but the latest version of SSRS2012 is not yet available (pruflink: <a href="http://technet.microsoft.com/en-us/library/ff519562.aspx">http://technet.microsoft.com/en-us/library/ff519562.aspx</a> ). <br>  There are thoughts that MS implemented the HTML display in such a limited way so that the security / stability of the reporting system did not suffer, but it seems that all alternative solutions resemble the notorious ‚Äútrolleybus‚Äù. <br><br>  <b>UPD:</b> <br>  About rendering HTML into a picture - based on <a href="http://code.msdn.microsoft.com/windowsdesktop/How-to-render-or-convert-7064e4e2">this,</a> you can try to develop a Custom report Item. </div><p>Source: <a href="https://habr.com/ru/post/142597/">https://habr.com/ru/post/142597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142592/index.html">Perlin Noise</a></li>
<li><a href="../142593/index.html">When you connect the IPTV service you</a></li>
<li><a href="../142594/index.html">Erlang. Recommendations for code design</a></li>
<li><a href="../142595/index.html">So, you decided to prohibit copying class objects in C ++.</a></li>
<li><a href="../142596/index.html">Simulator for software testing</a></li>
<li><a href="../142598/index.html">The story of another electric bicycle with their own hands</a></li>
<li><a href="../142599/index.html">The most common SQL injection pattern in PHP is the useless escape of characters.</a></li>
<li><a href="../142600/index.html">Difficult choice of Python or PHP. And maybe both?</a></li>
<li><a href="../142601/index.html">Umi.CMS developer problem tree, options for slowing growth</a></li>
<li><a href="../142602/index.html">Drug Design or Drug Design</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>