<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We expand the functionality of Monopoly City Streets</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Developers in MCS, unfortunately, do not provide for the possibility of building the street with a large number of buildings in a couple of mouse clic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We expand the functionality of Monopoly City Streets</h1><div class="post__text post__text-html js-mediator-article">  Developers in MCS, unfortunately, do not provide for the possibility of building the street with a large number of buildings in a couple of mouse clicks.  But the game is written in JS, so nothing prevents us from writing a small bookmarklet, which will allow us to add the required functionality. <br><a name="habracut"></a><br>  All MCS code is in the <a href="">monopoly.1255614067.js</a> file.  If you look at the firebug that happens during the building purchase process, we will see that 2 functions are used - MCS.BUILD.showLocations () [to display the markers of available places] and MCS.BUILD.buyBuilding () [for the actual purchase of the building ].  After thinking, I got the following code: <br><blockquote>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">typeof</font> MCS <font color="#339933">==</font> <font color="#3366CC">"undefined"</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Bookmarklet needs to be called only on the monopoly page'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">var</font> buildingType <font color="#339933">=</font> <font color="#003366">null</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> player <font color="#339933">=</font> MCS.  <font color="#660066">getPlayerData</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> player <font color="#339933">==</font> <font color="#003366">null</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Before calling, you must log in'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">var</font> streetId <font color="#339933">=</font> MCS.  <font color="#660066">STREET</font> .  <font color="#660066">getStreetData</font> <font color="#009900">(</font> <font color="#009900">)</font> .  <font color="#660066">id</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> streetData <font color="#339933">=</font> MCS.  <font color="#660066">STREET</font> .  <font color="#660066">getStreetData</font> <font color="#009900">(</font> <font color="#009900">)</font> .  <font color="#660066">data</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> streetId <font color="#339933">==</font> <font color="#003366">null</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Before calling, select the street'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#000066">if</font> <font color="#009900">(</font> streetData. <font color="#660066">o</font> <font color="#339933">! =</font> player. <font color="#660066">nickname</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Before calling, you must choose your street'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">var</font> locations <font color="#339933">=</font> <font color="#003366">new</font> Array <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> builtCnt <font color="#339933">=</font> 0 <font color="#339933">;</font> <br>  <font color="#003366">var</font> buildLimit <font color="#339933">=</font> 0 <font color="#339933">;</font> <br>  <font color="#003366">function</font> buy <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> builtCnt <font color="#339933">&lt;</font> buildLimit <font color="#009900">)</font> <font color="#009900">{</font> <br>  buyBuilding <font color="#009900">(</font> locations <font color="#009900">[</font> 0 <font color="#009900">]</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  MCS.  <font color="#660066">STATUSBAR</font> .  <font color="#660066">redraw</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  getLocations <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  setTimeout <font color="#009900">(</font> buy <font color="#339933">,</font> <font color="#CC0000">250</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#009900">{</font> <br>  done <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">function</font> done <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  MCS.  <font color="#660066">STREET</font> .  <font color="#660066">show</font> <font color="#009900">(</font> streetId <font color="#339933">,</font> <font color="#003366">null</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  MCS.  <font color="#660066">LOADING</font> .  <font color="#660066">hide</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Built buildings:'</font> <font color="#339933">+</font> builtCnt <font color="#339933">+</font> <font color="#3366CC">'pcs.'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">function</font> getLocations <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  locations <font color="#339933">=</font> <font color="#003366">new</font> Array <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  $.  <font color="#660066">ajax</font> <font color="#009900">(</font> <font color="#009900">{</font> <br>  url <font color="#339933">:</font> <font color="#3366CC">"/ build / getlocations"</font> <font color="#339933">,</font> <br>  cache <font color="#339933">:</font> <font color="#003366">false</font> <font color="#339933">,</font> <br>  data <font color="#339933">:</font> <font color="#009900">{</font> <br>  id <font color="#339933">:</font> streetId <font color="#339933">,</font> <br>  type <font color="#339933">:</font> buildingType <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  dataType <font color="#339933">:</font> <font color="#3366CC">"json"</font> <font color="#339933">,</font> <br>  async <font color="#339933">:</font> <font color="#003366">false</font> <font color="#339933">,</font> <br>  success <font color="#339933">:</font> <font color="#003366">function</font> <font color="#009900">(</font> data <font color="#339933">,</font> <font color="#000066">status</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  $.  <font color="#660066">each</font> <font color="#009900">(</font> data <font color="#339933">,</font> <font color="#003366">function</font> <font color="#009900">(</font> foo <font color="#339933">,</font> point <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> point <font color="#009900">)</font> <font color="#009900">{</font> <br>  locations.  <font color="#660066">push</font> <font color="#009900">(</font> foo <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">function</font> buyBuilding <font color="#009900">(</font> location <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  $.  <font color="#660066">ajax</font> <font color="#009900">(</font> <font color="#009900">{</font> <br>  url <font color="#339933">:</font> <font color="#3366CC">"/ negotiate / buybuilding"</font> <font color="#339933">,</font> <br>  type <font color="#339933">:</font> <font color="#3366CC">"post"</font> <font color="#339933">,</font> <br>  data <font color="#339933">:</font> <font color="#009900">{</font> <br>  nickname <font color="#339933">:</font> player.  <font color="#660066">nickname</font> <font color="#339933">,</font> <br>  hash <font color="#339933">:</font> player.  <font color="#660066">hash</font> <font color="#339933">,</font> <br>  id <font color="#339933">:</font> streetId <font color="#339933">,</font> <br>  type <font color="#339933">:</font> buildingType <font color="#339933">,</font> <br>  loc <font color="#339933">:</font> location <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  dataType <font color="#339933">:</font> <font color="#3366CC">"json"</font> <font color="#339933">,</font> <br>  async <font color="#339933">:</font> <font color="#003366">false</font> <font color="#339933">,</font> <br>  success <font color="#339933">:</font> <font color="#003366">function</font> <font color="#009900">(</font> data <font color="#339933">,</font> <font color="#000066">status</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  player.  <font color="#660066">balance</font> <font color="#339933">- =</font> MCS.  <font color="#660066">buildings</font> <font color="#009900">[</font> buildingType <font color="#009900">]</font> .  <font color="#660066">price</font> <font color="#339933">;</font> <br>  builtCnt <font color="#339933">++;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  MCS.  <font color="#660066">TRACK</font> .  <font color="#660066">view</font> <font color="#009900">(</font> <font color="#009900">{</font> <br>  page <font color="#339933">:</font> <font color="#3366CC">"build"</font> <font color="#339933">,</font> <br>  section <font color="#339933">:</font> <font color="#3366CC">"build"</font> <font color="#339933">,</font> <br>  street <font color="#339933">:</font> streetData.  <font color="#660066">n</font> <font color="#339933">,</font> <br>  country <font color="#339933">:</font> streetData.  <font color="#660066">cy</font> <font color="#339933">,</font> <br>  region <font color="#339933">:</font> streetData.  <font color="#660066">re</font> <font color="#339933">,</font> <br>  building_type <font color="#339933">:</font> buildingType <font color="#339933">,</font> <br>  activity <font color="#339933">:</font> <font color="#3366CC">"build property"</font> <font color="#339933">,</font> <br>  value <font color="#339933">:</font> MCS.  <font color="#660066">buildings</font> <font color="#009900">[</font> buildingType <font color="#009900">]</font> .  <font color="#660066">price</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  buildingType <font color="#339933">=</font> <font color="#000066">prompt</font> <font color="#009900">(</font> <font color="#3366CC">'Enter building identifier. List of available types can be found by typing "?"'</font> <font color="#339933">,</font> <font color="#3366CC">'?'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> buildingType <font color="#339933">! =</font> <font color="#003366">null</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> buildingType <font color="#339933">==</font> <font color="#3366CC">'?'</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#003366">var</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#000066">for</font> <font color="#009900">(</font> i <font color="#000066">in</font> MCS. <font color="#660066">buildings</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#339933">!</font> isNaN <font color="#009900">(</font> MCS. <font color="#660066">buildings</font> <font color="#009900">[</font> i <font color="#009900">]</font> . <font color="#660066">effect</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  string <font color="#339933">=</font> string <font color="#339933">+</font> <font color="#3366CC">"ID:"</font> <font color="#339933">+</font> i <font color="#339933">+</font> <font color="#3366CC">", name:"</font> <font color="#339933">+</font> MCS.  <font color="#660066">Lang</font>  <font color="#660066">building</font> <font color="#009900">[</font> <font color="#3366CC">"building"</font> <font color="#339933">+</font> i <font color="#009900">]</font> <font color="#339933">+</font> <font color="#3366CC">", cost:"</font> <font color="#339933">+</font> MCS.  <font color="#660066">buildings</font> <font color="#009900">[</font> i <font color="#009900">]</font> .  <font color="#660066">price</font> <font color="#339933">*</font> <font color="#CC0000">1000</font> <font color="#339933">+</font> <font color="#3366CC">" <font color="#000099">\ n</font> "</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> string <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">typeof</font> MCS. <font color="#660066">buildings</font> <font color="#009900">[</font> buildingType <font color="#009900">]</font> <font color="#339933">==</font> <font color="#3366CC">"undefined"</font> <font color="#339933">||</font> isNaN <font color="#009900">(</font> MCS. <font color="#660066">buildings</font> <font color="#009900">[</font> buildingType <font color="#009900">]</font> . <font color="#660066">effect</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">"An invalid identifier is specified"</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#009900">{</font> <br>  <font color="#003366">var</font> count <font color="#339933">=</font> Math.  <font color="#660066">floor</font> <font color="#009900">(</font> player. <font color="#660066">balance</font> <font color="#339933">/</font> MCS. <font color="#660066">buildings</font> <font color="#009900">[</font> buildingType <font color="#009900">]</font> . <font color="#660066">price</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> count <font color="#339933">&gt;</font> 0 <font color="#009900">)</font> <font color="#009900">{</font> <br>  getLocations <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> minCnt <font color="#339933">=</font> Math.  <font color="#660066">min</font> <font color="#009900">(</font> count <font color="#339933">,</font> locations. <font color="#660066">length</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> minCnt <font color="#339933">==</font> 0 <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">"On the street there is no place for buildings of this type"</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#009900">{</font> <br>  buildLimit <font color="#339933">=</font> minCnt <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#339933">!</font> <font color="#000066">confirm</font> <font color="#009900">(</font> <font color="#3366CC">'Now we will try to build houses in the amount of'</font> <font color="#339933">+</font> minCnt <font color="#339933">+</font> <font color="#3366CC">'pcs. If you want to change the limit (only down), click "cancel"'</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  buildLimit <font color="#339933">=</font> <font color="#000066">prompt</font> <font color="#009900">(</font> <font color="#3366CC">'How many buildings to try to build?'</font> <font color="#339933">,</font> minCnt <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> buildLimit <font color="#339933">==</font> <font color="#003366">null</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> isNaN <font color="#009900">(</font> buildLimit <font color="#009900">)</font> <font color="#339933">||</font> buildLimit <font color="#339933">&gt;</font> minCnt <font color="#339933">||</font> buildLimit <font color="#339933">&lt;</font> 0 <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Incorrect value'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  MCS.  <font color="#660066">LOADING</font> .  <font color="#660066">show</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  setTimeout <font color="#009900">(</font> buy <font color="#339933">,</font> <font color="#CC0000">250</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'You do not have enough money to build this building'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> </blockquote> code <a href="http://highlight.hohli.com/">highlighting</a> : <a href="http://highlight.hohli.com/">highlight.hohli.com</a> <br><br>  Before starting the script, it conducts several checks: the presence of the MCS class (otherwise we are definitely not on the game site), the authorization of the user, and the current selected street is also checked.  Next, a request is issued to determine the type of building - a list of the latter is taken from the game code.  Checks the availability of money from the player and availability on the street.  Then we find out the number of houses to build and proceed to this exciting activity.  So that the user does not get bored - do not forget to display the hourglass in the top panel.  And, finally, the number of houses built is displayed. <br><br>  To convert this script to 1 line - use <a href="http://javascriptcompressor.com/">javascriptcompressor.com</a> , as a result, we almost have a bookmarklet - it remains only to add 'javascript:' to the beginning of the resulting line. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Ready text of a bookmarklet in pastybin: <a href="http://pastebin.mozilla.org/678433">pastebin.mozilla.org/678433</a> <br><br>  PS As a bonus, a bookmarklet for displaying the cost of the current street without buildings: <code>javascript:if(typeof MCS != "undefined"&amp;&amp;MCS.STREET.getStreetData().data)alert(MCS.STREET.getStreetData().data.p*1000);</code> <br><br>  <b>UPD</b> Bookmarklet for batch removal of buildings: <br><blockquote>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">typeof</font> MCS <font color="#339933">==</font> <font color="#3366CC">"undefined"</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Bookmarklet needs to be called only on the monopoly page'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">var</font> buildingType <font color="#339933">=</font> <font color="#003366">null</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> player <font color="#339933">=</font> MCS.  <font color="#660066">getPlayerData</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> player <font color="#339933">==</font> <font color="#003366">null</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Before calling, you must log in'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">var</font> streetId <font color="#339933">=</font> MCS.  <font color="#660066">STREET</font> .  <font color="#660066">getStreetData</font> <font color="#009900">(</font> <font color="#009900">)</font> .  <font color="#660066">id</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> streetData <font color="#339933">=</font> MCS.  <font color="#660066">STREET</font> .  <font color="#660066">getStreetData</font> <font color="#009900">(</font> <font color="#009900">)</font> .  <font color="#660066">data</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> streetId <font color="#339933">==</font> <font color="#003366">null</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Before calling, select the street'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#000066">if</font> <font color="#009900">(</font> streetData. <font color="#660066">o</font> <font color="#339933">! =</font> player. <font color="#660066">nickname</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Before calling, you must choose your street'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">function</font> demolish <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> removedCnt <font color="#339933">&lt;</font> removeCnt <font color="#339933">&amp;&amp;</font> buildingList. <font color="#660066">length</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  $.  <font color="#660066">ajax</font> <font color="#009900">(</font> <font color="#009900">{</font> <br>  url <font color="#339933">:</font> <font color="#3366CC">"/ negotiate / demolishbuilding"</font> <font color="#339933">,</font> <br>  type <font color="#339933">:</font> <font color="#3366CC">"post"</font> <font color="#339933">,</font> <br>  data <font color="#339933">:</font> <font color="#009900">{</font> <br>  nickname <font color="#339933">:</font> player.  <font color="#660066">nickname</font> <font color="#339933">,</font> <br>  hash <font color="#339933">:</font> player.  <font color="#660066">hash</font> <font color="#339933">,</font> <br>  id <font color="#339933">:</font> streetId <font color="#339933">,</font> <br>  bid <font color="#339933">:</font> buildingList.  <font color="#660066">shift</font> <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  dataType <font color="#339933">:</font> <font color="#3366CC">"json"</font> <font color="#339933">,</font> <br>  async <font color="#339933">:</font> <font color="#003366">false</font> <font color="#339933">,</font> <br>  success <font color="#339933">:</font> <font color="#003366">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  MCS.  <font color="#660066">getPlayerData</font> <font color="#009900">(</font> <font color="#009900">)</font> .  <font color="#660066">balance</font> <font color="#339933">+ =</font> parseInt <font color="#009900">(</font> MCS. <font color="#660066">buildings</font> <font color="#009900">[</font> removeMe <font color="#009900">]</font> . <font color="#660066">price</font> <font color="#339933">/</font> <font color="#CC0000">2</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  removedCnt <font color="#339933">++;</font> <br>  setTimeout <font color="#009900">(</font> demolish <font color="#339933">,</font> <font color="#CC0000">500</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#009900">{</font> <br>  done <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">function</font> done <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  MCS.  <font color="#660066">STREET</font> .  <font color="#660066">show</font> <font color="#009900">(</font> streetId <font color="#339933">,</font> <font color="#003366">null</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  MCS.  <font color="#660066">LOADING</font> .  <font color="#660066">hide</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">var</font> buildingTypes <font color="#339933">=</font> <font color="#003366">new</font> Array <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> str <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> i <font color="#339933">;</font> <br>  <font color="#000066">for</font> <font color="#009900">(</font> i <font color="#000066">in</font> streetData. <font color="#660066">b</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#339933">!</font> isNaN <font color="#009900">(</font> MCS. <font color="#660066">buildings</font> <font color="#009900">[</font> streetData. <font color="#660066">b</font> <font color="#009900">[</font> i <font color="#009900">]</font> . <font color="#660066">t</font> <font color="#009900">]</font> . <font color="#660066">effect</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">typeof</font> buildingTypes <font color="#009900">[</font> streetData. <font color="#660066">b</font> <font color="#009900">[</font> i <font color="#009900">]</font> . <font color="#660066">t</font> <font color="#009900">]</font> <font color="#339933">==</font> <font color="#3366CC">"undefined"</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  buildingTypes <font color="#009900">[</font> streetData.  <font color="#660066">b</font> <font color="#009900">[</font> i <font color="#009900">]</font> .  <font color="#660066">t</font> <font color="#009900">]</font> <font color="#339933">=</font> <font color="#003366">new</font> Array <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  buildingTypes <font color="#009900">[</font> streetData.  <font color="#660066">b</font> <font color="#009900">[</font> i <font color="#009900">]</font> .  <font color="#660066">t</font> <font color="#009900">]</font> <font color="#009900">[</font> <font color="#3366CC">'name'</font> <font color="#009900">]</font> <font color="#339933">=</font> MCS.  <font color="#660066">Lang</font>  <font color="#660066">building</font> <font color="#009900">[</font> <font color="#3366CC">"building"</font> <font color="#339933">+</font> streetData.  <font color="#660066">b</font> <font color="#009900">[</font> i <font color="#009900">]</font> .  <font color="#660066">t</font> <font color="#009900">]</font> <font color="#339933">;</font> <br>  buildingTypes <font color="#009900">[</font> streetData.  <font color="#660066">b</font> <font color="#009900">[</font> i <font color="#009900">]</font> .  <font color="#660066">t</font> <font color="#009900">]</font> <font color="#009900">[</font> <font color="#3366CC">'count'</font> <font color="#009900">]</font> <font color="#339933">=</font> <font color="#CC0000">1</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#009900">{</font> <br>  buildingTypes <font color="#009900">[</font> streetData.  <font color="#660066">b</font> <font color="#009900">[</font> i <font color="#009900">]</font> .  <font color="#660066">t</font> <font color="#009900">]</font> <font color="#009900">[</font> <font color="#3366CC">'count'</font> <font color="#009900">]</font> <font color="#339933">++;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> buildingTypes. <font color="#660066">length</font> <font color="#339933">==</font> 0 <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'There are no buildings available for demolition on the selected street'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">for</font> <font color="#009900">(</font> i <font color="#000066">in</font> buildingTypes <font color="#009900">)</font> <font color="#009900">{</font> <br>  str <font color="#339933">=</font> str <font color="#339933">+</font> <font color="#3366CC">"ID:"</font> <font color="#339933">+</font> i <font color="#339933">+</font> <font color="#3366CC">", name:"</font> <font color="#339933">+</font> buildingTypes <font color="#009900">[</font> i <font color="#009900">]</font> <font color="#009900">[</font> <font color="#3366CC">'name'</font> <font color="#009900">]</font> <font color="#339933">+</font> <font color="#3366CC">", number:"</font> <font color="#339933">+</font> buildingTypes <font color="#009900">[</font> i <font color="#009900">]</font> <font color="#009900">[</font> <font color="#3366CC">'count'</font> <font color="#009900">]</font> <font color="#339933">+</font> <font color="#3366CC">"pcs."</font>  <font color="#339933">+</font> <font color="#3366CC">" <font color="#000099">\ n</font> "</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">var</font> removeMe <font color="#339933">=</font> <font color="#000066">prompt</font> <font color="#009900">(</font> <font color="#3366CC">"Enter the ID of the building to demolish. List of buildings on the street: <font color="#000099">\ n</font> "</font> <font color="#339933">+</font> str <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> buildingList <font color="#339933">=</font> <font color="#003366">new</font> Array <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> removeMe <font color="#339933">! =</font> <font color="#003366">null</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">typeof</font> buildingTypes <font color="#009900">[</font> removeMe <font color="#009900">]</font> <font color="#339933">==</font> <font color="#3366CC">'undefined'</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Invalid building type specified'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#003366">var</font> removeCnt <font color="#339933">=</font> buildingTypes <font color="#009900">[</font> removeMe <font color="#009900">]</font> <font color="#009900">[</font> <font color="#3366CC">'count'</font> <font color="#009900">]</font> <font color="#339933">;</font> <br>  <font color="#003366">var</font> removedCnt <font color="#339933">=</font> 0 <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#339933">!</font> <font color="#000066">confirm</font> <font color="#009900">(</font> <font color="#3366CC">'An attempt will be made to demolish buildings in the amount of'</font> <font color="#339933">+</font> removeCnt <font color="#339933">+</font> <font color="#3366CC">'pcs. If you want to change the quantity (only down), click "cancel"'</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  removeCnt <font color="#339933">=</font> <font color="#000066">prompt</font> <font color="#009900">(</font> <font color="#3366CC">'Enter the number of houses to demolish'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> removeCnt <font color="#339933">==</font> <font color="#003366">null</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> isNaN <font color="#009900">(</font> removeCnt <font color="#009900">)</font> <font color="#339933">||</font> removeCnt <font color="#339933">&gt;</font> buildingTypes <font color="#009900">[</font> removeMe <font color="#009900">]</font> <font color="#009900">[</font> <font color="#3366CC">'count'</font> <font color="#009900">]</font> <font color="#339933">||</font> removeCnt <font color="#339933">&lt;</font> 0 <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">alert</font> <font color="#009900">(</font> <font color="#3366CC">'Incorrect value'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">throw</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  MCS.  <font color="#660066">LOADING</font> .  <font color="#660066">show</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">for</font> <font color="#009900">(</font> i <font color="#000066">in</font> streetData. <font color="#660066">b</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> streetData. <font color="#660066">b</font> <font color="#009900">[</font> i <font color="#009900">]</font> . <font color="#660066">t</font> <font color="#339933">==</font> removeMe <font color="#339933">&amp;&amp;</font> removedCnt <font color="#339933">&lt;</font> removeCnt <font color="#009900">)</font> <font color="#009900">{</font> <br>  buildingList.  <font color="#660066">push</font> <font color="#009900">(</font> i <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  setTimeout <font color="#009900">(</font> demolish <font color="#339933">,</font> <font color="#CC0000">250</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> </blockquote><br>  <a href="http://pastebin.mozilla.org/678730">pastebin.mozilla.org/678730</a> </div><p>Source: <a href="https://habr.com/ru/post/73164/">https://habr.com/ru/post/73164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../73157/index.html">I'm a Mac: Apple‚Äôs response to Windows 7</a></li>
<li><a href="../73158/index.html">Toggl Widget for Mac</a></li>
<li><a href="../73159/index.html">Google Reader has become more social</a></li>
<li><a href="../73161/index.html">RSS for signed Habrablogs</a></li>
<li><a href="../73163/index.html">Proposal: Moratorium on Python language changes</a></li>
<li><a href="../73165/index.html">Desktop Competition</a></li>
<li><a href="../73167/index.html">VS 2010 Intellisense Improvements</a></li>
<li><a href="../73168/index.html">syncTranslit plugin</a></li>
<li><a href="../73171/index.html">Ubuntu 9.10 release candidate released</a></li>
<li><a href="../73172/index.html">CKEditor + jquery.fancybox / prototype.lightbox or a simple photo gallery option</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>