<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AutoCAD Architecture: First project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the product line from Autodesk, in addition to the basic AutoCAD, there are many specialized products that are optimized for various areas of desig...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AutoCAD Architecture: First project</h1><div class="post__text post__text-html js-mediator-article">  In the product line from Autodesk, in addition to the basic AutoCAD, there are many specialized products that are optimized for various areas of design.  One such product is AutoCAD Architecture (ACA).  Similar to AutoCAD, for AutoCAD Architecture it is possible to write plug-ins in .NET.  In addition to libraries from Autodesk to work with objects AutoCAD Architecture can use the C ++ library Teigha Architecture from the Open Design Alliance, which allows you to download, draw and manipulate architectural objects. <br><br>  I want to write a series of tutorials that demonstrate how to work with architectural objects using the Autodesk .NET API and Teigha Architecture.  Let's start with the basics: let's collect and make the ‚Äúyour first project‚Äù exercise work from the ACA documentation, and then slightly expand it to use Autodesk.Aec.Arch.DatabaseServices.Wall objects. <br><br><img src="https://habrastorage.org/files/62e/d36/a8f/62ed36a8fb6c49b5a59de4c8010da174.jpg" alt="image"><br><a name="habracut"></a><br>  For experienced programmers, the description will seem long, but I think that the first steps should be described in detail in order to exclude discrepancies and allow a person to start at least the simplest application without any problems.  With further work, problems with the ACA .NET API will be enough. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      My previous article describing the basics of ACA <s>flew like plywood over Yaroslavl</s> into Geektimes and is available here: <a href="http://geektimes.ru/post/260364/">Introduction to AutoCAD Architecture</a> .  From it you can get a superficial idea of ‚Äã‚Äãwhat AutoCAD Architecture is, what objects it implements and what are their features. <br><br>  I will write a plugin in VS2010 and check the work in ACA 2013 x64.  Different versions of ACA may require different versions of the .NET Framework, besides this plug-in built for x32 will not load ACA x64. <br><br><h3>  Step 1 </h3><br>  Create a Visual C # class library project called AcaSample1 as shown in the screenshot.  We will have the .NET Framework version 4. <br><br><img src="https://habrastorage.org/files/32b/22f/534/32b22f5345b94f1b9d458869602bd360.png" alt="image"><br><br><h3>  Step 2 </h3><br>  Documentation advises to immediately add references acmgd.dll and acdbmgd.dll with the necessary example classes from ACA.  These files are in the root of the folder where the ACA is installed.  I have this C: \ Program Files \ Autodesk \ AutoCAD 2013 <br>  Add the necessary libraries as shown in the screenshots (References -&gt; Add reference -&gt; browse tab) <br><br><img src="https://habrastorage.org/files/0e4/1d1/b07/0e41d1b07a4e40aaa57326e8b1340c3c.png" alt="image"><br><br><img src="https://habrastorage.org/files/2e5/f0a/9e6/2e5f0a9e61404e09974b5aa1c1248344.png" alt="image"><br><br>  If everything is done correctly, two new libraries will appear in the References list: <br><br><img src="https://habrastorage.org/files/bcc/220/ffa/bcc220ffa6ef41a3b64f60ca2d5fed2e.png" alt="image"><br><br>  Next, select the two added references, right click on them, go to the properties and set the copy local property to false.  This is necessary to avoid hard-to-catch glitches in the future.  Here is what the documentation on this subject writes: <br><br><blockquote>  Microsoft Visual Studio to set the referenced DLL in the build output for the project.  If the referenced DLL is copied to the build output folder </blockquote><br><br><img src="https://habrastorage.org/files/eda/948/92d/eda94892dcf1415db8129575145fd74d.png" alt="image"><br><br><h3>  Step 3 </h3><br>  Let's try to create a command code in the way the documentation suggests.  The sample from ACA for some reason operates with the MText object and not with architectural primitives.  Let's follow the example. <br>  Add using directives: <br><br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">using</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Autodesk</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.AutoCAD</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Runtime</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">using</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Autodesk</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.AutoCAD</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ApplicationServices</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">using</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Autodesk</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.AutoCAD</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DatabaseServices</span></span>;</code> </pre> <br><br>  Add the code: <br><br><pre> <code class="hljs pgsql">[assembly: CommandClass(typeof(AcaSample1.Class1))] namespace AcaSample1 { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Class1 { [CommandMethod("AdskGreeting")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> AdskGreeting() { // <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> document <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">database</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">transaction</span></span> Document acDoc = Application.DocumentManager.MdiActiveDocument; <span class="hljs-keyword"><span class="hljs-keyword">Database</span></span> acCurDb = acDoc.<span class="hljs-keyword"><span class="hljs-keyword">Database</span></span>; // Starts a <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">transaction</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span> Manager <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span> acTrans = acCurDb.TransactionManager.StartTransaction()) { // <span class="hljs-keyword"><span class="hljs-keyword">Open</span></span> the Block <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-type"><span class="hljs-type">record</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> // BlockTable acBlkTbl; acBlkTbl = acTrans.GetObject(acCurDb.BlockTableId, OpenMode.ForRead) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> BlockTable; // <span class="hljs-keyword"><span class="hljs-keyword">Open</span></span> the Block <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-type"><span class="hljs-type">record</span></span> Model space <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> BlockTableRecord acBlkTblRec; acBlkTblRec = acTrans.GetObject(acBlkTbl[BlockTableRecord.ModelSpace], OpenMode.ForWrite) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> BlockTableRecord; <span class="hljs-comment"><span class="hljs-comment">/* Creates a new MText object and assigns it a location, * text value and text style */</span></span> MText objText = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MText(); // Specify the insertion <span class="hljs-type"><span class="hljs-type">point</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the MText <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> objText.<span class="hljs-keyword"><span class="hljs-keyword">Location</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.AutoCAD.Geometry.Point3d(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); // <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> the <span class="hljs-type"><span class="hljs-type">text</span></span> string <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the MText <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> objText.Contents = "Greetings, Welcome to the AutoCAD .NET Developer's Guide"; // <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> the <span class="hljs-type"><span class="hljs-type">text</span></span> style <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the MText <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> objText.TextStyleId = acCurDb.Textstyle; // Appends the <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MText <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> model space acBlkTblRec.AppendEntity(objText); // Appends <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> MText <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the active <span class="hljs-keyword"><span class="hljs-keyword">transaction</span></span> acTrans.AddNewlyCreatedDBObject(objText, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); // Saves the changes <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> closes the <span class="hljs-keyword"><span class="hljs-keyword">transaction</span></span> acTrans.<span class="hljs-keyword"><span class="hljs-keyword">Commit</span></span>(); } } } }</code> </pre><br><br>  Here AdskGreeting is the name of the team.  Subsequently, this name will need to be entered on the ACA command line in order to execute the AdskGreeting () function code. <br>  We are trying to knock down ... well, of course, it does not build :) <br><br><img src="https://habrastorage.org/files/a38/41a/53d/a3841a53dcab4b2395addf6fe81de92d.png" alt="image"><br><br>  The reason is that we do not have enough references in which the CommandClass, CommandMethod, etc. are defined - accoremgd.dll <br>  This library also lies in the root of the folder where ACA is installed.  Add this reference and set its copy local to false: <br><br><img src="https://habrastorage.org/files/74e/77b/799/74e77b7994fc4cd8b9046a3679c15aa8.png" alt="image"><br><br>  We try to run the build: the library should be built without errors.  As a result, we have AcaSample1.dll <br><br><h3>  Step 4 </h3><br>  Now we need to pay attention to the platform.  For example, the default platform in 2010 studio Debug \ AnyCPU, and I have Win 7 x64 and ACA x64.  When you try to download this ACA x64 dll will give an error.  Therefore, I need to change the target platform: <br><br><img src="https://habrastorage.org/files/557/ec3/e57/557ec3e57c964a828c09f152f8e958b7.png" alt="image"><br><br>  Rebuild the project.  At this stage, AcaSample1.dll should appear in AcaSample1 \ AcaSample1 \ bin \ x64 \ Debug <br>  Documentation still advises checking the target framework <br><blockquote>  On the Applications tab, Target Framework drop-down list, select .NET Framework 4.0 </blockquote><br>  but we exhibited it in the first step when creating a project. <br><br><img src="https://habrastorage.org/files/3d1/869/a52/3d1869a524784ca3b073ae78cd330a98.png" alt="image"><br><br><h3>  Step 5 </h3><br>  We try to load our plugin into ACA and execute the command.  Open ACA 2013 and enter netload on the command line (the command line can be called with the ctrl + 9 combination if it is hidden).  The dialog box for selecting the plug-in opens (although if the FILEDIA variable is set to 0, then the window will not open, but you will be prompted to type in the command line dll before the plug-in).  Go to the folder with the solution, look for AcaSample1.dll (I have AcaSample1 \ bin \ x64 \ Debug) and press open: <br><br><img src="https://habrastorage.org/files/235/f48/378/235f4837835f4244be7703552d48732f.png" alt="image"><br><br>  If there were no errors, ACA will keep silent.  We type the team AdskGreeting.  If there were no errors, the autocad will keep silent again, and, most likely, nothing will change on the screen.  This is because the text is too small or out of the area the camera is pointing at.  To see it, use the zoom extents command from the panel (view tab): <br><br><img src="https://habrastorage.org/files/cf4/b70/0fb/cf4b700fb0e94accb09e28a73f06b667.png" alt="image"><br><br>  As a result, should see this: <br><br><img src="https://habrastorage.org/files/b37/237/c43/b37237c43d5f494c832dcf9a23ff32ed.png" alt="image"><br><br>  OK.  With minor additions, we managed to build and run a basic example from the documentation for AutoCAD Architecture. <br><br><h3>  Step 6 </h3><br>  Now let's try to make a command that uses the ACA objects themselves.  For example, walls.  To do this, we replace the entire code of the example with the following (code is crooked, use only for the sample): <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.AutoCAD.Runtime; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.AutoCAD.ApplicationServices; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.AutoCAD.DatabaseServices; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.AutoCAD.Geometry; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.Aec.Arch.DatabaseServices; [assembly: CommandClass(typeof(AcaSample2_Walls.Class1))] namespace AcaSample2_Walls { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Class1 { [CommandMethod("CreateHouse")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> CreateHouse() { Document acDoc = Application.DocumentManager.MdiActiveDocument; <span class="hljs-keyword"><span class="hljs-keyword">Database</span></span> acCurDb = acDoc.<span class="hljs-keyword"><span class="hljs-keyword">Database</span></span>; acDoc.Editor.WriteMessage("\n CreateHouse command"); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span> acTrans = acCurDb.TransactionManager.StartTransaction()) { // <span class="hljs-keyword"><span class="hljs-keyword">Open</span></span> the Block <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-type"><span class="hljs-type">record</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> BlockTableRecord acModelSpace = GetModelSpaceRecord(acCurDb, acTrans, OpenMode.ForWrite); AddWallToModelSpace(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), acModelSpace, acTrans); AddWallToModelSpace(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), acModelSpace, acTrans); AddWallToModelSpace(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), acModelSpace, acTrans); AddWallToModelSpace(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), acModelSpace, acTrans); acTrans.<span class="hljs-keyword"><span class="hljs-keyword">Commit</span></span>(); } acDoc.SendStringToExecute("_-VIEW _SWISO ", <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); acDoc.SendStringToExecute("_.zoom _all ", <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static BlockTableRecord GetModelSpaceRecord(<span class="hljs-keyword"><span class="hljs-keyword">Database</span></span> acDb, <span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span> acTrans, OpenMode om) { // <span class="hljs-keyword"><span class="hljs-keyword">Open</span></span> the Block <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-type"><span class="hljs-type">record</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> BlockTable acBlkTbl; acBlkTbl = acTrans.GetObject(acDb.BlockTableId, OpenMode.ForRead) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> BlockTable; // <span class="hljs-keyword"><span class="hljs-keyword">Open</span></span> the Block <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-type"><span class="hljs-type">record</span></span> Model space <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> BlockTableRecord acBlkTblRec; acBlkTblRec = acTrans.GetObject(acBlkTbl[BlockTableRecord.ModelSpace], om) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> BlockTableRecord; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> acBlkTblRec; } private static <span class="hljs-type"><span class="hljs-type">void</span></span> AddWallToModelSpace(Point3d ptS, Point3d ptE, BlockTableRecord acModelSpace, <span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span> acTrans) { Wall w = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Wall(); w.<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>(ptS, ptE, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Vector3d(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); w.BaseHeight = <span class="hljs-number"><span class="hljs-number">2500</span></span>; w.InstanceWidth = <span class="hljs-number"><span class="hljs-number">300</span></span>; acModelSpace.AppendEntity(w); acTrans.AddNewlyCreatedDBObject(w, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } } }</code> </pre><br><br>  We wrote a new team CreateHouse, which creates a "house" of the four walls.  In this case, we have already started using ACA objects, so the directive was added <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">using</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Autodesk</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Aec</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Arch</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DatabaseServices</span></span>;</code> </pre><br>  Aec.Arch is already an area of ‚Äã‚Äãarchitectural objects. <br><br>  Teams <br><pre> <code class="hljs objectivec"> acDoc.SendStringToExecute(<span class="hljs-string"><span class="hljs-string">"_-VIEW _SWISO "</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); acDoc.SendStringToExecute(<span class="hljs-string"><span class="hljs-string">"_.zoom _all "</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);</code> </pre><br>  rotate the view into an isometric view and call zoom_extents, which we previously did with our hands in the ACA UI. <br><br>  To build this project in the references you need to add libraries in which ACA objects are implemented.  In this example, we will need AecBaseMgd.dll and AecArchMgd.dll.  Do not forget to also set them Copy local property to false. <br>  I have these libraries in C: \ Program Files \ Autodesk \ AutoCAD 2013 \ ACA \ <br><br><img src="https://habrastorage.org/files/42d/489/97b/42d48997b8ed4a04805bb9a6ecdbd640.png" alt="image"><br><br>  Everything that starts at Aec refers to ACA. <br><br><img src="https://habrastorage.org/files/107/546/7be/1075467bea2346a1b86a75df1455b53a.png" alt="image"><br><br>  We build the project, load it with the help of netload in AutoCAD Architecture 2013 and execute the CreateHouse command.  It should turn out like this: <br><br><img src="https://habrastorage.org/files/a53/71a/15a/a5371a15a0d746678a657881762b6c33.png" alt="image"><br><br><h2>  Conclusion </h2><br>  In this article, I tried to give step-by-step instructions for the first attempts at programming under ACA.  I know that there are similar articles about using the .NET API, but in this case I wanted to explain all the steps to use the architectural API. <br><br>  In the following articles, I will show how to make your first application using Teigha Architecture, and then proceed to the analysis of what happens in these examples: what is dwg, what is the database where we add walls, the differences of architectural objects from the basic autocade primitives in work plan with them.  Then I hope to consider more common scenarios: how to render architectural objects in the right view, how to get their geometry for conversion to other formats, how to work with them, and so on. </div><p>Source: <a href="https://habr.com/ru/post/265617/">https://habr.com/ru/post/265617/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265607/index.html">Minimalism in cryptography, or the Even ‚Äì Mansour scheme</a></li>
<li><a href="../265609/index.html">Billing issues: What can go wrong with self-written software?</a></li>
<li><a href="../265611/index.html">The Basics of Urho3D</a></li>
<li><a href="../265613/index.html">Storage Replica on Windows Server 2016</a></li>
<li><a href="../265615/index.html">Development for Windows 10 - where to start</a></li>
<li><a href="../265621/index.html">Getting Started with Intel Energy Profiler for Android</a></li>
<li><a href="../265623/index.html">German intelligence shared citizens with the NSA in exchange for spyware XKeyscore</a></li>
<li><a href="../265625/index.html">IBM Opens Bluemix Garage in Toronto</a></li>
<li><a href="../265627/index.html">Client point of failure: SPOF due to external JS libraries</a></li>
<li><a href="../265633/index.html">Study: Which operating systems do IaaS provider clients use?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>