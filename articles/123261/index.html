<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Statics in a programming language: what besides types?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is known that programming languages ‚Äã‚Äãare static and dynamic. In static languages, the types of all values ‚Äã‚Äãare known at compile time. As a result...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Statics in a programming language: what besides types?</h1><div class="post__text post__text-html js-mediator-article">  It is known that programming languages ‚Äã‚Äãare static and dynamic.  In static languages, the types of all values ‚Äã‚Äãare known at compile time.  As a result, the compiler can check if the value is being used correctly, whether this or that operation applies to it.  It is more pleasant to find out about the error at the time of compilation than during execution - less errors will be released during testing and will reach the user.  For this mistakes and appreciate static languages. <br><br>  But why is it limited to data types only?  Let's try a little fantasizing what else the compiler could do. <br><a name="habracut"></a><br>  Suppose we have a constant for the number of seconds in a day: <br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> secondsPerDay = <span class="hljs-number"><span class="hljs-number">24</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>;</code> </pre> <br>  We did not multiply the numbers on the calculator, so that when reading the code it would be counted as the number was calculated (or maybe it was just that the calculator was not at hand).  But the program is not obliged to re-multiply these numbers at each initialization!  Let the compiler multiply them themselves and put the finished value.  I suspect a good compiler will do just that. <br><br>  Moving into the science fiction domain (both in the subject area and in C ++). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We decided to release a localized version of our program for Mars residents: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Planet{ Earth, Mars } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Planet locale = Mars; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">secondsPerDay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(locale == Earth) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(locale == Mars) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>+<span class="hljs-number"><span class="hljs-number">37</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>+<span class="hljs-number"><span class="hljs-number">23</span></span>; } assert(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"unknown locale"</span></span>); }</code> </pre><br><br>  The secondsPerDay () function is completely constant.  For compiled code, it always returns the same value.  Therefore, our hypothetical compiler has the right to calculate the value of this function, and substitute it at the place of the call.  And if we then add Venus, forgetting to fix the secondsPerDay (), then when compiling with locale = Venus, the assert will work (when compiled, not when executed, as it happens in real life). <br><br>  Recall the pseudo-function sizeof (), known since the days of C. This construction looks like a normal function, but in fact the compiler calculates the number of bytes that the function argument takes in memory.  During execution, no function call already occurs.  You can also include C ++ templates in the area of ‚Äã‚Äãcomputational calculations.  But more flexible possibilities for some reason are not supported. <br><br>  Consider an example more interesting.  Let's write a function that will generate a SQL query based on the name of the structure type, and its fields: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  -  ,      //    -   T fetchById&lt;T&gt;(Connection conn, int id){ //  !!! assert(is_struct(T), name_of(T)+" is not struct"); assert(has_field(T, id), name_of(T)+ " doesn't contains field id"); string query = "SELECT "; //  !      foreach (field f in T) { if(field.index != 0) { query += ", "; } query += field.name; } query += "FROM " + name_of(T) + " WHERE ID=?ID"; //       ...................................................................................................................... //       Record r,         //   C++     Java?    T result = new T; //            foreach (field f in T) { result[f] = r.getFieldValue&lt;f.type&gt;(f.name); } return result; }</span></span></code> </pre><br><br>  Now our function is no longer constant, but some of its fragments are constant, and the hypothetical compiler performs whole cycles, replacing them with constant values ‚Äã‚Äãor sequences of operators. <br><br>  And don't say RTTI is invented!  RTTI is a run time type information, it works during program execution.  Here the type information is used at compile time to execute constant instructions by the compiler. <br><br>  So, having received the structure as a result of a function, we enjoy a static check when referring to the names of the structure, in order to access the record fields by string representation.  However, if our structure in the program does not coincide with the actual fields in the database, we again fly into a runtime error.  But at least the code on which it depends is localized in the definition of the structure.  For safety net, we can write the same universal function, which will check the compliance of the database with the declared types, and, if necessary, perform a restructuring of the database. <br><br>  It is curious that the above problem is solved in at least two static languages ‚Äã‚Äã(in dynamic it is solved without problems). <br><br>  The LINQ language built into C # and VB.NET allows you to statically work with databases.  Many features were implemented quite legally: lambda expressions, anonymous types, operator forms of methods.  But for interfacing the statically declared classes with tables and fields in the database, Microsoft applied eighth-level magic called ‚Äúintegration of SQL schema information into CLR metadata‚Äù [1]. <br><br>  Another example is the HaskellDB library [2,3].  Haskel himself, with his monads, can be regarded as first-level magic.  But developers needed third-level magic in the form of a nonstandard language extension called ‚ÄúTrex Extensible Structures‚Äù.  And despite this, for linking with the database, each structure field has to be given an excessive advertisement.  Example of declaring a table with two fields: <br> <code>students :: Table(name :: String, mark :: Char) <br> name :: r\name =&gt; <br> Attr (name :: String | r) String <br> mark :: r\mark =&gt; <br> Attr (mark :: Char | r) Char <br></code> <br><br>  To more clearly present the benefits of our innovations, I offer more examples. <br>  We have two structures: <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Order</span></span></span><span class="hljs-class">{</span></span> Date date; Client client; Product product; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> qty; Numeric cost; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sales</span></span></span><span class="hljs-class">{</span></span> Product product; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> qty; Numeric cost; };</code> </pre><br><br>  Somewhere we decided to coordinate the data from Order to Sales <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Order o, Sales s)</span></span></span></span>{ foreach(field f in Sales){ s[f.name] = o[f.name]; } }</code> </pre><br><br>  Now we can add new structures to our fields without changing the foo () function!  And if the calculation of foo () becomes impossible due to the mismatch of the fields, we get a compilation error. <br><br>  An example from the field of object-oriented design: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shape</span></span></span><span class="hljs-class">{</span></span> .............................. }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Square</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Shape{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: Square(); }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Circle</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Shape{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: Square(); }; .................................... <span class="hljs-comment"><span class="hljs-comment">// ,       //    ,   //     Shape* shapeFactory(string shapeName) { foreach(type T in descendants(Shape)){ if(name_of(T) == shapeName){ return new T; } return null; }</span></span></code> </pre><br><br>  During the compilation process, shapeFactory () will turn into a regular function: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">Shape* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shapeFactory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shapeName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-string"><span class="hljs-string">"Square"</span></span> == shapeName){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Square; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-string"><span class="hljs-string">"Circle"</span></span> == shapeName){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Circle; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; }</code> </pre><br><br>  References: <br>  1. <a href="http://msdn.microsoft.com/library/bb308959.aspx">LINQ: .NET Language-Integrated Query</a> <br>  2. <a href="http://trac.haskell.org/haskelldb">The official page of the project HaskellDB</a> <br>  3. <a href="http://code.haskell.org/haskelldb/leijen.pdf">Daan Leijen, Eric Meijer.</a>  <a href="http://code.haskell.org/haskelldb/leijen.pdf">Domain Specific Embedded Compilers.</a>  <a href="http://code.haskell.org/haskelldb/leijen.pdf">An article about how HaskellDB works.</a>  <a href="http://code.haskell.org/haskelldb/leijen.pdf">The problem of SQL and programming language pairing is also discussed there.</a> </div><p>Source: <a href="https://habr.com/ru/post/123261/">https://habr.com/ru/post/123261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123253/index.html">We collect statistics on the deaths of HDD and SSD drives</a></li>
<li><a href="../123255/index.html">Ip telephony for blondes</a></li>
<li><a href="../123257/index.html">What is the determining factor for you when choosing an IP telephony operator?</a></li>
<li><a href="../123259/index.html">Selectel: be careful weekend!</a></li>
<li><a href="../123260/index.html">How much is Zynga for the people?</a></li>
<li><a href="../123262/index.html">Competition for overclocking HDD, prize $ 10,000</a></li>
<li><a href="../123265/index.html">Why write about IT or wake a journalist</a></li>
<li><a href="../123266/index.html">Overview of the SPI bus and development of the driver of the slave SPI device for embedded Linux (Part two, practical)</a></li>
<li><a href="../123267/index.html">Voice Recorder with tags and card for iPhone</a></li>
<li><a href="../123269/index.html">Bookmark site for videos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>