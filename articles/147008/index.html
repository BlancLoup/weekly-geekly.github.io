<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recipe for setting up remote monitoring of Tomcat and Jetty containers using standard JDK tools</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conducting interviews with Java developers for about 6 years, I noticed that no one of the candidates who came came to know that it was possible to re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recipe for setting up remote monitoring of Tomcat and Jetty containers using standard JDK tools</h1><div class="post__text post__text-html js-mediator-article">  Conducting interviews with Java developers for about 6 years, I noticed that no one of the candidates who came came to know that it was possible to remotely monitor the state of the JVM with servlet containers using standard JDK tools. <br>  Therefore, further step by step recipe, how to configure and use this great opportunity <br><a name="habracut"></a><br><br><h2>  Monitoring tools </h2><br><hr><br><ul><li>  <b>JConsole</b> is a GUI tool for monitoring and managing both local and remote JVM and applications.  We read about the <a href="http://docs.oracle.com/javase/1.5.0/docs/guide/management/jconsole.html">official docks</a> </li><li>  <b>JVisualVM</b> - simply - this is the JConsole + profiler.  About this tool <a href="http://habrahabr.ru/search/%3Fq%3D%255Bvisualvm%255D%26target_type%3Dposts">perfectly written by</a> <a href="http://habrahabr.ru/users/theshade/" class="user_link">TheShade</a> </li></ul><br>  Both software products are located in <i>% JAVA_HOME% / bin</i> JDK and use JMX technology - <a href="http://www.oracle.com/technetwork/java/javase/tech/javamanagement-140525.html">Java Management Extensions</a> <br><br><h2>  Tomcat setup </h2><br><hr><br>  <b>% CATALINA_HOME%</b> is the directory where Tomcat is installed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  In the directory <i>% CATALINA_HOME% / conf</i> create a config file <b>remote.users</b> with the contents of the form <br><pre><code class="hljs">_1 _1 _2 _2</code> </pre> <br>  The name of the file can be given any at your discretion.  The file contains logins and passwords in an explicit (unfortunately) form of users who will be entitled to perform remote monitoring. <br>  For example: <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">tartaren</span></span> from_tarascon portos passwordportos</code> </pre><br></li><li>  In the directory <i>% CATALINA_HOME% / conf</i> create a config file <b>remote.acl</b> with the contents of the form <br><pre> <code class="hljs">_1 _ _2 _</code> </pre><br>  The name of the file can be given any at your discretion.  <i>ACCESS RIGHT</i> - one of two <b>readwrite</b> or <b>readonly</b> constants. <br>  For example: <br><pre> <code class="hljs objectivec">tartaren <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> portos <span class="hljs-keyword"><span class="hljs-keyword">readwrite</span></span></code> </pre><br></li><li>  chmod 400 remote.users </li><li>  chmod 400 remote.acl </li><li>  chown tomcat: tomcat remote.users <br>  <i>(user and tomcat group may need to be replaced according to the situation)</i> </li><li>  chown tomcat: tomcat remote.acl <br>  <i>(user and tomcat group may need to be replaced according to the situation)</i> </li><li>  Find the run script <b>catalina.sh</b> (usually found in <i>% CATALINA_HOME% / bin</i> ) </li><li>  In the script before the launch section add the command: <br><pre> <code class="hljs objectivec"><span class="hljs-built_in"><span class="hljs-built_in">CATALINA_OPTS</span></span>=<span class="hljs-string"><span class="hljs-string">"$CATALINA_OPTS -Dcom.sun.management.jmxremote.password.file=___remote.users -Dcom.sun.management.jmxremote.access.file=___remote.acl -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=_ -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=&lt;b&gt;IP_"</span></span></code> </pre><br>  <b>IP_ADRES</b> - The IP address of the Tomcat server. <br>  <b>PORT NUMBER</b> ‚Äî The port number on which the Tomcat server will respond to JConsole or JVisualVM requests. <br>  For example: <br><pre> <code class="hljs bash"> * * * <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span> CATALINA_OPTS=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CATALINA_OPTS</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$JPDA_OPTS</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">shift</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span> CATALINA_OPTS=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CATALINA_OPTS</span></span></span><span class="hljs-string"> -Dcom.sun.management.jmxremote.password.file=/usr/share/apache-tomcat-7.0.22/conf/remote.users -Dcom.sun.management.jmxremote.access.file=/usr/share/apache-tomcat-7.0.22/conf/remote.acl -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=7777 -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=1.1.1.1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$1</span></span></span><span class="hljs-string">"</span></span> = <span class="hljs-string"><span class="hljs-string">"debug"</span></span> ] ; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">$os400</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Debug command not available on OS400"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> 1 * * *</code> </pre><br></li><li>  If you want to disable password authentication, you need to add <b>-Dcom.sun.management.jmxremote.authenticate = false</b> to the list of parameters <b>CATALINA_OPTS</b> <br></li><li>  To make changes in the config and script take effect, you need to restart Tomcat using standard tools. </li></ol><br><h2>  Jetty Setup </h2><br><hr><br><ol><li>  Create files <b>remote.users</b> and <b>remote.acl</b> (or with any other names at your discretion) in the directories that suit you. </li><li>  chmod 400 remote.users </li><li>  chmod 400 remote.acl </li><li>  chown jetty: jetty remote.users <br>  <i>(user and jetty group may need to be replaced according to the situation)</i> </li><li>  chown jetty: jetty remote.acl <br>  <i>(user and tomcat group may need to be replaced according to the situation)</i> </li><li>  Most often, Jetty is used in conjunction with Maven.  To run create script <b>reboot.sh</b> <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> MAVEN_OPTS=<span class="hljs-string"><span class="hljs-string">"-Dcom.sun.management.jmxremote.password.file=/___/remote.users -Dcom.sun.management.jmxremote.access.file=/___/remote.acl -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=__ -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=IP_"</span></span> mvn -P dev clean compile jetty:run</code> </pre><br></li><li>  chmod + x reboot.sh </li><li>  Start (restart) Jetty with the command <b>./reboot.sh</b> </li></ol><br><br><h2>  JConsole connection </h2><br><hr><br><ol><li>  run jconsole </li><li>  in the form that appears: </li></ol><ul><li>  select <b>remote access</b> mode </li><li>  enter the IP or domain name of the servlet container with the port number in the format <br>  <b>IP_OR_DOMEN: NUMBER_PORT</b> </li><li>  fill in the <b>Username</b> and <b>Password</b> </li><li>  press the <b>[Connect]</b> button </li></ul><br>  JConsole does not save connection settings and must be entered every time. <br>  If you disable monitoring password authentication in the servlet container, you can connect using the <b>jconsole IP_ORI_DOMEN: PORT NUMBER command</b> <br><br><h2>  JVisualVM connection </h2><br><hr><br><ol><li>  run JVisualVM </li><li>  choose in the menu <b>File-&gt; Add JMX connection</b> </li><li>  in the form that appears: </li><li>  <b>Connection</b> - enter the IP or domain name of the servlet container with the port number in the format <br>  <b>IP_OR_DOMEN: NUMBER_PORT</b> </li><li>  if there is a desire - turn on the "checkbox" <b>Display name</b> and enter the desired alias for this connection </li><li>  enable checkbox <b>Use security credentials</b> </li><li>  fill in the <b>Username</b> and <b>Password</b> </li><li>  optionally enable ‚Äúdaw‚Äù <b>Save security credentials</b> </li><li>  Click <b>[OK]</b> </li><li>  in the left tree, in the <b>Remote</b> item a new section will appear with our container </li><li>  On this container, right-click and select the <b>Open</b> item. </li></ol></div><p>Source: <a href="https://habr.com/ru/post/147008/">https://habr.com/ru/post/147008/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../147000/index.html">Five ways to find an interesting task.</a></li>
<li><a href="../147002/index.html">Blizzard bans Diablo III players for using Wine</a></li>
<li><a href="../147003/index.html">20 commandments of user interface design</a></li>
<li><a href="../147004/index.html">Tale of CPA-Typesquatter</a></li>
<li><a href="../147007/index.html">A digital startup program is just the beginning. Interview with Arkady Moreynis</a></li>
<li><a href="../147009/index.html">100 decent computer games for DOS, which appeared in the eighties and nineties</a></li>
<li><a href="../147010/index.html">Public transport routes for Minsk and 7 new cities</a></li>
<li><a href="../147011/index.html">From engineer to manager. Part 2: Delegation and Task Formulation</a></li>
<li><a href="../147012/index.html">Apple could not ban the import of new models of HTC</a></li>
<li><a href="../147013/index.html">How to live and work with a bad boss?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>