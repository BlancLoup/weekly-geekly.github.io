<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why is the BAARD not removed in the release?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In beta versions of Windows 3.1, there was a hidden and encrypted code that when launched on DR-DOS produced an incomprehensible message about a ficti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why is the BAARD not removed in the release?</h1><div class="post__text post__text-html js-mediator-article"> In beta versions of Windows 3.1, there was a <a href="http://habrahabr.ru/blogs/windows/103757/">hidden and encrypted code</a> that when launched on DR-DOS produced an incomprehensible message about a fictional error. <br><br>  They decided not to deal with such tricks in the release, but the code of the checks and the message itself were not removed: they remained inside <code>WIN.COM</code> , and it suffices to change one byte so that the AARD code is executed again each time it is started. <br><br>  Why was he left?  Did Microsoft expect to unlock these questionable checks one day in the future? <br>  Of course not.  Even the message in the release remained unchanged: ‚ÄúPlease contact Windows 3.1 beta support.‚Äù If the message was really meant to be shown, it would have been updated after the beta testing. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So why leave a meaningless code in the release that is never executed? <br><a name="habracut"></a><br>  <a href="http://blogs.msdn.com/b/larryosterman/archive/2004/08/13/214338.aspx">Larry Osterman</a> explains: <blockquote>  Bypassing the execution of the code by inserting the <code>JMP</code> command is pretty safe;  and if you delete it, in the remaining code the function offsets will change - i.e.  this will be a <i>new</i> , untested code.  Beta testing was already over, so the developers tried not to replace the tested code with untested. <br><br>  But why should such a minor code change affect something?  Chris Pratley <a href="http://blogs.msdn.com/b/chris_pratley/archive/2004/02/05/67871.aspx">gives</a> an example: <br><blockquote>  Even re-linking the code, not just recompiling, can introduce unexpected bugs.  A few years ago, when we were working on the Asian release of Word97 and we already considered all the code ready, we started working on its final optimization.  We have a tool that collects statistics on the performance of individual functions, and reorders them in the file in an optimal way;  the function code does not change.  After optimization, we gave the code for final testing, and - both!  - found a bug.  When testers used a certain function of the program, on some machines the optimized code collapsed.  On the same machines, the same function worked fine before optimization. <br><br>  We debugged;  but if we added debug information to the optimized version, it no longer collapsed.  We tried to debug it without additional information;  but even if we just ran it under the debugger, it did not crash anymore.  Whatever way we tried to find out the cause of the falls, the program did not fall;  but she fell absolutely always when we left her alone. <br><br>  We were already going to use ICE (hardware debugger) when we noticed a pattern: the program crashed only on Pentium processors with a frequency of 150 MHz and below, although not at all.  It was already a clue.  We went to the Intel site, and looked at the "list of inaccuracies" (as they call their bugs).  Bingo!  In Pentium processors there was an ‚Äúinaccuracy‚Äù, under certain conditions leading to a crash.  In <i>very</i> specific conditions: if after 33 bytes after <code>JMP</code> there is a conditional jump, and the <code>JMP</code> itself is located on the edge of the memory page.  This "inaccuracy" has been corrected since the release of the Pentium 150 MHz. <br><br>  In fact, chips are quite often bugs, although few of them become well-known.  In the end, the microcode chip is written by people, not gods.  Usually, as soon as chip manufacturers find a bug in it, they report to compiler manufacturers;  so compilers generate code to bypass the detected bugs, and ordinary programmers with these bugs no longer become.  It turned out that we had a slightly outdated compiler, which did not yet know about this particular bug. <br><br>  When a representative from Intel confirmed that the mysterious program crashes could be caused by this very bug, we went through the optimized code, found the guilty command sequence, and manually rearranged three bytes so that the distance between the two hops was 34 bytes.  The falls have stopped. <br><br>  Now, when someone assures me that his correction is ‚Äúabsolutely safe,‚Äù I always tell this story.  No code changes can be completely secure. <br></blockquote><br>  I myself came across a similar bug: when we were working on Exchange 5.5, another build crashed on the same test machine - always on the same one.  We tried for several days to find out the reason, but without success: the bug disappeared from the slightest code change.  But he absolutely always showed up when we stopped debugging.  In the end, we, like Chris, found a ‚Äúlist of inaccuracies‚Äù;  and indeed, our code suffered from one of them.  Not having reassured by fixing a specific build, we found a set of compilation options for which the bug was impossible. <br><br>  Therefore, it is not surprising that the Windows developers left the AARD code in the release: they had been testing Windows with this code for many weeks, if not months, and <i>they knew for sure</i> that when this code was in place, Windows was working.  Whether Windows works without it, they didn‚Äôt risk finding out just before the release. <br></blockquote><br><hr><br>  BAARD was not the only interesting feature of the beta version of Windows 3.1. <br>  For the first time, Windows intercepted pressing Ctrl-Alt-Del, and showed its own screen ‚Äúlet me help you to close a hung program.‚Äù  Those using Windows 3.x remember that this screen was blue;  in the beta, he was dull black. <br><div style="text-align:center;"> <a href="http://windowsmuseum.net.ru/Windows%25203.1%2520Beta/cad.html"><img src="http://windowsmuseum.net.ru/Windows%203.1%20Beta/cad_pv.png"></a> </div><br>  If the user confirmed closing the hung application, but Windows could not complete it (for example, if there were no hung applications in the system), then the only thing that Windows could offer was a reboot. <br><div style="text-align:center;"> <a href="http://windowsmuseum.net.ru/Windows%25203.1%2520Beta/cad-1.html"><img src="http://windowsmuseum.net.ru/Windows%203.1%20Beta/cad-1_pv.png"></a> </div><br>  In the release of Windows 3.1, this oddity was corrected: now, if there are no hung applications, Windows suggests leaving it as it is. <br><div style="text-align:center;"> <a href="http://windowsmuseum.net.ru/Windows%25203.1/cad.html"><img src="http://windowsmuseum.net.ru/Windows%203.1/cad_pv.png"></a> </div><br><hr><br>  I read another similar story, it seems, with Raymond Chen;  I could not find the source now.  There Chen said that an unused variable was found in one of the ancient Windows builds.  They removed it - the function stopped working in a completely different place in the code.  Returned the variable - the bug was gone. <br><br>  This time the chips were fine: the problem really turned out to be for the programmers.  In the broken function there was a variable that was not initialized in all cases before use.  The value of the uninitialized variable was garbage that happened to be in the stack cell allocated for it;  and it so happened that there was always zero in this place.  Zero was the appropriate value for that variable, and the program continued to work. <br><br>  When the unused variable was deleted, all other variables in the program ‚Äúmoved out‚Äù along the stack, and now some other value appeared in the space reserved for the uninitialized variable.  Now the program has collapsed. <br><br>  To the surprise of Chen's colleagues, the essential function was written many months before, and even got into the previous release of Windows!  Due to a successful set of circumstances, it <i>always</i> worked correctly, despite the bug, which is why the bug went unnoticed for so long. <br><br>  Chen cited this story as an explanation of why in Windows XP there are code fragments that no one has touched since Windows 3.0.  No one knows how many invisible bugs are there;  but everyone knows for sure: <i>this code works</i> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/438/b80/f93/438b80f93afb4a241db09e3ffa97a536.jpg"></div></div><p>Source: <a href="https://habr.com/ru/post/103903/">https://habr.com/ru/post/103903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../103894/index.html">CodeFest Tester Day</a></li>
<li><a href="../103898/index.html">Found a way to make jailbreak iOS 4.1</a></li>
<li><a href="../103899/index.html">Continuous wavelet transform</a></li>
<li><a href="../103900/index.html">CloudUSB: a computer in your pocket</a></li>
<li><a href="../103901/index.html">Beta test client Vizerra: prizes for bugs</a></li>
<li><a href="../103906/index.html">Structure and interpretation of computer programs</a></li>
<li><a href="../103909/index.html">The first in the world video review of portable GPS / GLONASS navigator RIRV NT-1813</a></li>
<li><a href="../103910/index.html">The real truth is hidden in the history of edits.</a></li>
<li><a href="../103913/index.html">Social Media Revolution 2.0</a></li>
<li><a href="../103914/index.html">Cross-platform code for iPhone and iPad applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>