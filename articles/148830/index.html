<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Training with reinforcements on neural networks. Theory</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I wrote here the article The Problem of ‚ÄúTwo or More Teachers‚Äù. The first touches , trying to show one difficult unsolved problem. But the first touch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Training with reinforcements on neural networks. Theory</h1><div class="post__text post__text-html js-mediator-article">  I wrote here the article <a href="http://habrahabr.ru/post/148809/">The Problem of ‚ÄúTwo or More Teachers‚Äù.</a>  <a href="http://habrahabr.ru/post/148809/">The first touches</a> , trying to show one difficult unsolved problem.  But the first touches were a bit difficult.  Therefore, I decided for readers to chew a little theory.  Alas, now apparently they are learning / (learning?) In a somewhat stereotyped way, such as how each task has its own methods. <br><br>  So I was told that for the classification task - neural networks (training with a teacher), genetic algorithms (training without a teacher) is a clustering task, and there is also reinforcement training (Q-training) - as a task of an agent who is wandering and something does.  And many are judged by such patterns. <br><br>  Let's try to figure out what the use of neural networks gives, as some say, to a task that they cannot solve - namely, with reinforcement training. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And at the same time we will analyze the thesis of <a href="http://www.keldysh.ru/pages/mrbur-web/diss/">Burtsev MS, ‚ÄúThe study of new types of self-organization and the emergence of behavioral strategies‚Äù</a> , in which the application of unpretentious neural networks in the reinforcement learning problem was no less beautiful. <br><a name="habracut"></a><br>  <b>Theory</b> <br><br>  In genetic algorithms and methods for learning with reinforcement (for example, Q-learning) there is one significant problem - you need to set a fitness function.  Moreover, it is given explicitly by a formula.  Sometimes it appears indirectly - then it seems that this function is clearly not (we will follow later on the analysis of the dissertation of MS Burtsev).  And all the ‚Äúwonders‚Äù of agent-based behavior come only from this formula. <br><br>  But what is a formula?  - Function.  Or the same mapping of inputs to outputs.  And what does a neural network / perceptron do?  This is what he does ‚Äî he is learning to display the inputs to the outputs. <br><br>  <b>Take an exaggerated theoretical example.</b>  An agent is some kind of organism that wants to survive.  For this he needs to eat.  He is two types of animals - well, let the hares and mice.  Accordingly, it has two input parameters - the number of kilograms that are eaten by hare and mouseat :).  He (the body) wants to estimate how full he is.  Then, depending on how full he is, he can run with more or less speed and desire.  But this is another task, and we will focus on the assessment of satiety. <br><br>  We do not know how to evaluate satiety, except the kilos of both.  Therefore, the first natural assessment is to learn how to add kilograms.  Those.  we introduce a simple fitness function c = a + b.  Remarkably, but with such a rigid evaluation function, we cannot correct our behavior. <br><br>  Therefore, a neural network is used.  She is first taught to add these two numbers.  After training, the neural network can accurately fold.  The agent uses the output of the neural network and understands how full it is. <br><br>  But then misfortune happens - he estimated that he was full for 7 points = after eating 4 kilos of hare and 3 mice.  And he ran thinking that he ate, so he almost overdid it and did not die.  It turned out that 4 kilos of hare and 3 mice are not the same as 7 kilos of hare.  Myshatin does not give the same satiety, and in fact you need to add up as 4 + 3 = 6. He draws this conclusion he draws into the neural network as an exact given.  She retrains, and her fitness function is no longer a simple addition, and takes on a completely different look.  Thus, having a neural network, we can adjust the fitness function, which we cannot do in other algorithms. <br><br>  You can say that in other algorithms you just had to take no addition function.  But which one?  You do not have the appropriate parameters or principles on which you would deduce the desired pattern.  You simply could not formalize such a task, because  could not understand the state space. <br><br>  <b>Practice on the example of Burtsev MS</b> <br><br>  <i>What is his model environment:</i> <br><br>  Population P of agents A, which are in a one-dimensional cellular environment, closed in the form of a ring.  With cells, with some probability, the resource necessary for the agents to perform actions appears.  In the same cell can be only one agent.  A descendant agent can only appear as a result of the crossing of two parent agents.  The agent has 9 inputs <br><br>  1,2,3 - 1 if there is a resource in this cell of the field of view (on the left, next, on the right), 0 otherwise; <br>  4, 5 - 1 if there is an agent in the left / right cell, 0 otherwise; <br>  6,7 - motivation to cross Mr neighbor left / right; <br>  8 - personal motivation to find food <br>  9 - self motivation to cross <br><br>  The motivation for crossing and searching for food is determined by the ratio of two coefficients chosen by the experimenter - r0 - the values ‚Äã‚Äãof the internal resource for saturation and r1 - for crossing. <br><br>  There are 6 actions: cross with the neighbor on the right, cross with the neighbor on the left, jump, move one cell to the right, move one cell to the left, consume a resource, relax <br><br>  <i>How to solve:</i> <br><br>  It was originally tuned by the INS, of course it's difficult to call it a network ‚Äî without the inner layer, but let it be.  She had different coefficients, as inputs are related to actions (outputs).  Next, a genetic algorithm was applied, which adjusted the neural network coefficients, and rejected an organism with bad behavior. <br><br>  In fact, genetic algorithms are not much needed here.  It is possible to randomly sort through different strategies of behavior and fix suitable ones, correcting the neural network. <br><br>  In fact, the problem with Q-learning and genetic algorithms is that a new behavior is searched randomly.  And randomness is an equally probable search throughout the entire space of possible states.  Those.  There is no targeted search.  And if the space of possible states is large, then elementary strategies will never be found. <br><br>  Therefore, in general, it is necessary not to accidentally sort through different strategies, but purposefully (but this should be discussed in the next article after understanding the first strokes :)). <br><br>  <b>Conclusion</b> <br><br>  I ran fast, because  we are only important conclusions, not details.  But you may need to read more about it yourself. <br><br>  As a result, the agent's suitability function is represented by a neural network.  As in the above theory, Burtsev also has a dissertation. <br><br>  But we distinguish it from the fitness function of the environment.  It is here indirectly given through the coefficients r0 and r1.  Moreover, this function of the suitability of the medium is known to the experimenter.  Therefore, there is not any fiction when Burtsev discovers how the function of the agent's suitability begins to approach the function of the suitability of the medium. <br><br>  The article <a href="http://habrahabr.ru/post/148809/">The problem of "two or more teachers."</a>  <a href="http://habrahabr.ru/post/148809/">The first strokes</a> of our situation is worse.  Even the experimenter does not know the suitability of the medium; more precisely, the form of this function.  This is the problem, it is neither indirectly defined.  Yes, only the final function of fitness is known - the maximum of money, but inside it contains a subfunction, which is not known.  The functions of the suitability of the agent, one must strive for this subfunction - and it cannot be calculated. <br><br>  Hopefully now will be a little more clear. </div><p>Source: <a href="https://habr.com/ru/post/148830/">https://habr.com/ru/post/148830/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148824/index.html">Drush command for instant installation of drupal</a></li>
<li><a href="../148825/index.html">Announced an updated configuration of the game tablet Wikipad</a></li>
<li><a href="../148826/index.html">Verizon will stop blocking tethering applications.</a></li>
<li><a href="../148828/index.html">Google postpones the launch of Nexus Q. All pre-order will receive the device for free</a></li>
<li><a href="../148829/index.html">Interactive Python lessons on Codecademy</a></li>
<li><a href="../148831/index.html">We work on the road on the phone</a></li>
<li><a href="../148833/index.html">Dropbox: Base with email addresses was stolen from employee account</a></li>
<li><a href="../148835/index.html">Sony Xperia go review</a></li>
<li><a href="../148836/index.html">Polymer VS bacteria. Who will win?</a></li>
<li><a href="../148837/index.html">UIImage, EXIF ‚Äã‚Äãand a bit of runtime</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>