<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple parser for youtube in google tables</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 
 There was a task to collect data on 2000+ youtube videos, from which it was necessary to extract the name of the video, channel and langu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple parser for youtube in google tables</h1><div class="post__text post__text-html js-mediator-article"><h2>  Prehistory </h2><br>  There was a task to collect data on 2000+ youtube videos, from which it was necessary to extract the name of the video, channel and language. <br><br>  The IMPORTXML function, with which you can perform parsing from sites, did not help, because, as it turned out later, youtube stores data in JSON files.  I didn‚Äôt want to sort through such a number of videos and I began to look for ways to automate or at least simplify this task. <br><a name="habracut"></a><br>  I found <a href="https://habr.com/ru/post/254805/">an old article from 15 on Habr√©</a> , which describes how to get the number of video views, but since its publication youtube updated the API and I needed to get some other data. <br><br>  In the process of solving the problem with the help of youtube API and Google tables, it turned out not only to extract data from a previously prepared list of video URLs, but also to parse the youtube output by keyword. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Being in the wildest delight of the result, I decided to share my experience and describe the process in a little more detail. <br><br>  The method itself is certainly not perfect.  It can be described as a very quick and simple solution.  But until I started learning Python (I hope this day will come sooner or later) I have to do everything the old-fashioned way in the tables. <br><br><h2>  Training </h2><br>  For the parser to work, as in the original article, we need the ImportJSON script and youtube API. <br><br><h3>  Importjson </h3><br>  Download the script from <a href="https://gist.github.com/paulgambill/cacd19da95a1421d3164">github</a> and install it in the table through the tools &gt;&gt; script editor. <br><br><h3>  Youtube API </h3><br>  We get our API - the <a href="https://console.cloud.google.com/apis/library">Youtube Data API V3</a> key in the library and create credentials for it.  Previously, of course, we make an account if you are not already registered in the google cloud. <br><br>  Information about the video is stored in a JSON file, which is available at the link: <br><blockquote>  <a href="https://www.googleapis.com/youtube/v3/videos%3Fid%3D">www.googleapis.com/youtube/v3/videos?id=</a> {Video_ID} &amp; key = {API_Key} &amp; part = {Part_Parametr} </blockquote>  Where <br>  <b>Video_ID</b> - video id <br>  <b>API_Key</b> - the API key that you get in the console <br>  <b>Part_Parametr</b> - the part of the file in which information is stored <br>  Parts of the file can be of several types: <br>  <b>snippet</b> - contains almost all the basic information about the video: <br>  1. publication date <br>  2. title of video <br>  3. channel name <br>  4. channel identifier <br>  5. description under video (Description) <br>  6. video category (number) <br>  7. tags <br>  <b>contentDetails</b> - contains the duration and resolution of the video. <br>  <b>topicDetails</b> - contains a category of video in the form of a link to Wikipedia with the name of the category, but this section is not always full. <br>  <b>statistics</b> <br>  1. views <br>  2. number of comments <br>  3. likes <br>  4. dislikes <br>  In general, these are the main parts that you may need, but a complete list, if anything, is <a href="https://developers.google.com/youtube/v3/getting-started">in the help</a> . <br><br><h2>  Retrieving URL list data </h2><br>  Consider the work of the parser for example review <a href="https://www.youtube.com/watch%3Fv%3DEOWa0fmSGs8">badcomedian</a> .  In order to get information about the video, we need only its identifier ( <b>Video_ID</b> ), in this case it is <b>EOWa0fmSGs8</b> . <br><br>  We get and structure information using the ImportJSON formula and XPath query language. <br><br>  This is how the JSON file on the server looks like: <br><br><img src="https://habrastorage.org/webt/_s/ox/wl/_soxwl58ros077luptnucxjfqaq.jpeg" alt="image"><br><br>  The formula for getting the number of views in the tables: <br><blockquote>  = ImportJSON ('' https://www.googleapis.com/youtube/v3/videos?id=EOWa0fmSGs8&amp;key= {API_Key} &amp; part = statistics'; "/ items / statistics / viewCount;" '' noHeaders' ') </blockquote>  In principle, XPath can not be used in the request, but then you get the entire contents of the JSON file, without segmentation by parameters.  Having created the required number of formulas with XPath parameters, you will receive only the necessary data, which will be easier to process. <br><br><h2>  Getting a list of videos by key request </h2><br>  The principle of issuing parsing is the same as in the example above, but the query structure changes slightly. <br><br>  In this case, the JSON file with the results of the video output is located by reference. <br><blockquote>  <a href="https://www.googleapis.com/youtube/v3/search%3Fpart%3Dsnippet%26q%3D">www.googleapis.com/youtube/v3/search?part=snippet&amp;q=</a> {Your_Query} &amp; type = video &amp; key = {API_Key} </blockquote>  where the type parameter indicates what exactly we get at the output: <br><br>  <b>type = video</b> - list of videos relevant to the request <br>  <b>type = channel</b> - <b>channel</b> list <br>  <b>type = playlist</b> - list of playlists <br>  You can also specify in the request: <br><br>  1. publication date or date range <br>  2. region and search language <br>  3. video length <br>  4. number of results (default 5, maximum 50), etc. <br><br>  <a href="https://developers.google.com/apis-explorer/">A complete list of parameters and query designer is available here</a> . <br><br>  To get the list of ID on request badcomedian use the formula: <br><blockquote>  = ImportJSON (" <a href="https://www.googleapis.com/youtube/v3/search%3Fpart%3Dsnippet%26q%3Dbadcomedian%26type%3Dvideo%26key%3D">www.googleapis.com/youtube/v3/search?part=snippet&amp;q=badcomedian&amp;type=video&amp;key=</a> {API_Key}"; "/ items / id / videoId"; '' noHeaders '') </blockquote>  ImportJSON works well with the CLUTCH function, which allows us to perform mass analysis or video parsing by changing various parameters. <br><br>  An example of how a table is organized: <br><br><img src="https://habrastorage.org/webt/n4/4d/eg/n44deg5ftvdmuqee8yejjjzemes.jpeg"><br><br><h2>  Minus method </h2><br>  A serious disadvantage of this method of parsing information is the rapid exhaustion of the daily limit of API requests.  I did not find a way to limit the number of requests or create a sequential call to the API.  That is, an attempt to parse info on 10+ keys at the same time is guaranteed to lead to an error - the end of the daily limit of requests.  Therefore, it is necessary to break the keywords into small groups and save the results as values. </div><p>Source: <a href="https://habr.com/ru/post/443506/">https://habr.com/ru/post/443506/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../443488/index.html">Functional components with React Hooks. How are they better?</a></li>
<li><a href="../443490/index.html">Why am I closing my work on Debian</a></li>
<li><a href="../443494/index.html">Hyde: How to get SaaS product to AppSumo - successes and some mistakes</a></li>
<li><a href="../443502/index.html">Why exactly 4 years ago NASA shot Atlas V rocket at the night sky of Cape Canaveral?</a></li>
<li><a href="../443504/index.html">The World Wide Web has turned thirty years old - what will happen to it next?</a></li>
<li><a href="../443510/index.html">Laptop Compaq Armada 7700 - as the development of the line Compaq LTE</a></li>
<li><a href="../443512/index.html">Hakaton on data analysis in Nizhny Novgorod</a></li>
<li><a href="../443514/index.html">We write our network layer on Swift: a protocol-oriented approach</a></li>
<li><a href="../443516/index.html">Hacker Geohot decided to free up people from an AI simulation</a></li>
<li><a href="../443518/index.html">RBKmoney Payments under the hood - microservices, protocols and platform configuration</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>