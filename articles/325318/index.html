<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I stopped being afraid and re-invented QML</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What? 
 Hi, Habr! Many years have passed since I wrote here. I hope the time of you / me is not too / too patched. 

 I would like to write about our ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I stopped being afraid and re-invented QML</h1><div class="post__text post__text-html js-mediator-article"><h1>  What? </h1><br>  Hi, Habr!  Many years have passed since I wrote here.  I hope the time of you / me is not too / too patched. <br><br>  I would like to write about our experience rethinking QML ideas.  Qt is an excellent (by virtue of merit) library, and although its internal structure sometimes <i>raises questions</i> , it has given the world not only a cross-platform UI toolkit, but also a solid professional set of tools: Designer, Creator, Linguist, and, of course, Qml .  The result of this rethinking was our modest project that turns qml into html5 / javascript for different platforms, and even allows you to build simple android applications using <a href="https://cordova.apache.org/">Cordova</a> . <br><br>  Qml has always attracted us (a small unknown group of QML lawyers, as we call ourselves, putting on monocles and cylinders) with its absolute expressiveness in terms of developing interfaces, and therefore each of us uses them to develop user interfaces and sites. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We would very much like a part of the Habr community, open to everything new, to try and appreciate our modest possibilities, we received feedback, and could improve our product. <br><br>  Source codes are available on <a href="https://github.com/pureqml">github</a> , the source codes of the site, examples and the library of controls that we use for all our projects are also there.  Documentation and lessons can be viewed on our website, <a href="http://pureqml.com/">pureqml.com</a> . <br>  If you do not understand something, you can join the <a href="https://t.me/pureqml">Telegram support group</a> , we will try to answer all the questions in real time. <br><br>  One of the free apps that we made was the port of the <a href="https://habrahabr.ru/post/102153/">Fontanero</a> game, it should be available in the LG / Samsung markets. <br><br>  Well, then you can not read! <br><br><h2>  How we came to such a life </h2><br>  It all started back in 2010, when we started writing embedded software (and user interface) in one large corporation for a line of disparate devices on various platforms that are available now: arm, mips, x86, sh4, all that was missing was sparc ... <br><a name="habracut"></a><br>  We formulated the main problem for ourselves: UI should be fast, cheap and good, and so that it is not necessary to choose only two points from these three.  There were very few resources (one and a half programmers), so I wanted the UI programming to be easy and pleasant, and the programmers did not suffer, did not cry, and did not run away, but focused on solving business problems, instead of manually tracking coordinates.  HTML was dropped immediately, partly because the very first device was on arm926xxx (armv5) and had 32 MB of RAM onboard, of which only 23 MB was available for user-space applications (and also armv5 has a funny limit of 2G virtual addresses for all processes in the amount, correct me if I am mistaken), which greatly narrows the scope for searches. <br><br>  After analyzing the existing solutions, our choice fell on a relatively new (then) language and technology - QML, which was not at all surprising given the previous positive development experience with Qt.  Exceptionally simple and visual, we immediately decided that this was what we needed.  A very functional prototype, which appeared in a week, sparkling from fashionable animations, even <i>more</i> convinced us of the correctness of the choice. <br><br><h2>  QML - <i>(Enough)</i> Fine </h2><br>  The most beautiful thing about QML is that it hides everything from the programmer, except for the UI itself.  You just have to take the idea in hand, and <i>splash out</i> on the canvas! <br><br>  The declarative approach is very intuitive and easy to use.  The reuse component is intuitive, and, for simple cases, very concise.  This allowed us to make a full-fledged UI (menus, applications, settings, schedules, and other things), in just a couple of months, by two programmers. <br><br>  We spent a lot of time on trapping Qt, but it turned out that even custom builds, without a drop of excess, do not fit in either 8 or 16 MB of flash memory.  Our sadness knew no bounds, because we already lived in a world where embedded interfaces were no longer dull and were indignant, recalling the times when there was no Qt QML. <br><br>  That evening, my colleague and I spent the evening drinking a bottle of Qingdao in one of the Shenzhen hotels (on the 48th floor!), Wondering whether it was possible to make QML, but in C ++, and at the same time, check the strength of that sad platform on arm926.  It turned out that everything is not so bad, and the processor has enough capabilities to draw transparent beautiful windows even software, and there was also a 2d graphics accelerator! <br><br>  Having rolled up our sleeves and discarded Qingdao, we began to compile violently, and after a couple of weeks we already had our QML with C ++ instead of javascript.  This was our first QML of our own, which we polished for a long time, to the bitter end. <br><br>  But C ++ is quite hardcore, and it imposes its limitations, for example, you cannot distribute applications for different platforms, native code compiles for a very long time, is more demanding on the brain of a programmer, and requires more investments.  Therefore, in a couple of years, when we with the <i>(other)</i> colleague whiled away the evening at the pies in one of the Amsterdam coffee shops, we figured out how to return the javascript (represented by v8) to the native code. <br><br>  This background story may not be very interesting, because those two QML are in the past, along with the very corporation where they were born.  They never appeared before the general public as a development tool, but the UI built on this technology uses about six million people on a daily basis. <br><br><h2>  Our days (a year and a half ago) </h2><br>  After leaving this large and scary corporation, we also wanted to quickly and easily develop interfaces, and at the same time there was a need to write a large and complex application for SmartTV, immediately on 5 (!) Platforms.  Android for TVs had not yet come out, and all SmartTV then (like most now) offered an HTML-based SDK, promoting its frameworks and libs to make life easier for programmers (for example, caph from samsung), but this rather complicates the process, since the implementation One UI needed to be rewritten under the framework of each specific manufacturer.  The motivation of their (manufacturers) TVs to use web-based technologies is understandable, but the implementation becomes very painful as the complexity of the application increases.  Having a five-year experience of writing our own QML engines, we decided to make another own QML <i>(we need more bikes!)</i> , But for SmartTV in particular, and for HTML in general. <br><br>  So our modest project was born. <br><br><h2>  Basic <s>instinct</s> principle </h2><br>  Everything is arranged almost as in qml, all components are described in .qml files, in .manifest the structure of the application is described.  Next comes the translator / transpiler (?) QML in html5 / javascript: signals, updates, prototypes and constructors are generated and connected.  After the translation, a compact and fast javascript file is obtained, along with an html-launcher, requiring only <a href="https://modernizr.com/">Modernizr</a> . <br><br>  A distinctive feature is that we wrote QML in QML, all core components are written in qml and javascript, using our toolchain, the transpiler itself only decomposes files into namespaces and generates what they usually write with their hands. <br><br><h2>  Translation difficulties and bicycles </h2><br>  The QML dialect we use is very similar to the original QML.  The most important change is that we redid the logic of the focus, making it simpler and safer. <br><br>  In general, we try to maintain compatibility with Qt QML and sometimes arrange cross-hikes on discrepancies. <br><br>  Since we use HTML5 as the main platform <i>(probably, it‚Äôs not very fashionable to say this, I don‚Äôt know for sure)</i> , we use HTML as a simple drawing system for 2d graphics, positioning the elements (div) absolutely, relative to the parent.  This allowed us to fully implement the impurities, for example, to allow any element to handle hover or click events without using the terrible MouseArea monster.  You can also add a Border, Gradient or Drag-n-Drop to arbitrary elements without creating an additional element, and without creating a bundle Item-MouseArea. <br><br><h2>  Current state </h2><br>  Obviously, with a small organized programmer group of three people, we did not implement all the components and functions included in Qt QML, but a significant part, the most useful, in our opinion, we did. <br><br>  A documentation generator and a navigator on it, like the skeleton of the documentation itself, are created using doxygen-like annotations.  Required to clean up the library components. <br>  Finalize instructions and tools for Windows and MacOS. <br><br>  We have a lot of ideas for optimization, functional enhancement and platform improvements, and more. <br><br>  Nevertheless, the core of the project is already quite stable, and we, by this time, managed to release several commercial projects (and several non-commercial) on our PureQML. <br><br>  We are looking forward to your feedback, and if someone wants to do something really working, it will be just fine! <br><br>  To all who read this confession to the end, thank you so much! <br><br>  If this article is interesting to anyone, we can continue to consider our QML vision, the development of impurities, integration with different platforms at different levels, declaratively and not, improving the language, adding dimensions to the declaration (%, em, pt). <br><br>  We have so far decided not to open source codes for smartTV platforms, but, in general, we are considering this possibility.  If you want to get a version for SmartTV, write in the comments, we will think in what form it can be done. </div><p>Source: <a href="https://habr.com/ru/post/325318/">https://habr.com/ru/post/325318/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325304/index.html">How we ported the software / hardware solution from SPARC Solaris to AMD64 Linux and virtualized it all</a></li>
<li><a href="../325308/index.html">Functional C #</a></li>
<li><a href="../325310/index.html">Development ‚Üí Kazakhstan: How I helped to submit 100 forms of tax reporting. Continuation 300 form</a></li>
<li><a href="../325312/index.html">The right to oblivion does not apply to data in business registers: decision of the Court of Justice of the European Union of March 9, 2017</a></li>
<li><a href="../325316/index.html">MySQL sample rotation</a></li>
<li><a href="../325320/index.html">Node.js Streams and Reactive Programming</a></li>
<li><a href="../325322/index.html">Productive weekend: when all things can be put off until later</a></li>
<li><a href="../325326/index.html">3.5 years, 500k Go lines. Part 1</a></li>
<li><a href="../325328/index.html">Tuning SQL Server 2012 under SharePoint 2013/2016. Part 2</a></li>
<li><a href="../325330/index.html">Security Watch: IBM QRadar SIEM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>