<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What is written in this? Hacking JavaScript Objects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JavaScript is a multi-paradigm language that supports object-oriented programming and dynamic method binding ‚Äî a powerful concept that allows the stru...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What is written in this? Hacking JavaScript Objects</h1><div class="post__text post__text-html js-mediator-article"> JavaScript is a multi-paradigm language that supports object-oriented programming and dynamic method binding ‚Äî a powerful concept that allows the structure of JavaScript code to change during program execution.  This gives developers serious opportunities, it makes the language flexible, but you have to pay for everything.  In this case, you have to pay clarity code.  The keyword <code>this</code> makes a significant contribution to this price, around which features a lot of things are collected that can confuse a programmer. <br><br> <a href="https://habr.com/ru/company/ruvds/blog/455527/"><img src="https://habrastorage.org/webt/ii/kt/pk/iiktpkrhqof7akjucnspeywzs0e.png"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Dynamic method binding</font> </h2><br>  Dynamic binding allows you to specify, during program execution, and not during compilation, the method that needs to be called when executing a certain command.  In JavaScript, this mechanism is implemented using the <code>this</code> and a chain of prototypes.  In particular, the specific value of <code>this</code> inside the method is determined during the execution of the program, and the rules for determining this value vary depending on how this method was declared. <br><br>  Let's play one game.  I call it "What's in this?".  Before you, its first option is the code of the ES6 module: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-string"><span class="hljs-string">'a'</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">getThis</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, getThis2 () {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } }; obj.getThis3 = obj.getThis.bind(obj); obj.getThis4 = obj.getThis2.bind(obj); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> answers = [ obj.getThis(), obj.getThis.call(a), obj.getThis2(), obj.getThis2.call(a), obj.getThis3(), obj.getThis3.call(a), obj.getThis4(), obj.getThis4.call(a) ];</code> </pre> <br>  Before reading further, think about what will fall into the answers array and write down the answers.  After you do this - check yourself by <code>answers</code> using <code>console.log()</code> .  Did you manage to correctly ‚Äúdecipher‚Äù the value of <code>this</code> in each of the cases? <br><br>  Let us analyze this problem, starting with the first example.  The <code>obj.getThis()</code> construction returns <code>undefined</code> .  Why?  To the arrow function <code>this</code> cannot be tied.  Such functions use <code>this</code> from the surrounding lexical scope.  The method is called in the ES6 module, in its lexical scope <code>this</code> will be <code>undefined</code> .  For the same reason, <code>undefined</code> and return call <code>obj.getThis.call(a)</code> .  The value of <code>this</code> when working with pointer functions cannot be reassigned even with <code>.call()</code> or <code>.bind()</code> .  This value will always correspond to <code>this</code> from the lexical scope in which such functions are located. <br><br>  The <code>obj.getThis2()</code> command demonstrates how to work with <code>this</code> when using the usual object methods.  If <code>this</code> not tied to a similar method, and provided that this method is not an arrow function, that is, it supports <code>this</code> binding, the <code>this</code> keyword is bound to the object for which the method is called using the property access syntax via point or using square brackets. <br><br>  With the construction <code>obj.getThis2.call(a)</code> already a little more difficult to figure out.  The <code>call()</code> method allows you to call a function with a given value of <code>this</code> , which is specified as an optional argument.  In other words, in this case, <code>this</code> is taken from the <code>.call()</code> parameter, as a result, the call <code>obj.getThis2.call(a)</code> returns the object <code>a</code> . <br><br>  Using the <code>obj.getThis3 = obj.getThis.bind(obj);</code>  we are trying to bind to <code>this</code> method, which is a switch function.  As we have already found out, this cannot be done.  As a result, calls to <code>obj.getThis3()</code> and <code>obj.getThis3.call(a)</code> return <code>undefined</code> . <br><br>  Methods that are ordinary functions can be bound to <code>this</code> , so <code>obj.getThis4()</code> , as expected, returns <code>obj</code> .  Calling <code>obj.getThis4.call(a)</code> returns <code>obj</code> , and not, as one would expect, <code>a</code> .  The fact is that before calling this command, we have already tied <code>this</code> command <code>obj.getThis4 = obj.getThis2.bind(obj);</code>  .  As a result, the execution of <code>obj.getThis4.call(a)</code> takes into account the state of the method in which it was after the first binding. <br><br><h2>  <font color="#3AC1EF">Using this in classes</font> </h2><br>  Here is the second version of our game - the same task, but now based on classes.  It uses the syntax of declaring public class fields (at the moment the <a href="https://github.com/tc39/proposal-class-fields">proposal</a> for this syntax is in the third stage of approval, it is available by default in Chrome, you can also use it using <code>@babel/plugin-proposal-class-properties</code> ). <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obj</span></span></span><span class="hljs-class"> </span></span>{ getThis = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> getThis2 () {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Obj(); obj2.getThis3 = obj2.getThis.bind(obj2); obj2.getThis4 = obj2.getThis2.bind(obj2); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> answers2 = [ obj2.getThis(), obj2.getThis.call(a), obj2.getThis2(), obj2.getThis2.call(a), obj2.getThis3(), obj2.getThis3.call(a), obj2.getThis4(), obj2.getThis4.call(a) ];</code> </pre> <br>  Before reading further, think about the code and record your vision of what will fall into the array of <code>answers2</code> . <br><br>  Is it done? <br><br>  Here all method calls, with the exception of <code>obj2.getThis2.call(a)</code> , will return a reference to the object instance.  The same call will return object <code>a</code> .  Arrow functions still take <code>this</code> from the lexical scope.  The difference between this example and the previous one is the difference in scopes from which <code>this</code> is taken. <br><br>  Namely, here we work with the properties of classes, which determines the peculiarities of the behavior of this code. <br><br>  The fact is that during the preparation of the code for execution, the values ‚Äã‚Äãare written to the properties of the classes like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obj</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() {   <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getThis = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } ...</code> </pre> <br>  In other words, it turns out that the switch function is declared inside the context of the constructor function.  Since we are working with a class, the only way to create an instance of it is to use the keyword <code>new</code> (if you forget about this keyword, you will get an error message). <br><br>  The most important tasks solved by the <code>new</code> keyword are to create a new instance of the object and to link <code>this</code> to the constructor.  This feature, taking into account what we have already said in the previous section, should help you understand what is happening. <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  Did you cope with the tasks given in this material?  A good understanding of how the <code>this</code> keyword behaves in JavaScript will save you a lot of time when debugging when looking for unclear reasons for incomprehensible errors.  If you answer some of the questions incorrectly, it means that it will be useful for you to practice. <br><br>  Experiment with a code of examples, and then test yourself again, and so on - until you manage to answer all the questions correctly.  After you figure it out yourself - find someone ready to listen to you, and tell him about why the methods from the tasks return exactly what they return. <br><br>  If all this seems more complicated than you expected, then know that you are not alone in this.  I checked on the knowledge of the features of <code>this</code> quite a few developers, and I think that only one of them was absolutely accurate in all of their answers. <br><br>  That language subsystem, which, at the very beginning, looked like a dynamic search for methods, which could be influenced by <code>.call()</code> , <code>.bind()</code> or <code>.apply()</code> , began to look much more complicated after the appearance of pointer functions and classes. <br><br>  Apparently, it will be useful to note the main features of classes and turnout functions in terms of using <code>this</code> .  Remember that the arrow functions always use <code>this</code> from their lexical scope, and the keyword <code>this</code> in classes is actually tied to a class constructor function.  And if you ever feel that you don‚Äôt know exactly what <code>this</code> indicates, use the debugger to check your assumptions about this. <br><br>  Also, remember that a lot can be done in JavaScript without using <code>this</code> in the code.  Experience tells me that virtually any JS code can be rewritten as pure functions that take all the arguments with which they work, in the form of an explicitly given list of parameters ( <code>this</code> can be perceived as an implicitly specified parameter with a mutable state).  The logic contained in pure functions is deterministic, which improves their testability.  Such functions have no side effects, which means that when working with them, in contrast to manipulations with <code>this</code> , you are unlikely to ‚Äúbreak‚Äù anything outside of them.  Whenever you change <code>this</code> , you face a potential problem, which is that something depending on <code>this</code> may stop working correctly. <br><br>  Notwithstanding the foregoing, it should be noted that <code>this</code> is a useful concept.  For example, it can be applied in order to organize the sharing of a certain method by a set of objects.  Even in functional programming, <code>this</code> can be useful for calling an object of its other methods from one method, which allows you to create something new on the basis of existing structures. <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> <br><br> <a href="https://ruvds.com/ru-rub/news/read/104"><img src="https://habrastorage.org/getpro/habr/post_images/a09/9e4/5a8/a099e45a81c9dafd3a3673edd5ea415b.jpg"></a> </div><p>Source: <a href="https://habr.com/ru/post/455527/">https://habr.com/ru/post/455527/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../455517/index.html">A graduate of the course of Netology "Data Science" about his work in the banking sector</a></li>
<li><a href="../455519/index.html">How we implemented the onboarding of new developers</a></li>
<li><a href="../45552/index.html">Sunset Web?</a></li>
<li><a href="../455523/index.html">Implementing the OpenStack LBaaS user interface</a></li>
<li><a href="../455525/index.html">Zimbra and protection from mail bombing</a></li>
<li><a href="../45553/index.html">That means what they do there! Mosaic in google.spreadsheets</a></li>
<li><a href="../455533/index.html">Bubble Physics: Search for a Foam Breakdown Mechanism</a></li>
<li><a href="../455535/index.html">Managing SSL / TLS certificates in clouds and containers is not human work.</a></li>
<li><a href="../455537/index.html">Search optimization in width: how to handle a graph with 10 billion states</a></li>
<li><a href="../455543/index.html">Is preparing a Kubernetes cluster easy and convenient? Announcing addon-operator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>