<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neural networks for beginners. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all readers of Habrahabr, in this article I want to share with you my experience in the study of neural networks and, as a result, their impl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neural networks for beginners. Part 1</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/4a2/61d/c6a/4a261dc6abcea37cf448267c74f0363c.jpg" alt="image"><br><br>  Hello to all readers of Habrahabr, in this article I want to share with you my experience in the study of neural networks and, as a result, their implementation, using the Java programming language, on the Android platform.  My familiarity with neural networks happened when the Prisma application came out.  It processes any photo using neural networks and reproduces it from scratch using the chosen style.  Having become interested in it, I rushed to look for articles and "tutorials", first of all, on Habr√©.  And to my great surprise, I did not find a single article that clearly and gradually described the algorithm of the operation of neural networks.  Information was fragmented and there were no key points.  Also, most authors rush to show the code in one or another programming language, without resorting to detailed explanations. <br><br>  Therefore, now that I have mastered neural networks well enough and found a huge amount of information from various foreign portals, I would like to share this with people in a series of publications where I will gather all the information you need if you are just starting to get acquainted with neural networks.  In this article, I will not put a strong emphasis on Java and will explain everything with examples so that you yourself can transfer it to any programming language you need.  In subsequent articles, I will talk about my application, written under the android, which predicts the movement of shares or currencies.  In other words, everyone who wants to plunge into the world of neural networks and eager for simple and accessible presentation of information or just those who do not understand something and want to pull up, welcome to the cat. <br><a name="habracut"></a><br>  The first and most important discovery of mine was the playlist of the American programmer Jeff Heaton, in which he analyzed in detail and clearly the principles of operation of neural networks and their classification.  After viewing this playlist, I decided to create my own neural network, starting with the simplest example.  You probably know that when you first start learning a new language, your first program will be Hello World.  This is a kind of tradition.  In the world of machine learning, there is also a Hello world and this is a neural network solving an exclusive or (XOR) problem.  The table is exclusive or looks like this: <br><table><tbody><tr><th>  a </th><th>  b </th><th>  c </th></tr><tr><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><td>  0 </td><td>  one </td><td>  one </td></tr><tr><td>  one </td><td>  0 </td><td>  one </td></tr><tr><td>  one </td><td>  one </td><td>  0 </td></tr></tbody></table>  Accordingly, the neural network takes as input two numbers and should output another number at the output - the answer.  Now about the neural networks themselves. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  What is a neural network? </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/947/cdd/918/947cdd91841e5ec69db32eddb7a070e9.jpg" alt="image"><br><br>  A neural network is a sequence of neurons connected by synapses.  The structure of the neural network came into the world of programming straight from biology.  Thanks to this structure, the machine acquires the ability to analyze and even memorize various information.  Neural networks are also able not only to analyze incoming information, but also to reproduce it from its memory.  Interested be sure to watch 2 videos from TED Talks: <a href="https://www.youtube.com/watch%3Fv%3DuSUOdu_5MPc%26index%3D2%26list%3DFLeakN3yOItVASrAnu779jzQ">Video 1</a> , <a href="https://www.youtube.com/watch%3Fv%3D0qVOUD76JOg%26index%3D3%26list%3DFLeakN3yOItVASrAnu779jzQ">Video 2</a> ).  In other words, the neural network is a machine interpretation of the human brain, in which there are millions of neurons transmitting information in the form of electrical impulses. <br><br><h2>  What are neural networks? </h2><br>  For now, we will consider examples at the most basic type of neural networks - this is a network of direct distribution (hereinafter referred to as SPR).  Also in subsequent articles I will introduce more concepts and tell you about recurrent neural networks.  AB, as derived from the name, is a network with a series connection of neural layers, information in it always goes only in one direction. <br><br><h2>  What are neural networks for? </h2><br>  Neural networks are used to solve complex problems that require analytical calculations similar to those of the human brain.  The most common applications of neural networks are: <br><br>  <b>Classification</b> - the distribution of data by parameters.  For example, at the entrance is given a set of people and you need to decide which of them to give a loan and who does not.  This work can be done by a neural network, analyzing such information as: age, solvency, credit history, and so on. <br><br>  <b>Prediction</b> - the ability to predict the next step.  For example, rising or falling stocks, based on the situation on the stock market. <br><br>  <b>Recognition</b> is currently the widest application of neural networks.  Used by Google when you are looking for a photo or in the camera phones, when it determines the position of your face and highlights it, and more. <br><br>  Now, in order to understand how neural networks work, let's take a look at its components and their parameters. <br><br><h2>  What is a neuron? </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e61/3db/569/e613db56971c92a6dedae728ef6997e0.png" alt="image"></div><br>  A neuron is a computational unit that receives information, performs simple calculations on it, and passes it on.  They are divided into three main types: input (blue), hidden (red) and output (green).  There is also a displacement neuron and a context neuron which we will discuss in the next article.  In the case when the neural network consists of a large number of neurons, the term layer is introduced.  Accordingly, there is an input layer that receives information, n hidden layers (usually no more than 3 of them) that process it and an output layer that displays the result.  Each of the neurons has 2 basic parameters: input data (input data) and output data (output data).  In the case of an input neuron: input = output.  In the others, the input information contains the total information of all neurons from the previous layer, after which, it is normalized using the activation function (for now just present it to f (x)) and enters the output field. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/604/b53/081/604b530814bf4c079ffd165167497df1.png"></div><br>  <b>It is important to remember</b> that neurons operate with numbers in the range [0,1] or [-1,1].  And what, you ask, then process the numbers that fall outside this range?  At this stage, the easiest answer is to divide 1 by this number.  This process is called normalization, and it is very often used in neural networks.  More on this later. <br><br><h2>  What is synapse? </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6c9/879/ae3/6c9879ae3bf445b3a7e39c0a26598471.png"></div><br>  A synapse is the connection between two neurons.  Synapses have 1 parameter - weight.  Thanks to him, the input information changes when transmitted from one neuron to another.  Suppose there are 3 neurons that transmit information to the following.  Then we have 3 weights corresponding to each of these neurons.  In that neuron, whose weight is greater, that information will be dominant in the next neuron (for example, color mixing).  In fact, a set of weights of a neural network or a matrix of weights is a kind of brain of the whole system.  Thanks to these weights, input information is processed and turned into a result. <br><br>  <b>It is important to remember</b> that during the initialization of the neural network, the weights are placed randomly. <br><br><h2>  How does a neural network work? </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8bf/88c/293/8bf88c293fc64a55bf09ea3e8c991ecb.png"></div><br>  In this example, a part of the neural network is depicted, where the letters I denote the input neurons, the letter H represents the hidden neuron, and the letter w denotes weights.  From the formula it is clear that the input information is the sum of all the input data multiplied by the corresponding weight.  Then we give input 1 and 0. Let w1 = 0.4 and w2 = 0.7. The input data of the H1 neuron will be as follows: 1 * 0.4 + 0 * 0.7 = 0.4.  Now that we have the input data, we can get the output by substituting the input value into the activation function (more on this later).  Now that we have the output, we pass it on.  And so, we repeat for all layers until we reach the output neuron.  By launching such a network for the first time, we will see that the answer is far from correct, because the network is not trained.  To improve the results we will train it.  But before we learn how to do this, let's introduce a few terms and properties of the neural network. <br><br><h3>  Activation function </h3><br>  The activation function is a way to normalize the input data (we already talked about this earlier).  That is, if you have a large number at the entrance, by passing it through the activation function, you will get an exit in the range you need.  There are a lot of activation functions, so we will look at the most basic ones: Linear, Sigmoid (Logistic) and Hyperbolic tangent.  Their main differences are the range of values. <br><br>  <b>Linear function</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/84d/a8a/f6b/84da8af6b86c4c48bcaafb5be1c53ff6.png"></div><br>  This function is almost never used, except when you need to test a neural network or transmit a value without transformation. <br><br>  <b>Sigmoid</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/150/8ef/062/1508ef06235444c3bc74a942812b4eb7.png"></div><br>  This is the most common activation function, its value range is [0,1].  It shows the majority of examples in the network, it is also sometimes called the logistic function.  Accordingly, if in your case there are negative values ‚Äã‚Äã(for example, stocks can go not only up, but also down), then you need a function that captures negative values. <br><br>  <b>Hyperbolic tangent</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/c71/db2/a75/c71db2a756494e5298ed1d5b5f15cbc9.png"></div><br>  It makes sense to use a hyperbolic tangent, only when your values ‚Äã‚Äãcan be both negative and positive, since the range of the function is [-1,1].  It is impractical to use this function with positive values ‚Äã‚Äãonly as this will significantly worsen the results of your neural network. <br><br><h2>  Training set </h2><br>  A training set is a sequence of data with which a neural network operates.  In our case, the exclusive or (xor) we have only 4 different outcomes, that is, we will have 4 training sets: 0xor0 = 0, 0xor1 = 1, 1xor0 = 1.1xor1 = 0. <br><br><h2>  Iteration </h2><br>  This is a kind of counter that increases each time a neural network passes one training set.  In other words, this is the total number of training sets traversed by the neural network. <br><br><h2>  The epoch </h2><br>  When the neural network is initialized, this value is set to 0 and has a ceiling that is set manually.  The greater the era, the better the network is trained and, accordingly, its result.  The era increases each time we go through the entire set of training sets, in our case, 4 sets or 4 iterations. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d73/0a6/439/d730a643937f45ca997d73eec4fabddd.png"></div><br>  <b>It is important</b> not to confuse the iteration with the epoch and to understand the sequence of their increment.  N first <br>  times the iteration increases, and then the era and not vice versa.  In other words, you cannot first train a neural network only on one set, then on another, and so on.  You need to train each set once in an era.  So, you can avoid computation errors. <br><br><h2>  Mistake </h2><br>  Error is a percentage value that reflects the discrepancy between the expected and received responses.  A mistake is formed every epoch and should go into decline.  If this does not happen, then you are doing something wrong.  The error can be calculated in different ways, but we will consider only three main methods: Mean Squared Error (hereinafter MSE), Root MSE and Arctan.  There is no restriction on use, as in the activation function, and you are free to choose any method that will bring you the best result.  One has only to consider that each method counts errors in different ways.  In Arctan, the error will almost always be greater, since it works on the principle: the bigger the difference, the bigger the error.  Root MSE will have the smallest error, which is why, most often, MSE is used, which maintains a balance in the error calculation. <br><br>  <b>MSE</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/8b2/b5a/997/8b2b5a9974f841a0af487f671aae850b.png"></div><br>  <b>Root MSE</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/2dc/6e7/193/2dc6e7193baa47178ddd5ea8f33faa11.png"></div><br>  <b>Arctan</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/7df/1a8/e0f/7df1a8e0f36944af87d7452701c97624.png"></div><br>  The principle of error counting is the same in all cases.  For each set, we consider an error, taking away from the ideal answer, received.  Next, either squaring or calculating the square tangent from this difference, after which the resulting number is divided by the number of sets. <br><br><h2>  Task </h2><br>  Now, to test yourself, calculate the result of a given neural network using sigmoid and its error using MSE. <br><br>  Data: I1 = 1, I2 = 0, w1 = 0.45, w2 = 0.78, w3 = -0.12, w4 = 0.13, w5 = 1.5, w6 = -2.3. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dad/168/f54/dad168f54a2d4cf0b6508200eda50eef.png"></div><br><div class="spoiler">  <b class="spoiler_title">Decision</b> <div class="spoiler_text">  H1input = 1 * 0.45 + 0 * -0.12 = 0.45 <br>  H1output = sigmoid (0.45) = 0.61 <br><br>  H2input = 1 * 0.78 + 0 * 0.13 = 0.78 <br>  H2output = sigmoid (0.78) = 0.69 <br><br>  O1input = 0.61 * 1.5 + 0.69 * -2.3 = -0.672 <br>  O1output = sigmoid (-0.672) = 0.33 <br><br>  O1ideal = 1 (0xor1 = 1) <br><br>  Error = ((1-0.33) ^ 2) /1=0.45 <br><br>  The result is 0.33, an error is 45%. <br></div></div><br>  Thank you very much for your attention!  I hope that this article was able to help you in the study of neural networks.  In the next article, I will talk about displacement neurons and how to train a neural network using the back propagation method and gradient descent. <br><br>  Resources used: <br>  - <a href="https://youtube.com/playlist%3Flist%3DPLHIAnqK_uV8FJlIh04cUMZMPWNHryN7Ma">Once</a> <br>  - <a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/">two</a> <br>  - <a href="http://stevenmiller888.github.io/mind-how-to-build-a-neural-network/">three</a> </div><p>Source: <a href="https://habr.com/ru/post/312450/">https://habr.com/ru/post/312450/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312428/index.html">Microsoft fixed vulnerabilities in their products</a></li>
<li><a href="../312430/index.html">How to write less code for MR, or why the world needs another query language? History of Yandex Query Language</a></li>
<li><a href="../312432/index.html">Internet provider fined ¬£ 400,000 after hacker attack with client data leakage</a></li>
<li><a href="../312442/index.html">Elixir: making code extensible with Behavior</a></li>
<li><a href="../312448/index.html">Personal experience of implementing the GLPI system. Part 1</a></li>
<li><a href="../312456/index.html">1C in the clouds</a></li>
<li><a href="../312458/index.html">Facebook and Google have released Yarn, a new JavaScript package manager.</a></li>
<li><a href="../312460/index.html">ONLYOFFICE or Libre: about the battle of formats and co-editing</a></li>
<li><a href="../312470/index.html">Storing user passwords in Google Chrome on Android</a></li>
<li><a href="../312472/index.html">Why super-mega-about machine learning in 15 minutes still does not become</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>