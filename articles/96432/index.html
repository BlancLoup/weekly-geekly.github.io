<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automate the cleaning of document images with Sikuli</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago I was asked to expand one old comment to a full-fledged topic. I don‚Äôt think that in itself it is interesting enough, but I had an idea:...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automate the cleaning of document images with Sikuli</h1><div class="post__text post__text-html js-mediator-article">  <i>Some time ago I was asked to expand one old <a href="http://habrahabr.ru/blogs/DIY/80701/">comment</a> to a full-fledged topic.</i>  <i>I don‚Äôt think that in itself it is interesting enough, but I had an idea: why not combine the useful with the pleasant and not get acquainted closer with one curious tool, the <a href="http://habrahabr.ru/blogs/ui_design_and_usability/82639/">news</a> about which has recently spread all the IT resources.</i> <br><br><h3>  Problem </h3><br>  The main task that we will be solving within the framework of this topic is the preparation of scans and photographs of written sources (books, lectures, etc.) for their printing, compact storage, packaging in djvu, etc. <br>  Photoshop and FineReader will not be considered.  Although they provide a number of useful tools, they cost money, generally speaking. <br>  In the presence of a scanner, everything is usually simple: you get images of good enough quality so that you can get by with minimal processing. <br>  With photos it is more interesting: problems with lighting and geometrical distortions are added.  Alas, it is difficult to automate the correction of geometric distortions.  But with lighting and background it is quite possible to fight.  What we do. <br><a name="habracut"></a><br><h3>  Instruments </h3><br>  <strong>Paint.NET</strong> is a raster graphics editor for Windows, with support for layers and filters. <br>  <strong>Sikuli</strong> is essentially a tool for automating interactions with the graphical interface.  Plus additional opportunities for testing applications, but in this article we do not touch them.  We will use Sikuli to compensate for the lack of full support for macros in Paint.NET. <br>  The main killer feature Sikuli should be the visibility and simplicity of the created scripts, according to the principle <em>‚ÄúWhat you see, it works the way‚Äù</em> ( <em>‚ÄúWhat you see is how it works‚Äù</em> ).  True, the overall dampness of the project spoils the impression.  I worked with version 0.09.  In the recently released version 0.10, the main rake has been removed, but there are still no many usual things, like the Undo function in the editor. <br><blockquote>  <em>By the way, I recently stumbled upon a <a href="http://www.qaliber.net/">QAliber</a> project.</em>  <em>Apparently, it has a number of advantages in terms of interaction with the interface under test and general elaboration.</em>  <em>But visibility ... In general, you can see and feel the difference :) Although, perhaps, on occasion, I‚Äôll try to use QAliber.</em> </blockquote><br>  <a href="http://sikuli.org/documentation.shtml">The Sikuli architecture</a> includes several layers written in various languages: <ul><li>  The top level is the Jython API.  In essence, the Sikuli scripts are programs in Python, and refer to the functions provided by the Jython API.  (Each project is stored in the% scriptname% .sikuli folder. Inside the folder is the% scriptname% .py file and images in PNG format.) The author mentions the possibility of implementing the top level in any other language running on top of the JVM.  <a href="http://goo.gl/Fa8j" title="How to use Sikuli Script in your JAVA programs">You can work</a> with Sikuli Java API directly from your program. </li><li>  The middle level is a Java API.  It works with keyboard and mouse, and also interacts with the OpenCV library to search for predefined graphical templates on the screen. </li><li>  Accordingly, the lower, platform- <a href="http://opencv.willowgarage.com/wiki/">dependent</a> level is the <a href="http://opencv.willowgarage.com/wiki/">OpenCV library</a> , implemented in C / C ++. </li></ul>  I described the architecture is not quite as the author, but most importantly, that the idea of ‚Äã‚Äãthe system can be made. <br><br><h3>  Theory </h3><br>  Since our task is, in essence, the separation of the useful signal from noise, then, to explain the idea, you can use suitable analogies: a bandpass filter and an active noise cancellation system. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A simple <em>Threshold</em> filter acts as a band-pass filter, simply ‚Äúcutting off‚Äù pixels with a brightness below the specified boundary (setting the brightness to 0 for them, and to 255 for all others).  More advanced <em>Levels</em> sets two boundaries between which values ‚Äã‚Äãchange smoothly. <br>  In case the brightness inside the image changes over a wide range, it will not be possible to ‚Äúcut off‚Äù the noise without losing the useful signal just using a bandpass filter.  We need a more cunning method. <br><br>  The principle of active noise cancellation systems in two words can be expressed as: "(Signal + Noise) - (Noise) = (Signal)". <br>  (Beep + Noise) is our shot.  (Noise) - this is the background, everything except the text.  (Signal) is, accordingly, the text. <br>  At the beginning we only have (Signal + Noise), but in our case it‚Äôs easy to get from it (Noise), if we use a certain property of the useful signal (text): it consists of thin lines. <br>  It is necessary to choose a filter that neatly ‚Äúblurs‚Äù the text, so that the image looks like a clean sheet.  As such a filter, <em>Median Blur is</em> suitable (which in Paint.Net is for some reason in the <em>Noise</em> menu as a means of <em>fighting noise</em> . Well, we will use it for the opposite purpose, removing the useful signal :) <br>  True, with illustrations, things may not be so smooth, and they will have to be processed separately ... <br><br>  The action algorithm is as follows: <br><ol><li>  Apply a <em>Median Blur</em> filter to the original image to get a clean background without text; </li><li>  Calculate the difference between the original and obtained in claim 1 images; </li><li>  Invert the image obtained in step 2 (we need dark text on a white background); </li><li>  Apply Levels filter to even out the contrast and get rid of the slight noise left after 1-2. </li></ol><blockquote>  <em>There could be beautiful schemes and illustrations here, but I could not reconcile my perfectionism with design abilities (or rather, their absence).</em>  <em>I hope the meaning is quite transparent and without pictures.</em> </blockquote><br><br><h3>  Automation </h3><br>  So, the task for automation is using Sikuli to open and process a set of images according to the described algorithm in Paint.NET. <br>  I didn‚Äôt think of anything better than opening the folder with images in advance and letting Sikuli walk through the icons launching Paint.NET through the context menu ... <br><br>  Open Sikuli IDE and start a new script by declaring the necessary variables: <br><blockquote><code>patterns <font color="#666666">=</font> [ <img src="http://img404.imageshack.us/img404/9060/1270062582173.png"> , <img src="http://img94.imageshack.us/img94/9764/iconbmp2.png"> , <img src="http://img33.imageshack.us/img33/8864/iconjpg2.png"> ] <br> openwith_img <font color="#666666">=</font> <img src="http://img413.imageshack.us/img413/4723/openwith1.png"> <br> paintnet_img <font color="#666666">=</font> <img src="http://img535.imageshack.us/img535/7853/openwithpaintnet.png"> <br> waitfor_img <font color="#666666">=</font> <img src="http://img232.imageshack.us/img232/4219/1269973637814.png"> <br> edited_text <font color="#666666">=</font> <font color="#BA2121">"_edited"</font> <br> base_timeout <font color="#666666">=</font> <font color="#666666">30000</font> <br> negation_mode <font color="#666666">=</font> <img src="http://img594.imageshack.us/img594/7459/1269974766470.png"> <br> difference_mode <font color="#666666">=</font> <img src="http://img171.imageshack.us/img171/22/1269981508955.png"></code> </blockquote><br><ul><li>  <em>patterns</em> - an array with images of those file formats that will be processed; </li><li>  <em>openwith_img</em> , <em>paintnet_img</em> - context menu items to click on; </li><li>  <em>waitfor_img</em> - the opening operation of Paint.NET will take some time and is considered completed when this fragment appears on the screen; </li><li>  <em>edited_text</em> - suffix that will be added to the names of processed files; </li><li>  <em>base_timeout</em> - the base value of the waiting time of all resource-intensive operations (in milliseconds), so as not to change the timeouts throughout the script, if necessary; </li><li>  <em>negation_mode</em> , <em>difference_mode</em> - while I was writing the script, I experimented with these two modes of layer blending.  Therefore, it was convenient for me to declare them as variables. </li></ul><br>  Here it is necessary to pay attention to the fundamental problem of the Sikuli approach - the limited portability of scripts. <br>  Almost certainly you have different icons of graphic formats.  They will have to add to the script yourself.  The rest of the images may be affected by the OS and the design used (VisualStyle).  In my case, this is Windows XP and <a href="http://b0se.deviantart.com/art/Opus-OS-1-5-4591314">Opus OS</a> from b0se. <br><br>  All the necessary functions follow. <br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">OpenWith</font> (x, y, w): <br> rightClick(x) <br> click(openwith_img) <br> click(y) <br> wait(w, timeout <font color="#666666">=</font> base_timeout <font color="#666666">*3</font> )</code> </blockquote> <br>  Opening a file through the context menu.  The function should receive three patterns: a file icon, a menu item corresponding to the desired application (Paint.NET, for example), and a fragment that appears on the screen when the download is complete. <br>  <em>Habrap User forgive me for meaningless variable names.</em> <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">SaveFile</font> (suffix): <br> type( <font color="#BA2121">"f"</font> , KEY_ALT) <br> click( <img src="http://img192.imageshack.us/img192/8826/1269984284111.png"> ) <br> type(Key <font color="#666666">.</font> END <font color="#666666">+</font> suffix) <br> sleep( <font color="#666666">1</font> ) <br> type(Key <font color="#666666">.</font> ENTER) <br> sleep( <font color="#666666">1</font> ) <br> type(Key <font color="#666666">.</font> ENTER) <br> sleep( <font color="#666666">7</font> )</code> </blockquote> <br>  Save file in Paint.NET.  Press Alt + F to get to the File menu.  <em>(In the script, I do not use all possible keyboard shortcuts to navigate the menu, although this would reduce the script and reduce the number of graphic fragments. I was faced with the fact that the combinations with Ctrl + Shift did not always work in Sikuli, so I acted in a more reliable way. )</em> <br>  After clicking on the ‚ÄúSave As ...‚Äù menu item, the input focus will be on the file name input field.  We add a suffix to it.  I did not come up with a reliable sign of the completion of the save, and therefore at the end of the function I inserted inaction for a sufficient period of time (7 seconds). <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">DoBlackWhite</font> (): <br> type( <font color="#BA2121">"a"</font> , KEY_ALT) <br> click( <img src="http://img696.imageshack.us/img696/4775/1269979921252.png"> ) <br> wait( <img src="http://img30.imageshack.us/img30/61/1269971801455.png"> , timeout <font color="#666666">=</font> base_timeout)</code> </blockquote> <br>  The B / W filter is the first filter we need.  Alt + A open the <em>Adjustments</em> menu and select the required item.  The filter works without parameters.  We are waiting until the corresponding mark appears in the <em>History</em> panel.  (A very convenient panel appeared.) <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">DoDuplicateLayer</font> (): <br> type( <font color="#BA2121">"l"</font> , KEY_ALT) <br> click( <img src="http://img171.imageshack.us/img171/5859/1269979841486.png"> ) <br> wait( <img src="http://img695.imageshack.us/img695/4048/1269972172783.png"> , timeout <font color="#666666">=</font> base_timeout)</code> </blockquote> <br>  Clone a layer.  The process is similar.  In our case, you do not need to switch between layers.  This is good, otherwise you would have to tinker with the <em>Layers</em> panel. <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">DoInvertColors</font> (): <br> type( <font color="#BA2121">"a"</font> , KEY_ALT) <br> click( <img src="http://img404.imageshack.us/img404/3513/1269973974173.png"> ) <br> wait( <img src="http://img22.imageshack.us/img22/948/1269973195252.png"> , timeout <font color="#666666">=</font> base_timeout)</code> </blockquote> <br>  Filter Negative.  Similar to the previous one. <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">DoOilPaint</font> (a, b): <br> type( <font color="#BA2121">"c"</font> , KEY_ALT) <br> click( <img src="http://img412.imageshack.us/img412/6271/1269973484486.png"> ) <br> click( <img src="http://img26.imageshack.us/img26/2822/1269973538845.png"> ) <br> sleep( <font color="#666666">0.1</font> ) <br> type(a <font color="#666666">+</font> Key <font color="#666666">.</font> TAB <font color="#666666">+</font> Key <font color="#666666">.</font> TAB <font color="#666666">+</font> Key <font color="#666666">.</font> TAB <font color="#666666">+</font> b <font color="#666666">+</font> Key <font color="#666666">.</font> ENTER) <br> wait( <img src="http://img687.imageshack.us/img687/6184/1269973068705.png"> , timeout <font color="#666666">=</font> base_timeout <font color="#666666">*2</font> )</code> </blockquote> <br>  <a href="">Oil Painting</a> Filter.  I initially used it, but ultimately refused in favor of <em>Median Blur</em> .  Still save for the story :) <br>  <em>(There is no point in worrying about the dead code in this case. Suddenly, someone will come in handy ... In fact, all the functions for working with Paint.NET would be worth putting into a separate file if Sikuli would support the appropriate feature.)</em> <br>  This is the first filter to have a settings dialog.  A couple of necessary parameters are passed to the function, which are entered into the appropriate form fields. <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">DoMedian</font> (a, b): <br> type( <font color="#BA2121">"c"</font> , KEY_ALT) <br> click( <img src="http://img714.imageshack.us/img714/2874/1269976632939.png"> ) <br> click( <img src="http://img175.imageshack.us/img175/7654/1269976676205.png"> ) <br> sleep( <font color="#666666">0.1</font> ) <br> type(a <font color="#666666">+</font> Key <font color="#666666">.</font> TAB <font color="#666666">+</font> Key <font color="#666666">.</font> TAB <font color="#666666">+</font> Key <font color="#666666">.</font> TAB <font color="#666666">+</font> b <font color="#666666">+</font> Key <font color="#666666">.</font> ENTER) <br> wait( <img src="http://img405.imageshack.us/img405/7687/1269976908033.png"> , timeout <font color="#666666">=</font> base_timeout <font color="#666666">*2</font> )</code> </blockquote> <br>  The <a href="">Median Blur</a> filter is in the <em>Effects&gt; Noise</em> menu.  It is configured similarly to the previous one, and is very useful to us. <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">DoLayerBlend</font> (mode): <br> type(Key <font color="#666666">.</font> F4) <br> click( <img src="http://img42.imageshack.us/img42/7065/1269974451392.png"> ) <br> click(mode) <br> type(Key <font color="#666666">.</font> ENTER) <br> wait( <img src="http://img688.imageshack.us/img688/5286/1269977286173.png"> , timeout <font color="#666666">=</font> base_timeout) <br> type( <font color="#BA2121">"m"</font> , KEY_CTRL) <br> wait( <img src="http://img62.imageshack.us/img62/5521/1269977316627.png"> , timeout <font color="#666666">=</font> base_timeout)</code> </blockquote> <br>  Mixing layers.  For F4, open the <a href="">layer properties dialog</a> and select the desired blend mode (passed as a parameter).  Immediately glue the layers by Ctrl + M. <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">DoLevels</font> (iwp, ibp, ogamma): <br> k_del <font color="#666666">=</font> Key <font color="#666666">.</font> DELETE <font color="#666666">+</font> Key <font color="#666666">.</font> DELETE <font color="#666666">+</font> Key <font color="#666666">.</font> DELETE <font color="#666666">+</font> Key <font color="#666666">.</font> DELETE <br> type( <font color="#BA2121">"a"</font> , KEY_ALT) <br> click( <img src="http://img7.imageshack.us/img7/4420/1269982199673.png"> ) <br> type(k_del) <br> type(iwp) <br> type(Key <font color="#666666">.</font> TAB <font color="#666666">+</font> Key <font color="#666666">.</font> TAB) <br> type(k_del) <br> type(ogamma) <br> type(Key <font color="#666666">.</font> TAB) <br> type(k_del) <br> type(ibp) <br> sleep( <font color="#666666">0.1</font> ) <br> type(Key <font color="#666666">.</font> ENTER) <br> wait( <img src="http://img195.imageshack.us/img195/1398/1269979005392.png"> , timeout <font color="#666666">=</font> base_timeout)</code> </blockquote> <br>  Filter <a href="">Levels</a> .  The dialog allows you to configure five parameters: Input White Point, Input Black Point, Output White Point, Output Black Point, Output Gamma.  At the output of the filter, we need to get the maximum contrast, so the OWP and OBP do not touch.  The rest is passed as parameters. <br>  The behavior of the input fields in this dialog is different from the other dialogs.  You have to specifically clear them, imitating clicking on Delete. <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">DoFilter</font> (): <br> DoBlackWhite() <br> DoDuplicateLayer() <br> DoMedian( <font color="#BA2121">"35"</font> , <font color="#BA2121">"50"</font> ) <br> DoLayerBlend(difference_mode) <br> DoInvertColors() <br> DoLevels( <font color="#BA2121">"235"</font> , <font color="#BA2121">"200"</font> , <font color="#BA2121">"1"</font> )</code> </blockquote> <br>  We begin to collect all the blanks in a single unit.  Actually, the rest of the script is for the sake of ensuring the work of this function.  Here you can call the sequence of filters with the necessary parameters. <br>  <em>(It is recommended to adjust the DoLevels () parameters for each set of images, although at the end of the article I present examples performed in one pass with the specified parameters ...)</em> <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">RunTaskOverImage</font> (x): <br> OpenWith(x, paintnet_img, waitfor_img) <br> sleep( <font color="#666666">2</font> ) <br> DoFilter() <br> sleep( <font color="#666666">1</font> ) <br> SaveFile(edited_text) <br> sleep( <font color="#666666">1</font> ) <br> closeApp( <font color="#BA2121">"paint.NET"</font> ) <br> sleep( <font color="#666666">1</font> )</code> </blockquote> <br>  Opening, processing, saving, closing a separate file.  The parameter is the found <a href="">region</a> that contains the file icon (or <a href="">pattern</a> ) to be processed. <br><br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#0000FF">main</font> (): <br> <font color="#008000"><strong>for</strong></font> pat <font color="#AA22FF"><strong>in</strong></font> patterns: <br> setThrowException( <font color="#008000">False</font> ) <br> find_regs <font color="#666666">=</font> findAll(Pattern(pat) <font color="#666666">.</font> similar( <font color="#666666">0.95</font> )) <br> setThrowException( <font color="#008000">True</font> ) <br> <font color="#008000"><strong>if</strong></font> find_regs: <br> <font color="#008000"><strong>for</strong></font> region <font color="#AA22FF"><strong>in</strong></font> find_regs: <br> RunTaskOverImage(region)</code> </blockquote> <br>  Search for all files on the screen, and processing found. <br>  <em>setThrowException ()</em> - the function allows you to change the behavior of Sikuli in the case when <em>findAll ()</em> does not find a single region corresponding to the pattern.  In this case, we are not afraid if any pattern is not found on the screen. <br>  <em>Pattern (pat) .similar (0.95)</em> - the pattern search is performed with some tolerance.  This should, if possible, compensate for differences in interface settings on different machines.  The default factor, 0.7, is a too soft condition.  As a result, all my icons were considered the same, and the script tried to execute three times in a circle (by the number of patterns in the array).  1.0, however, should not be set either: OpenCV can skip even the necessary icons in this case. <br><br><blockquote> <code>sleep( <font color="#666666">1</font> ) <br> main() <br> popup( <font color="#BA2121">"done"</font> )</code> </blockquote> <br>  Final chord: call the function <em>main ()</em> and report the completion of the script. <br>  The <em>main ()</em> function is highlighted for easy debugging.  Instead, you can substitute a call to any of the functions described, and debug it separately. <br><br>  <a href="">Download source code archive</a> <br>  <a href="http://mxi.pp.ru/test/clean-images.sikuli/clean-images.html">View full source code.</a> <br><br><h3>  Testing </h3><br><br>  For the tests used: a picture from the comments, based on which this topic was written;  a couple of free snapshots from your archive;  random snapshot from the internet. <br><br><table><tbody><tr><td>  Before </td><td>  After </td><td>  Before </td><td>  After </td></tr><tr><td> <a href=""><img src="http://img686.imageshack.us/img686/513/270w.th.png"></a> </td><td> <a href=""><img src="http://img243.imageshack.us/img243/8701/270edited.th.png"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/345/2d5/f4f/3452d5f4fb5671be17ce36b524f313fb.jpg"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/543/b48/f38/543b48f385149605400c4190a8aa25d3.jpg"></a> </td></tr><tr><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/19c/4d3/916/19c4d39161a4e0515485ac425c8b06a4.jpg"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/863/07a/e88/86307ae886dba93acb249c844b6bccc1.jpg"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/def/01b/0b6/def01b0b6ae1c81e32915ddde94d5ad2.jpg"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/03a/1e7/504/03a1e75049dc358ac45e69f0e9747a11.jpg"></a> </td></tr></tbody></table><br><br>  The speed was measured on a laptop with a Pentium M 2 GHz and 2 GB of RAM.  Script execution time over 4 test images: <br><ul><li>  Run 1: 6:32 </li><li>  Run 2: 6:57 </li><li>  Run 3: 6:47 </li><li>  Run 4: 6:38 </li></ul><br>  Average time: 6 minutes 43 seconds.  Average processing time per image: 1 minute 41 seconds. <br>  The main time is eaten by filters.  But, I think, by optimizing the script, it would be possible to save ten seconds per image ... <br><br><h3>  findings </h3><br><ol><li>  If a person can extract useful information from the incoming data stream (read the text, parse the captcha ...), then an algorithm for the computer that extracts this information can also be compiled.  The complexity and versatility of this algorithm is a separate issue.  The more we want, the more details will have to be taken into account in the algorithm.  The described algorithm allows you to clear text snapshots in more severe cases than a simple <em>Threshold</em> filter, but it also has its limitations. </li><li>  To consider Sikuli IDE as a serious tool, today is difficult.  And not because ‚Äúprogramming with pictures‚Äù is a silly idea.  Just using Computer Vision while working with the interface is not very reliable, and the available tools are not very convenient and can add trouble even when solving simple tasks.  At another time, when a similar task <em>occurs,</em> I will try <em>QAliber</em> . </li><li>  For a number of tasks, I think the Sikuli Java API will come in handy as a convenient wrapper over OpenCV for use in your own testing tools, etc. </li></ol><br><br><h3>  Resources </h3><br>  <a href="http://www.getpaint.net/">Paint.NET official website</a> <br>  <a href="http://groups.csail.mit.edu/uid/sikuli/">Official site of Sikuli.</a>  <a href="http://groups.csail.mit.edu/uid/sikuli/">Download links, documentation, etc.</a> <br>  <a href="http://blog.sikuli.org/">Blog with announcements and sample scripts</a> <br>  <a href="">Sikuli Documentation Version 0.10</a> <br>  <a href="https://code.launchpad.net/sikuli">Sikuli page on LaunchPad</a> <br><br>  PS: Thanks to <a href="https://habrahabr.ru/users/free0u/" class="user_link">free0u</a> for support.  I apologize to those who were forced to wait and to whom this article would be more useful before the session than after. <br><br>  UPD: Transferred to "Algorithms".  If there is a better option - write. </div><p>Source: <a href="https://habr.com/ru/post/96432/">https://habr.com/ru/post/96432/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../96426/index.html">Markup independent elements</a></li>
<li><a href="../96428/index.html">Nokera N100: the first solar-powered bulb</a></li>
<li><a href="../9643/index.html">Browsers on the KHTML engine (WebKit)</a></li>
<li><a href="../96430/index.html">Microsoft: new thin Xbox 360 and LIVE in Russia</a></li>
<li><a href="../96431/index.html">Trac 0.12 released</a></li>
<li><a href="../96434/index.html">Package organization with css-suki</a></li>
<li><a href="../96435/index.html">Audience Habrhabra</a></li>
<li><a href="../96436/index.html">Flash game "Mafia" in the conditions of "in contact"</a></li>
<li><a href="../9644/index.html">Habraokhota. Flash game for half an hour.</a></li>
<li><a href="../96440/index.html">Win-win contest testing. Show yourself a connoisseur - win laptop</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>