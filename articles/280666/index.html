<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NetApp ONTAP and NAS Antivirus Protection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="NetApp storage systems with ONTAP firmware support NAS integration with antivirus, so that files are first checked before reading / writing, this feat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NetApp ONTAP and NAS Antivirus Protection</h1><div class="post__text post__text-html js-mediator-article">  NetApp storage systems with ONTAP firmware support NAS integration with antivirus, so that files are first checked before reading / writing, this feature is called Off-box Anti-Virus Scanning.  It allows you to increase the level of protection of corporate environments and unload the extra workload from workstations.  Since the support of anti-virus databases of all workstations up to date may not be a feasible task.  Supported products from: <br><br><ul><li>  Kaspersky </li><li>  Symantec </li><li>  Trend micro </li><li>  Computer associates </li><li>  Mcafee </li><li>  Sophos </li></ul><br>  In addition, it supports the advanced file-screening functionality (FPolicy), which allows you to restrict work with files not only on the basis of their extension, but also on the type of file based on the header inside this file. <br><br>  Today, I would like to elaborate on the integration of ONTAP with CIFS (SMB) and McAfee antivirus system.  Which is basically similarly arranged with other anti-virus systems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/d25/d6e/045/d25d6e04528442aca2b8e24a4edb16cf.png"><br><a name="habracut"></a><br><ol><li>  To configure the integration, we need several components: </li><li>  Microsoft Windows Server 2008 and up </li><li>  Storage with ONTAP firmware (based on the NetApp FAS hardware platform or as an ONTAP Select virtual machine or ONTAP Cloud in the Amazone / Azure cloud) </li><li>  McAfee VirusScan Enterprise for Storage.  Download <a href="http://www.mcafee.com/us/downloads/downloads.aspx">VSEfS here</a> </li><li>  SMB 2 and later is used for scanning, version 1.0 is not supported. </li><li>  NetApp ONTAP AV Connector.  Download <a href="http://support.netapp.com/NOW/download/software/ontap_av_connector">AV Connecor here</a> </li></ol><br>  For details, contact <a href="http://mysupport.netapp.com/matrix/">the compatibility matrix</a> . <br><br><img src="https://habrastorage.org/files/42a/7df/666/42a7df66607446f590dd613a0f828f8f.png"><br><br>  Antivirus interaction scheme when requesting from SMB client to NAS. <br><br><h4>  Training </h4><br>  In accordance with the diagram below, you need to install and configure all software components to integrate with the NAS. <br><br><img src="https://habrastorage.org/files/d26/aed/8de/d26aed8de385455ab40386371156c081.png"><br><br><h5>  Vsefs </h5><br>  Install McAfee VSEfS, which can operate in two modes: as a standalone product or as a product managed by McAfee ePolicy Orchestrator (McAfee ePO).  In this article I will consider the "stand-alone product" mode.  To install McAfee VSEfS, you will need to have it already installed and configured: <br><br><ul><li>  McAfee VirusScan Enterprise (VSE).  Download <a href="http://www.mcafee.com/us/downloads/downloads.aspx">VSE here</a> </li><li>  McAfee ePolicy Orchestrator (ePO), not needed if VirusScan is used as a standalone product. </li></ul><br><h5>  SCAN server </h5><br>  To begin with, we will create several SCAN servers in order to balance the load of the anti-virus scan between them.  Each SCAN server will be installed on the Windows Server and include the following components: McAfee VSE, McAfee VSEfS and ONTAP AV Connector.  For example, let's prepare three such servers: SCAN1, SCAN2, SCAN3. <br><br><h5>  AD </h5><br>  Create a user scanuser in the domain (in our example, the domain "NetApp") with administrative rights on the servers SCAN1, SCAN2, SCAN3. <br><br><h5>  ONTAP </h5><br>  Let's configure ONTAP, create a Cluster Management LIF and one VSM Management LIF.  We include support for CIFS protocol and run integration with AD, create data-LIFs for end-user access to file balls.  Create a file ball.  Create a user scanuser for the cluster and VSM, which will be authenticated in the same AD domain as the SCANx server.  Let the Cluster be available on the management IP address named NCluster-mgmt, and the VSM management IP address named VSM01-mgmt. <br><br><pre><code class="bash hljs">NCluster::&gt; network interface create -vserver NCluster -home-node NCluster-01 -home-port e0M -role data -protocols none -lif NCluster-mgmt -address 10.0.0.100 -netmask 255.0.0.0 NCluster::&gt; network interface create -vserver VSM01 -home-node NCluster-01 -home-port e0M -role data -protocols none -lif VSM01-mgmt -address 10.0.0.105 -netmask 255.0.0.0 NCluster::&gt; domain-tunnel create -vserver VSM01 NCluster::&gt; security login create -username netApp\scanuser -application ontapi -authmethod domain -role <span class="hljs-built_in"><span class="hljs-built_in">readonly</span></span> -vserver NCluster NCluster::&gt; security login create -username netApp\scanuser -application ontapi -authmethod domain -role <span class="hljs-built_in"><span class="hljs-built_in">readonly</span></span> -vserver VSM01</code> </pre> <br><h5>  ONTAP AV Connector </h5><br>  install ONTAP AV Connector on each SCAN-server and launch the configuration, after the installer finishes we drive in the username and password: <br><br><img src="https://habrastorage.org/files/fe5/4f2/4b2/fe54f24b27c94533a981ba9507aefd92.png"><br><br>  If the application says "Access is denied", check that UAC (Use Account Control) is turned off, restart the computer. <br><br>  <i>Start ‚Üí All Programs ‚Üí NetApp ‚Üí ONTAP AV Connector ‚Üí Configure ONTAP Management LIFs</i> <br>  In the field ‚ÄúManagement LIF‚Äù we enter the IP or DNS name of the VSM or cluster: NCluster-mgmt or VSM01-mgmt. <br><br>  In the "Account" field we drive in the name and password of an AD domain user: NetApp \ scanuser.  Press the "Test" button, then "Update" and "Save", if the test was successful. <br><br><img src="https://habrastorage.org/files/4ec/df0/e1b/4ecdf0e1b3dd4e928fffa1194bc742b5.png"><br><br><h5>  McAfee Network Appliance Filer AV Scanner Administrator Account </h5><br>  on each SCAN server, we go as Administrator and start: Windows taskbar - right-click on ‚ÄúMcAfee menulet ‚Üí Choose VirusScan console‚Äù, in VirusScan console - open ‚ÄúNetwork Appliance Filer AV Scanner‚Äù, then go to the tab ‚ÄúNetwork Appliance Filer AV Scanner and Network Appliance Filers.  In the ‚ÄúThis Server is a processing request for these filers‚Äù field, we create a server using the ‚ÄúAdd‚Äù button, in the ‚ÄúServer name‚Äù field we type ‚Äú127.0.0.1‚Äù (not ONTAP!).  Next, fill in the ‚ÄúAdministrator Account‚Äù fields, where we enter all the same AD user ‚Äúscanuser‚Äù, and in the ‚ÄúDomain‚Äù field, separate from the user name, enter the domain, in our case ‚ÄúNetApp‚Äù. <br><br><img src="https://habrastorage.org/files/33a/1fd/cdd/33a1fdcdd96647f19ff540638f5c7080.png"><br><br><h5>  Go back to ONTAP </h5><br>  And we configure integration: we configure off-box scanning, enable it, create and apply a scanning policy: <br><br><pre> <code class="bash hljs">NCluster::&gt; vserver vscan scanner-pool create -vserver VSM01 -scanner-pool POOL1 -servers SCAN1,SCAN2,SCAN3 -privileged-users NetApp\scanuser NCluster::&gt; vserver vscan scanner-pool show Scanner Pool Privileged Scanner Vserver Pool Owner Servers Users Policy -------- ---------- ------- ------------ ------------ ------- VSM01 POOL1 vserver SCAN1, NetApp\scanuser idle SCAN2,SCAN3 NCluster::&gt; vserver vscan scanner-pool show -instance Vserver: VSM01 Scanner Pool: POOL1 Applied Policy: idle Current Status: off Scanner Pool Config Owner: vserver List of IPs of Allowed Vscan Servers: SCAN1, SCAN2, SCAN3 List of Privileged Users: NetApp\scanuser NCluster::&gt; vserver vscan scanner-pool apply-policy -vserver VSM01 -scanner-pool POOL1 -scanner-policy primary NCluster::&gt; vserver vscan <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> -vserver VSM01 NCluster::&gt; vserver vscan connection-status show Connected Connected Vserver Node Server-Count Servers --------- -------- ------------ ------------------------ VSM01 NClusterN1 3 SCAN1, SCAN2, SCAN3 NCluster::&gt; vserver vscan on-access-policy show Policy Policy File-Ext Policy Vserver Name Owner Protocol Paths Excluded Excluded Status --------- --------- ------- -------- ---------------- ---------- ------ NCluster default_ cluster CIFS - - off CIFS VSM01 default_ cluster CIFS - - on CIFS</code> </pre><br><h4>  Licenses </h4><br>  FPolicy and Off-box Anti-Virus Scanning do not require any additional licenses from the storage system, this functionality is present in the ONTAP basic distribution.  On the part of anti-virus protection software and software, extended licenses for FPolicy may require additional licenses, which can be clarified with the respective vendors and their partner representatives. <br><br><h4>  findings </h4><br>  The ability to integrate the NAS with the anti-virus system allows, on the one hand, to load the load of the end clients, but also eliminates the potential threat of infection due to the inability to keep all clients' anti-virus databases up to date.  And FPolicy restricts the recording of non-storage files in a corporate environment. <br><br>  PS <br>  Also note the document describing <a href="http://www.netapp.com/us/media/tr-4569.pdf">ONTAP security settings to enhance security (Security Hardening Guide for NetApp ONTAP 9)</a> . <br><br>  Translation to English: <br>  <b><a href="https://wp.me/p9LTcx-2d">ONTAP &amp; Antivirus NAS protection</a></b> <br><br>  <b>This may contain links to Habra articles that will be published later</b> . <br>  <b>I ask to send messages on errors in the text to the <abbr title="Private message">LAN</abbr></b> . <br>  <b>Comments, additions and questions on the article on the contrary, please in the comments</b> . </div><p>Source: <a href="https://habr.com/ru/post/280666/">https://habr.com/ru/post/280666/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../280652/index.html">EMC relies on ReactOS for storing big data in the IoT sphere</a></li>
<li><a href="../280656/index.html">SQL Server 2014 Developer Edition is now free</a></li>
<li><a href="../280660/index.html">Traditional April 1 on the Internet</a></li>
<li><a href="../280662/index.html">CLRium # 3: .NET Technology Workshop</a></li>
<li><a href="../280664/index.html">8 harmful tips to "accelerate" the site</a></li>
<li><a href="../280668/index.html">A little bit about sockets, redis and broken eggs</a></li>
<li><a href="../280672/index.html">Attackers use a Linux / Remaiten bot to compromise embedded devices, part 2</a></li>
<li><a href="../280674/index.html">Quad-tree live visualization on Shader Model 2.0</a></li>
<li><a href="../280676/index.html">Unbelievable combinations of the Internet and real professions</a></li>
<li><a href="../280678/index.html">Mobile OCR. How it all began</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>