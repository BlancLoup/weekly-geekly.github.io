<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mobile phones and total NSA surveillance: how it works</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The name of Edward Snowden regularly flashes in the news on the topic of information security over the past two years. Thanks to the revelations of th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mobile phones and total NSA surveillance: how it works</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/pt/blog/245113/"><img src="https://habrastorage.org/getpro/habr/post_images/01b/255/137/01b2551371c334c9d319d1b32f12adbd.png" alt="image"></a> <br><br>  The name of Edward Snowden regularly flashes in the news on the topic of information security over the past two years.  Thanks to the revelations of this former US intelligence officer, everyone has already heard that the National Security Agency (NSA) has the power of total mobile surveillance of citizens.  But how exactly this surveillance is arranged, few people know.  In this review, we have gathered some details about the technologies used by the NSA - and not only that. <br><br>  One of the first unpleasant news from Snowden concerned the erosion of trust in <b>cryptographic technology</b> .  Within the framework of a secret NSA project called <a href="http://www.theguardian.com/world/interactive/2013/sep/05/nsa-project-bullrun-classification-guide">Bullrun</a> , the possibility of circumventing many encryption systems was obtained - but not at the expense of hacking, but at the expense of operating bookmarks specially left by manufacturers at the request of the NSA.  In some cases, vendors were simply obliged to hand over encryption keys to the agency.  Thus, many safety standards that were considered reliable and used in large business and government organizations <a href="http://www.nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html">were discredited</a> . <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/e12/e89/1c3/e12e891c34047934e9c0097c453c9653.png" alt="image"><br><br>  Just recently, the development of this story appeared in the media - some details of the <a href="https://firstlook.org/theintercept/2014/12/04/nsa-auroragold-hack-cellphones/">AuroraGold</a> operation, within the framework of which the NSA monitored the telecom employees, reading their electronic correspondence and internal documents.  Already in May 2012, the NSA thus collected technical data on 70% of the mobile networks around the world.  The GSM Association, the international organization of telecoms, where recommendations for new communication standards are being developed, was also tapped.  The goal of AuroraGold‚Äôs operation is the same as that of the Bullrun project: to introduce bookmarks or learn about vulnerabilities that will help circumvent the A5 / 3 encryption algorithm and other new protection technologies.  Judging by the documents from the Snowden archive, the first attempts to <a href="https://firstlook.org/theintercept/document/2014/12/04/first-ever-collect-high-interest-4g-cellular-signal">hack the G4</a> succeeded to the NSA agency back in 2010 ‚Äî that is, before this ‚Äúsafe‚Äù standard was widely distributed. <br><br>  Another vector of NSA attacks is <b>mobile OS and applications</b> .  As it turned out, the special service has access to a lot of data on smartphones: lists of contacts and calls of subscribers, as well as their SMS and GPS data.  To do this, the NSA gathered teams of hackers, each of which was engaged in hacking one of the popular OS.  The publication of the German magazine <a href="http://www.spiegel.de/international/world/how-the-nsa-spies-on-smartphones-including-the-blackberry-a-921161.html">Spiegel</a> emphasizes that the Blackberry operating system was one of the first hacked, although traditionally it was considered more secure than iOS and Android. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2b/5fd/3f3/e2b5fd3f3c1fc9528746c13952d47848.jpg" alt="image"><br><br>  And of course, the opportunities for wiretapping have significantly expanded due to the development of the <b>mobile application</b> market.  Many of them regularly transfer a significant amount of user data to third parties.  Thus, for eavesdropping, it is not necessary to hack the OS - it is enough to convince the user to install a ‚Äúuseful‚Äù mobile application. <br><br>  But even more possibilities for surveillance were found in the <b>mobile communication networks</b> themselves.  In the documents of Snowden there was a description of the NSA spy directory - <a href="http://www.spiegel.de/international/world/a-941262.html">the Ant project</a> , which has solutions for manipulating mobile networks for all occasions.  It is not necessary to intercept data through vulnerable software - you can set bookmarks at the manufacturing stage of communication devices.  For example, a compromised radio module for a telephone: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a3b/f0a/d3a/a3bf0ad3abb18dabc8f37d1183ba47d3.png" alt="image"><br><br>  Another option is fake base stations with which you can intercept subscriber traffic and manipulate data on his phone: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/980/467/a5e/980467a5e3382d373bff680c722c8c90.png" alt="image"><br><br>  Or the whole cellular network in one box: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/443/5c6/a28/4435c6a2805f6192bfb06c1d9e367dce.png" alt="image"><br><br>  There is also a spectrum analyzer based on the Motorola L9 mobile phone, which allows you to record a radio spectrum for further analysis: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/828/4dd/a35/8284dda35694555901cdd2dc81d626c6.png" alt="image"><br><br>  Determining a location using a cellular network is approximate.  To accurately locate the victim, there is a separate portable tool on site: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/978/f56/cc4/978f56cc4ce18a90491153e21db2faa3.png" alt="image"><br><br>  Of course, the mere existence of such a device catalog does not mean that someone already uses them for total surveillance.  However, following the publication of the catalog, evidence of practical application began to appear. <br><br>  In September 2014, <a href="http://securityaffairs.co/wordpress/28666/intelligence/nsa-spying-un-vienna.html">a</a> suspicious roof booth <a href="http://securityaffairs.co/wordpress/28666/intelligence/nsa-spying-un-vienna.html">was discovered</a> on the IZD-Tower, opposite the UNO-city complex (Vienna International Center).  The booth is fenced with a solid metal fence, under the supervision of 10 cameras.  Most likely, this is a fake base station mobile network. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8d1/02b/cb2/8d102bcb269e83ec3e0e44a6735e8de8.png" alt="image"><br><br>  Vienna is the third city-residence of the United Nations (after New York and Geneva), the headquarters of OPEC and the OSCE are located there.  The interest of the NSA to the place where high-ranking officials of most countries gather is quite understandable.  But the estimated coverage of this station: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27c/4f2/39a/27c4f239acb2c202951a01e495302c11.png" alt="image"><br><br>  Such base stations can intercept the IMSI (the so-called IMSI-catcher) and then track the victim‚Äôs location via the SS7 network.  Once you have tracked the victim's IMSI, you can track its movement around the world until the user changes the SIM card.  More about these attacks, we have already told <a href="http://habrahabr.ru/company/pt/blog/226977/">here</a> . <br><br>  Snowden documents show that the Vienna Station (Annex Vienna) is only part of the global tracking network <a href="">SIGINT</a> .  It is already possible to search further on the list of countries and cities mentioned in these documents.  Here is a photo of a similar structure found on the roof in Rome: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0be/ccc/4e1/0beccc4e195330e8dc2f837890a2f624.jpg" alt="image"><br><br>  By the way, US intelligence agencies are not limited to stationary tracking systems.  They have long been using <a href="http://resources.infosecinstitute.com/stingray-technology-government-tracks-cellular-devices/">StingRay</a> interceptor stations on special vehicles that can drive up to a given target.  And in November, the Wall Street Journal <a href="http://securityaffairs.co/wordpress/30175/intelligence/cell-phone-data-spied-airplane.html">reported</a> that the US Department of Justice was using Cessna airplanes with fake base stations to intercept user data: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b76/e51/bd0/b76e51bd0af732e214742da84661bfce.png" alt="image"><br><br><h4>  Who is to blame and what to do? </h4><br>  First of all, it should be noted that despite the loud headlines of the newspapers, the described technologies are now available not only to special services.  In fact, wiretapping of mobile networks and protection from it have become a new high-tech market.  And as in any market, new, cheaper solutions are constantly appearing here. <br><br>  In August 2014, Popular Science magazine <a href="http://www.popsci.com/article/technology/mysterious-phony-cell-towers-could-be-intercepting-your-calls">spoke</a> about how the ESD America security team is promoting its own development, the ‚Äúspecially protected‚Äù CryptoPhone 500 Android-based smartphone.  Since there are already several similar products on the market, the developers used an unofficial advertising move.  With the help of their advanced smartphone, they found 17 fake base stations in the United States that forcefully disable data encryption: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f31/7cc/ffe/f317ccffea3786c539a3432e2003c358.png" alt="image"><br><br>  One such wiretapping station was found near a large casino in Las Vegas, a few more - near US military bases.  Who, except the NSA, can use this technique?  Yes, anyone.  True, commercial complexes are <a href="http://www.meganet.com/meganet-products-cellphoneinterceptors.html">expensive</a> - more than $ 100 thousand. However, you can significantly reduce the price of a solution if you use <a href="http://openbsc.osmocom.org/trac/">free software</a> to create your own base station. <br><br>  How to escape from this?  One of the options already mentioned above - "protected" smartphone.  However, the pleasure is not cheap: CryptoPhone costs $ 3,500.  For this money, the client receives a "closure" of a number of attack vectors that appeared higher on our list.  In particular, there is control of known vulnerabilities of Android OS, control of suspicious activity of mobile applications, and even baseband processor monitoring: it is this feature that allows you to determine the connection of a fake base interceptor station, which is not noticed by ordinary smartphones. <br><br>  It is more difficult to protect yourself from fake base stations with a regular phone, but you can still do something.  UMTS (G3) networks use mutual authentication of a mobile station in a cellular network, and a cellular network in a mobile station.  Therefore, one of the signs of wiretapping is forced switching from the G4 and G3 modes to the less safe G2 mode.  If the user disables 2G mode in advance, this will make it more difficult for an attacker to intercept a radio broadcast.  Some mobile phone models allow you to switch the type of network used: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a6/926/f72/7a6926f72790be4620076d8ef62429c1.png" alt="image"><br><br>  Also, many Android-based phones have a service menu, called by the * # * # 4636 # # # command, where you can select the type of network.  However, such a decision is fraught with increased battery consumption, as well as loss of communication in the absence of 3G network coverage. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a6a/f43/4a8/a6af434a85f3adccbdb493b826c309c4.png" alt="image"><br><br>  Fake base stations allow you to intercept any data transmitted over the cellular network - but this requires the physical presence of the subscriber in the coverage area of ‚Äã‚Äãthe base station.  Therefore, a more advanced method of surveillance can be considered <b>attacks on the SS7 network</b> , allowing you to intercept subscriber data, as well as its location, from anywhere in the world.  It also has its own commercial solutions: in one of the past posts we talked about the <a href="http://habrahabr.ru/company/pt/blog/237981/">SkyLock</a> system of the American company Verint, which allows you to track any subscribers around the world. <br><br>  How can you prevent wiretapping in this case?  Since the attacks are based on legitimate messages from the SS7 signaling network, coarse filtering of these messages can have a negative impact on the entire service.  According to the experience of experts of Positive Technologies, adequate protection against attacks on SS7 should be a set of measures on the operator‚Äôs side, including monitoring of SS7 traffic and ‚Äúsmart‚Äù filtering control, which allows blocking only attempts of attacks and fraud.  More information about how this is implemented on the basis of our products can be found in the article ‚Äú <a href="http://www.ptsecurity.ru/download/PT_SS7_security_2014_rus.pdf">Security of mobile communication networks based on SS7</a> ‚Äù. </div><p>Source: <a href="https://habr.com/ru/post/245113/">https://habr.com/ru/post/245113/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245099/index.html">93% of users are happy with the design: how we designed Septim</a></li>
<li><a href="../245101/index.html">A bit about the technology Forward Error Correction</a></li>
<li><a href="../245103/index.html">Equip a hamster or ‚ÄúOpenWrt does firmware from TP-LINK?‚Äù. Part 1 - preparatory</a></li>
<li><a href="../245107/index.html">Bash free space monitoring service</a></li>
<li><a href="../245109/index.html">Announcement of new features Typescript 1.4</a></li>
<li><a href="../245117/index.html">Bylina about how I connected Drupal and Yandex.</a></li>
<li><a href="../245119/index.html">Do not worry, we will look after them. Integration of Zabbix into the client‚Äôs personal account</a></li>
<li><a href="../245121/index.html">The way of the developer: stories about my fabulous failures, part 2</a></li>
<li><a href="../245123/index.html">Oracle, SQL * Net or ORDER BY saves network resources ...</a></li>
<li><a href="../245125/index.html">The Germans have created a library of drunken audio recordings.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>