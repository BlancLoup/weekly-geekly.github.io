<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ScadaPy Creator for python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Speed ‚Äã‚Äãup the process of creating modbus.py 


 Once again I want to share my experience and the results of experiments in the field of industrial au...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ScadaPy Creator for python</h1><div class="post__text post__text-html js-mediator-article"><h2>  Speed ‚Äã‚Äãup the process of creating modbus.py </h2><br><p>  Once again I want to share my experience and the results of experiments in the field of industrial automation. </p><br>  At the moment, we have slightly changed the concept of building a device polling system using the python language. <br><br>  Most of the SCADA modules of the systems are built on the principle of a bundle <i>‚Äúexecutable file - configuration file‚Äù</i> . <br><a name="habracut"></a><br>  <i>An executable file</i> is usually a compiled binary file that is directly involved in polling slave devices using a specific protocol, it can also be called a ‚Äúprotocol driver‚Äù. <br><br>  The polling parameters (port, addresses, speed, etc.) for the driver are recorded in a configuration file, which can be of different types.  It can be a table or tables in any DBMS, for example, SQLite or Firebird is often used, an xml file can also be used. <br>  Working with various devices, we came to the conclusion that it would be very convenient to have already compiled the driver file with all the settings (variables) inside, it would be nice to be able to correct the driver already on the server when organizing device polling. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For this purpose, we considered the option of creating an application that, based on the xml configuration file, will create a driver in python. <br><br>  The main condition - the program that generates the driver code, must necessarily work on both Windows and Linux. <br><br>  Initially, we decided to make an application on PyQt, but frankly, it turned out to be quite difficult for us to write a program in such a bundle without having a full-fledged visual IDE for building the user interface. <br><br>  Previously, you had to often do programs on C Builder and Delfi, so you turned your eyes towards Lazarus.  We tried to compile programs on different operating systems - we were satisfied with the result. <br><br>  We decided to try to write an application on Lazarus IDE 1.8.2., Called it ScadaPy Creator. <br>  All configuration settings are saved in one single xml file. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea3/444/da9/ea3444da9dbe83d7d914419cb2ca6ecb.png" alt="image"><br><br>  After compiling the output, we have a modbus driver, a Mercury 230 counter driver, an http Json server, and an html file as a client. <cut></cut><br><br><h3>  How it works </h3><br>  Run the modbus driver or Mercury-230 to poll devices. <br><br>  Having received the answers according to the described variables, the driver sends data via the UDP protocol to port 64000. We launch the Json HTTP server, which in turn receives data from the driver and forms a packet in json format for http requests. <br><br>  We launch the client's html file in the browser and see the already processed data in three formats - json, text and SVG images. <br><br>  Then you can edit and html and SVG to fit your needs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b4/584/302/2b45843022f2d8d1503a0da9fef7e7e2.png" alt="image"><br><br>  Frankly speaking, it is enough for me to present the data in the form of a simple table, but for some people the information is better perceived as a mnemonic scheme. <br><br>  A similar variant of using python scripts was repeatedly tested on remote substations, where object servers based on Linux OS were installed and access was available only via SSH. <br><br>  Of course, to create a full-fledged SCADA system, with a lot of input signals and measurements, this option is not suitable, you definitely need to apply <br>  stable software from trusted manufacturers. <br><br>  Here is a typical version of the latter. <br><br>  <b>Task:</b> <br><br>  There is a device operating under the modbus protocol - a Lumel P18 temperature and humidity sensor. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb9/73a/f35/fb973af3573aa6d12120f90dfcd2329c.jpg" alt="image"><br><br>  You need to get the temperature and humidity every five minutes and display on the monitor screen in any form. <br><br>  The device is far away, at a distance of about 90 km from the office. <br><br>  To begin with we create the project. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/811/b38/22c/811b3822c644cbee6b427ea69e5cce59.png" alt="image"><br><br>  At R18, the temperature is taken at two addresses 7002 and 7003, 32 bits, the number with a floating point, and the humidity is taken at two addresses 7004 and 7005, 32 bits, the number with a floating point. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/440/c5b/01f/440c5b01f3d314cdef19309e4f9c7661.png" alt="image"><br><br>  In addition to temperature and humidity, it is possible to display more detailed information on the object: relative and absolute humidity, dew point, etc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d47/a9e/378/d47a9e3784cf2dba129d7805220cd78c.png" alt="image"><br><br>  After generation, two files modbus.py and jserver.py will be created. <br><br>  We send these files to the server of the object, and on the client‚Äôs computer we run jclient.html. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/66a/c10/4c2/66ac104c2128791abdb7d24fa618880c.png" alt="image"><br><br>  You can of course move the html file to the web server. <br><br>  <b>That's basically it.</b> <br><br>  The project with examples can be downloaded <a href="https://github.com/scadapy/creator">here.</a> <br><br>  <b>PS</b> <br><br>  <i>Any criticism, comments and advice are welcome, but constructive and to the point.</i> </div><p>Source: <a href="https://habr.com/ru/post/354704/">https://habr.com/ru/post/354704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354694/index.html">Again about the trees</a></li>
<li><a href="../354696/index.html">Riddles resume. Part 1. Choosing a form</a></li>
<li><a href="../354698/index.html">A brief history of information security in China: how to build the Great Chinese firewall</a></li>
<li><a href="../354700/index.html">Is there life without architecture?</a></li>
<li><a href="../354702/index.html">The solution to the problem of detecting the center line of the vessel</a></li>
<li><a href="../354706/index.html">Twirp vs. gRPC. Is it worth it?</a></li>
<li><a href="../354708/index.html">Transparent HTTPS proxy to bypass Roskomnadzor‚Äôs locks</a></li>
<li><a href="../354710/index.html">MikroTik & OpenWRT & DNSCrypt</a></li>
<li><a href="../354712/index.html">Hosting VPS: Windows or Linux?</a></li>
<li><a href="../354714/index.html">Bioyino - a distributed, scalable metric aggregator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>