<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neyrabayesovsky approach to machine learning problems. Lecture by Dmitry Vetrov in Yandex</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With this post we complete a series of lectures with Data Fest. One of the central events of the conference was a report by Dmitry Vetrov , a professo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neyrabayesovsky approach to machine learning problems. Lecture by Dmitry Vetrov in Yandex</h1><div class="post__text post__text-html js-mediator-article">  With this post we complete a series of lectures with Data Fest.  One of the central events of the conference was a report by <a href="https://events.yandex.ru/lib/people/7949799/">Dmitry Vetrov</a> , a professor at the Faculty of Computer Science of the National Research University Higher School of Economics.  Dmitry is one of the most famous machine learning specialists in Russia and, since last year, has been working as a leading researcher at Yandex.  In the report, he talks about the basics of the Bayesian approach and explains the advantages of this approach when using neural networks. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/kFe5zSkro0E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Under the cut - decoding and part of the slide. <br><a name="habracut"></a><hr><br>  Time a little, I will ride on tops.  Those interested can watch the slides - there is a stricter conclusion and many beautiful and different formulas.  Let's hope that will not be very boring. <br><br>  What I will talk about.  I will try to give a brief description of Bayesian methods, the Bayesian approach as a probability theory, as a machine learning problem.  This approach was quite popular in the 90s and zero years - before the deep revolution started, caused by the triumphal procession of deep neural networks.  For some time it seemed: why all these Bayes methods are needed, we have neural networks and so work fine.  But as often happens, at some point it turned out that the advantages of the neural network and Bayesian approaches can be combined.  First of all, due to the fact that the techniques of variational Bayes output appeared, and these models do not contradict each other, but on the contrary, they perfectly complement each other, reinforcing each other. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In a sense, I perceive it as a direction for the further development of modern machine learning and deep learning.  It is important to understand that neural networks are not a panacea.  They are just an important step in the right direction, but not the last step.  I will try to talk about the next possible step in machine learning theory.  And the next speaker, Sergey Bartunov, <a href="https://habrahabr.ru/company/yandex/blog/315138/">will try to engage in the</a> deconstruction of the myth and in some sense continue the idea that in-depth training is not a panacea.  But Sergey will approach this somewhat from the other side, will provide some more global view. <br><br><img src="https://habrastorage.org/files/995/4b4/1fa/9954b41fad0642b3ad7fd2afdd368f6a.jpg"><br><br>  So what is the Bayesian approach?  The whole approach is based on a single formula or theorem.  Bayes theorem is given in mathematical and conceptual forms. <br><br>  Key idea  Suppose there is some unknown quantity that we would like to evaluate for some of its indirect manifestations.  In this case, the unknown quantity is Œ∏, and its indirect manifestation is y.  Then you can use the Bayes theorem, which allows our initial ignorance or knowledge of an unknown quantity, a priori knowledge, to transform into a posteriori after observing some indirect characteristics, somehow indirectly characterizing the unknown quantity Œ∏. <br><br>  The key feature of the formula is that we input an a priori distribution that encodes our ignorance or our uncertainty about an unknown value, and that the output is also a distribution.  This is a very important point.  Not a point estimate, but a certain entity of the same format that was at the entrance.  Due to this, it becomes possible, for example, to use the Bayesian inference, a posteriori distribution, as a priori in some new probabilistic model and, thus, to characterize a new unknown value from different sides by analyzing its various indirect manifestations.  This is the first advantage due to which it is possible to obtain the extensibility property - or compositionability - of different probabilistic models, when we can build more complex ones from simple models. <br><br>  The second interesting property.  The simplest rule for summing the product of probabilities is: if we have a probabilistic model ‚Äî in other words, a joint probability distribution for all variables arising in our problem ‚Äî then, at least in theory, we can always construct any probabilistic forecast, predict the variable of interest U, knowing some observable variables O. In this case, there is a variable L, which we do not know and does not interest us.  According to this formula, they are perfectly excluded from consideration. <br><br>  For any combination of these three groups of variables, we can always construct such a conditional distribution, which will indicate how our ideas about the quantities U of interest to us have changed, if we have observed the O values ‚Äã‚Äãsupposedly related to U. <br><br><img src="https://habrastorage.org/files/199/4c3/010/1994c3010a394226a8c35c55b49d57b1.jpg"><br><br>  In fact, the widespread use of Bayes formulas gave birth to a second alternative approach to probability theory.  There is a classic approach - often called frequency, phreakventist in the West - and there is an alternative Bayesian approach.  Here is a brief table that I give in all my lectures and which shows the differences between the approaches.  Naturally, they do not contradict each other.  They rather complement each other.  On this label you can see what they have in common and what are the differences. <br><br>  The key difference is what is meant by a random variable.  In frequency terms, we understand by a random variable a quantity, the value of which we cannot predict without appreciating any statistical patterns.  Something with objective uncertainty is needed, while in the Bayesian approach the random variable is interpreted simply as a deterministic process.  It can be fully predicted.  Just in this deterministic process, we do not know part of the factors that influence the outcome.  Since we do not know them, we cannot predict the outcome of the deterministic process.  So, for us, this outcome looks like a random variable. <br><br>  The simplest example is a coin flip.  This is a classic random value, but we understand that the coin obeys the laws of classical mechanics and, in fact, knowing all the initial conditions ‚Äî force, acceleration, coefficient of resistance of the medium, etc. ‚Äî we could say for sure will fall: an eagle or tails. <br><br>  If you think about it, the overwhelming majority of the quantities that we used to think of as random are actually random in the Bayesian sense.  These are some deterministic processes, we just do not know part of the factors of these processes. <br><br>  Since one may not know some factors, and the other - others, the concept of subjective uncertainty or subjective ignorance arises. <br><br>  The rest is the direct difference between this interpretation.  All values ‚Äã‚Äãin the Bayesian approach can be interpreted as random.  The apparatus of probability theory is applied to the distribution parameters of a random variable.  In other words, the fact that in the classical approach is meaningless, in the Bayesian approach makes sense.  The method of the statistical method, instead of the maximum likelihood method - Bayes theorem.  Estimates are not point-like, but a kind of posterior distribution, allowing us to combine different probabilistic models.  And unlike the frequency approach - theoretically justified for large n, and some prove, for example, when n tends to infinity - the Bayesian approach is true for any sample size, even if n = 0. Just in this case, the a posteriori distribution will coincide with the prior . <br><br><img src="https://habrastorage.org/files/c13/993/711/c13993711772490b8961115d5480afb6.jpg"><br><br>  Simple illustration.  A famous parable about blind wise men and an elephant, showing how a model can be hooked. <br><br>  Let's imagine: given several blind sages and one elephant.  The task is to estimate the mass of this elephant.  Wise men know that they will now feel a certain animal.  What exactly - do not know, but they have to evaluate the mass. <br><br><img src="https://habrastorage.org/files/329/ce8/e0d/329ce8e0df9c4ae5951a9d784b1cabc4.jpg"><br><br>  They all start by coding their ideas about the possible mass of an animal in the form of an a priori distribution, since now the distribution density can determine a simple measure of our ignorance about something.  To encode this knowledge, we can simply use the apparatus of probability theory. <br><br>  As far as sages are concerned, they know the characteristic masses of animals on planet Earth.  Therefore, they get about this prior distribution. <br><br>  The first sage comes up, feels the tail and concludes that, apparently, there is something snake-like or the tail of a large animal in front of him.  Hence, in the process of his Bayesian inference, by combining the results of his representations, which can be expressed in the form of a probability partition p1, he obtains the posterior distribution p (Œ∏) under the condition x = 1. <br><br>  Then comes another sage who can not feel, but say, sniff.  There is a completely different model.  X2 is a value from a completely different domain, indirectly characterizing the mass of the animal.  In the process of his Bayesian inference, he uses, as an a priori distribution, not the initial distribution from which everyone started, but the result of the output of the previous sage.  Thus, we can combine two completely different dimensions, two sources of information, in one elegant probabilistic model. <br><br>  And so, having done a series of measurements, we end up with a fairly sharp a posteriori distribution, an almost accurate estimate.  We can already say with high accuracy what weight the animal had.  This is an illustration of the third property - to extendibility, that is, the ability of the model to expand and hook all the time. <br><br>  Another advantage of the Bayesian approach, already applied to machine learning, is regularization.  By taking into account a priori preferences, we prevent the excessive adjustment of our parameters during the machine learning procedure and are thus able to cope with the effect of retraining.  Some time ago, when the algorithms began to train on huge amounts of data, it was thought that the problem of retraining was removed from the agenda.  But it was all about the fact that people were psychologically afraid to switch to giant-sized neural networks.  Everyone started with small neural networks, and they, with giant training samples, did not really retrain.  But as psychological fear disappeared, people began to use larger networks. <br><br>  Two things have become obvious.  For a start, the larger the network, the better it is in principle.  Large networks work better than small ones.  But large networks are starting to retrain.  If we have a number of parameters - 100 million, then 1 billion objects are not a very large training sample, and we need to regularize the procedure of such machine learning. <br><br>  The Bayesian approach provides an excellent opportunity to do this by introducing an a priori distribution on those parameters, on those neural network weights that are configured during the training procedure. <br><br>  In particular, it turned out that such a popular heuristic regularization technique, such as drop out, is a special case, a rough approximation for Bayesian regularization.  In fact, this is an attempt to make a Bayesian conclusion. <br><br>  Finally, the third advantage is the ability to build a model with latent variables.  About her more. <br><br><img src="https://habrastorage.org/files/a0c/1e6/ad2/a0c1e6ad2e8340dfb6517dc6d1921635.jpg"><br><br>  We have a motivating example - the main component method.  The method is very simple - linear reduction of the dimension.  We take a sample in space with a high dimension, build a covariance matrix, project it onto the main axis with the corresponding largest value.  Here is what is geometrically shown here.  And reduced the dimension of the space from 2 to 1, while maintaining the maximum dispersion contained in the sample. <br><br>  The method is simple, allows the solution in an explicit form.  But you can alternatively formulate differently, in terms of a probabilistic model. <br><br><img src="https://habrastorage.org/files/1bf/28b/30a/1bf28b30aa404d399987c0898d31a6d6.jpg"><br><br>  Imagine that our data is arranged as follows: for each object there is its hidden representation in a space of small dimension.  Here, it is labeled z.  And we observe a linear function of this hidden representation in space with a higher dimension.  We took a linear function and additionally added normal noise.  Thus, we obtained x, high-dimensional data, according to which it is highly desirable for us to restore their low-dimensional representation. <br><br><img src="https://habrastorage.org/files/e64/34e/926/e6434e926cf244be9f263c8095ccad91.jpg"><br><br>  Mathematically, it looks like this.  We set a probabilistic model, which is the joint probability distribution for observable and hidden components, on x and z.  The model is quite simple, the sample is characterized by the product of objects.  The observable component of each object is determined by the hidden component; we are talking about a priori distribution on the hidden component.  Both are normal distributions.  We assume that in a small space the data is distributed a priori normally, and we observe a linear function of this data, which is noisy with normal noise. <br><br>  We are given a sample, which is a high-dimensional representation.  We know x, we do not know z, and our task is to find the parameter Œ∏.  Œ∏ is the V, œÉ¬≤ matrix and that's it. <br><br>  This problem can be formulated in Bayesian language as a learning task with latent variables.  To apply the usual maximum likelihood method, there is not enough knowledge of increasing z.  It turns out that for this technique there is a standard approach based on the EM algorithm and various modifications.  You can run an iterative process.  The EM-step contains formulas describing what we are doing.  It can theoretically be shown that the process is monotonous and is guaranteed to converge to a local extremum, but still. <br><br>  The question arises: why do we need to use the iterative process, when we know that the problem is solved explicitly? <br><br>  The answer is simple.  To begin with - algorithmic complexity.  The complexity of the analytical solution is O (nD¬≤), while the complexity of one iteration of the EM algorithm is O (nDd). <br><br>  If we mentally imagine that we are projecting a space of 1 million in space with a dimension of 10, and the EM algorithm converges iterations over one hundred, then our iterative scheme will work 1000 times faster than an explicit solution. <br><br>  In addition, an important advantage: now we can expand our basic model, the method of principal components, in various ways, depending on the specifics of a specific task.  For example, we can introduce the concept of a mixture of methods of principal components, and say that our data does not live in one space, a linear subspace of a lower dimension, but in several.  And we do not know from which subspace each particular object came. <br><br>  There is a mixture of main component methods.  Formally, the model is written as follows.  Just entered the additional nomenclature of hidden discrete variables t.  And again, the EM-algorithm allows us to find a solution to the problem using almost the same formulas, although the original method of the main components did not allow us to make any modifications. <br><br><img src="https://habrastorage.org/files/34d/51b/190/34d51b190dae45b8b5806ddfbfabde3b.jpg"><br><br>  Another one is the ability to work in situations where, say, for our sample, part of the components of x are unknown, the data is missing.  It happens?  Pretty often.  Somewhat more exotic situation - when we know the hidden views of parts of objects, low-dimensional view, in whole or in part.  But again, this situation is possible. <br>  The original model of the principal component method is incapable of taking into account either one or the other, while the probabilistic model formulated in Bayesian language takes both of them elementary - by a simple modification of the EM algorithm.  We simply change the nomenclature of observable hidden variables. <br><br>  Thus, we can solve data processing tasks, when some arbitrary fragments of this data may be absent, not like in standard machine learning, when a nomenclature of observable and seemingly hidden target variables is allocated, they can in no way intermix.  This is where additional flexibility arises. <br><br><img src="https://habrastorage.org/files/426/10e/dcc/42610edccb3843818cac82f33adb9be9.jpg"><br><br>  Finally, until recently, it was believed that a significant limitation of Bayesian methods is that, with their high computational complexity, they are applicable to small data samples and are not transferred to big data.  The results of the last few years show that this is not the case.  Humanity has finally learned to provide the scalability of Bayesian methods.  And people immediately began to cross Bayesian methods with deep neural networks. <br><br>  I will say a few words on how to scale the Bayesian method, there is still time to benefit. <br><br><img src="https://habrastorage.org/files/796/a43/5b4/796a435b4f1b44d2888cd5b4b5cddbd9.jpg"><br><br>  Bayes theorem.  According to well-known X, M, we want to say something about Z, which is somehow related to X. We apply the Bayes theorem.  Question: what is the most vulnerable place here, what is the hardest fragment?  Integral. <br><br>  In those rare cases when the integral is taken analytically, all is well.  It‚Äôs another thing if it is not analytically taken - and we imagine that we are talking about high-dimensional data, and here the integral in space with dimensions not 1 or 2, but tens and hundreds of thousands. <br><br>  On the other hand, let's write a chain.  We start: ‚à´ p (X | Z) p (Z) dZ.  Since log P (X) dZ does not depend, it is just an integral over all Z, equal to 1. <br><br>  The second action.  They expressed p (X), transferred to the left by this formula, p (Z | X) in the denominator, recorded under the integral. <br><br>  Now we have the numerator and denominator depend on Z, although their quotient gives p (X), that is, it does not depend on Z. Identity. <br><br>  Then multiplied what stands under log, multiplied by 1 and divided by q (Z). <br><br>  And the last - broke the integral into two parts.  Here we see: the second part is the Kullback-Leibler divergence, well-known in probability theory, a non-negative and zero value if and only if these two distributions coincide with each other.  In a sense, this is analogous to the distance between distributions.  And I remind you that our task is to estimate p (Z | X), at least approximately, to perform Bayesian inference. <br><br>  We cannot calculate this value; here p (Z | X) appears.  But we can perfectly calculate the first term.  Each of the terms depends on q (Z), but their sum does not depend on q (Z), because it is equal to log p (X).  An idea arises: let us be the first item to be maximized in q (Z), in distribution. <br><br>  This means that, by maximizing the first term, we minimize the second ‚Äî which shows the degree of approximation of q (Z) to the true a posteriori distribution.  ,  ,  :     ,        ,   . <br><br>           . <br><br><img src="https://habrastorage.org/files/323/6d5/cd3/3236d5cd3ee54b679eb7ceb64859d057.jpg"><br><br>     .   ‚Äî    . <br><br>      , ?       ?  . <br><br>      . <br><br><img src="https://habrastorage.org/files/29b/b5b/a6d/29bb5ba6d65149aa8b2f293c3cbc0f9d.jpg"><br><br>       ‚Äî    .  X <sub>tr</sub> , Z   ,        Œ∏.         ,  ,         L,      Œ∏ ‚Äî         Œ∏.    L   Q(Z)   Œ∏.   Œ∏       ,    Q(Z)          Z. <br><br>   ,           .    ,  , ,        .         ,  , -      . <br><br>  ,    .            ,    Z   Q(Z).   ,   .    ,        . <br><br><img src="https://habrastorage.org/files/caa/8c2/85c/caa8c285c601456da0d7f29418092032.jpg"><br><br>   ,     .      ,   ,     , ‚Äî            ,  ,     . <br><br>     .      ‚Äî             . :      .   ,        ,    ,        .   . <br><br>  ,      ,      ,  -  .    , Œº  œÉ ‚Äî         .      .   ,     Z <sub>i</sub>    Œº  œÉ,     X <sub>i</sub> .      Œ∏.      . ,       ,   . <br><br><img src="https://habrastorage.org/files/caa/8c2/85c/caa8c285c601456da0d7f29418092032.jpg"><br><br>   ,    :      ,      ,   .       ,     .      L,   Q(Z),    œÜ,       .    ,    ,  .  ,       , ‚Äî  ,   . <br><br>    .      œÜ. ,   Z,  X.   ‚Äî ,  X     Z. <br><br>      ,        .       ,     . <br><br><img src="https://habrastorage.org/files/b9c/268/e1b/b9c268e1bb544013beae962344d27477.jpg"><br><br>   ,        . ,       .   ,            ,    ,  .      representations. <br><br>        log ,  ,     .  ,     ‚Äî ,  , ,    ,      ‚Äî       .  ‚Äî      .     -      ,        ,       ,   ,        . .      ,       ,    ,  ,        .          . <br><br>    ,    .      ‚Äî    drop out.       ,      ,   .   , .  ,       .            .      drop out   ,    ,      , ,      . <br><br>  ,        , attention maps,       ,   .          .           ,    ‚Äî        L(Q|Œ∏). <br><br>  On this finish. ,    .    ,           . ,       NIPS   ,   ,    ‚Äî        . <br><br> ,           , ,           .          ‚Äî    .  Thank. </div><p>Source: <a href="https://habr.com/ru/post/321434/">https://habr.com/ru/post/321434/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321424/index.html">DRM-protected Windows files can be used to de-anonymize a Tor user</a></li>
<li><a href="../321426/index.html">Development for Sailfish OS: Creating your own QML component in C ++</a></li>
<li><a href="../321428/index.html">BIND vulnerability allows you to ‚Äúdrop‚Äù any server: how and why it works</a></li>
<li><a href="../321430/index.html">Mongoose Embedded Compact Web Server</a></li>
<li><a href="../321432/index.html">Virtuozz moving</a></li>
<li><a href="../321436/index.html">YouTrack release 2017.1 and Hub 2017.1</a></li>
<li><a href="../321438/index.html">Offer a project for testing with the PVS-Studio analyzer: now on GitHub</a></li>
<li><a href="../321440/index.html">How to enable JTAG debugging via USB</a></li>
<li><a href="../321442/index.html">Openstack. Detective story or where the connection is lost? Part one</a></li>
<li><a href="../321444/index.html">We read Google tables from the web application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>