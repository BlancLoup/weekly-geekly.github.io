<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to use the webcam in the Android emulator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many developers, especially beginners, use the Android emulator to create their applications. This allows you to do a lot without connecting the phone...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to use the webcam in the Android emulator</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/30f/da0/c6e/30fda0c6e0b91dcabff2d6ec99d432e8.jpg"><br>  Many developers, especially beginners, use the Android emulator to create their applications.  This allows you to do a lot without connecting the phone.  Almost all.  It is this ‚Äúalmost‚Äù that applies, for example, to a webcam.  For most applications, it may be sufficient to have this type, because you can transfer the ‚Äúdesired‚Äù image to the processor, and finally test it on a real device.  For applications that work with augmented reality, this will not work at all.  I would like to have a video stream.  If there is no phone with android at hand, this is a problem. <br>  In the last <a href="http://habrahabr.ru/blogs/augmented_reality/135659/">post</a> I wrote about how the methods of recognition of augmented reality marker work.  This article will be devoted to how to use the webcam in the Android emulator. <br><a name="habracut"></a><br><h4>  The essence of the problem </h4><br>  If we use an emulator and a camera in our application, then at the output we get approximately the following picture: <br><img src="https://habrastorage.org/storage2/240/08a/5a4/24008a5a436feaa2e9f3901ae8a5e586.jpg"><br>  I wish there were images from the computer webcam instead. <br><br><h4>  Approaches to the solution </h4><br>  1) <s>You can modify the Android emulator, which opensource.</s> <br>  2) Transfer the stream from the webcam over the network and use it in the application. <br>  3) Use Android x86. <br><br>  The emulator source for honeycomb is not available since <a href="http://www.businessweek.com/technology/content/mar2011/tc20110324_269784.htm">March</a> 2011, there are deprecated versions available, it is fun to work with them, but unproductive.  A pity, it would be the most acceptable option.  Moreover, the experience of finishing applications that work with video stream and v4l2 under Linux is. <br>  <a href="http://www.android-x86.org/">Androidx86</a> is a way out, it can help many, but ... I didn‚Äôt manage to lift a webcam. <br>  The first and third approaches are not available to us, then we will fight for the second approach. <br>  The idea has long been proposed and even <a href="http://www.tomgibara.com/android/camera-source">implemented</a> for older versions of the emulator and API.  For new versions of API, a <a href="http://www.inter-fuser.com/2009/09/live-camera-preview-in-android-emulator.html">solution is</a> proposed, but only for JMF  Great solution, but my JMF camera did not recognize.  Making the camera work with JMF did not work either in Linux or in Windows (maybe I did something wrong, in theory this solution should run in Windows).  I carried out all further actions exclusively in Linux.  We modify the solution of this problem on the basis of a ready-made code. <br>  The source code implements the classic client-server system.  The server on the computer broadcasts the images from the camera to the network, and the client in the emulator (in the application) receives these images. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What is set </h4><br>  <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Jdk</a> <br>  <a href="http://developer.android.com/sdk/index.html">Android SDK</a> <br>  <a href="http://developer.android.com/sdk/eclipse-adt.html">Eclipse + google ADT</a> <br>  <a href="http://code.google.com/p/v4l4j/">v4l4j</a> <br>  / dev / video0 - webcam. <br><br><h4>  Server </h4><br>  To create a server, I decided to move along the path of least resistance and use the v4l4j library - which perfectly supports my camera. <br>  It is necessary to modify the source code so that instead of JMF it uses v4l4j.  That's what happened. <br><br>  Modified WebBroadcaster (I am citing the code completely so that the logic of the work is clear. By Tom Gibara, I just adapted it to v4l4j): <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.webcambroadcaster; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.BufferedOutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.DataOutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.OutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.ServerSocket; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.Socket; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> au.edu.jcu.v4l4j.DeviceInfo; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> au.edu.jcu.v4l4j.FrameGrabber; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> au.edu.jcu.v4l4j.V4L4JConstants; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> au.edu.jcu.v4l4j.VideoDevice; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> au.edu.jcu.v4l4j.VideoFrame; <span class="hljs-comment"><span class="hljs-comment">/** * A disposable class that uses JMF to serve a still sequence captured from a * webcam over a socket connection. It doesn't use TCP, it just blindly * captures a still, JPEG compresses it, and pumps it out over any incoming * socket connection. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Tom Gibara * */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebcamBroadcaster</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> RAW = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[args.length]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; values.length; i++) { values[i] = Integer.parseInt(args[i]); } <span class="hljs-comment"><span class="hljs-comment">//Parse inputs WebcamBroadcaster wb; if (values.length == 0) { wb = new WebcamBroadcaster(); } else if (values.length == 1) { wb = new WebcamBroadcaster(values[0]); } else if (values.length == 2) { wb = new WebcamBroadcaster(values[0], values[1]); } else { wb = new WebcamBroadcaster(values[0], values[1], values[2]); } //Start the grabbing procedure wb.start(); } public static final int DEFAULT_PORT = 9889; public static final int DEFAULT_WIDTH = 320; public static final int DEFAULT_HEIGHT = 240; private final Object lock = new Object(); private final int width; private final int height; private final int port; private boolean running; private boolean stopping; private Worker worker; private VideoDevice vd=null; private FrameGrabber fg=null; public WebcamBroadcaster(int width, int height, int port) { this.width = width; this.height = height; this.port = port; } public WebcamBroadcaster(int width, int height) { this(width, height, DEFAULT_PORT); } public WebcamBroadcaster(int port) { this(DEFAULT_WIDTH, DEFAULT_HEIGHT, port); } public WebcamBroadcaster() { this(DEFAULT_WIDTH, DEFAULT_HEIGHT, DEFAULT_PORT); } public void start() { synchronized (lock) { if (running) return; //Starting capture startCapture(); worker = new Worker(); worker.start(); System.out.println("Start capture"); running = true; } } public void releaseCapture(){ fg.stopCapture(); vd.releaseFrameGrabber(); vd.release(); } public void startCapture(){ try{ String dev = "/dev/video0"; vd = new VideoDevice(dev); fg = vd.getJPEGFrameGrabber(width, height, 0, 0, 80); fg.startCapture(); }catch(Exception e){ e.printStackTrace(); } } public void stop() throws InterruptedException { synchronized (lock) { if (!running) return; // //Stop capture at this place releaseCapture(); // stopping = true; running = false; worker = null; } try { worker.join(); } finally { stopping = false; } } private class Worker extends Thread { private final int[] data = new int[width*height]; public byte[] b=null; @Override public void run() { ServerSocket ss; VideoFrame frm; try { ss = new ServerSocket(port); } catch (IOException e) { e.printStackTrace(); return; } while(true) { synchronized (lock) { if (stopping) break; } Socket socket = null; try { socket = ss.accept(); //Grab image here try{ // frm = fg.getVideoFrame(); System.out.println("Datagrabbed"); OutputStream out = socket.getOutputStream(); DataOutputStream dout = new DataOutputStream(new BufferedOutputStream(out)); dout.write(frm.getBytes(), 0, frm.getFrameLength()); dout.close(); System.out.println("Datasent"); frm.recycle(); // }catch(Exception e){ e.printStackTrace(); return; } socket.close(); socket = null; } catch (IOException e) { e.printStackTrace(); } finally { if (socket != null) try { socket.close(); } catch (IOException e) { /* ignore */ } } } try { ss.close(); } catch (IOException e) { /* ignore */ } } } }</span></span></code> </pre> <br><br>  What is the logic of work: <br>  When starting, turn on the camera and prepare to receive images: <br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startCapture</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ String dev = <span class="hljs-string"><span class="hljs-string">"/dev/video0"</span></span>; vd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VideoDevice(dev); fg = vd.getJPEGFrameGrabber(width, height, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>); fg.startCapture(); }<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception e){ e.printStackTrace(); } }</code> </pre><br>  Then, when the client connects - send him an image to the stream: <br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// frm = fg.getVideoFrame(); System.out.println("Datagrabbed"); OutputStream out = socket.getOutputStream(); DataOutputStream dout = new DataOutputStream(new BufferedOutputStream(out)); dout.write(frm.getBytes(), 0, frm.getFrameLength()); dout.close(); System.out.println("Datasent"); frm.recycle(); // }catch(Exception e){ e.printStackTrace(); return; }</span></span></code> </pre><br><br>  Of the improvements for the future, the code uses the outdated getVideoFrame (), which should be replaced with a callback function call when a new frame appears on the camera, but it would also have to make changes to the logic of the entire bundle, so leave everything as is, I will probably rewrite later when there is time.  After all, this is an auxiliary function at the development stage ... Ideally, it is necessary to make the program read the stream in the MJPEG format, that is, parse the multipart / x-mixed response from the HTTP server and draw pictures as it arrives. <br><br><h4>  Customer </h4><br>  <a href="https://code.google.com/p/ece301-examples/downloads/detail%3Fname%3DCameraPreview.zip%26can%3D2%26q%3D">Link</a> to a classic example of using a conventional camera.  We will shorten it a bit, simplify it (for training and testing) and get an example for an ordinary camera. <br><br>  Important lines: The class that will be responsible for the display. <br><br><pre> <code class="java hljs">preview = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Preview(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); ((FrameLayout) findViewById(R.id.preview)).addView(preview);</code> </pre><br><br>  And the class itself: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.FrameLayout; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CameraDemo</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TAG = <span class="hljs-string"><span class="hljs-string">"CameraDemo"</span></span>; Preview preview; Button buttonClick; <span class="hljs-comment"><span class="hljs-comment">/** Called when the activity is first created. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.main); preview = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Preview(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); ((FrameLayout) findViewById(R.id.preview)).addView(preview); Log.d(TAG, <span class="hljs-string"><span class="hljs-string">"It were created"</span></span>); } }</code> </pre><br>  And inside this class Preview, every time we redraw the surface onto which the preview is displayed. <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.Camera; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.SurfaceHolder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.SurfaceView; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Preview</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SurfaceView</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SurfaceHolder</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Callback</span></span></span><span class="hljs-class"> </span></span>{ SurfaceHolder mHolder; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Camera camera; Preview(Context context) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(context); <span class="hljs-comment"><span class="hljs-comment">// Install a SurfaceHolder.Callback so we get notified when the // underlying surface is created and destroyed. mHolder = getHolder(); mHolder.addCallback(this); mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS); } public void surfaceCreated(SurfaceHolder holder) { // The Surface has been created, acquire the camera and tell it where // to draw. camera = Camera.open(); try { camera.setPreviewDisplay(holder); } catch (IOException e) { e.printStackTrace(); } } public void surfaceDestroyed(SurfaceHolder holder) { // Surface will be destroyed when we return, so stop the preview. // Because the CameraDevice object is not a shared resource, it's very // important to release it when the activity is paused. camera.stopPreview(); camera = null; } public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) { // Now that the size is known, set up the camera parameters and begin // the preview. Camera.Parameters parameters = camera.getParameters(); parameters.setPreviewSize(w, h); camera.setParameters(parameters); camera.startPreview(); } }</span></span></code> </pre><br>  If this code is run in the emulator, then we get a box as in the screenshot above. <br>  Now, we modify the class so that it shows pictures from our server. <br>  1) Take the source code for the SocketCamera class <a href="http://www.inter-fuser.com/2009/09/live-camera-preview-in-android-emulator.html">from here</a> .  Add to our project. <br>  2) Change the source code of the class Preview so: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.Camera; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.SurfaceHolder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.SurfaceView; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Preview</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SurfaceView</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SurfaceHolder</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Callback</span></span></span><span class="hljs-class"> </span></span>{ SurfaceHolder mHolder; <span class="hljs-comment"><span class="hljs-comment">//public Camera camera; public SocketCamera camera; Preview(Context context) { super(context); // Install a SurfaceHolder.Callback so we get notified when the // underlying surface is created and destroyed. mHolder = getHolder(); mHolder.addCallback(this); //mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS); mHolder.setType(SurfaceHolder.SURFACE_TYPE_NORMAL); } public void surfaceCreated(SurfaceHolder holder) { // The Surface has been created, acquire the camera and tell it where // to draw. //camera = Camera.open(); camera = SocketCamera.open(); try { camera.setPreviewDisplay(holder); } catch (IOException e) { e.printStackTrace(); } } public void surfaceDestroyed(SurfaceHolder holder) { // Surface will be destroyed when we return, so stop the preview. // Because the CameraDevice object is not a shared resource, it's very // important to release it when the activity is paused. camera.stopPreview(); camera = null; } public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) { // Now that the size is known, set up the camera parameters and begin // the preview. Camera.Parameters parameters = camera.getParameters(); parameters.setPreviewSize(w, h); camera.setParameters(parameters); camera.startPreview(); } }</span></span></code> </pre><br><br><h4>  Result </h4><br>  Now start the server: <br>  <b>java -Djava.library.path = / opt / Android / v4l4j-0.8.10 -cp "/opt/Android/v4l4j-0.8.10/v4l4j.jar:./" com / webcambroadcaster / WebcamBroadcaster</b> <b><br></b> <br>  where <b>-Djava.library.path = / opt / Android / v4l4j-0.8.10 is the</b> path to your <b>v4l4j</b> library <br><br>  Run the CameraDemo application on the emulator.  As a result, we get a video stream from the webcam in the emulator.  The stream twitches a little, comes late, but it's better than nothing. <br><br><img src="http://habrastorage.org/storage2/ead/211/f8e/ead211f8e0d31391404c36915fd94441.jpg"><br><br>  Client Sources: <a href="http://webfile.ru/5766327">CameraDemo.zip</a> <br>  Server sources: <a href="http://webfile.ru/5766321">WebBroadcaster.zip</a> <br><br><h4>  Afterword </h4><br>  I thought about the existing threshold for entering the technology.  It seems to be a small threshold, but the purchase of a device is very often not available to a novice developer.  The emulator removes this threshold only partially. <br>  And what is the threshold for entering the development of applications for the iPhone? <br><br>  Faced with the fact that a member of the open source community closes it after some time, questions arise: <br>  Is it only profit? <br>  Maybe the community‚Äôs work didn‚Äôt meet Google‚Äôs expectations? <br>  Is there really something to hide from the community? <br>  And what does the giant lose when it closes itself from studying and adding code to third-party developers? <br><br>  <b>UPD: This is all possible and not relevant.</b>  <a href="https://habrahabr.ru/users/skl1f/" class="user_link">skl1f</a> suggests that the camera is supported in the SDK. <br>  <a href="http://developer.android.com/sdk/tools-notes.html">developer.android.com/sdk/tools-notes.html</a> - like the documentation says yes, and the official manual: <a href="http://developer.android.com/guide/developing/devices/emulator.html">developer.android.com/guide/developing/devices/emulator.html</a> - no.  Need to try. <br><br>  <b>UPD2: Checked.</b>  The camera in the emulator <b>works</b> and is available for <b>SDK tools rev.</b>  <b>14 and above</b> and only for <b>Android 4.0 and above</b> .  For older platforms, the above described method is still relevant. </div><p>Source: <a href="https://habr.com/ru/post/136075/">https://habr.com/ru/post/136075/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136070/index.html">Web applications displace native?</a></li>
<li><a href="../136071/index.html">Selectel tour: DC "Technodom"</a></li>
<li><a href="../136072/index.html">Great Chinese Golden Shield</a></li>
<li><a href="../136073/index.html">Internet at 900 km / h</a></li>
<li><a href="../136074/index.html">Sony Xperia SmartWatch - where are the arrows?</a></li>
<li><a href="../136076/index.html">Another wiki project about contemporary culture</a></li>
<li><a href="../136077/index.html">Keep it simplest. Or about simple sites</a></li>
<li><a href="../136080/index.html">CES 2012 // Lenovo IdeaPad Yoga</a></li>
<li><a href="../136082/index.html">Asus Zenbook UX31 Ultrabook Review</a></li>
<li><a href="../136084/index.html">Demotivation in full, or why am I waiting for the end of the world?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>