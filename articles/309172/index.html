<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zabbix 3.0.4: Windows Agent with TLS, LLD drives, a simple SMART example and command line only</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We assume that the server Zabbix 3.0.4 is installed. For the agent installation scripts, we will use, according to hardcore, only the native Windows c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zabbix 3.0.4: Windows Agent with TLS, LLD drives, a simple SMART example and command line only</h1><div class="post__text post__text-html js-mediator-article">  We assume that the server Zabbix 3.0.4 is installed.  For the agent installation scripts, we will use, according to hardcore, only the native Windows command line, without pythons, pearls, etc., i.e.  without additional installations to the agent system.  Encryption is configurable using PSK. <br><br><blockquote>  Let the external IP of the Zabbix server be - 30.0.1.1 <br>  Local Zabbix Server IP - 10.3.10.1 <br>  Test node address - 30.0.1.3 <br>  By forwarding ports here will not be said.  The node in the example will listen to 10050, the server - 10051. </blockquote><br>  Formulation of the problem: <br><br>  1) Simplify agent installation on Windows systems <br>  2) Configure encryption between the agent and the server. <br>  3) Configure disk detection (names, models, serial numbers, types) using the smartmontools utility, SMART monitoring <br>  4) Create a scalable deployment scenario template. <br>  5) Configure the alert. <br>  6) Use command line only. <br><a name="habracut"></a><br>  Windows agents for some reason do not yet have TLS support, but there are compiled versions that can be downloaded <a href="">from here</a> .  <a href="https://support.zabbix.com/browse/ZBXNEXT-3047">Discussion</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Unpack  We need only the bin directory.  We will not need the default config. <br><br>  Create a <b>zabbix</b> directory and copy the <b>bin</b> directory from the unpacked agent into it.  Next, create in the <b>zabbix</b> directory subdirectories <b>conf, disks, logs, psk, scripts, smartmontools</b> .  Immediately make a decision that we will place the <b>zabbix</b> folder in the root of the volume <b>C: \</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/333/638/41a/33363841a56d44feabae3ea21294504c.png"></div><br><blockquote>  <b>conf</b> - there will be a config file <br>  <b>disks</b> - disk information in JSON will be generated here <br>  <b>logs</b> <br>  <b>pks</b> - there will be a Z_agent.psk file containing the pre-shared key <br>  <b>scripts</b> <br>  <b>smartmontools</b> - put the SMART program of the same name here </blockquote><br>  Immediately prepare the PSK keys and data file.  Create a pskgen4ik file on the server: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash echo -n "  ? : " read LIMIT a=1 echo \# &gt; /home/appliance/agent_psk while [ "$a" -le $LIMIT ] do openssl rand -hex 64 &gt;&gt; /home/appliance/agent_psk let "a++" done less /home/appliance/agent_psk</span></span></code> </pre> <br>  Save, make executable (chmod + x), run, and copy the result to the data file, I will give an example of Excel for clarity.  You can use the database.  Something like this: <br><br><img src="https://habrastorage.org/files/77a/2f5/828/77a2f582883c4889967cdac743e08724.png"><br><br>  We will fill in the Host name field after creating the agent config (unless of course there is no already compiled list).  We invent and add unique identifiers PSK ID.  We save the data file, make a backup, strictly restrict access to it and delete the file "agent_psk".  All we have is a data file with keys and identifiers that we will use. <br><br><h1>  SMART </h1><br>  For information about disks and their SMART use the utility <a href="https://www.smartmontools.org/">Smartmontools</a> .  I take the latest version 6.5.  In this version, USB passports are normally defined, and new manifestos for 10k.  <a href="https://www.smartmontools.org/browser/tags/RELEASE_6_5/smartmontools/NEWS">All fixes in the release</a> . <br><br>  Download and throw in the folder <b>zabbix \ smartmontools</b> <br><br><h2>  Acquaintance with the utility. </h2><br>  See the list of connected drives: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">c:\&gt;"</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Program</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Files</span></span></span><span class="hljs-function">"\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartmontools</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bin</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartctl.exe</span></span></span><span class="hljs-function"> --</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scan</span></span></span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/f99/922/091/f99922091f70431db352f938d63b5171.png"></div><br>  The ‚Äìd switch indicates the type of disk. <br><br>  We are interested in the / dev / sda disk.  So far, he has little to say about except that he is an ATA-type and most likely bootable. <br><br>  We look information about it: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">c:\&gt;"</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Program</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Files</span></span></span><span class="hljs-function">"\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartmontools</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bin</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartctl.exe</span></span></span><span class="hljs-function"> -</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dev</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sda</span></span></span><span class="hljs-function"> -</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ata</span></span></span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/318/b74/1de/318b741dee974dcbb0046982dee37804.png"></div><br>  Already more interesting.  As you can see SMART is disabled.  Turn it on: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">c:\&gt;"</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Program</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Files</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartmontools</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bin</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartctl.exe</span></span></span><span class="hljs-function">" --</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smart</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on</span></span></span><span class="hljs-function"> --</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offlineauto</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on</span></span></span><span class="hljs-function"> --</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">saveauto</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dev</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sda</span></span></span></span></code> </pre> <br>  We look at the <a href="https://ru.wikipedia.org/wiki/S.M.A.R.T.">table of attributes SMART</a> . <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">c:\&gt;"</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Program</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Files</span></span></span><span class="hljs-function">"\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartmontools</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bin</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartctl.exe</span></span></span><span class="hljs-function"> -</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dev</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sda</span></span></span><span class="hljs-function"> -</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ata</span></span></span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/90f/a72/bb0/90fa72bb031a4ebc9e509bd4a5c2bf71.png"></div><br>  The smart RAID table will not look, but we can get the health status. <br><br>  Look SMART Health: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">c:\&gt;"</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Program</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Files</span></span></span><span class="hljs-function">"\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartmontools</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bin</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">smartctl.exe</span></span></span><span class="hljs-function"> -</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">H</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dev</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sda</span></span></span><span class="hljs-function"> -</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ata</span></span></span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/5be/590/4ea/5be5904ea53548eda587284d5f611110.png"></div><br>  Now, the same needs to be done for the remaining 1000 disks. To create templates for each one is out of the question; moreover, I, for example, still need to get the model and serial number of each disk in the report.  <a href="https://www.zabbix.com/documentation/3.0/ru/manual/discovery/low_level_discovery">Zabbix LLD</a> comes to the rescue. <br><br>  Since Zabbix has the ability to process data using the JSON protocol provided by its <a href="https://www.zabbix.com/documentation/3.0/ru/manual/api">API</a> , we will generate the necessary information from smartmontools to the JSON format and <a href="https://www.zabbix.com/documentation/3.0/ru/manual/appendix/items/activepassive">passively transfer</a> to the server. <br><br>  Start creating scripts.  To begin with, we will invent detection <a href="https://www.zabbix.com/documentation/3.0/ru/manual/config/macros">macros</a> and determine the data: <br><blockquote>  Macro {#DISKPORT} - the name of the disk in the system (/ dev / sda, / dev / sdb, etc.), <br>  Macro {#DISKTYPE} - disk type (ata, scsi, sat, csmi, etc.), <br>  Macro {#DISKMODEL} - disk model, <br>  Macro {#DISKSN} - serial number. </blockquote><br>  Create a <b>DiskInfoGenerationJSON.cmd</b> file in the <b>zabbix \ scripts</b> <b>directory with the</b> following contents: <br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> @<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off &gt; c:\zabbix\disks\disks.cmd <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> {<span class="hljs-string"><span class="hljs-string">"data"</span></span>: &gt;&gt; c:\zabbix\disks\disks.cmd <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [ &gt;&gt; c:\zabbix\disks\disks.cmd <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /F <span class="hljs-string"><span class="hljs-string">"tokens=1,3"</span></span> %%a <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'C:\"Program Files"\smartmontools\bin\smartctl.exe --scan'</span></span>) ^ <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> %%s <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">"Device Model"</span></span> <span class="hljs-string"><span class="hljs-string">"Product"</span></span>) ^ <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /F <span class="hljs-string"><span class="hljs-string">"tokens=2*"</span></span> %%c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'C:\"Program Files"\smartmontools\bin\smartctl.exe -i %%a -d %%b ^| find %%s '</span></span>) ^ <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">"Serial Number"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /F <span class="hljs-string"><span class="hljs-string">"tokens=3*"</span></span> %%k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'C:\"Program Files"\smartmontools\bin\smartctl.exe -i %%a -d %%b ^| find %%i '</span></span>) ^ <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> {<span class="hljs-string"><span class="hljs-string">"{#DISKPORT}"</span></span>:<span class="hljs-string"><span class="hljs-string">"%%a"</span></span>,<span class="hljs-string"><span class="hljs-string">"{#DISKTYPE}"</span></span>:<span class="hljs-string"><span class="hljs-string">"%%b"</span></span>,<span class="hljs-string"><span class="hljs-string">"{#DISKMODEL}"</span></span>:<span class="hljs-string"><span class="hljs-string">"%%d"</span></span>,<span class="hljs-string"><span class="hljs-string">"{#DISKSN}"</span></span>:<span class="hljs-string"><span class="hljs-string">"%%k"</span></span>},&gt;&gt; c:\zabbix\disks\disks.cmd)))) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> {<span class="hljs-string"><span class="hljs-string">"{#SMARTV}"</span></span>:<span class="hljs-string"><span class="hljs-string">"Smartctl 6.5"</span></span>}&gt;&gt; c:\zabbix\disks\disks.cmd <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ] &gt;&gt; c:\zabbix\disks\disks.cmd <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> } &gt;&gt; c:\zabbix\disks\disks.cmd</code> </pre><br>  Save <b>DiskInfoGenerationJSON.cmd</b> <br><br>  I didn‚Äôt manage to solve the problem of the last comma in a simplified way with the help of cmd (yes, I didn‚Äôt start to solve it, because it‚Äôs crazy stuff) <br><br><pre> <code class="dos hljs">{"{#DISKPORT}":"<span class="hljs-variable"><span class="hljs-variable">%%a</span></span>","{#DISKTYPE}":"<span class="hljs-variable"><span class="hljs-variable">%%b</span></span>","{#DISKMODEL}":"<span class="hljs-variable"><span class="hljs-variable">%%d</span></span>","{#DISKSN}":"<span class="hljs-variable"><span class="hljs-variable">%%k</span></span>"},</code> </pre> <br>  ... which violates JSON syntax.  So I just added the line <b>{"{#SMARTV}": "Smartctl 6.5"}</b> , which closes the body without a comma. <br><br>  When you run the <b>DiskInfoGenerationJSON.cmd</b> file.  As a result, we should get the file c: \ zabbix \ disks \ <b>disks.cmd</b> with the following contents: <br><br><img src="https://habrastorage.org/files/2f7/73b/a65/2f773ba656cb4390af53bb796cb6f2b3.png"><br><br>  Create in the <b>zabbix \ scripts</b> directory the file <b>GetSmartAllDisk.cmd with the</b> following <b>contents</b> : <br><br><pre> <code class="bash hljs">rem        : <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /F <span class="hljs-string"><span class="hljs-string">"tokens=1"</span></span> %%a <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'C:\"Program Files"\smartmontools\bin\smartctl.exe --scan'</span></span>) ^ <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-string"><span class="hljs-string">"C:\Program Files\smartmontools\bin\smartctl.exe"</span></span> --smart=on --offlineauto=on --saveauto=on %%a</code> </pre> <br>  Save <b>GetSmartAllDisk.cmd</b> <br><br><h1>  Config generation </h1><br>  The generation will be divided into two parts: connection settings and user parameters. <br><br><h3>  Creating a config </h3><br>  Analyzing the future agent configuration file: <br><br><pre> <code class="bash hljs">LogFile=C:\zabbix\logs\logs.log <span class="hljs-comment"><span class="hljs-comment">#   LogFileSize=100 #     Server=30.0.1.1 #    ServerActive=30.0.1.1 #    StartAgents=3 # - - Timeout=30 #   30    Hostname= #    # TLS TLSConnect=psk #    ( ) TLSAccept=psk #    ( ) TLSPSKFile=C:\zabbix\psk\Z_agent.psk #     pre-shared  TLSPSKIdentity= #  </span></span></code> </pre><br>  The <b>Hostname =</b> and <b>TLSPSKIdentity = fields</b> in the configuration file are unique for each host.  As well as a pre-shared key in the <b>zabbix \ psk \ Z_agent.psk file</b> .  Therefore, we define these values ‚Äã‚Äãin variables. <br><br>  In the <b>zabbix \ scripts</b> directory, create the <b>AgentConfigGeneration.cmd</b> file: <br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off chcp 866 &gt; nul <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /P CLIENT=<span class="hljs-string"><span class="hljs-string">"Enter Organization name: "</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /P PSKID=<span class="hljs-string"><span class="hljs-string">" Enter PSKIdentity: "</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /P PSKkey=<span class="hljs-string"><span class="hljs-string">"Enter PSKkey: "</span></span> rem   @<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-comment"><span class="hljs-comment"># zabbix_agent 3.0.1&gt; C:\zabbix\conf\zabbix_agentd.conf @echo. &gt;&gt;C:\zabbix\conf\zabbix_agentd.conf @echo %PSKkey%&gt;&gt;C:\zabbix\psk\Z_agent.psk @echo LogFile=C:\zabbix\logs\logs.log &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo LogFileSize=100 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo Server=30.0.1.1 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo ServerActive=30.0.1.1 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo StartAgents=3 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo Timeout=30 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo Hostname=%CLIENT%.%COMPUTERNAME%&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo. &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo ##### TLS ###########&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo TLSConnect=psk&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo TLSAccept=psk&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo TLSPSKFile=C:\zabbix\psk\Z_agent.psk&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo TLSPSKIdentity=%PSKID%&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo. &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf</span></span></code> </pre> <br>  It's simple.  When you start, enter the name of the organization, for example, <b>Organization1</b> and get the Hostname in the config in the form of " <b>Organization1</b> . Hostname".  Within the network of one organization, as a rule, the use of identical host names is usually excluded, so we will have unique names.  Next, enter the PSK ID from the previously compiled data file and the key.  But while we do not run. <br><br><h3>  Adding custom parameters to the config </h3><br>  In the <b>zabbix \ scripts</b> directory create a file <b>UserParameters.txt</b> , which will contain user parameters (UserParameter = &lt;key&gt;, &lt;shell command&gt;) <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#####  . UserParameter=HDD.discovery,for /F "tokens=*" %a in ('C:\zabbix\disks\disks.cmd') do @echo %a ##### SMART # RAW_VALUE UserParameter=HDD.raw[*], for /F "tokens=10" %a in ('C:\"Program Files"\smartmontools\bin\smartctl.exe -A $1 -d $2 ^| find "$3"') do @echo %a # VALUE UserParameter=HDD.value.[*], for /F "tokens=4" %a in ('C:\"Program Files"\smartmontools\bin\smartctl.exe -A $1 -d $2^| find "$3"') do @echo %a # WORST UserParameter=HDD.worst.[*], for /F "tokens=5" %a in ('C:\"Program Files"\smartmontools\bin\smartctl.exe -A $1 -d $2 ^| find "$3"') do @echo %a # THRESOLD UserParameter=HDD.thresh.[*], for /F "tokens=6" %a in ('C:\"Program Files"\smartmontools\bin\smartctl.exe -A $1 -d $2 ^| find "$3"') do @echo %a # WHEN_FAILED UserParameter=HDD.when.failed.[*], for /F "tokens=9" %a in ('C:\"Program Files"\smartmontools\bin\smartctl.exe -A $1 -d $2 ^| find "$3"') do @echo %a # HEALTH Status UserParameter=HDD.health.[*], for /F "tokens=6" %a in ('C:\"Program Files"\smartmontools\bin\smartctl.exe -H $1 -d $2 ^| find "test"') do @echo %a</span></span></code> </pre><br>  Save <b>UserParameters.txt</b> .  We came up with keys and loops to get data.  And at the end of the <b>AgentConfigGeneration.cmd</b> file <b>we</b> add the following line: <br><br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">type</span></span> C:\zabbix\scripts\UserParameters.txt&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf</code> </pre> <br>  We still need to open the port on the host if the firewall is enabled.  Create the file <b>OpenLocalPort.cmd</b> <br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> localportname=10050 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> rulename=zabbix <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dirrname=<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> protocolname=TCP <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> actionname=allow netsh advfirewall firewall add rule name=%rulename% dir=%dirrname% action=%actionname% protocol=%protocolname% localport=%localportname%</code> </pre> <br>  So, we wrote the scripts.  Here is what we get: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/88f/749/d08/88f749d08639494997c4d127bbfe1c73.png"></div><br>  Now you need to decide on the sequence of launches of this kind: <br><br>  1) Enter variables <br>  2) Installing smartmontools in silent mode <br>  3) Installing the Zabbix Agent service <br>  4) Config generation with user parameters - AgentConfigGeneration.cmd <br>  5) Disk list generation - DiskInfoGenerationJSON.cmd <br>  6) Enable SMART - GetSmartAllDisk.cmd.cmd <br>  7) Open Port - OpenLocalPort.cmd <br>  8) Start Zabbix Agent service <br><br>  Create the <b>INSTALL_AGENT.cmd</b> file in the zabbix root directory and combine all the steps of our scripts in it: <br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off chcp 866 &gt; nul <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /P CLIENT=<span class="hljs-string"><span class="hljs-string">"Client NAME: "</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /P PSKID=<span class="hljs-string"><span class="hljs-string">"PSKIdentity: "</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /P PSKkey=<span class="hljs-string"><span class="hljs-string">"Enter PSKkey: "</span></span> cls rem  smartmontools    C:\zabbix\smartmontools\smartmontools-6.5-1.win32-setup.exe /S rem   10050   <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> localportname=10050 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> rulename=zabbix <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dirrname=<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> protocolname=TCP <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> actionname=allow netsh advfirewall firewall add rule name=%rulename% dir=%dirrname% action=%actionname% protocol=%protocolname% localport=%localportname% <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"port %localportname% was open on host %hostname%"</span></span> rem   @<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-comment"><span class="hljs-comment"># zabbix_agent 3.0.1&gt; C:\zabbix\conf\zabbix_agentd.conf @echo. &gt;&gt;C:\zabbix\conf\zabbix_agentd.conf @echo %PSKkey%&gt;C:\zabbix\psk\Z_agent.psk @echo LogFile=C:\zabbix\logs\logs.log &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo LogFileSize=100 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo Server=30.0.1.1 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo ServerActive=30.0.1.1 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo StartAgents=3 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo Timeout=30 &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo Hostname=%CLIENT%.%COMPUTERNAME%&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo. &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo ##### TLS ###########&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo TLSConnect=psk&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo TLSAccept=psk&gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo TLSPSKFile=C:\zabbix\psk\Z_agent.psk &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf @echo TLSPSKIdentity=%PSKID%&gt; C:\zabbix\conf\zabbix_agentd.conf @echo. &gt;&gt; C:\zabbix\conf\zabbix_agentd.conf rem    type C:\zabbix\scripts\UserParameters.txt&gt;&gt; C:\zabb\conf\zabbix_agentd.conf rem    @echo off echo @echo off &gt; c:\zabbix\disks\disks.cmd echo echo {"data": &gt;&gt; c:\zabbix\disks\disks.cmd echo echo [ &gt;&gt; c:\zabbix\disks\disks.cmd for /F "tokens=1,3" %%a in ('C:\"Program Files"\smartmontools\bin\smartctl.exe --scan') ^ do (for %%s in ("Device Model" "Product") ^ do (for /F "tokens=2*" %%c in ('C:\"Program Files"\smartmontools\bin\smartctl.exe -i %%a -d %%b ^| find %%s ') ^ do (for %%i in ("Serial Number") do (for /F "tokens=3*" %%k in ('C:\"Program Files"\smartmontools\bin\smartctl.exe -i %%a -d %%b ^| find %%i ') ^ do echo echo {"{#DISKPORT}":"%%a","{#DISKTYPE}":"%%b","{#DISKMODEL}":"%%d","{#DISKSN}":"%%k"},&gt;&gt; c:\zabbix\disks\disks.cmd)))) echo echo {"{#SMARTV}":"Smartctl 6.5"}&gt;&gt; c:\zabbix\disks\disks.cmd echo echo ] &gt;&gt; c:\zabbix\disks\disks.cmd echo echo } &gt;&gt; c:\zabbix\disks\disks.cmd rem      for /F "tokens=1" %%a in ('C:\"Program Files"\smartmontools\bin\smartctl.exe --scan') ^ do "C:\Program Files\smartmontools\bin\smartctl.exe" --smart=on --offlineauto=on --saveauto=on %%a rem   Zabbix Agent if DEFINED ProgramFiles(x86) (goto :x64) else (goto :x86) :x64 C:\zabbix\bin\win64\zabbix_agentd.exe -i -c C:\zabbix\conf\zabbix_agentd.conf goto :NEXT :x86 C:\zabbix\bin\win32\zabbix_agentd.exe -i -c C:\zabbix\conf\zabbix_agentd.conf goto :NEXT :NEXT rem   Zabbix Agent net start "Zabbix Agent" echo. echo OK! @echo ------------------------------------ @echo Hostname: %CLIENT%.%COMPUTERNAME% @echo ------------------------------------ @echo. Pause</span></span></code> </pre> <br>  We pack the zabbix directory into an SFX archive and encrypt it with a password if necessary <br><br><h1>  Example. </h1><br>  We have a server in the organization "Organization 1".  We place zabbix.exe on the server and unpack it in the root of the volume C: \ <br><br>  Run INSTALL_AGENT.cmd on behalf of the Administrator.  Enter the name of the Organization without spaces, copy the PSK identifier and key from the data file: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/801/8a4/b0d/8018a4b0d95747ba92b4bb18c6aeaea9.png"></div><br>  Enter: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b5a/7ed/ccd/b5a7edccda044fe2b379708444bd78ca.png"></div><br>  Check the log file C: \ zabbix \ logs \ logs.log: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f35/9d2/0a8/f359d20a80c04842a40f815249af2356.png"></div><br>  Copy the Hostname ‚ÄúOrganization1.SUNSET‚Äù into the data file: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b37/281/90f/b3728190f90a42eeba1b873e062944b7.png"></div><br>  And so on with each host.  After filling the file, go to the Zabbix office - <a href="http://10.3.10.1/zabbix">10.3.10.1/zabbix</a> - and add groups and nodes from it.  In the node encryption settings, mark the PSK and wait online. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/289/e4a/e58/289e4ae58538410e99f98fec48a32338.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2a4/8be/1e3/2a48be1e3fd843c994773686eac365cd.png"></div><br>  We are waiting for a few seconds: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3ca/03c/567/3ca03c5675d14ef6a13063c394ccf2ba.png"></div><br>  <a href="https://www.zabbix.com/documentation/3.0/ru/manual/encryption">About encryption and restrictions</a> <br><br><h1>  Lld </h1><br>  Russify the office for a change) <br><br>  Create a SMART Template and a group of data elements.  For example, I created the following groups on smart attributes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/659/0cd/8f8/6590cd8f85d44c45ad346904daf7d569.png"></div><br>  Select the ‚ÄúDiscovery Rules‚Äù and create the rule: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/abb/aba/9c1/abbaba9c132c44f3aa92b1040e4f1306.png"></div><br>  In the ‚ÄúKey‚Äù field, we indicate the user parameter that we have invented from the file <b>C: \ zabbix \ scripts \ UserParameters.txt</b> <br><br><pre> <code class="bash hljs">UserParameter=HDD.discovery,<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /F <span class="hljs-string"><span class="hljs-string">"tokens=*"</span></span> %a <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'C:\zabbix\disks\disks.cmd'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> @<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> %a</code> </pre> <br>  And in the "Filters" tab, we write our macros from the created file <b>c: \ zabbix \ disks \ disks.cmd</b> and click "Add" <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6e8/620/97c/6e862097c09447d9a9d1aea5351242e3.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c26/6d5/3f3/c266d53f3e954d0f8805af9c475b2362.png"></div><br><h3>  Create "Prototypes of data elements" </h3><br>  For example, I will create two prototypes of the <b>Spin_Retry_Count</b> attribute and add Pre-fail to the data item group: Spin_Retry_Count.  The first one will get the <b>VALUE</b> value, the second <b>THRESHOLD</b> from the smart attribute table for each detected disk <br>  Let's <b>look</b> again at the file <b>C: \ zabbix \ scripts \ UserParameters.txt</b> (well, or already created configuration).  And let's see what cycles we pull out the data we need: <br><br><pre> <code class="bash hljs">UserParameter=HDD.value.[*], <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /F <span class="hljs-string"><span class="hljs-string">"tokens=4"</span></span> %a <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'C:\"Program Files"\smartmontools\bin\smartctl.exe -A $1 -d $2^| find "$3"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> @<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> %a UserParameter=HDD.thresh.[*], <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /F <span class="hljs-string"><span class="hljs-string">"tokens=6"</span></span> %a <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'C:\"Program Files"\smartmontools\bin\smartctl.exe -A $1 -d $2 ^| find "$3"'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> @<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> %a</code> </pre> <br>  As you can see from the script for the keys HDD.value. [*] And HDD.thresh. [*], We need to input three arguments $ 1 - disk (/ dev / *), $ 2 - disk type (ata, sat, etc. ), $ 3 - attribute (in our case Spin_Retry_Count).  As a result, the key will receive such a format HDD.value. [$ 1, $ 2, $ 3].  For example, for our disk / dev / sda of type ‚Äúata‚Äù, it will be HDD.value. [/ Dev / sda, ata, Spin_Retry_Count].  But since we created macros for each detected disk, the key format in the prototype of the data item will be <b>HDD.value. [{# DISKPORT}, {# DISKTYPE}, Spin_Retry_Count]</b> .  This key will go through each disk for this attribute. <br><br>  By the way, we can check the key from the server, using <b>zabbix_get</b> <br><br><pre> <code class="bash hljs">root@zabbix:~<span class="hljs-comment"><span class="hljs-comment"># zabbix_get -s 30.0.1.3 -k HDD.value.[/dev/sda,ata,Spin_Retry_Count] --tls-connect psk --tls-psk-identity "ZP10001AA" --tls-psk-file /root/Organization1.SUNSET.psk</span></span></code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/files/74f/0e2/85d/74f0e285de8f4423b1d9a4f254ac811e.png"></div><br>  And also for Threshold: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5b3/fde/c03/5b3fdec0388e4028b1c345232d588b52.png"></div><br>  So, we create our prototype data for VALUE and use passive checking: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b11/00a/369/b1100a3691cd481cab8de6f08f0db1bb.png"></div><br><br>  Similarly, we create a prototype for Threshold.  As a result, we have: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/929/074/8a6/9290748a6dd040f29c79e26d9883c7f7.png"></div><br><br>  Create a ‚ÄúTrigger Prototype‚Äù.  Give the name, for example, for clarity: <br><br>  <b>SMART: ATTENTION!</b>  <b>Drive {#DISKMODEL} ({#DISKPORT} - {#DISKTYPE}).</b>  <b>It is expected to fail and / or complete failure of the disk in the next 24 hours!</b>  <b>Attribute value worse than critical threshold</b> <br><br>  In the "Expression" field we write the condition: <br><br><pre> <code class="bash hljs">({SMART:HDD.value.[{<span class="hljs-comment"><span class="hljs-comment">#DISKPORT},{#DISKTYPE},Spin_Retry_Count].last()}-{SMART:HDD.thresh.[{#DISKPORT},{#DISKTYPE},Spin_Retry_Count].last()})&lt;0</span></span></code> </pre> <br>  The point is that if the Value is less than the Threshold - you need to issue a problem.  Last () - shows the last received value ( <a href="https://www.zabbix.com/documentation/3.0/ru/manual/appendix/triggers/functions">for more information</a> about functions).  In the field "Description" we write, for example: <br><br><pre> <code class="bash hljs">: {<span class="hljs-comment"><span class="hljs-comment">#DISKPORT}  : {#DISKTYPE} : {#DISKMODEL}  : {#DISKSN} : Threshold ‚Äî  :  Value  Threshold ‚Äî   ;     ‚Äî   .     ,  SMART,          ¬´Good¬ª  ¬´Bad¬ª.  VALUE   THRESH   Pre-fail  -   ,      24 . / Spin_Retry_Count /          ,     .    ,       .</span></span></code> </pre> <br>  The importance of putting "Emergency" <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c52/382/5e3/c523825e38bd4ac38da888928c245c25.png"></div><br>  We assume that the alert we have configured by EMAIL.  If not, then <a href="https://www.zabbix.com/documentation/3.0/ru/manual/quickstart/notification">here</a> . <br><br>  Go to "Settings"&gt; "Actions".  Create a report form.  Click "Create action" <br><br>  <b>Name</b> : Problem Reports <br>  <b>Default theme:</b> PROBLEM!  [{HOST.NAME}] - {TRIGGER.NAME} ({EVENT.ID}) <br>  <b>The default message is:</b> <br><br><pre> <code class="bash hljs"> ! : {TRIGGER.SEVERITY} : {HOST.NAME}  : {HOST.DESCRIPTION} : {EVENT.DATE} : {EVENT.TIME} {TRIGGER.NAME}  : {TRIGGER.DESCRIPTION}     . : 1. {ITEM.NAME1} = {ITEM.VALUE1}. : {ITEM.KEY1} 2. {ITEM.NAME2} = {ITEM.VALUE2}. : {ITEM.KEY2} {TRIGGER.EXPRESSION} Event ID: {EVENT.ID}</code> </pre><br>  Fill in the recovery message: <br>  <b>Recovery theme:</b> OK.  [{HOST.NAME}] <br>  <b>Recovery Message:</b> <br><br><pre> <code class="bash hljs">  <span class="hljs-string"><span class="hljs-string">"{EVENT.ID}"</span></span>  . : {HOST.NAME}  : {HOST.DESCRIPTION}    : {EVENT.DATE} {EVENT.TIME}    : {EVENT.RECOVERY.DATE} {EVENT.RECOVERY.TIME}   : {TRIGGER.NAME} : {TRIGGER.SEVERITY}  :  : 1. {ITEM.NAME1} = {ITEM.VALUE1}. : {ITEM.KEY1} 2. {ITEM.NAME2} = {ITEM.VALUE2}. : {ITEM.KEY2} URL: {TRIGGER.URL} Event ID: {EVENT.ID}</code> </pre><br>  Enable "Activate" <br><br>  Go to the tab "Conditions" and fill in as shown below: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/143/84b/502/14384b5029ae46b18edca7f8b1abba34.png"></div><br>  I have indicated only ‚ÄúExtreme‚Äù problems for example.  Conditions you can set what your heart desires. <br><br>  Go to the tab ‚ÄúOperations‚Äù and add either our group of users, or specify only ourselves.  Here, in principle, nothing to comment. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/339/486/8f4/3394868f41de4134a5701372941c29bb.png"></div><br>  Now I simulate a crash.  For example, I have all the attributes in order, so I will change the value in the trigger and put "more than zero" <br><br><pre> <code class="hljs lisp">({SMART<span class="hljs-symbol"><span class="hljs-symbol">:HDD</span></span>.value.[{#DISKPORT},{#DISKTYPE},Spin_Retry_Count].last()}-{SMART<span class="hljs-symbol"><span class="hljs-symbol">:HDD</span></span>.thresh.[{#DISKPORT},{#DISKTYPE},Spin_Retry_Count].last()})&gt;0</code> </pre> <br>  I think it is not necessary to explain arithmetic. <br><br>  We wait for some time and get the problem: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4dc/9fd/5e1/4dc9fd5e106a4b35a5ab91296964566d.png"></div><br>  And after a couple of seconds, a message arrives in the mail: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f44/8ce/068/f448ce0681924f9d8a9391a40d2b5eed.png"></div><br>  After recovery, we will receive the following message: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7fe/7ef/dba/7fe7efdba87d4604a161c10fd26131cb.png"></div><br>  If there are mistakes, or something can be done easier, please report!  I wrote a topic for a couple of hours with screenshots, it seems I checked it twice successfully. <br><br>  <a href="">Download ready template</a> <br><br>  PS: Especially fire when zabbix sends a message to the supplier asking to bill the new disk or, for example, when the toner in the printer runs out, throws a support ticket for the cartridge refilling, but that's another story ... </div><p>Source: <a href="https://habr.com/ru/post/309172/">https://habr.com/ru/post/309172/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309162/index.html">Implementing a finite state machine in VHDL</a></li>
<li><a href="../309164/index.html">The digest of interesting materials for the mobile developer # 169 (August 29 - September 4)</a></li>
<li><a href="../309166/index.html">Offline-first app with Hoodie & React. Part One: Browser Database</a></li>
<li><a href="../309168/index.html">Interview with Artyom Malyshev, who will speak at Moscow Python in October</a></li>
<li><a href="../309170/index.html">Cable Management: Some Tips From Your Own Experience</a></li>
<li><a href="../309174/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ226 (August 29 - September 4, 2016)</a></li>
<li><a href="../309176/index.html">PHPixie vs Laravel</a></li>
<li><a href="../309180/index.html">Digest of grocery design, August 2016</a></li>
<li><a href="../309182/index.html">Graphic models based on Gaussian copulas</a></li>
<li><a href="../309184/index.html">Automatic change of product types in Magento 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>