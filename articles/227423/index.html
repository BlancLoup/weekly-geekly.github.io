<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Database monitoring HostTracker</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we would like to write about the next feature of our service - monitoring databases . 
 There are many different services and metrics that help ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Database monitoring HostTracker</h1><div class="post__text post__text-html js-mediator-article">  Today we would like to write about the next feature of our service - <a href="https://www.host-tracker.com/Glossary/DatabaseMonitoring">monitoring databases</a> . <br>  There are many different services and metrics that help collect information about the number of visits to the site, the amount of sales and other business-relevant indicators.  But if you need to somehow compare these figures with each other?  Or will it be necessary to check more ‚Äútechnical‚Äù values, for example, a base increase? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7aa/7cf/366/7aa7cf3667156c41e00b8f4837b4b829.png" alt="image"><br><br>  <i>HostTracker offers a function for solving such problems - monitoring the database.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h4>  Request setup </h4><br>  This function allows you to execute a specific query to the database with each check and process its result in a specified way.  If the request is not specified, the ability to connect to the database will be tested.  The most interesting thing is the ability to execute a specific query with a specified interval, save and compare the result.  The request can be any - from simple samples to regular updates of tables, running procedures (instead of the scheduler), various comparisons and logical operations.  The only restriction is that it should be executed in 30 seconds, otherwise the error (timeout) will be returned.  How can this data be analyzed? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1cc/3e2/e50/1cc3e2e50d2038265a3803c5ff177f59.png" alt="image"><br><br>  It is recommended to write such queries that return the desired value in the first column of the first row of the result.  This value can be analyzed.  For queries like UPDATE, INSERT, DELETE, the number of processed rows is fixed. <br><br>  For example, a graph of the result of a DELETE on certain parameters: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fa4/202/f42/fa4202f4297f3a850c7903e80a25474d.png" alt="image"><br><br>  Each result of the query is recorded, the latter is shown in the table of tasks on the interface.  If the value is numeric, a graph is plotted using it and you can track its behavior.  It is possible to choose the conditions for comparing this result - it can be equal to / not equal to a certain value, exceed it, be in a given range or outside it. <br>  If the condition is not fulfilled, or the request failed due to a timeout, or there is no connection with the database, you will receive an alert (we remind you that HostTracker supports SMS, E-mail, Skype, Gtalk, voice call). <br><br><h4>  Usage example </h4><br>  Script to track the size of the database files and receive notifications when a certain critical value is reached. <br>  1. We write a query to pull out the data we need about the free space in the tablespace: <br> <code>SELECT <br> convert(DECIMAL(12,2),round(sysfile.size/128.000,2)) AS 'FileSize/mb' <br> , convert(DECIMAL(12,2),round(fileproperty(sysfile.name,'SpaceUsed')/128.000,2)) <br> AS 'Used/mb' <br> , convert(DECIMAL(12,2),round((sysfile.size-fileproperty(sysfile.name,'SpaceUsed'))/128.000,2)) <br> AS 'Free/mb' <br> , filegroup.groupname AS 'File-group' <br> , sysfile.[name],sysfile.[filename] <br> FROM dbo.sysfiles sysfile (NOLOCK) <br> inner join dbo.sysfilegroups filegroup (NOLOCK) ON filegroup.groupid = <br> sysfile.groupid <br> UNION ALL <br> SELECT <br> convert(DECIMAL(12,2),round(sysfile.size/128.000,2)) AS 'FileSize/mb' <br> , convert(DECIMAL(12,2),round(fileproperty(sysfile.name,'SpaceUsed')/128.000,2)) <br> AS 'Used/mb' <br> , convert(DECIMAL(12,2),round((sysfile.size-fileproperty(sysfile.name,'SpaceUsed'))/128.000,2)) <br> AS 'Free/mb' <br> , (CASE WHEN sysfile.groupid = 0 THEN 'Log' END) AS 'File-group' <br> , sysfile.[name],sysfile.[filename] <br> FROM dbo.sysfiles sysfile (NOLOCK) WHERE groupid = 0 <br> ORDER BY [File-group],sysfile.[name]</code> <br>  2. We get this picture: <br><img src="https://habrastorage.org/getpro/habr/post_images/0ee/65a/337/0ee65a33719c01d28d93e623c6c2767b.png" alt="image"><br>  3. Select the desired parameters: <br><br>  The result of the query is ‚Äúthe value in the first column of the first row‚Äù <br><br>  The check of the result is ‚Äúless than‚Äù and enter ‚Äú1000‚Äù values ‚Äã‚Äãin the field. <br><br>  <b>The result</b> - if the log file exceeds 1 GB, we will receive an alert.  In addition, you can view the history - how quickly and when exactly the increase is observed. <br><br><h4>  Monitoring setup </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/2d8/0dd/cd6/2d80ddcd6adccd4bc65e3c7ebbbf4a27.png" alt="image"><br><br>  When setting up, <b>it is necessary to set the server address, port, database name, username and password of the user</b> under which the request will be executed.  <b>It is strongly recommended to create a separate user with limited rights</b> , just in case.  And at the same time, do not forget to give him the rights to the actions that he is supposed to perform.  It is also <b>necessary to add the addresses</b> of the HostTrecker servers, from where the checks will be carried out, <b>to the white list of the firewall and the database server</b> in order to provide access to the database.  Addresses are listed immediately, they are permanent. <br><br></div><p>Source: <a href="https://habr.com/ru/post/227423/">https://habr.com/ru/post/227423/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../227409/index.html">Introduction to Renesas microcontrollers using the RL78 line as an example</a></li>
<li><a href="../227411/index.html">Synology Announces Free Five-Year Warranty for XS / XS + Series NAS Servers</a></li>
<li><a href="../227415/index.html">Own WebGL engine. Article number 3. Primitives</a></li>
<li><a href="../227419/index.html">Formed a preliminary program WebCamp: Project Management Day</a></li>
<li><a href="../227421/index.html">Sell ‚Äã‚Äãa lot: the principles of the device sales department</a></li>
<li><a href="../227425/index.html">We program the quadcopter on Arduino (a part 1)</a></li>
<li><a href="../227429/index.html">Why should a cat tail: realtime statistics in conditions of medium visibility</a></li>
<li><a href="../227431/index.html">Webinar "Integrated IT infrastructure from Fujitsu"</a></li>
<li><a href="../227433/index.html">Vacuum transistor will be able to overcome the line of 1 THz</a></li>
<li><a href="../227435/index.html">Never ‚Äúdo‚Äù what you regret or smart home with CCU.IO</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>