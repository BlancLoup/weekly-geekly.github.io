<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Inversion of Control: Implementation Methods with PHP Examples</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Oh god, another post about Inversion of Control 

 Each more or less experienced programmer has encountered the phrase Inversion of Control in his pra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Inversion of Control: Implementation Methods with PHP Examples</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  Oh god, another post about Inversion of Control </blockquote><br><br>  Each more or less experienced programmer has encountered the phrase Inversion of Control in his practice.  But often not everyone fully understands what it means, not to mention how to properly implement it.  I hope the post will be useful to those who are starting to get acquainted with the inversion of control and somewhat confused. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, according to Wikipedia, Inversion of Control is an object-oriented programming principle used to reduce connectivity in computer programs, based on the following 2 principles <br><ul><li>  Top level modules should not be dependent on lower level modules.  Both those, and others should depend on abstraction. </li><li>  Abstractions should not depend on the details.  Details must depend on abstractions. </li></ul><br><br>  In other words, we can say that all dependencies of modules should be built on the abstractions of these modules, and not on their specific implementations. <br><br>  Consider an example. <br>  Suppose we have 2 classes - OrderModel and MySQLOrderRepository.  OrderModel calls MySQLOrderRepository to get data from the MySQL repository.  Obviously, a higher level module (OrderModel) depends on the relative low-level MySQLOrderRepository. <br><br>  An example of bad code is shown below. <br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OrderModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($orderID)</span></span></span><span class="hljs-function"> </span></span>{ $orderRepository = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySQLOrderRepository(); $order = $orderRepository-&gt;load($orderID); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;prepareOrder($order); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prepareOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($order)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//some order preparing } } class MySQLOrderRepository { public function load($orderID) { // makes query to DB to fetch order row from table } }</span></span></code> </pre> <br><br>  In general, this code will work fine, perform the duties assigned to it.  It was possible to stop at this.  But suddenly your customer has a brilliant idea to store orders not in MySQL, but in 1C.  And here you encounter a problem - you have to change the code that worked perfectly, and also make changes to every method that uses MySQLOrderRepository. <br>  In addition, you did not write tests for OrderModel ... <br><br>  Thus, the following problems of the code given earlier can be highlighted. <br><ul><li>  Such code is poorly tested.  We cannot test 2 modules separately when they are so closely connected </li><li>  Such code is poorly extended.  As the example above showed, to change the order repository, we had to change the model that processes the orders. </li></ul><br><br>  And what to do with all this? <br><br><h1>  1. Factory Method / Abstract Factory </h1><br>  One of the easiest ways to implement control inversion is a <b>factory method (an abstract factory can also be used)</b> <br>  Its essence lies in the fact that instead of directly instantiating a class object through new, we provide a certain interface for the client class to create objects.  Since such an interface can always be redefined with the right design, we get some flexibility when using low-level modules in high-level modules. <br><br>  Consider the above example with orders. <br>  Instead of directly instantiating an object of the MySQLOrderRepository class, we will call the factory build method for the OrderRepositoryFactory class, which will decide which instance and which class should be created. <br><br><div class="spoiler">  <b class="spoiler_title">Implementing inversion control with Factory Method</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OrderModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($orderID)</span></span></span><span class="hljs-function"> </span></span>{ $factory = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DBOrderRepositoryFactory(); $orderRepository = $factory-&gt;build(); $order = $orderRepository-&gt;load($orderID); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;prepareOrder($order); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prepareOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($order)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//some order preparing } } abstract class OrderRepositoryFactory { /** * @return IOrderRepository */ abstract public function build(); } class DBOrderRepositoryFactory extends OrderRepositoryFactory { public function build() { return new MySQLOrderRepository(); } } class RemoteOrderRepositoryFactory extends OrderRepositoryFactory { public function build() { return new OneCOrderRepository(); } } interface IOrderRepository { public function load($orderID); } class MySQLOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to DB to fetch order row from table } } class OneCOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to 1C to fetch order } }</span></span></code> </pre><br></div></div><br><br>  <b>What does such an implementation give us?</b> <br><ol><li>  We are given the flexibility to create repository objects ‚Äî the class to be instantiated can be replaced by whatever we want.  For example, the MySQLOrderRepository for DBOrderRepositoryfactory can be replaced with OracleOrderRepository.  And it will be done in one place. </li><li>  The code becomes more obvious as objects are created in specialized classes. </li><li>  It is also possible to add some code to execute when creating-objects.  The code will be added only in 1 place </li></ol><br><br>  <b>What problems does this implementation solve?</b> <br><ol><li>  The code has ceased to depend on low-level modules, but nonetheless depends on the factory class, which still makes testing somewhat difficult </li></ol><br><br><h1>  2. Service Locator </h1><br>  The main idea of ‚Äã‚Äãthe Service Locator pattern is to have an object that knows how to get all the services that may be needed.  The main difference from factories is that Service Locator does not create objects, but knows how to get one or another object.  Those.  actually already contains instantiated objects. <br>  Objects in the Service Locator can be added directly, through the configuration file, and indeed in any way convenient to the programmer. <br><br><div class="spoiler">  <b class="spoiler_title">Implementing Inversion Control with Service Locator</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OrderModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($orderID)</span></span></span><span class="hljs-function"> </span></span>{ $orderRepository = ServiceLocator::getInstance()-&gt;get(<span class="hljs-string"><span class="hljs-string">'orderRepository'</span></span>); $order = $orderRepository-&gt;load($orderID); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;prepareOrder($order); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prepareOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($order)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//some order preparing } } class ServiceLocator { private $services = array(); private static $serviceLocatorInstance = null; private function __construct(){} public static function getInstance() { if(is_null(self::$serviceLocatorInstance)){ self::$serviceLocatorInstance = new ServiceLocator(); } return self::$serviceLocatorInstance; } public function loadService($name, $service) { $this-&gt;services[$name] = $service; } public function getService($name) { if(!isset($this-&gt;services[$name])){ throw new InvalidArgumentException(); } return $this-&gt;services[$name]; } } interface IOrderRepository { public function load($orderID); } class MySQLOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to DB to fetch order row from table } } class OneCOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to 1C to fetch order } } // somewhere at the entry point of application ServiceLocator::getInstance()-&gt;loadService('orderRepository', new MySQLOrderRepository());</span></span></code> </pre><br></div></div><br><br>  <b>What does such an implementation give us?</b> <br><ol><li>  We are given the flexibility to create repository objects.  We can bind to a named service any class that we wish. </li><li>  It is possible to configure services through the configuration file </li><li>  When testing, services can be replaced by Mock-classes, which allows you to easily test any class that uses the Service Locator </li></ol><br><br>  <b>What problems does this implementation solve?</b> <br>  In general, the debate about whether the Service Locator is a pattern or an anti-pattern is already very old and beaten.  In my opinion, the main problem of Service Locator <br><ol><li>  Since the locator object is a global object, it can be available in any part of the code, which can lead to its excessive code and, accordingly, nullify all attempts to reduce the connectivity of modules. </li></ol><br><br><h1>  3. Dependency Injection </h1><br>  In general, Dependency Injection is the provision of an external service to some class through its implementation. <br>  There are 3 such ways <br><ul><li>  Via class method (Setter injection) </li><li>  Through the designer (Constructor injection) </li><li>  Via interface injection </li></ul><br><br><h2>  Setter injection </h2><br>  With this method of implementation in the class where dependencies are introduced, a corresponding set-method is created, which sets this dependency. <br><br><div class="spoiler">  <b class="spoiler_title">Implementing inversion control with Setter injection</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OrderModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> IOrderRepository */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $repository; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($orderID)</span></span></span><span class="hljs-function"> </span></span>{ $order = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;repository-&gt;load($orderID); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;prepareOrder($order); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setRepository</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IOrderRepository $repository)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;repository = $repository; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prepareOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($order)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//some order preparing } } interface IOrderRepository { public function load($orderID); } class MySQLOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to DB to fetch order row from table } } class OneCOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to 1C to fetch order } } $orderModel = new OrderModel(); $orderModel-&gt;setRepository(new MySQLOrderRepository());</span></span></code> </pre><br></div></div><br><br><h2>  Constructor injection </h2><br>  With this method of implementation, a new argument is added to the constructor of the class where dependencies are introduced, which is the dependency to be set. <br><div class="spoiler">  <b class="spoiler_title">Implementing inversion control with Constructor injection</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OrderModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> IOrderRepository */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $repository; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IOrderRepository $repository)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;repository = $repository; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($orderID)</span></span></span><span class="hljs-function"> </span></span>{ $order = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;repository-&gt;load($orderID); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;prepareOrder($order); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prepareOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($order)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//some order preparing } } interface IOrderRepository { public function load($orderID); } class MySQLOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to DB to fetch order row from table } } class OneCOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to 1C to fetch order } } $orderModel = new OrderModel(new MySQLOrderRepository());</span></span></code> </pre><br></div></div><br><br><h2>  Interface injection </h2><br>  This method of implementing dependencies is very similar to Setter Injection, then the exception is that with this method of implementation, the class where dependencies are introduced is inherited from the interface, which requires the class to implement this set method. <br><br><div class="spoiler">  <b class="spoiler_title">Implementing inversion control using interface injection</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OrderModel</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IOrderRepositoryInject</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> IOrderRepository */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $repository; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($orderID)</span></span></span><span class="hljs-function"> </span></span>{ $order = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;repository-&gt;load($orderID); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;prepareOrder($order); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setRepository</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IOrderRepository $repository)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;repository = $repository; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prepareOrder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($order)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//some order preparing } } interface IOrderRepositoryInject { public function setRepository(IOrderRepository $repository); } interface IOrderRepository { public function load($orderID); } class MySQLOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to DB to fetch order row from table } } class OneCOrderRepository implements IOrderRepository { public function load($orderID) { // makes query to 1C to fetch order } } $orderModel = new OrderModel(); $orderModel-&gt;setRepository(new MySQLOrderRepository());</span></span></code> </pre><br></div></div><br><br>  <b>What does the implementation with Dependency Injection give us?</b> <br><ol><li>  Class code now depends only on interfaces, not abstractions.  The specific implementation is specified at runtime. </li><li>  Such classes are very easy to test. </li></ol><br><br>  <b>What problems does this implementation solve?</b> <br>  In truth, I do not see any major flaws in dependency injection.  This is a good way to make a class flexible and as independent as possible from other classes.  Perhaps this leads to unnecessary abstraction, but this is already a problem of the concrete implementation of the principle by the programmer, and not the principle itself. <br><br><h1>  4. IoC container </h1><br>  An IoC container is a container that is directly involved in managing dependencies and their implementations (in fact, it implements Dependency Injection) <br><br>  IoC containers are present in many modern PHP frameworks - Symfony 2, Yii 2, Laravel, even in the Joomla Framework :) <br>  Its main goal is to automate the introduction of registered dependencies.  Those.  you only need to specify the necessary interface in the class constructor, register the concrete implementation of this interface and voila - the dependency is implemented in your class <br><br>  The work of such containers is somewhat different in different frameworks, so I give you links to the official framework resources, which describes how their containers work. <br><br>  Symfony 2 - <a href="http://symfony.com/doc/current/components/dependency_injection/introduction.html">symfony.com/doc/current/components/dependency_injection/introduction.html</a> <br>  Laravel - <a href="http://laravel.com/docs/4.2/ioc">laravel.com/docs/4.2/ioc</a> <br>  Yii 2 - <a href="http://www.yiiframework.com/doc-2.0/guide-concept-di-container.html">www.yiiframework.com/doc-2.0/guide-concept-di-container.html</a> <br><br><h1>  Conclusion </h1><br>  The topic of control inversion has been raised millions of times, hundreds of posts and thousands of comments on this topic.  But nevertheless, I also meet people all, I see the code and I understand that this topic is not very popular in PHP, despite the presence of excellent frameworks and libraries that allow writing beautiful, clean, readable, flexible code. <br><br>  I hope the article was useful to someone and someone's code thanks to this will be better. <br>  Write your comments, suggestions, clarifications, questions - I will be glad </div><p>Source: <a href="https://habr.com/ru/post/244517/">https://habr.com/ru/post/244517/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244505/index.html">Vectorization of cycles: diagnosis and control</a></li>
<li><a href="../244507/index.html">Equalization of histograms for image enhancement</a></li>
<li><a href="../244509/index.html">The project 1C-Tools became the winner of the selection in U.M.NI.K.</a></li>
<li><a href="../244511/index.html">Samsung's DeepSort ranked first in the Sort Benchmark 2014 competition</a></li>
<li><a href="../244515/index.html">The company Global Web Index presented a statistical report on the Internet preferences of Europeans in 2014</a></li>
<li><a href="../244519/index.html">How to warm up for a "foreign" account</a></li>
<li><a href="../244521/index.html">Elegant Java Builder</a></li>
<li><a href="../244523/index.html">Subtleties nodejs. Part II: Work with errors</a></li>
<li><a href="../244525/index.html">Textbook on the programming language D. Part 5</a></li>
<li><a href="../244527/index.html">What will 100Gbps broadband satellite technology mean?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>