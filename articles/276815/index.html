<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What's New in Veeam Backup & Replication 9.0: Increase Efficiency in Creating and Storing Backup Files</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post, I will talk about new features that you can use by upgrading your version of Veeam Backup & Replication to 9.0. Among the variety of new...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What's New in Veeam Backup & Replication 9.0: Increase Efficiency in Creating and Storing Backup Files</h1><div class="post__text post__text-html js-mediator-article">  In this post, I will talk about new features that you can use by upgrading your version of Veeam Backup &amp; Replication to 9.0.  Among the variety of new products, I confess, I have a few favorites - and although they may seem obscure in appearance, they are of great benefit, for which I appreciate.  Of course, the whole mass in one post cannot be described, so I will immediately give a reference to the full review of the new products on the official website: <a href="https://www.veeam.com/veeam_backup_9_0_whats_new_en_wn.pdf">What's New in Veeam Backup &amp; Replication v9</a> . <br><br>  Here is what awaits you under the cut: <br><ul><li>  Remote Management Console </li><li>  New repository features </li><li>  New storage options </li><li>  Optimization of work with guest OS </li><li>  Setting up a full backup copy in the transfer task </li></ul><br><img src="https://habrastorage.org/files/570/43a/548/57043a54857a4d11ad085a0de8e66308.jpg"><br>  (In the picture - an exclusive set of cakes, which we treated ourselves to on the day of release. Thanks <a href="https://habrahabr.ru/users/therealgostev/" class="user_link">TheRealGostev</a> - managed to take a picture before everyone snapped up.) <br><a name="habracut"></a><br><h1>  Remote Management Console </h1><br>  In the past, the post has already been a review of this new component.  I remind you that the console allows you to connect to remote servers Veeam backup;  it can be set up as a separate setup, there is also an automatic installation (see the description in the <a href="http://helpcenter.veeam.com/backup/hyperv/silent_install_console.html">User Guide</a> ).  Thus, Veeam now supports a fully distributed architecture.  In previous versions, the Veeam.Backup.Service.exe and VeeamShell.exe components were exclusively coexistent, and in v9, with the efforts of our engineers, their interdependence was finally defeated - that is, as <a href="https://habrahabr.ru/users/therealgostev/" class="user_link">TheRealGostev</a> put it, ‚Äúsplit Siamese twins‚Äù. <br><img src="https://habrastorage.org/files/d80/b8a/95a/d80b8a95a2774131b829432a177268c5.png"><br><br><h1>  New repository features </h1><br>  New features have appeared in working with backup repositories. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First, now you can assign a connection server (mount server) to any repository.  This is a Windows server that performs a specific role in the backup infrastructure ‚Äî when restoring at the file level (FLR, file-level restore), such a server mounts VM files directly from the backup to its file system, as if ‚Äúconnecting‚Äù them to itself.  The connection server can be set up in the corresponding step ( <b>Mount Server</b> ) of the repository setup wizard. <br><img src="https://habrastorage.org/files/89d/4b3/4b8/89d4b34b8de44363a778255e1a41975f.png"><br><br>  There are various options for activating a mount operation: <br><ul><li>  So, to restore files or objects of an application, it is first mounted on the machine where the console is running ‚Äî so that the user can view the contents of the backup and select the files / objects needed for the restoration, because the browsing tools are launched from the console (whether offline or combined with the server), whether it is the Veeam Backup Browser or any of the Veeam Explorers tools. </li><li>  After the command to restore the selected files / objects (as a rule, to the machine in production) is given, the connection server will start working with the repository, and the traffic will go between it and the target machine.  This will speed recovery in distributed infrastructures. </li><li>  If the recovery is performed using the Enterprise Manager and is done for the machines that have guest OS files indexed during the backup, then only one connection will be involved (both for viewing and recovery), so in this case the traffic will always go between connection server and target VM. </li></ul><br>  For owners of Enterprise and Enterprise <i>Plus</i> licenses, it is possible to create a scalable repository.  This was described in some detail in an article on Habr√© ‚Äú <a href="https://habrahabr.ru/company/veeam/blog/275115/">about an‚Äú infinitely ‚Äùscalable backup repository</a> .‚Äù  This repository is easier to manage (since the routine task of selecting target storage from the pool is automated), in addition, fuel <s>consumption of</s> the storage space in the pool is optimized, and performance is improved, because the default is to enable per-VM backup chains. <br><img src="https://habrastorage.org/files/b76/8e4/85e/b768e485e726495abca26901341e4602.png"><br><br>  For regular repositories, the option of storing backups ‚Äúper machine‚Äù (per-VM backup files) is also offered.  With this option, a write stream will be generated for each VM (and not for each job).  As a result, the queue depth increases, which improves performance, since the maintenance of a single thread (queue depth = 1) is a performance limiting factor for most storage systems.  Creating several threads (queue depth ~ = N, that is, the number of tasks in the repository) helps a lot. <br><img src="https://habrastorage.org/files/400/ea9/f85/400ea9f8523b4cbc9f8b8dc2db3d3766.png"><br><br>  In addition, it became possible to create larger tasks without reservations about difficulties in controlling large backups.  With the release of v9, our system architects are preparing to revise the recommendations on the number of VMs included in one task - for example, bringing it to 250-300.  In any case, our own testing confirmed the possibility of processing tasks containing 5,000 virtual machines. <br><br>  Of course, when planning and setting up backup tasks, you need to remember that a number of operations ‚Äî for example, creating a synthetic backup, Backup Copy Jobs tasks (transferring backup to a backup site), etc. ‚Äî will wait for the backup of all VMs to work.  For this reason, it is not recommended to create giant tasks. <br><br>  <i>Important!</i>  After you have selected the <b>Use per VM-backup files backup</b> storage option, you need to activate it by performing an active full backup (Active Full) operation, either manually or waiting for the schedule to be triggered. <br><br>  A couple more points: remember that deduplication on the source side is not going anywhere.  And second, when creating new repositories on EMC DataDomain storage systems (with DDBoost), HP StoreOnce (with Catalyst) and ExaGrid (with Accelerated Data Mover), this option is enabled by default, but it is recommended to check this, just like any other these storage settings. <br><br><h1>  New storage options </h1><br>  After updating, new features of Veeam Backup &amp; Replication will be disabled by default.  To start using them, you should reconfigure existing backup jobs.  I note that the first two options from the list below were previously available only for backup transfer jobs (Backup Copy Jobs).  Now they can also be used to create other types of tasks.  Here are the new features: <br><br>  <b>Defragmentation and compression.</b>  Using this option will be useful if your backup task does not include the periodic full backup (active full backup), and at the same time the data retention policy implies that the full backup file will be periodically merged with the nearest incremental copy.  Such a transformation leads to the fact that the backup file becomes fragmented and ‚Äúvoids‚Äù are formed in it.  Voids are also formed when a part of the VM has been deleted from the backup task (after removing them from the backup, the file itself does not become smaller).  To reduce the file size, as well as slightly increase the speed of working with it, you can enable the <b>Defragment and compact full backup file</b> option.  It works as follows: at the specified time, Veeam Backup &amp; Replication will create an empty VBK file and copy there only the necessary blocks from the backup file obtained as a result of transformations.  There are restrictions for this option that are described in the <a href="http://helpcenter.veeam.com/backup/hyperv/backup_copy_compact_file.html">User Guide</a> . <br><br>  <b>Health check and self-healing.</b>  To ensure that your backups are not damaged, in addition to SureBackup, you can activate the <b>Perform backup files health check</b> option.  In this case, when creating each backup copy, Veeam Backup &amp; Replication will calculate the hash and checksum of the created file.  Then, before starting the next backup, Veeam Backup &amp; Replication re-calculates the hash and checksum of the file and compares it with the previously saved values.  If it is found that the file data has been damaged, Veeam Backup &amp; Replication will replace the damaged blocks by copying the required data from the original VM or from the previous backup. <br><img src="https://habrastorage.org/files/8b1/98d/1da/8b198d1da28e485695f57dd29ada06b8.png"><br><br>  <b>Eliminate blocks marked as deleted.</b>  Removing files in NTFS, you do not actually clear the data blocks that contain the file, but mark them as deleted.  Therefore, often when creating a backup image of a VM (image-based backup), the size of the backup file can be much larger than the size displayed in the file system.  Until recently, the only way to avoid copying ‚Äúdeleted‚Äù data was to use the <a href="https://technet.microsoft.com/en-us/sysinternals/sdelete.aspx">sdelete</a> utility <a href="https://technet.microsoft.com/en-us/sysinternals/sdelete.aspx">(SysInternals)</a> before starting a backup.  In Veeam Backup &amp; Replication v9, you can activate the <b>BitLooker</b> option <b>so</b> that before starting the backup, Veeam analyzes the MFT partition and does not copy the blocks marked as deleted. <br><img src="https://habrastorage.org/files/5eb/3fe/ddc/5eb3feddcb6d4ec185916131a0e0eae7.png"><br><br>  The article ‚Äú <a href="https://habrahabr.ru/company/veeam/blog/276433/">A new version of Veeam Backup FREE Edition has been released: a brief overview</a> ‚Äù describes in more detail how BitLooker works.  This technology is currently awaiting patent. <br><br>  <i>Important!</i>  In the commercial version of Veeam Backup &amp; Replication after the upgrade, this option is disabled by default - it is convenient to activate it using PowerShell commands: <br> <code>asnp VeeamPSSnapin; Foreach ($job in Get-VBRJob) { <br> $job.Options.ViSourceOptions.DirtyBlocksNullingEnabled = $true; <br> $job.SetOptions($job.Options) } <br></code> <br><br><h1>  New opportunities to work with guest OS </h1><br>  <b>Optimization of interaction with guest OS.</b>  In the backup infrastructure, built on the basis of Veeam Backup &amp; Replication v9, a new component - Guest Interaction Proxy.  It is intended for the interaction of the backup server with the guest OS (previously this interaction was carried out by the backup server itself, which greatly increased the load on it).  If you configure automatic machine selection for the Guest Interaction Proxy role, Veeam will select a less loaded machine that is located on the same site as the VM for which you plan to back up.  This approach simplifies backups in remote offices and branch offices (components interact faster when they are on the same site) and does not require the use of VMware VIX. <br><img src="https://habrastorage.org/files/a49/026/536/a49026536d4948308c5913c9854688ac.png"><br><br>  <b>Exclude unnecessary files during backup.</b>  This feature is part of BitLooker technology: when backed up, Veeam also analyzes the MFT partition and creates a cache in the proxy server memory, which marks which files and folders to exclude.  During the backup data is read simultaneously with the original VM and from the cache.  It is important to note that the exclusion of files is possible only if you have activated the backup option taking into account the state of the application (application-aware image processing).  In this case, the exclusion of many small files is processed more slowly than the exclusion of several large files of the same size, because exception handling increases the load on the proxy server.  For example, to exclude 100,000 files from a backup, you need 400 MB of memory on a proxy server. <br><img src="https://habrastorage.org/files/e30/919/3f3/e309193f37a146b1b3591ae1dd9074ba.png"><br><br><h1>  Setting up a full backup copy in the transfer task </h1><br>  Well, one more operation is now automated - earlier, users used the PowerShell script to create a full backup to set the backup copy job, and now you can simply tick the checkbox. <b>Target</b> when setting up a job. <br><img src="https://habrastorage.org/files/d59/646/965/d59646965ac741e59c2013de2c6b9960.png"><br><br>  This option is useful for low-performance storage systems, on which to convert files, synthesizing a full backup from incremental ones, is inefficient, and it is much more convenient to copy a full backup. <br><br><h1>  Instead of conclusion </h1><br>  In addition to the above links, I recommend reading (while in English. Language): <br><ul><li>  <a href="https://helpcenter.veeam.com/backup/hyperv/per_vm_backup_files.html">Description of the backup storage per VM-backup</a> </li><li>  <a href="https://helpcenter.veeam.com/backup/hyperv/mount_server.html">What is a connection server (mount server) and how it works</a> </li><li>  <a href="https://helpcenter.veeam.com/backup/hyperv/guest_interaction_proxy.html">About optimization of work with guest OS</a> </li></ul><br>  Resources in Russian: <br><ul><li>  <a href="https://www.veeam.com/ru/videos/webinar-scale-out-repository-ru-7195.html">Scalable repository video review</a> </li><li>  <a href="https://www.veeam.com/ru/videos/webinar-new-veeam-availability-suite-v9-ru-7446.html">Veeam Availability Suite 9.0 video review</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/276815/">https://habr.com/ru/post/276815/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276805/index.html">Our introduction to Cisco UCS</a></li>
<li><a href="../276807/index.html">Virtualization and Virtual Data Centers: Basic Questions</a></li>
<li><a href="../276809/index.html">Corporate Cloud: Connection Options</a></li>
<li><a href="../276811/index.html">Antivirus again at gunpoint: Malwarebytes found critical vulnerabilities</a></li>
<li><a href="../276813/index.html">Software special computer. ‚ÄúYauza-6‚Äù, ‚ÄúTemp‚Äù, ‚ÄúRuza‚Äù</a></li>
<li><a href="../276821/index.html">The use of machine learning in the field of fintech</a></li>
<li><a href="../276823/index.html">Overview of WhatsApp Toolkit</a></li>
<li><a href="../276825/index.html">Using VS Code for Web Development</a></li>
<li><a href="../276827/index.html">Windows Phone as an experimental platform</a></li>
<li><a href="../276831/index.html">Shodan collected the IPv6 addresses of NTP clients and scanned them in response</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>