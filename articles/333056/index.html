<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I created a printer installation system at work</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear% user%. Today I will talk about how I wrote a user system to enable users to install the printers required for them. I will tell you a lit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I created a printer installation system at work</h1><div class="post__text post__text-html js-mediator-article"><img src="https://hsto.org/web/9b6/90c/986/9b690c986b5a49f88489226b9561d57e.JPG" alt="image"><br><br>  Hello, dear% user%.  Today I will talk about how I wrote a user system to enable users to install the printers required for them.  I will tell you a little about the place where I work, so that it is clear why I did it.  I will say in advance that I knew about the existence of a role component in Windows Server 2012 R2, which makes it possible to install a printer from a browser.  But I wanted to invent my bike, and the restrictions here will probably be in fantasy.  To whom it became interesting welcome under kat.  For those who are not patient, I‚Äôll just say that the screenshots are at the end of the article. <br><a name="habracut"></a><br><h2>  Little about work </h2><br>  I work in helpdesk in some big organization that has many branches.  There are more than a thousand employees working in front of computers.  One can guess that there is a large zoo of network printers, there are individual employees responsible for the operability of printers.  We carry out installation of printers to computers - helpdesk.  Very often, employees of different departments move from one workplace to another, come or leave, or even change their position and profession, and so on.  A lot of interesting things.  Accordingly, because of this, very often calls are made to our helpdesk asking to install a printer for them.  You see, asking the user to tell the printer‚Äôs IP address is like asking a monkey to cook soup.  I will give an example of a dialogue (real case): <br><br><div class="spoiler">  <b class="spoiler_title">U - user, I - I</b> <div class="spoiler_text">  U- Hello, this is a helpdesk I got there? <br>  I- Yes.  Right.  You got there <br>  U- Help me please install the printer on my computer <br>  I-Okay, please tell me the name of your computer. <br>  U-My computer name is comp-01 (fictitious) <br>  I-What printer do you need?  (Connecting to computer) <br>  U-HP LaserJet 600, it is in% place% <br>  I - the location of the printer does not give me anything (and the truth will change it with another printer since the first one went bad, or it will change its place).  Well, can you tell me the ip address of this printer? <br>  U- ... <br>  Pause at the end of the tube.  I already heard the user's brain begin to move, blood began to flow out of his ears, and finally he asked <br>  U- Sorry what?  Amy?  What do you say?  Imy address? <br>  I - ip, ip address. <br>  U-ipi?  And what is it?  How can you look at it? <br>  I ‚ÄìOkay tell me, is there someone else using this printer? <br>  U-Well, it uses% another_user% <br>  I-Please ask him for the name of the computer and get permission for me to connect to it for a moment <br>  U- Ok, now (and I hear the muffled voice of how he asks% another_user% computer name and permission to connect) <br>  I- ... .. (thinking to myself: aimi aimi aimi, sticks of a tree what rhyme on ayimi can come up with) <br>  U-Ale <br>  I- Yes, I'm listening to you <br>  U- Computer name comp-02, you can connect <br>  I- Ask% another_user% to show me the printer that he constantly uses (I connect to the computer) <br>  U- Ok, now (again a muffled voice) ... ... - This one <br>  Okay, okay, I get it. I‚Äôll not keep you on the line. Now I‚Äôll put everything in and set it up. <br>  U- Ok, thanks.  However, you did not tell me what is aymi. <br>  I- You probably meant ip.  Well, it will be difficult to explain now, as there are too many calls, but in general this is the address of the device on the network. <br>  Have you ever heard how the human brain breaks down?  I heard this sound, you know such a deaf sound with splashes of a large amount of information with the content of only ‚Äúwater‚Äù. <br>  U - .... (long pause) ... I see.  I'll go away on business and you put the printer <br>  I- Yeah, well, goodbye <br></div></div><br>  Now imagine that every third caller in the helpdesk, with a request to install the printer in the same condition.  How to be?  This kind of dialogue is very tiring, and to explain to the user how to print the configuration of the device to look at the printer‚Äôs IP, this is something extra heavy.  So some kind of automation is needed.  And what if you collect centrally all the printers on one separate printer server, write a simple web site with a friendly interface.  A couple of clicks and the printer is installed.  Challenge accepted. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Everything is not so difficult as it seems </h2><br>  I asked system administrators to allocate a separate server for Windows Server 2012 R2. <br><br>  <b>On the printer server</b> <br><br><ul><li>  Established the role of Printer Sever </li><li>  Created scripts $ folder to store printer installation scripts </li><li>  Install XAMPP </li><li>  Added apache and mysql as a service to autoload, so that if the server is restarted, the website will not crash </li></ul><br>  <b>With printers:</b> <br><br><ul><li>  I pasted on all the printers the hands reach the stickers with their numbers and installed them on the printer server.  The sequence number is a kind of identifier for the printer.  Wherever he is located, a juzver can always find him by ordinal number.  For example: ‚ÄúHP LaserJet 600 Printer #id% filial%‚Äù, where% filial% is the name of the branch, #id is the unique serial number of the printer.  Printed paper with a serial number and glued to the printer.  It is not necessary for the user to even know the name of the printer.  Coincided number with the fact that the site - it means he is. </li><li>  I agreed with the branch managers, asked for someone to know someone in the branch office to collect and send me the names, printer ip addresses and pasted their serial numbers.  Added all printers one by one to the printer server. </li></ul><br><h2>  We start to program </h2><br>  The website is built on PHP by writing a samopny MVC engine, using only Notepad ++ editor, Google and a browser (yes - only on hardcore).  I don‚Äôt have knowledge of any framework, study laziness, use javascript frameworks in 2k17?, And isn't it too much for printers? <br><br>  <b>We set the goal that we need from this system:</b> <br><br><ul><li>  The most simple and intuitive for the user </li><li>  Ability to create administrator accounts </li><li>  Ability to add / remove printers to administrators </li><li>  Ability to add \ delete branch administrators </li><li>  Availability of any background information for the user </li><li>  Switch language </li><li>  Ability to install printers not by one but by several methods (scripts) </li></ul><br>  <b>Define the structure of the project:</b> <br><br><ul><li>  App <br><ol><li>  Configs </li><li>  Controllers </li><li>  Locale </li><li>  Views </li></ol><br></li><li>  Uploads </li></ul><br>  In the root folder, create the index.php file and add the code: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//  session_start(); //   spl_autoload_register(function ($class){ include './app/controllers/' . $class . '.php'; }); //  .        $controller = new Controller($_GET, $_POST); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br>  In the configs folder, create the database.php file: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> define(<span class="hljs-string"><span class="hljs-string">"HOST"</span></span>, <span class="hljs-string"><span class="hljs-string">"localhost"</span></span>); define(<span class="hljs-string"><span class="hljs-string">"USER"</span></span>, <span class="hljs-string"><span class="hljs-string">"root"</span></span>); define(<span class="hljs-string"><span class="hljs-string">"PASSWORD"</span></span>, <span class="hljs-string"><span class="hljs-string">"OUR_PASSWORD"</span></span>); define(<span class="hljs-string"><span class="hljs-string">"DATABASE"</span></span>, <span class="hljs-string"><span class="hljs-string">"printer"</span></span>); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  Go to the browser in phpmyadmin, create a printer database using the utf8_general_ci encoding.  Create 3 tables with the names branches, printers, users. <br><br>  Branch structure: <br><table><tbody><tr><th>  Name </th><th>  Type of </th><th>  Additionally </th></tr><tr><td>  Id </td><td>  int (6) </td><td>  AUTO_INCREMENT, PRIMARY, UNIQUE </td></tr><tr><td>  branch_name </td><td>  varchar (255) </td><td></td></tr><tr><td>  image </td><td>  varchar (255) </td><td></td></tr></tbody></table><br>  Printers structure: <br><table><tbody><tr><th>  Name </th><th>  Type of </th><th>  Additionally </th></tr><tr><td>  Id </td><td>  int (6) </td><td>  AUTO_INCREMENT, PRIMARY, UNIQUE </td></tr><tr><td>  Name </td><td>  varchar (255) </td><td></td></tr><tr><td>  branchid </td><td>  int (6) </td><td>  Default value: 1 </td></tr><tr><td>  description </td><td>  text </td><td></td></tr><tr><td>  ipaddress </td><td>  varchar (255) </td><td></td></tr><tr><td>  image </td><td>  varchar (255) </td><td></td></tr><tr><td>  File1 </td><td>  varchar (255) </td><td></td></tr><tr><td>  File2 </td><td>  varchar (255) </td><td></td></tr><tr><td>  File3 </td><td>  varchar (255) </td><td></td></tr></tbody></table><br>  Users structure: <br><table><tbody><tr><th>  Name </th><th>  Type of </th><th>  Additionally </th></tr><tr><td>  Id </td><td>  int (6) </td><td>  AUTO_INCREMENT, PRIMARY, UNIQUE </td></tr><tr><td>  Login </td><td>  varchar (128) </td><td></td></tr><tr><td>  Token </td><td>  varchar (128) </td><td></td></tr><tr><td>  password </td><td>  varchar (128) </td><td></td></tr><tr><td>  lang </td><td>  varchar (10) </td><td></td></tr><tr><td>  logindate </td><td>  varchar (255) </td><td></td></tr></tbody></table><br>  As can be seen from the tables branchid determines to which branch the printer belongs (having received the value of its id). <br><br>  Create a record with id equal to 1, the branch name ‚Äúnone‚Äù and image with the value ‚Äúnone‚Äù.  This entry is needed to set the printer is not set branch.  The first entry is hard-coded and is not displayed in the lists of branches, as well as for users and in the admin.  It can not be deleted. <br><br>  I found the <i>Database</i> class on the Internet.  It has a function for connecting to our database, using the values ‚Äã‚Äãfor the connection from the database.php file located in the configs folder and the function for querying the database. <br><br>  The <i>ƒ∞nfo</i> class <i>is</i> used to get, change, delete data from the database.  It is with this class that all operations in the system are performed. <br><br>  One of the important classes is the class <i>Controller.php</i> .  As the name suggests, this class is a controller that accepts GET and POST requests in __construct ($ get, $ post) from index.php.  After receiving a specific request, it collects pieces of the page into a single corresponding request and performs the required functions from <i>Info.php</i> . <br><br>  The <i>Views</i> class is a class that loads pieces of a page.  Each page has its own name corresponding to the php file in the Views folder.  So for example, to display the main page, you should write: <br><br><pre> <code class="php hljs">$views = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Views; $views-&gt;addView(<span class="hljs-string"><span class="hljs-string">'header'</span></span>, <span class="hljs-string"><span class="hljs-string">'header.php'</span></span>); $views-&gt;addView(<span class="hljs-string"><span class="hljs-string">'menu'</span></span>, <span class="hljs-string"><span class="hljs-string">'menu.php'</span></span>); $views-&gt;addView(<span class="hljs-string"><span class="hljs-string">'dashboard'</span></span>, <span class="hljs-string"><span class="hljs-string">'dashboard.php'</span></span>); $views-&gt;addView(<span class="hljs-string"><span class="hljs-string">'footer'</span></span>, <span class="hljs-string"><span class="hljs-string">'footer.php'</span></span>);</code> </pre><br>  In the same class, the current language of the user is determined, the localization is loaded from the ini file, and the variable $ lang is created, which is already used in the piece of the page itself.  Sample code for the main page ( <i>dashboard.php</i> ): <br><br><pre> <code class="php hljs">&lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dashboard</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">container</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt;&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lang</span></span></span><span class="hljs-class">['</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DASHBOARD_HEADER</span></span></span><span class="hljs-class">']; ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">&gt;&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lang</span></span></span><span class="hljs-class">['</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DASHBOARD_TEXT</span></span></span><span class="hljs-class">']; ?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">br</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">br</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">&gt;&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">primary</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lg</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">href</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">index</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class">?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">branches</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">role</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">button</span></span></span><span class="hljs-class">"&gt;&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lang</span></span></span><span class="hljs-class">['</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DASHBOARD_INSTALL</span></span></span><span class="hljs-class">']; ?&gt; ¬ª&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">img</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dashboard</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">img</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">src</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">app</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">views</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">img</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">printer_icon</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">png</span></span></span><span class="hljs-class">"&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre><br>  In the views folder there are also css, javascript files.  I used Bootstrap as the basis for CSS styles. <br><br>  The <i>Lang</i> class defines the user's current language.  First, it tries to get cookies cookie_lang.  If it does not detect it, then it defaults to the Russian language.  The getLangArray () function loads the required ini file and returns an array of the form ‚Äúkey‚Äù -&gt; ‚Äúvalue‚Äù.  It is this function that is used in the views class. <br><br><h2>  What we got </h2><br>  The user enters the main page.  There is a description of where he got and the button that opens the list of all branches.  After the user selects a branch, a list of printers opens.  Printers are displayed in a grid, where their photos and their names.  The user selects a printer, a page with the selected printer opens, where there is a large ‚ÄúInstall‚Äù button (also there is information about the printer, its IP address).  When you click on this button, the bat file is downloaded, which in turn opens the vbs script shared in the scripts $ folder on the printer server.  The problem is that if you upload a vbs file, then instead of downloading it, the browser opens this file in its new tab.  Therefore it was necessary to be so perverted.  Vbs files on the ball folder are also sorted along with their bat file into folders.  For example, below is the folder structure: <br><br>  Printer # id <br><ul><li>  Printer # id.bat </li><li>  Printer # id.vbs </li></ul><br>  Where #id is the serial number of the printer. <br><br>  When adding a new printer through the admin panel, fill in the required fields and select the desired bat file from the balloons.  The installation file, the printer photo is uploaded to the uploads folder.  In the admin it is done in such a way that we can download up to three different installation files.  How many files downloaded so many buttons "Install".  In this case, there were no alternative methods for installing printers.  VBS script was enough. <br><br><h2>  Vbs script </h2><br>  Vbs script setting the printer looked like this: <br><br><pre> <code class="vbscript hljs">printerName = <span class="hljs-string"><span class="hljs-string">"\\prnserver01\HP LaserJet 600 printer1 branch1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> WshNetwork = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"WScript.Network"</span></span>) WshNetwork.AddWindowsPrinterConnection printerName WSHNetwork.SetDefaultPrinter printerName</code> </pre><br>  This script runs in invisible mode, a command window is displayed for a while, then it disappears.  This script has a minus of what is not clear what is happening.  Therefore, thinking a little changed it to this form: <br><br><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">'   printerName = "\\prnserver01\HP LaserJet 600 printer1" '  Internet Explorer Set objExplorer = CreateObject("InternetExplorer.Application") '   - , ,    objExplorer.Navigate "about:blank" objExplorer.ToolBar = 0 objExplorer.StatusBar = 0 objExplorer.Left = 500 objExplorer.Top = 250 objExplorer.Width = 550 objExplorer.Height = 170 objExplorer.Visible = 1 '  objExplorer.Document.Title = "Ustanovka printera" ' html  ,     objExplorer.Document.Body.InnerHTML = "&lt;table style=""width:100%""&gt;&lt;tr&gt;&lt;td id=""progress"" style=""font-family:Segoe UI;text-align: center;font-size:48px;border-bottom:1px solid black;""&gt; Ustanovka printera: 0%&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=""font-family:Segoe UI;text-align: center;font-size:22px;""&gt;" &amp; printerName &amp; "&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;" ' 500 ,      id progress    .    ,    0 Wscript.Sleep 500 objExplorer.document.getElementById("progress").innerText = " Ustanovka printera: 10%" '    ,       .            Set WshNetwork = CreateObject("WScript.Network") WshNetwork.AddWindowsPrinterConnection printerName WSHNetwork.SetDefaultPrinter printerName '   200 ,        Wscript.Sleep 200 objExplorer.document.getElementById("progress").innerText = " Ustanovka printera: 20%" '     200  Wscript.Sleep 200 objExplorer.document.getElementById("progress").innerText = " Ustanovka printera: 40%" ' ,         Wscript.Sleep 200 objExplorer.document.getElementById("progress").innerText = " Ustanovka printera: 60%" '      Wscript.Sleep 200 objExplorer.document.getElementById("progress").innerText = " Ustanovka printera: 80%" '  , ! Wscript.Sleep 100 objExplorer.document.getElementById("progress").innerText = " Printer ustanovlen!" '  3     ,      Wscript.Sleep 3000 objExplorer.Quit</span></span></code> </pre><br><h2>  Screenshots </h2><br><div class="spoiler">  <b class="spoiler_title">Screenshots</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/9b6/90c/986/9b690c986b5a49f88489226b9561d57e.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/579/183/d8e/579183d8e8304db19af6d2c393bcbb37.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/a87/8b7/0af/a878b70afcb745acb17dfded1b54e7b8.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/3c9/238/de9/3c9238de99b94c59b1e7d02ab3c4f49a.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/9a9/2d4/ed2/9a92d4ed213a4a7c8cc479f5cb32d821.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/55e/5f0/01c/55e5f001c8384468841b6b73e0e19e47.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/f2c/3da/2b0/f2c3da2b08a24023898a2bf66d6cdca6.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/b2b/c8b/7cc/b2bc8b7cc9ea4cd78d6ea7010289982f.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/39f/173/c70/39f173c702f146f88a118260cae1ee05.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/c43/e78/290/c43e7829003a4153a21802ae2c18015e.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/f3a/443/a9b/f3a443a9be8d4a4ab2f61549aa65403c.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/bf7/5fd/feb/bf75fdfebef540f8ab3d6406c2518908.JPG" alt="image"><br><br><img src="https://habrastorage.org/web/b70/95d/1cc/b7095d1ccc784cc79df1f436b88d4d2f.PNG" alt="image"><br><br><img src="https://habrastorage.org/web/2a7/6fc/8ce/2a76fc8ce4d84eb39ead79323ca660a3.PNG" alt="image"><br><br><img src="https://habrastorage.org/web/002/d65/2d6/002d652d6c7848de8d8987d1cf74954d.PNG" alt="image"><br><br><img src="https://habrastorage.org/web/d0a/155/c3d/d0a155c3d7964c65a4dca0c43363dd08.PNG" alt="image"><br></div></div><br>  The source code of all this is posted on <a href="https://github.com/akshinmustafayev/PrinterSetupSystem">github</a> <br><br>  Now there are fewer calls to install printers. <br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/333056/">https://habr.com/ru/post/333056/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../333036/index.html">Yubikey 4 - purchase, delivery and receipt</a></li>
<li><a href="../333038/index.html">Experience Tutu.ru: how the schedule of trains</a></li>
<li><a href="../333040/index.html">WPF and Box2D. How I did physics with WPF</a></li>
<li><a href="../333042/index.html">Neuro Theater: ITMO University technologies help to create the ‚Äúart of new media‚Äù</a></li>
<li><a href="../333046/index.html">Semantics exactly-once in Apache Kafka</a></li>
<li><a href="../333132/index.html">Information Security Europe: trends in the global information security market that you will not read about from Gartner</a></li>
<li><a href="../333274/index.html">With the new (IT) "year" you, friends</a></li>
<li><a href="../333336/index.html">What is Display Rate and how does it affect the revenue of your application?</a></li>
<li><a href="../333338/index.html">Which firewall is the best? Leaders among UTM and Enterprise Firewalls (Gartner 2017)</a></li>
<li><a href="../333344/index.html">Measuring Telegram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>