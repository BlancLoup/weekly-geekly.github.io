<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kaggle: British satellite imagery. How we took the third place</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I‚Äôll just make a reservation that this text is not a dry squeeze of basic ideas with beautiful graphs and an abundance of technical terms (this text i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kaggle: British satellite imagery. How we took the third place</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/d38/3f4/3bd/d383f43bdaf7438fa68a4f991f8b1f4d.png"></div><br>  I‚Äôll just make a reservation that this text is not a dry squeeze of basic ideas with beautiful graphs and an abundance of technical terms (this text is called a scientific article and I will definitely write it, but then when they pay us $ 20,000 in prizes, and then, God forbid, conversations begin about the license, copyright, etc.. (UPD: <a href="https://arxiv.org/abs/1706.06169">https://arxiv.org/abs/1706.06169</a> ).  To my regret, until all the details are fixed, we cannot share the code that we wrote for this task, because we want to receive money.  As everything settles down - be sure to deal with this issue.  (UPD: <a href="https://github.com/ternaus/kaggle_dstl_submission">https://github.com/ternaus/kaggle_dstl_submission</a> ) <br><br>  So, this text is more like stories based on motives in which, on the one hand, everything is true, and on the other hand, the abundance of lyrical digressions and other ad-libs does not allow to consider it as something science-intensive, but rather just as useful and fascinating. reading matter, the purpose of which is to show how the process of working on tasks in the competitive machine learning discipline can occur.  In addition, there is a lot of vocabulary in the text that is specific to Kaggle and I will explain something along the way, and leave something like this, for example, the question about geese will not be disclosed. <br><a name="habracut"></a><br>  A few weeks ago at Kaggle ended the next competition in computer vision.  Despite all our efforts, in the team with <a href="https://www.linkedin.com/in/sergeymushinskiy/">Sergei Mushinsky</a> we still managed to finish third (the original marshal's plan was to stay in the top 50), which made us involved in the cut of the prize fund, which the British Ministry of Defense allocated.  The top three winners share $ 100k: <a href="https://www.kaggle.com/kylelee">Malaysian Kyle</a> ($ 50k) won first, <a href="https://www.kaggle.com/zfturbo">Roman Solovyov</a> and <a href="https://www.linkedin.com/in/artur-kuzin-75a48838/">Arthur Kuzin‚Äôs</a> team won the second place ($ 30k), and we, that is, <a href="https://www.linkedin.com/in/sergeymushinskiy/">Sergey Mushinsky</a> ($ 20k) and the third.  As a side effect, I was in the top 100 in the global ranking, which, of course, does not bother anyone, but is a pleasant addition to the summary. <br><br>  Hereinafter, I will call Data Scientists the code word "Scientologist", which, on the one hand, underlines the deep connection of Data Sciene with basic science, and on the other, is the standard neologism in <a href="http://ods.ai/">slack Open Data Science</a> , which I will call simply - "chat." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The success of Kaggle among the Scientologists of Silicon Valley, where I currently live, is quoted roughly next to nothing, and counting on receiving prize money is quite a bold move, so the only true motivation to participate in competitions is the knowledge that is acquired in the process.  To whom it is very interesting, a few months ago, when I wrote a <a href="https://habrahabr.ru/post/318518/">similar text</a> , but about a <a href="https://www.kaggle.com/c/allstate-claims-severity">different task</a> , I devoted the entire introduction to the question of motivation in the context of competitive machine learning, where Russian and white described how and why it makes sense to invest some piece of free time in this lesson. <br><br>  It should be noted that there is a lot of competition, but there is little free time, plus life outside the monitor and keyboard does exist, so the planning process is quite acute. <br><br>  Each competition at Kaggle, as a rule, is about three months, and at the same time there are several.  The organizers are trying to shift them in time, so I have a pretty good method when the competitions are sorted in the order of the deadlines and you work on the task that ends next. <br><br>  One of the advantages is that closer to the end of the forum is full of fruitful discussions, which, in turn, greatly reduces the time to check what works and what does not, and from the minuses that a couple of weeks in the evenings after work may not be enough to offer something worthy, and with such an approach in the top 10 it is extremely difficult to leave, in any case, I did it only once. <br><br>  But, since we are not checkers, but go, this approach allowed us to pick up machine learning to a level that was enough to find an adequately paid position Sr.  Data Scientist, on which machine learning is much used for work. <br><br>  All this is wonderful, but there is a nuance.  Classical machine learning is fine, but neural networks are much more exciting, and the fact that during the day at work I screw machine learning in production, and in the evenings I read all sorts of clever books and articles about Deep Learning, it seems to me unsatisfactory.  Anyway, I want to go to DeepMind, but there is a hypothesis that if I submit there now, no one will look at my resume, for all my articles on theoretical physics, and not on machine learning, but, more fundamentally, I have corny may not have enough knowledge to correctly answer the questions in the interview. <br><br>  I distribute all these lyrics in order to uncover a simple idea: to cut competitions on Deep Learning, if I want to find interesting work with this very Deep Learning - it‚Äôs very necessary and this is almost the most effective option to learn how to work with neural networks in a short time. <br><br>  Last summer, I stuck on ImageNet and it immediately became clear that my infrastructure was not prepared, some trifles always come out about which the authors of the articles either deliberately or accidentally keep silent about, but you need to know about the various frameworks, not as good as I would like. <br><br>  All autumn, there were some uninteresting tasks at Kaggle, and in every second - data leak, so instead of machine learning, the public exploited the curvature of the hands of the organizers, but with the beginning of winter the map went to me.  In the past couple of months, thousands of experienced Kagglers have been sitting and blinking their eyes in surprise from the fact that since December 6 Deep Learning competitions have started with a total prize pool of $ 1,475,000.  As usual, the stacks of xgboost will not go away, you have to spend money on GPU / cloud, go out of your comfort zone, knead your brains and start working with neural networks. <br><br>  The first among these six competitions was the task that I will continue to talk about. <br><br><h2>  Formulation of the problem </h2><br>  The data were provided by a research laboratory at the Department of Defense of the United Kingdom and compiled 450 satellite images of the Nigerian jungle with a total area of ‚Äã‚Äã450 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><msup><mi>m</mi><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.306ex" height="2.419ex" viewBox="0 -935.7 1853.9 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-6B" x="0" y="0"></use><g transform="translate(521,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-32" x="1242" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><msup><mi>m</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-1"> km ^ 2 </script>  .  The fact that this is Nigeria, we learned after the end.  The organizers quite well anonymized the data, so for us it was just pictures, without reference to the terrain.  I do not think that the purpose of the competition was to get a code that can be inserted into production and boldly begin to direct rockets to African villages.  Rather, it was something from the series ‚Äúsend the task, take the popcorn and we will see what these Scientologists succeed in,‚Äù that is, the usual Proof Of Concept.  The results pleased them so much that they filed their <a href="https://www.datasciencechallenge.org/">own copy of Kaggle</a> . <br><br>  In contrast to the classical problems of image segmentation, in this problem each of the pictures is available in a large number of spectral channels.  Moreover, these channels have different resolutions and may have shifts in time and space. <br><br><img src="https://habrastorage.org/files/c1c/de0/598/c1cde0598ff14af98609a6371f18a195.png"><br><br>  At the output, it is necessary to predict class by pixel pixel.  It is worth noting that the classes are not mutually exclusive, that is, the same pixel can belong to the car, and the road along which this car drives, and the tree that hangs over this car and the road. <br><br>  In total, it was necessary to predict belonging to 10 classes, which are extremely unevenly distributed, and even these distributions differ in train and test, plus many classes are few, and there are fewer machines than few. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/3bd/a22/c86/3bda22c862144512b65bb27b01ff338f.png"></div><br><br>  As mentioned above, all data is divided into 26 train set pictures (masks are available for them), and 425 test set pictures, for which the masks should have been predicted.  Test set, in turn, was also divided into two parts in the best traditions of Kaggle: <br><br><ul><li>  19% - Public test </li><li>  81% - Private test </li></ul><br>  All three months, while the competition was going on, the model's accuracy rating on the Public was known, and when the competition was over, the final result is calculated by the Private part. <br><br><h4>  Metrics </h4><br>  Accuracy was calculated as the average <a href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard Index</a> for all classes, that is, the fields made the same contribution as the machines, despite the fact that judging by train pixels with fields 60 thousand times more. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/68f/3b7/79c/68f3b779cd50f21da0b69932396c8407.png" alt="image" width="250"></div><br><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10</mn></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10</mn></mrow></msubsup><mi>j</mi><mi>a</mi><mi>c</mi><mi>c</mi><mi>a</mi><mi>r</mi><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10</mn></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10</mn></mrow></msubsup><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>A</mi><mi>i</mi></msub><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>a</mi><mi>p</mi><msub><mi>B</mi><mi>i</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>A</mi><mi>i</mi></msub><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>u</mi><mi>p</mi><msub><mi>B</mi><mi>i</mi></msub></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.62ex" height="3.142ex" viewBox="0 -935.7 32989 1352.7" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-63" x="469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-6F" x="903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-72" x="1388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-65" x="1840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-3D" x="2584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-66" x="3890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-72" x="4441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-61" x="4892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-63" x="5422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-31" x="5855" y="0"></use><g transform="translate(6356,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-73" x="7607" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-75" x="8076" y="0"></use><g transform="translate(8649,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,360)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-30" x="500" y="0"></use></g><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-6A" x="10776" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-61" x="11188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-63" x="11718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-63" x="12151" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-61" x="12585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-72" x="13114" y="0"></use><g transform="translate(13566,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-69" x="736" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-3D" x="14708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-66" x="16015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-72" x="16565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-61" x="17017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-63" x="17546" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-31" x="17980" y="0"></use><g transform="translate(18480,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-73" x="19731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-75" x="20201" y="0"></use><g transform="translate(20773,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,360)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-30" x="500" y="0"></use></g><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-66" x="23150" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-72" x="23701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-61" x="24152" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-63" x="24682" y="0"></use><g transform="translate(25115,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-69" x="1061" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-63" x="1344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-61" x="1778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-70" x="2307" y="0"></use><g transform="translate(2811,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-69" x="1074" y="-213"></use></g></g><g transform="translate(29030,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-69" x="1061" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-63" x="1344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-75" x="1778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-70" x="2350" y="0"></use><g transform="translate(2854,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325096/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhOm6xalbWzlu_Sobzwgo8Zu2QWyg#MJMATHI-69" x="1074" y="-213"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msubsup><mi>j</mi><mi>a</mi><mi>c</mi><mi>c</mi><mi>a</mi><mi>r</mi><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msubsup><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>A</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>p</mi><msub><mi>B</mi><mi>i</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>A</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mi>c</mi><mi>u</mi><mi>p</mi><msub><mi>B</mi><mi>i</mi></msub></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> score = \ frac 1 {10} \ sum_ {i = 1} ^ {10} jaccard_i = \ frac 1 {10} \ sum_ {i = 1} ^ {10} \ frac {A_i \ cap B_i} {A_i \ cup B_i} </script></p><br>  That's how it all looks offhand, that is, the task is quite straightforward, especially considering that the <a href="https://www.kaggle.com/c/ultrasound-nerve-segmentation">similar task</a> , though not about satellite imagery, but about ultrasound scans, and not for roads and houses, but for finding the nerves, I already worked.  But in general, from the technical side, it is image segmentation as it is. <br><br><h3>  Nuances </h3><br>  For any competition, and indeed machine learning tasks, the most important first step is to write a pipeline that takes raw data, cleans, caches, trains something, performs validation and prepares a submit.  And usually, for what, often rightly, Kaggle is poor, the data is more or less clean and everything is quite straightforward from the technical side and the main problems arise at the stages of feature engineering and training of models, but then the British military added British exotics. <br><br><h4>  Problem one </h4><br>  I look at what the organizers have marked for us and do not understand what to do with it.  To train a neural network, I need a matrix <code>(height, width, num_channels)</code> , and I don‚Äôt have the slightest understanding how to get it. <br><br>  Something like this looks like this: <br><br> <code>'MULTIPOLYGON (((0.005311 -0.009044999999999999, 0.00531 -0.009035, 0.00531 -0.009024000000000001, 0.005318 -0.009018999999999999, 0.005327 -0.009016, 0.005341 -0.009016, 0.005356 -0.009017000000000001, 0.005372 -0.009023, 0.005375 -0.009031000000000001, 0.005375 -0.009044999999999999, 0.005311 -0.009044999999999999)), ...</code> <br> <br>  Some polygons, and a lot of non-integer digits.  We climb to the forum and, as usual, there is a <a href="https://www.kaggle.com/visoft">good soul</a> who shared the <a href="https://www.kaggle.com/visoft/dstl-satellite-imagery-feature-detection/export-pixel-wise-mask">code</a> that performs the desired transformation. <br><br><h4>  Problem two </h4><br>  Proper validation is 90% success.  There is no such question on ImageNet - there the organizers choose a subsample that represents the full distribution well and provides it to the participants.  Anyway, there are so many pictures there that almost any subsample will work fine.  On Kaggle everything is usually different.  Precedents, when the data is well balanced, and local validation corresponds to what we see on the leaderboard, exist, but this is the exception rather than the rule.  Looking ahead, I will say that we, as well as, probably, all the others, have not solved the problem with the validation of our results.  <a href="https://www.kaggle.com/zfturbo">Roman Solovyov</a> (his team finished in second place) had <a href="https://www.kaggle.com/c/dstl-satellite-imagery-feature-detection/discussion/29829">some kind of system, with cross-validation</a> , but I treat it with a certain degree of skepticism. <br><br>  The idea is that there are few pictures, and they correspond to quite different areas.  That is, Train, Public and Private are three different distributions, strongly correlated, but, nevertheless, different, as can be seen in the picture above. <br><br><h4>  Problem three </h4><br>  God bless her with validation to get to the first submission, you can disable it.  I take the standard workhorse of Unet segmentation tasks, write the entire infrastructure with the formation of batches on the fly, augmentation with transformations <a href="https://en.wikipedia.org/wiki/Dihedral_group">of the D4 group</a> , I train the network predicting all 10 classes at a time, something even converges somewhere. <br><br>  I trained.  Cool.  Then what?  The next problem is how to make the prediction itself.  The network was trained on random crocs of 112x112 in size from 3600x3600 images and at this stage it was necessary to create an infrastructure that would cut a large image into small ones, predict, correctly handle edge effects, and then assemble everything back.  This is a dreary, but straightforward piece, although, as it turned out later, I nakosyachil on it too. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/e1c/4aa/487/e1c4aa487c284255bf6f93163035ea37.png" width="300"></div><br><br><h4>  Fourth problem </h4><br>  Cool.  I already sense that I have almost reached a submission, and for every big picture I can create a mask.  But this is not enough.  Kaggle takes the prediction in the form of polygons, and it is not a trivial task to overtake masks into polygons on the fly.  I climb on a forum.  There is some kind of code.  I screw it.  I collect - size 4Gb.  I upload to the site, the download takes longer than a long time, something starts to count, and the submit fails.  I climb to the forum, and there already is a branch, in which intelligently, but without a mate, they discuss this particular problem.  I attach some of the proposed solutions to the submission, now the file is only 2Gb, which is still a lot, but it's better to load it, and this time the download lasts two times faster than a very long time, something starts spinning, and on the screen This is a capacious message. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/194/7cb/9f2/1947cb9f2a82437b89608bb5c7b35e9c.png" width="400"></div><br><br>  And now, after all the movements, a month has already passed, and I never made the first submit.  It is worth noting that, in parallel with this whole process, I began to look for work focused on Deep Learning, in order to aggravate my knowledge in this area as part of paid work, and not in the evenings, killing my free time.  The pompous Indians who interviewed me more than once said something like: ‚ÄúKaggle for children, there is clean data, and you don‚Äôt really need to write the code, not what we have here in Horns and Hooves.‚Äù  And in many respects they are right, but in the context of this task about satellite imagery on the head to hit such characters, of course, I wanted to. <br><br>  So, I suffer.  Not a damn thing and it‚Äôs not clear where to dig.  I strongly sinned on the net, saying that it mows me, and therefore the error in the broken polygons because it predicts badly, the polygons in the submite are highly fragmented, which leads to a large submission size, plus the polygons have some kind of wrong format, which leads to mistakes.  And the whole month with all this, I unsuccessfully snuggled.  It should be noted that I was not the only one who had a similar success, but also the majority of the participants, which led to the fact that many did not want to suffer with all this overhead projector and piled it on to more straightforward but equally dull parallel contests <a href="https://www.kaggle.com/c/the-nature-conservancy-fisheries-monitoring">on the classification</a> <a href="https://www.kaggle.com/c/data-science-bowl-2017">of small</a> <a href="https://www.kaggle.com/c/the-nature-conservancy-fisheries-monitoring">fish</a> and <a href="https://www.kaggle.com/c/data-science-bowl-2017">lung cancer.</a> .  A month before the end, there were about 200 people on the Leadeboard, and only 50 of them were above the sample submission. <br><br>  So what do we want?  Get a lot of knowledge in the problem of segmentation of satellite imagery.  But what do we have?  Yes, we don't have a damn thing, a bunch of code with some kind of networks that do not understand how they work, if they work at all. <br><br>  There remained 30 days, and in order for something to stick together during this period, it was necessary to make a knight's move, which was successfully accomplished.  In chatik (Slack channel Open Data Science) there is a room kaggle_crackers, in which, in theory, there is an intelligent discussion of current and past tasks on machine learning.  Actually, there I started to actively ask questions about this problem, in the mode ‚Äúhere is an error, who faced?‚Äù.  One of the chat participants, namely, a simple brutal guy <a href="https://www.kaggle.com/lopuhin">Kostya Lopukhin</a> (finished fifth in the extremely strong DL quartet), while I bleated and stumbled, hacked through the OpenCV documentation and shapely, and wrote the correct and fast code for driving from the mask to the polygons, which allowed to make submissions of adequate size, and this was a turning point for the whole competition, I would even say epochal.  Actually, it all started with this.  This function was used by 90% of the participants, and indeed, if it were not for Kostya, the British military would be sitting and swearing at Scientologists, and not filed their Kaggle. <br><br>  I screwed the function, made a submit, got 0 and the last place on the Leaderboard.  It was connected with the next trick from the organizers: it turns out that there were some muddy coefficients that were used for anonymization, and they had to be taken into account, and after I took them into account, it turned out that I had very adequate networks and gave the result in the top 10%.  The issue with errors in sabmite was decided to blow up the polygons, because, it turns out, the Kaggle code does not like polygons with strongly sharp corners, and if I don‚Äôt lie, <a href="https://www.kaggle.com/movchan">Alexander Movchan</a> suggested this solution. <br><br>  Word for word, the discussion of this task in the core channel began to attract those to whom this task seemed interesting, especially when it became clear that all unhealthy engineering, which everyone does at work for money, but no one wants to do it in their free time and for free, surmountable <br><br>  The second landmark event happened when <a href="https://www.kaggle.com/drn01z3">Arthur Kuzin</a> (finished second in command with <a href="https://www.kaggle.com/zfturbo">Roman Solovyov</a> ) decided to show that analysts at Avito were not done with a finger, and that now he will show his high class to a Scientologist from the valley, and started the <a href="https://www.kaggle.com/drn01z3/dstl-satellite-imagery-feature-detection/end-to-end-baseline-with-u-net-keras/">kernel on Kaggle, which gives the end2end solution</a> that is, it cleans the data, trains the model and makes a prediction that attracted a couple of hundred more people to participate in solving this problem. <br><br>  A separate channel was created for this case, <a href="https://www.kaggle.com/drn01z3">Arthur</a> invited <a href="https://www.kaggle.com/zfturbo">Roman Solovyov</a> to chat, who is known on Kaggle as the legendary ZFTurbo, and in Russia as a modest researcher in one of the design offices.  Also <a href="https://www.kaggle.com/alexeynoskov">Alexey Noskov</a> joined the chat.  Apparently, he was invited after being on the second place in the <a href="https://www.kaggle.com/c/outbrain-click-prediction">Outbrain Click Prediction</a> competition, <a href="https://www.kaggle.com/c/outbrain-click-prediction">which</a> ended in January.  My future partner, <a href="https://www.kaggle.com/ceperaang">Sergei Mushinsky,</a> also decided that it was enough to kick the noodle in the Siberian snows and took up the code and reading literature.  Separately, I would like to mention <a href="https://www.kaggle.com/stromnov">Andrei Stromnova</a> , who did not even participate in the competition, but since he was very knowledgeable in the subject area, he advised us a lot on the specifics of working with satellite imagery. <br><br>  The team caught up with the engineering, we figured out, there were three weeks left, and what did we have? <br><br>  It is absolutely incomprehensible how to locally validate.  The standard way - to take 5 pictures in holdout set and use them for validation - I was very worried, because it led to the fact that we have train, validation, Public and Private - these are four different distributions, and to cut down an already small train is not very wanted to. <br><br>  Sasha Movchan suggested another way - to bite off a piece from each picture and sprinkle validation from it.  In theory, this was better, because it guaranteed that train and validation were from one distribution.  But this, of course, is also not a solution, because test is still quite different, although we certainly tested this hypothesis. <br><br>  In the end, everyone came up with something different.  The novel did not spare computer resources and did 5 fold, Kostya and Alexey identified several pictures for validation, someone just believed the Public leaderboard, motivated by the fact that there are 80 pictures, and indeed, it‚Äôs hard to overfill the segmentation task. <br><br>  Sergey and I used the worker-peasant solution and did not use validation at all.  Trained until the train loss went to the plateau.  After that, predictions were made for the whole test, side by side - a mask and a picture. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/4bb/08c/8dc/4bb08c8dc06b4a8b827aefd8447fbbdc.png"></div><br><br>  And all this was visible through the eyes.  On the one hand, it was possible to catch obvious flaws in the code, for example, my network liked to add houses evenly around the edges of the picture, which I decided with the same technique that was used in the original article about Unet, namely, to make padding a reflection of the nearest area of ‚Äã‚Äãthe original picture . <br><br>  Or in the picture above: <br><br><ul><li>  Ponds predicted in houses and in the middle of roads. </li><li>  Incomprehensible pieces of asphalt roads here and there.  You can filter at the post-processing stage by the minimum area of ‚Äã‚Äãpolygons. </li><li>  Gaps in the predictions of asphalt roads - you can try to fix it through <a href="http://docs.opencv.org/trunk/d9/d61/tutorial_py_morphological_ops.html">morphological transformations.</a> </li></ul><br>  It also made it possible to understand what we are burning on False Positive or False Negative and to correct the binarization thresholds.  After visually it seemed to us that it was better, the prediction was sent to the Leaderboard.  On the one hand, such an approach is a violation of the rules, like, to look at the test is a low style, but on the other hand, it is life, and we did it from despair.  At work, they do manual review from time to time, for machine learning without Human In the Loop is a crime. <br><br>  Summing up about validation - from what I have seen, our approach is the most reliable. <br><br>  The next question, to which we all the team tried to get an answer - how to catch cars and trucks.  There are two classes of them, that is, 20% of the final result is incorporated in them.  With machines, the main problems were that there are few of them, each of them is a few pixels on the asphalt, and they are marked in Hindu - somewhere the machine is not marked, somewhere instead of a car there is a trash can, various bands in one the same picture can be taken at intervals of a few seconds, so if the car moves, you can easily get the car in different places on the same picture. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/66c/6ad/b11/66c6adb119d0449cbc9127ca819c455e.png"></div><br>  This is the same truck. <br><br>  Other teams used solutions of varying degrees of efficiency, but our team decided, again, to do it in a simple way: we scored on machines, aware that we were definitely losing this.  Perhaps now, when I greatly improved my skills and knowledge in localization tasks, I would have acted differently, but at that moment, it seems to me, this was the most correct decision. <br><br>  Another nuance that this competition possessed is the submission format and the metric, which allowed to make predictions for individual classes and check what this corresponds to on the Leaderboard.  On the one hand, this allowed the participants to go into silent mode, and on the other, to have a more accurate assessment of the predictions.  Classes are so different that it‚Äôs very difficult to measure progress in predicting them all at once.  From these considerations, everyone began to make predictions class-by-class, which led to the appearance of a summary table, which looked like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/253/a65/8b9/253a658b93954392906c9a07ccbbb425.png"></div><br>  In turn, this led to the formation of teams among those who believed that this would greatly improve the result.  At first Arthur and Roman got into the team, after them Alexey, Kostya and the guys from <a href="https://deepsystems.io/">deepsystems.io</a> .  And then Sergey and I formed a team, and we got quite comfortable because of the very different time zones (Angarsk - San Francisco), a sort of shift work. <br><br>  Standard technical question: which network to use?  Each article claims that they, the State of The Art, even if they do not lie, then this State Of The Art was on other data, and their experience is not necessarily transferred.  To assess what can be used from the literature and what is not, adequate validation is needed, and we, as noted above, did not have it.  All the articles that we discussed operate with some kind of pure big data, but something like that has never been encountered in this Nigerian foul-heartedness with which we worked. <br><br>  And, of course, a person who understands segmentation tasks may have a legitimate question: ‚ÄúHave you tried using method X from article Y, for example, CRF for post-processing?‚Äù Or ‚ÄúHave you tried network architecture Z, say, DenseNet variation for segmentation?  Most likely, the answer is yes, we shoveled the cubic meters of literature, and many of the ideas were embodied in the code and checked, but not in the mode that everyone tried everything, more likely this way: someone tried it, it didn‚Äôt go down, he shared it with the others, and those already for this time did not lose. <br><br>  Unlike the standard segmentation task, where in RGB pictures we need to distinguish cinderella from Cheburashek pixel by pixel, we had a lot of input channels in different ranges and this had to be somehow taken into account.  The simple option is to stick everything together in one big sandwich and train on it (Roman did this), or make a tricky network with different entrances, what did Arthur do?  Trust the network or help her old-fashioned methods, namely, to do segmentation through indices?  What to do with RGB?  RGB satellite does not produce.  It turns out that the M band in low resolution is mixed with the P band, which is high, a pinch of tobacco is added and RGB is obtained.  This was shown in the <a href="https://www.kaggle.com/resolut/dstl-satellite-imagery-feature-detection/panchromatic-sharpening">first</a> <a href="https://www.kaggle.com/resolut">Vladimir Osin</a> <a href="https://www.kaggle.com/resolut/dstl-satellite-imagery-feature-detection/panchromatic-sharpening">kernel</a> . <br><br>  Our team did this: we found fast and slow water through indexes based on the <a href="https://www.kaggle.com/resolut/dstl-satellite-imagery-feature-detection/waterway-0-095-lb">second kernel</a> from Vladimir Osin. <br><br>  And for the rest of the classes we collected RGB, P, M and glued 4 additional indexes <a href="https://en.wikipedia.org/wiki/Enhanced_vegetation_index">Enhanced vegetation index (EVI)</a> , <a href="https://en.wikipedia.org/wiki/Normalized_difference_water_index">Normalized difference water index (NDWI)</a> , <a href="https://www.researchgate.net/publication/259360047_Use_of_the_Canopy_Chlorophyl_Content_Index_CCCI_for_Remote_Estimation_of_Wheat_Nitrogen_Content_in_Rainfed_Environments">Canopy Chlorophyl Content Index (CCCI)</a> , <a href="https://en.wikipedia.org/wiki/Soil-Adjusted_Vegetation_Index">Soil-Adjusted Vegetation Index (SAVI)</a> .  All of these indices do not add any new information, so the network would figure it out, but, bearing in mind how adding quadratic interactions between features helped the gradient boosting in the <a href="https://habrahabr.ru/post/318518/">Allstate problem</a> , even though this boosting should find the high-level interactions itself, we have added. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e64/93e/837/e6493e8379d34789b64bf9c8d6c86dbd.png"></div><br>  As you can see, in this picture the water through the indices is very good, so similar techniques have been used since multispectral satellite imagery began to be taken. <br><br>  After that, all of this was fed into the input of the stranded Unet.  Unet is something like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/17d/c47/5ed/17dc475ed2315797693480216c084cda.png" alt="image"><br>  (a picture from the <a href="https://arxiv.org/abs/1505.04597">original article</a> , we had a slightly different way (we added BatchNormalization, replaced Relu with Elu, cropped differently and changed the number of filters), but in Unet it is also conceptual of Unet in Africa, although there are many An interesting example is <a href="https://arxiv.org/abs/1611.09326">the Tiramisu network</a> , to which we had high hopes, but somehow it somehow did not go to anyone but Alexei Noskov.) <br><br>  We had an unstable impression that since the images in Train are very different, in this problem a large batch is more important than a large receptive field, so we used a batch of 128 images of 112x112 in size and 16 channels each.  That is, we fed a matrix to the network input (128, 112, 112, 16). <br><br>  Sergey checked on his GPU with a 96-picture batch, it went fine, so it might have made sense to use (96, 128, 128, 16), which is generally similar, but slightly better. <br><br>  I would say more, different classes required different receptive field and different number of channels, say, the fields most likely could be predicted on one M band, the resolution of 1.24 m / pixel was enough for the eyes.  You can even reduce.  And since there are many of these fields, a large batch size was not required. <br><br>  There is little data, so during training a random transformation from <a href="https://en.wikipedia.org/wiki/Dihedral_group">the D4 group (a symmetry group of the square)</a> was applied to each picture from the batch.  Other teams additionally used turns at small angles, but my hands did not reach, and without this, what worked worked more or less, and for machines this was not enough anyway. <br><br>  We used <a href="http://www.cs.toronto.edu/~fritz/absps/momentum.pdf">Nadam</a> as an Optimizer and coached every network of 50 epochs with 400 updates with learning rate = 1e-3, and then another 50 with learning rate = 1e-4 <br><br>  As a loss function, we used the following expression: <br><p><math> </math> $$ display $$ loss = \ left (\ mbox {binary_cross_entropy} \ right) - log \ left (\ frac 1 {10} \ sum_ {i = 1} ^ {10} \ frac {\ sum y_ {true} \ times y_ {pred}} {\ sum y_ {true} + \ sum y_ {pred} - \ sum y_ {true} \ times y_ {pred}} \ right) $$ display $$ </p><br>  A similar loss function performed well in another segmentation task.  Intuition for our choice was this: on the one hand, we need the probability of belonging to each class, so binary_crossentropy will show itself well, and on the other, our metric is jaccard, which means it would be nice to add its approximation to the loss function.  As a bonus, such a combination simplified life at the threshold selection stage when moving from the probability that a pixel belongs to a mask to a binary value.  With this loss function it becomes not very important that you use: 0.3, 0.5 or 0.7.  Rather, the difference is, but it is smaller than it would be when using the bare binary_crossentropy. <br><br>  Each Fully Convolutional Network suffers from the fact that predictions reduce accuracy with distance from the center, which is usually solved by cutting the prediction around the edges and / or overlapping the predictions.  We did both.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each predicted mask at the edges was cut off by 16 pixels. </font><font style="vertical-align: inherit;">Plus, we used test time augmentation, in this mode, which partly reduced the edge effects: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, the initial image size (3348, 3396) through ZeroPadding to (3392, 3472)</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/files/195/23f/97c/19523f97ca924d6d8e94383069873d35.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leaving the edges in such a ZeroPadding mode is impossible, when I did this, this sharp edge was perceived by the network as a wall of a house, and they turned out at home smeared with an even layer around the perimeter. </font><font style="vertical-align: inherit;">This is quite easily solved. </font><font style="vertical-align: inherit;">As I already mentioned, in the original article on Unet this was solved by adding reflection from the original image to this area, and we did the same.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f1c/c1f/2eb/f1cc1f2eb17543989f8e8c77d467f0fb.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This picture is cut into intersecting pieces 112x112, with 16 pixel overlap. </font><font style="vertical-align: inherit;">It is going to be in one big batch (and it‚Äôs really big: one picture is 3600x3600 ~ 1800 patches 112x112), it is predicted, it can be broken back into a big picture.</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d6c/516/038/d6c5160389c44c81872739d7d73cc728.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But you can aggravate. </font><font style="vertical-align: inherit;">If you reflect / rotate the original big picture, make a prediction, and then return to the original orientation, it turns out that the cutting was a little different. </font><font style="vertical-align: inherit;">And if we repeat this several times for different orientations and average (in this case, we used the geometric mean), then on the one hand the question with edge effects will be partially closed, and on the other, test time augmentation, which we have done, reduces the variance of predictions that reinforced concrete adds a little bit to accuracy.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It adds to accuracy, but it also takes considerably longer to predict. Something like five hours for the whole test. Another thing is that it can be parallelized, but at that time only Titan was at home on the computer, so it probably makes sense to use test time augmentation for such tasks closer to the final. Well, it is very expensive. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Made predictions.</font></font> Everything?  Of course not.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remains post processing. For example, you can try to remove all the predictions of houses from fast water, which we believe more than houses, and all the slow water from houses, which we believe more than this slow water. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After that Kostin's function is applied, we make our way through the submission errors, everything becomes good and pleasant, and we get some more points on LeaderBoard. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we summarize a piece of our decision about neural networks in a nutshell, it may turn out to be something like what Arthur did when he gave a </font></font><a href="https://youtu.be/yUyaYL_x4kQ"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">report</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at ML-training in Yandex </font><font style="vertical-align: inherit;">that week </font><font style="vertical-align: inherit;">:</font></font><br><br><img src="https://habrastorage.org/files/3ea/e5a/5a2/3eae5a5a20894228b89bac99f662ee9f.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the last few days, when everyone was already emotionally exhausted, and someone else was physically (closer to the end I got up for an alarm clock a night to restart the network training, predictions, or something else), I wanted, if not bread, then spectacles, and Sergei put Arthur‚Äôs script on the forum, in which he corrected bugs + added a couple of improvements, and </font></font><a href="https://www.kaggle.com/greenwolf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Kamenshchikov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> donated ready-made weights for the network for this script. And this script gave 0.42 on the Public Leaderboard, that is, at that moment something around 30 places out of 420. Freebies are a sweet word, so people started to massively launch this script, causing anger moans on the forum, though, as it turned out later , on Private Leaderboard everything was much worse, and the whole team of freeloaders flew 100 places down.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Under this case, Mikhail instantly gave birth to such a meme. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9fa/2b1/be3/9fa2b1be313a45b9a8f913c7aee2cff1.png" width="400"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is me to the fact that everyone is exhausted. </font><font style="vertical-align: inherit;">Those in the top 10 are wondering if they will stay there (dreaming of a Kaggle gold medal, which is a prerequisite for another Kaggle Master / GrandMaster level), and those in the top 3 have similar thoughts, but already about the money. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At the finish, on the Public Leaderboard at top 10:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5858 - </font></font><a href="https://www.kaggle.com/kylelee"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kyle - Alpha Goose from Malaysia</font></font></a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5569 - Quartet from </font></font><a href="https://www.kaggle.com/lopuhin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kostya Lopukhin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/alexeynoskov"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexey Noskov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/rmbashirov"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renat Bashirov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/romul0212"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ruslan Baykulov</font></font></a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5484 - </font></font><a href="https://www.kaggle.com/zfturbo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roman Soloviev</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/drn01z3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arthur Kuzin</font></font></a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5413 - </font></font><a href="https://www.kaggle.com/u1234x1234"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dmitry Tsybulevsky</font></font></a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0.5413 - Octet deepsense.io </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5345 - </font></font><a href="https://www.kaggle.com/ironbar"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ironbar - unknown Spaniard</font></font></a> </li><li> 0.5338 ‚Äî <a href="https://www.kaggle.com/confirm">Kohei ‚Äî   </a> </li><li> 0.5287 ‚Äî <a href="https://www.kaggle.com/iglovikov"></a>  <a href="https://www.kaggle.com/ceperaang"> </a> </li><li> 0.5222 ‚Äî <a href="https://www.kaggle.com/danielfg">Daniel FG ‚Äî -  </a> </li><li> 0.51725 ‚Äî <a href="https://www.kaggle.com/nekrasov"> </a> </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, in Moscow - the night of March 7, in the top 10 on the Public Leaderboard half of the teams come from our friendly chat. Everyone is waiting for three in the morning, the announcement of the results. It should be noted here that this whole monthly movement around satellite images has fueled the interest not only of the participants, but of a large number of fans who themselves did not try to plunge into the abyss of the reservoir of this engineering mud, which we not only plunged into, but also swam safely by supporting each other from not drowning. It's a little easier for me - I have a different time zone, so I screwed another model in production at work, while simultaneously watching and participating in discussions.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The seventh of March, 3 o'clock in the morning in Moscow, the end of the competition, everyone breathed in, looked at the site - but I do not want to exhale. </font><font style="vertical-align: inherit;">Everyone wants a denouement, whatever it may be, but it does not occur. </font><font style="vertical-align: inherit;">But instead, it comes from the admin polite:</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I‚Äôve been the one who kept the leader of the leaderboard. </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Little chattered, moaned and cursed, emotions poured over the edge. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A week later, a </font></font><a href="https://www.gov.uk/government/news/dstls-kaggle-competition-has-been-a-great-success"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">press release</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> came out </font><font style="vertical-align: inherit;">, with a powerful title: "Dstl's Kaggle competition has been a great success" of the British military about how they are all impressed, and told how much money they possibly spent for it (2,500k), how much they paid Kagge ( 350k for hosting competitions, 100k for prizes), and that they actively and thoroughly analyze the decisions of the winners.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And a little later these winners were announced. In the top ten, only Kyle's alpha goose remained unchanged, the rest mixed a bit, which is not surprising, considering that the Public test and Private test were so different. Arthur and Roman went up from third place to second, with Sergey and me from eighth to third, the quartet lost 3 places and went to fifth, Dmitry Tsybulevsky also lost a couple of places, but Yevgeny Nekrasov rose by three.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The people below ranked much stronger, + - 100 places light. For example, motion 129 =&gt; 19 (this is a good card), or 20 =&gt; 133 (this is bad). Such movements are a classic example of what happens when Train, Public / Private is different distributions, and either luck or the correct cross validation mechanism will help: by this I mean not what they write in books like ‚Äúdivide by 5 statified fold and everything is fine ", but about the fact that a couple of orders of magnitude more intricate. For example, there is a technique in competitive machine learning that explains how to choose the correct random seed when splitting into folds so that your models have a better ability to predict on data that your model has not yet seen.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But nevertheless, all this movement is still strange. Yes, the team of the overfitt Public LB in the hope that the accuracy of the Private model will be the same. And in theory, it had to be done that way. This is simply because in a train there are 25 pictures, and in Public it is 19% of 425, that is, 80. And 80 are much more than any hold out that you can bite off of a train. The belief that the accuracy of 80 pictures of Public will be similar to the 397 pictures in Private, if not reinforced, but quite logical.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But what happened in reality. After the end of the competition, the admins admitted that in fact only 57 images were marked up. There is a hypothesis that initially the British military had 450 pictures, they hired the Indians to mark the data, and someone on the forum even posted a link to the announcement of this work. Those managed to mark only 57 pictures. But since the competition must begin, we made a knight's move - 25 pictures in Train, 6 in Public, 26 in Private and 397 for noise. That is, the predictions in these 397 pictures we did, but they were not taken into account. Such a focus is done often enough to prevent manual marking, but usually it is announced before the start of the competition, and not after. And chat again raged, moaned and swore.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rounding out, I will say that I personally wanted to pick up knowledge about the use of neural networks for image segmentation. There are both DL articles and OpenCV tutorials, all this is embodied in the code, plus an infrastructure was written that can be used for any other segmentation task. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I have access to a team of very smart people who can and want to cut down the evil problems in machine learning. The last two years, after registering at Kaggle, I tried to persuade classmates in graduate school, colleagues at work, even co-founded the San Francisco Kagglers meetup group, but all was unsuccessful. And then the card lay down. And this is very, very important.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For the third place I was raised in the Kaggle rating right up to 67 places out of 55,000, which hopefully helps a little with finding Deep Learning oriented work, and the money, which we, by the way, have not yet received, is a pleasant bonus. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What did not work out: I have not yet found a job directly connected with DL, although I am in the process with a couple of companies. But being in the process and getting an offer is not at all the same. Two parallel competitions about fish (150k prize) and about lung cancer (million dollar prize) passed by me, that is, I also received neither knowledge nor money from these tasks. But these are all trifles, against the background of the fact that I figured out the tasks of segmentation of everything that can be done both by classical methods and through Deep Learning.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What did the British military get: they got a Proof Of Concept, what to do with satellite imagery is possible, and that competition is a cheap option to have algorithms for little money, plus a bit of PR. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As I already mentioned, they even filed </font></font><a href="https://www.datasciencechallenge.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">their own version of Kaggle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and even launched a couple of competitions there, and one of them was about identifying machines on satellite images. True, since at the level of the British Government Russian citizens are considered second-rate people, we cannot claim a prize, the Chinese, it is true, too. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How far are the proposed solutions far from production?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the form in which they are now, you probably should not be allowed into production, although if you add data, hire DL specialists, test it, tighten the heuristics, you can get more than decent results. But right now, according to our predictions, the British missiles are probably not worth suggesting, so Nigeria can sleep peacefully. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our blog post on Kaggle (for him it seems promise to give a T-shirt with the inscription Kaggle). It is in English, it has less dynamics, but a bit more technical details - a </font></font><a href="http://blog.kaggle.com/2017/05/09/dstl-satellite-imagery-competition-3rd-place-winners-interview-vladimir-sergey/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For those who did get to this part of the text and it‚Äôs still not enough, here‚Äôs a </font></font><a href="https://www.youtube.com/watch%3Fv%3D3oG_OqOpHlw%26feature%3Dyoutu.be%26t%3D58m23s"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link to a video</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from Arthur‚Äôs speech in Yandex about his solution of this task plus </font></font><a href="https://habrahabr.ru/company/avito/blog/325632/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">his post on Habr√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, a video from</font></font><a href="https://www.kaggle.com/zfturbo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Romana</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (he has professional deformation, interesting visualizations to do.)</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/rpp7ZhGb1IQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And finally, I would like to say a special thank you to all those with whom we have long and stubbornly discussed this task, which allowed us to get to the top. Noted for the better: </font></font><a href="https://www.kaggle.com/ceperaang"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sergei Mushinsky</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/drn01z3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arthur Kuzin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/lopuhin"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konstantin Lopukhin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/stromnov"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andrei Stromnov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/zfturbo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roman Solovyov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/movchan"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander Movchan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/yankov"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artem Yankov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/nizhibitsky"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Evgeny Nizhbitsky</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/resolut"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vladimir Osin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/alexeynoskov"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexey Noskov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/jgc128"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexey Romanov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/greenwolf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Kamenschikov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/rasimakhunzyanov"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rasim Akhunzyanov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/velikolepno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gleb Filatov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://www.kaggle.com/panfilov"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Egor Panfilov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Special thanks to Nastya </font></font><a href="https://habrahabr.ru/users/bauchgefuehl/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bauchgefuehl</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for editing.</font></font></div><p>Source: <a href="https://habr.com/ru/post/325096/">https://habr.com/ru/post/325096/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325084/index.html">Test items. Opinions and speculations</a></li>
<li><a href="../325088/index.html">Blog a la Habr, the choice of platform</a></li>
<li><a href="../325090/index.html">We start VMWare ESXi 6.5 under QEMU hypervisor</a></li>
<li><a href="../325092/index.html">Several arguments against Dependency Injection and Inversion of Control</a></li>
<li><a href="../325094/index.html">‚ÄúPresent documents‚Äù or what will help to recognize a passport</a></li>
<li><a href="../325098/index.html">A new record in speech recognition: the error rate of the algorithm is reduced to 5.5%</a></li>
<li><a href="../325102/index.html">GTK3 applications in a browser with https and basic auth</a></li>
<li><a href="../325104/index.html">Asterisk. Integration with amoCRM, step-by-step guide</a></li>
<li><a href="../325106/index.html">Vivaldi 1.8 - Immersion in history</a></li>
<li><a href="../325108/index.html">‚ÄúFifth Element‚Äù in R. Ecosystem. WYSIWYG Interface for Analysts</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>