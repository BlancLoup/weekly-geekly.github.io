<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CodeRush for Roslyn: Part 2 - feature overview for better code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We are releasing a new product - CodeRush for Roslyn (hereinafter CRR ). 



 The first part was about the Unit Test Runner, and in this article we wi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CodeRush for Roslyn: Part 2 - feature overview for better code</h1><div class="post__text post__text-html js-mediator-article">  We are releasing a new product - <b><a href="">CodeRush for Roslyn</a></b> (hereinafter <b>CRR</b> ). <br><br><img src="https://habrastorage.org/files/ebe/3b5/fc3/ebe3b5fc3eda4c04935fbc03639bf492.png"><br><br>  <a href="https://habrahabr.ru/company/devexpress/blog/303008/">The first part</a> was about the Unit Test Runner, and in this article we will discuss the features of CRR, which help to improve the quality of the code: <br><ul><li>  Static Analysis (Static Analysis). </li><li>  Spell Checker (Spell Checker). </li><li>  Naming Conventions (Naming Conventions). </li><li>  Analysis of code coverage by tests (Test Coverage). </li></ul><br>  All the examples in the article are made in Visual Studio 2015 on the source code of the <a href="https://github.com/OpenCover/opencover">OpenCover</a> project. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Static analysis </h3><br>  Visual Studio checks the code when typing.  For example, for this code snippet, the warning <i>The variable'testValiable 'is shown but never used (CS0168)</i> appears in the Error List. <br><br><img src="https://habrastorage.org/files/b60/f27/e3a/b60f27e3a557421989d6c08ae822fcd6.png"><br><br>  In Visual Studio 2015, the formation of such errors is implemented in special classes called <b>Roslyn Code Analyzer</b> .  Code Analyzer is, to put it simply, part of the implementation of the Visitor pattern for Roslyn Syntax Tree.  But if you search in MSDN by error code <i>CS0168</i> , there is this <a href="https://msdn.microsoft.com/en-us/library/tf85t6e4.aspx">article</a> , in it <i>CS0168</i> is called ‚ÄúCompiler Warning‚Äù, and not <b>Analyzer</b> or <b>Diagnostic</b> , as is customary in Roslyn.  This is due to the fact that <i>CS0168</i> appeared at the time when Roslyn was not yet used in Visual Studio, and this error was detected at the stage of partial compilation of the code.  We will not go further into the details, but it is useful to know that in Visual Studio 2015 almost all the messages in the Error List are generated using <b>Roslyn Code Analyzers</b> .  Read more about them <a href="https://github.com/dotnet/roslyn/wiki/Getting-Started-C%2523-Syntax-Analysis">here</a> .  A full list of standard diagnostics for .NET can be found <a href="https://msdn.microsoft.com/en-us/library/ee1hzekz.aspx">here</a> .  CRR adds the following diagnostics to this set: <br><br><img src="https://habrastorage.org/files/1c9/840/18a/1c984018a553463c97c1549db8ccfae8.png"><br><br>  This screenshot is made from the standard studio ruleset editor, i.e.  if you are using a studio code analyzer, just add the CRR diagnostics to your ruleset. <br><br>  Check the <b>OpenCover</b> project using standard Visual Studio diagnostics.  To do this, open the properties of the solution and set the settings as shown in the picture. <br><img src="https://habrastorage.org/files/ffb/be0/f18/ffbbe0f1801c42c5bc116eb38c0361c4.png"><br><br>  And, as a result, we get about a thousand messages in the Error List. <br><br><img src="https://habrastorage.org/files/d8b/d3b/2dc/d8bd3b2dc1674f35b9352c8d1e296887.png"><br><br>  Thousands of messages are not the limit, because not the largest set of diagnostics was used.  However, it is not the number of diagnostics that is important, but their quality.  To attract the attention of the developer is only when it is really necessary. <br>  Let's try to analyze <b>OpenCover</b> using our diagnostics.  There are three ways to do this: <br><ul><li>  Start the scan manually. </li><li>  Check in background. </li><li>  Check from the console. </li></ul><br><br><h4>  Manual scan run </h4><br>  If the project is large, static analysis in the background may interfere with the normal operation of Visual Studio.  This is due to the fact that diagnostics expand syntactic trees, and in some situations this leads to significant memory consumption.  After checking, full syntax trees are no longer needed, and memory is released.  But this creates memory traffic, and leads to the fact that most of the computing resources will be spent on garbage collection.  Manual scan mode will make predictable moments when Visual Studio is slow.  To run a static analysis in this mode, you need to click on the <b>Refresh</b> button in the <b>Code Issues</b> window (the <b>Refresh</b> button is the first on the left). <br><br><img src="https://habrastorage.org/files/b3a/70d/018/b3a70d01869547a0bcbec69a40ea4ad8.png"><br><br>  Also, manual start of diagnostics is provided <a href="https://msdn.microsoft.com/en-us/library/bb907198.aspx">in the Visual Studio interface</a> .  But in this case, you will have to add the CRR diagnostics to the ruleset as described <a href="https://msdn.microsoft.com/en-us/library/dd264949.aspx">here</a> . <br><br><h4>  Background check </h4><br><br>  Visual Studio has a standard mechanism for performing static code analysis in the background.  This mechanism is described <a href="https://msdn.microsoft.com/en-us/library/mt709421.aspx">here</a> .  As already mentioned, checking in the background on large projects can cause studio freezes.  Turn with caution.  In order for CRR diagnostics to be performed in this mode, you must set the <b>Include CodeRush diagnostics</b> option <b>into the VisualStudio background analysis</b> . <br><br><img src="https://habrastorage.org/files/b55/ebe/5e0/b55ebe5e0e394e4e8f2ef730eb45bf83.png"><br><br><h4>  Check from console </h4><br>  CRR has an executable file that can be run from the command line on the developer‚Äôs machine or on the build server.  The file is called <i>DevExpress.StaticCodeAnalysis.exe</i> .  You can find it in the plugin directory (you can open it from <b>CodeRush</b> | <b>Support</b> | <b>Extension Folder ...</b> ).  The file is a fully autonomous console version of CRR diagnostics.  No additional files are required for its operation.  Because of this, it is easily integrated into any assembly system.  Just copy <i>DevExpress.StaticCodeAnalysis.exe</i> to the build server and enter a simple call into the build script: <br> <code>DevExpress.StaticCodeAnalysis.exe EditorsDemos\EditorsSamples_CS.sln results.txt</code> <br>  As a result, a results report will be generated in the <i>results.txt</i> . <br><br><h3>  Test results </h3><br>  We do not pursue a number of diagnostics, but only implement really useful ones, paying a lot of attention to false positives.  The result of the <b>OpenCover</b> source <b>check is</b> shown below. <br><br><img src="https://habrastorage.org/files/f4e/437/650/f4e43765024345c5a5224424e76d7b69.png"><br><br>  There were only a couple of strange places: <br><br><img src="https://habrastorage.org/files/7c8/912/61e/7c891261e5814fc99e4155cd6b0e7541.png"><br><br>  In this section of the diagnostic code, it is found that <b>CurrentCulture</b> and <b>CurrentUICulture are</b> assigned twice.  Diagnostics worked correctly, but apparently, this is done in order to get the text exception in English. <br>  The second strange place was found in the tests. <br><br><img src="https://habrastorage.org/files/ca9/7a8/5af/ca97a85afc0b464bb1766e4c42b54b18.png"><br><br>  The <b>result</b> variable is assigned twice.  Diagnostics worked correctly, although the author of the test in the comments wrote that it was intended.  Excellent result - no false positives. <br><br><h3>  Checking naming and typos in titles </h3><br>  In CRR, naming and spell checking are also implemented as <b>Roslyn Code Analyzer</b> .  These checks are disabled by default because configuration is required before using them.  For example, if you enable without configuration on an <b>OpenCover</b> project, there will be a huge number of naming rule violation messages in the Error List.  To configure the naming rules there is a page in <b>Options</b> .  You can enable and configure naming checks for types, namespaces, properties, and so on. <br><br><img src="https://habrastorage.org/files/049/6d8/bdd/0496d8bdd3984df8a7963ae80fe7748c.png"><br><br>  The <a href="https://documentation.devexpress.com/">spell</a> checker is implemented on the <a href="https://documentation.devexpress.com/">DevExpress Spellchecker core</a> .  Typos go to the Error List, and are also highlighted in the code by a wavy line.  In the context menu, spellchecker creates a list of proposed replacements. <br><br><img src="https://habrastorage.org/files/ebe/3b5/fc3/ebe3b5fc3eda4c04935fbc03639bf492.png"><br><br><h3>  Checking code coverage tests </h3><br>  In addition to diagnostics, there is another way to improve your code.  This is code coverage tests.  In the <a href="https://habrahabr.ru/company/devexpress/blog/303008/">previous article there</a> was an overview of the capabilities of our <b>Test Runner</b> , but we didn‚Äôt tell about the launch of tests with coverage analysis.  In <b>Test Runner</b> there is a test run mode in which the code is instrumented.  In this mode, the test run takes a longer time, so separate buttons are provided for running tests with coverage analysis. <br><br><img src="https://habrastorage.org/files/b7a/3ef/563/b7a3ef563d904895ac49c03e796b093e.png"><br><br>  Coverage can be viewed in the <b>Code Coverage Tool Window</b> .  In this screenshot, you can see that the conditions branch in the second cycle is not covered by the else link. <br><br><img src="https://habrastorage.org/files/866/b6a/5a0/866b6a5a00514cb1ae24630b5954bb31.png"><br><br>  According to the analysis of coverage, new tests are usually written that increase the percentage of coverage.  It should be remembered that 100% code coverage of tests does not guarantee the absence of problems in it.  For example, this code snippet has a high percentage of coverage. <br><br><img src="https://habrastorage.org/files/ae2/6ad/80a/ae26ad80a3f74b3f94a2f6a8c961c5a0.png"><br><br>  But among the tests there is no one that checks conditional branching when the condition is triggered. <br> <code>if(_domain == null) return;</code> <br>  And if the coverage was considered not by operators, but by the branches of conditional operators, then the figure would be different. <br><br>  CodeRush for Roslyn is a new handy tool that helps to write the correct code and fix problems in the existing one.  You can download it in the <a href="https://visualstudiogallery.msdn.microsoft.com/8a8390ae-1f71-4659-9d8d-5dd56fd8a72e">Visual Studio Gallery</a> . <br><br>  <a href="https://habrahabr.ru/company/devexpress/blog/307346/">In the next part</a> , consider the possibilities of CRR to navigate through the code. </div><p>Source: <a href="https://habr.com/ru/post/303376/">https://habr.com/ru/post/303376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../303366/index.html">REST API on Symfony, FOSRestBundle + GlavwebDatagridBundle</a></li>
<li><a href="../303368/index.html">We write a serializer for a network game in C ++ 11</a></li>
<li><a href="../303370/index.html">Tony Robbins seminar review ‚ÄúFree your inner strength‚Äù. Day 4. The power of clean energy (part 2)</a></li>
<li><a href="../303372/index.html">Connect MATLAB to Wolfram Mathematica</a></li>
<li><a href="../303374/index.html">2-3-tree. Naive implementation</a></li>
<li><a href="../303378/index.html">Determine the Phantom bots</a></li>
<li><a href="../303380/index.html">Not Pascal alone: ‚Äã‚Äãwhat did the winner of the computer "Nobel Prize" Niklaus Wirth do for the modern world?</a></li>
<li><a href="../303382/index.html">From blacklists to intelligent call management</a></li>
<li><a href="../303386/index.html">inter-AS Option AB (D)</a></li>
<li><a href="../303388/index.html">The harsh web development market in Russia or why do we need databases, persistent storage and FTP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>