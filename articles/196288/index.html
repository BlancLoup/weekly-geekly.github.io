<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JavaScript API Yandex.Maps - version 2.1-beta - new design and new features</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have released the beta version of the Yandex.Maps API 2.1 . Its main feature is a complete redesign of the map interface. Moreover, the changes aff...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JavaScript API Yandex.Maps - version 2.1-beta - new design and new features</h1><div class="post__text post__text-html js-mediator-article">  We have released the <a href="http://api.yandex.ru/maps/">beta version of the Yandex.Maps API 2.1</a> .  Its main feature is a complete redesign of the map interface.  Moreover, the changes affected not only the appearance, but also the behavior of the map controls.  Since it was initially clear that backwards-compatibility failures cannot be avoided, we also made architectural changes that were necessary to improve the work of the API (about them closer to the end of the post). <br> <a href="http://habrahabr.ru/company/yandex/blog/196288/"><img src="https://habrastorage.org/getpro/habr/post_images/28e/261/f72/28e261f7228ebce53665246a049d9c50.png" alt="image"></a> <br>  As for the design, it was important for us that the interface looked equally well on devices and screens of different sizes.  One of the main difficulties is that we never know in advance what the service or website with embedded maps will look like.  Therefore, when developing a redesign, we had to try to provide a maximum of options. <br><br>  To solve our problems, we decided to implement an adaptive interface design in the new version.  At the Yet Another Conference, <a href="http://habrahabr.ru/users/madhare/" class="user_link">madhare</a> designer and <a href="http://habrahabr.ru/users/madhare/" class="user_link">zloylos</a> developer gave a talk about <a href="http://tech.yandex.ru/events/yac/2013/talks/1113/">why we needed adaptability and how exactly we implemented it in the API</a> .  In this post, I will describe the background and the concept of our decisions, talk about what's new in version 2.1-beta, and what else will change to release 2.1. <br><a name="habracut"></a><br><h4>  Why do we think about design? </h4><br>  After the release of version 2.0, we already wrote a <a href="http://habrahabr.ru/company/yandex/blog/142310/">post</a> in which we talked about our approach to API development.  The essence of the concept is that we make the product not only for developers, but also for those who will enjoy the results of their work.  If a person is comfortable and pleasant to use our cards, and he will require them from his favorite services - this will be a real success.  At the same time, developers should also be easy and pleasant to satisfy the desires of users, which means we should simplify their work with the API to the maximum.  With such thoughts, we began work on version 2.0, and the new 2.1-beta was a logical continuation of the same concept. <br><br><h4>  Study </h4><br>  Observing the installation of our API and analyzing the cases of using maps, we identified two main types of developers: <br><ul><li>  They solve typical tasks, do not want to spend a lot of time, prefer ready-made Yandex interfaces.  About 90%. </li><li>  Solve non-standard problems or prefer even typical tasks to solve in their own way.  They are not suitable standard controls.  Need serious customization of maps.  It is logical that this is the remaining 10%. </li></ul><br>  So, we had to do well first, leaving second room for maneuver.  Those.  prepare a set of ready-made solutions that themselves control the appearance of the final map, i.e.  ‚ÄúThey do well‚Äù, but at the same time, if desired, they can be customized for their own needs.  The task of the maximum was to maintain a balance. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/713/713/8a0/7137138a0d5982ce57f569e45014c888.png" alt="image"><br><br>  Having decided on the audience, we began to study use cases.  It turned out that in our case, the main meaning, oddly enough, size.  We got 3 + 1 options: small, medium, large map and mobile sites. <br><br><h4>  Draw design for maps of different sizes </h4><br>  The worst case is small cards.  It seems that because of the small size it is worth removing all the controls of the card, but I also do not want to lose functionality.  Therefore, we made a new set of controls especially for small cards: <br><img src="https://habrastorage.org/getpro/habr/post_images/fd9/4db/b8c/fd94dbb8cc71a17dc77ac50950755c5d.png" alt="image"><br><br>  A new control has also been added - ‚Äúexpand the map to full screen‚Äù.  It saves space on the site by placing a small card, while the end user is left with the opportunity to see a large map.  All the necessary behavior of the card is already programmed on the API side.  In general, the idea of ‚Äã‚Äãthis button was born when we thought about a solution for mobile devices.  An acceptable size card on the desktop can become completely useless on your mobile.  Fulskrin solves this problem: <br><img src="https://habrastorage.org/getpro/habr/post_images/998/2ce/e24/9982cee240bd48398ca9eaac75090abd.png" alt="image"><br><br>  In addition, the balun design has changed for small-sized maps.  Now on small maps and mobile devices, the standard balloon is replaced with a die at the bottom of the screen.  This allows you to save more information card for users.  If desired, this option can be disabled. <br><img src="https://habrastorage.org/getpro/habr/post_images/fb8/13e/316/fb813e3163e6065166e8ee8c509b7743.png" alt="image"><br><br>  With average cards, everything is much simpler.  Since there is where to turn: <br><img src="https://habrastorage.org/getpro/habr/post_images/a57/8f6/1b3/a578f61b3dd6452671fee3935aefa503.png" alt="image"><br><br>  As with the big cards: <br><img src="https://habrastorage.org/getpro/habr/post_images/a88/3f4/02f/a883f402ffdc42b19c573aec19553fbf.png" alt="image"><br><br>  In order to simplify the work of developers as much as possible when selecting map controls, we made three ready sets for different map sizes. <br><pre><code class="javascript hljs">map.controls.add(<span class="hljs-string"><span class="hljs-string">'default'</span></span>);</code> </pre> <br>  List of available keys: <br>  smallMapDefaultSet // for small <br>  mediumMapDefaultSet // for normal <br>  largeMapDefaultSet // for large <br><br>  Of course, you can still specify the necessary controls by yourself. <br><pre> <code class="javascript hljs">myMap.controls .add(<span class="hljs-string"><span class="hljs-string">'trafficControl'</span></span>) <span class="hljs-comment"><span class="hljs-comment">//  .add('searchControl') //  .add('zoomControl') // - .add('typeSelector') //  .add('geolocationControl') //  .add('fullscreenControl') //  ‚Ä¶</span></span></code> </pre><br><br><h4>  Adaptability </h4><br>  It is not enough just to draw an interface design for different card sizes.  After all, a page with a map can be opened on different screens.  That is why it was decided to implement the adaptive behavior of the card interfaces.  Different interface elements are rebuilt and change their size depending on the actual size of the map container. <br><img src="https://habrastorage.org/getpro/habr/post_images/61c/498/9ef/61c4989efad0de6d0816d68db7661242.png" alt="image"><br><br>  We implemented adaptive behavior through <a href="">control.Manager</a> .  You can also set it for those buttons and lists that you create yourself: <br><img src="https://habrastorage.org/getpro/habr/post_images/a94/849/e50/a94849e5056c27add99f59fc28ca18b3.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/ac9/b07/d0a/ac9b07d0a6bcfad87651d6092640ff0e.png" alt="image"><br><br><h4>  Acceleration and optimization work </h4><br>  A geoobject is the main entity on the map.  For such a title he has to pay a rather complicated and cumbersome structure.  The first iteration of work on geo-objects was to distribute the load during their creation.  We tried to bring all the preparatory operations from the constructor of the geoobject to the places where they really become necessary.  It gave very good results.  Also in some places we made lazy initialization of entities using _defineGetter_ and defineProperty (_defineGetter_, by the way, a bit faster).  We have reduced the number of subscriptions to geo-objects events within our system of events.  Partially helped by accepting a subscription directly to a group of geo-objects with the subsequent definition in the handler of the target object.  Here you have to admit that acceleration can only be felt on dom and canvas tags, new svg tags should be modified (why we call it beta? Because it beta then nothing;) <br><br>  While working, we had time for a small cleanup in the code, according to its results we will give microvirculation: <br>  Microdraw 1. When transferring a handler function, it is much more advantageous to transfer the function separately, the context separately.  If your hands are itching to do a bind right away, consider whether you can afford it. <br>  Microdraw 2. Reduce the number of intermediate arrays, objects, and anonymous functions.  They are not always well cleaned by garbage collector. <br><br><h4>  Other changes </h4><br><ol><li>  In API 2.0, to locate by IP or using the Geolocation API, developers have to independently use the necessary methods and process the result.  In version 2.1, simply add a new standard control: <br><pre> <code class="javascript hljs">control.GeolocationControl(parameters)</code> </pre>  The user location mechanism used in the API has also been improved.  Now the most accurate result is automatically selected from browser geolocation and geolocation by IP address. </li><li>  Standard labels in the API were redrawn in SVG, which means that they can be given arbitrary colors. </li><li>  The package system in version 2.1 will be eliminated.  APIs are modified in such a way as to maximize the load on the components of the API on demand, for which most of the mappings were transferred to asynchronous mode.  Work is still underway. </li><li>  For such a massive update, we had to sacrifice backward compatibility with version 2.0.  Also, for the official release of version 2.1, backward compatibility for some parts of the beta version may break: <br><ul><li>  The clusteriser will change significantly. </li><li>  Map.action.Manager will be rewritten. </li><li>  Promises will be implemented according <a href="http://dom.spec.whatwg.org/">to the DOM specification</a> . </li><li>  Some of the objects in the ymaps namespace will be put into on-demand download. </li></ul></li><li>  After exiting beta version 2.1, the versioning system will change.  Before the official release, you can connect the latest version of the API only via the link api-maps.yandex.ru/2.1-dev. </li></ol><br>  The API 2.1-beta API reference guide is <a href="">published on the API website</a> .  Examples can be found in the <a href="http://api.yandex.ru/maps/jsbox/placemark_balloon">sandbox</a> .  And also the <a href="http://beta.maps.yandex.ru/">beta version of Yandex.Map is</a> already working on the new API. </div><p>Source: <a href="https://habr.com/ru/post/196288/">https://habr.com/ru/post/196288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../196276/index.html">History of Apple operating systems. Part 2. Macintosh Takeoff</a></li>
<li><a href="../196278/index.html">Community reaction played a role - Yahoo rewarded its reward program for found vulnerabilities</a></li>
<li><a href="../196280/index.html">How to improve the quality of the code</a></li>
<li><a href="../196282/index.html">About space kindness and Chelyabinsk meteorite</a></li>
<li><a href="../196286/index.html">Ukrainian crowdfunding or laser pointer and blaster duel</a></li>
<li><a href="../196290/index.html">Habr-foresight: 6,000,000 tons of wet kittens in space</a></li>
<li><a href="../196292/index.html">Who will get the Nobel Prize for the Higgs?</a></li>
<li><a href="../196296/index.html">More komitov, good and different</a></li>
<li><a href="../196298/index.html">Denial of service and the potential execution of arbitrary code in most versions of Ruby</a></li>
<li><a href="../196300/index.html">Adobe hacked, 3 million accounts compromised</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>