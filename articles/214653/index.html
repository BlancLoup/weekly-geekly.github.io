<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As we Russian firms investigated</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SKB Kontur has been a federal software developer since 1988 . You may have heard of Contour as a company developing products for small and medium busi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As we Russian firms investigated</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/8ce/3ca/15f/8ce3ca15ff2994d683e5ba0885d9ba2e.png" align="right"><br><br>  <s>SKB Kontur has been a federal software developer since 1988</s> .  You may have heard of Contour as a company developing products for small and medium businesses.  But our unit is doing something completely different.  Or, to be more precise, this approach is on the other side.  We are called ‚ÄúContour Labs‚Äù and we are engaged in scientific and research projects. <br><br>  What do you do if you have a few dozen gigabytes of data?  We first of all try to draw this data in some way - it seems that links that were not directly visible can appear in the visual display. <br><a name="habracut"></a><br>  This is exactly what we did with the data on more than 20 million legal entities officially registered in Russia.  <a href="http://ru.wikipedia.org/wiki/%25D0%2595%25D0%25B4%25D0%25B8%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B3%25D0%25BE%25D1%2581%25D1%2583%25D0%25B4%25D0%25B0%25D1%2580%25D1%2581%25D1%2582%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D1%2580%25D0%25B5%25D0%25B5%25D1%2581%25D1%2582%25D1%2580_%25D1%258E%25D1%2580%25D0%25B8%25D0%25B4%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D1%2585_%25D0%25BB%25D0%25B8%25D1%2586">The</a> Uniform State Register of Legal Entities provides such information to everyone (and Kontur based on it even made its <a href="https://focus.kontur.ru/">Kontur.Focus</a> service).  For each company and individual entrepreneur, we know a whole mountain of information: the date of registration, the founders (including foreign ones), their shares in preparing the initial capital, several types of names (full, abbreviated, English), addresses, telephones ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The most interesting thing that we found in this heap of unstructured data is a different kind of communication between firms.  To begin with, we admired connections showing who organized whom.  This seemed to us a little, and we tied the company, having the same person in the directors.  We seriously hooked on this case, and a week later we already had connections between firms with the same legal address or the same phone number. <br><br>  Immediately the question arose: how best to study firms and their relationships with others?  How to find companies that have the same address with those established by Gazprom (and there are more than a hundred ‚Äúchildren‚Äù)?  Of course, draw!  Since firms with connections between them form a graph, we first paid attention to graph visualizers. <br><br>  If you have ever engaged in visualization of graphs, then you know the limitations of the corresponding algorithms and tools.  At best, we are talking about tens of thousands of vertices, a maximum of about a hundred, and then this is likely to be completely not in real time.  And we had tens of millions of peaks, even more edges, and even meta-information about the types of connections!  We had to do something, and we decided to realize the opportunity to look at our graph in small pieces, because at each moment we are only interested in the neighborhood of a particular company. <br><br>  We took Gephi (this is a program for drawing graphs and not only, details can be found on <a href="https://gephi.org/">their website</a> ) and wrote a plugin for it that allows us to view certain parts of our large graph ‚Äúunder a magnifying glass‚Äù.  On the way, we also made a pull request with fix bugs in the plugin for Gephi, which did not allow us to transfer Russian company names over the network.  At each moment of time, we looked only at a small piece, while having the opportunity to add to the consideration of some company or even everyone with whom it is connected by connections. <br><br>  Having played with the plugin, we realized that this was not enough - it was inconvenient to solve the problems of research of firms and their surroundings, using it.  Then we carefully consulted and decided that it would be most convenient to work with such a graph on touch devices.  Just imagine - an elegant tap on the screen, and you are already studying the firms associated with the chosen one.  Zoom in and out with standard gestures.  Dynamic addition of new companies and links to the screen in real time.  And all this on the tablet, so that the discovered interesting things can be shown on the road or at a meeting. <br><br>  So, we decided to develop an application for Aipad, which will pick up information about the neighborhood of companies from the server, place it on the tablet screen and provide the user with a convenient interface for working with this data. <br><br>  Immediately, many interesting problems arose.  We will tell about all in order. <br><br><h4>  Task 1. Server </h4><br>  The server part of our application is simple and complex at the same time.  It is simple, because it does not need to do almost anything, just store and give information about firms adjacent to a given one, and also give various meta-information about companies and connections, such as the founders of the company, creation date, addresses, phone numbers and other other, other.  Difficult, because this simple task needs to be done quickly and efficiently, because you want to process a lot of clients in real time, and do it at the cost of a small amount of resources. <br><br>  We decided to abandon the use of large and monstrous databases, and write something of our own - small and fast.  We took C ++, added some Python, and here we have what we needed - a fast and easily scalable server for storing companies and the relationships between them.  All data is actually stored on disk, only indexes are loaded into RAM for quick access, which makes it possible, if necessary, to start the server on a regular machine of any developer or user. <br><br>  Since in our heads all the time there existed the idea of ‚Äã‚Äãa variety of clients for different platforms, we chose HTTP as the transport, and JSON as the format of the transmitted data.  This slows down the speed of data transmission and processing, but makes it much more convenient to work with the service on different clients. <br><br><h4>  Task 2. Convenient interface </h4><br>  Few people decide to make an application that shows only a graph on the screen.  Of the similar tablet applications we found, Wikiweb and Solyaris turned out to be the most similar.  But none of them solved problems similar to those that confronted us.  How to show a mountain of textual information about a particular company at the request of the user?  What to do with the environment, if it has more than five hundred firms?  And if more than a thousand? <br><br>  We tried several different interface solutions.  Some of us were discarded at once, some were given to ordinary people.  The key feature that we have identified for ourselves at these stages is the minimization of textual information on the main screen, which contains a graph directly with companies.  Unnecessary in most cases, detailed information should be hidden by default, and all controls should be made visual and visual. <br><br>  We decided to do the following with the problem of a large number of neighboring firms: in the case of an attempt to show an exorbitantly large neighborhood, we will display a user-friendly search in which all neighboring firms are divided into groups according to some ‚Äúimportance‚Äù of the firm.  The ‚Äúimportance‚Äù in this case was the size of the firms, the number of connections known to it. <br><br>  After drawing different versions of the interfaces, something like this came out: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/69c/016/3c9/69c0163c9f6f7f0eaa6d1456b7685080.png"><br><br><h4>  Task 3. Client application </h4><br>  There were several requirements for the application that would draw a picture with links between firms.  But one of them was crucial - the application should fly.  In every sense of the word - it should work quickly, and all changes in the displayed structure should occur smoothly.  Therefore, when developing an application for iPad, we used only native code written in Objective-C and C ++.  <a href="http://www.cocos2d-x.org/">Cocos2D</a> is responsible for drawing, he copes with it well, so there is nothing interesting here. <br><br>  The most interesting thing is, as always, under the hood.  As we have already discussed, what is displayed on the screen at any given moment in time is nothing but an ordinary graph, with its vertices and edges.  In order for the user of the application to have at least something clear among the tens and hundreds of vertices currently displayed, it is necessary to solve the problem of a good <a href="http://en.wikipedia.org/wiki/Graph_drawing">graph image on a plane</a> .  It is clear that it is impossible to achieve an ideal in solving this problem (it simply does not exist), but we tried :) <br><br>  To solve the problem of graph layout on the plane, it was decided to use the Force Atlas family of algorithms and, in particular, its modifications developed by the French scientist Mathieu Jacomy.  The idea of ‚Äã‚Äãthe Force Atlas algorithms is that in place of each vertex of our graph, we place a small weight of a corresponding weight, and replace all the edges of the graph with springs with a certain coefficient of elasticity.  The whole system comes into action, and after a while it stops.  The resulting process is recorded and can be shown in a somewhat slow form for beautiful animation of the gradual change in the position of the vertices in the image. <br><br>  We found implementations of similar algorithms in Java and JavaScript, but we needed a really very fast code.  A Java implementation port in C ++ was also found, but the number of dependencies in it was incredibly large and scared us.  The iPad doesn‚Äôt have much power, especially compared to desktop computers, so we needed something really lightweight. <br><br>  By adding a week to C ++, mixing it all with Objective-C, we got our implementation of Force Atlas, which suited us for speed and flexibility.  She remained flexibly customizable, but at the same time she managed to display hundreds of vertices on the screen of the tablet in real time. <br><br>  Here are some screenshots of what we got (on click - full-size versions): <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/cb6/f2f/ac1/cb6f2fac1dcc75a1f6f60ee758f2b040.png" width="400"></a> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/674/1cf/36c/6741cf36ce983da1d0acf7e4c0a65297.png" width="400"></a> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/f8f/fb6/9dd/f8ffb69ddf7ccef194f9718a372f4075.png" width="400"></a> <br><br><h4>  What have we got? </h4><br>  We would very much like to show the public the final version of the application.  But, unfortunately, we cannot do this, since the data used for it constitute the commercial idea of ‚Äã‚ÄãContour. Focus.  In order to show the beauty of the dynamic layout of the graph on a plane, we sketched an application on our knees, operating with data about actors and movies.  We took these data from the well-known IMDB database by downloading them from <a href="">one of their FTP servers</a> . <br><br>  Actors and films became the tops of the count, we laid a rib if the actor played in this film.  In order not to clutter up the data (as well as to get rid of films for adults), we threw out from the base all the films with a rating strictly below 7. You can download the resulting app for the iPad. <br><br>  For a snack, a video of the process of studying the graph on the tablet, recorded from the emulator, with the disclosure of the surroundings and the dynamic loading of new firms.  Watch, of course, in the best quality. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/LBoYPrAoR9U%3Ffeature%3Doembed&amp;xid=17259,15700019,15700186,15700191,15700253&amp;usg=ALkJrhgCjha7evxDPF8fLKa5gdQSGx7mRg" frameborder="0" allowfullscreen=""></iframe><br><br>  We will be very glad to any feedback of all interested readers :-) </div><p>Source: <a href="https://habr.com/ru/post/214653/">https://habr.com/ru/post/214653/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../214643/index.html">Aggregates of multidimensional OLAP cubes in RAM</a></li>
<li><a href="../214645/index.html">Magento Enterprise: What is Full Page Cache and why is it needed?</a></li>
<li><a href="../214647/index.html">PHP and various types of NoSQL</a></li>
<li><a href="../214649/index.html">Up! Plus 2. Overview: unpacking, calibration, analysis and first print</a></li>
<li><a href="../214651/index.html">Testing on the 1C: Enterprise 8 platform</a></li>
<li><a href="../214655/index.html">Sports robotics: an interview with a member of RobotChallenge 2014</a></li>
<li><a href="../214657/index.html">Facebook is going to cover Africa with a network of "atmospheric satellites"</a></li>
<li><a href="../214663/index.html">The logic of thinking. Part 5. Waves of the brain</a></li>
<li><a href="../214665/index.html">Business card on the Arduino with Tetris on board</a></li>
<li><a href="../214667/index.html">CombGuid. Generating SQL-Friendly Guid Server Values ‚Äã‚Äãin .net Applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>