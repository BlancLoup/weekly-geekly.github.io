<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>[SSD only] Activating TRIM on Mac OS Lion / Mountain Lion 10.8</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear habrazhiteli. 

 This translation is intended primarily for those who already use the SSD drive and MacOS Lion. Personally, I‚Äôve been happ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>[SSD only] Activating TRIM on Mac OS Lion / Mountain Lion 10.8</h1><div class="post__text post__text-html js-mediator-article">  Hello, dear habrazhiteli. <br><br>  This translation is intended primarily for those who already use the SSD drive and MacOS Lion.  Personally, I‚Äôve been happy for a year with the performance of the Intel X-25M SSD and the absence of the <i>death carousel</i> <img src="https://habrastorage.org/storage2/2cd/ef5/42e/2cdef542e98dbcc485e87acf2d560171.png">  I wish you all the best. <br><br>  Until today, I was confident that my SSD works at 100% of its capabilities.  But it was not there!  If you bought your apple computer without an SSD, that is, it left the store with a regular HDD, then the <a href="http://www.google.ru/search%3Fclient%3Dsafari%26rls%3Den%26q%3D%25D1%2587%25D1%2582%25D0%25BE%2B%25D1%2582%25D0%25B0%25D0%25BA%25D0%25BE%25D0%25B5%2BTRIM%26ie%3DUTF-8%26oe%3DUTF-8%26redir_esc%3D%26ei%3DGR2tT7mNHYif-QaP2sywDA">TRIM</a> promised in Lev will <b>be inactive</b> , as it turned out, only computers equipped with the default SSD drive have this function by default.  The problem, as you understand, <s>in the marketing of the company</s> , <s>causing questions,</s> has software roots, not iron.  And for this Apple trick, Mr. Grant Pennel offers his threaded bolt. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  Before proceeding directly to the translation, I suggest you check whether the TRIM works for you or not: <br><img src="https://habrastorage.org/storage2/bd4/dbf/c44/bd4dbfc44224aa56ff03fb73a7df6bb9.png"><br><br>  If your SSD has a SandForce 2 *** controller, then TRIM is not recommended for you.  As they say, the whole point is that the SF2 *** controller processes the information deleted by the user in its own special way and generally stores data on a disk as one large archive ... the details of its work and the resulting problems are described <a href="https://discussions.apple.com/message/15649687">here</a> .  The SF2 *** controller is equipped with a fairly wide range of devices, including the popular OCZ Vertex 3, so be sure to look at the <a href="http://en.wikipedia.org/wiki/SandForce">list of SSDs equipped with the SandForce controller</a> and watch carefully whether your disk is in this list, if yes, then in the Controller column determine the sequence number , if it starts at 2, then further operations to enable TRIM can only harm.  For all other SSD users, this article will be useful: <br><br>  <b>Do not use the <a href="http://habrahabr.ru/post/116366/">TRIM ENABLER</a> program <a href="http://habrahabr.ru/post/116366/">(1.1 or 1.2)</a> to activate TRIM in Leo.</b> <br><br>  After a small check of this application, I found that instead of the usual patch, it replaces the most important system file at the kernel level of the system.  This means that if you used TRIM Enabler, then it replaced the file with a mass of threads stretching from it all over MacOS (especially true for those who moved to Leo from MacOS Snow Leopard 10.6.8).  Is that bad.  Very bad.  Along with the fact that TRIM really turns on, there is a real danger of facing a car of problems, ranging from the kernel panic and ending with input / output (I / O) problems, and that‚Äôs when the rotating and intimidating beach ball hits you. <img src="https://habrastorage.org/storage2/9be/550/c58/9be550c58d2be1718391154d94c85a84.png"><br><br>  In the process of discussion with the developer of this application (Oskar Groth), I heard only accusations through comments on his blog that they were <i>doing trolling and gaining fear</i> (although in fact I tried to offer an alternative, which is presented below).  Probably - in the next version of TRIM Enabler - the file will be patched correctly, instead of directly replacing it, however, this update has not yet occurred. <br><br>  So, here is the right way to enable TRIM support.  To do this, run the following commands in the terminal: <br><br>  <b>1. First, make a backup of the file that we will patch:</b> <br><blockquote><font color="black"><code>sudo cp /System/Library/Extensions/IOAHCIFamily.kext/Contents/PlugIns/IOAHCIBlockStorage.kext/Contents/MacOS/IOAHCIBlockStorage /System/Library/Extensions/IOAHCIFamily.kext/Contents/PlugIns/IOAHCIBlockStorage.kext/Contents/MacOS/IOAHCIBlockStorage.original</code></font> </blockquote> <br>  <b>2. Filing the file, thereby activating TRIM support:</b> <br><blockquote> <font color="black"><code>sudo perl -pi -e 's|(\x52\x6F\x74\x61\x74\x69\x6F\x6E\x61\x6C\x00{1,20})[^\x00]{9}(\x00{1,20}\x51)|$1\x00\x00\x00\x00\x00\x00\x00\x00\x00$2|sg' /System/Library/Extensions/IOAHCIFamily.kext/Contents/PlugIns/IOAHCIBlockStorage.kext/Contents/MacOS/IOAHCIBlockStorage</code></font> </blockquote> <br>  <b>3. Clean the cache:</b> <br><blockquote> <font color="black"><code>sudo kextcache -system-prelinked-kernel <br> sudo kextcache -system-caches</code></font> </blockquote> <br>  <b>Now reboot!</b> <br><br><h4>  If you suddenly need to disable TRIM support: </h4><br>  <b>1. Shutdown:</b> <br><blockquote> <font color="black"><code>sudo perl -pi -e 's|(\x52\x6F\x74\x61\x74\x69\x6F\x6E\x61\x6C\x00).{9}(\x00\x51)|$1\x41\x50\x50\x4C\x45\x20\x53\x53\x44$2|sg' /System/Library/Extensions/IOAHCIFamily.kext/Contents/PlugIns/IOAHCIBlockStorage.kext/Contents/MacOS/IOAHCIBlockStorage <br> <br> sudo kextcache -system-prelinked-kernel <br> <br> sudo kextcache -system-caches</code></font> </blockquote> <br>  <b>2. Restore a file from backup:</b> <br><blockquote> <font color="black"><code>sudo cp /System/Library/Extensions/IOAHCIFamily.kext/Contents/PlugIns/IOAHCIBlockStorage.kext/Contents/MacOS/IOAHCIBlockStorage.original /System/Library/Extensions/IOAHCIFamily.kext/Contents/PlugIns/IOAHCIBlockStorage.kext/Contents/MacOS/IOAHCIBlockStorage</code></font> </blockquote> <br><br>  All that this patch does is replace the phrase ‚ÄúAPPLE SSD‚Äù with zeros in the IOAHCIBlockStorage file.  This is necessary in order to circumvent the restriction of Apple itself on the use of brand SSDs only.  The backup file is saved in the same directory where the original file is located. <br><br>  To check if TRIM has been activated, go here: <i>About this Mac</i> &gt; <i>System Report</i> &gt; <br><img src="https://habrastorage.org/storage2/6e1/8ec/165/6e18ec165ad7a921fc63f143696adab6.png"><br><br>  Remember, if you have a bearded SSD generation and the equipment itself does not support TRIM ... this patch will not help.  The patch only bypasses the restriction created by Apple itself to limit TRIM support for any SSD that is not under the apple brand. <br><br>  Having dealt with the TRIM Enabler and disliking his method, I began to look for a sane solution ... I found it <a href="http://www.insanelymac.com/forum/index.php%3Fshowtopic%3D256493%26st%3D0%26p%3D1680183%26">here</a> . <br><br>  The MD5 checksum entries for the original and the patched file in 10.7.0 are as follows: <br>  Original: 155b426c856c854e54936339fbc88d72 <br>  Modified: 945944136009c9228fffb513ab5bf734 <br><br>  If you have already used TRIM Enabler, you can do the following: <br><ul><li>  Try to copy and replace the key file from another Mac running the same version. </li><li>  Attempt to copy and replace the key file from the Recovery Section (Open Disk Utility&gt; Mount Recovery HD) </li><li>  Reinstall Lion </li><li>  Wait for the next OS update to 10.7. * And hope that the key file will be replaced during the update (which, by the way, de facto), and after that apply the normal patch. </li></ul><br><br><blockquote>  <b>Important:</b> <br>  Unfortunately, this operation will have to be done every time after a major update of OS X <b>10.7.1</b> &gt; <b>10.7.2</b> &gt; <b>10.7.3</b> &gt; <b>and so on ...</b> because the key file is updated almost every time the OS is updated (if it is not on duty). </blockquote><br><h5>  End of translation </h5><br>  Wikipedia chews further in the article that TRIM does not work on standard HDDs, that the computer is not a fool and can distinguish HDD from SSD, that SSD cannot warm more when TRIM is activated, that the patch cannot affect the system in any way, since it does not no changes to the core itself, that if you turn on TRIM, and you have a HDD, then nothing will happen and all commands will be simply ignored ... and so on.  In general: since the author called himself a mushroom, I had to get into the box to the very hat and answer all.  If there are similar questions in local comments - I will translate his afterwords with the ‚ÄúUpdate‚Äù prefix, in portions. <br><br>  EFFICIENT EFFORTS  Thanks for attention. <br><br>  <b>TRIM:</b> <br>  TRIM technology increases the speed of writing to the cells where any data has already been stored before.  In other words, this data is stored there after its deletion.  And if it is necessary to rewrite the SSD, a command is sent to release these cells and only then does the recording begin.  Thus, it takes time and reduces the recording speed.  TRIM technology allows the controller to write data to bypass the cell release operation.  For example: the declared speed of my SSD x-25M is <i>up to 70 Mb per second</i> .  Having tested it before activation, TRIM produced no more than 50 Mb / s, now claimed 65-70 Mb / s.  Test your SSD, maybe you will also miss the 30% speed when writing data ... <br><br>  <b>Update 1.0</b> <br>  There was information that TRIM in some cases causes problems on those SSDs that are equipped with a SandForce 2 *** controller, as they say, the whole thing is that the SF2 *** controller processes the information that the user has removed in a special way and generally stores data on disk in the form of one large archive ... the details of his work and the resulting problems are described <a href="https://discussions.apple.com/message/15649687">here</a> . <br><br>  As it turned out, the SF2 *** controller is equipped with a fairly wide range of devices, including the popular OCZ Vertex 3, so be sure to take a look at the <b><a href="http://en.wikipedia.org/wiki/SandForce">list of SSDs equipped with the SandForce controller</a> and watch carefully if your disk is in this list, if yes, then define the Controller column sequence number, if it starts at 2, then disable the TRIM, the instruction is above.</b> <br><br><h4>  Update 2.0 </h4>  <b>This method stopped working after the system update to version 10.8.1.</b> <br>  Nevertheless, TRIM Enabler works, but on the Internet there are still <a href="http://www.macupdate.com/app/mac/37852/trim-enabler">opinions</a> that it can tear down the system.  You can try at your own risk, problems go away, if through this same program you disable TRIM when they occur, but you understand yourself - all this is ‚Äúforks on water‚Äù - if it does, then individually. <br><br>  When there is a method without interfering with the core of the system, I will write about it;  if any of you, dear makovods, find a way earlier, do not be lazy to inform, please. <br><br><h1>  Update 3.0 // Found a way to activate TRIM for system 10.8.2 </h1>  Thank user <a href="https://habrahabr.ru/users/shok/" class="user_link">shok</a> , a way <a href="http://ixxi.me/apple-2/aktivaciya-trim-v-mac-os-mountain-lion-10-8-2/">found on the Internet</a> . <br><br>  Run the following commands in the terminal: <br>  <b>1. Backup original drivers.</b> <br><blockquote> <font color="black"><code>sudo cp /System/Library/Extensions/IOAHCIFamily.kext/Contents/PlugIns/IOAHCIBlockStorage.kext/Contents /MacOS/IOAHCIBlockStorage /System/Library/Extensions/IOAHCIFamily.kext/Contents/PlugIns/IOAHCIBlockStorage.kext/Contents/MacOS/ IOAHCIBlockStorage-backup</code></font> </blockquote> <br>  <b>2. Change the driver.</b> <br><blockquote> <font color="black"><code>sudo perl -pi -e 's|(\x52\x6F\x74\x61\x74\x69\x6F\x6E\x61\x6C\x00{1,20})[^\x00]{9}(\x00{1,20}\x4D)|$1\x00\x00\x00\x00\x00\x00\x00\x00\x00$2|sg' /System/Library/Extensions/IOAHCIFamily.kext/Contents/PlugIns/IOAHCIBlockStorage.kext/Contents /MacOS/IOAHCIBlockStorage</code></font> </blockquote> <br>  <b>3. Execute two commands to clear the OS X cache and pick up the modified driver.</b> <br><blockquote> <font color="black"><code>sudo kextcache -system-prelinked-kernel sudo kextcache -system-caches</code></font> </blockquote> <br>  <b>4. Restart the Mac.</b>  <b>Checking TRIM activation</b> <br>  Source: <a href="http://ixxi.me/apple-2/aktivaciya-trim-v-mac-os-mountain-lion-10-8-2/">Science and Technology</a> </div><p>Source: <a href="https://habr.com/ru/post/143659/">https://habr.com/ru/post/143659/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143654/index.html">In Peterhof with a smartphone</a></li>
<li><a href="../143655/index.html">Search local value</a></li>
<li><a href="../143656/index.html">Manage the boot of virtual machines</a></li>
<li><a href="../143657/index.html">An example of integration of Last.FM API and VK.COM API to update the contents of its player</a></li>
<li><a href="../143658/index.html">Aleph PHP Framework</a></li>
<li><a href="../143660/index.html">Apple refuses Google Maps in iOS 6</a></li>
<li><a href="../143661/index.html">Symptoms of an epidemic: the flow of web design</a></li>
<li><a href="../143662/index.html">Moscow Ubuntu Precise Install Fest - May 19, MIEM</a></li>
<li><a href="../143663/index.html">VMWARE vSphere 5.0: Implementation Experience on the Example of the Tomsk Municipality</a></li>
<li><a href="../143664/index.html">Which smartphone is the best in the world?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>