<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How not to meet the apocalypse or reduce its probability to a minimum</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After reading the article ‚ÄúHow did we meet the apocalypse, or how were 3,500 companies left without calls?‚Äù There was a sense of bewilderment, and the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How not to meet the apocalypse or reduce its probability to a minimum</h1><div class="post__text post__text-html js-mediator-article">  After reading the article <a href="http://megamozg.ru/company/perezvoni/blog/15448/">‚ÄúHow did we meet the apocalypse, or how were 3,500 companies left without calls?‚Äù There was</a> a sense of bewilderment, and then there was a desire to share experience. <br><br>  So, if you have, like <a href="https://megamozg.ru/users/yagodkinvs/" class="user_link">yagodkinvs had</a> : <br><blockquote>  Redundancy was the server for the web-muzzle, but with telephony is not so simple ... </blockquote><br>  That welcome under kat. <br><br><img src="https://habrastorage.org/files/c27/3d1/013/c273d1013343437296c5cb883f5118f7.jpg"><br><a name="habracut"></a><br>  Participating in one project, he was responsible for the initial setup and further support of telephony.  The project grew over time, requirements changed, one of which was uninterrupted work of the call center, with the exception of cases of loss of electricity and / or trunk accidents with providers (Internet and / or telephony). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  How was this solved? </h4><br>  I would like to note that it is impossible to reserve a phone number for 100% if you have it ONE.  In case of an accident with a telecom operator, you cannot do anything. <br><br>  Therefore, we acted as follows.  The main telephony server was moved roughly from office to cloud.  For its reservation, the second one was raised in a cheap hosting. <br><br>  Settings on the backup - a copy of the main, with the exception of small nuances. <br><br>  The project manager was offered the following options for automatically switching telephony between servers: <br><ol><li>  Use DNS, in particular - from Amazon.  There you can configure a very fast name switching, for example, voip.company.pro between the IP addresses of our two servers, by fail-over and other parameters. </li><li>  Use balancer.  Options settings Kamailio and Asterisk, and not only it is in the vast network. </li></ol><br><br>  It should be noted that in the first embodiment, the switching of SIP-clients to the new server will be after the registration timeout works. <br><br>  In the second case, the authorization is moved outside of Asterisk to the balancer itself. <br><br>  But, the customer, having beaten the option with DNS, refused it.  Proving that the update of information in the DNS servers at the end devices can be very long. <br><br>  The second option was postponed, in view of the fact that so far there are not so many operators, and the customer did not want to complicate this scheme yet.  Well, the weak point in the second version would be the balancer, and it would be necessary to reserve it. <br><br>  The customer offered to think about another option - he sets up two accounts for operators in SIP clients.  They are essentially identical, the differences are only in the connection server.  And for my part, it is necessary to work out telephony switching between servers. <br><br>  That is, part of the scheme on the part of subscribers took the following form: <br><br><img src="https://habrastorage.org/files/1b9/596/c0b/1b9596c0b7684e22a455abae5193c626.png"><br><br>  Not perfect, but the customer insisted on such a decision, and all the labor costs for setting up SIP clients were taken by him.  Entrusted to the existing sysadmin :) <br><br>  Further.  In order for calls to come in any case, an additional city number was rented, but from another service provider. <br><br>  Number posted on the site, along with the main. <br><br>  Both servers were connected in personal accounts at both telephone service providers, as sip-clients. <br><br>  Were configured scripts for processing incoming calls, according to the following scheme: <br><ol><li>  When an incoming call arrived, it was sent to the main server, the dialing time was 20 seconds. </li><li>  When the primary server was unavailable, the call was sent to the backup, the dialing time was 20 seconds. </li><li>  With unavailability and backup server, the call was sent to voicemail. </li></ol><br><br>  Almost all VOIP providers allow you to configure this scheme either in your personal account or on request to support service.  At least from those chosen by us, we set it up in a personal account. <br><br>  It turned out the following scheme: <br><br><img src="https://habrastorage.org/files/ce8/157/0f5/ce81570f58a44c2281a02d5b391419ad.png"><br><br>  Since the servers regarding external SIP clients are external, the customer has the opportunity to reserve Internet access channels for the call center without any problems.  Although, I must say, he went even further and reserved the call center, opening its part in another city. <br><br><h4>  findings </h4><br>  The implemented scheme allowed to avoid idle call center in such cases: <br><ol><li>  Failure, for any reason, of one of the telephony servers. </li><li>  The loss of electricity and / or all communication channels on the Internet at one of the call centers </li><li>  Accident at one of the service providers </li></ol><br><br>  Of course, in any of these cases, the current calls were broken, and the subsequent ones were already received on a backup scheme. <br><br>  I remember that feeling of satisfaction, when in the evening in monitoring I saw a case of switching to a backup scheme. <br>  And while no one called me with screams of panic, since this was hardly noticed. <br><br>  Thank you for your attention!  I hope that someone, this material will be useful. </div><p>Source: <a href="https://habr.com/ru/post/290664/">https://habr.com/ru/post/290664/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../290650/index.html">Google will add to the search results button "Buy"</a></li>
<li><a href="../290652/index.html">How professionals work. Alexey Shtarev, Executive Director, SeoPult</a></li>
<li><a href="../290654/index.html">User did not leave email? 9 examples of how to hold it and bring to purchase</a></li>
<li><a href="../290660/index.html">Kaspersky Lab ranks first in Russia in the number of registered patents</a></li>
<li><a href="../290662/index.html">Healthy sleep - 4 tips from astronauts</a></li>
<li><a href="../290666/index.html">What sites in the next 3 years will search engines and advertisers love</a></li>
<li><a href="../290668/index.html">38 items that you must exclude from your resume right now</a></li>
<li><a href="../290670/index.html">Nikolay Fetyukhin, MST digital agency: how to throw away all the excess and start growing</a></li>
<li><a href="../290672/index.html">VAT in Estonia for IT companies</a></li>
<li><a href="../290674/index.html">We program sales managers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>