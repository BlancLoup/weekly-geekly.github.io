<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Electronic forms via Microsoft InfoPath</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, habravchane! 


 Business processes and workflow in any organization require the filling of a variety of forms and forms. The task of automating t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Electronic forms via Microsoft InfoPath</h1><div class="post__text post__text-html js-mediator-article">  Hi, habravchane! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a78/b5d/be3/a78b5dbe34644fdd80c65f3a45db4f36.png" alt="image" align="right"><br>  Business processes and workflow in any organization require the filling of a variety of forms and forms.  The task of automating these processes involves, inter alia, replacing the antediluvian paper forms with electronic analogues.  It uses a lot of very different tools and technologies: forms based on Excel documents, forms based on Access, web forms of asp.net applications, corporate desktop applications. <br><br>  As part of the MS Office package, there is a program specifically designed for creating electronic forms - this is Microsoft Office InfoPath. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I will talk about the basics of developing InfoPath forms.  The focus will be on basic things, but in conclusion, some deeper aspects will be mentioned, such as data connections, programming in InfoPath forms and integration with Sharepoint. <br><br><a name="habracut"></a><br><br><h4>  Concept </h4><br>  The underlying principle of InfoPath forms is the separation of a form template and its data. <br><ul><li>  A form template is a file with the .xsn extension, containing a description of the structure of the form and its design.  With some stretch you can take it as an empty form without data. </li><li>  Form data is an xml file containing specific information.  This is a useful "filling" of the form. </li></ul><br>  In accordance with this division, InfoPath appears in two ways: the designer for developing templates and the client for opening and filling out forms based on templates.  Up until InfoPath 2007, this functionality was combined in one application.  In the version of Office 2010, the application is divided into two independent components: InfoPath Designer (Form Designer), designed to develop templates and InfoPath Filler, which fill out specific forms based on templates.  Examples in this article will be for InfoPath 2007. <br>  Typically, a form template is published in a well-known place from where it can be accessed by users.  Users open a template and fill out a form.  Further actions may be different: saving the completed form as an .xml file, sending information somewhere. <br>  Saved as a .xml file, the form can be opened and modified.  It is clear that the .xml file must ‚Äúknow‚Äù where the corresponding form template is located, because the structure and design of the form are defined in the template.  If the template is not available, InfoPath will take it from the cache, if it has changed, you will be given the opportunity to download the updated template.  To provide links between a form template and its data, InfoPath has a complex architecture for publishing form templates. <br><br><h4>  Simple example </h4><br>  The best way to figure it out is to touch it with your hands.  For a start, you can experiment with the ready-made ‚Äúsample‚Äù forms with the program.  Open Microsoft Office InfoPath 2007. If the Getting Started window appears, select ‚ÄúSet up sample‚Äù on the left, if it doesn‚Äôt appear, go to the ‚ÄúFile‚Äù menu, select ‚ÄúForm Designer ...‚Äù and in the window that opens, again click on the "Customize Pattern ..." button to the left.  Take, for example, the sample "Asset Accounting". <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a1/db6/902/0a1db690265c574a43997eb6aa85bdc5.png" alt="image"><br><br>  After double clicking on the sample, InfoPath will open it in designer mode.  You can edit the form template, delete unnecessary fields, add new ones, etc. The panel with the available components (input fields, checkboxes, drop-down lists) can be opened via the ‚ÄúControls‚Äù link on the taskbar in the right part of the window. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/70c/ef4/0d0/70cef40d05853cc9eafd9b35d983d2c1.png" alt="image"><br><br>  Let's save our template in a convenient place as the ‚ÄúAsset Accounting.xsn‚Äù file.  Perhaps at the same time InfoPath will remind you that it would be good to publish it - but for now let's not do it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f2/be9/d1a/8f2be9d1add5bd180c58003063643752.png" alt="image"><br><br>  Now you can open the template and fill out the form. <br><br>  After filling, you can save it.  This will already be a file with the .xml extension - a data file based on our template.  This way you can fill out many forms based on one template. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b0c/f80/e05/b0cf80e0581a7637bada49a864e9513e.png" alt="image" width="400"><br><br><h4>  Publication </h4><br>  As already mentioned, InfoPath has a complex architecture for publishing form templates.  The asset accounting form template, which we have saved somewhere on our computer, is available only to us.  I would like to make it accessible to a larger circle of users. <br><br>  First, open the form template in design mode (the ‚ÄúDesigner‚Äù item from the context menu of the file). <br>  The Publish Wizard is launched by the "Publish ..." command from the "File" menu. <br><br>  InfoPath provides several options for publishing a form.  In this case, let's lay out the template in a shared folder. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/09b/d5b/658/09bd5b658066980a4123ef8f22af6697.png" alt="image"><br><br>  In the next wizard window you need to specify the place of publication.  At one time I suffered at this step.  Not quite understanding the meaning of the actions performed, I clicked on the ‚ÄúBrowse‚Äù button and selected the saved template file there.  This is not necessary.  In the "Path and file name for the form template" field, the path to the file that does not yet exist should be indicated in the place where we want to publish it.  Therefore, click "Browse", we reach the shared folder, and in the "File name" field we drive in the name of the future published template, and then click "OK". <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ed6/6b9/b22/ed66b9b228ffb693abbf8f102948cfa5.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/70c/37e/887/70c37e887adb0a461a6bfece35fda1ff.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/be3/7a3/11e/be37a311e5aae4fd4941251b06f95e59.png" alt="image"><br><br>  In the next step, you need to enter an alternative way to access the published template from the users.  After all, the mapping of network resources may differ from the developer and the end user.  The network resource seen by end users may be different.  And InfoPath requires that access to the published template is uniform.  Therefore, when publishing, two paths are specified ‚Äî one for the administrator (we have already defined it), and the other for the end users.  If the path on the part of the user is no different, simply copy the path that we indicated in the previous step into the input field. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f58/4dc/706/f584dc706e65505ffd12c3adcc3e2139.png" alt="image"><br><br>  After clicking on the ‚ÄúNext‚Äù button, we check the entered data and click ‚ÄúPublish‚Äù. <br>  In the final wizard window, you can enjoy the message about the successful publication and ask to immediately open the form based on the published template in order to make sure that everything is in order. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/be2/df6/050/be2df605073b6898f140a5220aa41e58.png" alt="image"><br><br><h4>  Security </h4><br>  In the final windows of the publication wizard you can see the line ‚ÄúSecurity level: Domain‚Äù. <br>  The security level of a form determines what form is allowed to do, what is the level of trust in it. <br>  This is set when developing a form template on the ‚ÄúSecurity and Trust‚Äù tab of the ‚ÄúForm Settings‚Äù dialog box, which is opened by the same command from the ‚ÄúTools‚Äù menu.  There are three possible levels of trust: limited, domain level and full trust. <br><ul><li> Forms with a limited trust are not very useful, they cannot access external data sources, they cannot even be published in a shared folder, which we did with the asset accounting form template.  However, templates with limited confidence can be sent by e-mail, and recipients will be able to fill out forms based on them.  By the way, when you send an InfoPath 2007 form by email, you can do this in two ways.  The first is to send the form as an attachment.  This can be done regardless of which email clients are used by the recipient and ours.  The second possibility is to send the form in the message body.  This is possible if both we and the recipient have an email client - Microsoft Office Outlook 2007. <br></li><li>  Forms with a domain security level can access content within a domain, for example, populate drop-down lists from directories stored in an MS SQL Server database or from Sharepoint lists. <br></li><li>  Full trust means that the form can do anything.  In particular, if a form has program code (event handlers, etc.), it must have a full level of trust.  Templates with a full level of trust must be signed - this can be done here (checkbox ‚ÄúSign this form template‚Äù, buttons for creating and selecting digital signature certificates). <br></li></ul><br>  By default, the ‚ÄúAutomatically detect security level‚Äù checkbox is selected on the Security and Trust tab.  From experience, I can say that it is automatically determined by far not always automatically: a significant part of errors when opening a form based on a certain template was caused precisely by the fact that the template had a low level of security. <br><br><h4>  Little by little </h4><br><h5>  Data sources </h5><br>  As already mentioned, the InfoPath form can access external data sources.  This can be a database (MS Sql or Access), a Sharepoint list, a web service, .xml file.  The most obvious use is to populate drop-down lists based on various directories. <br>  Let me remind you that the form template that accesses external data sources must have a security level - domain. <br><br>  In fact, the structure of the InfoPath form itself is determined by the data source.  Even if a form template is created from scratch, all the same, there will already be one in the data sources - the ‚Äúprimary‚Äù data source.  When adding elements to the form, the corresponding nodes will be added to the data source.  Any data source in InfoPath is represented by an xml-tree, and thus the structure of the form is essentially an xml-tree. <br><br>  It is possible to create InfoPath forms based on some of the available data sources - web services, databases, predefined xml schemas.  In this case, we will not be able to change the data source, which is the basis of the structure of the form, and we will not be able to add new fields that are not in the data source. <br><br><h5>  Representation </h5><br>  A form can have multiple views.  A view is a kind of ‚Äúslice‚Äù that includes a specific group of fields.  After all, it is not necessary to simultaneously display on the form all the fields of its data source.  If there are many fields, you can group them by meaning and divide them into several representations.  In addition, you can create different views for different user groups that will work with the form as part of a business process.  Finally, you can create a separate presentation for printing the form, which will have a particularly beautiful design, focused specifically on this task.  You can switch between views using the InfoPath client‚Äôs View menu, in which the form is open, and, for example, programmatically, for example, by clicking the buttons on the form (you can, on the contrary, disable the ability to manually switch through the View menu ). <br><br><h5>  Programming </h5><br>  Complex forms can contain program code (managed code in C # or Visual Basic .Net is of most interest).  Let me remind you that the level of security of such forms should be ‚ÄúFull trust‚Äù.  In the code, you can, for example, perform the necessary event processing, complex control of the input data (in addition to simpler validation, which can be configured through the InfoPath designer interface).  It is possible to dynamically change the interface and form elements, add and hide certain input fields, switch between views.  You can programmatically connect to such data sources, connection to which is not provided in the InfoPath constructor (for example, to an Oracle database). <br><br><h5>  Sharepoint Integration </h5><br>  A bunch of InfoPath forms and Sharepoint is probably one of the most promising and widespread applications of InfoPath forms today.  Let's say my acquaintance with InfoPath happened quite recently in the process of studying the development of workflows (Workflows) for Sharepoint.  For many years before, InfoPath lived quietly on my computer as part of the MS Office suite, without attracting attention to itself. <br><br>  So, what about InfoPath integration with Sharepoint? <br><ul><li>  The form template can be published as a Sharepoint form library.  In this case, when publishing on the Sharepoint site, an InfoPath form library is created, based on this template.  Users will be able to fill out forms and add them to the library. </li><li>  In continuation of the previous paragraph, the InfoPath Forms Services service, available in MOSS 2007 (Microsoft Office Sharepoint Server 2007), allows you to fill in InfoPath forms right in a browser window.  In this case, users do not have to install the InfoPath application - they will be able to fill out and add forms to the form library using only the browser.  Unfortunately, InfoPath Forms Services is available only in MOSS, in WSS (Windows Sharepoint Services) this service is not available.  Another limitation is that far from all the capabilities of full InfoPath forms can be used in forms compatible with InfoPath Services: in order for the form to be displayed directly in the browser, you have to give up some controls (pictures, ActiveX controls, block ‚ÄúMain / Details‚Äù, bulleted and numbered lists, and others), and when writing program code for such a form, deal with a greatly reduced object model (mainly, the possibilities associated with dynamic changes  Niemi form elements). </li><li>  Publishing a template as a form library has one drawback - the impossibility of reuse.  If we need another library, we will have to publish again.  Fortunately, you can publish a form template as a Sharepoint content type and create any number of form libraries on its basis. </li><li>  InfoPath forms can be used as Sharepoint workflow forms.  About Windows Workflow Foundation (WF) and workflows on Habr√© <a href="http://habrahabr.ru/blogs/net/46409/">has already been written</a> .  The Sharepoint Platform (both WSS and MOSS) offers a WF-based workflow infrastructure for lists, libraries, and content types.  For example, you can create a workflow for approving documents (yes, the same InfoPath forms!), Which will be launched when a document is added to the library.  A workflow involves creating tasks for users or groups of users (in this case, they are tasks that approve the added document).  When designing a workflow, it is necessary to create various forms that need to be completed at different stages of the life cycle of the workflow: when the workflow is associated with a list, when the workflow is started, when performing the assigned tasks.  And these forms of Sharepoint workflow can be both classic asp.net pages and InfoPath forms. </li><li>  Finally, it is through InfoPath forms that metadata are entered when loading and editing documents in document libraries on the Sharepoint site.  The figure below shows a Word document that has an information bar for entering metadata ‚Äî the Author, Title, Subject, and other fields.  This panel is nothing more than an embedded form of InfoPath.  If you wish, you can customize such a form, replace it with your own handwritten design, if something that does not suit the one that was generated automatically for a given document library does not suit you. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b10/695/ed3/b10695ed3279b6245bfa07684ef174a6.png" alt="image"><br></li></ul><br><br><h4>  Afterword </h4><br>  In this article, I tried to briefly describe the development of electronic forms using InfoPath, focusing mainly on the Microsoft Office version of InfoPath 2007. Many questions are mentioned only in passing, other aspects remained completely unaffected - primarily because I myself encountered InfoPath- forms are relatively recent and the process of studying them is far from complete.  This process could be much more laborious without one book, which served me as the main source of information on the topic - this is Phil Janus' book ‚ÄúInfoPath 2007 for Professionals‚Äù. <br><br><ul><li>  Janus, Philo.  InfoPath 2007 for professionals .: Trans.  from English  - M .: LLC ‚ÄúI.  D. Williams, 2009. - 272 pp., Ill.  - Paral.  tit  English  ISBN 978-5-8459-1484-2 (Russian) </li></ul></div><p>Source: <a href="https://habr.com/ru/post/111333/">https://habr.com/ru/post/111333/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111328/index.html">Two beauties</a></li>
<li><a href="../111329/index.html">Computer in the car "cheap" or CarPC "Siberian"</a></li>
<li><a href="../111330/index.html">Removing .NET programs from registration using the example of BEM</a></li>
<li><a href="../111331/index.html">Rake tutorial</a></li>
<li><a href="../111332/index.html">The emulator of the game "life" in the GLSL language</a></li>
<li><a href="../111336/index.html">Anti-interference coding using various codes</a></li>
<li><a href="../111338/index.html">Online cinema</a></li>
<li><a href="../111339/index.html">Screenshot of a video player without black holes</a></li>
<li><a href="../111341/index.html">Review of Huawei E960 3G router</a></li>
<li><a href="../111343/index.html">Mac App Store - First Impressions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>