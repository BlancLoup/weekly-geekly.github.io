<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ractive.js - the diamond age of web development</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="According to the development team itself, Ractive.js is a library for developing dynamic web interfaces, thanks to which the world of web development ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ractive.js - the diamond age of web development</h1><div class="post__text post__text-html js-mediator-article">  According to the development team itself, Ractive.js is a library for developing dynamic web interfaces, thanks to which the world of web development will flourish: everyone will be given bonuses of 100%, holivars who will be cooler will step aside, and developers who write interactive , dynamic sites finally cease to be covered with gray hair and foul. <br><br>  In short, the diamond age of web development will come. <br><br>  Starting another project, before starting to write Backbone code (fu-fu-fu), I decided to use this miracle in the project (diamonds!).  And since I‚Äôve <s>chewed up</s> Google, I realized that there‚Äôs only one article about Ractive.js on Habr√©, I need to eliminate this injustice and at the same time write about whether the car of happiness will fall to all of us and whether anyone will be happy at all.  After all, to promise the "diamond age" is one thing (every 4 years we hear from the telephones), and to do it is quite another. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Under the cut, I‚Äôll review what Ractive.js is and how it works, and I will write out in detail the production task with full implementation and description of what all this threatens to us all. <br><a name="habracut"></a><br><h4>  What is this beast at first? </h4><br>  Briefly (in fact, very briefly, but catch the idea, and the details will come with the code) and in fact: Ractive.js is terribly simple and consists of two halves: <br><br><ul><li>  Templates (read ‚Äúview‚Äù) in which you very declaratively describe how your program / component should look like. </li><li>  Data - the actual data that needs to be presented in the view and how it is affected by the outside world (user interaction and / or network requests). </li></ul><br><br>  Accordingly, after you have described the template, the data and where it will all be rendered (usually the id DOM of the element on the page), <br>  Ractive.js provides (and absolutely disinterestedly and without your participation) a two-way connection between this data and the template. <br>  That is, as soon as the data is changed, your view that corresponds to this data is immediately reactively changed, the necessary DOM elements are deleted and deleted.  Well, in the opposite direction: <br>  as soon as a user pokes something up in your application, the data changes. <br>  And so in a circle.  And all very reactive. <br><br>  You ask: "And what's the joy?" <br><br>  And the joy is that you write a short, clear, declarative code without millions of events (which, as usual, fly back and forth, and we are trying to observit, bandage, etc.). <br>  And most importantly, there is no manipulation of the DOM!  We are not creating new elements ... we are not deleting them from the DOM ... <br>  we never actually look for any element with $ (selector) - everything is always at hand. <br>  Ractive builds a parallel DOM in the same way as React does and produces only pointwise manipulations with the DOM. <br>  No unnecessary movements, and therefore it works very quickly.  By the way, the Ractive is better / worse. React is a topic for a separate article. <br><br>  It's simple: changed the data - changed the display.  This is the general idea of ‚Äã‚Äãthe library. <br><br>  Now we will look at the implementation, the actual code and the details of how it works.  But first we will form a TOR for what we want to write. <br><br><h4>  Practice </h4><br>  It was necessary to write comments to the blog.  You ask why not to use Disqus or something like that.  The bottom line is that <br>  Our project is engaged in education in the field of healthy lifestyle and in a public blog we used just Disqus. <br>  But within the framework of the project, online trainings are held, and comments in them should be private, as they contain private information and all sorts of valuable answers to questions. <br>  So I had to make my component. <br><br>  So, the requirements: <br><br><ul><li>  The user should be able to leave a multi-line text in the form of a comment. </li><li>  Comments should work without reloading the page (interactive user as we all love). </li><li>  Comments must be tree-like (you can reply to another comment and thus create a branch). </li><li>  A new comment should appear with a pretty animation. </li><li>  Users can delete their own comments. </li></ul><br><br>  Actually, to immediately understand what and how we will build here on the <a href="http://jsfiddle.net/maxtern/e2mk0tn3/embedded/result/">link to jsfiddle with the final result</a> . <br><br><h5>  Templates </h5><br>  Ractive.js for UI description uses {{mustache}}.  Only they podhachili him slightly and expanded. <br>  I will not describe here mustache, you can read about it <a href="http://mustache.github.io/mustache.5.html">here</a> who is not familiar. <br><br>  I will describe only the features that made Ractive: <br><br><ul><li>  Introduced the variable this.  In the block, it corresponds to the given object.  For example, if you write <br><pre><code class="html hljs xml">{{#user}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>this.name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {{/user}}</code> </pre>  then if <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = {<span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">''</span></span>}</code> </pre>  will turn out <pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></li><li>  If the block is an array, this will be equal to the element of the array. </li><li>  And also you can execute any js code inside {{}}.  So if <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = { <span class="hljs-attr"><span class="hljs-attr">age</span></span>:<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">''</span></span> }</code> </pre><br>  and template: <br><pre> <code class="html hljs xml">{{#user}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{this.age &lt; 18+1*Math.random() ? 'illegal' : 'legal'}}"</span></span></span><span class="hljs-tag">&gt;</span></span>this.name <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {{/user}}</code> </pre><br>  then we will get a predictable result <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'illegal'</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></li><li>  Proxy DOM Events: if you write in template <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on-eventName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'callbackName'</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  where eventName is the name of the standard DOM event (click, submit, etc.), then upon the occurrence of an event, ractive can subscribe to such an event as <br><pre> <code class="javascript hljs">ractive.on(<span class="hljs-string"><span class="hljs-string">'callbackName'</span></span>,<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">)</span></span>{});</code> </pre><br></li></ul><br>  There are still differences, but now it‚Äôs not up to them. <br>  Then everything is simple: each Ractive instance has data on it that needs to be displayed in the template. <br>  It puts data into the template and builds the HTML structure we need, and each object from data has a html block from the template. <br>  Therefore, when changing data, Ractive knows exactly what needs to be added and what to remove from the real DOM, and therefore it works very quickly, producing point replacements in the DOM. <br>  Also, since each piece of DOM now corresponds to a piece of data in data, all events that are proxied via on-eventName (for example, on-click) are accompanied by a link to the data from data as context.  For example, if I have such a template: <br><br><pre> <code class="html hljs xml">{{#user}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">--</span></span></span><span class="hljs-tag">  </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">this</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">user</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">--</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'alert_username'</span></span></span><span class="hljs-tag">&gt;</span></span>{{this.username}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {{/user}}</code> </pre><br>  then the alert_username event handler might look like this: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = e.context; alert(user.username); }</code> </pre><br><br>  I hope that the real example will become clearer. <br><br>  Next is our implementation of the template for our task, but first we will describe the structure of our data (comments) in the data: <br><br><pre> <code class="javascript hljs">ractive.data = {<span class="hljs-string"><span class="hljs-string">'replys'</span></span>:[ { <span class="hljs-attr"><span class="hljs-attr">md_text</span></span>:<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-attr"><span class="hljs-attr">date</span></span>:<span class="hljs-number"><span class="hljs-number">10240912834091</span></span>,<span class="hljs-comment"><span class="hljs-comment">//  nix // user:{ username:' ', image:'http://link-roga-serega-avatar.ru' }, //   replys:[{ md_text:"    ", date:10240912834091, replys:[...]}, {...}] }, { md_text:"   ", date:10240912834091,//  nix user:{ username:' ' }, ]};</span></span></code> </pre><br>  Template with comments: <br><pre> <code class="html hljs xml">{{#top_reply}} <span class="hljs-comment"><span class="hljs-comment">&lt;!--       .    ,  --&gt;</span></span> {{#if replys.length &gt; 0}} <span class="hljs-comment"><span class="hljs-comment">&lt;!--   -  --&gt;</span></span> {{#if this.reply_draft}} <span class="hljs-comment"><span class="hljs-comment">&lt;!--        comment_form -    .--&gt;</span></span> {{&gt;comment_form}} {{else}} <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ,    ' '    --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    reply  e.context = this; this = top_reply --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add_comment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"reply"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> {{/if}} {{/if}} {{/top_reply}} <span class="hljs-comment"><span class="hljs-comment">&lt;!--      partial   --&gt;</span></span> {{#replys}} {{&gt;comment}} {{/replys}} <span class="hljs-comment"><span class="hljs-comment">&lt;!--  --&gt;</span></span> {{#bottom_reply}} {{&gt;comment_form}} {{/bottom_reply}} <span class="hljs-comment"><span class="hljs-comment">&lt;!-- {{&gt;comment}} --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     partial    replys - this    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{this.id}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"comment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">intro</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"scroll_to:{go:{{this.is_new}}}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--            --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"avatar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"author"</span></span></span><span class="hljs-tag">&gt;</span></span>{{this.user.username}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   .    moment    .        data--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">time</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pubdate</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">datetime</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{{moment(parseInt(date)).format()}}</span></span></span><span class="hljs-tag">&gt;</span></span> {{moment(parseInt(date)).fromNow()}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">time</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    -       --&gt;</span></span> {{#if user.id === current_user.id}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"delete"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"delete"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{deleting}}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> {{/if}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> {{{marked(md_text)}}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       --&gt;</span></span> {{^this.reply_draft}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"reply"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> {{/this.reply_draft}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> {{#if this.reply_draft}} {{&gt;comment_form}} {{/if}} <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> {{#this.replys}} {{&gt;comment}} {{/this.replys}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- {{/comment}} --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- {{&gt;comment_form}} --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"comment"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"avatar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"author"</span></span></span><span class="hljs-tag">&gt;</span></span>{{current_user.username}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      save--&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  this    .context     .--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on-submit</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"save"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on-reset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cancel_reply"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      input    . --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       textarea     this.reply_draft.text--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{this.reply_draft.text}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{this.loading}}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"reset"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- {{/comment_form}} --&gt;</span></span></code> </pre><br><h5>  Data </h5><br>  Now we describe how the template is related to the data. <br>  The model here is very simple, so I will not stop for a long time: JS class Comments with text type, publication date, user, as well as the ability to save comments to the server and delete from it. <br>  There is also a method for downloading comments from the server, as promised nothing interesting. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Comment</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id, md_text, user, domain, date, reply_to</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!md_text || !user || !domain || !date) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'md_text, user, domain and date is required'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id = id; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.md_text = md_text; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.user = user; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.date = date; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.reply_to = reply_to ? reply_to.id || reply_to : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.domain = domain; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.replys = []; }; Comment.prototype.destroy = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//ajax     }; Comment.prototype.save = function () { //ajax     }; Comment.fetch = function (domain, options) { //    . };</span></span></code> </pre><br>  Now the implementation of the Ractive components: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Comments = Ractive.extend({ <span class="hljs-comment"><span class="hljs-comment">//$(selector)   Ractive     el: '#comments', //id tag &lt;script&gt;        (    ) template: '#comments_template', init : function (options) { var self = this; //     . var domain = options.comments_domain; // . var current_user = options.current_user; if (!current_user) { throw new Error('options.domain and options.current_user is required'); } //       . Comment .fetch(domain) .then(function (comments) { //          . var comments_by_id = _.indexBy(comments, 'id'); //   comments = _.sortBy(comments, 'date'); //      //    replys  ,          . comments = _.filter(comments, function (comment) { if (comment.reply_to &amp;&amp; comments_by_id[comment.reply_to]) { var parent = comments_by_id[comment.reply_to]; parent.replys.push(comment); } return comment.reply_to === null }); //reative.set(prop_name,value)    data, ractive.get(prop_name)    data. //           . //   self.data.replys = comments     . self.set('replys', comments); }); //Ractive    . //Events     ractive.on('event_name',callback);  .on({prop_name:callback}); //Events       ...         . self.on({ //   . //   .    ractive     //e.node - html DOM   . //e.original -   DOM (  e.original.preventDefault()); //e.keypath -     .    ractive.data   .      data  : //data:{ comments:['text1','text2'] };     'text2'     'comments.1' //Ractive    DOM    ,  DOM     keypath . //  e.context -       e.keypath ( ractive.get(e.keypath) ); save : function (e) { e.original.preventDefault(); //save    . ,      ,    -  -      . var reply_to = e.context.id ? e.context.id : null; //   . var reply = e.context.reply_draft; //  var new_comment = new Comment(void 0, reply.text, current_user, domain, moment().valueOf(), reply_to); //   self.set(e.keypath + '.loading', true); //  new_comment.save() .then(function (comment) { //   setTimeout(function(){ // ,  . self.set(e.keypath + '.loading', false); self.set(e.keypath + '.reply_draft', false); var comments = reply_to ? self.get(e.keypath + '.replys') : self.get('replys'); //     comments.push(comment); //.   ,     . //     Ractive      . // -             ,      . },600); }) .fail(function (err) { self.set(e.keypath + '.loading', false); }); }, delete : function (e) { // . //       . //       . self.set(e.keypath + '.deleting', true); e .context .destroy() .then(function (comment) { self.set(e.keypath + '.md_text', comment.md_text); self.set(e.keypath + '.deleting', false); }) .fail(function () { self.set(e.keypath + '.deleting', false); //</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> show erorr; }); }, reply : function (e) { //e.keypath      . //       . //   .        Comments...     v2.0 self.set(e.keypath + '.reply_draft', {}); }, cancel_reply: function (e) { //  ... //   self.set(e.keypath + '.reply_draft', false); } }); }, //data         . data: { bottom_reply: {}, // top&amp;bottom_reply  ,   . top_reply: {}, marked: marked, //data       ,        . moment: moment //     . } });</span></span></code> </pre><br><h5>  Animations </h5><br>  For any element, you can add an intro \ outro attribute for the DOM element:, and each time you add / remove an element from the ROM DOM, it will trigger the specified animation. <br><br>  Animations are described by a function that takes an object as a parameter: <br><br>  t.node - DOM element to animate. <br>  t.isIntro - element is inserted or removed. <br>  t.complete - a function that needs to be called after you have all zanimirovali and everything is over.  Ractive will set all element styles to initial state. <br><br>  The actual function of the animation of our comments looks like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//Ractive          \ DOM . transitions: { scroll_to: function (t, param) { //        (param.go === true) if (t.isIntro &amp;&amp; param.go) { //      . //    $ var element = $(t.node); var offsetTop = element.offset().top - element.outerHeight(); $('html, body').animate({scrollTop: offsetTop}, 500, function () { //    t.setStyle('background-color', 'yellow'); t.animateStyle('background-color', 'transparent', { duration: 1500, easing : 'easing' }, t.complete); //   Ractive t.complete     . Ractive           . }); } else { //     DOM,      (param.go) t.complete(); } } }</span></span></code> </pre><br>  That's all, 230 lines with comments (sooo detailed), templates and js code.  Virtually no DOM search - beauty. <br>  Well, just once the working code can be found here <a href="http://jsfiddle.net/maxtern/e2mk0tn3">jsfiddle.net/maxtern/e2mk0tn3</a> <br><br><h4>  findings </h4><br>  Happiness lies in the fact that in this example, in fact, never once had to look for something in the DOM, look for references to objects, check the status of the component. <br>  All declaratively and reactively, as promised.  No one throws himself at each other with millions of events. <br>  Very few "gluing" views with code models.  Anyway, very little code. <br><br>  Then Ractive works very quickly.  Since you do not need to dig constantly into the DOM and he knows exactly where to change something, <br>  There is virtually no redrawing of the view, so it works quickly.  For example, in Backbone we sometimes call render and redraw a bunch of views, even those that have not changed. <br><br>  It can also be used absolutely with any other libraries, for example, with the same Backbone - we take Model and Route from it. <br><br>  Also on the website Ractive there is an interactive tutorial that can be completed in 30-50 minutes you know Ractive.  those.  30-50 minutes and you are a pro. <br>  The learning process is incredibly simple and straightforward. <br><br>  What do you think?  Personally, I think that the diamond age may not have come yet, but once again it has become much easier to live. <br><br><h4>  Epilogue </h4><br>  We are currently working on the next release on the Fifteen project site, and we plan to launch the power planner for the web. <br>  The scheduler itself is designed as a tag game (which is evident from the name of the project) and a calendar.  On mobile it looks like this: <br><img src="http://dieta.blob.core.windows.net/blogimg/derevo02.jpg" alt="image"><br>  With all this, the web still draws graphics, and users upload and edit images.  In general, full interactive. <br><br>  If this article is interesting, I will publish after the release how easy it is in Ractive to break a complex interface into components, and how they interact with each other using the example of this very scheduler. <br><br>  There is also an idea to write ‚ÄúRactive vs.  React.  Such reactive frameworks. ‚Äù <br><br>  Official website: <a href="http://www.ractivejs.org/">www.ractivejs.org</a> <br>  Especially good and they and the tutorial: <a href="http://learn.ractivejs.org/hello-world/1">learn.ractivejs.org/hello-world/1</a> </div><p>Source: <a href="https://habr.com/ru/post/235675/">https://habr.com/ru/post/235675/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235661/index.html">Gear VR - Samsung's Unusual Virtual Reality Helmet</a></li>
<li><a href="../235665/index.html">Lumia 830, Lumia 730 and Lumia 735 announced in Berlin</a></li>
<li><a href="../235667/index.html">Health IT-Schnick and Relax Eye's</a></li>
<li><a href="../235669/index.html">Oracle Siebel CRM Event Model (Part 1)</a></li>
<li><a href="../235671/index.html">Leaked private photos of celebrities: a detailed investigation of the Australian developer</a></li>
<li><a href="../235679/index.html">Twitpic closes</a></li>
<li><a href="../235681/index.html">Entertaining web quest. Get the whole URL</a></li>
<li><a href="../235685/index.html">ASUS MEMO Pad 7 Tablet Review (ME176CX)</a></li>
<li><a href="../235689/index.html">Github stats</a></li>
<li><a href="../235691/index.html">Remove ads in uTorrent in 15 seconds</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>