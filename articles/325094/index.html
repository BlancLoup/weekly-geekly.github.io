<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúPresent documents‚Äù or what will help to recognize a passport</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have already talked about the recognition of text from a video stream, its advantages in comparison with photo processing and scenarios, where it i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúPresent documents‚Äù or what will help to recognize a passport</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/29b/97e/f56/29b97ef56646456f92d3ce2bfc4bd542.jpg" align="left">  We have already <a href="https://habrahabr.ru/company/abbyy/blog/281973/">talked</a> about the recognition of text from a video stream, its advantages in comparison with photo processing and scenarios, where it is especially useful. <br><br>  Today we are launching the <a href="https://www.abbyy.com/ru-ru/real-time-recognition-sdk/">ABBYY Real-Time Recognition SDK</a> for Android and iOS mobile platforms.  Therefore, we want to talk about the features of data recognition on a mobile device, namely, about extracting information in a video stream using the example of one of the most complex documents - a civil passport. <br><br>  We all often have to use our passport information.  You need a passport to register with a mobile bank or payment system, purchase tickets, or rent a car.  Now many people use a smartphone for these tasks.  Typing on a small keyboard of a mobile device is very inconvenient.  A particularly unpleasant input field is the data on the place of issue of the passport: they usually take a couple of lines and contain many abbreviations. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Carsharing companies told us that the main part of potential customers "falls off" exactly at the stage of manual entry of these data.  So, the problem is not that people are afraid to declassify information about themselves, but that they feel sorry for wasting time on the dreary reprinting of text from a passport.  All smartphones have cameras that can be used to simplify and speed up the entry of information from documents.  The task is - you need to solve. <br><br>  In fact, ABBYY already has a solution for this task running on a PC.  However, a modern smartphone, though powerful, is still not a computer.  We needed to make a correction for the allowable size of the application (not more than 50 MB) and the available RAM.  Therefore, the option "just transfer existing technology to mobile platforms" we shoal and started a new development. <br><br><h1>  Why is it difficult to recognize a passport? </h1><br>  It would seem that difficult to recognize a passport?  The structure of the passport is known: on the ‚Äúhalf with photo‚Äù, there is a vertical line on the side with a series and number, to the left of it - 6-7 horizontal lines with personal data.  But the difficulty lies not in figuring out which field is where, but in correctly recognizing the desired text. <br><br>  A passport is not the easiest document to recognize.  There are a number of problems that all those who are trying to process it face sooner or later. <br><br><h1>  Defects of shooting </h1><br>  In this blog, <a href="https://habrahabr.ru/company/abbyy/blog/275631/">we have already discussed more than once</a> what difficulties arise when recognizing a photograph, and not a scan.  The main difficulty is that the camera of the smartphone is not a scanner :) When photographing, we hold the device (and sometimes the document being photographed) in our hands, and the hand may waver.  The result is blurred text on a photo that is simply impossible to recognize. <br><br>  In the case of a passport, the situation is complicated by the fact that the most necessary pages are laminated.  So, when photographing them, glare will inevitably occur, which will make the text unreadable. <br><br><img src="https://habrastorage.org/files/7cf/bc2/b59/7cfbc2b593674fbdbe4f1a5da898b0a1.jpg"><br>  <i>Figure 1. Blik completely closes the name (passport data is changed)</i> <br><br><h1>  Difficult background </h1><br>  To protect the document from forgery, the FMS officers add holograms and further complicate the task of recognizing and retrieving passport data. <br><br>  I think, having seen a photo of my passport, many were indignant because the double-headed eagle hit the face and finally spoiled the photo.  In the same way, he can ‚Äúspoil‚Äù the surname, date of birth and other fields, turning them into barely readable text on a photo - this is a problem for recognition systems. <br><br><img src="https://habrastorage.org/files/57d/f09/bf4/57df09bf4a8c48c5ac9f90bf5f365f1d.jpg"><br>  <i>Figure 2. The ‚ÄúRF‚Äù hologram covers the middle name (passport data is changed)</i> <br><br><h1>  Text size and color </h1><br>  Another unpleasant moment.  Captions to the data fields (for example, "Date of birth", "Middle name", etc.) are written in very small print.  Even good cameras of smartphones do not always allow to get an image on which this text can be recognized qualitatively.  As a result, signatures are turned into garbage from different symbols, which can no longer be a reference point for searching data fields and interfere with the analysis of results. <br><br>  In addition, often there are documents that are clearly regretted paint.  The text is so pale that it can hardly be read.  Recognizing such text on a photo is even more difficult. <br><br><img src="https://habrastorage.org/files/947/295/615/947295615b394a32983c6e5a0f0df809.png"><br>  <i>Figure 3. Poorly contrast text (passport data is changed)</i> <br><br><h1>  What can help in recognition? </h1><br>  So, recognizing a passport is not easy.  But difficulties exist in order to overcome them.  And we want to share some ideas useful for recognizing a passport on a mobile phone. <br><br><h1>  Recognition from the video stream </h1><br>  The first problem we mentioned is the difficulty of working with a photo due to the presence of glare, blurred text, etc.  To cope with it, you can try to level these defects.  For example, use the functions of the <a href="https://www.abbyy.com/ru-ru/mobile-imaging-sdk">ABBYY Mobile Imaging SDK</a> to assess the quality of the image and its suitability for recognition.  If it becomes clear that there are no good results for a photo, the application may ask the user to take a second shot. <br><br>  Another way to deal with defects is to refuse to work with photos and go to video stream processing, i.e.  sequences of images (frames) received from the camera device. <br><br>  It is difficult for a person to keep his hands straight when shooting a passport.  This means that the defects will ‚Äútravel‚Äù through the frames: in one, the flare may be located in the area of ‚Äã‚Äãthe Name field, and in the other - somewhere in the photo of the passport holder.  By recognizing different frames separately, and then combining the results for each field, you can significantly improve the accuracy of the extracted data.  This is just a statistic: for each passport field we will have a whole set of values ‚Äã‚Äãobtained after recognizing successive frames, for them we will be able to calculate the average value and use it as the final result, which will be returned to the user.  It is obvious that the average will change when adding data of the new processed frames, and it is logical to return the result only after its stabilization.  In our workings for evaluating stability, we use a probabilistic criterion and stop processing only when the probability of a change in the result becomes extremely small. <br><br><h1>  Recognition Dictionaries </h1><br>  When recognizing text, the machine goes through hypotheses and assesses how much a fragment of an image is similar to one or another symbol of a language.  In the case of processing images of poor quality is likely to choose the wrong hypothesis.  But we have the opportunity to ‚Äúprompt‚Äù to the discriminator which of the available hypotheses is more likely by connecting dictionaries containing the necessary vocabulary.  In the case of a passport, this gives a noticeable increase in the accuracy of processing, correcting such ‚Äúclassical‚Äù recognition errors, such as 'AND' -&gt; 'TH', 'O' -&gt; '0', etc. <br><br>  Regular expressions for numeric fields (dates, codes, and numbers) will also help.  Their use will allow to exclude situations where the numbers are confused with the letters ('B' -&gt; '8', '' -&gt; '3', etc.). <br><br><h1>  Filtering small text </h1><br>  Dictionaries will help to improve the quality of recognition of the main text, but they cannot cope with small reference text (field signatures).  That he did not interfere, it must be filtered.  You can do this, for example, based on its color and size.  These characteristics are noticeably different for the font, which is written the basic data of the passport, but still with their use errors are possible.  Therefore, the filtering criteria should not be too strict.  It is better to additionally use the information about the coordinates of the found text and throw away the garbage symbols located at a considerable distance from the main data. <br><br><h1>  Normalization of Recognized Values </h1><br>  Unfortunately, it‚Äôs not always possible to achieve 100% quality of the recognition of the main text and completely filter out all the small interfering garbage, and the remaining errors strongly affect the quality of the extracted data.  To improve the result, you can use special post-processing: <br><br><ol><li>  For numeric fields, it suffices to specify a regular expression describing this field and discard ‚Äúextra‚Äù characters that fall into the result but are not suitable for the format.  For example, there is not enough space in the passports for the ‚ÄúDate of Issue‚Äù field, therefore, often an incorrectly recognized signature to the field can ‚Äústick‚Äù to the value itself.  As a result, we will see, for example, the following result: ":: May 16, 2010".  Simple normalization will allow you to leave only the correct value for this field: "05/16/2010". <br><br>  In addition, when recognizing from a video stream, you can use format checks to speed up the process, completing processing when getting a stable result that matches the format.  Our internal tests show that this approach allows us to speed up the recognition process by about 15% without significant quality drawdown compared to the ‚Äúfull stabilization‚Äù described above. <br><br></li><li>  For vocabulary fields, you can use additional checking and correcting errors in the dictionary.  The dictionary feature will also be useful for speeding up the processing process ‚Äî returning the result for the field where all the words have passed the test, without waiting for the ‚Äúfull stabilization‚Äù of the meaning. </li></ol><br>  Of course, this is not all ideas and solutions that can be useful when recognizing a passport.  In our future articles, we will continue to talk about this problem. <br><br>  Passport recognition is one of the many data entry tasks you need to solve on a smartphone.  In practice, such tasks are much more.  For example, now almost all banks in their mobile applications offer the service of payment of housing and communal payments.  Automatic recognition of the data needed for this (subscriber code, personal account number, etc.) will significantly simplify and speed up the process. <br><br>  We at ABBYY are aware of the importance of such tasks, and therefore our team is actively working on a specialized API that will allow developers to quickly and as easily as possible create mobile applications to extract data from any documents.  And the <a href="https://www.abbyy.com/ru-ru/real-time-recognition-sdk/">ABBYY Real-Time Recognition SDK</a> is available now. <br><br>  Keep for updates :) <br><br>  <i>Olga Titova,</i> <i><br></i>  <i>product department for developers</i> </div><p>Source: <a href="https://habr.com/ru/post/325094/">https://habr.com/ru/post/325094/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325082/index.html">Terminal graphics</a></li>
<li><a href="../325084/index.html">Test items. Opinions and speculations</a></li>
<li><a href="../325088/index.html">Blog a la Habr, the choice of platform</a></li>
<li><a href="../325090/index.html">We start VMWare ESXi 6.5 under QEMU hypervisor</a></li>
<li><a href="../325092/index.html">Several arguments against Dependency Injection and Inversion of Control</a></li>
<li><a href="../325096/index.html">Kaggle: British satellite imagery. How we took the third place</a></li>
<li><a href="../325098/index.html">A new record in speech recognition: the error rate of the algorithm is reduced to 5.5%</a></li>
<li><a href="../325102/index.html">GTK3 applications in a browser with https and basic auth</a></li>
<li><a href="../325104/index.html">Asterisk. Integration with amoCRM, step-by-step guide</a></li>
<li><a href="../325106/index.html">Vivaldi 1.8 - Immersion in history</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>