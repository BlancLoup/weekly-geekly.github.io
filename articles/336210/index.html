<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sustainable channel based on a cellular modem cluster (SD-WAN): solve route selection problems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Field Tests 

 There is a commercial task: you need to quickly connect sites to a normal WAN network, but do it where there is only cellular coverage ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sustainable channel based on a cellular modem cluster (SD-WAN): solve route selection problems</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/77d/4fd/ab0/77d4fdab05554002acc8fb9d329f5c86.jpeg"><br>  <i>Field Tests</i> <br><br>  There is a commercial task: you need to quickly connect sites to a normal WAN network, but do it where there is only cellular coverage available and there is no possibility to run a cable or organize a radio relay transfer to fiber or copper. <br><br>  <b>The solution is modem clusters.</b>  The obvious problem of the solution is that each of the modems is a separate physical channel.  It is necessary with the help of a chisel and some mother to combine them into one encapsulated device, which will simply give up the channel.  In addition, it is necessary that when a cable appears, it is not necessary to change the box and reconfigure something. <br><a name="habracut"></a><br><h3>  From whom to choose </h3><br>  The technology is called SD-WAN.  The leaders are 3 American startups: Versa Networks, Viptela, Velocloud.  Classic network equipment manufacturers are trying to catch up.  In particular, Cisco states that they have 2 SD-WAN solutions - iWAN and Meraki.  But at the same time a couple of months ago they announced the purchase of Viptela.  And Riverbed bought Ocedo about a year and a half ago to launch SD-WAN solutions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, evaluated: <br><br><ul><li>  Cisco Systems </li><li>  Huawei, </li><li>  Nuage Networks, </li><li>  Viptela, </li><li>  VeloCLoud, </li><li>  Silver Peak, </li><li>  Versa Networks, </li><li>  Citrix, </li><li>  InfoVista, </li><li>  Riverbed. </li></ul><br><h3>  What got </h3><br>  We settled on the Versa decision;  first because of the price advantage.  Ordinary SDN solutions are used a little for other tasks, in particular, for uniting branches of companies into one logical network, visible to all terminals and servers as a single physical addressing space, somewhat similar to Cisco's DMVPN, but with its own blackjack in the form of ZTP, channel -bundling and SLA.  The chosen solution turned out to be a little more specific, and due to the lack of fullstack protocols of classic routers on the box itself and the use of standard components, the base cost was reduced.  Most vendors offer to buy hardware and software immediately or by subscription, but Versa does not do hardware, so software is by subscription, and hardware is from partners who make reference x86 boxes.  For customers, the cost model becomes more and more convenient with each passing year.  For example, the smallest box from Versa (pictured above) costs no more than the Cisco 800 Series, but it can pump 500 Mbps through itself.  And this is on IMIX traffic, where 90% of TCP and 10% of UDP are enabled while IPv4 Routing / Forwarding, IPSecEncryption, Layer 7 Application based traffic steering, CGNAT, NextgenFirewall (NGFW), QOS (Classification and Marking), SLA monitoring, internal service chaining, URL Filtering). <br><br><img src="https://habrastorage.org/web/c2d/d94/2ca/c2dd942cad4d432dbd7db1dea153d3cf.jpg"><br>  <i>SD-WAN concept</i> <br><br>  The principle of separation of control and data plane, as well as overlay, is taken from SDN.  The control plane is a Director (control) controller (BGP route reflector and IPSEC), Analytics is an optional component, but adds transparency to the services used on the WAN. <br><br><img src="https://habrastorage.org/web/fa5/b81/3ff/fa5b813ff63648b389aaa55dc6fcf827.png"><br>  <i>Comparison of those two boxes</i> <br><br>  The logic of work within each branch box. <br><br><img src="https://habrastorage.org/web/871/aa3/6f3/871aa36f329747b384c15c10c9293bbb.jpeg"><br>  <i>Logical box architecture</i> <br><br><h3>  How to install </h3><br>  The comparison is this: at the end of the year, Cisco will have the 19xx series in EOS, and it will have to be replaced.  That is, bypass (fly around, travel) physically all the points with their feet.  Versa allows you to send a box in place by any delivery service.  On the spot in the piece of iron will need to plug a modem or cable with the Internet.  As soon as the piece of iron has a fresh connection, it will build a VXLAN tunnel with the controller, receive IKE from it, and with it build the service IPSEC tunnel through which it will take the settings and receive the entire network‚Äôs routes from the controllers, I‚Äôm reminding you that the controller is BGP route reflector  All this happens completely automatically. <br><br>  That is, even an accountant can do it on site - he plugged the cable, a little magic, it worked. <br><br><img src="https://habrastorage.org/web/a33/8a5/76f/a338a576f1d74d8689c54fdbb9fd0cdb.jpeg"><br>  <i>Initialization of the box on the new site</i> <br><br>  <i><b>Here‚Äôs how the procedure looks in English-language documentation: 1. Controller‚Äôs IP address is the IP address in the IPSec config.</b></i>  <i><b>2. Establishes IKE session with controller over VXLAN tunnel.</b></i>  <i><b>3. Controller assigns an IP address to Versa Director.</b></i>  <i><b>4. VD IP address is notified to branch.</b></i>  <i><b>5. Branch installs reverse route to VD.</b></i>  <i><b>6. VD pushes the session and reboots the branch device.</b></i> <br><br>  The settings themselves are templates, with templates with variables ‚Äî they can include QOS, shaping, SLA, LAN settings, external channel balancing rules, and the bonding of these channels into one pipe. <br><br>  If there is a great desire, then you can climb on the box with your hands, the manufacturer has not yet closed this, and there, a surprise, Juniper-like-console. <br><br><h3>  Tests </h3><br><img src="https://habrastorage.org/web/fa8/739/e70/fa8739e7097541aa9d2df6c884aa70c9.jpeg"><br>  <i>Prototypes with two modems</i> <br><br>  To emulate a real network, where part of the boxes on the cable, and some for LTE-clusters.  3G-LTE-dangles were stuck into one piece of iron (at the time of the photo they were MTS and Megaphone), and into the second cable with the Internet from Garza.  Modems are combined into a pipe, the transmission of information.  Zhelezka looks traffic, recognizes it by application, imposes policies and criteria for prioritization. <br><br>  After a small finish, Megafon and MTS (as in the photo) with their locked modems began to be automatically recognized by the boxes.  Synthetic iperf traffic at 5 sessions gave out almost 50/50 balancing. <br><br><img src="https://habrastorage.org/web/6d2/c78/1dc/6d2c781dc4174e19a33ecb550bf8ced0.jpeg"><br>  <i>Monitoring functions built into the Director</i> <br><br><img src="https://habrastorage.org/web/56f/5ec/93d/56f5ec93d4104d018a1a6b40a6d883e0.jpeg"><br>  <i>Charts of loading two LTE-modems in the Director interface</i> <br><br>  The total band was about 50 Mbit, for each of the modems separately - 25 Mbit.  Embedded analytics out of the box in real time gave out statistics on the load. <br><br>  It was empirically very successful with telephony: for example, if there are 15 telephone calls at the same time, then we push the first to the eighth channel on the first channel, and the rest on the second one with high priority (in the second, other office services like mail). <br><br>  The second feature: in places where there are many drops on the last mile due to the nature of network loading or coverage, we managed to put a more or less stable connection. <br>  Tested per-packet balancing.  One TCP session is spread over two LTE interfaces.  Iperf was tested, one TCP session, in the dashboard you can see that it is divided into two channels.  That is, it works on synthetic traffic, then it already depends on each particular application, how they behave when such balancing is done.  For example, based on our own experience, we can confirm that video streaming over RTSP via VLC works fine.  This policy can be applied separately for each service.  That is, services that work well with per-packet balancing, we balance per packet, the rest - per-flow.  In this case, the politicians themselves roll out on the boxes on the button.  Because of this, best-practice considers doing several groups of sites: test ones closer to themselves (preferably in the office), then the second for early-deploy templates and policies and already the main one for production. <br><br>  Switching traffic from one LTE modem to another works.  We tested iperf with one session and all the same VLC video streaming.  You take out the modem on which the session is going on, there is a slight drawdown in bandwidth (iperf shows a drop of 40‚Äì60%), the video ruffles a little for a couple of seconds, then everything is restored. <br><br><h3>  Versa Features </h3><br><ol><li>  There is an analyst.  There are no external control systems, there is no need to monitor the channels separately using PRTG, etc., all at once as it should. </li><li>  One controller can serve any number of devices, in fact it is a web-scale.  In particular, there is no need for a telecom operator or cloud provider to deploy a separate SD-WAN solution in telco-cloud for each customer. </li><li>  If necessary for important traffic, there is a setting for duplicating packets on various channels to ensure content delivery. </li><li>  In addition, TPM-chips are used on the boxes.  These are special modules for storing encryption keys on devices.  At the initialization of the TPM module, a pair of keys is created - private and public.  The private key cannot be read: there are no methods to access it, but there is an API for calling the encryption-decryption method. </li><li>  Dynamic tunnels.  When controllers act as BGP route reflectors, they drop information on routes to the final piece of hardware of each site, and the spoke-to-spoke-tunnel is built only for the appearance of traffic between the sites.  And it also allows to ensure the scalability of the solution to thousands of sites. </li></ol><br>  Differences in classic site-to-site ipsec and in Versa SD-WAN IPSEC: <br><br><img src="https://habrastorage.org/web/0b2/68d/ba2/0b268dba2bb94b649cbea59aa1b37da5.png"><br>  <i>Versa VPN Cloud</i> <br><br>  Another important point: the glands for cellular operators are many times cheaper, it is possible to purchase almost directly from large factories.  To do this, the vendor gives the go-ahead to the plant to supply the devices directly to a large customer, and then gives the plant basic firmware.  The software is poured into the box, the box arrives to the telecom operator or cloud provider.  The provider clogs 2 parameters into it: the IP controller and the Internet access configuration (for example, static-IP).  Then the box is sent at least by RF mail to the customer.  The box itself will find what and how.  Compatibility is wide, that is, immediately IP-telephony services, video conferencing - everything can come in. <br><br>  There is also a standard Packet steering (SLA) and bonding - this is just the union of a group of external channels into one pipe and prescribing the switching logic for each service.  Moreover, the Versa or Riverbed solution automatically recognizes which service owns the passing traffic in order to communicate not at the ‚Äúport-type‚Äù session level, but at the ‚ÄúSkype for buisness corporate level to give priority, but not to give such normal Skype video calls‚Äù.  Bonding also helps to solve problems with the long provision of the last mile.  They inserted 3 LTE-modems from different operators and resolved the issue of site availability at 99.999. <br><br><img src="https://habrastorage.org/web/e30/871/e0a/e30871e0a6b84e48bcd47e4e60ecec4a.jpeg"><br>  <i>Dynamic tunnels between boxes at different sites</i> <br><br><h3>  Summary </h3><br><ol><li>  Now we have launched a service for setting up these glands in our country, and not in the US cloud (as in a number of vendors), in order to make life easier for Russian companies. </li><li>  This solution is very well suited for cellular operators and cloud providers.  For the former, it is an opportunity to sell retail (for example, a laundry, grocery or car service network), not only a channel for sending, say, reports and mail, but also an additional service for managing application traffic in a bundle of channels, as well as diverse monitoring of the performance of applications existing communication channels (the so-called managed service).  By the way, as the global trend shows, currently the largest projects on SD-WAN (the number of connection points) occur in the financial sector and large retail. </li><li>  Very simple repair.  If at the other end of the planet something broke in the grocery - the seller shoveles the cord from one ‚Äúbox‚Äù to another - and the config of the old one is automatically loaded to the new one in 10-15 minutes.  In general, if desired, even an accountant can handle it. </li><li>  To work with SD-WAN you do not need an IT specialist at the branch for any of the cases. </li></ol><br>  Everything.  I will answer questions in the comments.  Well, or write to the mail: MKazakov@croc.ru </div><p>Source: <a href="https://habr.com/ru/post/336210/">https://habr.com/ru/post/336210/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../336196/index.html">Room: Android data storage for everyone</a></li>
<li><a href="../336198/index.html">Neuro-authentication: an introduction to biometric authentication</a></li>
<li><a href="../336202/index.html">Another way to work with Promise for Redux</a></li>
<li><a href="../336204/index.html">How to become the best Android application developer: 31 tips</a></li>
<li><a href="../336208/index.html">Crashplan closes service for individuals</a></li>
<li><a href="../336212/index.html">Practice with dapp. Part 1: Build Simple Applications</a></li>
<li><a href="../336214/index.html">Announcement of the second Uptime community conference in Moscow: let's talk about the worst</a></li>
<li><a href="../336216/index.html">Study: hackers are increasingly renting Trojans for rent</a></li>
<li><a href="../336218/index.html">36 materials on neural networks: books, articles and recent research</a></li>
<li><a href="../336220/index.html">How to automatically pause an Adwords campaign when a site crashes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>