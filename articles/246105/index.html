<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Data structures: 2-3 heap (2-3 heap)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The question of an effective way to implement a queue with a priority by some data structure remains relevant for a long time. The answer to this ques...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Data structures: 2-3 heap (2-3 heap)</h1><div class="post__text post__text-html js-mediator-article">  The question of an effective way to implement a queue with a priority by some data structure remains relevant for a long time.  The answer to this question is always a kind of compromise between the amount of memory needed to store data and the time it takes to work on a queue. <br><br>  In computer science, heap structures are used to efficiently implement a priority queue. <br><a name="habracut"></a><br>  <b>A heap</b> is a specialized tree-type data structure that satisfies the heap property: if <i>B</i> is a descendant node of node <i>A</i> , then key ( <i>A</i> ) ‚â• key ( <i>B</i> ).  It follows that the element with the largest key is always the root node of the heap, therefore sometimes such heaps are called max-heaps (alternatively, if the comparison is turned over, the smallest element will always be the root node, such heaps are called min-heaps).  There is no limitation on how many descendant nodes each heap node has, although in practice their number is usually not more than two.  Heaps are crucial in some efficient algorithms on graphs, such as the Dijkstra algorithm and the pyramid sorting. <br><br>  One of the most studied and well-established data structures for storing and working with priority queues are the <a href="http://habrahabr.ru/post/112222/">Binary Heap</a> and the <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25B8%25D0%25B1%25D0%25BE%25D0%25BD%25D0%25B0%25D1%2587%25D1%2587%25D0%25B8%25D0%25B5%25D0%25B2%25D0%25B0_%25D0%25BA%25D1%2583%25D1%2587%25D0%25B0">Fibonacci Heap</a> .  But these structures have some peculiarities. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For example, a binary heap for basic operations has a laboriousness of Œò (logn), besides finding the minimum, and merging such heaps will require linear time (!).  But to store such a heap, you need little memory compared to other heaps. <br><br>  The Fibonacci heap is balanced when the node is removed from the heap, which reduces the complexity of the basic operations.  With a large number of consecutive operations of adding the Fibonacci heap grows in width and balancing occurs only with the operation of removing the minimum, so the operation of obtaining the minimum may require a significant investment of time! <br><br>  Tadao Takaoka took up the solution to this problem by <a href="http://www.cosc.canterbury.ac.nz/tad.takaoka/2-3heaps.pdf">publishing his work</a> ‚Äú2-3 heap‚Äù in 1999 ... <br><br><h2>  A little about the structure of "2-3 Heap" </h2><br>  <b>A 2-3 heap (2-3 heap)</b> is a tree-type data structure that satisfies the heap property (min-heap, max-heap).  It is an alternative to the Fibonacci heap (Fibonacci heap).  Consists of 2-3 trees. <br><br>  The solution that offers 2-3 heap, is that, unlike Heap Fibonacci, 2-3 heap balances not only when you delete, but also when adding new elements, reducing the computational load when removing the minimum node from the heap. <br><br>  The number of children of the vertex t of an arbitrary tree T is called the degree of this vertex, and the degree of the tree is the degree of its root. <br><br>  2-3 trees are trees T <sub>0</sub> , T <sub>1</sub> , T <sub>2</sub> , ..., defined inductively.  The tree T <sub>0</sub> consists of a single vertex.  A tree T <sub>i</sub> is a tree composed of either two trees T <sub>i-1</sub> or three: the root of each next one becomes the rightmost child of the previous one. <br><br>  Trees with 2-3 heaps we call trees H [ <i>i</i> ].  The tree H [ <i>i</i> ] is either an empty 2-3 tree, or one, or two 2-3 trees of degree <i>i</i> , connected by the same way as trees T <sub>i</sub> . <br><br>  2-3 heap is an array of trees H [ <i>i</i> ] ( <i>i</i> = 0..n), for each of which the heap property is satisfied. <br><br><img src="https://habrastorage.org/files/fb1/1c7/890/fb11c7890b7e4df28ef86d6b87aec23d.jpg"><br>  <i>rice</i>  <i>Heap view</i> <br><br><h3>  Node structure </h3><br><table><tbody><tr><td><img src="https://habrastorage.org/files/49b/e8a/2e4/49be8a2e4d7a4f75903d2f423369ed21.jpg"><br></td><td>  Each node has pointers to other nodes (fields with arrows), service fields and a pair of key (priority) - value. <br></td></tr></tbody></table><br><br><h2>  Basic operations </h2><br><br><h4>  Find the minimum in 2-3 heap (FindMin) </h4><br>  The minimum element of the heap is at the root of one of the heap trees.  To find the minimum node, you need to walk through the trees. <br><br>  By supporting a pointer to the minimum node in the heap, we can find this node in constant time (Œò (1)) <br><br><h4>  Insert in 2-3 heap (Insert) </h4><br><ol><li>  To add a new element, create a tree H [0] containing one vertex </li><li>  Perform the operation of adding this tree to the heap.  When adding a tree of degree <i>i</i> to the heap, the following options are possible: <br><ol><li>  If there is no tree with such priority, then simply add it to the heap. </li><li>  Otherwise, we extract such a tree from the heap and combine it with the added one, then add the resulting tree to the heap. </li></ol></li><li>  After adding we fix the pointer to the minimum root </li></ol><br><img src="https://habrastorage.org/files/902/2cc/856/9022cc856b134fc2bc9f69714ba7c400.jpg"><br><br><img src="https://habrastorage.org/files/f58/605/feb/f58605feba974f25bd9942ebbfed58b9.gif"><br>  rice  Animation of sequential addition of elements in 2-3 heap <br><br><h4>  Remove the minimum item from the heap </h4><br>  The minimal element of the heap is in the root of one of the heap trees, let's say in H [ <i>i</i> ] - we will find it using FindMin.  Extract the H [ <i>i</i> ] tree from the heap and delete its root, and the tree will split into subtrees, which we will later add to the heap. <br><br>  We will delete the root recursively: if the tree consists of one vertex, then simply remove it;  otherwise, disconnect from the root of the rightmost child and continue the removal. <br><img src="https://habrastorage.org/files/f37/d77/af5/f37d77af5f4f4345a60b5ba609e24f9b.jpg"><br><br><h4>  Decrease key at the element </h4><br>  First of all, we can freely reduce the key at the required node.  After that, you need to check: if the node is in the root of the tree, then nothing else needs to be done, otherwise you will need to remove this node with all the subtrees and insert it back into the heap (with the key already changed). <br><img src="https://habrastorage.org/files/4fe/163/bb5/4fe163bb51ae4296b0baae0ea39eecc4.jpg"><br><br><h4>  Combining two heaps into one </h4><br>  There are two heaps that need to be merged into one.  To do this, we will in turn extract all 2-3 trees from the second heap and insert them into the first heap.  After it will be necessary to correct the counter of the number of nodes: we summarize the number of elements in the first and second heaps and write the result in the counter in the first heap, and in the second heap we set the counter to 0. <br><br><h2>  Comparison of the complexity of operations with other algorithms </h2><br>  The table shows the complexity of operations queue with priority (in the worst case, worst case) <br>  The symbol '*' denotes the amortized complexity of operations <br><table><tbody><tr><th>  Operation </th><th>  Binary heap </th><th>  Binomial heap </th><th>  Fibonacci heap </th><th>  2-3 heap </th></tr><tr><td>  Findmin </td><td>  Œò (1) </td><td>  O (logn) </td><td>  Œò (1) * </td><td>  Œò (1) * </td></tr><tr><td>  DeleteMin </td><td>  Œò (logn) </td><td>  Œò (logn) </td><td>  O (logn) * </td><td>  O (logn) * </td></tr><tr><td>  Insert </td><td>  Œò (logn) </td><td>  O (logn) </td><td>  Œò (1) * </td><td>  Œò (1) * </td></tr><tr><td>  Decreasekey </td><td>  Œò (logn) </td><td>  Œò (logn) </td><td>  Œò (1) * </td><td>  Œò (1) * </td></tr><tr><td>  Merge / union </td><td>  Œò (n) </td><td>  Œ© (logn) </td><td>  Œò (1) </td><td>  Œò (1) * </td></tr></tbody></table><br><br>  Thank you for your attention! <br><br>  The source code of a C ++ implementation based on the author‚Äôs article 2-3 Heap is available <a href="https://github.com/biziwalker/23heap">on GitHub</a> under MIT. <br><br>  PS: When writing a course project on this topic, I realized that there was practically no information in RuNet, so I decided to deposit my couple of kopecks in this case, telling the interested community about this algorithm. </div><p>Source: <a href="https://habr.com/ru/post/246105/">https://habr.com/ru/post/246105/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../246091/index.html">Working groups in OpenCL 2.0. Heterogeneous working groups</a></li>
<li><a href="../246093/index.html">Hacker's guide to neural networks. Schemes of real values. Patterns in the "reverse" stream. Example "One neuron"</a></li>
<li><a href="../246095/index.html">Monitoring Methods in DWDM Systems (Part 1)</a></li>
<li><a href="../246097/index.html">The problem of the "7th of January"</a></li>
<li><a href="../246099/index.html">OpenStack, Docker and Web Terminal, or how we do interactive exercises for learning Linux.</a></li>
<li><a href="../246111/index.html">Fight for ping in WoT tanks in Khabarovsk, Krasnoyarsk and Vladivostok</a></li>
<li><a href="../246113/index.html">About ReactOS first-hand or ‚Äúconfrontation‚Äù with Alexey Bragin</a></li>
<li><a href="../246115/index.html">How to start a startup without money: personal experience on the example of coworking in Thailand</a></li>
<li><a href="../246117/index.html">Perl Birthday and Best Golf Solutions from Moscow.pm</a></li>
<li><a href="../246119/index.html">Passing more than 40 kilobytes via LocalConnection</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>