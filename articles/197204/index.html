<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Offline OSX Recovery from Recovery HD</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 
 In light of the release of OS X Mavericks Golden Master decided to look at the new beast, installing it on the outdated iMac7.1. The inst...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Offline OSX Recovery from Recovery HD</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/storage3/63f/214/d05/63f214d054c8ce6d3c2d7f9af33f88d7.jpg"><br><br><h4>  Prehistory </h4><br>  In light of the release of OS X Mavericks Golden Master decided to look at the new beast, installing it on the outdated iMac7.1.  The installation was successful, in the usual way from the working system version 10.7.  But everything worked very slowly.  This mac has experienced more than one OS generation update and a single installation with a ‚Äú0‚Äù.  Due to the lack of valuable data - it was decided to put it clean.  I reformatted the partition from recovery mode, aka Recovery HD, and here I was in for a nasty surprise and not even one.  Details of how to persuade, is no longer a kitty from Cupertino, without access to the Internet and a boot device <a name="habracut"></a><br><br><h4>  First surprise </h4><br>  When installed, Recovery HD was upgraded from version 10.7 to version 10.9, and from this follows the second surprise ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Surprise Two </h4><br>  Internet Recovery is a well-known OSX recovery mechanism over the Internet.  Log in to the Apple Store, if OSX is purchased, then the installer will download the necessary files via the Internet.  Works like a clock, or rather worked.  There is a small problem - the Mavericks are not in the Apple Store yet, and the DMG file with the operating system was obtained from Apple Dev, so it did not work out to restore it in the usual way.  " <b>An unknown error has occurred</b> " is what I met when trying to login. <br>  Scratching my turnips, I created a bootable USB flash drive.  Then a third surprise awaited me ... <br><br><h4>  Surprise the third </h4><br>  iMac refuses to see USB as a boot disk, for some incomprehensible (to me) reason.  At the same time, Disk Utility, in Recovery mode, sees it normally.  Having reset NVRAM, SMC and having played enough with all the flash drives found at home, I decided to try a portable disk.  If meekly - see the result of a flash drive.  The DVD writers and, most importantly, the 2-ply media was not at hand - I was despondent and crawled to Google. <br><br><h4>  Casket just opened </h4><br>  The result of a 2-day yaw on specialized forums allowed to install the Mavericks without access to the Internet and without the possibility of downloading from external media. <br>  It's simple, copy the Packages folder to the root of any flash drive with a capacity of more than 4 GB.  To do this, you need the downloaded dmg file downloaded from the Apple Dev (or obtained in another way). <br><br>  You can get this folder like this: <br><img src="https://habrastorage.org/storage3/6cb/89d/f2a/6cb89df2a502c04376d08e4afebf9055.gif"><br><br>  Reboot into recovery mode (with Alt clamped), connect the USB flash drive and start the Terminal <br><img src="https://habrastorage.org/storage3/44e/fc4/63f/44efc463f72d4e9d9373e465e616fd73.jpg"><br><br>  We check the list of devices, we are interested in <b>macHD</b> - the label of my hard drive in iMac and <b>usb-osx</b> - the label of the flash drive with the Packages directory in the root. <br><pre><code class="bash hljs">-bash-3.2<span class="hljs-comment"><span class="hljs-comment"># diskutil list /dev/disk0 #: TYPE NAME SIZE IDENTIFIER 0: GUID_partition_scheme *250.1 GB disk0 1: EFI EFI 209.7 MB disk0s1 2: Apple_HFS macHD 249.2 GB disk0s2 3: Apple_Boot Recovery HD 650.0MB disk0s3 ... /dev/disk3 #: TYPE NAME SIZE IDENTIFIER 0: GUID_partition_scheme *7.7 GB disk3 1: EFI EFI 209.7 MB disk3s1 2: Apple_HFS usb-osx 7.4 GB disk3s2</span></span></code> </pre> <br><br>  We look where these devices are mounted (paths are needed to form the installation command below) <br><pre> <code class="bash hljs">-bash-3.2<span class="hljs-comment"><span class="hljs-comment"># mount | grep macHD /dev/disk0s2 on /Volumes/macHD (hfs, local, journaled) -bash-3.2# mount | grep usb-osx /dev/disk3s2 on /Volumes/usb-osx (hfs, local, nodev, nosuid, noowners)</span></span></code> </pre><br><br>  Run the installation process. <br><pre> <code class="bash hljs">-bash-3.2<span class="hljs-comment"><span class="hljs-comment"># installer -pkg /Volumes/usb-osx/Packages/OSInstall.mpkg -target /Volumes/macHD installer: Package name is OS X installer: Installing at base path /Volumes/macHD 2013-10-13 21:36:12.016 installer[411:817f] Looking for system packages 2013-10-13 21:36:12.092 installer[411:817f] no system packages found 2013-10-13 21:36:12.093 installer[411:817f] No or Invalid system receipts found on /Volumes/macHD/Recovered Items 2013-10-13 21:36:12.093 installer[411:817f] Attempting fallback using: /System/Library/PrivateFrameworks/SystemMigration.framework/Resources/FallbackSystemFiles.plist 2013-10-13 21:36:12.423 installer[411:817f] Finding system files... 2013-10-13 21:36:13.907 installer[411:817f] Writing system path cache. 2013-10-13 21:36:13.941 installer[411:817f] FSF cache NOT written: /Volumes/macHD/Recovered Items/System/Library/Caches/com.apple.FindSystemFiles.plist No mount point for /Volumes/Image Volume/.IABootFiles Cant determine mount point of /Volumes/Image Volume/.IABootFiles Could not statfs() Could not determine filesystem of installer: The install was successful.</span></span></code> </pre><br><br>  Unfortunately, the installation process is not informative (no progress is visible), you can indirectly observe the change of free space on the macHD section in the adjacent terminal tab. <br><pre> <code class="bash hljs">-bash-3.2<span class="hljs-comment"><span class="hljs-comment"># df -h | grep macHD /dev/disk0s2 232Gi 3.4Gi 229Gi 2% 881294 59958448 1% /Volumes/macHD ... /dev/disk0s2 232Gi 3.5Gi 229Gi 2% 911436 59928306 1% /Volumes/macHD</span></span></code> </pre><br><br>  The installation takes about 1 hour, after completion it takes 7.3Gi on disk. <br><br>  After the end - we reboot. <br><pre> <code class="bash hljs">-bash-3.2<span class="hljs-comment"><span class="hljs-comment"># reboot</span></span></code> </pre><br>  After a reboot, we are greeted by a freshly installed OSX. <br><img src="https://habrastorage.org/storage3/3c4/974/3b4/3c49743b449d4be8cd9ffafa71d4376b.jpg"><br><br><h4>  Bonus </h4><br>  Having a little experimented, I found an interesting side effect - in this way, you can make a downgrade of the operating system, replacing the contents of the Packages catalog with earlier versions (10.7, 10.8) <br><br><h4>  Instead of conclusion </h4><br>  I hope the article was useful, comments and obscene language are accepted.  For myself, I received a pleasant confirmation that under the "ryushechkami" nice GUI OSX, hides the most powerful command line.  You just need to know how to cook it. </div><p>Source: <a href="https://habr.com/ru/post/197204/">https://habr.com/ru/post/197204/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197192/index.html">Introducing components in Markdown webdocs</a></li>
<li><a href="../197194/index.html">Kickstarter in Canada. Results of the first month of work</a></li>
<li><a href="../197198/index.html">LG Smart TV Apps Contest 2013-2014 + Bonus: an interview with last year's finalist</a></li>
<li><a href="../197200/index.html">PHP support in Google App Engine!</a></li>
<li><a href="../197202/index.html">OPPO Clover R815. Emphasis on music</a></li>
<li><a href="../197206/index.html">New Acer Chromebook for $ 249.99</a></li>
<li><a href="../197208/index.html">The cosmonauts of the ISS will test a mini-brewery created by an 11-year-old schoolboy.</a></li>
<li><a href="../197212/index.html">Introduction to data visualization when analyzing with Pandas</a></li>
<li><a href="../197214/index.html">Session API in Yii with the ability to store in Redis</a></li>
<li><a href="../197216/index.html">PicUntu 4.5 installer: an easy way to install Ubuntu on devices with Rockchip RK3188</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>