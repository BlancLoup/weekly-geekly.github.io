<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Red arrows of extra reality</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="My readers already know that the manual direction finder and augmented reality are made for each other. A simple background of the video can significa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Red arrows of extra reality</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/59/db/27/59db2798c440a188943797.png"></p><br><p>  My readers already know that the manual direction finder and augmented reality are made for each other.  A simple background of the video can significantly simplify the work of the operator.  Nevertheless, there are people who have difficulty in finding sources of radio-radiation with an amplitude direction finder with a simple video background.  Simplification of the process requires a closer integration of the direction finder with the "heavy" additional reality.  Despite the emergence of technologies such as ARKit and ARCore, the most accessible remains Google Tango. </p><br><p>  Augmented reality for a beautiful picture, so inside not only technical details, but also video clips of the direction finder in one of the most beautiful places in St. Petersburg. </p><a name="habracut"></a><br><p>  Technology Google Tango many times described on Habr√©, the best descriptions <a href="https://habrahabr.ru/company/byyd/blog/303480/">here</a> and <a href="https://habrahabr.ru/company/google/blog/309876/">here</a> .  In our case, of the number of components of the technology, only the ability to track movements and orientations (Motion Tracking) is used.  The possibility of separating flat and other surfaces, we actually do not need.  After all, the source, in this case, the WiFi device, can be located behind the wall and at the same time be quite a bearing.  Although it is clear that if there is nothing in front of the Tango camera, then she (Tanga - she) cannot track the movements and orientation.  Maybe in the future it will be possible to automatically build a 3D map of the surrounding space and save it along with the video as a result of the work, but for now this is fantastic. </p><br><p>  It is possible to briefly justify the use of the technology of visual inertial odometry (Visual-Inertial Odometry) for the orientation of the direction finder with their better accuracy compared to inertial systems only.  Coordinate and orientation data supplied <br>  devices with Tango are local, they are tied to the starting point.  But, within the session, they, in contrast to inertial data, have much greater accuracy. </p><br><p>  The WiFi hotspot direction finder described <a href="https://habrahabr.ru/post/323638/">earlier</a> was assigned as the test subject.  It is designed to search for illegal access points (rogue AP) and devices of the Internet of things based on WiFi.  Although Bluetooth is pushing new technologies, such as <a href="https://habrahabr.ru/company/vasexperts/blog/333998/">Mesh</a> , thanks to the World Forge of All Existing, the use of WiFi-based things is very economically justified.  This is confirmed by articles on Habr√©: <a href="https://habrahabr.ru/post/255625/">here</a> and <a href="https://habrahabr.ru/company/masterkit/blog/256931/">here</a> . </p><br><p>  Direction finder on a regular Android works like this: </p><br><p><img src="https://habrastorage.org/webt/59/da/ff/59daff2cc1760847083150.gif"></p><br><p>  If anyone is interested, see the source on <a href="https://github.com/xnzr">github.com/xnzr</a> and <a href="https://www.youtube.com/channel/UCO6vbgRx703M1wbkMN73zBQ">various videos</a> .  Unfortunately, I am not a professional in the video, and the videos are not very high quality, for which I ask forgiveness in advance.  But to show the work of this direction finder is only possible on video. </p><br><p>  Let's start with iron.  The first Tango tablet was from Google, and it was called Google Tango Tablet.  First there was the epic story of getting this miracle to Russia.  Officially it was impossible.  I was forced to create a fake account on Gmail from Finland, to order in the Google store from Finland to the mailbox in Finland.  And I thought it was lucky that I got the device with such a little blood.  And you say - sanctions.  Then there were still no sanctions, and the curtain was already there.  From the other side. </p><br><p>  But this is not the end.  It turned out that the USB port of this miracle does not pull even the direction finder.  I had to invent an external removable power bank to power the direction finder and a special cable for it.  It looked awful (there is no direction finder in the photo, only four of its 3M Dual-Lock adhesives are visible): </p><br><p><img src="https://habrastorage.org/webt/59/db/08/59db08020b091123098570.jpeg"></p><br><p>  Well, to hell with emotions.  Then everything went well.  Work on the software was delayed, as often happens.  And soon (Oh, thank you, great Google and its best friend Lenovo) appeared Lenovo Phab 2 Pro!  The only available in Russia and, apparently, the latest tablet with Google Tango.  The gadget is sturdy, powerful and large, which is important for the direction finder.  At the same time, it is cheaper than gadgets with ARCore support, on average, by 10 tr.  The direction finder sits on it beautifully: </p><br><p><img src="https://habrastorage.org/webt/59/db/0b/59db0b78c0857111585226.jpeg"></p><br><p>  Therefore, the Google Tango Tablet was placed in <del>  sarcophagus </del>  Museum of hand-held DR-finders until better times.  And may the power bank be with him. </p><br><p>  Now about the software.  It is, as always, available in source, at <a href="https://github.com/xnzr/xnzr-tango">github.com/xnzr/xnzr-tango</a> .  The point is quite simple: if the threshold for the difference in the levels of two antennas, meaning that the source is close to the normal to the plane of the direction finder, is exceeded, then a red arrow is stuck into the space.  These arrows are not erased, but are accumulated in space, which allows not to track the binding of the direction-finding parameter to the terrain by the brain, but to be guided by the arrows hanging in space. </p><br><p>  The arrows are displayed by the SagittaStorage and OpenGlCylinder classes. </p><br><p>  When the direction finder reports that it is directed to the WiFi source, we request the current ‚Äúpose‚Äù of our Tango device (or rather, not the pose itself, but only the transition matrix): </p><br><pre><code class="java hljs">TangoSupport.TangoMatrixTransformData depthTarea = TangoSupport.getMatrixTransformAtTime(pointCloud.timestamp, TangoPoseData.COORDINATE_FRAME_START_OF_SERVICE, TangoPoseData.COORDINATE_FRAME_CAMERA_DEPTH, TangoSupport.TANGO_SUPPORT_ENGINE_OPENGL, TangoSupport.TANGO_SUPPORT_ENGINE_TANGO, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (depthTarea.statusCode == TangoPoseData.POSE_VALID) { mRenderer.addPeleng(depthTarea.matrix); }</code> </pre> <br><p>  And we put in CopyOnWriteArrayList (this is a multi-threaded version of ArrayList). </p><br><p>  Each frame we in turn apply the saved matrices to the cylinder and draw the cylinder in all saved "poses": </p><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GL10 gl)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>[] mm : mModelMatrixList) { mSagittaObject.setModelMatrix(mm); mSagittaObject.draw(gl); } }</code> </pre> <br><p>  As I wrote above, the only way to show the work of such a direction finder is video.  As a WiFi hotspot was my smartphone with the Internet sharing feature enabled.  The direction finder accepts Beacon Frame packets and delivers the data to the tablet, which displays them in red arrows of augmented reality (KSDR).  Links to test videos are below.  The videos were shot in the Summer Garden on a weekday afternoon, so there were not many people who saved me from unnecessary adventures and gave an amazing background <del>  with elements of antique nude </del>  .  You can even watch the kids. </p><br><p>  <a href="https://www.youtube.com/watch%3Fv%3D1cGraYWEAYw">First</a> one <br>  <a href="https://www.youtube.com/watch%3Fv%3DfG4SdDxfe5s">second</a> one <br>  <a href="https://www.youtube.com/watch%3Fv%3DZLvfgW1T5pk">third</a> <br>  <a href="https://www.youtube.com/watch%3Fv%3DFfk5X3jXvv4">and more</a> <br>  <a href="https://www.youtube.com/watch%3Fv%3D8hmWTg8V8hg">and more</a> <br>  <a href="https://www.youtube.com/watch%3Fv%3DkDlUtPiTJvU">and more</a> . </p><br><p>  Those who do not like to watch the video, I recommend to see the photo (in full resolution, a large amount of files): <a href="">1</a> , <a href="">2</a> , <a href="">3</a> , <a href="">4</a> , <a href="">5</a> , <a href="">6</a> , <a href="">7</a> , <a href="">8</a> and <a href="">9</a> . </p><br><p>  Naturally, it is possible in the software to find the intersection of red arrows and build and display the area of ‚Äã‚Äãspace where the source is most likely located.  We can say that today there is not just a new interface with an augmented reality style for the direction finder, but a base for fully automatic search of radio emission sources with display of results in 3D.  In the future, it will also be possible to make more vivid the presentation of the results of my phase satellite finder on satellite navigation, described <a href="https://habrahabr.ru/post/332746/">here</a> and <a href="https://habrahabr.ru/post/337608/">here</a> . </p><br><p>  I want to note that Mikhail Lukin, who is also <a href="https://habrahabr.ru/users/ktator/" class="user_link">Ktator</a> , helped me in the software part (for which I thank him so much), which I hope will continue publishing on Habr√© on augmented reality for radio direction finders.  I will try to focus on the gland. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/339586/">https://habr.com/ru/post/339586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339572/index.html">API on Swift in five minutes. Lecture in Yandex</a></li>
<li><a href="../339576/index.html">REPL - setting for saving history and loading modules by default</a></li>
<li><a href="../339580/index.html">Using the event model in Doctrine 2 + Symfony 3</a></li>
<li><a href="../339582/index.html">About design patterns for working with RDBMS</a></li>
<li><a href="../339584/index.html">We make life easier with the conclusion of SLA</a></li>
<li><a href="../339590/index.html">Webpack and addictions</a></li>
<li><a href="../339592/index.html">Functional F #, which slowly appears in C #</a></li>
<li><a href="../339594/index.html">Expansion of analytical capabilities of the linear programming method with Python tools</a></li>
<li><a href="../339596/index.html">The history of hacking all the games in Telegram</a></li>
<li><a href="../339602/index.html">Service control panel. Part 1: Introduction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>