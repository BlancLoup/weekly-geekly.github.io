<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Scarless Face or First Steps in Multicad.NET API 7 (for Nanocad 8.1)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="By the will of fate, it turned out that for one of my hobbies, I needed to poke around in the API for the domestic CAD system Nanocad , while not havi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Scarless Face or First Steps in Multicad.NET API 7 (for Nanocad 8.1)</h1><div class="post__text post__text-html js-mediator-article">  By the will of fate, it turned out that for one of my hobbies, I needed to <a href="http://www.nanocad.ru/">poke</a> around in the API for the domestic CAD <a href="http://www.nanocad.ru/">system Nanocad</a> , while not having any practical skills in developing for CAD. <br><br>  And if a couple of years ago in a similar situation, when I decided to look at the API for Revit purely for the sake of curiosity, there were no problems at all, then everything was not so simple with Nanocad. <br><br>  In memory, and with all due respect to Mikhail Nikolayevich, one can say: ‚ÄúBreathe air into the chest ...‚Äù these Americans posted on their website in the public domain ... <a href="https://knowledge.autodesk.com/ru/support/revit-products/learn-explore/caas/CloudHelp/cloudhelp/2014/RUS/Revit/files/GUID-8EB25D2A-3CAF-486A-BA8E-C2BEF3DB68F6-htm.html">instructions for getting started</a> !  What are they all there ... well, in general, you understand, this is not ‚Äústore in onions in pantyhose‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But we, as decent people, will not scold people who gave us a completely sane product for free and access to development tools, just try to help them a little, especially since the latest publication on MultiCad.  NET API was <a href="https://habrahabr.ru/company/nanosoft/blog/269203/">in the Nanosoft blog</a> on Habr√©, almost two years ago and it is necessary to fill a little vacuum. <br><br>  Unfortunately, as a complete newcomer to this issue, I will not be able to give you the material of really decent quality, but at least we will consider those issues on which I immediately had a ‚Äúplug‚Äù.  It turns out, as in the last <a href="https://habrahabr.ru/post/331118/">cycle on Data Science</a> article from a beginner - beginners. <br><br>  The plan is something like this: a few words about Nanocad, a bit of general programming about Nanocad, and at the end writing a primitive command using MultiCAD .NET API 7 (for Nanocad 8.X). <br><br>  So, we hide the drawings in the tube, remove the drawpieces, push the patterns on the mezzanine, and you are welcome under the cat. <br><br><img src="https://habrastorage.org/webt/rb/74/xv/rb74xv1nactakkmjgzjsrqdjohi.png"><br><a name="habracut"></a><br>  Dear reader, if you see these lines, know that you are in GREAT danger!  Those who have read <a href="https://habrahabr.ru/post/340698/">my past articles</a> know that lately I have been supplementing headlines with something stylized for greater artistic expression, now I play on films, now proverbs. <br><br>  I don‚Äôt know why, but when I started writing this article, I realized that I simply had to fill it with references to excerpts from the monologues of the Golden Age of the ‚ÄúAnshlag‚Äù and ‚ÄúSmehopanorama‚Äù programs.  So, this article is only for people with strong spirit. <br><br>  Content: <br><br>  <a href="https://habr.com/ru/post/342186/">Part I: ‚ÄúI do not get paid for it!</a>  <a href="https://habr.com/ru/post/342186/">(Introduction).</a> <br>  <a href="https://habr.com/ru/post/342186/">Part II: Import Substitution</a> <br>  <a href="https://habr.com/ru/post/342186/">Part III: Access to the API, documentation, where to start.</a> <br>  <a href="https://habr.com/ru/post/342186/">Part IV: Set up the development environment and write a simple command.</a> <br>  <a href="https://habr.com/ru/post/342186/">Part V: It's a shame!</a>  <a href="https://habr.com/ru/post/342186/">(Conclusion)</a> <br><a name="I"></a><br><h3>  1. I do not pay for it!  (Introduction) </h3><br> <a href="https://youtu.be/iqVvKvpIUtM%3Ft%3D7m49s"><img src="https://habrastorage.org/webt/95/du/f2/95duf2tiktop85pnpz1xbwjkkhc.png"></a> <br><br>  To begin with, it would be appropriate to say that I am in no way connected with Nanosoft, they don‚Äôt pay me any money, so all that will be in the article is my personal opinion. <br><br>  By the way, this opinion will be quite positive.  My full acquaintance with Nanocad began many years ago, when my colleague <a href="https://habrahabr.ru/users/drzugrik/" class="user_link">Drzugrik</a> was still young trainees and fate brought us to a good company, for which the use of pirated software was unacceptable.  Naturally, for two ‚Äústudents‚Äù there was no AutoCAD license, and it was then that Nanocad us out. <br><br>  True, it should be noted that all the free versions of the 3.X family cost me a lot of pulled out hair and foul language, but then version 5.1 ( <a href="http://www.nanocad.ru/products/nanocad_free/capabilities">Nanocad Free</a> ) came out, which is quite a convenient ‚Äúelectronic drawing board‚Äù.  I still use it when I need to jot down some simple "scheme", for example, this one: <br><br><img src="https://habrastorage.org/webt/gf/4y/p6/gf4yp6btwazy-6spfiss4lkmpgo.png"><br><br>  As you can see, the interface is similar to the old-fashioned AutoCAD ‚Äúdolentochny‚Äù, and the functionality is similar to AutoCAD LT of the ‚Äúend of zero‚Äù.  True, in contrast to the LT version of Avtokad, in the free Nanocade there is some possibility to work with 3D, there is not much benefit from it unless students do tasks on descriptive geometry (I drew myself views and isometry, I looked, and then I copied). <br><br>  And in terms of two-dimensional design for the construction industry, the functionality of the free version may well be enough for freelancers or small design offices and construction and assembly organizations. <br><br>  There is certainly a paid version, at the moment Nanocad 8.5, I honestly do not like all the charms of automation, which it gives.  But if you believe the book ‚ÄúPath to Nanocad‚Äù (about it later), then it seems to be really convenient to work, but I myself didn‚Äôt come across in practice, I can only imagine how much time automating some fields in the drawing and automated control with NormaCS could save. <br><br>  Unlike the free version in the paid version, 3D seems to be better, but 2D parametrization and 3D modeling will have to be paid separately (in addition to the license for Nanocad Plus), for foreigners, this version is simply dubbed <a href="http://nanocad.com/page/NanoCADPro">NanoCAD PRO</a> <br><br>  The whole trouble is that, as I understand, in our country of companies where the design process is put on the "mind" is probably still less than offices where everything "should be done yesterday" and "on the knee", but on people implementers of automation are looked upon as holy fools.  This is true my personal opinion and at the same time, it is far behind the reality, it may already be a bright future, a ‚Äúgarden city‚Äù and all that, then I will be very happy for my homeland =) <br>  But back to the Nanocad, in the light of the current world conjuncture he has for Russian companies (including state-owned companies) one chip, namely ... <br><a name="II"></a><br><h3>  2. Import substitution </h3><br> <a href="https://vk.com/video44500869_171454063"><img src="https://habrastorage.org/webt/35/ac/--/35ac--iqko5dvhg_ouefpzvfyr0.png"></a> <br><br>  Life somehow does not become calmer, extends sanctions, and you see that it comes to the point that we will crush the sanctions distributions on DVDs with a bulldozer, what then do? <br><br>  It should be noted that historically, we have an overwhelming advantage in products of Autodesk and its twin brothers in the field of building design, products of the company Ascon (Compass), somehow did not take root, although sometimes the projects carried out in Compass, are also found.  It should be noted that this is again my personal opinion, I hope it will not provoke a ‚Äúholivar‚Äù. <br><br>  Well, going back to ‚ÄúAutoCAD and Company‚Äù what do we have?  Autodesk products are quality but expensive and the office is central in the USA.  There are BricsCAD and ZWCAD, they are of course cheaper, and for example the same BricsCAD will tell a bunch of advantages about itself <a href="http://bricscad-russia.ru/info.php%3Fpage%3Dcompare">in comparison with others</a> , but still, despite the presence of domestic offices, they can also be considered foreign.  These programs have their fans, but I can‚Äôt say anything about them - I didn‚Äôt use it. <br><br>  There is also DRAFTSIGHT, which has a free version for private use that runs under Linux, neither say anything bad nor good about it, I used it for about 30 minutes, probably, and that for a long time. <br>  Well, there certainly is ArchiCAD, but it seems to me there is a slightly different concept and we will not compare them now. <br><br>  There are other CAD systems, including domestic ones, I know very little or nothing about them. <br>  The main thing is that, apart from the dependence on the Open Design Alliance, Nanocad is probably the first candidate for the "import substitution" of some Autodesk products in the field of building design. <br><br>  Note that the platform has a vertical of solutions and you can meet various specializations from mechanics to modern BIM, I honestly have not encountered them in practice and I can not say whether, for example, Nanocad ‚ÄúEngineering BIM‚Äù can replace the solutions based on Revit. <br><br>  By the way, it would be appropriate to say thanks to Autodesk, because if you believe the forum, then the update of the free version of Nanocad was tied exactly to the update of the DWG format to the version of DWG 2018. The exact <a href="http://forum.nanocad.ru/index.php%3Fshowtopic%3D7837">timing of the update of the free version is still unknown</a> . <br><br>  Well, besides paid products, let us recall that there is of course an opensource solution: FreeCad, LibreCAD, QCAD - I sincerely wish them success, but I think few people dare to build a project business based on them, at least for now. <br><br>  Well, in order to move smoothly to API issues, I‚Äôll say that the MultiCAD .NET API theoretically allows you to write universal applications that will run <a href="https://habrahabr.ru/company/nanosoft/blog/242497/">in Nanocad, AutoCAD, ZWCAD</a> .  In the case of a non-native platform, the libraries are launched through the software layer.  True, in practice, I failed to verify this now, and why?  And because I only have AutoCAD 2017 installed on my PC, and there is an accessible ‚Äúlayer‚Äù on the developer portal, it does not support it (the edge is AutoCAD 2016).  So that we leave the evidence on the conscience of the developers. <br><br>  Now we finally began to smoothly approach the problems that the novice developer will face, determined to master the Nanocad API. <br><a name="III"></a><br><h3>  3. Access to API, documentation, where to start. </h3><br> <a href="https://www.youtube.com/watch%3Fv%3DRaaJQLutyy4"><img src="https://habrastorage.org/webt/ee/cm/d0/eecmd0s4nf8rduao7u1-d9ivfbq.png"></a> <br><br>  Perhaps the most rational way will be to register in the <a href="http://developer.nanocad.ru/">"Club of Developers"</a> Nanocad.  Fill in a simple questionnaire, wait for approval (I think if it is adequately filled out, then there should be no problems), after which you get access to resources for development. <br><br>  What are these resources: <br><br><ol><li>  Access to licenses and distributions of released versions of Nanocad, including some beta versions, as well as directly to the API itself (SDK package). </li><li>  Access to a private forum for developers (not to be confused <a href="http://forum.nanocad.ru/">with a regular forum</a> ) </li><li>  Communication with developers, the ability to point to a "bug" or request a "feature." </li></ol><br>  Well, in words everything looks very good, in practice, of course, it is also good, but still with a fly in the ointment. <br><br>  I think, since this direction is non-core and not monetized, they are doing it on a residual basis, so, for example, only beta version 8.5 is available on the developer portal, although the company‚Äôs portal has already posted a full version.  The problem is that the full version with of.  site, in my opinion, goes without the SDK, so sit down think strongly the SDK from the beta is different from the final or not. <br><br>  Well, as I mentioned above, the MultiCAD_AC_ZC_Enabler_2209_RU package (a set of ‚Äúlayers‚Äù for API work in other CAD) has probably already been updated too, but there is no newer version (for AutoCAD 2017). <br><br>  But once again, and for that - <b>thanks!</b>  These are trifles, the main thing is that you can get licenses for new and old versions of the program, and start sawing your application (licenses are given only for development). <br><br>  The second problem is the API documentation, it should be noted that there are APIs for many languages: pure .NET API (not Multikad), C ++, Lisp, but we will talk today only about the MultiCAD API .NET.  So, if you are accustomed to a detailed description of classes, methods, properties in native libraries from Microsoft, you will certainly be disappointed.  Most of the descriptions in the help seem to be automatically generated, but sometimes there are still classes for which there is an explanation.  It turns out that if you are ‚Äúnot any programmer‚Äù (as I am) and you are not a brilliant detective at the same time, in order to immediately solve the logic of the API, then you cannot do without outside help. <br><br>  Where can we get help?  And almost nowhere except the developers forum.  But about the forum a little later, but to begin with about literature. <br><br>  With educational literature, everything is simple - it is almost there!  In the API documentation itself there is a small explanation of how to create a project (more on this in the next chapter), a couple of short notes and a few examples. <br><br>  There is a book <a href="http://www.nanocad.ru/book">‚ÄúThe Way to nanoCAD‚Äù</a> , since I was ‚Äúvery secured‚Äù, I even bought it (by the way, I found it cheaper than on the official website).  The book itself is good, you can scroll through the day, and thus find out what you can (and cannot) do in Nanocad 8.X and how quickly you can transfer to it from AutoCAD.  The book has the 13th chapter, which summarizes the basic concepts of programming for Nanocad.  But there is not much information and porridge from it can not be cooked, in fact, this statement of reference from the SDK + is a few good techniques and explanations. <br><br>  What else is there?  There are articles in the company's blog on Habr√© or, which is more convenient in my opinion, the same articles in the <a href="http://developer.nanocad.com/blog/">English version of the blog via API</a> (there they are not mixed with articles that are not related to the development).  The articles are good, but they are frankly small and they rarely come out, as I mentioned at the beginning, the latter came out almost 2 years ago. <br><br>  The community at Nanocad is small, so it seems that all that remains is a forum for developers.  On the one hand, it is clearly impossible to say that the forum is living a stormy life, that there is a boom and so on.  On the other hand, the specialists of the company try to answer normal questions during the day, for which they are thankful.  But with ‚Äúabnormal‚Äù (stupid) questions, things are worse, there is no one to answer them (so I sometimes communicate with myself there). <br><br>  I think the main problem is that there are few enthusiasts on the forum.  And in order to fix this, I am writing now, and you are reading this article. <br><br>  Another important point is licensing. <br><br>  Firstly, by joining the developers club you sign a contract (well, in the sense of clicking the "I agree" button), in which it is written in a difficult legal language that it is possible and impossible. <br><br>  The question of the interpretation of this contract in terms of the rights to your applications (libraries) to the developers was asked by various people, including <a href="http://forum.nanocad.ru/index.php%3Fshowtopic%3D7271%26hl%3D%26fromsearch%3D1">me</a> .  The meaning of the answers is something like this: Nanosoft does not limit the free use and distribution of your work on the basis of the Nanocad development tools. <br><br>  And in order to find out it is not necessary to join the club, simply read the license agreement for any version of the program (at least since version 5).  For example, the SDK for the free version 5.1 is available inside the distribution (at least it used to be), that is, in principle, it looks like a club and you don‚Äôt have to join, but if you want to use the latest API versions (and we want, because in NC5 .1 it is scanty), you still have to enter. <br><br>  But enough to say, it's time to do something useful, let's move on to the part for which the whole article was conceived. <br><a name="IV"></a><br><h3>  4. Set up the development environment and write a simple command. </h3><br>  Before we begin, I will say that we chose the MultiCAD .NET API not only for its ‚Äúcross-platform‚Äù nature, but also for the ability to create <a href="https://habrahabr.ru/company/nanosoft/blog/184482/">custom primitives</a> (but in this example we will not create them). <br><br> <a href="https://www.youtube.com/watch%3Fv%3DUiiCaxSEwc8"><img src="https://habrastorage.org/webt/zk/qw/gt/zkqwgtjomuyixwwgw3pconjsm2o.png"></a> <br><br>  So, we are going to write a team that draws a face, the one on the left, but then you will draw your own on the right (just kidding).  We will focus on Nanocad 8.1, but the code is simple and I think it will go in any version of the 8.X. family. <br><br>  We will write and collect the code in MS Visual Studio.  Ok, and which version to choose?  It all depends on our goals.  So the examples included in the SDK for NC 8 were collected in MS Visual studio 2012. And when you try to open them in later versions, a solution update wizard may appear. <br><br>  Unfortunately, since I haven‚Äôt collected the whole package from the SDK, I can‚Äôt say whether the conversion to a newer version of the project influences its performance.  But I can say for sure that if you download the free VS Express Desktop 2012, then the projects in the SDK will not be cursed and, in principle, they can be collected calmly. <br><br>  By the way, if you want to download VS Express Desktop 2012 <a href="https://my.visualstudio.com/">from the Microsoft website</a> , it‚Äôs not a fact that you will succeed, in my case, MS apparently thinks that I am crazy and if you persistently try to download it, it blocks me, but fortunately this version can also be found on the web , but again, the registration service seems to have died, so I‚Äôll also have to look for the code. <br><br>  Anyway, that example that we will write with you now can be collected in a later version of Visual Studio.  For example, I use VS 2015 Community edition, but I think in 2013 and in 2017, I also have to go. <br><br>  The first thing to start is to create a project (this information is also in the SDK). <br><br><img src="https://habrastorage.org/webt/kn/-w/-n/kn-w-nszo77qhfzmvnpve1msyis.png"><br><br>  Attention choose .NET Framework 4.0 This version is used in the API for NC8 (for NC 5.1, for example, .NET Framework 3.5).  Next, select the class library, the name you can choose what you want. <br><br>  Next you need to connect the libraries from the MultiCAD .NET API (mapimgd.dll and mapibasetypes.dll), as in the picture: <br><br><img src="https://habrastorage.org/webt/fw/z2/a6/fwz2a69aasjndf8gcpbg2mi8vp4.png"><br><br>  Be sure to remove the item locally in the properties: <br><br><img src="https://habrastorage.org/webt/oc/yo/0w/ocyo0wwuaxjdzbpjzhjl5vbgbbo.png"><br><br>  Configure the debugger so that our assembly opens immediately in Nanocad.  To begin with, in the properties of the project, we specify nCad.exe as the application being launched (as in the picture). <br><br><img src="https://habrastorage.org/webt/20/wz/i2/20wzi28durjyw5xe7pt7wvboke8.png"><br><br>  Let's connect our library to the list of startup files (so as not to call the netload command every time).  To do this, in our case (for NC 8.1), go to C: \ ProgramData \ Nanosoft \ nanoCAD x64 Plus 8.1 \ DataRW and find or create the load.config file with the following content. <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"C:\Users\...\bin\Debug\nanoforhabr1.dll"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Instead of three points, naturally, the full address to your project folder.  It is not necessary to be limited to one record in the future, you can add another 1 section if you have your own libraries. <br><br>  Now, when you press F5, our project will be immediately loaded into Nanocad and you will only have to type the command that we will write. <br><br>  As usual, we are going to sort it out into pieces now, and the full text is available on <a href="https://github.com/bosonbeard/Funny-models-and-scripts/tree/master/2.ForNanoCAD/2.Some_simple_scripts">GitHub</a> (only. * Cs file is located at this address, if necessary, create a project yourself) <br><br>  So, for the beginning we will write the necessary namespaces: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Multicad.AplicationServices; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Multicad.Runtime; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Multicad.DatabaseServices; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Multicad.Geometry; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Multicad.DatabaseServices.StandardObjects; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Windows.Forms;</code> </pre><br>  Next, create a team. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">nanoforhabr1</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">startfor81</span></span> { [CommandMethod(<span class="hljs-string"><span class="hljs-string">"Dface"</span></span>, CommandFlags.NoCheck | CommandFlags.NoPrefix )] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DrawFace</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {</code> </pre><br>  Attribute [CommandMethod ("Dface", CommandFlags.NoCheck | CommandFlags.NoPrefix)] <br>  It defines the name of the command that we will enter in the NC command line (in our case, Dface), and then the flags go; I‚Äôm not ready to say about the flag values ‚Äã‚Äãyet.  Then immediately comes the name of the class in which we implement our "business logic", the name of the class is any - at your discretion, I have public void DrawFace () <br><br>  In the next section, we will draw the left half of the face. <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//We draw half of face // Draw eye DbCircle eye = new DbCircle(); eye.Radius = 100; eye.Center = new Point3d(200, 500,0); eye.DbEntity.AddToCurrentDocument(); //Draw nose DbLine nose = new DbLine(); nose.StartPoint= new Point3d(350, 400, 0); nose.EndPoint = new Point3d(350, 200, 0); nose.DbEntity.AddToCurrentDocument(); //Draw mouth DbPolyline mouth = new DbPolyline(); List&lt;Point3d&gt; mouthPoints = new List&lt;Point3d&gt;() { new Point3d(100, 150, 0), new Point3d(200, 100, 0), new Point3d(350, 100, 0) }; mouth.Polyline= new Polyline3d(mouthPoints); mouth.Polyline.SetClosed(false); mouth.DbEntity.Transform(McDocumentsManager.GetActiveDoc().UCS); //change coordinates from UCS to WCS for BD mouth.DbEntity.AddToCurrentDocument();</span></span></code> </pre><br>  So, let's understand.  In the MultiCAD .NET API there are classes that are responsible for defining geometric objects and displaying them in a drawing, create an eye: DbCircle eye = new DbCircle ();  - creates a circle object (similar to the CIRCLE command in the command line or clicking on the circle in the toolbar) then we adjust the radius of the circle and the coordinates of the center, I think it‚Äôs so clear.  eye.DbEntity.AddToCurrentDocument ();  - adds an object to the drawing. <br><br>  With a simple line, I think everything is so clear (this will be our nose). <br><br>  Then draw a mouth.  Define a polyline DbPolyline mouth = new DbPolyline ();  We form points on which it will be built (inclined and straight line). <br><br><pre> <code class="cs hljs">List&lt;Point3d&gt; mouthPoints = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Point3d&gt;() { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">350</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) };</code> </pre> <br>  mouth.Polyline = new Polyline3d (mouthPoints);  - create in the database object the geometry according to our points. <br>  mouth.Polyline.SetClosed (false);  if you want the line to close - change the value. <br><br><pre> <code class="cs hljs">mouth.DbEntity.Transform(McDocumentsManager.GetActiveDoc().UCS); <span class="hljs-comment"><span class="hljs-comment">//change coordinates from UCS to WCS for BD</span></span></code> </pre> <br>  - I borrowed this line on the developers forum, I don‚Äôt know whether it is necessary to precisely change the system of user coordinates to the world or not =) <br><br>  Draw the second part of the face <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//draw mirror half the face (2nd half) DbCircle eye2 = new DbCircle(); eye2.Radius = 100; eye2.Center = new Point3d(500, 500, 0); eye2.DbEntity.AddToCurrentDocument(); DbPolyline mouth2 = new DbPolyline(); mouth2.Polyline= mouth.Polyline.Mirror(new Plane3d(new Point3d(350, 100, 0), new Vector3d(200, 0, 0))) as Polyline3d; mouth2.DbEntity.AddToCurrentDocument();</span></span></code> </pre><br>  We simply create the second eye by analogy.  But the second half of the mouth mirrored for the sake of diversity.  In fact, we make an analogue of the MIRROR team (mirror) <br><br><pre> <code class="hljs cs">mouth2.Polyline= mouth.Polyline.Mirror(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Plane3d(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point3d(<span class="hljs-number"><span class="hljs-number">350</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3d(<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Polyline3d;</code> </pre> <br>  This command creates for us a new mirror copy of the line reflected from the base point and the plane (it‚Äôs as if you poke a mouse at the screen and draw a line along which the object will be reflected). <br><br>  Add a little interactive. <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Get notification in command line McContext.ShowNotification("You need to enter data into the console"); //Get uaser input InputJig editorInput = new InputJig(); string name = editorInput.GetText("Input your name and press Enter");</span></span></code> </pre><br>  The first section simply sends the text to the console (the window where you enter commands).  The second section creates an object for entering data into the console and gets the value entered by the user.  In this case, we ask the user to introduce himself and save his name. <br><br>  Create a text object, this is a small share of humor in our team. <br><br><pre> <code class="cs hljs"> <span class="hljs-comment"><span class="hljs-comment">//Drawing face's text DbText spech = new DbText(); spech.Text = new TextGeom("Oh Master! Why I'm so ugly? Please remove me!", new Point3d(510, 15, 0), Vector3d.XAxis, "Standard", 15); spech.DbEntity.AddToCurrentDocument();</span></span></code> </pre><br>  We draw the user's attention to the created record, and at the same time we demonstrate that a design, such as windows.forms, for example, can be built into your application, that is, you could make your own form call and then process the data.  We will simply display the username obtained earlier. <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Get windows message box MessageBox.Show("Congratulation " + name +" you did it! But look, it want, to say something to you...");</span></span></code> </pre><br>  It seems that our face is dissatisfied with its being, let's remove it. <br><br>  In the last section, we do two things: we show the user a pop-up hint that the ‚Äúdelete‚Äù command was automatically turned on and we run another command from our team. <br><br><pre> <code class="cs hljs"> <span class="hljs-comment"><span class="hljs-comment">//Get popup help McContext.PopupNotification("Delete command has activated"); //Activate another command (Delete) McContext.ExecuteCommand("Delete"); } } }</span></span></code> </pre><br>  We press F5 and if everything is OK, we can check our team in action, do not forget to enter the name of the team as in the screenshot. <br><br><img src="https://habrastorage.org/webt/gd/37/ur/gd37ur8p5sjd5gbxb9scrdgqlai.png"><br><br>  And to intercept some debug information, you can use a special <a href="http://www.spds.ru/download/utilites/monitor.html">monitoring utility</a> . <br><br>  If suddenly you don‚Äôt want to join the developers club, and you really want to see the result of your work, you can download the demo version of NC 8.5. It looks like it comes without an SDK bundle, but we will not be upset, naturally the mapimgd.dll and mapibasetypes.dll libraries should be in the package of the program itself, so that they can be found in the bin folder. <br><br>  I do not know whether this is possible from the point of view of the law, but I think that there should be no problems. <br><br>  So, I shared with you almost everything I knew at the moment, it remains only to draw a conclusion. <br><a name="V"></a><br><h3>  5. It's a shame (Conclusion) </h3><br> <a href="https://www.youtube.com/watch%3Fv%3DW6WM0707Euw"><img src="https://habrastorage.org/webt/gq/gj/en/gqgjenwx5abozmmeptdnlb-dfjy.png"></a> <br><br>  Well, what did Viktor Koklyushkin say: ‚ÄúIt's a shame‚Äù, why is it insulting?  For the fact that a promising project - a product of a completely acceptable quality did not unfold, as it could unfold.  Strangely, of course, it seems that even some state support measures were there, it seems that in the free version you can really draw something simple, without wanting to throw a brick at the monitor, but still somehow the environment created around the product is worse than it could be.  I‚Äôm thinking that if more people get involved in the development for Nanocad, even if it‚Äôs just ‚Äújust for fun‚Äù, as we are now, then Nanosoft will feel its relevance, maybe the forum will heal, the APIs will start to be better documented and the files are more often laid out.  In principle, if we consider that it may still be worthwhile to wait for the update of the free version, then maybe it will be so in the future. <br><br>  In the meantime, I‚Äôll say thank you and wish good luck to the developers of the Nanocad and to everyone who has mastered this article to the end, despite the jokes from the Anshlag. <br><br>  Have a good start of work week! </div><p>Source: <a href="https://habr.com/ru/post/342186/">https://habr.com/ru/post/342186/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342172/index.html">Creating concept art in 3D</a></li>
<li><a href="../342174/index.html">How to follow trends on github</a></li>
<li><a href="../342176/index.html">Brilliance and misery of Artificial Intelligence</a></li>
<li><a href="../342180/index.html">Introduction to WebAssembly</a></li>
<li><a href="../342184/index.html">CatalogBox - the idea of ‚Äã‚ÄãComboBox development</a></li>
<li><a href="../342188/index.html">Roles, their modeling in IC</a></li>
<li><a href="../342190/index.html">Convenient solution for the gaming database based on EditorWindow</a></li>
<li><a href="../342192/index.html">Sir Markdown. Yandex lecture</a></li>
<li><a href="../342194/index.html">How to programmatically manage the TP-Link WiFi router using Python requests</a></li>
<li><a href="../342196/index.html">How we set up the CI / CD process for our SOA projects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>