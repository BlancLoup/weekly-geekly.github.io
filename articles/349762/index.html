<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implementation of a prototype of mobile / web clients and a server for an enterprise equipment control system</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The customer was interested in a system that would simplify control over the condition of the equipment at the enterprises of the industry. The existi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implementation of a prototype of mobile / web clients and a server for an enterprise equipment control system</h1><div class="post__text post__text-html js-mediator-article"> <a href=""><img src="https://habrastorage.org/webt/d1/3i/g1/d13ig1ej99ei_2fiyzelx7tdmxc.jpeg"></a> <br><br>  The customer was interested in a system that would simplify control over the condition of the equipment at the enterprises of the industry.  The existing control procedure consists of regular rounds of equipment installed in workshops (along routes) and filling in paper forms, indicating in them instrument readings and external signs of malfunctions. <br><br>  Since full automation (with the control of all parameters by sensors and data transfer from them over the network) is technically and organizationally impossible, it was proposed to partially automate the procedure.  Namely, at the inspection sites (control points), hang NFC tags, and bypass employees to issue smartphones with an application that fixes the attachment of the smartphone to the tag and offers to enter the parameters required for each point.  The data is then transmitted to the server, from where it can be viewed by the supervisor in the browser (with marks of exceeding permissible values, statistics, etc.). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Javascript was chosen for implementation, specifically - a bundle in the form of NodeJS, React + Redux, React-Native (with the exchange between them through GraphQL).  This allowed the use of one language for the server, client and mobile application.  Before, I didn‚Äôt come across the listed technologies (except Javascript), so the article largely reflects the experience of exploring them. <br><a name="habracut"></a><br><h1>  Functional system and organization of the database </h1><br><h2>  Entities and their relationship </h2><br>  'checkpoint' - control point, equivalent to piece of equipment <br>  'param' - Control point parameters <br>  'unit' - Unit of parameter <br>  'range' - The range of values ‚Äã‚Äãallowed for this parameter. <br><br>  'checkup' - fact of passing checkpoints on one of the routes <br>  'check' - The fact of checking the control point during the tour (contains comments on the point) <br>  'checkvalue' - The actual value of one parameter when checking a checkpoint <br><br>  'firm' - Company <br>  'plant' - Company Enterprise <br>  'shop' - Workshop of the enterprise <br>  'route' - Route in the shop <br>  'rclink' - Linking a control point to a route (determines the order of visiting points on a given route) <br><br>  'position' - user position <br>  'user' - User <br><br> <a href=""><img src="https://habrastorage.org/webt/w3/cs/is/w3csishsar7osymgax1p0iyrfu0.jpeg"></a> <br><br>  The binding of control points to routes is performed not directly, but through intermediate rclinks.  This is due to the fact that within the same workshop there can be several routes, and along the same control points - on different routes, in a different order, and not necessarily all.  Therefore, it uses a bidirectional list. <br><br>  All described entities are represented in the database by tables of the same name (in the plural - that is, routes, checkpoints, etc.).  Record identifiers are global and are generated via <a href="https://github.com/broofa/node-uuid">node-uuid</a> on the server (in React Native ‚Äî via <a href="https://github.com/eugenehp/react-native-uuid">react-native-uuid</a> ) with the addition of the type (for debugging convenience) <br><br>  Example: 0ec74560-9da3-11e7-b19a-b5183ad4a4a8_checkpoint <br><br>  For each record, the record creation date, the date it was changed (dt_crt, dt_mod), the last synchronization date (dt_sync), the synchronization session identifier (sync_id), and the id of the user who created or changed the record (user_crt_id, user_mod_id) are recorded in all tables. <br><br>  The database structures on the server and in the mobile application are identical (for this reason SQLite was chosen for the server part). <br><br>  Before starting work in the web interface, organizations and their structure are created.  The highest level of hierarchy is organization (firm), which contains production objects (plants).  Each object has in its composition shop (shops).  The level of the workshops is technically basic - access to positions is allowed to them (positions), control points are added, there are routes within the workshops, etc. <br><br>  Users (users) technically only provide the ability to enjoy the rights of posts and may have different interface settings. <br><br><h2>  Control points </h2><br>  The key essence of the system is the concept of a checkpoint (checkpoint).  The point of a detour (checkup) is to visit the control points and remove the values ‚Äã‚Äãof the parameters of the equipment placed on them (checkvalue) for subsequent storage and evaluation. <br><br>  The initial addition of the control point is carried out in the context of a given workshop (shop), via the web interface.  In this case, the NFC tag is entered into the form by touching the NFC smartphone tag. <br><br>  Also, in the process of adding a point, one or several parameters (params) and valid ranges of values ‚Äã‚Äã(ranges) are attached to it.  To parameters - their units of measurement (units), which are also attached to the organization (firms).  Those.  each organization can have its own set of units. <br><br>  Parameters can be of two types - float (number) and boolean (value of the form yes / no).  The third type (text) is reserved. <br><br>  For each parameter, the minimum and maximum acceptable values ‚Äã‚Äãmust be specified.  When showing crawl results, values ‚Äã‚Äãout of range will be highlighted in red. <br><br>  The created control points can be tied to one or several routes (route) in a given order for each route.  Those.  the same point may be part of different routes. <br><br>  The order is set by the intermediate table rclinks, where for each point-route pair the next and previous point id is specified (null for the first and last). <br><br><h2>  Crawling process </h2><br>  When performing a crawl, the mobile application functions as follows: <br><br>  The user presses the ‚ÄúStart tour‚Äù button in the route proposed by him or his chosen route.  This creates a checkup.  When selecting a control point, the user fills in the values ‚Äã‚Äãof the parameter fields received by the application from params, units.  When they are saved, a check is created for a given point in the context of this traversal, in which also notes on the point are saved and the created check values ‚Äã‚Äãare attached to check, in which the values ‚Äã‚Äãof each of the entered parameters are saved. <br><br>  After saving the values ‚Äã‚Äãof the parameters, the point is considered checked (because check is created for it) and the next point is expected (in accordance with rclinks.next_id) point on this route. <br>  In this case, already checked points can be edited again (until the end of the tour).  Skipping the same points is not allowed. <br><br><h1>  Server side (backend) </h1><br>  The server part is implemented on NodeJS, SQLite, GraphQL and allows you to: <br><br>  1. Store data <br>  2. Provide access to data from mobile and web applications with appropriate access control <br><br>  For the server, express is used (graphql-server-express and <a href="https://github.com/auth0/express-jwt">express-jwt</a> are joined with it).  SQLite - through <a href="https://github.com/kriasoft/node-sqlite">node-sqlite</a> (supports promises). <br><br>  The server consists of schema.js, which describes the types and methods for GraphQL queries (using <a href="https://github.com/apollographql/apollo-server">Apollo Server</a> ), resolvers.js (with the methods described in the schema), connectors.js (with all logic and SQL queries to the database) and, in fact, primary server.js <br><br>  <b>server.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> express <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'express'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { graphqlExpress, graphiqlExpress } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'graphql-server-express'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> bodyParser <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'body-parser'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cors <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'cors'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">schema</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./schema'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span>, subscribe } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'graphql'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createServer } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'http'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { SubscriptionServer } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'subscriptions-transport-ws'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> db <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'sqlite'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> connectors <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./connectors'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> jwt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span><span class="hljs-string"><span class="hljs-string">'express-jwt'</span></span>; const { GQLSERVERLOCAL, GQLSERVERPROD, WEBSERVER, <span class="hljs-type"><span class="hljs-type">PATH</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span>, AUTH } = require(<span class="hljs-string"><span class="hljs-string">'./config'</span></span>); let p = db.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span>.NAME).<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(db =&gt;{ console.error("SQLite: DB ok "); }).catch(error =&gt; { console.error("SQLite: DB error: " + error); }); const <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> = express(); const corsOptions = { origin(origin, callback){ callback(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); }, credentials: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">server</span></span>.use(cors(corsOptions)); <span class="hljs-keyword"><span class="hljs-keyword">server</span></span>.use(<span class="hljs-type"><span class="hljs-type">PATH</span></span>.GQL, bodyParser.json(), jwt({ secret: AUTH.secret, credentialsRequired: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, getToken: <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fromHeaderOrQuerystring (req) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.headers.<span class="hljs-keyword"><span class="hljs-keyword">authorization</span></span> &amp;&amp; req.headers.<span class="hljs-keyword"><span class="hljs-keyword">authorization</span></span>.split(<span class="hljs-string"><span class="hljs-string">' '</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] === <span class="hljs-string"><span class="hljs-string">'Bearer'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> req.headers.<span class="hljs-keyword"><span class="hljs-keyword">authorization</span></span>.split(<span class="hljs-string"><span class="hljs-string">' '</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.query &amp;&amp; req.query.token) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> req.query.token; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } }), graphqlExpress(req =&gt; ({ <span class="hljs-keyword"><span class="hljs-keyword">schema</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">schema</span></span>, context: { <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: req.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span> ? connectors.findUser(req.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>.id) : Promise.resolve(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>), }, //   context  resolvers.js }))); //  ,         websockets const ws = createServer(<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">server</span></span>.use(<span class="hljs-type"><span class="hljs-type">PATH</span></span>.GIQL, graphiqlExpress({ endpointURL: <span class="hljs-type"><span class="hljs-type">PATH</span></span>.GQL, subscriptionsEndpoint: `ws://${GQLSERVERPROD.HOST}:${GQLSERVERPROD.PORT}/subscriptions` })); ws.<span class="hljs-keyword"><span class="hljs-keyword">listen</span></span>(GQLSERVERPROD.PORT, () =&gt; { console.log(`GraphQL <span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> v1 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> now running <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ${GQLSERVERPROD.HOST}:${GQLSERVERPROD.PORT}`); <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SubscriptionServer({ <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span>, subscribe, <span class="hljs-keyword"><span class="hljs-keyword">schema</span></span> }, { <span class="hljs-keyword"><span class="hljs-keyword">server</span></span>: ws, <span class="hljs-type"><span class="hljs-type">path</span></span>: <span class="hljs-type"><span class="hljs-type">PATH</span></span>.SUBS, }); });</code> </pre> <br></div></div><br>  <b>scheme.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">type</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">DeletePlantResult</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">rows_changed</span></span>: Int error: String } <span class="hljs-selector-tag"><span class="hljs-selector-tag">input</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">IdsInput</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">ids</span></span>: [String] } <span class="hljs-selector-tag"><span class="hljs-selector-tag">deletePlant</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">data</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">IdsInput</span></span>): <span class="hljs-selector-tag"><span class="hljs-selector-tag">DeletePlantResult</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[...]</span></span></code> </pre><br></div></div><br>  <b>resolvers.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs coffeescript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> connectors <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./connectors'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const resolvers = { Mutation: { [...] deletePlant: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(root, params, context)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> context  ,      server.js [...] const errors = []; const {data} = params const ids = data.ids.map(function(id){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"'"</span></span> + id + <span class="hljs-string"><span class="hljs-string">"'"</span></span> }).join(<span class="hljs-string"><span class="hljs-string">","</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> connectors.deletePlant(ids) .<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(rows_changed =&gt; ({ rows_changed, errors })) .<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err.code &amp;&amp; err.message) { errors.push({ key: err.code, value: err.message }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { errors }; } }); },<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>deletePlant } [...] }</code> </pre><br></div></div><br>  <b>connectors.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs coffeescript">deletePlant(ids) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Promise(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(resolve, reject)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> db.run(`<span class="javascript"><span class="javascript"> DELETE FROM </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'plants'</span></span></span><span class="javascript"> WHERE id IN(${ids}) </span></span>`) .<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(plant)</span></span></span><span class="hljs-function"> =&gt;</span></span> { resolve(plant.changes); }) .<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reject(err); }); }) },<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>deletePlant</code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/pw/dg/ff/pwdgffy0x9tp3azfhxuxsvvx2ga.jpeg"><br><br>  Implemented bilateral non-incremental data synchronization between the server and the mobile application.  From the server to the mobile application are transmitted <br><br>  positions, shops, routes, rclinks, checkpoints, ranges, params, units, users <br><br>  (for synchronization, a sample of only the records related to the workshops allowed for the position (position) of the user of the mobile application) is formed.  Those.  composition of the sample is determined by the position. <br><br>  The results of the rounds - checkups, checks, checkvalues ‚Äã‚Äãare transferred from the mobile application to the server. <br><br><h1>  Web client (frontend) </h1><br>  The web client is implemented on React + Redux and allows you to: <br><br>  1. To form in the system the organizational structure of the organization (industrial facilities, shops, users, their positions), schemes and detour mode (routes through workshops, control points on the routes, their parameters) <br><br>  2. To control the mode and results of the conducted rounds on routes at facilities and in workshops, to review the values ‚Äã‚Äãof parameters entered by the inspector at control points, their deviations from the specified allowable values, various statistics <br><br>  3. Register and authorize registered users, provide them access to resources <br><br>  All pages are represented by React components and are divided into two groups - user (main interface) and administrative (for control, selective viewing and editing database tables). <br><br> <a href=""><img src="https://habrastorage.org/webt/wj/uv/77/wjuv77zb0_5hwyb9ztvytchx-ns.jpeg"></a> <br><br>  Navigation is implemented on <a href="https://github.com/ReactTraining/react-router">react-router</a> ‚Äî the store stores the current context in which the user is located, gradually being filled with updateContext () calls.  In the links, only the path to the component is transferred (except for the administrative pages where you can specify the object id in the query string).  From the context data at the top of each page, a navigation bar is constructed showing where the user is located. <br>  The context is automatically saved to local storage via <a href="https://github.com/rt2zz/redux-persist">redux-persist</a> . <br><br>  The layout is adaptive (bootstrap), most of the components of the pages at the base have a table on <a href="https://github.com/AllenFang/react-bootstrap-table">react-bootstrap-table</a> , whose cells are filled with the results of the GraphQL query, whose parameters are the id of objects taken from the context and the query string. <br>  Where necessary, custom formatters / renderers are defined for the cells (display of dates, editing with a choice from the list, etc.) <br>  <a href="https://github.com/apollographql/react-apollo">Apollo is</a> used for GraphQL (both in the web client and in the mobile application). <br><br>  A typical component of a simple page with an editable table looks like this: <br><br>  <b>components / PlantsPage.js:</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { BootstrapTable, TableHeaderColumn } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap-table'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { reduxForm } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-form'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Button, ProgressBar } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap'</span></span>; [...] <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlantsPage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ addEmptyItem() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.addPlant({ <span class="hljs-attr"><span class="hljs-attr">variables</span></span>: {<span class="hljs-attr"><span class="hljs-attr">data</span></span>: {<span class="hljs-attr"><span class="hljs-attr">firm_id</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.params.firm_id, <span class="hljs-attr"><span class="hljs-attr">user_crt_id</span></span>:<span class="hljs-string"><span class="hljs-string">'system_user'</span></span>,<span class="hljs-attr"><span class="hljs-attr">user_mod_id</span></span>:<span class="hljs-string"><span class="hljs-string">'system_user'</span></span>}} }); } [...] }; render() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.data.loading) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ProgressBar</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bsStyle</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"info"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">now</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{100}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">; return ( </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">BootstrapTable</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">this.props.data.getPlants.plants</span></span></span></span><span class="xml"><span class="hljs-tag"> } [</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span></span><span class="xml"><span class="hljs-tag">] &gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TableHeaderColumn</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataField</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'title'</span></span></span></span><span class="xml"><span class="hljs-tag"> [</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span></span><span class="xml"><span class="hljs-tag">] &gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TableHeaderColumn</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> [...] </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">BootstrapTable</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> [</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span></span><span class="xml"><span class="hljs-tag">] </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag"> () =&gt;</span></span></span><span class="xml"> { this.addEmptyItem(); } }&gt;  </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) } } [...] export default PlantsPage;</span></span></code> </pre><br></div></div><br>  <b>components / PlantsContainer.js:</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">React</span></span> from <span class="hljs-symbol"><span class="hljs-symbol">'reac</span></span>t'; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withRouter } from <span class="hljs-symbol"><span class="hljs-symbol">'react</span></span>-router'; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } from <span class="hljs-symbol"><span class="hljs-symbol">'react</span></span>-redux'; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gql from <span class="hljs-symbol"><span class="hljs-symbol">'graphql</span></span>-tag'; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { graphql, compose } from <span class="hljs-symbol"><span class="hljs-symbol">'react</span></span>-apollo'; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">PlantsPage</span></span> from <span class="hljs-string"><span class="hljs-string">"../components/PlantsPage"</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlantsContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;<span class="hljs-type"><span class="hljs-type">PlantsPage</span></span> {...<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props} /&gt;; } }<span class="hljs-comment"><span class="hljs-comment">//class const gqlGetPlants = gql` query getForPlants($firm_id:String!,$object_id:String!,$holding_id:String!) { getPlants(firm_id: $firm_id) { plants { id, title, shops_count, [...] }, errors { key, value, } }, } `; const gqlGetPlantsProps = { options: (ownProps) =&gt; ({ pollInterval: 0, variables: { firm_id: ownProps.params.firm_id, object_id: ownProps.params.firm_id, holding_id: 'all', }, }), } const gqlAddPlant = gql` mutation ($data: PlantInput) { addPlant(data: $data) { id, errors { key value } } } `; const gqlAddPlantProps = { name: 'addPlant', options: { refetchQueries: [ 'getForPlants', ], }, }; [...] const PlantsWithData = compose( graphql(gqlUpdatePlant, gqlUpdatePlantProps), graphql(gqlGetPlants, gqlGetPlantsProps), [...] )(withRouter(PlantsContainer)); const PlantsWithDataAndDispatch = connect( null, //   mapStateToProps null, //   mapDispatchToProps )(PlantsWithData); export default PlantsWithDataAndDispatch</span></span></code> </pre><br></div></div><br>  For pop-up notifications and error messages used <a href="https://github.com/diegoddox/react-redux-toastr">react-redux-toastr</a> <br><br>  Where required forms (checkpoint creation, registration, login, profile editing, etc.), <a href="https://github.com/erikras/redux-form">redux-form was used.</a> <br><br>  The principle of working with forms is as follows: <br><br>  <b>components / ProfilePage.js:</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Field, reduxForm } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-form'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Button, ControlLabel, FormGroup, Alert } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> renderErrors = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">errors</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Alert</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bsStyle</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"warning"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {errors.map((error, index) =&gt; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{index}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{error.value}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">)} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Alert</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfilePage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> errors = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.errors &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-literal"><span class="hljs-literal">null</span></span> : renderErrors(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.errors) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { handleSubmit } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onSubmit</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{handleSubmit}</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FormGroup</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">controlId</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"firstname"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ControlLabel</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">:</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ControlLabel</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Field</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"form-control"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"firstname"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"firstname"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">component</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"input"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"  (: '')"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FormGroup</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> [...] {errors} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bsStyle</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) } } ProfilePage = reduxForm({ form: 'ProfileForm', enableReinitialize: true, })(ProfilePage); // enableReinitialize: true, -       export default ProfilePage;</span></span></code> </pre><br></div></div><br>  <b>containers / ProfileContainer.js:</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withRouter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-router'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gql <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'graphql-tag'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { graphql, compose } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-apollo'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ProfilePage <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/ProfilePage'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { toastr } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux-toastr'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> jwtDecode = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jwt-decode'</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfileContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">errors</span></span>: [] }; } handleSubmit(data) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.updateProfile({ <span class="hljs-attr"><span class="hljs-attr">variables</span></span>: { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { <span class="hljs-attr"><span class="hljs-attr">firstname</span></span>: data.firstname, [...] }, <span class="hljs-attr"><span class="hljs-attr">id</span></span>: jwtDecode(localStorage.getItem(<span class="hljs-string"><span class="hljs-string">'token'</span></span>)).id }}) .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">errors</span></span>: [] }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.data.updateProfile.errors.length &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { toastr.success(<span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, {<span class="hljs-attr"><span class="hljs-attr">showCloseButton</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">errors</span></span>: response.data.updateProfile.errors }); } }) .catch(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err); toastr.error(<span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-string"><span class="hljs-string">'   '</span></span>, {<span class="hljs-attr"><span class="hljs-attr">showCloseButton</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}) }); }<span class="hljs-comment"><span class="hljs-comment">//handleSubmit render() { return &lt;ProfilePage {...this.props} onSubmit={this.handleSubmit.bind(this)} errors={this.state.errors} /&gt;; } }//class const gqlGetProfile = gql` query getProfile ($user_id: String!) { getProfile(user_id: $user_id) { profile { id, firstname, [...] }, errors { key, value }, } } `; const gqlGetProfileProps = { options: (ownProps) =&gt; ({ variables: { user_id: jwtDecode(localStorage.getItem('token')).id, }, }), props: ({ ownProps, data }) =&gt; { if (data.loading) { return { initialValues: { test: [] }, errors: [] }; }; return { initialValues: data.getProfile.profile, errors: data.getProfile.errors, }; } } const gqlUpdateProfile = gql` mutation ($data: ProfileInput, $id : String) { updateProfile(data: $data, id : $id) { token, errors { key, value }, } } `; const gqlUpdateProfileProps = { name: 'updateProfile', options: { refetchQueries: [ 'getProfile', ], }, }; const ProfileWithData = compose( graphql(gqlUpdateProfile, gqlUpdateProfileProps), graphql(gqlGetProfile, gqlGetProfileProps), )(withRouter(ProfileContainer)); const ProfileWithDataAndDispatch = connect( null, null )(ProfileWithData); export default ProfileWithDataAndDispatch</span></span></code> </pre><br></div></div><br><h1>  Mobile app </h1><br>  The mobile application is implemented for Android 4.4+ (NFC) smartphones, using React-Native, Redux, SQLite. <br><br>  The application allows you to: <br><br>  1. To conduct rounds - i.e.  Record visits to specified route control points using contactless NFC tags and save the associated parameters and notes in the database <br><br>  2. Synchronize data ‚Äî get routes from the server, parameters of control points, a mode of their crawling, and send data to the server using crawls and values ‚Äã‚Äãrecorded at control points <br><br><img width="360" src="https://habrastorage.org/webt/3t/s0/9a/3ts09aybrlincfjrwgcodso8xcw.jpeg"><br><br>  Similar to the web client, the mobile application has components for pages (screens), however the layout is on Flex and from the Android UI components.  Forms are made through the <a href="https://github.com/erikras/redux-form">redux-form</a> and <a href="https://github.com/esbenp/react-native-clean-form">react-native-clean-form</a> , but this is a pretty curved solution, except for the prototype. <br><br>  There is also navigation between the screens, but instead of the react-router web client, it uses <a href="https://github.com/aksonov/react-native-router-flux">react-native-router-flux</a> ). <br><br>  There are queries to the database, but they are not executed via GraphQL to the server, but directly through calls to actions in which the <a href="https://github.com/andpor/react-native-sqlite-storage">reactant-native-sqlite-storage</a> accesses the local SQLite database (given that asynchronous requests are used by <a href="https://github.com/gaearon/redux-thunk">redux-thunk</a> ) <br><br>  GraphQL in a mobile application is used only to synchronize data with the server and send messages to the server with NFC id tags and with responses to debugging queries to the database (see below).  The main work with the application occurs offline. <br><br>  The component for the screen looks like this: <br><br>  <b>containers / CheckpointContainer.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { bindActionCreators } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CheckpointPage <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/CheckpointPage'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { saveCheckpoint } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/CheckpointsActions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Actions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native-router-flux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ToastAndroid } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CheckpointContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ handleSubmit = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, dispatch</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function">) =&gt;</span></span> { setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.saveCheckpoint(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.checkpoint_id,<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.checkup_id,data.check_note,data.params).then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)=&gt;</span></span>{ ToastAndroid.showWithGravity(<span class="hljs-string"><span class="hljs-string">' '</span></span>, ToastAndroid.SHORT, ToastAndroid.BOTTOM); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }).catch(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">)=&gt;</span></span>{ ToastAndroid.showWithGravity(<span class="hljs-string"><span class="hljs-string">'   '</span></span>, ToastAndroid.SHORT, ToastAndroid.BOTTOM); }) resolve(); }, <span class="hljs-number"><span class="hljs-number">100</span></span>) }) } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">CheckpointPage</span></span></span></span><span class="xml"><span class="hljs-tag"> {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...this.props</span></span></span></span><span class="xml"><span class="hljs-tag">} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onSubmit</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleSubmit.bind(this)}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> } }//class const mapStateToProps = (state) =&gt; { return { stateValues: state.checkpointData, }; }; const mapDispatchToProps = (dispatch) =&gt; { return bindActionCreators ({ saveCheckpoint: (checkpoint_id, checkup_id, note,formData) =&gt; saveCheckpoint(checkpoint_id, checkup_id, note, formData), }, dispatch); } export default connect(mapStateToProps, mapDispatchToProps)(CheckpointContainer);</span></span></code> </pre><br></div></div><br>  <b>components / CheckpointPage.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">React</span></span>, { <span class="hljs-type"><span class="hljs-type">Component</span></span> } from <span class="hljs-symbol"><span class="hljs-symbol">'reac</span></span>t' <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> styles from '../styles'; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { reduxForm } from <span class="hljs-symbol"><span class="hljs-symbol">'redux</span></span>-form/immutable' <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { <span class="hljs-type"><span class="hljs-type">ActionsContainer</span></span>, <span class="hljs-type"><span class="hljs-type">Button</span></span>, <span class="hljs-type"><span class="hljs-type">FieldsContainer</span></span>, <span class="hljs-type"><span class="hljs-type">Fieldset</span></span>, <span class="hljs-type"><span class="hljs-type">Form</span></span>, } from <span class="hljs-symbol"><span class="hljs-symbol">'react</span></span>-native-clean-form' <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { <span class="hljs-type"><span class="hljs-type">Input</span></span>, } from <span class="hljs-symbol"><span class="hljs-symbol">'react</span></span>-native-clean-form/redux-form-immutable' <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { <span class="hljs-type"><span class="hljs-type">View</span></span>, <span class="hljs-type"><span class="hljs-type">Text</span></span>, <span class="hljs-type"><span class="hljs-type">StyleSheet</span></span>, } from <span class="hljs-symbol"><span class="hljs-symbol">'react</span></span>-native' <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CheckpointPage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ render() { const { handleSubmit, submitting, onSubmit } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;<span class="hljs-type"><span class="hljs-type">View</span></span> style={{marginTop: <span class="hljs-number"><span class="hljs-number">80</span></span>, flex:<span class="hljs-number"><span class="hljs-number">1</span></span>, flexDirection: <span class="hljs-symbol"><span class="hljs-symbol">'colum</span></span>n', }}&gt; &lt;<span class="hljs-type"><span class="hljs-type">Form</span></span>&gt; &lt;<span class="hljs-type"><span class="hljs-type">FieldsContainer</span></span>&gt; &lt;<span class="hljs-type"><span class="hljs-type">Fieldset</span></span> label=<span class="hljs-string"><span class="hljs-string">":"</span></span> last&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.stateValues.params.map((param, i) =&gt; { [...] }) } &lt;/<span class="hljs-type"><span class="hljs-type">Fieldset</span></span>&gt; &lt;<span class="hljs-type"><span class="hljs-type">Fieldset</span></span> label=<span class="hljs-string"><span class="hljs-string">":"</span></span> last&gt; &lt;<span class="hljs-type"><span class="hljs-type">Input</span></span> name=<span class="hljs-string"><span class="hljs-string">"check_note"</span></span> label=<span class="hljs-string"><span class="hljs-string">":"</span></span> placeholder=<span class="hljs-string"><span class="hljs-string">", ..."</span></span> multiline={<span class="hljs-literal"><span class="hljs-literal">true</span></span>} numberOfLines={<span class="hljs-number"><span class="hljs-number">2</span></span>} inlineLabel={<span class="hljs-literal"><span class="hljs-literal">false</span></span>} /&gt; &lt;/<span class="hljs-type"><span class="hljs-type">Fieldset</span></span>&gt; &lt;/<span class="hljs-type"><span class="hljs-type">FieldsContainer</span></span>&gt; &lt;<span class="hljs-type"><span class="hljs-type">ActionsContainer</span></span>&gt; &lt;<span class="hljs-type"><span class="hljs-type">Button</span></span> icon=<span class="hljs-string"><span class="hljs-string">"md-checkmark"</span></span> iconPlacement=<span class="hljs-string"><span class="hljs-string">"right"</span></span> onPress={handleSubmit(onSubmit)} submitting={submitting}&gt;&lt;/<span class="hljs-type"><span class="hljs-type">Button</span></span>&gt; &lt;/<span class="hljs-type"><span class="hljs-type">ActionsContainer</span></span>&gt; &lt;/<span class="hljs-type"><span class="hljs-type">Form</span></span>&gt; &lt;/<span class="hljs-type"><span class="hljs-type">View</span></span>&gt; ) } } export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> reduxForm({ form: <span class="hljs-symbol"><span class="hljs-symbol">'For</span></span>m', enableReinitialize: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, keepDirtyOnReinitialize: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, })(<span class="hljs-type"><span class="hljs-type">CheckpointPage</span></span>)</code> </pre><br></div></div><br>  <b>actions / CheckpointsActions.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs coffeescript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> types <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/ActionTypes'</span></span>; var uuid = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'react-native-uuid'</span></span>); [...] <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> function saveCheckpointSuccess(data) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { type: <span class="hljs-string"><span class="hljs-string">'SAVE_CHECKPOINT_SUCCESS'</span></span>, data }; } function txUpdateChecks(result, check_id, note) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'CheckpointsActions/txUpdateChecks:'</span></span>, check_id, note); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Promise(function(resolve, reject) { db.transaction(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tx)</span></span></span><span class="hljs-function">=&gt;</span></span>{ tx.executeSql(`<span class="javascript"><span class="javascript">UPDATE checks SET note = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'${note}'</span></span></span><span class="javascript">, dt_mod = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'${nowSQL()}'</span></span></span><span class="javascript"> WHERE checks.id = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'${check_id}'</span></span></span></span>`).<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([tx,results])</span></span></span><span class="hljs-function"> =&gt;</span></span>{ result = results.rowsAffected; resolve(result); }).<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(error)</span></span></span><span class="hljs-function"> =&gt;</span></span> { reject(error); });<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> executeSql });<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>db.transaction })<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>txUpdateChecks() [...] <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> function saveCheckpoint(checkpoint_id, checkup_id, note, values) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (dispatch) =&gt; { let result; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> txSelectChecks(checkup_id,checkpoint_id).<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(check_id)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!check_id) { txInsertChecks(result,checkpoint_id,checkup_id,note).<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(check_id)</span></span></span><span class="hljs-function"> =&gt;</span></span> txInsertCheckValues(result,check_id,values)) .<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(result)</span></span></span><span class="hljs-function"> =&gt;</span></span> { dispatch(saveCheckpointSuccess(result)); }).<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error =&gt; { dispatch(dbFailed({method:<span class="hljs-string"><span class="hljs-string">'saveCheckpoint !check_id'</span></span>,error})); }); }<span class="hljs-regexp"><span class="hljs-regexp">//i</span></span>f <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { txUpdateChecks(result,check_id,note).<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(result)</span></span></span><span class="hljs-function"> =&gt;</span></span> txUpdateCheckValues(result,check_id,values)) .<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(result)</span></span></span><span class="hljs-function"> =&gt;</span></span> { dispatch(saveCheckpointSuccess(result)); }).<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error =&gt; { dispatch(dbFailed({method:<span class="hljs-string"><span class="hljs-string">'txUpdateChecks/tx'</span></span>,error})); }); }<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-keyword"><span class="hljs-keyword">else</span></span> }).<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error =&gt; { dispatch(dbFailed({method:<span class="hljs-string"><span class="hljs-string">'txSelectChecks/tx'</span></span>,error})); }); }<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>saveCheckpoint      : Actions.routesPage({shop_id:<span class="hljs-string"><span class="hljs-string">'6f6853d0-a642-11e7-83e7-792a5b00d12c_shop'</span></span>});</code> </pre><br></div></div><br><h2>  Reading NFC tags </h2><br>  As already mentioned, in order to identify control points, it was intended to provide them with NFC tags.  Despite the fact that there are different types of such tags, in this case the matter is simplified by the fact that for identification it is enough to read their id, which (depending on the type of tag) looks, for example, as ‚ÄúF1: E8: A5: 9E‚Äù or ‚Äú 04: 2C: 9F: 12: 85: 20: 83. "  For testing purposes, any maps are suitable - maps for subway, bank, etc. <br><br>  Strangely enough, among the native React-Native modules for Android there was nothing related to NFC.  Of the outsiders, then, there was only one <a href="https://github.com/Lube/nfc-react-native">module</a> , which I (and, it seems, other people, too) couldn‚Äôt get to work. <br>  Native modules consist of two parts - one for Javascript, the second for Java.  I do not write in Java but, looking at the examples and looking through the documentation, I squeezed out a couple of dozen lines that read the NFC id cards and pulled the js handler.  I will not hide - when <a href="https://github.com/petersobolev/nfc-react-native-simple">my module was</a> working, I was pretty surprised. <br><br>  The problem with third-party native modules is also the fact that to install them (at least in some cases - I came across such modules) you need to use your hands to crawl into several files like android / app / src / main / java / [...] /MainApplication.java, android / settings.gradle, android / app / build.gradle.  Then it creates all sorts of unpleasant situations with the subsequent installation of other packages.  I don‚Äôt know if this is a flaw in which authors like me or React Native‚Äôs problem.  One way or another, the module has earned.  Further, it was necessary to register in AndroidManifest.xml: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs xml">[...] <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.NFC"</span></span></span><span class="hljs-tag"> /&gt;</span></span> [...] <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.nfc.action.TECH_DISCOVERED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.nfc.action.TECH_DISCOVERED"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/nfc_tech_filter"</span></span></span><span class="hljs-tag"> /&gt;</span></span> [...]   nfc_tech_filter.xml, ,     NFC : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xliff</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:oasis:names:tc:xliff:document:1.2"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.IsoDep<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.NfcA<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.NfcB<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.NfcF<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.NfcV<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.Ndef<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.NdefFormatable<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.MifareClassic<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.MifareUltralight<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span>android.nfc.tech.NfcBarcode<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tech-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  In the application itself, everything is already simple: <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> nfcListener = DeviceEventEmitter.addListener(<span class="hljs-string"><span class="hljs-string">'NFCCardID'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> =&gt; { console.log(<span class="hljs-string"><span class="hljs-string">'NFC id'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.id) [...] })</code> </pre><br><br>  In the emulator, to simulate the attachment of a smartphone to the NFC tag, I did not invent anything smarter than a similar handler for the ‚ÄúBack‚Äù button.  By the way - it is strange that in the Android emulator is not provided at least the NFC simulation.  Indeed, in the NFC smartphones is found far from the first year. <br><br>  When creating control points (in a web application), it is necessary to place their NFC id in the database.  In order not to make complicated dances with external USB NFC readers or transfer id from third-party applications on a smartphone (such as <a href="https://play.google.com/store/apps/details%3Fid%3Dse.anyro.nfc_reader">this</a> ), the NFC id was read by the mobile application itself and transferred to the web client via the server. <br><br>  For this, the GraphQL subscriptions mechanism is used. <br>  The mobile application is transferred to the "Snap points" mode in which, when an NFC tag is attached and the "Send" button is clicked, <br>  sendTag method ({variables: {tag: {shop_id: 1, tag_id: data.tagId}}}) <br>  This call starts the sendTag method on the server, inside which it is called <br>  pubsub.publish ('tagSent', {tagSent: newMessage, shop_id: '1'}); <br>  This ultimately results in a call to the updateQuery method in the web client, to which tag_id is passed, after which it is placed in the required field of the web form. <br><br>  Below are the source fragments of all components of the application that implement this functionality: <br><br>  Mobile app: <br><br>  <b>index.android.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs javascript">[...] <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { SubscriptionClient, addGraphQLSubscriptions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'subscriptions-transport-ws'</span></span>; wsClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubscriptionClient(<span class="hljs-string"><span class="hljs-string">`ws://10.0.2.2:3002/subscriptions`</span></span>, { <span class="hljs-attr"><span class="hljs-attr">reconnect</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">timeout</span></span>: <span class="hljs-number"><span class="hljs-number">10000</span></span>, } ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> networkInterfaceWithSubscriptions = addGraphQLSubscriptions( networkInterface, wsClient, ); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dataIdFromObject</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.__typename) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.id !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${result.__typename}</span></span></span><span class="hljs-string">:</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${result.id}</span></span></span><span class="hljs-string">`</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ApolloClient({ <span class="hljs-attr"><span class="hljs-attr">networkInterface</span></span>: networkInterfaceWithSubscriptions, <span class="hljs-attr"><span class="hljs-attr">customResolvers</span></span>: { <span class="hljs-attr"><span class="hljs-attr">Query</span></span>: { <span class="hljs-attr"><span class="hljs-attr">channel</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_, args</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> toIdValue(dataIdFromObject({ <span class="hljs-attr"><span class="hljs-attr">__typename</span></span>: <span class="hljs-string"><span class="hljs-string">'Channel'</span></span>, <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> })) }, }, }, dataIdFromObject, }); [...]</code> </pre><br></div></div><br>  <b>components / CheckpointAttachPage.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs haskell">[...] &lt;<span class="hljs-type"><span class="hljs-type">Button</span></span> title='  ' icon={{name:'tap-and-play'}} buttonStyle={styles.button} onPress={ () =&gt; { this.props.sendTag({variables: { tag: {shop_id : <span class="hljs-number"><span class="hljs-number">1</span></span>, tag_id : <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">.tagId} } }).then(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">res</span></span></span><span class="hljs-class"> =&gt; { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToastAndroid</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">showWithGravity</span></span></span><span class="hljs-class">(`  `, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToastAndroid</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SHORT</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToastAndroid</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BOTTOM</span></span></span><span class="hljs-class">); } ).catch(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">error</span></span></span><span class="hljs-class"> =&gt;{ </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToastAndroid</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">showWithGravity</span></span></span><span class="hljs-class">(`   (?)`, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToastAndroid</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SHORT</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToastAndroid</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BOTTOM</span></span></span><span class="hljs-class">); }) ; } } /&gt; [...]</span></span></code> </pre><br></div></div><br>  <b>containers / CheckpointAttachContainer.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta">...</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gqlSendTag = gql` <span class="hljs-function"><span class="hljs-function">mutation </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendTag</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$tag: TagInput!</span></span></span><span class="hljs-function">)</span></span> { sendTag(tag: $tag) { tag_id shop_id title } } `; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gqlSendTagProps = { name: <span class="hljs-string"><span class="hljs-string">'sendTag'</span></span>, options: { }, }; [...]</code> </pre><br></div></div><br>  Server: <br><br>  <b>server.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> express <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'express'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createServer } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'http'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> server = express(); [...] <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ws = createServer(server); server.use(PATH.GIQL, graphiqlExpress({ <span class="hljs-attr"><span class="hljs-attr">endpointURL</span></span>: PATH.GQL, <span class="hljs-attr"><span class="hljs-attr">subscriptionsEndpoint</span></span>: <span class="hljs-string"><span class="hljs-string">`ws://</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${GQLSERVERLOCAL.HOST}</span></span></span><span class="hljs-string">:</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${GQLSERVERLOCAL.PORT}</span></span></span><span class="hljs-string">/subscriptions`</span></span> })); ws.listen(GQLSERVERLOCAL.PORT, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubscriptionServer({ execute, subscribe, schema }, { <span class="hljs-attr"><span class="hljs-attr">server</span></span>: ws, <span class="hljs-attr"><span class="hljs-attr">path</span></span>: PATH.SUBS, }); }); [...]</code> </pre><br></div></div><br>  <b>schema.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Mutation</span></span></span><span class="hljs-class"> { [...] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sendTag</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tag</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TagInput</span></span></span><span class="hljs-class">!): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Tag</span></span></span><span class="hljs-class"> } [...] input </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TagInput</span></span></span><span class="hljs-class">{ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shop_id</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tag_id</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Tag</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shop_id</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tag_id</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Subscription</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tagSent</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">shop_id</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class">): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Tag</span></span></span><span class="hljs-class"> } [...]</span></span></code> </pre><br></div></div><br>  <b>resolvers.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs coffeescript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PubSub } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'graphql-subscriptions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withFilter } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'graphql-subscriptions'</span></span>; const pubsub = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PubSub(); [...] <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> const resolvers = { Mutation: { sendTag: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(root, { tag })</span></span></span><span class="hljs-function"> =&gt;</span></span> { const newMessage = { title: tag.title, shop_id: tag.shop_id, tag_id: tag.tag_id }; pubsub.publish(<span class="hljs-string"><span class="hljs-string">'tagSent'</span></span>, { tagSent: newMessage, shop_id: <span class="hljs-string"><span class="hljs-string">'1'</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> newMessage; }, [...] }, Subscription: { tagSent: { subscribe: withFilter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> pubsub.asyncIterator(<span class="hljs-string"><span class="hljs-string">'tagSent'</span></span>), <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(payload, variables)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> payload.shop_id === variables.shop_id; }), }, [...] }, }</code> </pre><br></div></div><br>  Web client: <br><br>  <b>index.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs javascript">[...] <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { SubscriptionClient, addGraphQLSubscriptions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'subscriptions-transport-ws'</span></span>; wsClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubscriptionClient(<span class="hljs-string"><span class="hljs-string">`ws://localhost:3002/subscriptions`</span></span>, { <span class="hljs-attr"><span class="hljs-attr">reconnect</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> networkInterfaceWithSubscriptions = addGraphQLSubscriptions( networkInterface, wsClient, ); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dataIdFromObject</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.__typename) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.id !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${result.__typename}</span></span></span><span class="hljs-string">:</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${result.id}</span></span></span><span class="hljs-string">`</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ApolloClient({ <span class="hljs-attr"><span class="hljs-attr">networkInterface</span></span>: networkInterfaceWithSubscriptions, <span class="hljs-attr"><span class="hljs-attr">customResolvers</span></span>: { <span class="hljs-attr"><span class="hljs-attr">Query</span></span>: { <span class="hljs-attr"><span class="hljs-attr">channel</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_, args</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> toIdValue(dataIdFromObject({ <span class="hljs-attr"><span class="hljs-attr">__typename</span></span>: <span class="hljs-string"><span class="hljs-string">'Channel'</span></span>, <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> })) }, }, }, dataIdFromObject, }); [...]</code> </pre><br></div></div><br>  <b>components / AddCheckpointPage.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { <span class="hljs-type"><span class="hljs-type">Field</span></span> } from <span class="hljs-symbol"><span class="hljs-symbol">'redux</span></span>-form'; [...] &lt;<span class="hljs-type"><span class="hljs-type">Field</span></span> className=<span class="hljs-string"><span class="hljs-string">"form-control"</span></span> id=<span class="hljs-string"><span class="hljs-string">"tag_id"</span></span> name=<span class="hljs-string"><span class="hljs-string">"tag_id"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"text"</span></span> component=<span class="hljs-string"><span class="hljs-string">"input"</span></span> placeholder=<span class="hljs-string"><span class="hljs-string">"     ' '"</span></span>/&gt; [...]</code> </pre><br></div></div><br>  <b>containers / AddCheckpointContainer.js</b> <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs javascript">[...] <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { change <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> changeFieldValue } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-form'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tagSubscription = gql<span class="hljs-string"><span class="hljs-string">` subscription tagSent($shop_id: String) { tagSent(shop_id: $shop_id) { tag_id shop_id title }, } `</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddCheckpointContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ componentWillMount() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.data.subscribeToMore({ <span class="hljs-attr"><span class="hljs-attr">document</span></span>: tagSubscription, <span class="hljs-attr"><span class="hljs-attr">variables</span></span>: { <span class="hljs-attr"><span class="hljs-attr">shop_id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">onError</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(<span class="hljs-string"><span class="hljs-string">'subscribeToMore ERROR:'</span></span>,err), <span class="hljs-attr"><span class="hljs-attr">updateQuery</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">prev, {subscriptionData}</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'updateQuery:'</span></span>,subscriptionData) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.changeFieldValue(<span class="hljs-string"><span class="hljs-string">"addCheckpointForm"</span></span>, <span class="hljs-string"><span class="hljs-string">"tag_id"</span></span>, subscriptionData.data.tagSent.tag_id); } }); }<span class="hljs-comment"><span class="hljs-comment">//componentWillMount() [...] }</span></span></code> </pre><br></div></div><br>  At the end of the analysis - a small video showing the operation of the mobile application and the web client: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/mmfuZZcVOak" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h1>  Development and Debugging Tools </h1><br>  Everything was written and debugged under Windows 7, but for demonstration to the customer it was transferred to a linux server.  As for the development environment, I'm a Sublime fan.  However, I should note that glitch syntax highlighting of queries inside the js code regularly glitches happen.  Painfully there it is all unconventionally combined.  A couple of times the idea arose to try VSCode (but for the time being I hold on) <br><br> <a href=""><img src="https://habrastorage.org/webt/ox/3-/c3/ox3-c3cnudwpt3xfpyjw2nlqora.jpeg"></a> <br><br>  Installing nodejs under Win7 did not cause any special problems, but with the installation and configuration of the Android SDK so that everything then began to move together, I had to tinker well. <br><br>  As for debugging tools, for the web client this is the usual Chrome Dev tools with the Apollo Client Developer Tools and Redux DevTools extensions.  For the mobile application - <a href="https://github.com/jhen0409/react-native-debugger">React Native Debugger</a> (almost the same, only implemented separately on Electron). <br>  I note that for local debugging with an emulator, instead of localhost, you need to use the address <a href="https://developer.android.com/studio/run/emulator-networking.html">10.0.2.2</a> <br><br>  In addition, for the convenience of debugging in the clients themselves and the server, I implemented the ability to send SQL queries to the SQLite database in the smartphone, either directly from the smartphone (from the Debug menu), or remotely from the web application. <br><br>  In the second case, this is done through the GraphQL subscription mechanism, via web sockets.  The web application calls sendDebugRequest () on the server, which generates the message newDebugRequestCreated, to which the mobile application is subscribed.  In a mobile application, upon receiving this message, execSql () is executed.  The result of the request is sent to the server by calling sendDebugResponse (), which in turn generates a newDebugResponseCreated message to which the web application is subscribed.  In fact, this is a kind of chat, just from a mobile application, it is not a person who ‚Äúanswers‚Äù, but a database. <br><br>  To view and edit SQLite files under Win7 I went very well (after sorting through various options) - <a href="https://sqlitestudio.pl/">SQLiteStudio</a> . <br><br>  A useful little thing is that you can use util.inspect () so that the console.log () server is nicely and completely outputting objects. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> util = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'util'</span></span>) util.inspect.defaultOptions.showHidden = <span class="hljs-literal"><span class="hljs-literal">false</span></span> util.inspect.defaultOptions.depth = <span class="hljs-literal"><span class="hljs-literal">null</span></span> util.inspect.defaultOptions.maxArrayLength = <span class="hljs-number"><span class="hljs-number">1000</span></span> util.inspect.defaultOptions.colors = <span class="hljs-literal"><span class="hljs-literal">true</span></span> [...] <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"data: "</span></span>, util.inspect(data))</code> </pre> <br>  Also in connection with the server - all the time I forget that if the variable is promise, then to see the result in the server log is not in the form of "[Promise]". <br><br><pre> <code class="hljs lua">variable.<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(result)</span></span></span></span> { console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'!'</span></span>,result) })</code> </pre> <br><h1>  Authorization / Authentication </h1><br>  When performing registration, the web client calls the server signUp method, where a hash is generated from the entered password using <a href="">bcrypt.hash</a> , which, together with the email (login), is placed in the database. <br><br>    -    signIn,        email    ( bcrypt.compare).    signIn  <a href="https://github.com/auth0/node-jsonwebtoken">jwt.sign</a>  ,   -. <br><br> -    localStorage          http    GraphQL  (   network.use applyMiddleware  req.options.headers.authorization = `Bearer ${token}`) <br><br> ,  GraphQL ,  server.js         http  Authorization,       <a href="https://github.com/auth0/express-jwt">express-jwt</a> ,  user.id,          ,    context,        ( connectors.js).   ,  jwt()    ¬´credentialsRequired: false¬ª,          (     SignIn  SignUp   ). <br><br>  ,     ,      . ,     ,     (email,  ) .           ‚Äî        nfc_id (  ,      NFC )     ,  <a href="https://www.npmjs.com/package/react-native-bcrypt">bcrypt.compare</a>  React Native. <br><br>          ,      . <br><br><h1>  Problems </h1><br>       ,       .     : <br><br><ol><li>  ,   ,       .      ‚Äî ,     -     ,    ‚Äî  .   ,  -   , ..     ,    ,      .   ‚Äî   ,     -    , , 10-20%  .   ‚Äî               ,                 . <br><br>   : ,  node_modules/     200mb     (!)  ‚Äî   . , ,          (    ),    . </li><li>  webpack/babel ‚Äî   .   ,           ‚Äî    -  ¬´ ¬ª,  <a href="https://github.com/facebook/create-react-app">create-react-app</a>  <a href="https://github.com/react-community/create-react-native-app/">create-react-native-app</a> .      ,       ,       .  ,  ,      ( ,  eslint   service-worker.js,   ) <br></li><li>   (   ‚Äî  Win7)        ,                 . ,    ,  ,        .  ,      react-native run-android --variant=release        (,   ,        assets/)    -    (  ,     \android\.gradle ). <br><br>      , ,      ,      ( ‚Äî ) ,         .        ,        . <br><br>             apk ‚Äî     gradle   , , -       ,   ,           (!)  .. .      ,     ,    . <br><br>  , ,        ,          ,            (    ),     . <br></li></ol><br><h1>     ,      ? </h1><br><ol><li>      : </li><li> React Router 4 (      3) </li><li>    <a href="https://github.com/aksonov/react-native-router-flux/">react-native-router-flux</a> () </li><li>   NFC   ,     .  <a href="https://github.com/whitedogg13/react-native-nfc-manager"></a> . </li><li>   Apollo GraphQL       GraphQL    (    ). </li><li>  <a href="https://github.com/AllenFang/react-bootstrap-table">react-bootstrap-table</a>   <a href="https://github.com/react-bootstrap-table/react-bootstrap-table2">react-bootstrap-table2</a>  -  (  react-table). </li><li> ,    Bootstrap.   , Material UI           .  ,         . </li><li>           <a href="https://github.com/sequelize/sequelize">Sequilize</a> .  , -  ,        SQLite     ,   (  ,  )     redux store. <br> , ,     store,     state,      ‚Äî  , ,   . </li><li>   React Native  drawer (,             -   ,     ‚Äî   ).  ,       <a href="https://github.com/react-navigation/react-navigation">react-navigation</a> ,     <a href="https://github.com/aksonov/react-native-router-flux/">react-native-router-flux</a> . </li><li> ,    ‚Äî  .   <a href="https://github.com/erikras/redux-form">redux-form</a> ,            .   React Native     .       redux form       react   react native.     . </li></ol><br>  ,   ,       ( , ,    ,       ): <a href="https://medium.com/react-native-training/building-chatty-a-whatsapp-clone-with-react-native-and-apollo-part-1-setup-68a02f7e11"> ¬´ WhatsApp¬ª</a> ( React-Native, NodeJS, GraphQL)  ,   ,   GraphQL: <a href="https://marmelab.com/blog/2017/09/03/dive-into-graphql.html">Dive intro GraphQL</a> . </div><p>Source: <a href="https://habr.com/ru/post/349762/">https://habr.com/ru/post/349762/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349752/index.html">Get started with Google Go in Azure</a></li>
<li><a href="../349754/index.html">Security Week 5: Literacy at the expense of security; mining at the highest level; site is not for people</a></li>
<li><a href="../349756/index.html">Asynchronous circuits. Calculation of logical functions directly on the event graph. Part 1</a></li>
<li><a href="../349758/index.html">Linux in one file for Macbook</a></li>
<li><a href="../349760/index.html">Bylina about how I worked in a startup</a></li>
<li><a href="../349766/index.html">[Yekaterinburg, announcement] New Java mitapes in Yekaterinburg: java.ural.Meetup @ 1</a></li>
<li><a href="../349768/index.html">The concept of "unqualified (and qualified) performer" in project management</a></li>
<li><a href="../349770/index.html">Localization Vivaldi - we do it together</a></li>
<li><a href="../349776/index.html">We indulge in unary operators in Python</a></li>
<li><a href="../349778/index.html">Creating 2D particle effects in Unity3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>