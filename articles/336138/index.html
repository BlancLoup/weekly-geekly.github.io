<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>System IEEE Software Taggant: protection against false positives antivirus</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post I want to talk about the IEEE Software Taggant system, which was developed by the IEEE Malware Working Group in collaboration with leadin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>System IEEE Software Taggant: protection against false positives antivirus</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/534/785/715/5347857150874b4aa89c7bc99254a989.jpg" alt="image"><br><br>  In this post I want to talk about the IEEE Software Taggant system, which was developed by the IEEE Malware Working Group in collaboration with leading information security companies. <br>  The plans of the Guardant development team have long been to add support for the IEEE Software Taggant to Guardant Armor protector, and finally we did.  A brief overview of the system and practical conclusions in front of you. <br><a name="habracut"></a><br><h2>  Why panic antivirus? </h2><br>  There is no such user who would not face the problem of the false alarm of the antivirus.  The reaction of an ordinary person is often reduced to the removal of a ‚Äúsuspicious‚Äù file, which is often not only not harmful, but, on the contrary, useful and sometimes valuable.  In turn, programmers, knowing about such jokes, can fall into irritation close to stress.  Neither contributes to effective work. <br><br>  Often, such operations occur on files protected by various protectors.  The thing is that modern protectors use code obfuscation intensively.  By obfuscation, I mean technology mutations and code virtualization, as well as their combination.  Obfuscation is used to make it difficult to analyze source code for a certain number of methods and tools.  It is the obfuscated areas of the code that cause the heuristic analyzer of the antivirus to panic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A few years ago, a real battle broke out between antivirus companies and protectors.  Losing, antiviruses decided to ban all packers that are not used in commercial and widely used software.  Then even several well-known packers were banned.  Over time, the situation returned to normal, but there is still no complete solution to the problem. <br><br>  Constant development of obfuscation code, replacing the original code with pseudo-code, which is executed during the work of a protected application, seriously complicated the analysis and affected the performance when scanning protected files with antivirus.  A wide variety of protectors used for legitimate as well as malicious purposes creates problems for the antivirus industry.  A serious security threat is the use by authors of malicious code (trojans, viruses, etc.) protectors to hide their code from detection.  This technique has become used on the server side (server polymorphism), as a result, it has become much more difficult to identify and counteract the threats of malicious code.  Antiviruses are not able to determine what is actually inside a protected file and are forced to seek a balance between reliability and the complete absence of false positives on harmless programs. <br><br><h2>  Control the distribution of protected files </h2><br>  Heuristic analysis was invented by antivirus companies to detect new threats and, in part, is necessary for them to collect suspicious files.  In our case, the probability of false positives is much higher, so antiviruses maintain white signature lists for commercial packers.  This partly helps to improve the situation, but still leaves the antivirus to feel ‚Äúwith impunity‚Äù.  Like "gods" playing dice, they are able to give out a harmless file as a virus.  To justify their existence, antiviruses are forced to complicate the analysis and come up with additional control schemes.  For protectors, they decided to implement a system of complete control over the distribution of protected files.  The system allows you to block only files from unreliable publishers of protected software and show loyalty to files from trusted sources. <br><br>  Antiviruses use digital signatures intensively to verify the authenticity of the file.  Confirmed by well-known organizations, digital signatures provide a reliable way to track the source of a file.  Such organizations are unlikely to sign the malicious code with their certificate.  But not always a digital signature is enough.  There are known cases of infection when the file contained a valid digital signature, because  the virus was introduced at the compilation of the program.  However, the responsibility for applying a digital signature lies with the user of the protector, and a high level of trust is required for the certificate issuer. <br><br>  In 2010, the IEEE Malware Team began discussing how to develop a system ‚Äî now called the IEEE Software Taggant ‚Äî to help identify a particular tread user.  The term ‚Äútaggant‚Äù is borrowed from a system used for explosives, to which a chemical marker is added, traceable to, or even after, an explosion.  The IEEE Software Taggant System embeds a cryptographic marker in the output executable file created by any protector installation.  This allows identification of the unique protector license that was used to protect the file. <br><br>  The emergence of the IEEE Software Taggant system was preceded by the practice of using ‚Äúwatermarks‚Äù.  "Watermarks" contain encrypted license information.  The most responsible protector developers include two sets of watermarks in the executable file.  One to identify the protector, the second to uniquely identify the license.  However, there is no single standard for using watermarks, and each developer of the tread is free to act. <br><br>  According to the system developers themselves, the introduction of the new term ‚Äútaggant‚Äù is ambiguous.  On the one hand, this eliminates the use of the terms ‚Äúwatermark‚Äù and certificate, on the other hand, the IEEE Software Taggant system includes characteristics of both of these tools, although it is very different in terms of its scope and implementation. <br><br><h2>  Infrastructure </h2><br>  The IEEE Software Taggant is effective only if it is used simultaneously by both protector and antivirus.  The system uses a public key infrastructure (PKI), while the root and trusted centers are controlled by IEEE.  If you are a tread vendor, you need to register with IEEE to generate Software Taggant licenses.  The license must be transparent to the users of the tread and integrated into the installer before selling. <br><br>  Before releasing a new tread, vendors are advised to protect a representative sample of 10‚Äì20 files with different protection parameters and put it on a general review.  Antiviruses, in turn, must ensure that there are no false positives of the heuristic analyzer.  The reputation of the file with the Software Taggant should be higher than that of the file without it. <br><br>  When a protected malware is detected with the Software Taggant token, the license with which the malware was protected becomes a candidate for blacklisting.  The community recommends antiviruses to quickly exchange information to compile a complete list of blocked licenses. <br><br><h2>  Cryptographic marker </h2><br>  How does the Software Taggant differ from the usual digital signature Authenticode in Microsoft Windows? <br><br>  The IEEE Software Taggant system allows the calculation of hash sums for small critical program areas to minimize software integrity checking time (Authenticode always covers the entire file, so the checking time depends on the file size).  This is important for antiviruses, as it allows them to work in the quick scan mode.  Another interesting thing is that if you have an Internet connection, a trusted timestamp of creating a marker is added (according to RFC 3161), which allows antiviruses to selectively supplement the blacklist (block software only after a certain moment of compromise). <br><br>  According to the documentation, Taggant can be added not only to PE-format files.  In the list of formats there are ELF and JavaScript.  It is possible to add Taggant to any unstructured format. <br><br>  For the PE format, the analogy with the Windows digital signature is traced.  The taggant structure is written to the end of the PE file as an overlay.  If there is an original overlay in the file, the structure is written after it.  To calculate the hash sum, the SHA2-256 algorithm is used.  The easiest way to add a Taggant to a PE file is to use a utility with the usual name SignTool. <br><br>  <b>Example:</b> <b><br></b> <br>  <i>&gt; SignTool.exe SimpleTest-x86.exe license.pem</i> <i><br></i>  <i>SignTool Application (adds Taggant v2 to files)</i> <i><br></i>  <i>SPV Taggant Library version 2</i> <i><br></i>  <i>Date is Sat Apr 03 23:59:59 2027</i> <i><br></i>  <i>File hashes computed successfully</i> <i><br></i>  <i>Put timestamp</i> <i><br></i>  <i>Timestamp successfully placed</i> <i><br></i>  <i>Prepare the taggant</i> <i><br></i>  <i>Taggant successfully created</i> <i><br></i>  <i>Taggant is written to file</i> <i><br></i> <br>  Microsoft's digital signature does not conflict with Taggant, since  is added after the taggant structure and covers the entire file, including the taggant. <br><br><h2>  Benefits </h2><br>  The IEEE Software Taggant system was developed as a specialized and universal solution for antiviruses and protectors, which certainly is an indisputable advantage over other file authentication methods.  Antivirus get: <br><br><ul><li>  the ability to identify a specific license used to generate malware.  This allows you to blacklist individual licenses without blocking the entire protector. </li><li>  The ability to quickly identify the version and license of the packer, which are used in a well-defined safe mode, without the need to unpack files.  This should improve file scanning performance. </li><li>  ability to identify modified file versions.  Such files can be blacklisted. </li><li>  ability to track license history to enhance the reputation of a particular user of the protector. </li></ul><br>  All of these features should reduce the risk of false positives and improve performance when scanning protected files. <br><br><h2>  Testing </h2><br>  We hoped to reduce the false positives of antiviruses, because the system appeared quite a long time ago.  But alas, the miracle did not happen.  First, look at the results of VirusTotal: <br><br>  <b>Clean file:</b> <b><br></b> <br><img src="https://habrastorage.org/web/48b/98d/7ca/48b98d7ca2d84ed0a879faafe7074030.png" alt="image"><br><br>  <b>Protected file without taggant:</b> <br><br><img src="https://habrastorage.org/web/b14/a21/cd5/b14a21cd53bd4ead9f4500c570dd0bbf.png" alt="image"><br><br>  <b>Protected file with Taggant:</b> <br><br><img src="https://habrastorage.org/web/c59/f8e/fc7/c59f8efc79644219af79eb9ad7e58e19.png" alt="image"><br><br>  <b>Secure Taggant file with Microsoft signature:</b> <br><br><img src="https://habrastorage.org/web/15e/fe7/13c/15efe713c4714ecb88372b004cfc59e2.png" alt="image"><br><br>  Little-known antiviruses do not react to the presence of the Taggant signature, they react more precisely, but vice versa.  For them, the Microsoft signature is still an important argument. <br><br>  Upset us and Kaspersky Endpoint Security.  It places this file in quarantine regardless of the presence of the Taggant signature and the Microsoft signature.  As before, only turning off the heuristic analyzer helps.  At the same time, the scan on VirusTotal by Kaspersky antivirus says that the file is clean. <br><br><img src="https://habrastorage.org/web/1dd/b0f/383/1ddb0f383a0344c6a8e78f5390bfd82a.png" alt="image"><br><br><h2>  Conclusion </h2><br>  Apparently, not all antiviruses are in a hurry to build Taggant support into their engines.  IEEE bureaucracy is also a matter of concern.  Correspondence with this organization took us a huge amount of time.  A simple developer can get into the "white" lists of legal software distributors can be more difficult than using the Microsoft digital signature mechanism.  Nevertheless, Taggant is a worthy alternative to watermarking, and we hope that the system will be gradually introduced.  In the meantime, Microsoft's signature is a stronger argument for antiviruses. <br><br><h3>  References: </h3><br><ol><li>  <a href="https://standards.ieee.org/develop/indconn/icsg/">ICSG: Industry Connections Security Group</a> </li><li>  <a href="http://standards.ieee.org/develop/indconn/icsg/amss.html">IEEE Anti-Malware Support Service (AMSS)</a> </li><li>  <a href="https://github.com/IEEEICSG/IEEE_Taggant_System">GitHub: IEEE_Taggant_System</a> </li><li>  <a href="http://pferrie.host22.com/papers/packerstandards.pdf">Standards and Policies on Packer Use</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/336138/">https://habr.com/ru/post/336138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../336124/index.html">Useful NaN</a></li>
<li><a href="../336128/index.html">Welcome to Moscow Data Science Meetup September 1</a></li>
<li><a href="../336132/index.html">Dive into Ethereum development. Part 1</a></li>
<li><a href="../336134/index.html">Engineering systems of our data centers and their monitoring, part one</a></li>
<li><a href="../336136/index.html">A little bit about pseudo-arrays (mass-like objects or collections). ‚ÄúWhat is this?‚Äù, ‚ÄúHow to work with them?‚Äù And so on</a></li>
<li><a href="../336140/index.html">Auto-optimization of virtual reality or what is the difference between reproducing, timewarp and spacewarp</a></li>
<li><a href="../336142/index.html">Unscientific revolution: how not to go broke on fake innovations</a></li>
<li><a href="../336144/index.html">We measure the dynamics of mentioning entities in the information field</a></li>
<li><a href="../336152/index.html">Parallels Desktop for Mac 13: Ready for macOS High Sierra</a></li>
<li><a href="../336154/index.html">Log storage for a cloud platform. ELK implementation experience</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>