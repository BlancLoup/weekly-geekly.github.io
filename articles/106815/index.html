<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Microcast: Iterators / Generating Date Ranges, Numbers, etc.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is inspired by the topic " counting the number of calendar events in each month of the year ." There is nothing new in it, it's just a mi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Microcast: Iterators / Generating Date Ranges, Numbers, etc.</h1><div class="post__text post__text-html js-mediator-article">  This article is inspired by the topic " <a href="http://habrahabr.ru/blogs/mysql/106793/">counting the number of calendar events in each month of the year</a> ."  There is nothing new in it, it's just a micro-note about possible solutions. <br>  Although the task of that topic is very typical and was solved quite calmly with the usual passage with case or if: <br><blockquote><code><font color="black"><font color="#0000ff">SELECT</font> <br> <font color="#0000ff">sum</font> ( <br> <font color="#0000ff">CASE</font> <br> <font color="#0000ff">when</font> t.`start_date`&lt; <font color="#A31515">'2010-02-01'</font> <font color="#0000ff">and</font> t.end_date&gt; <font color="#A31515">'2010-01-01'</font> <font color="#0000ff">then</font> 1 <br> <font color="#0000ff">else</font> 0 <br> <font color="#0000ff">end</font> <br> ) <br> <font color="#0000ff">AS</font> jan, <br> <font color="#0000ff">sum</font> ( <br> <font color="#0000ff">CASE</font> <br> <font color="#0000ff">when</font> t.`start_date`&lt; <font color="#A31515">'2010-03-01'</font> <font color="#0000ff">and</font> t.end_date&gt; <font color="#A31515">'2010-02-01'</font> <font color="#0000ff">then</font> 1 <br> <font color="#0000ff">else</font> 0 <br> <font color="#0000ff">end</font> <br> ) <br> <font color="#0000ff">AS</font> feb, <br> ... <br> <font color="#0000ff">FROM</font> test t</font> <br></code> </blockquote><br>  But I found it necessary to write about some possibilities to avoid unnecessary manual work.  For example, if we needed to aggregate not for a year and not for two, but, say, for the last 5 years, monthly.  Agree, in that case 60 lines with if would be at least hard to read. <br><a name="habracut"></a><br>  <a href="https://habrahabr.ru/users/jaydi/" class="user_link">JayDi</a> <a href="http://habrahabr.ru/blogs/mysql/106793/">was going in the right direction</a> talking about the date plate, but it would have to be separately created, even with specific conditions (daily, monthly or per second, etc.) ... This method is even <a href="http://datacharmer.blogspot.com/2006/06/filling-test-tables-quickly.html">used sometimes</a> . <br><br>  In principle, I have nothing against the creation of temporary tables, but in this case they are completely unnecessary.  In Oracle, for example, generation of such time ranges-counters can be done as you please, for example, " <i>select rownum &lt;N</i> ", either by creating a pipelined function, or by using types from dbms_sql, or <a href="http://www.xt-r.com/2010/10/1-oracle.html">using collections</a> .  In mysql, unfortunately, there is no ‚Äúconnect by‚Äù, but there is information_schema, an analogue of the oracle data dictionary, and oraklists quite often use queries like " <b>select rownum from all_objects</b> " for test runs.  We can do the same in the same way: <br><br>  Sample for grouping and join for 10 months from the beginning of 2010: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">-- <font color="#0000ff">set</font> @rownumber:=0; <br> <font color="#0000ff">select</font> <br> <font color="#0000ff">case</font> <br> <font color="#0000ff">when</font> @rownumber <font color="#0000ff">is</font> <font color="#0000ff">null</font> <br> <font color="#0000ff">then</font> @rownumber:=1 <br> <font color="#0000ff">else</font> @rownumber:=@rownumber+1 <br> <font color="#0000ff">end</font> n, <br> DATE_FORMAT( <br> date_add( <font color="#A31515">'2010-01-01'</font> , <font color="#0000ff">interval</font> @rownumber <font color="#0000ff">month</font> ), <br> <font color="#A31515">'%Y.%m'</font> ) <font color="#0000ff">month</font> <br> <font color="#0000ff">from</font> <br> information_schema.columns t <br> <font color="#0000ff">limit</font> 10</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Here we simply use the information_schema.column as a row generator, which can be replaced by any other, which is mostly not used and in which there are guaranteed enough rows for our query (in my case, for example, there are 5281 of them).  The first commented line must be executed to reset the counter variable. <br>  We get: <br><pre> n month
 1 2010.01
 2 2010.02
 3 2010.03
 4 2010.04
 5th 2010.05
 6 2010.06
 7 2010.07
 8 2010.08
 9th 2010.09
 10 2010.10
</pre><br>  Now you can join this table with your table according to your conditions.  If you do not know in advance the required number of months (lines), then instead of limit, limit the conditions to the minimum and maximum dates. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Another solution: the solution "in the forehead" - the use of cursors.  Well, what could be more logical than creating a procedure using cursors if we need to assemble more complex aggregates than built-in ones?  I will not even describe this question (you can read, for example, <a href="http://habrahabr.ru/blogs/mysql/46333/">here</a> ), but do not forget about them (in that topic, no one even remembered about it ...) </div><p>Source: <a href="https://habr.com/ru/post/106815/">https://habr.com/ru/post/106815/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../106807/index.html">Love of Google Maps to Russian strategic sites</a></li>
<li><a href="../106809/index.html">Ruby and EventMachine</a></li>
<li><a href="../106810/index.html">Entering an American Business School</a></li>
<li><a href="../106811/index.html">Using Coffeescript on Windows</a></li>
<li><a href="../106813/index.html">Convert UserJS to Opera extension</a></li>
<li><a href="../106816/index.html">The first Russian applications appeared in the Windows Marketplace</a></li>
<li><a href="../106817/index.html">Modification of the Chieftec power supply cooling system</a></li>
<li><a href="../106818/index.html">DesignGu.ru Podcast</a></li>
<li><a href="../106820/index.html">Tuning linux for games</a></li>
<li><a href="../106824/index.html">vWorkspace 7.2 Beta 2 - generating a config.xml file using AppPortal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>