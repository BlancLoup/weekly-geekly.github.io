<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Improving search relevance in sphinxsearch</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sphinxsearch is a search engine for fast fulltextsearch, can receive data from mysql, oracle and mssql, can act as a repository itself (realtime index...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Improving search relevance in sphinxsearch</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage2/151/944/77c/15194477cf182efdb060d77ffd1c6eb3.jpg">  Sphinxsearch is a search engine for fast fulltextsearch, can receive data from mysql, oracle and mssql, can act as a repository itself (realtime indexes).  Also, sphinx has an operation mode via api and via sphinxql - an analogue of the sql protocol (with some restrictions), which allows you to connect a search through sphinx on the site with minimal code changes.  This is one of the few great, large and open projects developed in Russia.  In my life, I have seen sphinx handle about 100-200 search queries for 2 million records from mysql and at the same time the server was breathing freely and was not sick, mysql is starting to die at 10 requests per second on a similar config. <br><br>  The main problem of sphinx documentation in my opinion is a small number of examples for most interesting settings, today I will try to tell you about them in examples.  The options that I‚Äôll touch on relate mainly to algorithms and search variations.  Anyone who works closely with sphinx will not learn anything new, and newbies hopefully can improve the quality of search on their sites. <br><br>  Sphinx contains two independent programs, indexer and searchd.  The first builds indexes according to data taken from the database, the second searches the built index.  Now let's move on to the search settings in sphinx. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  morphology </h5><br>  Allows you to set the morphology of words, I use only stemming.  The algorithm of stemming with the help of a set of rules for the language cuts off the endings and suffixes.  Stemming does not use ready-made bases of words, but is based on certain rules of circumcision for the language, which makes it small and fast, but this also adds to its disadvantages as it can make mistakes. <br><br>  An example of the normalization of the word stemming in Russian. <br>  The words ‚Äúapple‚Äù, ‚Äúapples‚Äù, ‚Äúapple‚Äù will be cut in ‚Äúapples‚Äù and any search query with a variation of the word ‚Äúapple‚Äù will also be normalized and will find records with the words that were described above. <br><a name="habracut"></a><br>  For English, the words ‚Äúdogs‚Äù and ‚Äúdog‚Äù will be normalized to ‚Äúdog‚Äù. <br>  For example, in sphinx should put the word curly into the index, the word curly into the index, and there will be variations of the curly, curly, etc. <br>  Enable stemming is possible for Russian, English or both languages. <br><br>  morphology = stem_en <br>  morphology = stem_ru <br>  morphology = stem_enru <br><br>  You can also use the options Soundex and Metaphone they allow you to use for the English language, taking into account the sound of words.  I do not use these morphology algorithms in my work, so if someone knows a lot about them I will be happy to read.  For the Russian language, such algorithms would allow to obtain from the words ‚Äúsun‚Äù and ‚Äúsun‚Äù the normalized form ‚Äúsun‚Äù, which is obtained on the basis of the sound and pronunciation of these words. <br><br>  morphology = stem_enru, Soundex, Metaphone <br><br>  You can connect and external engines for morphology or write your own. <br><br><h4>  Wordforms </h4><br>  Allows you to connect your word form dictionaries, is well applied on specialized subject sites, has a good example in the documentation. <br><br>  core 2 duo&gt; c2d <br>  e6600&gt; c2d <br>  core 2duo&gt; c2d <br><br>  Allows you to find an article on core 2 duo for any search query from the model before name variations. <br><br>  hemp&gt; grass <br>  dope&gt; weed <br>  my beauty&gt; grass <br>  grass of freedom&gt; grass <br>  why smoke&gt; grass <br>  there is something&gt; grass <br><br>  And this dictionary will allow your user to easily find information about weed on the site. <br><br>  For word forms, files in ispell or MySpell format are used (which can be done in Open Office) <br><br>  wordforms = /usr/local/sphinx/data/wordforms.txt <br><br><h4>  enable_star </h4><br>  Allows you to use asterisks in queries, for example, on request * pr * prospect, hello, approximation, etc. will be found. <br><br>  enable_star = 1 <br><br><h4>  expand_keywords </h4><br>  Automatically expands the search query to three queries. <br><br>  running -&gt; (running | * running * | = running) <br><br>  Just a word with morphology, a word with asterisks and a complete word match.  Previously, this option was not available and in order to search with asterisks I had to manually make an additional request, now everything is turned on by one option.  Also, a complete match will be automatically higher in search results than a search with asterisks and morphology. <br><br>  expand_keywords = 1 <br><br><h4>  index_exact_words </h4><br>  Allows along with the morphologically normalized form to store the original word in the index.  This greatly increases the size of the index, but with the previous option allows you to produce results more relevant. <br><br>  For example, there are three words ‚Äúmelon‚Äù, ‚Äúmelon‚Äù, ‚Äúmelon‚Äù without this option, all three words will be saved in the index as a melon and at the request ‚Äúmelon‚Äù will be issued in the order added to the index, that is, ‚Äúmelon‚Äù, ‚Äúmelon‚Äù ‚ÄúMelon‚Äù. <br>  If you turn on the expand_keywords and index_exact_words options, then the query ‚Äúmelon‚Äù will have a more relevant issue of ‚Äúmelon‚Äù, ‚Äúmelon‚Äù, ‚Äúmelon‚Äù. <br><br>  index_exact_words = 1 <br><br><h4>  min_infix_len </h4><br>  Allows you to index parts of the word infixes, and search by them using *, like search *, * search and * search *. <br>  For example, if min_infix_len = 2 and if the word ‚Äútest‚Äù falls into the index, they will be saved into the index ‚Äúthose‚Äù, ‚Äúes‚Äù, ‚Äúst‚Äù, ‚Äútes‚Äù, ‚Äúeats‚Äù, ‚Äútest‚Äù and on request ‚Äúec‚Äù will be found this word. <br><br>  I usually use <br><br>  min_infix_len = 3 <br><br>  A lower value generates too much garbage and remember that using this option greatly increases the index. <br><br><h4>  min_prefix_len </h4><br>  It is a child of min_infix_len and does almost the same thing only preserves the beginning of words or prefixes. <br>  For example, if min_infix_len = 2 and if the word ‚Äútest‚Äù falls into the index, then the word ‚Äúte‚Äù, ‚Äútes‚Äù, ‚Äútest‚Äù will be saved and the word ‚Äúsearch‚Äù will be found. <br>  min_prefix_len = 3 <br><br><h4>  min_word_len </h4><br><br>  The minimum word size for indexing, defaults to 1 and indexes all words. <br>  I usually use <br>  min_word_len = 3 <br>  Smaller words usually have no meaning. <br><br><h4>  html_strip </h4><br>  Cuts all html tags and html comments.  This option is relevant if you build your google / yandex based on sphinxsearch.  They launched a spider sparsili site, drove it into the database, slayed the indexer and this option will get rid of the trash in the form of html tags and search only on the site content. <br><br>  I myself unfortunately did not use it, but the documentation says that it can mess up with all sorts of xml and not standard html (for example, wherever it opens and closes tags, etc.). <br><br>  html_strip = 1 <br><br>  I will be glad to any questions and clarifications. <br>  <a href="http://sphinxsearch.com/">Offsite sphinxsearch.com</a> . <br>  If the article was interesting to you, do not be lazy plus. </div><p>Source: <a href="https://habr.com/ru/post/147745/">https://habr.com/ru/post/147745/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../147739/index.html">Read more about the implementation of GCM support on the Android client</a></li>
<li><a href="../147741/index.html">How I became a Robocode Champion</a></li>
<li><a href="../147742/index.html">Poster app for iOS: buying movie tickets, viewing trailers, adding photos and places</a></li>
<li><a href="../147743/index.html">Data access speed: the battle for the future</a></li>
<li><a href="../147744/index.html">2 million points on the map? easy!</a></li>
<li><a href="../147746/index.html">Real-time 3D rendering for architecture and industrial design</a></li>
<li><a href="../147748/index.html">Hacked androidforums.com</a></li>
<li><a href="../147750/index.html">Active Directory Audit Powershell Change Alert. Part 1</a></li>
<li><a href="../147751/index.html">Installing ZTE AX226 in Ubuntu 11.04 and 12.04</a></li>
<li><a href="../147752/index.html">It's not a shame to watch such an advertisement: Thematic selection of the best commercials about telecom 2012</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>