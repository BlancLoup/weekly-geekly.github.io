<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reaction to longevity: how we updated the Lingualeo frontend</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúIf you are not ashamed of the first version of your product, then you are late with entering the market‚Äù 
 These words justify the development of the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reaction to longevity: how we updated the Lingualeo frontend</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/b14/6d6/afe/b146d6afe09f422eb354e0baff04d317.png" alt="image"><br><br><blockquote>  ‚ÄúIf you are not ashamed of the first version of your product, then you are late with entering the market‚Äù </blockquote><br>  These words justify the development of the Lingualeo front-end from the very beginning, from 2010.  In a complex multi-platform product with a 5-year history, the code layered a little thicker than the layers of soil above the archaeological Tripoli culture.  And so, this day has come: we decided to run up and jump properly, updating the web client platform.  Below we will tell what we did to land as far as possible from the point of reference. <br><a name="habracut"></a><br>  A PR person who was recklessly trying to dig into an understanding of all this had to say that the main technologies on which Lingualeo's frontend is based are crutches and bicycles.  We hope she has enough sense not to write it on Habr. <br><br><h4>  Step one.  Dig a PR manager </h4><br>  The Lingualeo frontend runs on a heap of diverse libraries, with code distributed from places where sadness is pichal, to those places where the ‚Äúbleeding edge‚Äù is also a kind of sadness-pichal :-D.  In ancient times, everything started on the Lingualeo website with jS files with jQuery splashes.  Then it became necessary to break it, and some semblance of ‚Äúwidgets‚Äù appeared, to which they hooked the global bus of events.  The system of "widgets" has undergone several iterations, until we decided to move to the so-called component approach.  After some hesitation and searching, we added a bit of entropy to the hectic around <a href="https://facebook.github.io/react/">React</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/0ca/f0d/9b5/0caf0d9b574d4817b2460e5b614bc2c7.png" alt="image"><br><br><h4>  Step two.  To blind, from what was, and add a little from myself </h4><br>  So, for those who are far from the topic and were too lazy to follow the link above, we inform you: React is a JS library for building user interfaces.  By the time our experiments began, React was released in version 0.13.  With him and started to work.  Directly with React "make friends" failed for several reasons: <br><br><ul><li>  we had to somehow maintain and cross the previous code and the code on React, </li><li>  at the start, I did not want to give up the usual text patterns, </li><li>  it was interesting to dig deeper and write something of my own, </li><li>  our collector (who is also many years old) has not learned to work with jsx. </li></ul><br>  So we decided to write a ‚Äúwrapper‚Äù of our own, and use a ready-made system for creating and working with Virtual DOM: <br><br><ul><li>  <a href="https://github.com/Matt-Esch/virtual-dom">https://github.com/Matt-Esch/virtual-dom</a> to build a Virtual DOM and compare it with the previous Virtual DOM, </li><li>  <a href="https://github.com/marcelklehr/vdom-virtualize">https://github.com/marcelklehr/vdom-virtualize</a> - to convert html to Virtual DOM, </li><li>  <a href="https://github.com/nthtran/vdom-to-html">https://github.com/nthtran/vdom-to-html</a> - to convert Virtual DOM to html (we thought it would be useful, but no, we use it mainly for debugging). </li></ul><br>  By the way, we already mentioned this in a post about a <a href="http://habrahabr.ru/company/lingualeo/blog/267457/">new grammar training</a> . <br><br>  We tried to write the ‚Äúwrapper‚Äù with API compatibility with React components, i.e.  passing the same life cycle with the following hooks: <br><br>  (componentWillMount, componentDidMount, componentWillUnmount, <br>  componentWillUpdate, componentDidUpdate, <br>  componentWillReceiveProps) <br><br>  So you can look for some general cases, as if we are working with React, and indeed there is a reserve for a simpler transition to React without rewriting all the components. <br><br><h4>  Step three.  Go down to earth and love life again </h4><br>  The whole euphoria of switching to a planned plan with the Virtual DOM was a little dumbfounded when the question of how to deal with the flow of data and the processing of user events was ripe.  The architectural approach of <a href="https://facebook.github.io/flux/">Flux</a> seemed to us to be a very abstract solution.  Having written with it, the first version of the <a href="http://lingualeo.com/ru/grammar/rules%3Ffrom%3Dtop-menu">new grammar workout</a> , we backed up and turned in the direction of <a href="https://github.com/rackt/redux">Redux</a> .  We consider this approach more direct and concise: a single data warehouse, middlewares, and neat handler functions that we like as event handlers.  But we would not be us without writing our own layer to implement this approach, for which there were several different reasons.  The latter mostly rested on our collector: it does not support ES6, on which Redux is written. <br><br><img src="https://habrastorage.org/files/61e/521/bac/61e521bac0da47368fe56cf3c292725c.jpeg" alt="image"><br><br>  <i>Redux <a href="https://github.com/rackt/redux/issues/151">in the view of developers</a></i> <br><br><h4>  Step Four.  Dream and embody </h4><br>  As a result, we slowly reach for a brighter future, in which: <br><br><ul><li>  in the components of the minimum business logic, they simply reflect the state and listen to events from the user; </li><li>  all business logic (reaction to events) is accumulated inside the store, or rather, Reducer, which returns a new store state based on the old state and action; </li><li>  some asynchronous actions are placed in the action creators or even in middlewares; </li><li>  the animation is our stumbling block, the horror of all the front-tenders is crammed into components (not everyone has confidence in this approach). </li></ul><br>  In fact, there is still a lapping to this approach, and not all questions have obvious answers, as in the case of animation, for example, but in general, we really like this approach and make life well in places where it is implemented. <br>  The plans for the future - the transition to Virtual DOM throughout the site and the introduction of the <s>normal</s> now popular collector <a href="https://github.com/webpack/webpack">webpack</a> .  Of course, all this takes time and care. <br><br>  By the way, we will be very grateful to habrovchan for comments on how they work with animation in React: they are interested in complex cases when there are several interacting animations, or interaction with a component during animation).  And the question of how the transition from one architecture to another was carried out is also interesting for you ;-) <br><br>  Yours sincerely, Lingualeo frontend team. <br><br>  Follow our news on <a href="https://twitter.com/LinguaLeo">Twitter</a> , <a href="">Facebook</a> , <a href="http://vk.com/lingualeo">vkontakte</a> and <a href="http://instagram.com/lingualeo">Instagram</a> . <br><br>  <b>Off topic:</b> Lingualeo is waiting for its developers iOS and Android.  Read about all open vacancies in the <a href="http://corp.lingualeo.com/ru/careers/">blog</a> on the site lingualeo.com.  We are waiting for your resume! </div><p>Source: <a href="https://habr.com/ru/post/270243/">https://habr.com/ru/post/270243/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270231/index.html">How the second chip allows hackers to bypass the verification process of a bank card</a></li>
<li><a href="../270233/index.html">About Parboiled</a></li>
<li><a href="../270235/index.html">Programmer's resume: how to make it convenient?</a></li>
<li><a href="../270237/index.html">CONVERT web analytics and internet marketing conference: preliminary program</a></li>
<li><a href="../270241/index.html">Index-based programming or why do we need all these if, switch, ternary operator?</a></li>
<li><a href="../270245/index.html">Smooth scroll on AngularJS using requestAnimationFrame + style tips</a></li>
<li><a href="../270247/index.html">SWAPY with a new code generator</a></li>
<li><a href="../270249/index.html">New Intercepter-NG released [Android Edition] 1.6</a></li>
<li><a href="../270251/index.html">‚ÄúStored Procedures‚Äù in Redis</a></li>
<li><a href="../270253/index.html">What's new in Fedora 23 Workstation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>