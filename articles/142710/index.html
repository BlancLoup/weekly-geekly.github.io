<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>FortNotes - online password manager</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon. 
 I want to share a project that I recently completed. I hope someone will come in handy. 
 Everyone who has used the Internet for a l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>FortNotes - online password manager</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon. <br>  I want to share a project that I recently completed.  I hope someone will come in handy. <br>  Everyone who has used the Internet for a long time has probably accumulated a large amount of various private data, such as usernames and passwords for websites, mailboxes, servers and databases.  Someone less, someone more, but everyone has such data.  You can store it on scraps of paper, stickers on the monitor, in a notebook on a bedside table, or in a file on the desktop.  Many people realize that this is not very safe: someone can spy or tritely lose this precious data, but usually rarely anyone tries to do something about it. <br>  The Internet has entered our lives very tightly and it would be nice to be able to streamline and secure your data.  Even if you don‚Äôt keep millions in banks and don‚Äôt worry that someone steals a password from a bank account, it doesn‚Äôt mean that losing access to mail, wm-keeper or facebook will be pleasant.  Personal correspondence, business contacts, photos, secret information of a different type - all this should not be available to anyone except the owner. <br><a name="habracut"></a><br><h2>  General system description </h2><br>  <a href="http://fortnotes.com/" title="FortNotes Online Password Manager">FortNotes</a> is Fort Knox for user data.  The technology behind this project is <a href="http://en.wikipedia.org/wiki/Black_box_theory" title="Black box theory">BlackBox</a> , a black box or an encrypted container.  All records created on this site are immediately encrypted directly in the browser using <a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard" title="Advanced Encryption Standard">AES</a> (a symmetric block encryption algorithm adopted as the encryption standard by the US government) and only after that are sent to the server already encrypted.  This means that no one except the data owner has access to them.  Neither the interception of Internet connection data, nor the study of an encrypted container by an overly curious site administrator, will allow access to the original data.  Without a user password, this would just be a meaningless jumble of characters.  The black box is decrypted in real information only when entering the FortNotes site and entering a password.  Thus, users do not trust the storage of their secret data to anyone: the FortNotes server stores only encrypted black boxes and nothing more, no information in the clear.  Further, the user's computer and browser does not even leave the login, which is registered in the system.  Absolutely everything is encrypted before being sent to the server.  When data is needed, a request is sent, a crypto-container is uploaded and decryption occurs.  The process is automated and transparent: only a preliminary password is required. <br><br><h2>  Going deeper </h2><br><h4>  check in </h4><br>  For registration in the system, only a login and password are required, which are converted into a sha256-hash before being sent to the server, which essentially makes the registration anonymous.  Instead of user names and their passwords in the database are character sequences of the form "a9dc602f9d82bc6720b2b4bb016edcacf7da4b2b453a466b742da743f3cba15d".  The server does not store any data that could identify users.  For the same reason, the user's e-mail is not requested, so the recovery of the login and password is impossible.  The high level of security imposes certain requirements: there are no backdoors, no ‚Äúrecovery of forgotten passwords‚Äù.  This means that the loss of this password is equivalent to the loss of the entire database of secret user data.  The modal registration window strongly emphasizes this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/506/6d4/4a3/5066d44a3189ecb8a4bac82d8d0c21c4.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Captcha is used to verify registration: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b97/3b2/0ba/b973b20ba09605ef5460254100aec828.png"><br><br>  After successful registration there is a redirect to the user section.  Each time you enter this closed section, a password is requested, which is necessary for all data encryption and decryption operations.  The password is stored in RAM for a limited (adjustable) time, after which it is cleared and again requested from the user: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/319/efa/4dc/319efa4dc8b8442471042761df4f351d.png"><br><br>  Before clearing the password (after its storage time has expired), all data that has not yet been saved is encrypted and temporarily stored in the browser without being sent to the server.  After the user enters his password, this data will be restored, and the user will be able to continue working. <br><br>  Two commands are available in the upper right corner of the screen: <br><ul><li>  <b>Lock</b> allows you to immediately encrypt all open data, erase the password from the memory and lock the screen until a password is entered.  It is important to remember that if at this moment any notes were edited and they were not saved, then with this lock, these changes will remain only in the browser and will not get to the server until the user explicitly stores the note. <br></li><li>  <b>Exit</b> performs a full logout with clearing the password from memory, deleting all user caches and sessions on the server, and then redirects to the project‚Äôs home page. <br></li></ul><br><h4>  Create and edit notes </h4><br>  The main unit of information in the system is a note.  Notes can be of different types.  To create notes there are a dozen basic types, designed in the form of templates.  With their help, in one click you can get a note like "mailbox", "site", "jabber account", "ssh / ftp server", etc.  Types are not static, but more on that later.  List of sample templates for notes: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/92a/0b0/32d/92a0b032df9eea49df1a934b7264e3e4.png"><br><br>  Each note consists of a set of fields ( <b>entry</b> ), which are the final input fields of information, and a list of tags, separated by a space.  For example, a skype note consists of three fields: skype name (skype account name), password (password), comments (optional comment field) and looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4bf/98a/22f/4bf98a22f12c446a5b193b7fcc4e6e0a.png"><br><br>  Fields, in turn, are also divided by type: simple single-line text, e-mail, URI (for addresses such as sites), password, multi-line text, html. <br>  The division by types for the fields allows you to add various auxiliary operations: for example, for the password type field, the function of generating a random password of a given length becomes available; <br><br>  As mentioned above, the fields in the notes are not static.  In a Skype-type note, you can add a new field of any type at any time (for example, e-mail) and position it in the desired location, you can delete any existing field (restore deleted), move higher or lower, change type or just edit text field and title. <br>  When you hover the mouse over any field, additional controls pop up: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5c/edc/2f6/a5cedc2f69ef7ae9109064292da19e57.png"><br><br>  The type of any field can be changed at any time using the appropriate item.  The text of the header (if it was changed) and the data is saved. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7de/678/edd/7de678eddf3c37b4df3f2571f390204e.png"><br><br>  We should also note the review of the history of changes in each field with the ability to roll back to previously saved values.  Both field data and header are restored.  When you select the appropriate item in the pop-up menu, a table appears with the ten most recent history values ‚Äã‚Äãand a link to restore: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ae/eb1/849/7aeeb1849c5ad30eec31b69c498c086b.png"><br><br>  When changing the header or data of an existing note, the modified data is highlighted: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e74/6c4/2d1/e746c42d12ac3f60199168965a2607d5.png"><br><br>  After making changes while saving a note, which fields are added visually and which are updated (plus a new field, a check mark is updated): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ffe/699/8d9/ffe6998d9d21135eba31a332d6580123.png"><br><br>  When editing a note, it is possible to perform a quick save using the <u>Ctrl</u> + <u>Enter</u> key combination. <br>  In addition to saving, two special commands are available - duplicating the current note and creating a new note with the same current one, but with empty fields.  It will be convenient when creating a series of similar notes. <br><br><h4>  Search and filtering </h4><br>  The search on the server side is carried out with the help of tags that are listed separated by spaces in the search string.  Using a search tag with a minus sign in front of it displays a list of notes where such a tag is not found.  In addition to custom tags created when adding notes, there is a set of system tags for getting a list of deleted notes, notes without tags, or filtering by last access time.  Such tags are available in the search bar after entering the colon character " <b>:</b> ".  The example below shows the search result for records for the last month, where the <b>site</b> , <b>work</b> and <b>dev</b> tags are found, but the <b>php</b> tag is not found: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b2d/88c/76e/b2d88c76ef58d8de7a0ef5a5f77d965f.png"><br><br>  The resulting list displays all satisfying notes, where each line corresponds to one note with a brief indication of the field contents, the date of the last changes and a complete list of tags.  When you click on a tag, you can add it to the search terms or remove it from the search, if it was already there.  With the <u>Ctrl</u> key <u>pressed</u> simultaneously, you can add the selected tag with a minus sign to the search. <br><br>  The search field supports intelligent auto-completion.  Just start typing the name of the tag and immediately a list of possible options will be displayed, taking into account the tags already entered.  Those.  Only those tags that are found in pairs with those already indicated are displayed. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3fa/860/15c/3fa86015c5e44dcd286204f113fb0e5a.png"><br><br>  Tag search returns the first 20 notes.  If you need to get a complete list, you can use the corresponding <b>load all</b> link.  There are also links to highlight all notes, deselect and invert.  To start working with a note, simply click on it with the mouse, after which the line will be marked with a check mark and highlighted in green, and the note will be opened in edit mode.  It is also possible to tick one or more notes by clicking on the desired line with the <u>Ctrl</u> key <u>pressed</u> .  Similar to working in file managers, selecting notes while holding down the <u>Shift</u> key works ‚Äî it selects all the elements between two mouse clicks.  You can perform general operations on selected checkmarks: delete or restore deleted ones.  To switch to the deleted notes recovery mode, you can use the system tag <b>: deleted</b> .  Also, the ability to go to the recovery is present in the tooltip that pops up immediately after deleting the selected notes. <br>  If words that are not tags are found in the search bar, they will be used to further filter all the notes loaded in the list. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/95e/d1e/127/95ed1e1270baec3ffc4f36df7b8866c8.png"><br><br><h4>  Technical side </h4><br>  Development languages ‚Äã‚Äã- PHP and Javascript.  The second is significantly more, because the main work goes on the client side.  The role of the server side is reduced to the registration / authorization and processing of <a href="http://en.wikipedia.org/wiki/AJAX" title="Asynchronous JavaScript and XML">AJAX</a> requests to save / retrieve data and their search.  For AES encryption on the client using a 256 bit key, the wonderful Stanford Javascript Crypto Library ( <a href="http://crypto.stanford.edu/sjcl/" title="the computer security system for the cryptography in javascript">SJCL)</a> library is used. <br><br>  The client side is essentially a web application that runs without reloads, and consists of a set of js classes.  The <a href="http://jquery.com/" title="A quick and concise JavaScript Library that simplifies HTML document handling, event handling, animating, and Ajax interactions for rapid web development">jQuery</a> library and modules for it are actively used: <a href="https://github.com/dyve/jquery-autocomplete" title="The original jQuery autocompleter">jquery-autocomplete</a> and <a href="http://www.ericmmartin.com/projects/simplemodal/" title="a lightweight jQuery Plugin for modal dialog development">SimpleModal</a> .  There is a system core, the main function of which comes down to storing and retrieving a password, as well as encrypting and decrypting data using this password.  All other modules of the system (using the <a href="http://en.wikipedia.org/wiki/Observer_pattern" title="It‚Äôs not a matter of how you want to use it.">observer</a> template) are notified when the password is received from the user, or when the storage time has expired.  Depending on this, the decryption of the closed data takes place with further display, or cleaning / encryption and blocking. <br>  All communication between the client and the server is performed by the data in the <a href="http://en.wikipedia.org/wiki/JSON" title="Javascript object notation">JSON</a> format.  When starting a web application, all reference data is already present on the page as JS arrays and objects.  Further requests are performed using background <a href="http://en.wikipedia.org/wiki/AJAX" title="Asynchronous JavaScript and XML">AJAX</a> requests. <br><br>  For the server side, a micro-framework was developed with <a href="http://ru.wikipedia.org/wiki/%25D0%25A7%25D0%259F%25D0%25A3_(%25D0%2598%25D0%25BD%25D1%2582%25D0%25B5%25D1%2580%25D0%25BD%25D0%25B5%25D1%2582)" title="human-readable web addresses">CNC</a> support and absolutely minimal functionality.  The ‚Äúnothing superfluous‚Äù approach and maximum caching (general data ‚Äî <a href="http://pecl.php.net/package/APC" title="Alternative PHP Cache">APC</a> , user- <a href="http://en.wikipedia.org/wiki/JSON" title="Javascript object notation">JSON</a> in gzipovannyh files on the <a href="http://en.wikipedia.org/wiki/Ramfs" title="persistent storage device">RAMFS</a> partition in RAM) made it possible to achieve quite impressive performance indicators.  So, for example, the generation of a page of a closed user section takes 5-7ms on an old machine of the level Athlon 2800+. <br><br>  <a href="httpd" title="an open-source web server optimized for speed-critical environments">Lighttpd is</a> used as a web server.  <a href="http://php-fpm.org/" title="A simple and robust FastCGI Process Manager for PHP">PHP-FPM</a> as a <a href="http://en.wikipedia.org/wiki/FastCGI" title="a protocol for interfacing interactive programs with a web server">FastCGI</a> process manager. <br>  Database - <a href="http://en.wikipedia.org/wiki/MySql" title="relational database management system">MySql</a> .  Access is done through its implementation of an approach similar to the <a href="http://www.meekro.com/" title="What is SQL? 100% impossible.">MeekroDB</a> library.  The difference is in the use of PDO and the in-built validation of tables and fields.  This library is allocated in a separate <a href="https://bitbucket.org/DarkPark/db" title="PHP PDO library similar to MeekroDB">project</a> .  Using PDO in theory means being able to work with other databases (besides MySql), but this has not been tested. <br><br>  To minimize calls to the server, all JS files are packed into one collective file all.js, and all CSS files are packed into all.css.  When modifying any source file in debug mode, automatic reassembly occurs. <br><br>  The system contains two shell scripts, init.sh and halt.sh, executed when the server is started and shut down, respectively: <br><ul><li>  <b>init.sh</b> creates a directory for the cache (if necessary) and mounts it as <a href="http://en.wikipedia.org/wiki/Ramfs" title="persistent storage device">RAMFS</a> .  If there is a backup of previously cached data, they are transferred to the cache.  Additionally, it checks and creates (if necessary) sub cache directories responsible for different data.  The required access rights are set.  A database structure is generated for use in subsequent verification of table and field names.  Check and create a log folder, its contents and installation rights.  Preparation of collective files for JS and CSS files.  Run php-fpm and lighttpd. <br></li><li>  <b>halt.sh</b> exits lighttpd and php-fpm.  It backs up all cached data and disables the cache. <br></li></ul><br><h2>  Finally </h2><br>  The system is free and open to all.  Moreover, it is distributed with open source, so that anyone can personally audit the code or, if necessary, install this system on their personal home or corporate server.  Full source codes are in the public mercurial <a href="https://bitbucket.org/DarkPark/fortnotes" title="FortNotes mercurial public repository">repository</a> , and detailed installation instructions are available on the <a href="http://fortnotes.com/forum/viewtopic.php%3Fid%3D3" title="FortNotes FluxBB Forum">wiki</a> . <br>  Plans: add data import / export, detailed auditing, session management, settings and multilingualism. <br>  Site address - <a href="http://fortnotes.com/" title="Securely online password management software based on the AES encryption. Fort Knox for your notes.">http://fortnotes.com/</a> <br>  Or secure encrypted connection - <a href="https://fortnotes.com/" title="Securely online password management software based on the AES encryption. Fort Knox for your notes.">https://fortnotes.com/</a> <br>  Project on <a href="https://www.ohloh.net/p/fortnotes">ohloh.net</a> . <br>  Constructive comments and suggestions are welcome. <br>  Pleasant and safe work :) <br><br>  <b>Update</b> (2013.02.10): <br>  Cleared code and documentation, editing minor bugs. <br>  Added the ability to run using the Apache web server. <br>  Added support for embedded PHP web server.  This removes the mandatory dependency on Apache or Lighttpd. <br>  Added support for sqlite databases.  This allows you to quickly install the system without any external databases (such as Mysql). <br>  Representative offices were created in various social networks: <a href="https://plus.google.com/communities/103135805865798128116">Google+</a> , <a href="http://www.facebook.com/fortnotes">Facebook</a> , <a href="http://vk.com/fortnotes">VKontakte</a> . <br><br>  <b>Update</b> (2013.03.30): <br>  Another piece of minor revisions, optimizations, and updates to the source code documentation. <br>  Activation and support of the SJCL entropy generation mechanism to improve the quality and reliability of random passwords generated. <br>  Long-awaited backup recovery implementation.  The user and password in the backup must match the login and password of the account where the recovery is performed.  All old data will be deleted, and the data from the backup file will be imported. <br>  When exporting, a more convenient name is offered, the opportunity to completely log out in the password request window has appeared. <br>  A detailed step- <a href="https://bitbucket.org/DarkPark/fortnotes/wiki/Home">by</a> -step <a href="https://bitbucket.org/DarkPark/fortnotes/wiki/Home">installation guide for the</a> project has been added (windows system, Sqlite database, php built-in web server) and a detailed <a href="https://bitbucket.org/DarkPark/fortnotes/wiki/Architecture">description of the architecture</a> in English. <br><br>  <b>Update</b> (2013.11.13): <br>  There is a complete rework system.  Emphasis on scalability, multi-platform support, ease of installation and operation.  All are welcome. <br><br>  <b>Update</b> (2018.06.05): <br>  Docker test images of the current version are released with minor cosmetic changes and serious internal processing. <br>  Details - <a href="https://github.com/fortnotes/legacy/tree/master/docker">github.com/fortnotes/legacy/tree/master/docker</a> </div><p>Source: <a href="https://habr.com/ru/post/142710/">https://habr.com/ru/post/142710/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142705/index.html">Certification by Yandex.Direct. Want to become an expert?</a></li>
<li><a href="../142706/index.html">ebay What did your neighbor buy?</a></li>
<li><a href="../142707/index.html">OpenStreetMap: reviewing licensing agreements and Russian legislation</a></li>
<li><a href="../142708/index.html">User Authorization Management System on thousands of servers</a></li>
<li><a href="../142709/index.html">According to the results of the forum DEPO Computers "Formula DEPO: the race of IT leaders"</a></li>
<li><a href="../142712/index.html">Facebook buys part of AOL patents for $ 550 million from Microsoft</a></li>
<li><a href="../142713/index.html">Cloud Contest 2 Report</a></li>
<li><a href="../142714/index.html">Experience of using teaser networks to advertise their software</a></li>
<li><a href="../142715/index.html">Bug in htb.init v0.8.5, associated with the switching speed in time</a></li>
<li><a href="../142717/index.html">Useful stuff in the work of a web developer or "How could I live without it"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>