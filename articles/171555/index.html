<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Windows Azure VMs: Data Disk, Virtual Networks, and Availability Set</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings, Habrovchane! 
 One of the services that Windows Azure provides is virtual infrastructure and virtual machines. In the article I would like ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Windows Azure VMs: Data Disk, Virtual Networks, and Availability Set</h1><div class="post__text post__text-html js-mediator-article">  Greetings, Habrovchane! <br>  One of the services that Windows Azure provides is virtual infrastructure and virtual machines.  In the article I would like to talk about three simple things that can be useful in the beginning of the way of acquaintance with the platform.  All these things are not secret and are described in the documentation, but who reads it :) <br><img src="https://habrastorage.org/storage2/5ca/4ab/d01/5ca4abd010b3822ce1cc70140c332b07.png"><br><a name="habracut"></a><br><br><h4>  Data storage on OS Disk, Data Disk or temp disk or what to choose? </h4><br>  There are several types of disks in virtual machines in Windows Azure: <b>OS Disk</b> , <b>Data Disk,</b> and <b>temporary disks</b> .  Everything is written in great detail <a href="http://blogs.msdn.com/b/windowsazurestorage/archive/2012/06/28/exploring-windows-azure-drives-disks-and-images.aspx">here</a> . <br><br>  When a virtual machine is created, an OS Disk is automatically created for it, on which the OS is installed (Windows, Ubuntu, CentOS, etc.).  If you go to the virtual machine via RDP, you can see the following picture: C: \ is the OS Disk, D: \ is a temporary disk (Temporary Storage)!  What does a temporary disk mean?  If the machine reboots or is transferred to another server (for example, if something is wrong with the current server), then the data on the temporary disk will not be saved, because  The temporary disk is the physical disk of the server where your virtual machine is raised.  The temporary disk is intended for temporary storage of files. <br><img src="https://habrastorage.org/storage2/eab/9ea/a24/eab9eaa24157d122bfedda20bb0174a6.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Therefore, for long-term storage of files, you must connect and use Data Disk.  If you connect the Data Disk (and initialize it), then it will look like in the figure below.  F: \ drive is a connected Data Disk, i.e.  the data on it will survive all-all-all and are persistent. <br><img src="https://habrastorage.org/storage2/871/162/b5b/871162b5bb4b56855307d36a05c0e181.png"><br><br>  For non-Windows machines, i.e.  Linux, the situation is similar. <br><img src="https://habrastorage.org/storage2/6fc/72a/84e/6fc72a84ea8cf65af8fbf3450d56dd26.png"><br><br>  And in the Windows Azure panel, it will look like this: <br><img src="https://habrastorage.org/storage2/60e/466/f8a/60e466f8ad0d5f72d80b4d362a01372e.png"><br><br>  <b>What follows from this</b> : <br><ol><li>  Store everything that should be kept safe on connected Data Disks. </li><li>  On OS Disk, store the OS and other settings, but not the data, since  although OS Disk also saves all changes, but OS Disk is optimized for fast loading, and Data Disk for random IO. </li><li>  Data that is not terrible to lose can be stored on a temp disk, which will increase the speed of access to them.  For example, if you enable caching for Data Disk, then the cache will be stored in memory and on the temp disk.  Alternatively, a temp disk is recommended for tempdb SQL Server databases. </li></ol><br><h4>  Virtual networks </h4><br>  A virtual network allows you to combine virtual machines into an isolated network (oh, how, who would have thought).  And what does this give?  This allows virtual machines to communicate directly with each other via internal ip, i.e.  Do not drive traffic through Load Balancer in Windows Azure. <br>  It is also recommended to configure interaction between IaaS and PaaS through virtual networks, this will allow traffic to be allowed directly, not via VIP, and also not open ‚Äúextra‚Äù ports to the outside in virtual machines. <br><br>  By the way, I note that ip addresses for all virtual machines (i.e., <b>internal ip</b> - internal ip) included in the virtual network are distributed dynamically (from the address pool specified when creating the virtual network).  Therefore, you should not enter a virtual machine and register a static address (this will lead to a network error, and traffic, including RDP, will not reach your machine). <br><br>  <b>What follows from this</b> : <br><ol><li>  All virtual machines and services that are part of the same system are included in the <b>virtual network</b> (Virtual Network). </li><li>  We use dynamic ip addresses, we do not register our own ip addresses in the settings of the network adapter. </li></ol><br><img src="https://habrastorage.org/storage2/545/194/dc6/545194dc6e1562efc5087839e9bb654b.png"><br>  By the way, here is the topic of <b>public</b> ip addresses. <a href="http://habrahabr.ru/post/165207/">The lifetime of static IP addresses in Windows Azure</a> . <br><br><h4>  Availability Set and Failover </h4><br>  In order to guarantee or increase the resiliency of your system deployed on virtual machines, you need to raise several virtual machines and include them in balancing (if required) and <b>Availability Set</b> . <br><br>  With balancing everything is clear, it is very easy to turn it on - <a href="http://www.windowsazure.com/en-us/manage/windows/common-tasks/how-to-load-balance-virtual-machines/%3Ffb%3Dru-ru">Load Balancing Virtual Machines</a> .  Balancing is carried out according to the round-robin scheme.  With Availability Set is also not difficult.  Availability Set simply tells Windows Azure that the virtual machines included in this set should reside on different physical servers (i.e. if something happens, the probability of two or more virtual machines failing at the same time is greatly reduced) and the update for these (their root OS) should be performed in turn ( <a href="http://www.windowsazure.com/en-us/manage/windows/common-tasks/manage-vm-availability/">Manage the Availability of Virtual Machines</a> ), i.e.  in fact, virtual machines will be spaced apart in different racks. <br><img src="https://habrastorage.org/storage2/25e/173/f86/25e173f86a1d2a2cf710a3d435ce298c.png"><br><br>  <b>What follows from this</b> : <br><ol><li>  If we make a fault-tolerant solution (farm, cluster), then we add the machines to the balancing and always in the Availability Set. <br></li></ol><br><br>  I hope that someone these simple tips will be useful. </div><p>Source: <a href="https://habr.com/ru/post/171555/">https://habr.com/ru/post/171555/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../171543/index.html">About JSDB Benefits</a></li>
<li><a href="../171545/index.html">Software Requirements: Collection and Documentation Guidelines</a></li>
<li><a href="../171547/index.html">All in 1: Fujitsu ESPRIMO X913-T Monoblock</a></li>
<li><a href="../171549/index.html">SSRF DoS Relaying</a></li>
<li><a href="../171551/index.html">Hackathon for mobile developers in Moscow</a></li>
<li><a href="../171557/index.html">Using XSLT to Prevent XSS by Filtering Custom Content</a></li>
<li><a href="../171559/index.html">Design Pattern "Specification"</a></li>
<li><a href="../171561/index.html">Frequently asked questions about asm.js</a></li>
<li><a href="../171565/index.html">Google Chrome Extensions: Making Hot Keys</a></li>
<li><a href="../171569/index.html">My Adventures at MWC 2013 or Barcelona, ‚Äã‚ÄãThere and Back</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>