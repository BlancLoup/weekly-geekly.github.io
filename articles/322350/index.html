<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Personal experience: TeamCity and character server integration</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue to talk about how to implement practices and approaches DevOps. For example, they recently wrote about creating their own tool for conduct...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Personal experience: TeamCity and character server integration</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/pt/blog/322350/"><img src="https://habrastorage.org/files/cfd/3db/dbd/cfd3dbdbd1e5444a900bcdcfabd72320.png"></a> <br><br>  We continue to talk about how to implement practices and approaches DevOps.  For example, they recently wrote about creating <a href="https://habrahabr.ru/company/pt/blog/321354/">their own tool</a> for conducting competitive analysis of software products.  Today we will talk about how we integrated the TeamCity system with an external debug symbols server. <a name="habracut"></a><br><br><h2>  Why do you need it </h2><br>  Debug symbols are information that the compiler automatically generates based on source codes.  Such symbols can be included in the binary file, presented as a separate file, or discarded altogether at the compilation stage - this allows reducing the size of the binary file and increasing the complexity of its reverse engineering. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Such symbols solve several problems: <br><br><ul><li>  they contain debug information about the binary file (the names of variables, functions, etc.) </li><li>  with their help it is easier to look for errors in the code; </li><li>  debugging symbols are needed when searching for bugs and parsing dumps. </li></ul><br>  The use of debug symbols is clear, now let's talk about why we did not use the symbol server built into TeamCity and came to a different solution. <br><br><h2>  What is wrong with the TeamCity symbol server </h2><br>  Our decision to use an external character server was dictated by the flaws of the built-in TeamCity solution: <br><br><ul><li>  At the time when we were thinking about how to work with debugging symbols, the built-in solution TeamCity did not know how to interact with binary files - this function appeared later, but we decided to use an external server. </li><li>  Also, there was no debugged character storage mechanism. </li><li>  In the configuration we had at that time, there was not a large amount of disk resources on the character server; we simply did not have enough space. </li><li>  Our company is engaged in the development of multi-component products, and it was difficult to store symbols with version binding components for them. </li></ul><br><h2>  Decision </h2><br>  Here is how we solve the problems described now: <br><br><ul><li>  use a virtual server with OS Windows Server; </li><li>  The main working tool is included in the Windows SDK Symstore.exe, which is used to lay out characters on the server; </li><li>  We also wrote a separate metaranner for TeamCity. </li></ul><br>  We have implemented a so-called ‚Äúrelease scheme with assembly promotions‚Äù in which the tested artifacts of assemblies of individual components are moved from the garbage .snapshot repository to the release version - from there they are later taken to build release installers of products.  We lay out the symbols of release and feature assemblies on different shared-servers.  Therefore it is necessary to be able to distinguish release assemblies.  When we build a regular build, the binary files go to the artifactories, like the debug symbols.  When you start the promotion of the assembly of a separate component through a special configuration ‚Äî the promoter, the developed metainner loads symbols into the release folder on the symbol server. <br><br><img src="https://habrastorage.org/files/b1f/4d7/a60/b1f4d7a6055c4e6b88f467de052f47ac.jpg"><br><br>  In more detail, this process looks like this: when an assembly occurs, we look at whether it has the status of promote.  If we are dealing with such an assembly, the characters are placed in the release shared folder on the server.  If this is a common feature, the characters are placed in the artifactories and in the common ‚Äúdevelopment‚Äù folder on the character server. <br><br><img src="https://habrastorage.org/files/a6f/8d9/db6/a6f8d9db69464415bb5adc89ba4a2f9e.jpg"><br><br><h2>  What is the result </h2><br>  As a result, two directories are now located on our symbol server: <br><br><ul><li>  Release Symbols - there are symbols of release assemblies in it that need to be stored for a long time; </li><li>  Symbols - for symbols of developer assemblies. </li></ul><br>  We managed to solve the problem with a lack of disk space - a directory with developer characters is cleared by a script that is launched by the scheduler.  It deletes all files older than N days from a certain directory of the tree of characters, as well as files that meet a certain condition ‚Äî for example, all assemblies of the same version, except the latest one. <br><br>  Our TeamCity metaranner is able to work with all binary files and is integrated into the process of building multi-component products. <br><br>  <b>PS</b> The story about our experience with TeamCity and the character server was presented in the framework of DevOps-mitap, which took place in the fall of 2016 in Moscow. <br><br>  Video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OwidXkpRWfY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Slides <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  The <a href="http://www.slideshare.net/phdays">link</a> presents presentations of 16 reports presented during the event.  All presentations and video presentations are added to the table at the end of this <a href="https://habrahabr.ru/company/pt/blog/310584/">topic-announcement</a> . <br><br>  <b>Author</b> : <a href="https://www.linkedin.com/in/alexey-solovyev">Alexey Soloviev</a> </div><p>Source: <a href="https://habr.com/ru/post/322350/">https://habr.com/ru/post/322350/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322336/index.html">Hi, SaaS | Russian SaaS 2016 - results</a></li>
<li><a href="../322340/index.html">Determine the best place to live in the United States with your own application on IBM Bluemix</a></li>
<li><a href="../322344/index.html">Salyut-EL24D1: debug board on the Russian processor 1892BM14Ya for harsh operating conditions</a></li>
<li><a href="../322346/index.html">Heuristic network - analogue of the recurrent neural network for chat bot program</a></li>
<li><a href="../322348/index.html">Escape analysis and scalarization: let GC rest</a></li>
<li><a href="../322352/index.html">As I made the fastest resize of images. Part 1, general optimizations</a></li>
<li><a href="../322354/index.html">Manage application state with Vuex</a></li>
<li><a href="../322360/index.html">Interesting features of Python, which you could not guess</a></li>
<li><a href="../322362/index.html">Red Hat acquires 3scale, which develops API management systems, and intends to open source code of products</a></li>
<li><a href="../322364/index.html">RTM Cybergroup specializes in stealing funds from Russian companies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>