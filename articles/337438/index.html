<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúAs per the notes!‚Äù Or Machine Learning (Data science) in C # using Accord.NET Framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yesterday after the publication of the article zarytskiy ‚Äú What programming language should I choose to work with data? ‚ÄúI realized that .net in gener...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúAs per the notes!‚Äù Or Machine Learning (Data science) in C # using Accord.NET Framework</h1><div class="post__text post__text-html js-mediator-article">  Yesterday after the publication of the article <a href="https://habrahabr.ru/users/zarytskiy/" class="user_link">zarytskiy</a> ‚Äú <a href="https://habrahabr.ru/post/337330/">What programming language should I choose to work with data?</a>  ‚ÄúI realized that .net in general and C # in particular is not considered as a tool for machine learning and data analysis.  It‚Äôs not that there are no objective reasons for this, but you still need to restore justice and spend a couple of minutes on the story about the <b>Accord.NET</b> framework <b>.</b> <br><br>  So, in the <a href="https://habrahabr.ru/post/337040/">last article of the</a> cycle on teaching Data Science from scratch, we analyzed the issue of creating our own data set and teaching models from the scikit-learn (Python) library on the example of classifying the emission spectra of lamps and daylight. <br><br>  This time, so that the data set does not disappear, we will consider and compare our last article a small piece of the machine learning task, but this time implemented in C # <br>  You are welcome all under the cat. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/web/74a/34a/212/74a34a2127af4f5cb938d355db47a642.png"><br><a name="habracut"></a><br>  First we need to note that machine learning, Python and C #, I know equally badly, well, that is, almost nothing, so this article is unlikely to present the reader with some kind of virtuoso code or especially valuable information.  In other matters, we do not set such a goal, right? <br><br>  Fragments of code and data, as before you can take on <a href="https://github.com/bosonbeard/ML_light_sources_classification/tree/master/1st_spectrum_classification">GitHub</a> <br><br><h3>  Part 1. Prelude </h3><br>  In brief, let me remind you of what was discussed in the <a href="https://habrahabr.ru/post/337040/">last article</a> : <br><br>  Using the open-source project <a href="https://spectralworkbench.org/">Spectralworkbench</a> (Public Lab), I assembled for you a small collection of daylight spectra, fluorescent lamps and LED lamps of supposedly different shades of white light and with different color quality.  The kit contained 30 training samples of each class and 11 control, respectively. <br><br>  Further, after my long speeches, we finally started directly machine learning and eventually taught: the RandomForestClassifier and LogisticRegression classifiers, including the selection of parameters, were also pampered with the display of signs in a two-dimensional form using T-SNE and PCA, in the end we tried to do the clustering data using DBSCAN, well, my epic battle with a computer, which I unfortunately lost with the result of a couple of% prediction accuracy, completed the article. <br><br><h3>  Part 2. Aria </h3><br>  So, a quick search on the Internet says that <a href="http://accord-framework.net/">Accord.NET is</a> one of the most popular in the .Net ecosystem, apparently due to the fact that it is primarily designed for C #, although there are others, for example, <a href="https://github.com/predictionmachines/Angara">Angara</a> (for F #).  Of course, the platform allows you to run frameworks in all .Net languages ‚Äã‚Äã(well, or just the vast majority of languages). <br><br>  The first thing that catches your eye is, nevertheless, an order of magnitude smaller popularity of the framework as compared to solutions in Python or R, as a result, you will have to rely on examples and documentation, documentation, for a beginner it could be more chewed, and examples are mostly found in as already collected projects that would be good to open in Visual Studio.  After a whole sea of ‚Äã‚Äãinformation on machine learning with Python, this is a bit repulsive, which is probably why in this case I limited myself to only the classification (SVM) and the display of features using PCA. <br><br>  So, we need MS Visual Studio (I had 2015) or MonoDevelop (for example, for Linux). <br><br>  In principle, you can use the instructions for a <a href="https://github.com/accord-net/framework/wiki/Getting-started">quick start</a> , but you can take my word for it.  I will give an example for Visual Studio: <br><br><ol><li>  Create a new console application. </li><li>  Add a link to the assembly System.Windows.Forms.dll, it is useful to us for displaying graphs. </li><li>  Add NuGet packages: Accord, Accord.Controls, Accord.IO, Accord.MachineLearning, Accord.Statistics (some of them will be added by themselves when one pulls the others) </li><li>  Getting started "cod" </li></ol><br>  Open Program.cs and add namespaces: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Accord.Statistics.Models.Regression.Linear; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Accord.Statistics.Analysis; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Accord.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Accord.Math; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Data; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Accord.MachineLearning.VectorMachines.Learning; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Accord.Math.Optimization.Losses; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Accord.Statistics.Kernels; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Accord.Controls;</code> </pre> <br>  Next, for simplicity, we stuff everything into the base class. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> {</code> </pre><br>  So: <br><br>  We read the data, unfortunately we do not have a convenient library, we do not have Pandas, but there are analogues (though less convenient in my opinion). <br><br>  One of the drawbacks, this is again not obvious, I gathered a couple of ‚Äúbicycles‚Äù before I realized that Accord offers its solution for handling csv or xsls if desired. <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//This is a program for demonstrating machine //learning and classifying the spectrum of light sources using .net //read data (If you use linux do not forget to correct the path to the files) string trainCsvFilePath = @"data\train.csv"; string testCsvFilePath = @"data\test.csv"; DataTable trainTable = new CsvReader(trainCsvFilePath, true).ToTable(); DataTable testTable = new CsvReader(testCsvFilePath, true).ToTable(); // Convert the DataTable to input and output vectors (train and test) int[] trainOutputs = trainTable.Columns["label"].ToArray&lt;int&gt;(); trainTable.Columns.Remove("label"); double[][] trainInputs = trainTable.ToJagged&lt;double&gt;(); int[] testOutputs = testTable.Columns["label"].ToArray&lt;int&gt;(); testTable.Columns.Remove("label"); double[][] testInputs = testTable.ToJagged&lt;double&gt;();</span></span></code> </pre><br>  Actually, we train the model of the classifier, if the scikit-learn terminology has already been absorbed into your soul, then it will not be customary at first.  But in principle, everything should be clear in the teacher we push the class of the model, then we train it on the data, then we cause the prediction of the tags (recall: 0 - LED, 1 - lamp, - 2 daylight) <br><br><pre> <code class="cs hljs"> <span class="hljs-comment"><span class="hljs-comment">// training model SVM classifier var teacher = new MulticlassSupportVectorLearning&lt;Gaussian&gt;() { // Configure the learning algorithm to use SMO to train the // underlying SVMs in each of the binary class subproblems. Learner = (param) =&gt; new SequentialMinimalOptimization&lt;Gaussian&gt;() { // Estimate a suitable guess for the Gaussian kernel's parameters. // This estimate can serve as a starting point for a grid search. UseKernelEstimation = true } }; // Learn a machine var machine = teacher.Learn(trainInputs, trainOutputs); // Obtain class predictions for each sample int[] predicted = machine.Decide(testInputs);</span></span></code> </pre><br>  Then we print the data (the result will be, a little later in the picture) <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// print result int i = 0; Console.WriteLine("results - (predict ,real labels)"); foreach (int pred in predicted) { Console.Write("({0},{1} )", pred, testOutputs[i]); i++; } //calculate the accuracy double error = new ZeroOneLoss(testOutputs).Loss(predicted); Console.WriteLine("\n accuracy: {0}", 1 - error);</span></span></code> </pre><br>  Well, the final chord - transform the data using PCA and derive the scatter diagram <br><br><pre> <code class="cs hljs"> <span class="hljs-comment"><span class="hljs-comment">// consider the decrease in the dimension of features using PCA var pca = new PrincipalComponentAnalysis() { Method = PrincipalComponentMethod.Center, Whiten = true }; pca.NumberOfOutputs = 2; MultivariateLinearRegression transform = pca.Learn(trainInputs); double[][] outputPCA = pca.Transform(trainInputs); // print it on the scatter plot ScatterplotBox.Show(outputPCA, trainOutputs).Hold(); Console.ReadLine();</span></span></code> </pre><br>  Well, what happened in the end: <br><br><img src="https://habrastorage.org/web/ab4/20a/0c4/ab420a0c45a443d082b526d0870393a0.png"><br><br>  Let's compare with what we learned in the last article for <br>  Logistic regression with matched parameters <br>  (prediction, fact): <br>  [(0, 0), (0, 0), (0, 0), (2, 0), (0, 0), (0, 0), (0, 0), (0, 0), ( 0, 0), (0, 0), (2, 0), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 1), (1, 1), (1, 1), (1, 1), (1, 1), (2, 1), (2, 2), (2, 2), (2, 2) , (0, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2), (2, 2)] <br>  accuracy on test data: 0.81818 <br><br>  As you can see the result is comparable. <br><br>  Let's look at the PCA chart. <br><img src="https://habrastorage.org/web/146/609/8bc/1466098bc2ec4f99933c919f7a6d8886.png" alt="image"><br><br>  Well, in principle, it seems, but a little different, the developers on their website say that ‚Äúeverything is all right and it should be, all the same, most likely it‚Äôs all right, just these are the features of the algorithms‚Äù (well, close to the text). <br><br>  UPD: Thank you <a href="https://habrahabr.ru/users/airlight/" class="user_link">AirLight</a> <br>  As it turned out, the graphs, if they are correctly put on and completely coincide at all, I think the rest is just the specifics of the operation and implementation of the algorithm, but the whole thing can be scaled, I‚Äôll not take it for granted <br><img src="https://habrastorage.org/web/31a/7e3/ae9/31a7e3ae9ec9479b9659af1c7264d350.png" alt="image"><br><br><h3>  Part 3. Final. </h3><br>  Let's summarize.  It is clear that I have little experience to judge objectively, so I will be subjective. <br><br>  1. At first, after Python, returning to .Net and this framework ‚Äúfrozen‚Äù terribly.  You quickly get used to dynamic typing and convenient data manipulations.  Also, other models were annoyed by the fact that there was a hell of a lot of them and a class was implemented for everything (well, what is the C # paradigm to do) <br><br>  2. I didn‚Äôt want to download projects as a whole, and the examples for the description of the ‚Äúscanty‚Äù classes as a result of the analysis even of what I posted to you here, took more time than I would like, I didn‚Äôt understand the multi-class classification, In scikit-learn, it is somehow much better out of the box. <br><br>  3. On the other hand, the model showed the same accuracy and didn‚Äôt even have to go through the parameters, I think the random forest would also have converged if I had not been too lazy to deal with its implementations. <br><br>  4. Where to apply it?  Well, apparently, firstly, in applications based on Windows Forms - a technology that is certainly honorable and respectable, but has long been outdated and MS is not developed, on the other hand, I have not tried, but it is possible that the Accord will be hooked to universal applications Windows and then with its help it will be possible to solve problems of machine learning and data analysis in small devices running Windows IoT. <br><br>  5. If anyone is interested in cross-platform, then yes - it is!  Do not be lazy, I put myself on the second system (Mint) MonoDevelop and checked, the project is being built and launched, and therefore it should also go under MacOS. <br><br>  Considering the large number of C # fans and their optimistic comments on the project site, I think this framework, as well as in general, the use of C # in the field of data science has a right to life, albeit some slightly marginal. <br><br>  Well, that's it, all the promises I made in the article <a href="https://habrahabr.ru/post/335214/">‚ÄúA train that could!‚Äù Or ‚ÄúSpecialization Machine learning and data analysis‚Äù</a> are fulfilled by the <a href="https://habrahabr.ru/post/335214/">eyes of a newbie in Data Science</a> , so I can retire for a while with a clear conscience. <br><br>  All success and good weekend! </div><p>Source: <a href="https://habr.com/ru/post/337438/">https://habr.com/ru/post/337438/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337424/index.html">VK by design</a></li>
<li><a href="../337426/index.html">We go to the Internet outside the Russian Federation: (MikroTik <-> Ubuntu) * GRE / IPsec</a></li>
<li><a href="../337428/index.html">"Siege affairs": How companies build a solid fortress to protect the clouds</a></li>
<li><a href="../337430/index.html">Multitasking Arduin: pain-free timers</a></li>
<li><a href="../337436/index.html">Bitcoin farm and android miner app</a></li>
<li><a href="../337440/index.html">Boat in the anthill</a></li>
<li><a href="../337442/index.html">Cybersecurity: Flipping through Cisco's annual report</a></li>
<li><a href="../337446/index.html">Data masking as a tool to minimize labor costs at the stage of putting new information systems into operation</a></li>
<li><a href="../337448/index.html">Statistics on basic operating systems in images on the Docker Hub</a></li>
<li><a href="../337450/index.html">CSS immersion: font metrics, line-height and vertical-align</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>