<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Script for working with virtual hosts apache2 on locale</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="0. Intro 
 What is it all for? Goals were 2: 


1. get rid of the routine of picking in the console and files 
2. get exp in shell script development....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Script for working with virtual hosts apache2 on locale</h1><div class="post__text post__text-html js-mediator-article"><h4>  0. Intro </h4><br>  What is it all for?  Goals were 2: <br><ol><li>  get rid of the routine of picking in the console and files </li><li>  get exp in shell script development. </li></ol><br><h4>  1. What is it? </h4><br>  Below will be presented the script for working with virtual hosts of Apache under the <b>cubunta</b> for the <b>local machine only</b> .  For the server hardly fit.  Not for these purposes was written. <br><a name="habracut"></a><br><h6>  So what is it? </h6><br>  The script allows you to create, delete, activate and deactivate hosts on the machine, while saving our time.  That is, you do not need to prescribe something, poking around in configs, throwing symlinks and other restarting of the server just for this purpose.  Only one team in the console can reduce the time at times.  Go!  ) <br><br><h4>  2. Short help </h4><br>  The script takes the trail.  arguments: <br>  vhost (add | del | enable | disable) vhostname <br><br>  Accordingly, by command (aliases in brackets): <br>  - add (create) - create a host, create a basic file structure and activate it *. <br>  - del (delete, rm) - delete only the host with configs. <br>  - delall - delete host and configs, and delete all files for this site ** <br>  - enable (on) ‚Äîadd a host to apache.  (just throw links to sites-enabled). <br>  - disable (off) - disable host (configs remain) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Example: <br>  sudo vhost add test.lan <br>  sudo vhost rm test.lan <br><br>  Root is needed in order to be recorded in / etc / hosts and restarting Apache. <br><br>  * The folder structure is what I use.  There are variables at the top of the script that determine where your sites are stored. <br><br>  ** Only if the overall structure is maintained. <br>  For example: the host is called test.lan, and the files are in /home/user/www/test.lan.  In this case this folder with contents will be deleted. <br><br><h4>  3. The source of the world. </h4><br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#!/bin/bash <br> projects= <font color="#A31515">"/home/alex/web/www"</font> ; <br> hosts= <font color="#A31515">"/home/alex/web/hosts"</font> ; <br> enabled_hosts= <font color="#A31515">'/etc/apache2/sites-enabled'</font> ; <br> user=$(whoami); <br> action=$1; <br> name=$2 <br> db=$3; <br> <br> add_folders() { <br> mkdir -p <font color="#A31515">"$projects/$name/www"</font> ; <br> mkdir -p <font color="#A31515">"$projects/$name/logs"</font> <br> mkdir -p <font color="#A31515">"$projects/$name/tmp"</font> <br> chown -R $user\: <font color="#A31515">"$projects/$name/"</font> <br> chmod -R 777 <font color="#A31515">"$projects/$name"</font> ; <br> } <br> <br> add_host() { <br> echo <font color="#A31515">" <br> &lt;VirtualHost $name:80&gt; <br> ServerAdmin webmaster@localhost <br> ServerName $name <br> ServerAlias www.$name <br> DocumentRoot $projects/$name/www <br> ErrorLog $projects/$name/logs/error.log <br> CustomLog $projects/$name/logs/access.log combined <br> DirectoryIndex index.php index.htm index.html <br> LogLevel debug <br> &lt;/VirtualHost&gt;"</font> &gt; $hosts/$name <br> <br> ln -s $hosts/$name $enabled_hosts/$name <br> <br> echo <font color="#A31515">"127.0.0.1        $name"</font> &gt;&gt; /etc/hosts <br> } <br> <br> add_index_file() { <br> echo <font color="#A31515">"&lt;html&gt; <br> &lt;body&gt; <br> &lt;h1&gt;$name works!&lt;/h1&gt; <br> &lt;/body&gt; <br> &lt;/html&gt;"</font> &gt; $projects/$name/www/index.htm <br> } <br> <br> create_host() { <br> <font color="#0000ff">if</font> [ -z $name ]; then <br> echo <font color="#A31515">'No name for vhost given.'</font> ; <br> exit 1; <br> fi <br> <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> echo <font color="#A31515">'Virtual host already exists.'</font> ; <br> exit 0; <br> fi <br> <br> echo <font color="#A31515">'All is ok, fast forward --&gt;'</font> ; <br> add_folders; <br> echo <font color="#A31515">'* Folders created'</font> ; <br> add_host; <br> echo <font color="#A31515">'* Host created'</font> ; <br> add_index_file; <br> <br> reload_apache; <br> } <br> <br> delete_host() { <br> <font color="#0000ff">if</font> [ -z $name ]; then <br> echo <font color="#A31515">'No name for vhost given. Exit.'</font> ; <br> exit 1; <br> fi <br> <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> echo <font color="#A31515">"Remove vhost $name? (y/n)"</font> ; <br> read confirm; <br> <br> <font color="#0000ff">if</font> [ $confirm = <font color="#A31515">'y'</font> ]; then <br> echo <font color="#A31515">"* Removing vhost file from $hosts/$name"</font> ; <br> rm $hosts/$name <br> <br> echo <font color="#A31515">"* Removing link from $enabled_hosts/$name"</font> <br> rm $enabled_hosts/$name <br> <br> echo <font color="#A31515">"* Cleaning up /etc/hosts"</font> <br> sed <font color="#A31515">"/$name/d"</font> /etc/hosts &gt; /tmp/tmp-hosts; <br> mv -f /tmp/tmp-hosts /etc/hosts <br> <br> echo <font color="#A31515">"* Vhost $name removed"</font> ; <br> <br> reload_apache; <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">"Skipped."</font> ; <br> fi <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> exit; <br> fi <br> } <br> <br> delete_all() { <br> <font color="#0000ff">if</font> [ -z $name ]; then <br> echo <font color="#A31515">'No name for vhost given. Exit.'</font> ; <br> exit 1; <br> fi <br> <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> echo <font color="#A31515">"Remove vhost $name?"</font> ; <br> echo <font color="#A31515">"This action will remove all files and directories from this project (y/n)"</font> ; <br> read confirm; <br> <br> <font color="#0000ff">if</font> [ $confirm = <font color="#A31515">'y'</font> ]; then <br> echo <font color="#A31515">"* Removing files and directories from $projects/$name"</font> ; <br> rm -rf $projects/$name <br> <br> echo <font color="#A31515">"* Removing vhost file from $hosts/$name"</font> ; <br> rm $hosts/$name <br> <br> echo <font color="#A31515">"* Removing link from $enabled_hosts/$name"</font> <br> rm $enabled_hosts/$name <br> <br> echo <font color="#A31515">"* Cleaning up /etc/hosts"</font> <br> sed <font color="#A31515">"/$name/d"</font> /etc/hosts &gt; /tmp/tmp-hosts; <br> mv -f /tmp/tmp-hosts /etc/hosts <br> <br> echo <font color="#A31515">"* Done. The matrix has project $name"</font> ; <br> <br> reload_apache; <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">"Skipped."</font> ; <br> fi <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> exit; <br> fi <br> } <br> <br> enable_host() { <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> ln -s $hosts/$name $enabled_hosts/$name <br> echo <font color="#A31515">"127.0.0.1        $name"</font> &gt;&gt; /etc/hosts <br> <br> reload_apache; <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> fi <br> } <br> <br> disable_host() { <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$enabled_hosts/$name"</font> ]; then <br> echo <font color="#A31515">'* Removing symlink for current host...'</font> ; <br> rm /etc/apache2/sites-enabled/$name <br> echo <font color="#A31515">'* Updating /etc/hosts'</font> ; <br> sed <font color="#A31515">"/$name/d"</font> /etc/hosts &gt; /tmp/tmp-hosts; <br> mv -f /tmp/tmp-hosts /etc/hosts <br> <br> reload_apache; <br> echo <font color="#A31515">'* Done'</font> <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> fi <br> } <br> <br> show_help() { <br> echo <font color="#A31515">'Available actions: <br> create - creates a new project. Includes folder structure and database (optional). <br> delete - delete all project files and drops database (optional). Asks for confirmation. <br> enable - enables selected virtual host. <br> disable - disables selected virtual host <br> help - shows this message.'</font> ; <br> } <br> <br> reload_apache() { <br> service apache2 reload <br> } <br> <br> <font color="#0000ff">if</font> [ $(whoami) != <font color="#A31515">"root"</font> ]; then <br> echo <font color="#A31515">'You must be root.'</font> <br> exit 1; <br> fi <br> <br> <font color="#0000ff">case</font> $action <font color="#0000ff">in</font> <br> create) <br> create_host; <br> ;; <br> add) <br> create_host; <br> ;; <br> rm) <br> delete_host; <br> ;; <br> del) <br> delete_host; <br> ;; <br> delete) <br> delete_host; <br> ;; <br> delall) <br> delete_all; <br> ;; <br> on) <br> enable_host; <br> ;; <br> enable) <br> enable_host; <br> ;; <br> off) <br> disable_host; <br> ;; <br> disable) <br> disable_host; <br> ;; <br> help) <br> show_help; <br> ;; <br> *) <br> echo <font color="#A31515">"Usage: `basename $0` (create|delete|enable|disable) vhostname"</font> ; <br> exit 0; <br> ;; <br> esac <br></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#!/bin/bash <br> projects= <font color="#A31515">"/home/alex/web/www"</font> ; <br> hosts= <font color="#A31515">"/home/alex/web/hosts"</font> ; <br> enabled_hosts= <font color="#A31515">'/etc/apache2/sites-enabled'</font> ; <br> user=$(whoami); <br> action=$1; <br> name=$2 <br> db=$3; <br> <br> add_folders() { <br> mkdir -p <font color="#A31515">"$projects/$name/www"</font> ; <br> mkdir -p <font color="#A31515">"$projects/$name/logs"</font> <br> mkdir -p <font color="#A31515">"$projects/$name/tmp"</font> <br> chown -R $user\: <font color="#A31515">"$projects/$name/"</font> <br> chmod -R 777 <font color="#A31515">"$projects/$name"</font> ; <br> } <br> <br> add_host() { <br> echo <font color="#A31515">" <br> &lt;VirtualHost $name:80&gt; <br> ServerAdmin webmaster@localhost <br> ServerName $name <br> ServerAlias www.$name <br> DocumentRoot $projects/$name/www <br> ErrorLog $projects/$name/logs/error.log <br> CustomLog $projects/$name/logs/access.log combined <br> DirectoryIndex index.php index.htm index.html <br> LogLevel debug <br> &lt;/VirtualHost&gt;"</font> &gt; $hosts/$name <br> <br> ln -s $hosts/$name $enabled_hosts/$name <br> <br> echo <font color="#A31515">"127.0.0.1        $name"</font> &gt;&gt; /etc/hosts <br> } <br> <br> add_index_file() { <br> echo <font color="#A31515">"&lt;html&gt; <br> &lt;body&gt; <br> &lt;h1&gt;$name works!&lt;/h1&gt; <br> &lt;/body&gt; <br> &lt;/html&gt;"</font> &gt; $projects/$name/www/index.htm <br> } <br> <br> create_host() { <br> <font color="#0000ff">if</font> [ -z $name ]; then <br> echo <font color="#A31515">'No name for vhost given.'</font> ; <br> exit 1; <br> fi <br> <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> echo <font color="#A31515">'Virtual host already exists.'</font> ; <br> exit 0; <br> fi <br> <br> echo <font color="#A31515">'All is ok, fast forward --&gt;'</font> ; <br> add_folders; <br> echo <font color="#A31515">'* Folders created'</font> ; <br> add_host; <br> echo <font color="#A31515">'* Host created'</font> ; <br> add_index_file; <br> <br> reload_apache; <br> } <br> <br> delete_host() { <br> <font color="#0000ff">if</font> [ -z $name ]; then <br> echo <font color="#A31515">'No name for vhost given. Exit.'</font> ; <br> exit 1; <br> fi <br> <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> echo <font color="#A31515">"Remove vhost $name? (y/n)"</font> ; <br> read confirm; <br> <br> <font color="#0000ff">if</font> [ $confirm = <font color="#A31515">'y'</font> ]; then <br> echo <font color="#A31515">"* Removing vhost file from $hosts/$name"</font> ; <br> rm $hosts/$name <br> <br> echo <font color="#A31515">"* Removing link from $enabled_hosts/$name"</font> <br> rm $enabled_hosts/$name <br> <br> echo <font color="#A31515">"* Cleaning up /etc/hosts"</font> <br> sed <font color="#A31515">"/$name/d"</font> /etc/hosts &gt; /tmp/tmp-hosts; <br> mv -f /tmp/tmp-hosts /etc/hosts <br> <br> echo <font color="#A31515">"* Vhost $name removed"</font> ; <br> <br> reload_apache; <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">"Skipped."</font> ; <br> fi <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> exit; <br> fi <br> } <br> <br> delete_all() { <br> <font color="#0000ff">if</font> [ -z $name ]; then <br> echo <font color="#A31515">'No name for vhost given. Exit.'</font> ; <br> exit 1; <br> fi <br> <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> echo <font color="#A31515">"Remove vhost $name?"</font> ; <br> echo <font color="#A31515">"This action will remove all files and directories from this project (y/n)"</font> ; <br> read confirm; <br> <br> <font color="#0000ff">if</font> [ $confirm = <font color="#A31515">'y'</font> ]; then <br> echo <font color="#A31515">"* Removing files and directories from $projects/$name"</font> ; <br> rm -rf $projects/$name <br> <br> echo <font color="#A31515">"* Removing vhost file from $hosts/$name"</font> ; <br> rm $hosts/$name <br> <br> echo <font color="#A31515">"* Removing link from $enabled_hosts/$name"</font> <br> rm $enabled_hosts/$name <br> <br> echo <font color="#A31515">"* Cleaning up /etc/hosts"</font> <br> sed <font color="#A31515">"/$name/d"</font> /etc/hosts &gt; /tmp/tmp-hosts; <br> mv -f /tmp/tmp-hosts /etc/hosts <br> <br> echo <font color="#A31515">"* Done. The matrix has project $name"</font> ; <br> <br> reload_apache; <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">"Skipped."</font> ; <br> fi <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> exit; <br> fi <br> } <br> <br> enable_host() { <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> ln -s $hosts/$name $enabled_hosts/$name <br> echo <font color="#A31515">"127.0.0.1        $name"</font> &gt;&gt; /etc/hosts <br> <br> reload_apache; <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> fi <br> } <br> <br> disable_host() { <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$enabled_hosts/$name"</font> ]; then <br> echo <font color="#A31515">'* Removing symlink for current host...'</font> ; <br> rm /etc/apache2/sites-enabled/$name <br> echo <font color="#A31515">'* Updating /etc/hosts'</font> ; <br> sed <font color="#A31515">"/$name/d"</font> /etc/hosts &gt; /tmp/tmp-hosts; <br> mv -f /tmp/tmp-hosts /etc/hosts <br> <br> reload_apache; <br> echo <font color="#A31515">'* Done'</font> <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> fi <br> } <br> <br> show_help() { <br> echo <font color="#A31515">'Available actions: <br> create - creates a new project. Includes folder structure and database (optional). <br> delete - delete all project files and drops database (optional). Asks for confirmation. <br> enable - enables selected virtual host. <br> disable - disables selected virtual host <br> help - shows this message.'</font> ; <br> } <br> <br> reload_apache() { <br> service apache2 reload <br> } <br> <br> <font color="#0000ff">if</font> [ $(whoami) != <font color="#A31515">"root"</font> ]; then <br> echo <font color="#A31515">'You must be root.'</font> <br> exit 1; <br> fi <br> <br> <font color="#0000ff">case</font> $action <font color="#0000ff">in</font> <br> create) <br> create_host; <br> ;; <br> add) <br> create_host; <br> ;; <br> rm) <br> delete_host; <br> ;; <br> del) <br> delete_host; <br> ;; <br> delete) <br> delete_host; <br> ;; <br> delall) <br> delete_all; <br> ;; <br> on) <br> enable_host; <br> ;; <br> enable) <br> enable_host; <br> ;; <br> off) <br> disable_host; <br> ;; <br> disable) <br> disable_host; <br> ;; <br> help) <br> show_help; <br> ;; <br> *) <br> echo <font color="#A31515">"Usage: `basename $0` (create|delete|enable|disable) vhostname"</font> ; <br> exit 0; <br> ;; <br> esac <br></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#!/bin/bash <br> projects= <font color="#A31515">"/home/alex/web/www"</font> ; <br> hosts= <font color="#A31515">"/home/alex/web/hosts"</font> ; <br> enabled_hosts= <font color="#A31515">'/etc/apache2/sites-enabled'</font> ; <br> user=$(whoami); <br> action=$1; <br> name=$2 <br> db=$3; <br> <br> add_folders() { <br> mkdir -p <font color="#A31515">"$projects/$name/www"</font> ; <br> mkdir -p <font color="#A31515">"$projects/$name/logs"</font> <br> mkdir -p <font color="#A31515">"$projects/$name/tmp"</font> <br> chown -R $user\: <font color="#A31515">"$projects/$name/"</font> <br> chmod -R 777 <font color="#A31515">"$projects/$name"</font> ; <br> } <br> <br> add_host() { <br> echo <font color="#A31515">" <br> &lt;VirtualHost $name:80&gt; <br> ServerAdmin webmaster@localhost <br> ServerName $name <br> ServerAlias www.$name <br> DocumentRoot $projects/$name/www <br> ErrorLog $projects/$name/logs/error.log <br> CustomLog $projects/$name/logs/access.log combined <br> DirectoryIndex index.php index.htm index.html <br> LogLevel debug <br> &lt;/VirtualHost&gt;"</font> &gt; $hosts/$name <br> <br> ln -s $hosts/$name $enabled_hosts/$name <br> <br> echo <font color="#A31515">"127.0.0.1        $name"</font> &gt;&gt; /etc/hosts <br> } <br> <br> add_index_file() { <br> echo <font color="#A31515">"&lt;html&gt; <br> &lt;body&gt; <br> &lt;h1&gt;$name works!&lt;/h1&gt; <br> &lt;/body&gt; <br> &lt;/html&gt;"</font> &gt; $projects/$name/www/index.htm <br> } <br> <br> create_host() { <br> <font color="#0000ff">if</font> [ -z $name ]; then <br> echo <font color="#A31515">'No name for vhost given.'</font> ; <br> exit 1; <br> fi <br> <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> echo <font color="#A31515">'Virtual host already exists.'</font> ; <br> exit 0; <br> fi <br> <br> echo <font color="#A31515">'All is ok, fast forward --&gt;'</font> ; <br> add_folders; <br> echo <font color="#A31515">'* Folders created'</font> ; <br> add_host; <br> echo <font color="#A31515">'* Host created'</font> ; <br> add_index_file; <br> <br> reload_apache; <br> } <br> <br> delete_host() { <br> <font color="#0000ff">if</font> [ -z $name ]; then <br> echo <font color="#A31515">'No name for vhost given. Exit.'</font> ; <br> exit 1; <br> fi <br> <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> echo <font color="#A31515">"Remove vhost $name? (y/n)"</font> ; <br> read confirm; <br> <br> <font color="#0000ff">if</font> [ $confirm = <font color="#A31515">'y'</font> ]; then <br> echo <font color="#A31515">"* Removing vhost file from $hosts/$name"</font> ; <br> rm $hosts/$name <br> <br> echo <font color="#A31515">"* Removing link from $enabled_hosts/$name"</font> <br> rm $enabled_hosts/$name <br> <br> echo <font color="#A31515">"* Cleaning up /etc/hosts"</font> <br> sed <font color="#A31515">"/$name/d"</font> /etc/hosts &gt; /tmp/tmp-hosts; <br> mv -f /tmp/tmp-hosts /etc/hosts <br> <br> echo <font color="#A31515">"* Vhost $name removed"</font> ; <br> <br> reload_apache; <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">"Skipped."</font> ; <br> fi <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> exit; <br> fi <br> } <br> <br> delete_all() { <br> <font color="#0000ff">if</font> [ -z $name ]; then <br> echo <font color="#A31515">'No name for vhost given. Exit.'</font> ; <br> exit 1; <br> fi <br> <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> echo <font color="#A31515">"Remove vhost $name?"</font> ; <br> echo <font color="#A31515">"This action will remove all files and directories from this project (y/n)"</font> ; <br> read confirm; <br> <br> <font color="#0000ff">if</font> [ $confirm = <font color="#A31515">'y'</font> ]; then <br> echo <font color="#A31515">"* Removing files and directories from $projects/$name"</font> ; <br> rm -rf $projects/$name <br> <br> echo <font color="#A31515">"* Removing vhost file from $hosts/$name"</font> ; <br> rm $hosts/$name <br> <br> echo <font color="#A31515">"* Removing link from $enabled_hosts/$name"</font> <br> rm $enabled_hosts/$name <br> <br> echo <font color="#A31515">"* Cleaning up /etc/hosts"</font> <br> sed <font color="#A31515">"/$name/d"</font> /etc/hosts &gt; /tmp/tmp-hosts; <br> mv -f /tmp/tmp-hosts /etc/hosts <br> <br> echo <font color="#A31515">"* Done. The matrix has project $name"</font> ; <br> <br> reload_apache; <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">"Skipped."</font> ; <br> fi <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> exit; <br> fi <br> } <br> <br> enable_host() { <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$hosts/$name"</font> ]; then <br> ln -s $hosts/$name $enabled_hosts/$name <br> echo <font color="#A31515">"127.0.0.1        $name"</font> &gt;&gt; /etc/hosts <br> <br> reload_apache; <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> fi <br> } <br> <br> disable_host() { <br> <font color="#0000ff">if</font> [ -f <font color="#A31515">"$enabled_hosts/$name"</font> ]; then <br> echo <font color="#A31515">'* Removing symlink for current host...'</font> ; <br> rm /etc/apache2/sites-enabled/$name <br> echo <font color="#A31515">'* Updating /etc/hosts'</font> ; <br> sed <font color="#A31515">"/$name/d"</font> /etc/hosts &gt; /tmp/tmp-hosts; <br> mv -f /tmp/tmp-hosts /etc/hosts <br> <br> reload_apache; <br> echo <font color="#A31515">'* Done'</font> <br> <font color="#0000ff">else</font> <br> echo <font color="#A31515">'No such vhost.'</font> ; <br> fi <br> } <br> <br> show_help() { <br> echo <font color="#A31515">'Available actions: <br> create - creates a new project. Includes folder structure and database (optional). <br> delete - delete all project files and drops database (optional). Asks for confirmation. <br> enable - enables selected virtual host. <br> disable - disables selected virtual host <br> help - shows this message.'</font> ; <br> } <br> <br> reload_apache() { <br> service apache2 reload <br> } <br> <br> <font color="#0000ff">if</font> [ $(whoami) != <font color="#A31515">"root"</font> ]; then <br> echo <font color="#A31515">'You must be root.'</font> <br> exit 1; <br> fi <br> <br> <font color="#0000ff">case</font> $action <font color="#0000ff">in</font> <br> create) <br> create_host; <br> ;; <br> add) <br> create_host; <br> ;; <br> rm) <br> delete_host; <br> ;; <br> del) <br> delete_host; <br> ;; <br> delete) <br> delete_host; <br> ;; <br> delall) <br> delete_all; <br> ;; <br> on) <br> enable_host; <br> ;; <br> enable) <br> enable_host; <br> ;; <br> off) <br> disable_host; <br> ;; <br> disable) <br> disable_host; <br> ;; <br> help) <br> show_help; <br> ;; <br> *) <br> echo <font color="#A31515">"Usage: `basename $0` (create|delete|enable|disable) vhostname"</font> ; <br> exit 0; <br> ;; <br> esac <br></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br><h4>  4. Outro </h4><br>  I will take note of any advice, as in such shell scripts I am still a novice. <br><br>  p \ s: used colors for C # to highlight, for there was no shell. <br><br>  <a href="">Download</a> </div><p>Source: <a href="https://habr.com/ru/post/84815/">https://habr.com/ru/post/84815/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../84800/index.html">Who keeps the sniper rifle in the office? (curious survey by February 23)</a></li>
<li><a href="../84810/index.html">Weborama + Java</a></li>
<li><a href="../84811/index.html">Software design</a></li>
<li><a href="../84812/index.html">What we need to dock set up</a></li>
<li><a href="../84814/index.html">ABBYY Business Card Reader for iPhone 3GS</a></li>
<li><a href="../84816/index.html">Resharper 5 beta 2 released</a></li>
<li><a href="../84818/index.html">The program of accounting in trade on the basis of the software designer</a></li>
<li><a href="../84820/index.html">ECONabr or Habra for economists</a></li>
<li><a href="../84821/index.html">"High-tech" business or a fairy tale about shtetl Themis</a></li>
<li><a href="../84823/index.html">Notifications for messages from Google Wave are broadcast via Gmail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>