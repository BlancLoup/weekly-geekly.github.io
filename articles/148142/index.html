<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Android stopwatch with Python + sl4a + fullScreenUI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Such a wonderful thing as SL4A (Scripting Level for Android) is no longer news. With each new SL4A release, the API's ability to access...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Android stopwatch with Python + sl4a + fullScreenUI</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  Such a wonderful thing as SL4A (Scripting Level for Android) is no longer news.  With each new SL4A release, the API's ability to access / control the smartphone is growing.  Until recently, the creation of the user interface was limited to webView tools and standard dialog boxes.  But in the r5 version a new one appeared, as the developers stated, so far experimental, a way to create a user interface - fullScreenUI. <br>  FullScreenUI allows you to create an interface using standard <nobr>Android</nobr> widgets (buttons, text fields, radio buttons, etc.), as well as handle events from them.  Using the example of creating a simple stopwatch, I want to demonstrate the capabilities of this API. <br><a name="habracut"></a><br>  I hope that you are already familiar with SL4A (if not, then Habr√© <a href="http://habrahabr.ru/post/122188/">has a</a> <a href="http://habrahabr.ru/post/122281/">lot of</a> <a href="http://habrahabr.ru/post/134184/">useful</a> and interesting information). <br><br><h4>  What happens </h4><br>  Here are the screenshots of the final result: <br><img src="https://habrastorage.org/storage2/fae/dcf/931/faedcf9316c96d9c433595096552a69a.png"><img src="https://habrastorage.org/storage2/0ae/b71/f27/0aeb71f27440c2e760b31a7a2d588270.png"><br><br><h4>  Markup </h4><br>  To begin with we will create a marking of our interface.  This is the standard <nobr>Android-</nobr> <nobr>xml markup</nobr> (for more information about it, you can find out at <a href="http://developer.android.com/guide/topics/ui/index.html">http://developer.android.com/guide/topics/ui/index.html</a> ).  Of course, SL4A does not support all the subtleties of markup and has not recently supported the very important type of markup RelativeLayout, but since <a href="http://code.google.com/p/android-scripting/wiki/Release_Notes">r6</a> this feature has been supported. <br>  Consider the markup itself: <br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/MainWidget"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag">&gt;</span></span> android:background="#ff000000" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/display"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#0bda51"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"00:00:00.000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bold"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"60dp"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/startbutton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_below</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/display"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"40dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_toLeftOf</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/center"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/center"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_below</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/display"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_centerHorizontal</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/stopbutton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0pdp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"40dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_below</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/display"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentRight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_toRightOf</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/center"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/info"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_below</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/stopbutton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#FFFFFF"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bold"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:textSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"30dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you even see this markup for the first time, but have some experience with HTML or XML, everything should be clear.  If we talk about the support of RelativeLayout, then the full use of this type of markup became possible after attributes such as <br><br><ul><li>  <code>android:layout_alignParentBottom="true"</code> - the bottom edge of the widget will be aligned to the bottom edge of the parent widget (similarly for <code>layout_alignParentTop</code> , <code>layout_alignParentLeft</code> , <code>layout_alignParentRight</code> ) </li><li>  <code>android:layout_below="@id/display"</code> - will place the widget under the widget with the specified id </li><li>  <code>android:layout_toRightOf = "@id/center"</code> - will place the widget to the left of the widget with the specified id </li><li>  <code>android:layout_centerHorizontal="true"</code> - will center on the parent widget </li><li>  etc </li></ul><br><br>  The Button with the id <i>‚Äúcenter‚Äù is</i> created only so that the ‚ÄúStart‚Äù and ‚ÄúStop‚Äù buttons are stretched to it (it is located in the center).  This is what should work: <br><br><img src="https://habrastorage.org/storage2/2cc/f80/043/2ccf80043c77c19f8977b848c752330e.png"><br><br><h4>  Code </h4><br>  Actually the stopwatch code itself.  Some trivial or duplicate code is omitted.  Full version: <a href="http://pastebin.com/z4H2p7Wq">http://pastebin.com/z4H2p7Wq</a> <br>  God forgive me the Python community for ugly code and global variables, I just got acquainted with this programming language quite recently. <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#StopWatch.py #------------------------ layout="""&lt;?xml version="1.0" encoding="utf-8"?&gt; ... &lt;/RelativeLayout&gt; """ rCircle_label = "" rStart_label = "" rClear_label = "" rStop_label = "" #--------------------- import android, os, datetime #  starttime=datetime.datetime.now() runed = False # True    lastcircle = 0 cleared = True # True,     def format_time(tm): hours = int(tm.seconds / 3600) minuts = int((tm.seconds - hours*3600)/60) seconds=tm.seconds - hours*3600 - minuts*60 microseconds = round(tm.microseconds/1000) return "{0:0&gt;02}:{1:0&gt;02}:{2:0&gt;02}.{3:0&gt;03}".format(hours,minuts,seconds,microseconds) #     .  now =0,      def timediff(prev, now=0): if not now: now=datetime.datetime.now() diff=now-prev return format_time(diff) def stopwatch_start(): global runed,lastcircle,starttime runed=True starttime=datetime.datetime.now() lastcircle = starttime droid.fullSetProperty("startbutton","text",rCircle_label) droid.fullSetProperty("stopbutton","enabled","true") def stopwatch_circle(): #  # t -      lastdata = droid.fullQueryDetail("info").result['text'] newdata = lastdata+"\n"+t; droid.fullSetProperty("info","text",newdata) lastcircle = datetime.datetime.now() def stopwatch_stop(): #  def stopwatch_clear(): #  def eventloop(): while True: event=droid.eventWait(50).result if runed: droid.fullSetProperty("display","text",timediff(starttime)) if event != None: if event["name"]=="key": droid.vibrate(30) if event["data"]["key"] == '4': return elif event["data"]["key"]=='24' and cleared: if runed: stopwatch_circle() else: stopwatch_start() elif event["data"]["key"]=='25' and runed: stopwatch_stop() elif event["name"]=="click": droid.vibrate(30) id=event["data"]["id"] if id=="startbutton" and not runed: stopwatch_start() elif id=="stopbutton" and runed: stopwatch_stop() elif id=="stopbutton" and not runed: stopwatch_clear() elif id=="startbutton" and runed: stopwatch_circle() elif event["name"]=="screen": if event["data"]=="destroy": return droid = android.Android() try: print(droid.fullShow(layout)) droid.fullKeyOverride([24,25],True) droid.fullSetProperty("MainWidget","background","#ff000000") droid.fullSetProperty("startbutton","text",rStart_label) droid.fullSetProperty("stopbutton","text",rStop_label) eventloop() finally: droid.fullDismiss()</span></span></code> </pre><br><br><h4>  Parsing code </h4><br>  So, in order to display the interface created by us in the form of xml markup, you need to pass a string with markup to the <code>droid.fullShow</code> function.  You can of course create a separate file with markup and then read it, but in the case when the markup is simple, like mine, I just assigned it to the <code>layout</code> variable.  For debugging purposes, the result returned by <code>droid.fullShow</code> can be output to the console: <pre> <code class="python hljs">print(droid.fullShow(layout))</code> </pre>  If there were errors in the markup, or supported attributes, a corresponding message will be displayed.  After calling this function, if the markup was correct, it will be displayed on the device screen.  To remove it you need to call the function: <pre> <code class="python hljs">droid.fullDismiss()</code> </pre>  If this function is not called for some reason, such as a program crash, then the created interface will not be cleared automatically, but simply will remain, so it is important to use the <code>try finally</code> construct <br><br>  Next line: <pre> <code class="python hljs">droid.fullKeyOverride([<span class="hljs-number"><span class="hljs-number">24</span></span>,<span class="hljs-number"><span class="hljs-number">25</span></span>],<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre>  replaces the standard behavior when pressing keys with codes 24 and 25 (these are volume keys, codes for other keys <a href="http://developer.android.com/reference/android/view/KeyEvent.html">here</a> ).  What does it mean?  This means that if our script is running and one of these keys is pressed, then the standard action of these keys will not be executed (the volume of the sound will not be changed in this particular case). <br><br>  To change the properties of widgets from the script, there is a function <code>droid.fullSetProperty</code> , which takes three parameters: the widget id, the property name, the value assigned.  For example this line <br><pre> <code class="python hljs">droid.fullSetProperty(<span class="hljs-string"><span class="hljs-string">"startbutton"</span></span>,<span class="hljs-string"><span class="hljs-string">"text"</span></span>,rStart_label)</code> </pre><br>  we change the inscription on the button. <br><br>  To query the properties of <code>droid.fullQueryDetail</code> , takes one value - the widget's id.  For example, you can get the value of the property - <code>text</code> text field with id <code>info</code> as follows: <br><pre> <code class="python hljs">droid.fullQueryDetail(<span class="hljs-string"><span class="hljs-string">"info"</span></span>).result[<span class="hljs-string"><span class="hljs-string">'text'</span></span>]</code> </pre> <br><br><h5>  Message handling </h5><br>  All user actions, such as pressing a button, or a key, get into the script as messages. <br>  Message handling is convenient to implement in a separate function.  I have <code>eventloop()</code> functions.  There are a number of functions for processing messages.  For this example it was convenient to use: <code>droid.eventWait</code> .  This function stops the script until a message is received.  Accepts optional parameter - maximum wait time in ms.  If during this time the message was not received, the script will continue to run, and the result of the function will be the object <code>None</code> .  If the message is received, the result of <pre> <code class="python hljs">event=droid.eventWait(<span class="hljs-number"><span class="hljs-number">50</span></span>).result</code> </pre>  there will be an associative array with the name of the event and information about it. <br>  To begin with, we check the value of <code>event["name"]</code> , if it is equal to <i>"key"</i> , then a button was pressed, the code for which can be learned from <code>event["data"]["key"]</code> .  If it is equal to <i>‚Äúclick‚Äù</i> , then there was a click on a button (or another widget), whose id can be found in <code>event["data"]["id"]</code> . <br><br>  I hope that the rest of the code is completely understandable and does not require explanation. <br><br><h4>  Total </h4><br>  With the advent of fullScreenUI in sl4a, developers in Python, Perl, JRuby, Lua, BeanShell, JavaScript can now compete with Java developers.  Although the fullScreenUI support in sl4a is still far from ideal, yet you can already create quite a good, fast graphical interface for your scripts.  Developers are constantly engaged in the <a href="http://code.google.com/p/android-scripting/wiki/FullScreenUI_Layout_Property_Issues">improvement of</a> this API, which is very pleasing. <br><br>  <b>upd: The</b> stopwatch is not the best example of using sl4a + python (since the specifics of the language is not the same), but for the introductory article - just right. </div><p>Source: <a href="https://habr.com/ru/post/148142/">https://habr.com/ru/post/148142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148136/index.html">Practice ITIL for a small company. Change management</a></li>
<li><a href="../148137/index.html">UCS2 or UCS4? - pyodbc and work with utf16 data in MSSQL</a></li>
<li><a href="../148138/index.html">Time sinks and the fight against them</a></li>
<li><a href="../148139/index.html">Java shared memory and off-heap caching</a></li>
<li><a href="../148140/index.html">Substitution of XMLHttpRequest or not touching the tons of ready-made js-code to change the behavior of all ajax requests</a></li>
<li><a href="../148144/index.html">Load balancing on PPTP / L2TP MPD5 servers</a></li>
<li><a href="../148151/index.html">SQL injection for beginners. Part 1</a></li>
<li><a href="../148155/index.html">Queryfeed - RSS feeds from Twitter and Facebook</a></li>
<li><a href="../148156/index.html">The future of cloud computing: 9 major trends of 2012</a></li>
<li><a href="../148157/index.html">Mobile Technologies Olympiad. Team Tour</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>