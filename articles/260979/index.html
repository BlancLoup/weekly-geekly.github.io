<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>STC Metrotek: how it was. Part One (2004-2006)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 At the insistent request of Des333 (why everyone writes, and you don‚Äôt?), Publish the story of STC Metrotek. 


 Not so long ago in St....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>STC Metrotek: how it was. Part One (2004-2006)</h1><div class="post__text post__text-html js-mediator-article"><h3>  Introduction </h3><br>  At the insistent request of <a href="http://habrahabr.ru/users/des333/" class="user_link">Des333</a> (why everyone writes, and you don‚Äôt?), Publish the story of STC Metrotek. <br><br><img src="https://habrastorage.org/files/22c/833/a2f/22c833a2f77442e38509b1bf36aace3f.jpg"><br>  Not so long ago in St. Petersburg there was such an institute - LONIIS (Leningrad branch research institute of communication), in which they developed various useful and useless things related to communication.  In particular, the full analogue of the Finnish digital telephone exchange DX-200 was created there, but this analogue was called ATTS-90 on domestic components.  Who then knew that our electronics is waiting?  In addition, in the nineties, research institutes actively engaged in certification of foreign equipment: from telephones to office PBXs, which brought a good income and made it possible to develop other areas.  For example, measuring and testing communication channels and signaling protocols in telephony.  Access to both Russian and international standards was organized, it was possible to purchase any software and development tools.  In addition, the experience of creating a digital telephone station made it possible to make their equipment of any complexity.  In general, it was cool.  Almost exactly the same as that of the Strugatskys on Monday begins on Saturday. <a name="habracut"></a><br>  Now LONIIS no longer exists, but there is the Leningrad branch of the Central Research Institute of Communication, that is, LO ZNIIS.  At the beginning of the "zero" one director was replaced by another, the war began, and the dawn, as always happens, was replaced by sunset. <br><br><h3>  The beginning and the first pancake </h3><br>  Four engineers, confident in their abilities and knowledge, decided to organize their <a href="http://metrotek.spb.ru/">company</a> for the development and production of measuring equipment for telecommunications.  Found partners, money, registered a legal entity, removed the so-called office space, repaired it and began to produce a new super-device for analyzing the alarm system OKS-7 and DSS1 based on a handheld from Compaq <a href="https://en.wikipedia.org/%3Ftitle%3DIPAQ">iPAQ 3950</a> .  Here is this: <br><img src="https://habrastorage.org/files/6f3/133/cf1/6f3133cf145543e8aff26228c2528439.jpg"><br>  This is a four-port analyzer for the OKS-7 signaling protocols and DSS1 / PRI.  I will omit the development details, but I will say that at that time (2004) it was a rather bold decision ( <s>Pity and flamethrowers! Dementia and courage!</s> ), Because the protocol analyzers that existed then looked like this: <br><img src="https://habrastorage.org/files/d55/0d0/90f/d550d090fbfd41e6bd6a203c98053922.jpg"><br>  Quite a big box with ISA-boards that are connected to the <a href="https://ru.wikipedia.org/wiki/%25D0%25A6%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D0%25B2%25D0%25BE%25D0%25B9_%25D0%25BF%25D0%25BE%25D1%2582%25D0%25BE%25D0%25BA_E1">PCM / E1</a> paths under test.  And our device fits easily in your pocket.  However, this turned out to be one of the factors that played a fatal role in his fate.  Firstly, it was difficult for customers to imagine that a device ten times smaller in size could perform the same functions as a hefty computer.  Secondly, we were told in plain text: ‚ÄúWhat are you guys?  His sprint on the second day of use! ‚ÄùAnother natural reason for the failure was that handheld computers lost the battle for the user and the manufacturers took them out of production.  And what was the iPAQ's convenient 100-pin connector for connecting external devices! <br><img src="https://habrastorage.org/files/f71/ba7/56e/f71ba756e355485ab25300c198131650.jpg"><br>  In the picture above - the so-called sleeve with the interface board and the analyzer that we developed inside.  Used body from CompactFlash-expansion.  Then you could easily order any parts on Foxconn.  However, in spite of everything, about 30 <a href="http://metrotek.spb.ru/bc.html">devices</a> managed to be quite successfully attached. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Testing E1 </h3><br>  Admittedly, in 2005 we knew little about testing PCM, but since the transmission medium for signaling, which we were able to analyze, was the E1 paths, we decided to make an inexpensive analyzer for their (paths) measurements.  Thus, a 2048 kbps <a href="http://metrotek.spb.ru/b3.html">Bercut-E1</a> analyzer was born.  In the process of development, our programmers learned a lot of new and interesting, the standards were studied along and across, the rake race was more than fascinating.  The error in the choice of the ADC bandwidth to obtain the pulse shape made it possible to master the methods of analyzing the physical signal using a stroboscope;  insufficiently careful reading of the processor documentation helped to subsequently deal with the <a href="http://www.scienceprog.com/microcontroller-brown-out-detection/">brownout</a> mechanism of the <a href="http://www.scienceprog.com/microcontroller-brown-out-detection/">detector</a> , as well as with the hysteresis effect, as a result of which this mechanism did not work;  The 320x240 display controller was written on fpga ... Yes, there was a lot of things!  And it was great. <br><div class="spoiler">  <b class="spoiler_title">Here is a piece of ChangeLog</b> <div class="spoiler_text"><pre><code class="tex hljs">2004/08/20 * video.c:      .   [fam] 2004/08/19 + mem.c:    + video.c:    .     . * service.c:    epcs   fpga   epcs_nconf_clr()  epcs_nce_set() [fam] 2004/08/18 * epcs.c:  epcs  flash' [fam] * fpga.c:  fpga  epcs [fam] 2004/08/17 * xmodem.c: usart0      xmodem    [fam] * service.c:    DataFlash,        flash'  [fam] 2004/08/12 + init.c:    * timer?.?:   * flash.c: !    DataFlash.     [fam] * defines.h:   ,   . defines     : DDR_XX -- data direction register   XX (DDRB) DD_XX --    DDR (DDB1) PORT_XX --  (PORTB, ) IPORT -- input  (PINB) XX - ,    (PB1) PIN_XX --   input (PINB1) [fam] 2004/08/11 * ,   spi .       . . [fam] 2004/08/10</code> </pre> <br></div></div><br>  Anyway, we released the device in mass production, even made a little for export, and it also became the de facto standard for PCM measurements in domestic telephony.  Apparently, it was possible to still catch luck by the tail on the decline of the wave.  And it gave us the opportunity to move on. <br><br><h3>  Making your handheld </h3><br>  In the meantime, as I said, the handhelds were removed from production and we decided that it would not be very difficult to do something similar on our own.  No sooner said than done.  And the development of the device based on the Intel PXA270 processor began.  He didn‚Äôt have enough of his own strength, so they attracted Timur Tashpulatov, who kindly agreed to help with the circuitry and layout of the board, despite the fact that he hadn‚Äôt been engaged in such things before.  The result is this: <br><img src="https://habrastorage.org/files/c67/b8f/836/c67b8f836701490ba21f8c3b14e7799a.jpg"><br>  The exhibit in the company's museum, with Linux insider, is the same <a href="https://en.wikipedia.org/wiki/Open_Palmtop_Integrated_Environment">Opie</a> , which we installed on the iPAQ, aka ‚ÄúBercut-C‚Äù, fixed by the jambs in the bootloader and the qt-application as an example of output to the screen.  Oddly enough, it all worked almost the first time.  The most difficult thing was probably to get the jtag interface working properly. <br><br>  And then we developed a new board, which was installed in a solid metal case.  The design of the case was modeled in Blender's 3-d editor for a couple of nights, and then buyers began to say: ‚ÄúWe want this device, fashionable, with a wave‚Äù. <br>  Actually, it looked like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/45e/d36/581/45ed365815bb3745ba1a6dca3c085bba.jpg" alt="image"><br>  <a href="http://metrotek.spb.ru/b4.html">Here</a> you can read about the device in a little more detail.  The fact that it is modular, with a large screen, with a large battery capacity.  But something about what you link will not know.  About what is inside and what is good, and what is bad from the standpoint of the developer of the device.  Because now, looking back, you can safely talk about what we have done well and what not, what absolutely could not be done, why reinvent the wheel and what tasks needed to be solved differently.  But about this, I hope, I will write next time. <br><br>  Thank you for reading this part of the story to the end. </div><p>Source: <a href="https://habr.com/ru/post/260979/">https://habr.com/ru/post/260979/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260969/index.html">The digest of news from the world of development on Unity</a></li>
<li><a href="../260971/index.html">Brubeck is a fast, statsd-compatible metric aggregator from GitHub</a></li>
<li><a href="../260973/index.html">How to control the availability of keywords on the site</a></li>
<li><a href="../260975/index.html">The importance of the output serialization API</a></li>
<li><a href="../260977/index.html">Software-defined WAN: well-made electrical tape?</a></li>
<li><a href="../260981/index.html">Visualization of results in R: first steps</a></li>
<li><a href="../260983/index.html">PHP extension. Writing a simple array with Traversable and ArrayAccess</a></li>
<li><a href="../260985/index.html">RAD using multidimensional table processor</a></li>
<li><a href="../260987/index.html">Go away HTML, go away</a></li>
<li><a href="../260989/index.html">Messenger spam: is the law broken?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>