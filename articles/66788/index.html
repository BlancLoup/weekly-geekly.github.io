<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Windows Mobile: Focus Issues in ImageButton</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all! 

 The problem is the following: an ImageButton control is required for a Windows Mobile Application that combines the behavior of Bu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Windows Mobile: Focus Issues in ImageButton</h1><div class="post__text post__text-html js-mediator-article">  Good day to all! <br><br>  The problem is the following: an ImageButton control is required for a Windows Mobile Application that combines the behavior of Button and PictureBox controls. <br><br>  ImageButton options: <br>  1. Use the Button control.  Problem: the lack of the Image property as in WinForms analog. <br>  2. Use the PictureBox control that supports the OnClick event.  Problem: PictureBox <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.control.focus.aspx">does not support the Focus method</a> (as well as its successors). For the sake of fairness, it can be said that this method can be called programmatically, but visually it will not be noticeable.  In addition, we can not switch using taba between multiple controls such as PictureBox. <br>  3. Inherit from Button and try to implement the Image property yourself.  This way I could not achieve the desired result. <br>  4. Inherit from Control and implement your control's drawing logic, as Mictrosoft recommends doing.  Problem: the focus frame is not drawn.  We will try to solve this problem. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h4>  Microsoft ImageButton </h4><br>  Microsoft proposes to inherit from Control and implement all the logic of drawing independently.  This is what happens (I submit with minor code changes, the control itself can be <a href="http://www.microsoft.com/downloads/details.aspx%3FFamilyID%3D039C5D13-2DA5-42C7-9426-B1F298752B4E%26displaylang%3Den">downloaded from here</a> ): <br><br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code> <h4> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code> </h4> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code> <blockquote> <code><code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code> <blockquote> <code><code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code> <blockquote> <code><code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ImageButton : Control <br> { <br> <font color="#0000ff">public</font> Image Image <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">Bitmap</font> m_bmpOffscreen; <br> <br> <font color="#0000ff">public</font> ImageButton() <br> { <br> <font color="#0000ff">this</font> .Size = <font color="#0000ff">new</font> Size(21, 21); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaint(PaintEventArgs e) <br> { <br> <font color="#0000ff">try</font> <br> { <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .Image != <font color="#0000ff">null</font> ) <br> { <br> <font color="#2B91AF">Graphics</font> gxOff; <font color="#008000">//Offscreen graphics</font> <br> <br> <font color="#0000ff">if</font> (m_bmpOffscreen == <font color="#0000ff">null</font> ) <font color="#008000">//Bitmap for doublebuffering</font> <br> { <br> m_bmpOffscreen = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (ClientSize.Width, ClientSize.Height); <br> } <br> <br> gxOff = <font color="#2B91AF">Graphics</font> .FromImage(m_bmpOffscreen); <br> <br> <font color="#008000">//gxOff.Clear(this.BackColor);</font> <br> <font color="#008000">//Draw some bitmap</font> <br> gxOff.DrawImage( <font color="#0000ff">this</font> .Image, 0, 0, <font color="#0000ff">this</font> .ClientRectangle, GraphicsUnit.Pixel); <br> <br> <font color="#008000">//Boundary rectangle</font> <br> Rectangle rc = <font color="#0000ff">this</font> .ClientRectangle; <br> rc.Width--; <br> rc.Height--; <br> <br> <font color="#008000">//Draw boundary</font> <br> gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc); <br> <br> <font color="#008000">//Draw from the memory bitmap</font> <br> e. <font color="#2B91AF">Graphics</font> .DrawImage(m_bmpOffscreen, 0, 0); <br> <br> gxOff.Dispose(); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception ex) <br> { <br> <br> } <br> } <br> <br> <font color="#0000ff">private</font> Color BackgroundImageColor(Image image) <br> { <br> <font color="#2B91AF">Bitmap</font> bmp = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> (image); <br> <font color="#0000ff">return</font> bmp.GetPixel(0, 0); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseDown(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnMouseUp(System.Windows.Forms.MouseEventArgs e) <br> { <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnPaintBackground(PaintEventArgs e) <br> { <br> <font color="#008000">//Do nothing</font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>      double buffering,       ImageButton . <br> <br>     <br>    ,   -       focused.   -     .    : <br> <br>   OnPaint : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br> : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">gxOff.DrawRectangle( <font color="#0000ff">new</font> Pen(( <font color="#0000ff">this</font> .Focused) ? Color.Black : Color.Transparent), rc);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     OnGotFocus  OnLostFocus,      Invalidate   : <br> <br> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnGotFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnGotFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLostFocus( <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLostFocus(e); <br> <font color="#0000ff">this</font> .Invalidate(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br> <br>     Focused    ,    - .     . ,     ,    ,  . <br> <br> PS        ,  .</code> </div><p>Source: <a href="https://habr.com/ru/post/66788/">https://habr.com/ru/post/66788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../66779/index.html">Yandex will share pay per context in Yandex.Site search</a></li>
<li><a href="../66780/index.html">From simple correspondence to social networking</a></li>
<li><a href="../66781/index.html">Selection of work in RuNet</a></li>
<li><a href="../66782/index.html">Everyone can be a first-class specialist!</a></li>
<li><a href="../66785/index.html">Blind comparison of search engines</a></li>
<li><a href="../66789/index.html">‚ÄúWriting quickly and making money is difficult‚Äù - the service to reduce links tr.im died</a></li>
<li><a href="../66791/index.html">Sun Java Runtime Environment 6.0 Update 16</a></li>
<li><a href="../66794/index.html">Tackling OEM lawlessness</a></li>
<li><a href="../66798/index.html">We will not die, to the question of the threat of a nuclear apocalypse</a></li>
<li><a href="../66801/index.html">Theory of buying from abroad</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>