<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Genetic algorithms in faces</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Genetic algorithms were invented in the 1950s as the result of the first computer simulation experiments on natural evolution. Since then, they have b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Genetic algorithms in faces</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/67f/40b/85b/67f40b85b86e0ee466d32433fb3fd7fc.png" align="right">  Genetic algorithms were invented in the 1950s as the result of the first computer simulation experiments on natural evolution.  Since then, they have been used to solve a wide variety of optimization problems where gradient methods for some reason are not suitable.  The biological component of genetic algorithms has a very simplified form here and in this case it is more about following the general idea of ‚Äã‚Äãevolutionary selection than its full-fledged simulation.  However, sometimes the results of the work of the GA can be interpreted in a biological sense.  In our article, we talk about the experience of applying genetic algorithms for the problem of face recognition in order to obtain "regions of importance" of a person.  The use of this approach allowed an average increase in the recognition accuracy of our face recognition system by 20%. <a name="habracut"></a><br><br><h1>  Existing approaches for face recognition </h1><br>  Historically, after about 20 years of intensive research in the field of computer facial recognition, in the early 2000s two basic groups of methods for comparing individuals were distinguished: ‚Äúholistic approaches‚Äù, ‚Äúholistic approaches‚Äù (or ‚Äúglobal approaches‚Äù) and ‚Äúfeatured approaches‚Äù "," Feature-based approaches "(or" structural approaches ") [1].  In the first case, the faces are treated as whole images that are compared with each other.  In the second case, local features are distinguished from the face image, such as information about the absolute and relative position of the eyes, nose, mouth, etc.  Both groups have their drawbacks: holistic approaches have shown, in general, greater reliability in close to ideal recognition conditions as compared to indicative approaches, however, featured approaches have better recommended in a situation when certain parts of the face are not visible for some reason (for example, they are closed by elements of clothing or points).  The application of SIFT-like methods for extracting attributes in their pure form to the face recognition problem gives unsatisfactory results, since there are usually too few ‚Äúangles‚Äù on a person‚Äôs face for which key points are defined.  The algorithms of the ‚Äúdense-SIFT‚Äù type with the calculation of signs for a given lattice of key points, although they demonstrate good recognition quality [2], are not always convenient for practical use due to the large size of the vectors of signs and the long time required for their calculation.  Under these conditions, in recent years, a group of methods has gained popularity, which can be conventionally called ‚Äúmodular approaches‚Äù [4‚Äì9], including the method of <a href="http://habrahabr.ru/post/193658/">local binary patterns</a> . <br><br><h1>  Cluster approaches for comparing individuals </h1><br>  The essence of cluster approaches for comparing individuals is to divide the face image into a number of areas, to each of which you can apply a holistic approach and compare them in pairs, i.e.  regardless of other sites.  In this case, it can be hoped that if some pairs of plots of the compared images do not coincide with each other due to the aforementioned interfering factors such as shadows and overlaps, the remaining pairs of plots will provide the necessary degree of mutual correlation, which will be enough for a correct final solution of the individuals . <br>  The method of principal components [4], moment invariants [5], <a href="http://habrahabr.ru/post/153109/">local binary patterns</a> (LBT) [6, 7], Gabor wavelets [8], Haar wavelets [9] and other methods can be used as a holistic approach.  In our project we use the combined approach of the LBP [7] and the moments of the pseudo-Zernike [5]. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Matrix of importance scales </h1><br>  In our face recognition system embedded in the ZZPhoto application, we consider the unequal importance of different face areas for comparing faces by dividing the face image into <img src="https://habrastorage.org/getpro/habr/post_images/78a/27c/da1/78a27cda1f02e63fabb20847eb2d7844.png">  plot (Fig. 1) and assigning each of them their own weights <img src="https://habrastorage.org/getpro/habr/post_images/230/5de/96f/2305de96f0d28c049789d4946549fa6a.png">  , weights take one of four discrete values, <img src="https://habrastorage.org/getpro/habr/post_images/414/16e/9f2/41416e9f2e7ec80af3ad35572ec97ad9.png">  . <br><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/80a/dc6/63c/80adc663c03aa4042a7e07dda59dad92.png"></div><br>  <b>Figure 1. a) Separation of the face into 8x8 = 64 non-overlapping square sections.</b>  <b>b) Values ‚Äã‚Äãof the weights matrix of the importance of the face areas.</b> <br><br>  The greater the weight value, the greater the influence / mismatch of the corresponding area of ‚Äã‚Äãthe face on the final decision of the comparison algorithm.  In fig.  6 more important areas of the face are highlighted in more red. <br>  The use of complete enumeration to determine the optimal weight weights matrix is ‚Äã‚Äãdifficult in practice, since we would have to consider <img src="https://habrastorage.org/getpro/habr/post_images/77e/b07/0d8/77eb070d8db71fe7288beb80c01ff9d2.png">  variants of the matrix of weights (here there is a degree of 32, not 64, since the matrix of weights that are symmetrically horizontal are used because of, in general, the symmetrical nature of the human face).  Therefore, to search for a better matrix, it is necessary to use a more intelligent search algorithm.  As a result, we stopped on genetic algorithms (GA). <br><br><br><h1>  Genetic algorithms </h1><br>  <a href="http://habrahabr.ru/post/200454/">Genetic algorithms</a> have proven themselves well as a means of global optimization when gradient optimization methods cannot be applied.  Their advantages are: no differentiable model of the object to be optimized is required, as well as a lower risk of falling into a local minimum.  Their disadvantage is a significantly lower convergence rate compared to gradient methods.  The essence of genetic algorithms is to simulate the process of natural selection as a means of finding the optimal solution, using the mechanism for transmitting hereditary information from generation to generation through genes.  As a measure of the success of the "life" of the organism, the objective optimization function is used, which in terms of the GA is called the "fitness function".  Before describing the work of the GA algorithm for our case, we list the concepts with which we operate and briefly explain their meaning. <br><br>  <i>Fitness function</i> - determines the quality of "life" of an individual in a generation (population).  In our case, the role of the fitness function is performed by a program experiment on face recognition using our face comparison algorithm on a given database of face images.  The result of the fitness function is the percentage of correctly recognized persons for a particular chromosome. <br><br>  <i>Chromosome</i> - defines the individual in the population, in fact, this is our matrix of weights of the importance of the areas of the face.  Each chromosome is a candidate for solving the target problem. <br><br>  <i>Fitness</i> is the quality of life of an individual encoded by the chromosome.  It is the result of applying a fitness function to the chromosome.  In our case, this is the classification accuracy with a given weights matrix of the importance of face areas. <br><br>  <i>A population</i> is a set of 100 different chromosomes, the genes are encoded by values ‚Äã‚Äãfrom the allowable set {0,1,2,3}.  Values ‚Äã‚Äãcan be either completely random (the first population) or be the product of an evolutionary process (crossing and mutations). <br><br>  <i>Crossing</i> (reproduction) - the procedure for obtaining a new chromosome.  A new ‚Äúchild‚Äù chromosome is formed from parts of the ‚Äúparent‚Äù chromosomes.  The crossing point is selected using a random number generator each time for each pair of parents.  The choice of parents is performed by the selection procedure. <br><br>  <i>Breeding</i> is a procedure for selecting ‚Äúparent‚Äù chromosomes from which chromosomes will be formed for a new population.  Breeding is designed to increase the likelihood of hitting the set of ‚Äúparents‚Äù of chromosomes that showed the best fitness in the last currently populated population.  We use the stochastic approach, the probability <img src="https://habrastorage.org/getpro/habr/post_images/8e6/e03/ec4/8e6e03ec4901d707ce41bd88b1413447.png">  Choosing the i-th chromosome: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e95/f2a/e01/e95f2ae01b78de62ecf0ac5c453ad133.png"></div><br><br>  Where: <img src="https://habrastorage.org/getpro/habr/post_images/19e/590/431/19e590431b2ef4bd531729f723d8ea73.png">  . <br><br>  <i>Mutation</i> - the procedure of replacing a single chromosome value with a random value after crossing, the probability of a mutation is set in advance. <br><br>  <i>Elitism</i> is a feature of the formation of a new generation, the essence of which lies in the fact that the best parents are directly included in the new generation.  Their number can be from 1 and more. <br><br><h1>  Description of the experiment </h1><br><ol><li>  An initial population of 100 chromosomes is generated, the values ‚Äã‚Äãof which are filled with random values. </li><li>  A fitness function is applied to each chromosome of the population, which determines the value of fitness for chromosomes. </li><li>  With the help of selection, the most adapted chromosomes are selected, which form a multitude of ‚Äúparents‚Äù. </li><li>  Random pairs are selected from a variety of parents, crossing is performed, and chromosomes of "children" are formed. </li><li>  The mutation procedure is applied to the chromosomes of "children". </li><li>  The resulting chromosomes form a new population, to which steps 2) - 5) are performed. </li><li>  If the improvement does not occur for a long time (say, 30 populations or more), then stop.  Chromosome, which showed the best fitness, is the solution to the problem. </li></ol><br><br><h1>  Experiments </h1><br>  The following biological interpretation can be given for our experiments: biological individuals who pay attention to the ‚Äúwrong‚Äù parts of the face are dying out;  the same individuals who have a good recognition ability survive and produce more numerous offspring. <br>  The first experiment was carried out on the well-known Color FERET face image database [11].  From this database, images of the faces of 100 people, photographed during several sessions, 5 examples of persons per person were selected.  Examples of images from the Color FERET Face Database are shown in Figure.  2. This database contains images of faces taken from several photo sessions in different lighting conditions and with different facial expressions.  The selection of the actual sites of persons was carried out automatically by the module for the selection of persons based on the Viola-Jones face detector, which is part of OpenCV.  It additionally includes the normalization of the image in size, position and angle of rotation in the frontal plane (for which the face, eye, nose and mouth are additionally searched for). <br><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fe4/39f/e8b/fe439fe8b038e47d911ec8a500515bd5.jpg"></div><br>  <b>Fig.</b>  <b>2. Examples of faces from the Color FERET Face Database.</b> <br><br>  The essence of the experiment consists in the classification of persons in the ‚ÄúSingle face Per Person‚Äù mode.  The recognition algorithm receives as input one photo of each person‚Äôs face from the database, after which it compares the selected person with all its other and other people's faces in the database and builds dependencies of authentication errors of the 1st and 2nd kind on the authentication threshold, i.e. .  False Accept Rate (FAR) dependency curves, and False Reject Rate (FRR).  The FAR error corresponds to the ‚Äúfalse access‚Äù situation, when the system falsely ‚Äúrecognizes someone else as its own‚Äù;  The FRR error is ‚Äúgoal skipping‚Äù when the system falsely ‚Äúdoes not recognize its own.‚Äù  According to the conditions of the applied problem that we are solving, the value of the FRR was fixed and should not exceed 20%.  According to the results of experiments, a total recognition error is formed on all faces, in the role of which the error HTER (Half Total Error Rate) is used, i.e.  access error equal to the average of FAR and FRR. <br><br>  For the Color FERET Face Database, the FAR recognition error with unit weights was 21% (ie, 79% of correct answers), which is close to the current state-of-the-art level of face recognition methods.  After applying genetic algorithms to optimize the weights matrix of the importance of the face areas (Fig. 3), the FAR recognition error was reduced to 12%, i.e.  reduce by almost 2 times compared to the original. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4d2/796/eba/4d2796eba029f9b7e0cb5415f8870ad1.png"></div><br>  <b>Fig.</b>  <b>3. The result of applying genetic algorithms to optimize the matrix of weights of the importance of areas of the face based on Color FERET.</b> <br><br>  To organize an experiment with different races, as well as, more close to real conditions, we collected our own database of ZZWolf ABC Face Database, which includes faces of people of different races (ABC = Asian, Black, Caucasian).  The base of persons contains samples of persons for three main races, 10 persons for 10 persons (5 men and 5 women) of each race, photos of persons were collected on the Internet, only 300 persons.  These are mainly the faces of famous people (actors and politicians), the pictures were taken by various photo cameras, at different times (the difference in the filming can be years) and in different lighting conditions. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/18c/16c/83e/18c16c83e91f60e7a5b2d4c479f8e980.png"></div><br>  <b>Fig.</b>  <b>4. Examples of persons from the ZZWolf ABC Face Database.</b>  <b>Allocation, normalization and preprocessing of individuals was carried out automatically.</b> <br><br>  As a result, the face recognition error on the new base averaged 37.2%.  After applying the genetic algorithms, it was possible to reduce the error to 32%. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/362/9c0/b18/3629c0b180c9cab1298fd7170a346cb8.png"></div><br>  <b>Fig.</b>  <b>5. The result of applying genetic algorithms to optimize the weights matrix of the importance of facial areas based on the ZZWolf ABC Face Database for different races.</b> <br><br>  <b>Table 1. Recognition results based on ZZWolf ABC Faces</b> <br><table><tbody><tr><td width="205"></td><td width="104">  For Asians <br></td><td width="123">  For blacks <br></td><td width="95">  For whites <br></td><td width="113">  The average <br></td></tr><tr><td width="205">  Unit weight weights <br><br>  (all parts of the face are equal) <br></td><td width="104">  38.0% <br></td><td width="123">  35.3% <br></td><td width="95">  38.3% <br></td><td width="113">  37.2% <br></td></tr><tr><td width="205">  Weights of importance optimized by genetic algorithms <br></td><td width="104">  34.3% <br></td><td width="123">  29.0% <br></td><td width="95">  32.8% <br></td><td width="113">  32.0% <br></td></tr></tbody></table><br><br>  The final optimized matrices of importance of the areas of the faces are shown in Fig.  6, they differ for different races.  Our sample of faces ‚ÄúZZWolf ABC Face Database‚Äù is small in size, so we do not pretend that the experimentally obtained matrices of importance of areas of people for different races are optimal under any conditions and fully correspond to biological systems of face recognition in real people. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/67f/40b/85b/67f40b85b86e0ee466d32433fb3fd7fc.png"></div><br>  <b>Fig.</b>  <b>6. Matrix of importance of sites of persons for various races.</b>  <b>The more red, the more important it is.</b> <br><br>  Nevertheless, if we accept the hypothesis that people of different races, when recognizing each other's faces, pay more attention to areas of the face that are characteristic of their race and because of this, it is difficult for representatives of different races (for example, Europeans and Asians) to recognize each other , the results can be interpreted as follows: for whites, the most important is the eye area, for blacks the nose area, and for Asians the ear area and the forehead above the standard arches. <br><br><h1>  findings </h1><br>  The article presents a method for improving the accuracy of the face recognition algorithm, which is used in the ZZPhoto program based on the use of genetic algorithms.  Experiments on various bases of individuals show an improvement in the quality of recognition from 20% to 2 times.  The method is quite general and can be applied to various cluster face recognition algorithms.  The results of experiments on a sample of individuals from different races give interesting results, possibly explaining some natural mechanisms for recognizing faces in humans. <br><br><h1>  Bibliography </h1><br><ol><li>  W. Zhao, R. Chellappa, PJ Phillips, A. Rosenfeld.  Face recognition: A literature survey, ACM Computing Surveys (CSUR), 2003, Volume 35, Issue 4, pp.  399 - 458. </li><li>  P. Dreuw, P. Steingrube, H. Hanselmann, H. Ney.  SURF-Face: Face Recognition Under Viewpoint Consistency Constraints // Proceedings British Machine Vision Conference, 2009. </li><li>  R. Gottumukkal, VK Asari.  An Approach for a Modified PCA Approach // Pattern Recognition Letters, 2004, Volume 25, Issue 4, pp.  429 - 436. </li><li>  HV Nguyen, L. Bai, L. Shen.  Biblical Pattern: Personality: A Novel Approach for Person Recognition of Individual Persons // Advances in Biometrics.  Lecture Notes in Computer Science Volume 5558, 2009, pp.  269-278. </li><li>  HR Kanana, K. Faez, Y. Gaob.  Face recognition using an adaptively weighted PZM array pattern for a person // Pattern Recognition, 2008, Volume 41, Issue 12, pp.  3799-3812. </li><li>  S. Nikan, M. Ahmadi.  Human face recognition under occlusion using LBP and entropy weighted voting // 2012 21st International Conference on Pattern Recognition (ICPR), 11-15 Nov.  2012, pp.  1699 - 1702. </li><li>  T. Ahonen, A. Hadid, M. Pietikainen.  Face Description with Local Binary Patterns: Application to Face Recognition // Pattern Analysis and Machine, 2006, Volume 28, Issue, 12, pp.  2037-2041. </li><li>  B. Kepenekci, FB Tek, G. Bozdagi Akar, Occluded face recognition based on Gabor wavelets, ICIP 2002, September 2002, Rochester, NY, MP-P3.10. </li><li>  H.-S.  Le, H. Li, Recognizing images of the 17th International Conference on Pattern Recognition (ICPR04), vol.  1, 2004, pp.  318‚Äì321. </li><li>  D. Rutkovskaya, M. Pilinsky, L. Rutkovsky.  Neural networks, genetic algorithms and fuzzy systems // Per.  from Polish M .: Hotline-Telecom, 2004 - 452 p. </li><li>  <a href="http://www.cl.cam.ac.uk/research/dtg/attarchive/facedatabase.html">www.cl.cam.ac.uk/research/dtg/attarchive/facedatabase.html</a> </li><li>  <a href="http://www.nist.gov/itl/iad/ig/colorferet.cfm/">www.nist.gov/itl/iad/ig/colorferet.cfm</a> </li></ol><br><br>  UPDATE: The names of the races are aligned with the English-language Wikipedia. <br></div><p>Source: <a href="https://habr.com/ru/post/221137/">https://habr.com/ru/post/221137/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221121/index.html">Trends in online education</a></li>
<li><a href="../221123/index.html">Why do we need reflection in C ++ 1y</a></li>
<li><a href="../221129/index.html">EMET, prevention of operation and non-obvious settings</a></li>
<li><a href="../221133/index.html">JSR 133 (Java Memory Model) FAQ (translation)</a></li>
<li><a href="../221135/index.html">Viewaide: now web service</a></li>
<li><a href="../221139/index.html">Bad advice from the creators of the Yandex.Maps API. How to make everything so bad</a></li>
<li><a href="../221141/index.html">Torrent Updater - OS X Open Source program for checking new versions of .torrent files on popular trackers</a></li>
<li><a href="../221143/index.html">New Dedicated Server: Acceptance and Verification</a></li>
<li><a href="../221145/index.html">PyCon Russia 2014 Program</a></li>
<li><a href="../221153/index.html">May 20-22, ICAgile Certified Professional training in St. Petersburg</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>