<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using the Managed Extensibility Framework (MEF) to Develop Modular Silverlight Applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The MEF library appeared relatively recently, but quickly gained popularity among .Net developers for its ease of use and efficiency. It allows you to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using the Managed Extensibility Framework (MEF) to Develop Modular Silverlight Applications</h1><div class="post__text post__text-html js-mediator-article">  The MEF library appeared relatively recently, but quickly gained popularity among .Net developers for its ease of use and efficiency.  It allows you to build modular applications with a minimum level of connectivity parts (parts) of the application.  This library includes not only the Dependency Injection container, but a large amount of infrastructure: a variety of mechanisms for searching for composition elements in assemblies, remote XAP files, a mechanism for marking composition elements using .Net attributes, etc. <br><br>  There is a version of the MEF for Silverlight, which is different from the desktop version.  We will talk about the features of using MEF for Silverlight applications in this article. <a name="habracut"></a><br><br><h4>  Differences from the desktop version </h4>  Several specific classes have been added to MEF for Siverlight. <ul><li>  CompositionInitializer </li><li>  DeploymentCatalog </li><li>  Compositionhost </li><li>  ExportFactory &lt;T&gt; </li></ul><h5>  CompositionInitializer </h5> In Silverlight, MEF developers propose to use the <code>CompositionInitializer</code> class (the System.ComponentModel.CompositionInitialization.dll library), which allows you to create a composition for a specific object, initializing all imports of this object and other dependent entities.  This functionality is especially important for Silverlight applications, where the decentralization of the component elements of an application is particularly pronounced. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first call to the <code>SatisfyImports()</code> method of this class creates a global container that will be used in all further calls to <code>SatisfyImports()</code> .  <code>SatisfyImports</code> produces a composition of all objects that are found in the current assembly and all dependent assemblies (that is, within the entire XAP file).  Objects instantiated during composition will be in the container until the latter is destroyed, i.e.  until the end of the program. <br><br>  There are several features of using this class: <ol><li>  Classes that call the <code>SatisfyImports()</code> method cannot have the <code>[Export]</code> attribute; </li><li>  Objects are instantiated only once and stored in a container; </li><li>  By default, only the current XAP file is subject to composition, which is easy to fix. </li></ol>  <i>Example:</i> <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> Shell : UserControl&lt;br&gt;{&lt;br&gt; <font color="#0000ff">public</font> MainPage()&lt;br&gt; {&lt;br&gt;  ComposeContainer()&lt;br&gt; }&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> ComposeContainer()&lt;br&gt; {&lt;br&gt;  CompositionInitializer.SatisfyImports( <font color="#0000ff">this</font> );&lt;br&gt; }&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <h5>  DeploymentCatalog </h5>  This class is designed to dynamically download XAP files, which allows you to even more decentralize development, reduce the size of the main XAP file, increase the download speed of the application, etc. XAP files are loaded in asynchronous mode, and the developer can subscribe to a notification that the file has finished downloading and handle errors if they exist. <br><br>  This class is part of the idea of ‚Äã‚Äãrecomposition (re-composing a composition from existing and added parts), carrying out the latter, if there are parts that allow recomposition. <br><br>  Features of using <code>DeploymentCatalog</code> : <ol><li>  The browser cache is used when the application is offline. </li><li>  The <code>CompositionHost</code> class must be used (see below). </li><li>  If there are identical assemblies in different XAP files, <code>DeploymentCatalog</code> will try to add them all to the catalog, which can lead to an exception (exception) if recomposition is not allowed.  You should set <code>CopyLocal=False</code> to duplicate assemblies of the entire application or use my extension for VS2010 <a href="http://habrahabr.ru/blogs/silverlight/98939/">XapsMinifier</a> </li><li>  Only the assemblies that are specified in the manifest file are loaded from the XAP directory. </li><li>  In Out of Browser mode, downloadable assemblies are not cached in the file system. </li></ol>  <i>Example:</i> <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">void</font> CancelLoading()&lt;br&gt;{&lt;br&gt; catalog.CancelAsync();&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> LoadXapFile( <font color="#0000ff">string</font> xapPath)&lt;br&gt;{&lt;br&gt; DeploymentCatalog catalog = <font color="#0000ff">new</font> DeploymentCatalog(xapPath);&lt;br&gt; catalog.DownloadCompleted += <font color="#0000ff">new</font> EventHandler&lt;AsyncCompletedEventArgs&gt;(DownloadCompleted);&lt;br&gt; catalog.DownloadProgressChanged += <font color="#0000ff">new</font> EventHandler&lt;DownloadProgressChangedEventArgs&gt;(ProgressChanged);&lt;br&gt; catalog.DownloadAsync();&lt;br&gt; _aggregateCatalog.Catalogs.Add(catalog);&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">void</font> DownloadCompleted( <font color="#0000ff">object</font> sender, System.ComponentModel.AsyncCompletedEventArgs e)&lt;br&gt;{&lt;br&gt; <font color="#0000ff">if</font> (e.Error != <font color="#0000ff">null</font> )&lt;br&gt; <font color="#0000ff">throw</font> e.Error;&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">void</font> catalog_DownloadProgressChanged( <font color="#0000ff">object</font> sender, DownloadProgressChangedEventArgs e)&lt;br&gt;{&lt;br&gt; <font color="#0000ff">int</font> progress = e.ProgressPercentage;&lt;br&gt; <font color="#0000ff">long</font> received = e.BytesReceived;&lt;br&gt; <font color="#0000ff">long</font> total = e.TotalBytesToReceive;&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <h5>  Compositionhost </h5>  This class is the link between the directories that contain information on the export / import of parts, and the container that contains the composition of parts.  This class allows you to override the initial configuration of the application (loading parts only from the current XAP file).  It allows you to specify a set of directories, the contents of which will be tracked, and in case of a change (add / delete), the recomposition of existing parts will be called. <br><br>  <i>Example:</i> <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> Shell : UserControl&lt;br&gt;{&lt;br&gt; <font color="#0000ff">public</font> MainPage()&lt;br&gt; {&lt;br&gt;  ComposeContainer()&lt;br&gt; }&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> ComposeContainer()&lt;br&gt; {&lt;br&gt;  _aggregateCatalog = <font color="#0000ff">new</font> AggregateCatalog( <font color="#0000ff">new</font> DeploymentCatalog());&lt;br&gt;  CompositionHost.Initialize(_aggregateCatalog);&lt;br&gt;  CompositionInitializer.SatisfyImports( <font color="#0000ff">this</font> );&lt;br&gt; }&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <h5>  ExportFactory &lt;T&gt; </h5>  In some situations, you need to create multiple instances of the composition elements.  For example, if the application allows the user to create several copies of documents (elements of the composition), then this cannot be achieved by conventional means.  Take advantage of ExportFactory &lt;T&gt;. <br><br>  <i>Example:</i> <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[Export]&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">class</font> DocumentViewModel {&lt;br&gt;&lt;br&gt; [Import] &lt;br&gt; <font color="#0000ff">public</font> ExportFactory&lt;IDocument&gt; DocumentFactory&lt;br&gt; {&lt;br&gt; <font color="#0000ff">get</font> ;&lt;br&gt; <font color="#0000ff">set</font> ;&lt;br&gt; }&lt;br&gt;&lt;br&gt; <font color="#0000ff">protected</font> <font color="#2B91AF">List</font> &lt;IDocument&gt; Documents&lt;br&gt; {&lt;br&gt; <font color="#0000ff">get</font> ;&lt;br&gt; <font color="#0000ff">set</font> ;&lt;br&gt; }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">void</font> CreateDocument() &lt;br&gt; {&lt;br&gt;    Documents.Add(DocumentFactory.CreateExport().Value);&lt;br&gt; }&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Creating parts of the composition using ExportFactory &lt;T&gt;, the developer takes full responsibility for the lifetime of the created instance.  If instances require freeing memory, then you can use the standard <code>Dispose()</code> pattern. <br><br>  <i>Example:</i> <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[Export]&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">class</font> DocumentViewModel : IDisposable &lt;br&gt;{&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">bool</font> isDisposed = <font color="#0000ff">false</font> ;&lt;br&gt; [Import] &lt;br&gt; <font color="#0000ff">public</font> ExportFactory&lt;IDocument&gt; DocumentFactory&lt;br&gt; {&lt;br&gt; <font color="#0000ff">get</font> ;&lt;br&gt; <font color="#0000ff">set</font> ;&lt;br&gt; }&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#2B91AF">List</font> &lt;ExportLifetimeContext&lt;IDocument&gt;&gt; ExportLifeTimeContextList&lt;br&gt; {&lt;br&gt; <font color="#0000ff">get</font> ;&lt;br&gt; <font color="#0000ff">set</font> ;&lt;br&gt; }&lt;br&gt;&lt;br&gt; <font color="#0000ff">protected</font> <font color="#2B91AF">List</font> &lt;IDocument&gt; Documents&lt;br&gt; {&lt;br&gt; <font color="#0000ff">get</font> ;&lt;br&gt; <font color="#0000ff">set</font> ;&lt;br&gt; }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">void</font> CreateDocument() &lt;br&gt; {&lt;br&gt;    ExportLifetimeContext&lt;IDocument&gt; LifeTimeContext = DocumentFactory.CreateExport();&lt;br&gt;    ExportListLifeTimeContext.Add(LifeTimeContext);&lt;br&gt;    Documents.Add(LifeTimeContext.Value);&lt;br&gt; }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">void</font> Dispose()&lt;br&gt; {&lt;br&gt;    Dispose( <font color="#0000ff">true</font> );&lt;br&gt;    GC.SuppressFinalize( <font color="#0000ff">this</font> );&lt;br&gt; }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">void</font> Dispose( <font color="#0000ff">bool</font> disposing)&lt;br&gt; {&lt;br&gt; <font color="#0000ff">if</font> (isDisposed)&lt;br&gt; <font color="#0000ff">return</font> ;&lt;br&gt;&lt;br&gt; <font color="#0000ff">if</font> (disposing)&lt;br&gt;    {&lt;br&gt; <font color="#0000ff">foreach</font> (IDisposable d <font color="#0000ff">in</font> ExportLifeTimeContextList)&lt;br&gt;        d.Dispose();&lt;br&gt;    }&lt;br&gt;    &lt;br&gt;    isDisposed = <font color="#0000ff">true</font> ;&lt;br&gt; }&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <h4>  An example of the implementation of the mechanism of recomposition </h4>  As an example, which reflects the simplicity and power of using MEF in Silverlight applications, I chose the implementation of support for visual themes (Themes) for application controls. <br><br>  The application must meet the following requirements: <ol><li>  Maintain threads </li><li>  Have the ability to download third-party XAP files with themes </li><li>  Downloading an XAP file should update the list of available topics (recomposition) </li><li>  The choice of topic should lead to a change in the appearance of controls. </li></ol><h5>  Supporting those </h5>  To implement support for the themes, I turned to a published <a href="http://go.microsoft.com/fwlink/%3FLinkId%3D192411">project</a> that provides several ready-made sets of themes.  From these projects I use xaml files with themes for basic controls. <br><br>  Each topic is located in a separate assembly of a separate XAP file.  Themes themselves are stored as resources and retrieved upon request. <br><br>  As a mechanism for accessing topics, a class that implements the <code>IThemeLoader</code> interface is <code>IThemeLoader</code> .  This class is able to extract the required resources and contains the name of the topic. <br><br>  <i>Example:</i> <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[InheritedExport]&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">interface</font> IThemeLoader&lt;br&gt;{&lt;br&gt; <font color="#0000ff">string</font> Name&lt;br&gt;  {&lt;br&gt; <font color="#0000ff">get</font> ;&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#2B91AF">IEnumerable</font> &lt;ResourceDictionary&gt; Resources&lt;br&gt;  {&lt;br&gt; <font color="#0000ff">get</font> ;&lt;br&gt;  }&lt;br&gt;&lt;br&gt;}&lt;br&gt;&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">class</font> ThemeLoader : ThemeLoaderBase&lt;br&gt;{&lt;br&gt;&lt;br&gt; <font color="#0000ff">#region</font> IThemeLoader Members&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> Name&lt;br&gt;  {&lt;br&gt; <font color="#0000ff">get</font> &lt;br&gt;    {&lt;br&gt; <font color="#0000ff">return</font> <font color="#A31515">"Accent"</font> ;&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#2B91AF">IEnumerable</font> &lt;ResourceDictionary&gt; Resources&lt;br&gt;  {&lt;br&gt; <font color="#0000ff">get</font> &lt;br&gt;    {&lt;br&gt; <font color="#0000ff">yield</font> <font color="#0000ff">return</font> LoadResourceDictionary( <font color="#A31515">"/SLandMEFdevcamp.AccentTheme;component/Style.xaml"</font> );&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">#endregion</font> &lt;br&gt;  &lt;br&gt; <font color="#008000">/*</font> &lt;br&gt; <font color="#008000">protected virtual ResourceDictionary LoadResourceDictionary(string uri)</font> &lt;br&gt; <font color="#008000">{</font> &lt;br&gt; <font color="#008000">return new ResourceDictionary</font> &lt;br&gt; <font color="#008000">{</font> &lt;br&gt; <font color="#008000">Source = new Uri(uri, UriKind.Relative)</font> &lt;br&gt; <font color="#008000">};</font> &lt;br&gt; <font color="#008000">}</font> &lt;br&gt; <font color="#008000">*/</font> &lt;br&gt;}&lt;br&gt;</font> &lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  The attribute <code>InheritedExport</code> indicates that all implementations of the interface marked with this attribute should be exported. <br><br><h5>  Downloading third-party XAP files </h5>  To support third-party XAP files, I place the input field of the XAP file address and the start button on the main form of the application.  Downloading is done using <code>DeploymentCabinet</code> , which initiates a recomposition. <br><br>  As soon as the recomposition has occurred, the list of implementations of <code>IThemeLoader</code> will be <code>IThemeLoader</code> and a new list of available themes will be displayed on the UI. <br><br>  <i>Example:</i> <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> AggregateCatalog _aggregateCatalog = <font color="#0000ff">null</font> ;&lt;br&gt; <font color="#0000ff">private</font> <font color="#2B91AF">IEnumerable</font> &lt;IThemeLoader&gt; themesLoaders;&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> ComposeContainer()&lt;br&gt;{&lt;br&gt;  _aggregateCatalog = <font color="#0000ff">new</font> AggregateCatalog( <font color="#0000ff">new</font> DeploymentCatalog());&lt;br&gt;  CompositionHost.Initialize(_aggregateCatalog);&lt;br&gt;  CompositionInitializer.SatisfyImports( <font color="#0000ff">this</font> );&lt;br&gt;}&lt;br&gt;&lt;br&gt;[ImportMany(AllowRecomposition = <font color="#0000ff">true</font> )]&lt;br&gt; <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;IThemeLoader&gt; ThemesLoaders&lt;br&gt;{&lt;br&gt; <font color="#0000ff">get</font> &lt;br&gt;  {&lt;br&gt; <font color="#0000ff">return</font> themesLoaders;&lt;br&gt;  }&lt;br&gt; <font color="#0000ff">set</font> &lt;br&gt;  {&lt;br&gt;    themesLoaders = <font color="#0000ff">value</font> ;&lt;br&gt;    RaisePropertyChanged( <font color="#A31515">"ThemesLoaders"</font> );&lt;br&gt;  }&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> IThemeLoader theme;&lt;br&gt; <font color="#0000ff">public</font> IThemeLoader Theme&lt;br&gt;{&lt;br&gt; <font color="#0000ff">get</font> &lt;br&gt;  {&lt;br&gt; <font color="#0000ff">return</font> theme;&lt;br&gt;  }&lt;br&gt; <font color="#0000ff">set</font> &lt;br&gt;  {&lt;br&gt;    theme = <font color="#0000ff">value</font> ;&lt;br&gt;    LoadTheme( <font color="#0000ff">value</font> );&lt;br&gt;    RaisePropertyChanged( <font color="#A31515">"Theme"</font> );&lt;br&gt;  }&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> LoadTheme(IThemeLoader themeLoader)&lt;br&gt;{&lt;br&gt; <font color="#0000ff">if</font> (themeLoader.Resources == <font color="#0000ff">null</font> || !themeLoader.Resources.Any())&lt;br&gt; <font color="#0000ff">return</font> ;&lt;br&gt;&lt;br&gt;  App.Current.Resources.MergedDictionaries.Clear();&lt;br&gt;&lt;br&gt; <font color="#0000ff">foreach</font> ( <font color="#0000ff">var</font> resourceDict <font color="#0000ff">in</font> themeLoader.Resources)&lt;br&gt;    App.Current.Resources.MergedDictionaries.Add(resourceDict);&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> Button_Click( <font color="#0000ff">object</font> sender, System.Windows.RoutedEventArgs e)&lt;br&gt;{&lt;br&gt;  DeploymentCatalog catalog = <font color="#0000ff">new</font> DeploymentCatalog(XapUrlTextBox.Text);&lt;br&gt;  catalog.DownloadAsync();&lt;br&gt;&lt;br&gt;  _aggregateCatalog.Catalogs.Add(catalog);&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  In this case, XAP files with themes are located in the same folder as the main XAP file, and therefore you can specify only the name of the XAP file without a full url.  For example, SLandMEFdevcamp.AccentTheme.xap, SLandMEFdevcamp.Win7Theme.xap. <br><br>  The logic of this code is as follows: <ul><li>  When creating a form, the container is initialized ( <code>ComposeContainer()</code> ) </li><li>  The user enters the address of the XAP file in the <code>XapUrlTextBox</code> field and presses the download button.  Loading the XAP file results in adding a new implementation of <code>IThemeLoader</code> to the directory and recommending the ThemesLoaders property, which is associated with the <code>ListBox</code> element on the form </li><li>  If the user selects any <code>ListBox</code> element, a change in the Theme property is generated, which causes the <code>LoadTheme()</code> method to be <code>LoadTheme()</code> </li><li>  The <code>LoadTheme()</code> method removes all existing resources and adds resources for the topic the user has selected. </li></ul>  The results of the program can be seen here. <img src="https://habrastorage.org/storage/cec95219/2e90f590/14221a4a/0f458476.jpg"><br><br><h4>  Conclusion </h4>  MEF has a large number of advantages, among which are recompositions, the absence of a strictly defined place in which parts of the composition should be registered, etc. <br><br>  MEF for Silverlight has additional features that are not available even in the desktop version, allowing you to build even more flexible programs. <br><br>  Possibilities of recomposing allow you to change the set of components right during the program operation, which is very important for those cases when dynamic connection / disconnection of functionality, working modules, etc. is required. <br><br><h4>  Project source code </h4>  Source code can be downloaded <a href="">here</a> . <br><br>  <b>Upd:</b> The <code>ExportFactory&lt;T&gt;</code> class has <code>ExportFactory&lt;T&gt;</code> added to the desktop version of the library in <a href="http://mef.codeplex.com/releases/view/53792">MEF 2 Preview 2</a> . </div><p>Source: <a href="https://habr.com/ru/post/106486/">https://habr.com/ru/post/106486/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../106479/index.html">Beeline-wired-Internet came to the entrance</a></li>
<li><a href="../106481/index.html">60% of Apple's revenue comes from products that 3 years ago did not exist</a></li>
<li><a href="../106483/index.html">Upgrade line. Meet Google Chrome 7 Stable</a></li>
<li><a href="../106484/index.html">I'm going to Peter (general reflections on a private topic)</a></li>
<li><a href="../106485/index.html">Chrome 7.0.517.41 (stable)</a></li>
<li><a href="../106488/index.html">IPv4 addresses will end at the beginning of 2011</a></li>
<li><a href="../106489/index.html">Steve Jobs accuses Android of "fragmentation"</a></li>
<li><a href="../106490/index.html">The attackers turned Kaspersky offsite into a hotbed of infection</a></li>
<li><a href="../106491/index.html">Progress Success v1.1 released</a></li>
<li><a href="../106492/index.html">Linux Mint 10 Julia in the pre-release stage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>