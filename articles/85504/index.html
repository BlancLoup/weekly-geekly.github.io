<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Convert an interface reference to implement a class in Delphi 2010</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not all innovations in Delphi 2010 are big and noticeable. The team spent a lot of time implementing a lot of additional functionality, fixes and impr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Convert an interface reference to implement a class in Delphi 2010</h1><div class="post__text post__text-html js-mediator-article">  Not all innovations in Delphi 2010 are big and noticeable.  The team spent a lot of time implementing a lot of additional functionality, fixes and improvements.  Some of them may seem insignificant separately, but they not only generally have a significant impact, but also significantly add harmony to the product. <br><img src="https://habrastorage.org/getpro/habr/post_images/4d1/f3a/2ff/4d1f3a2ffc0ea39edac1cae929dda30c.jpg" align="left"><br>  One of the features of Delphi 2010, which, I think, will create a lot of controversy is the ability to bring the interface link back to the type of class that implements this interface. <br><a name="habracut"></a><br>  Let's imagine that we have an <i>IMyInterface</i> interface and a <i>TMyClass</i> class that implements this interface: <br><br><blockquote><code><font color="black">IMyInterface = <font color="#0000ff">interface</font> <br> [ <font color="#A31515">'{7AD04980-5869-4C93-AC29-C26134511554}'</font> ] <br> procedure Foo; <br> end; <br> <br> TMyClass = <font color="#0000ff">class</font> (TInterfacedObject, IMyInterface) <br> procedure Foo; <br> procedure Bar; <br> end; <br></font></code> </blockquote><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e7f/019/715/e7f019715fecf907c1aa375ddc7c16e2.jpg" align="left">  Next, let's imagine that we were given a variable of type <i>IMyInterface</i> .  What happens if we want to call <i>Bar</i> ?  Attempting to simply cast the interface reference to the <i>TMyClass</i> type will result in a compiler error. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>The most common solution I've seen is to include in the interface a method that returns the class type,</b> but it destroys the value of putting the interface in the first place, binding the interface to a specific implementation.  Moreover, it is disgusting. <br><br>  <i>Such techniques are no longer needed.</i> <br><br>  In Delphi 2010, you can use the <i>is</i> operator to check whether the interface is implemented by a particular class, and if so, bring it to this class and use non-interface methods, properties, etc. <br><br>  Moreover, if you try to cast the interface reference to a class type from which it was not actually obtained, the as operator will throw an <i>EInvalidCast</i> exception.  Under the same conditions, a hard type conversion will return <i>nil</i> . <br><br>  <b>Now this code runs successfully:</b> <br><blockquote> <code><font color="black"><font color="#0000ff">if</font> MyInterface <font color="#0000ff">is</font> TMyClass then <br> TMyClass(MyInterface).Bar;</font></code> </blockquote> <br><br>  Of course, this should be used with understanding.  For example, the usual compiler warnings about saving the interface with reference counting and object references without counting the references to the same instance remain valid. <br><br><hr><br>  <b>You can help improve the translation.</b> <br>  <a href="http://translated.by/you/casting-an-interface-reference-to-the-implementing-class-in-delphi-2010/into-ru/">translated.by/you/casting-an-interface-reference-to-the-implementing-class-in-delphi-2010/into-ru</a> <br>  Translators: <a href="https://habrahabr.ru/users/r3code/" class="user_link">r3code</a> , <a href="https://habrahabr.ru/users/debose/" class="user_link">debose</a> , <a href="http://translated.by/VesninAndrey/">VesninAndrey</a> </div><p>Source: <a href="https://habr.com/ru/post/85504/">https://habr.com/ru/post/85504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../85489/index.html">The qualities of a successful entrepreneur - Diligence (6/11)</a></li>
<li><a href="../85498/index.html">Startup Crash Test 11.0 will be held in Kiev on Friday</a></li>
<li><a href="../85499/index.html">Underwater world of the Internet [continued] or how to dim optics in the Russian territorial waters</a></li>
<li><a href="../85502/index.html">Is there a future for online education?</a></li>
<li><a href="../85503/index.html">Attribute Refactoring Support in Delphi 2010</a></li>
<li><a href="../85505/index.html">How software is sold in Russia</a></li>
<li><a href="../85507/index.html">Lotus knows ...</a></li>
<li><a href="../85508/index.html">Cleankeys Touch Sensitive: Cleanest Keyboard</a></li>
<li><a href="../85509/index.html">Briefly about RTTI and attributes in Delphi 2010</a></li>
<li><a href="../85512/index.html">According to the observations of bloggers, strict censorship slowly appears in LiveJournal.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>