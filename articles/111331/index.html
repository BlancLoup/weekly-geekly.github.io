<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rake tutorial</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Rake is a tool for automating the assembly of software code written in Ruby, similar to tools like make, Ant or Phing. Although between them there is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rake tutorial</h1><div class="post__text post__text-html js-mediator-article">  Rake is a tool for automating the assembly of software code written in Ruby, similar to tools like make, Ant or Phing.  Although between them there is a huge difference.  Unlike other tools, Rake does not provide external DSL (for example, an XML assembly file in Ant).  Instead, all tasks are described in pure Ruby.  This way you get full flexibility and can use the useful features of Ruby. <br><br><a name="habracut"></a><h5>  What are build tools? </h5><br>  If you have ever tried to install software from source codes on a Linux or Unix system, there is a high probability that you have to deal with make.  The installation process usually looks the same.  First you go to the directory with already unpacked source codes, then enter the following commands: <br><br> <code>./configure <br> make <br> make install <br></code> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The second and third lines are just a call to the make program.  First of all, when running, make looks for a Makefile.  It contains information about source codes and dependencies between them.  make sorts the topological dependencies and tries to solve them in the proper order.  It looks like this: first, the developer indicates the dependencies, and the build tool is responsible for processing them.  make also saves time.  If the source code has not changed since the last compilation, it will not be processed again, as this will be a complete loss of time.  Build tools can be used not only to compile code, although this is their main task.  In general, build tools are used to automate tedious and repetitive tasks. <br><br><h5>  Differences between Rake and the rest of the build tools. </h5><br>  As I said, there is one significant difference between Rake and other tools for building.  Instead of writing a Makefile for make and build.xml for Ant and Phing, you simply write Ruby code.  You will not have to master the syntax of new build tools if you decide to replace one tool with another. <br>  But theory is not enough, let's move on to practice. <br><br><h5>  Install Rake </h5><br>  Installing rake is easy enough, provided that you have Ruby gems on your computer.  To install rake, enter the following commands: <br><br> <code>gem install rake <br></code> <br><br>  In most cases, you may need administrator privileges, so either go to the administrator username or use the sudo prefix. <br><br> <code>sudo gem install rake <br></code> <br><br>  After the rake gem is installed, we can write our first example. <br><br><h5>  First Rake Example </h5><br>  The easiest way to define a Rake task is to write the following Ruby code: <br><br> <code>task :default do <br> puts "Hello World!" <br> end <br></code> <br><br>  Rake tasks should always be in a file named Rakefile, Rakefile, rakefile.rb, or Rakefile.rb.  The first two forms are used most often.  After the Rakefile is saved, go to the folder with this file and run the following command: <br><br> <code>$ rake <br> (in /home/lukasz/ruby/rake_examples) <br> Hello World! <br></code> <br><br>  The first rake task works fine. <br><br>  So what really happened?  When receiving our Rakefile, Rake looks for tasks in it that are simply calls to the task method.  There can be many tasks in one Rakefile.  When you run the file, you can transfer the name of the task you want to perform.  If the task is not transferred, rake searches for the default task.  That is why our Rake call did its job without querying for any additional parameters. <br><br>  Let's try adding many tasks to one Rakefile: <br><br> <code>task :ring do <br> puts "Bell is ringing." <br> end <br> <br> task :enter do <br> puts "Entering home!" <br> end <br></code> <br><br>  If we try to run the rake command without any parameters, we get an error: <br><br> <code>$ rake <br> (in /home/lukasz/ruby/rake_examples) <br> rake aborted! <br> Don't know how to build task 'default' <br> <br> (See full trace by running task with --trace) <br></code> <br><br>  There is no default task in this file, so we must explicitly give them the name of the task: <br><br> <code>$ rake enter <br> (in /home/lukasz/rake_examples) <br> Entering home! <br> $ rake ring <br> (in /home/lukasz/rake_examples) <br> Bell is ringing. <br></code> <br><br>  At first glance, our example works fine, but still an error has crept into the code, namely, we cannot enter the house without ringing the door.  This is where the dependencies begin. <br><br><h5>  Add dependencies </h5><br>  Let's modify our file a bit: <br><br> <code>task :ring do <br> puts "Bell is ringing." <br> end <br> <br> task :enter =&gt; :ring do <br> puts "Entering home!" <br> end <br></code> <br><br>  Now, when you want to enter the house, the doorbell will first ring: <br><br> <code>$ rake enter <br> (in /home/lukasz/ruby/rake_examples) <br> Bell is ringing. <br> Entering home! <br></code> <br><br>  Now Rake is responsible for the doorbell before entering.  You can declare more complex dependencies and Rake will be responsible for solving them.  You just specify everything you want and rake does all the tedious work for you. <br><br>  The good news is that the dependency can be indicated not only when defining the task, but also later, depending on the fulfillment of the conditions of time.  After all, we write tasks in the Ruby programming language, not a static XML file, remember? <br><br>  To achieve the same effect with the doorbell, we can write: <br><br> <code>task :ring do <br> puts "Bell is ringing." <br> end <br> <br> task :enter do <br> puts "Entering home!" <br> end <br> <br> task :enter =&gt; :ring <br></code> <br><br>  And the effect will be the same. <br><br><h5>  Description of the task. </h5><br>  Each task you write can be described with a few simple words.  The description will serve you not only as a built-in comment, but also appear in the list of available tasks.  Let's add descriptions: <br><br> <code>desc 'Ring the bell' <br> task :ring do <br> puts "Bell is ringing." <br> end <br> <br> desc 'Enter home' <br> task :enter =&gt; :ring do <br> puts "Entering home!" <br> end <br></code> <br><br>  To see the list of available tasks, run rake with the -T or --tasks option: <br><br> <code>$ rake -T <br> (in /home/lukasz/ruby/rake_examples) <br> rake enter # Enter home <br> rake ring # Ring the bell <br></code> <br><br>  As I said, the build tools were made to simplify the compilation of the project.  There's a lot <br>  dependencies between individual files and rake, as well as many build tools, support this.  This allows you to define a special type of tasks -a file task: <br><br> <code>file 'products.sql' =&gt; 'products.xml' do <br> # build SQL INSERT clause and save it in products.sql file, <br> # basing on products.xml datafile <br> end <br></code> <br><br>  File task - in general - no different from regular tasks.  The fact is that it will not work if the input file (products.xml in this case) does not exist.  It will also not work if the result file (products.sql) is not older than the input file.  If this behavior does not suit you, then you need to overwrite the output file each time you start a task, use regular tasks. <br><br><h5>  Fileutils </h5><br><br>  Rake includes a Fileutil module that provides many Unix-like methods, including mkdir, rmdir, cp, chmod, and touch. <br>  Since the Fileutils module is already enabled, you can call these methods directly, without using operator frames. <br><br> <code>task :manipulate_files do <br> mkdir 'new_dir' <br> mv 'new_dir', 'lukasz' <br> chmod 0777, 'lukasz' <br> touch 'lukasz/wrobel.txt' <br> rm_rf 'lukasz' <br> end <br></code> <br><br>  If you are familiar with the Linux / Unix command shell, you will learn this module in a very short time. <br>  By the way, remember the problem files?  If the output file is not older than the input file, the task file will not work.  In case you want to perform such a check in regular tasks, you can use the Fileutils method, which is called uptodate. <br><br> <code>task :check do <br> # ... <br> <br> unless uptodate?(output_file, input_file) <br> # regenerate output_file <br> end <br> end <br></code> <br><br><h5>  Filelist </h5><br>  Imagine a task file where many input files are combined to get a single output file.  The most obvious way to determine the dependencies between files is: <br><br> <code>one_file_to_rule_them_all = 'database.sql' <br> tables_sql = ['orders.sql', 'payments.sql', 'categories.sql'] <br> <br> file one_file_to_rule_them_all =&gt; tables_sql <br></code> <br><br>  This will work, but what if we create another SQL input file?  We must remember to add it to our list. <br><br>  I do not know about you, but I'm a little confused.  As already mentioned, build tools have been developed to automate boring and repetitive tasks.  And adding files to our list is a boring task.  Fortunately, the author Rake also knew about it. <br><br>  There is a FileList class that can be useful in such situations.  Let's use it now: <br><br> <code>one_file_to_rule_them_all = 'database.sql' <br> <br> FileList['*.sql'].each {|table| file one_file_to_rule_them_all =&gt; table} <br></code> <br><br>  Forget about adding each individual SQL file to the list.  Rake will do it for you. <br><br><h5>  annotation </h5><br>  There are a huge number of Rake functions that were not covered in this explanation, for example, clean, clobber, rdoc and gem tasks, pathmap, rules and namespaces.  You will have a chance to find out about them later. <br>  I hope this article will be a good starting point to get an idea about Rake.  Rake has proven its worth and is now widely used in the Ruby world, so writing Rake tasks is an essential skill.  Good luck in your own experiments with Rake. <br><br>  PS The original article can be read <a href="http://lukaszwrobel.pl/blog/rake-tutorial">here.</a> </div><p>Source: <a href="https://habr.com/ru/post/111331/">https://habr.com/ru/post/111331/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111325/index.html">Angry Birds - now for Windows</a></li>
<li><a href="../111327/index.html">Electronic documentation in schools (ACS RNO)</a></li>
<li><a href="../111328/index.html">Two beauties</a></li>
<li><a href="../111329/index.html">Computer in the car "cheap" or CarPC "Siberian"</a></li>
<li><a href="../111330/index.html">Removing .NET programs from registration using the example of BEM</a></li>
<li><a href="../111332/index.html">The emulator of the game "life" in the GLSL language</a></li>
<li><a href="../111333/index.html">Electronic forms via Microsoft InfoPath</a></li>
<li><a href="../111336/index.html">Anti-interference coding using various codes</a></li>
<li><a href="../111338/index.html">Online cinema</a></li>
<li><a href="../111339/index.html">Screenshot of a video player without black holes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>