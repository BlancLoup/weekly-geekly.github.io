<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Statistics from the Android application on your GAE site</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Android, Google Analytics, App Engine - products of one company. It would seem - what could be easier than to show data from one product to another? F...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Statistics from the Android application on your GAE site</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/8ad/c73/cb2/8adc73cb2abc6b8c5fa8e2aafc7c1d57.png"><br><br>  Android, Google Analytics, App Engine - products of one company.  It would seem - what could be easier than to show data from one product to another?  For example, Google Analytics statistics from an Android application on the App Engine website?  It turned out that to make it really easy.  Only not all steps are obvious. <br><a name="habracut"></a><br>  In this article I will try to tell in steps how to achieve the desired.  The part concerning the transfer of data from the Android application to Google Analytics is deliberately omitted, because  does not contain <a href="https://developers.google.com/analytics/devguides/collection/android/v4/">any difficulties</a> . <br><br><h4>  Step 1. Access </h4><br><ol><li>  In order for your GAE application (website) to use data from Google Analytics, you need to enable the Analytics API in the APIs section of <a href="https://console.developers.google.com/project/apps~%253Cyour-app-id%253E/apiui/api">your project</a> in the <a href="https://console.developers.google.com/project">Google Developers Console</a> .  If necessary, you can immediately set your limits (quotas) for using the Analytics API. </li><li>  In Google Analytics itself, in the User Management section, you must give Read and Analysis rights to the service user - <i>your-app-id@appspot.gserviceaccount.com</i> .  It is under this user that we will request information from Google Analytics.  Fortunately, data from Google Analytics (unlike some other Google services, for example, Google Play Services) can be obtained under the service user.  Using a regular (non-service) user would require additional steps for oauth authorization. </li><li>  In order to be able to test your code locally, without uploading to Google servers, you need to create another service user.  Detailed instructions on how to create and use it are given in <a href="http://stackoverflow.com/questions/20349189/unable-to-access-bigquery-from-local-app-engine-development-server/22723127">response</a> to StackOverflow.  <i>your-app-id@appspot.gserviceaccount.com</i> works only in a combat environment. </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Step 2. Libraries and Tools </h4><br><ol><li>  To simplify access to the Analytics API, download the <a href="https://code.google.com/p/google-api-python-client/">Google API Python Client for GAE</a> (if you use Python).  Of course, we need exactly the version for GAE.  Documentation for this library is <a href="https://code.google.com/p/google-api-python-client/wiki/GoogleAppEngine">here</a> . </li><li>  To test <a href="https://developers.google.com/analytics/devguides/reporting/core/v3/">queries</a> to Google Analytics, you can use <a href="http://ga-dev-tools.appspot.com/explorer/">Google Analytics Query Explorer 2</a> . </li></ol><br><br><h4>  Step 3. Data acquisition </h4><br>  Now, getting data from Google Analytics is quite simple - <pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> oauth2client.appengine <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppAssertionCredentials <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> apiclient.discovery <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> build <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> google.appengine.api <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> memcache <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> httplib2 credentials = AppAssertionCredentials(scope=<span class="hljs-string"><span class="hljs-string">'https://www.googleapis.com/auth/analytics.readonly'</span></span>) http = credentials.authorize(httplib2.Http(memcache)) service = build(<span class="hljs-string"><span class="hljs-string">'analytics'</span></span>, <span class="hljs-string"><span class="hljs-string">'v3'</span></span>, http=http) active_users = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> response = service.data().ga().get( ids=<span class="hljs-string"><span class="hljs-string">'ga:'</span></span>+profile_id, <span class="hljs-comment"><span class="hljs-comment">#        start_date='2014-03-03', end_date='2014-03-09', metrics='ga:visitors').execute() if response.get('rows'): active_users = int(response.get('rows')[0][0])</span></span></code> </pre> <br>  This code allows you to find out the number of active users in the application for a specified period of time. <br><br>  In my case, I request the necessary data from Google Analytics once a week, on Tuesdays (precisely on Tuesdays, because one additional day is set aside for transferring data from Android users to the Google Analytics server).  Data is stored in NDB, and the site is displayed using <a href="https://developers.google.com/chart/">Google Charts</a> . </div><p>Source: <a href="https://habr.com/ru/post/230591/">https://habr.com/ru/post/230591/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../230579/index.html">Crazy car, semi-legal TPM and liquid nitrogen: what is remembered by NeoQUEST-2014</a></li>
<li><a href="../230583/index.html">Experiment in Yandex. How to identify a cracker using machine learning</a></li>
<li><a href="../230585/index.html">As in the Magic Electrotechnical practice in Java has passed and a little about Lumia 710</a></li>
<li><a href="../230587/index.html">The most detailed geological map of Mars</a></li>
<li><a href="../230589/index.html">CSScomb 3.0: beautiful code with one team</a></li>
<li><a href="../230593/index.html">Gamers. Difference of interests</a></li>
<li><a href="../230595/index.html">ActivityRecognitionClient from the Google Play Services Library - "recognition of user actions"</a></li>
<li><a href="../230597/index.html">Juniper SRX: Site-to-Site IPSec VPN using SSL certificates</a></li>
<li><a href="../230601/index.html">Book about venus</a></li>
<li><a href="../230603/index.html">No worries, no hassle: What you need for successful store automation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>