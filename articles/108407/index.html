<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IEnumerable <T> and IQueryable <T>, what is the difference?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dear Habrovchane, I decided to share one not obvious point of using LinqToSql, which I encountered some time ago. Namely, about the features of using ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IEnumerable <T> and IQueryable <T>, what is the difference?</h1><div class="post__text post__text-html js-mediator-article">  Dear Habrovchane, I decided to share one not obvious point of using LinqToSql, which I encountered some time ago.  Namely, about the features of using cascading Linq queries: <br><br>  Working on another ASP.NET MVC project, and designing the level of access to the database, I needed to check the quality of the scripts generated by the L2C Framework. <br><br><h3>  What we have (simplified version of the model): </h3><br>  class User { <br>  public long Id {get;  set;  } <br>  public string Name {get;  set;  } <br>  public IEnumerable &lt;Parameter&gt; Parameters {get;  set;  } <br>  } 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      class Parameter { <br>  public long UserId {get;  set;  } <br>  public string Name {get;  set;  } <br>  public string Value {get;  set;  } <br>  } <br><br>  To get the data, the UserRepository class is written: <br><br>  class UserRepository: MyProjectDataContext { <br>  public IEnumerable GetUsers () { <br>  return this.Users.ToModelUsers (); <br>  } <br>  } <br><br>  static class RepositoryHelper { <br>  public static IEnumerable &lt;Model.User ToModelUsers (this IEnumerable &lt;DataAccess.User&gt; users) { <br>  return users.Select (u =&gt; new Model.User {Id = u.Id, Name = u.Name, Parameters = u.Parameters.ToModelParameters ()}); <br>  } <br><br>  public static IEnumerable &lt;Model.Parameter&gt; ToModelParameters (this IEnumerable &lt;DataAccess.Parameter&gt; parameters) { <br>  return parameters.Select (u =&gt; new Model.Parameter {...}); <br>  } <br>  } <br><br>  write <br>  var users = userRepository.GetUsers (). ToList (); <br><br>  We look at the profiler, and we are surprised to <b>find out that</b> <b>as many as 11 requests</b> were executed <b>for loading 10 users</b> and their parameters. <br><a name="habracut"></a><br>  I'm trying to cure this problem, changing the repository code for the following: <br><br>  public IEnumerable &lt;User&gt; GetUsers () { <br>  return this.Users.ToModelUsers (). Select (u =&gt; new Model.User { <br>  Id = u.Id, Name = u.Name, Parameters = u.Parameters.Select (p =&gt; new Model.Parameter {...}) <br>  }); <br>  } <br><br>  The picture changes dramatically.  Only 1 request in which both user and parameter parameters are loaded. <br><br><h3>  Where is the dog buried? </h3><br>  Everything is very simple, the whole thing is in the original version after calling the GetUsers method we received a request containing 2 different expressions: Linq2Sql and Linq2Object, and in the second only Linq2Sql. <br><br><h3>  And now the conclusions </h3><br>  As it turned out, Linq extensions behave quite differently when using a variable of type IEnumerable and IQueryable, and this is not accidental.  The fact is that the user.Select (...) method exists in both the System.Linq.Enumerable and System.Linq.Queryable classes, respectively, but the implementation is of course different (as can be easily seen with the Reflector). <br><br><h3>  What to do? </h3><br>  There are 2 ways, either specify the type IQueryable &lt;T&gt; for the return value <br><br>  static class RepositoryHelper { <br>  public static IQueryable &lt;Model.User&gt; ToModelUsers (this IQueryable &lt;DataAccess.User&gt; users) { <br>  return users.Select (u =&gt; new Model.User {Id = u.Id, Name = u.Name, Parameters = u.Parameters.ToModelParameters ()}); <br>  } <br>  } <br><br>  or explicitly cast IEnumerable &lt;T&gt; to IQueryable &lt;T&gt; by calling the method .AsQueryable &lt;T&gt; () <br><br>  And the most important thing is to remain attentive and not forget what is hidden behind the syntactic sugar of features .Net 3.5 / 4.0 </div><p>Source: <a href="https://habr.com/ru/post/108407/">https://habr.com/ru/post/108407/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../108402/index.html">Kaspersky code leak - now in public</a></li>
<li><a href="../108403/index.html">Launched the world's first 100 Gbit / s commercial highway</a></li>
<li><a href="../108404/index.html">"Steel Tambourine" Ukrainian Conference of System Administrators (continued)</a></li>
<li><a href="../108405/index.html">Principles of organization of work with remote employees</a></li>
<li><a href="../108406/index.html">Start-up tournament Harvest (registration is open!)</a></li>
<li><a href="../108409/index.html">Simulator from Megaphone</a></li>
<li><a href="../108410/index.html">Let's meet!</a></li>
<li><a href="../108411/index.html">Translation "1C: Chronograph School" on the ACT</a></li>
<li><a href="../108412/index.html">Swedes are going to arrest the head of WikiLeaks</a></li>
<li><a href="../108414/index.html">Dobroknizhka about HTML5 from Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>