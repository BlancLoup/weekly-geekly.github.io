<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bounty program in Badoo</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, many IT companies have their own bounty programs (or vulnerability scan programs). Badoo - among them. 

 In this article I will talk about how...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bounty program in Badoo</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/3e3/f7e/033/3e3f7e033f0c43aea5abdce3735049d0.png" alt="image"></div><br><br>  Today, many IT companies have their own bounty programs (or vulnerability scan programs).  Badoo - among them. <br><br>  In this article I will talk about how we, without having an information security department, launched and run our bounty program.  I will talk about the problems that we faced, how they were solved and how they came to what we now have.  And, of course, I will mention some interesting bugs sent by the participants of this program. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Three years have passed since the start of our bounty program.  We still continue to send messages to participants from around the world. <br><br>  We want to increase interest in it, including from foreign researchers.  Therefore, we, firstly, opened the page with our program on the largest portal of researchers <a href="https://hackerone.com/badoo">hackerone.com</a> , and secondly - increased the amount of rewards for the found vulnerabilities!  Now the amount of remuneration, depending on the category, starts from <b>¬£ 100</b> and can reach <b>¬£ 1000</b> , the amount of the super premium is <b>¬£ 2000</b> (which is more than 200,000 rubles at the current rate!) And even more if the detected vulnerability represents a real threat to our users. <br><br><a name="habracut"></a><br><br>  Badoo is the world's largest dating service.  Here you can meet your love, make new friends or just find interlocutors who are nearby. <br><br>  Today, Badoo has over 300 million registered users who speak more than 50 languages ‚Äã‚Äãand live around the world.  This system is supported by about 3,000 servers located in four data centers (in America, Europe, Asia and Russia).  Our product is a collection of applications for all popular mobile platforms, a mobile web and a web version for a desktop browser.  We are a highload project, and at the peak of traffic we have 70-80 thousand requests per second. <br><br>  It is obvious that the system is quite large-scale and requires a lot of work in various areas, including in the field of information security. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/cb0/9f1/9dc/cb09f19dcc764c6aae9382df5620fe4e.png" alt="image"></div><br><br>  Oddly enough, we do not have an information security department.  And we, too, do not have specialists who deal exclusively with this area. <br><br>  Nevertheless, we value our users and take care of the security of their data.  Despite the fact that we are not a bank, not an online payment system, and we have no possibility of withdrawing funds (but there is a deposit of funds that are transferred to the local currency ‚ÄúBadoo loans‚Äù), we have quite a lot of data that needs to be protected. <br><br>  Oil is added to the fire and dictated by business need not to deprive users of convenience.  So, for example, we have a feature, when in a letter to a user there is a direct link to access to an account without the need to enter a login and password.  Obviously, this is a huge security risk.  We try to insure to the maximum, and we have mechanisms to protect user data even in this case.  But, of course, no one is perfect. <br><br>  Why we do not have a dedicated department is a difficult question, answering which I would like to remind you that our project has grown out of a startup.  And any startup initially aims at the rapid development and achievement of business goals;  he does not focus much on quality, safety and other aspects that are obvious to mature projects.  That is why most startups think about their testing department not from the very beginning, but about the information security department even later.  And that's fine. <br><br>  Until now, in our company, some methods and approaches characteristic of a startup have been applied.  We generally dealt with information security from the very beginning (our guys are professionals), but there was no systematic approach.  Probably someday we will come to the need for individual specialists or the whole department dealing with information security. <br><br>  And today we provide security and support the bounty program as follows: <br><ul><li>  system administrators are involved in infrastructure, network and other security.  And they began to do this before all other teams; </li><li>  developers (including during the code review) check the code from the point of view of security and possible errors; </li><li>  testers in auto tests and when checking tasks manually also check the security of features (for example, unauthorized access or code injection); </li><li>  we regularly conduct checks with automatic tools, in particular Skipfish and Acunetix; </li><li>  we are certified by PCI DSS (we have the first, highest level).  Within the framework of this standard, a lot of safety measures are regularly carried out: complete isolation of the process of developing and displaying the code and equipment processing payments;  regular penetration tests;  regular infrastructure audits and much more.  All these activities have allowed us not only to get the highest category by standard, but also to keep it for several years now; </li><li>  we tried to make the code development system itself, the framework, the template engine, the operating environment, and other things, first, to minimize the possibility of error, and second, to minimize the consequences of possible errors.  The simplest example: we patch our php-fpm so that it executes PHP-code only from certain directories (closed for writing, of course).  Thus, even if we assume that we have managed to upload third-party code to our servers, we minimize the possibility of its launch. </li></ul><br><br>  Once upon a time, third-party security specialists helped us.  Someone we asked ourselves, someone wrote us about bugs of their own accord and received a reward for it.  But the process itself was unorganized, so we decided to systematize it, streamline it, and put it on stream. <br><br>  A couple of years ago, we seriously thought about a permanent bounty program, especially since, on the one hand, it is a kind of challenge that would allow us to reach a new level, and on the other hand, an independent test that would help us understand how our dealing with security. <br><br><h5>  Training </h5><br><div style="text-align:center;"><img src="https://habrastorage.org/files/06d/b93/212/06db932122a54ef9a19d34e2f5fcf53b.png"></div><br><br>  Of course, we did not immediately take up implementation, but began with preparation and conducted several internal checks to increase confidence that we are ready. <br><br><ul><li>  Make sure that access to databases and other resources in order.  Checked the rights to run, write and other actions for system users on the servers.  Of course, a lot of work was done and much had to be redone in order for the system to meet the new requirements.  In some places, the access API was changed so that it could be controlled. </li><li>  Enhanced XSS attack protection for our templating system.  Now everything has become screened by default, and not only when the programmer explicitly writes this. </li><li>  We have conducted several stages of the internal audit of the entire system, code, environment. </li><li>  Prepared tools for processing user requests.  We did not want to immediately launch a large program.  To begin with, they decided to experiment and launch it for a month, so they didn‚Äôt bother with tools too.  First of all, we organized a system for processing applications in Google Groups (we use Google mail in our company).  From the point of view of customization, the interface of the service is quite flexible, so many things (whether the application was accepted, which category was assigned to it, whether it went into development, whether money was paid for it) was not difficult to do. </li><li>  We decided to start the program from the main website to see how it will go and how effective it will be. </li><li>  It was also decided to hold the program in the Russian-speaking segment of the network, because, first, we were already familiar with several strong researchers from Russia who were asked to participate, and secondly, we were afraid of a global failure in case of failure. </li></ul><br><br>  In the interface of the corporate site, we made a page where the bids were submitted, their statuses and categories.  The description of vulnerabilities appeared on this page only after the vulnerability was closed.  A new application could be sent to us through the same page. <br><br><img src="https://habrastorage.org/files/60b/033/929/60b0339294bf4e27b712964d2bb9e53a.png"><br><br>  This turned out to be very convenient: people received an application number from us in a letter and could monitor its condition in the same list.  And they could give a link to this page to others, increasing their own karma. <br><br>  As an additional motivation, we made a rating of participants, which took into account not only the number of accepted applications from a particular participant, but also their criticality.  After the end of the month we awarded the leaders of the rating with special prizes. <br><br>  This page also helped us point participants to duplicates.  In case of duplication, the participant received a notification with the number of the application already accepted.  As a result, he could track the status of such applications on this page. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6ab/1b9/2a1/6ab1b92a1cb04c03a029e18fef721713.png"></div><br><br>  When evaluating the bugs found by the participants, we did not rely on common vulnerability assessment systems, such as, for example, OWASP.  On the contrary, we decided to award a category depending on the potential damage that vulnerability could inflict on us and our users.  We introduced 5 of such categories, and in monetary terms they were estimated at between 50 and 500 pounds sterling. <br><br>  At first glance, this may seem strange, but we were guided by the fact that often not the most critical OWASP vulnerability can cause us serious harm, therefore, it should be assessed higher.  In addition, we have provided a super premium of ¬£ 2000 and above in case of finding a particularly critical vulnerability.  So we decided to further motivate our researchers not only to report on vulnerability, but also to come up with the most effective vector of exploitation for it.  Further in the article, I will give an example of a simple XSS vulnerability, for which we were given a super bonus because of an unusual and very interesting attack vector. <br><br><h5>  Competition </h5><br>  So, the ‚ÄúD-day‚Äù has come.  We launched the program, announcing it in several sources, and waited for the results.  Let me remind you that we launched it only for a month.  He was tense, but very helpful to us.  The results of the Safety Month at Badoo were: <br><ul><li>  we received about 500 applications with potential threats; </li><li>  about 50 of them turned out to be duplicates; </li><li>  about 150 applications were just bugs or suggestions for improvement, unrelated to security; </li><li>  just over 50 were real vulnerabilities; </li><li>  more than half of the vulnerabilities were various CSRFs. </li></ul><br><br><img src="https://habrastorage.org/files/c7c/bde/f04/c7cbdef0421040df89752de168af7738.png"><br><br>  The main percentage of bugs sent within a few days was CSRF.  Affected were mostly pages on which users filled out information about themselves, uploaded photos, and so on.  We can not say that at that time we did not have any protection against CSRF attacks.  Many pages were protected by a session token.  However, as it turned out, not all user actions on the site were protected from CSRF threats. <br><br>  We responded quickly and within a few days after the start of the competition we launched a large project for the protection of user data - anti-CSRF.  We redesigned all the pages and web services so that they began to check CSRF tokens by default.  So we closed almost all the CSRF vulnerabilities on the site. <br><br><h5>  Interesting bugs </h5><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fa9/409/c35/fa9409c353e942bfb31461ba959d3318.png"></div><br><br>  Top 3 most stupid bugs received during the first ‚Äúsafety month‚Äù looked like this: <br><ul><li>  In our application there are ‚Äúloans‚Äù - an artificial internal currency of the system for which the user exchanges real money and then buys some services.  The error found was very stupid and existed in the system for quite a long time.  If it were not for the bounty program, we would not have known about it for a long time.  The bottom line was that, due to an error in the code, despite all the precautions, the number of credits that would be credited to the user after payment was taken directly from the form.  Editing these values ‚Äã‚Äãin the html-code of the page allowed the attacker, by paying a small amount of money, to put more credits into the account of credits.  We analyzed the transactions and paid a substantial reward to the finder (although no one, except him, took advantage of it). </li><li>  The second mistake was just as simple.  It consisted in the fact that one of the handlers incorrectly validated the value of the parameter that identifies the user when his data changes.  As a result, by changing the user_id in the request, it was possible to change some information of other users.  As you can see, both errors are simple, however they received the highest rating. </li><li>  What was the third bug?  Badoo has the ability to link external social network accounts to your account.  After that, through them, you can log in to the internal account.  So, in the binding mechanism there was an error that allowed you to link your account in the external social network to someone else's internal account and, accordingly, access to someone else's profile. </li></ul><br><br><h5>  What's next? </h5><br>  During the month of the competition, we learned how to respond to requests from participants within a few hours, fixed bugs and created a separate project to protect against CSRF attacks.  It became clear that this program is a good and necessary thing.  She fully justified the time and resources spent on its preparation and implementation.  Therefore, we decided to move on and began to prepare for a permanent program to look for vulnerabilities in the Badoo security system, slightly changing the format. <br><br>  Within a month, we understood how a convenient flow should look for processing applications, and transferred it to JIRA, since the tracking of all tasks in our company is done in this system. <br><br>  A simple flow in Google Groups looked like this: <br><img src="https://habrastorage.org/files/6d9/6be/7c0/6d96be7c0d194635bc2c9b89da59395a.png" align="left"><br><br>  Applications from the participants came to us in two ways: through the form on the corporate website and a special email-address.  Next, the competition jury evaluated the applications and sent them (in the case of real threats) to the development of specific teams.  The Developer Relations Manager helped us to communicate with the participants at this stage, although many letters could be generated automatically. <br><br>  Flow in Jira, which we did for the permanent program, looked a little different and already included automatic answers to the participants, excluding the human factor. <br><img src="https://habrastorage.org/files/cc9/b76/595/cc9b76595f2c40f6949055c5a119d92a.png" align="left"><br><br>  We also decided to add mobile apps to the permanent program. <br><br>  At about the same time, we were included in the list of bounty programs of <a href="https://bugcrowd.com/list-of-bug-bounty-programs">Bugcrowd</a> , which brought us additional popularity and attracted the attention of researchers from around the world.  Strengthening the announcement, we launched the program. <br><br><h5>  Results of the ongoing program </h5><br>  The results were not as impressive as after the month - the flow of irrelevant reports about usyazimosti was more.  Nevertheless, in the first year of the ‚Äúbig‚Äù program, we received reports of several interesting bugs. <br><ul><li>  We received about 870 applications. </li><li>  About 50 of them were real security vulnerabilities. </li><li>  More than 30 applications sent in the first year turned out to be duplicates. </li><li>  More than 20 sent bugs were about mobile applications. </li></ul><br><br><img src="https://habrastorage.org/files/6f1/361/f23/6f1361f236fd40ecb8b3dba936a1a2a4.png"><br><br>  As expected, there was more ‚Äúnoise‚Äù, but there were also quite a lot of useful reports, so we are satisfied with the result of the program as a whole. <br><br><h5>  Interesting bugs </h5><br>  Many interesting bugs in the first year were sent to us about mobile apps, which is undoubtedly nice.  This area is new and interesting for developers and researchers. <br><br>  Top 3 bugs found in the first year of the program: <br><ul><li>  A special award was awarded vulnerability with a very unusual vector and not very difficult to operate.  In many places, we use a comet-server to send messages of different types over already open connections.  This technology is also used to display the ‚Äúpencil‚Äù in the messenger - a standard indication that something is being written to you right now at that end.  And it was in this type of message that there was an unused field left over from debugging times, and arbitrary data could be entered into it.  These arbitrary data "as is" were transmitted to the user to whom you are writing the message.  And there it was processed as html.  There is an atypical XSS, content spoofing, DDoS and many other "goodies", and the victim does not need to do anything - if only the messenger was open.  Precisely because such vulnerability could be applied massively, we awarded a special award for it.  The quick fix, as you understand, was simple - the unused field was simply deleted.  And then rechecked all similar moments in other places. </li><li>  The second interesting mistake was in the Badoo mobile app on the Android platform.  Our developers once discovered an interesting hack: to speed up the rendering, they used their own handler via the addJavascriptInterface android API on screens using web-view, which did almost nothing except instantiation.  And in the case of a MitM attack (when you can‚Äôt completely trust the data arriving to the client), an attacker‚Äôs JavaScript could get into this interface.  Thus, arbitrary code could be executed on client devices. </li><li>  The third bug (from the author of the previous bug) was that our own cache loader in an Android application did not sufficiently check the path to that same cache.  As a result, it could be used to receive application files (after all, the downloader works with the same rights as the application), including authorization keys in external systems (for example, to log in via Facebook, VKontakte, etc.) . </li></ul><br><br>  In general, we believe that the bounty program has brought us a positive and rewarding experience.  We receive daily expert appraisals of our applications and websites from a multitude of researchers around the world and are working to improve our products, following news from the field of information security.  We appreciate the trust of our users and try to do everything to preserve the security of their data. <br><br>  Participate in our program, look for bugs on websites and applications of other companies.  This is a very entertaining process that can not only bring you positive emotions and interesting knowledge, but also make a significant contribution to your budget.  We pay in pounds sterling, and recently also significantly increased the amount of premiums. <br><br>  To send us messages about vulnerabilities or bugs is best through the <a href="https://hackerone.com/badoo">Hackerone</a> platform.  Successful bug-hunting! <br><br>  Ilya Ageev <br>  Head of QA, Badoo. <br><br>  PS: While the article was being written, we <a href="https://hackerone.com/badoo">were</a> told about new and interesting vulnerabilities in the program on <a href="https://hackerone.com/badoo">Hackerone</a> .  We will definitely write about them in detail next time. <br><div class="spoiler">  <b class="spoiler_title">Our rewards in the hacktivity feed</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b95/1c1/d86/b951c1d866734b1dbed4029aed5f7ad0.png"><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/279325/">https://habr.com/ru/post/279325/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../279309/index.html">Banking Android Trojan disguises as a Flash player and bypasses 2FA authentication</a></li>
<li><a href="../279313/index.html">Audio conferences for the poor and for the rich</a></li>
<li><a href="../279315/index.html">Curious case with root-access to mysql</a></li>
<li><a href="../279321/index.html">Finding inefficiencies: What you need to know about creating strategies for trading on the exchange</a></li>
<li><a href="../279323/index.html">Welcome to Moscow Python Meetup March 18</a></li>
<li><a href="../279327/index.html">We organize the recovery of virtual machine files using the web portal Veeam Self-Service File Restore</a></li>
<li><a href="../279329/index.html">NetApp Converged Infrastructure Storage. Predictions 2016</a></li>
<li><a href="../279331/index.html">Where do we form a model for UI with Domain Driven Design? Performance comparison of various architectural solutions</a></li>
<li><a href="../279333/index.html">Oracle Database 12.1.0.2 New Features</a></li>
<li><a href="../279335/index.html">Understand Open Source: Usage Models</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>