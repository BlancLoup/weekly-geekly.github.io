<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tale of how I simplified my workflow. Or writing your spy in C #</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I want to tell you about the experiment that I set for myself. 

 I have been working remotely (outsourcing) for a long time and as a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tale of how I simplified my workflow. Or writing your spy in C #</h1><div class="post__text post__text-html js-mediator-article">  In this article I want to tell you about the experiment that I set for myself. <br><br>  I have been working remotely (outsourcing) for a long time and as a result I have to provide a monthly report on the work done, in the form of a table with the name of the tasks, time spent and other information.  Even with a huge availability of ticket systems, use them daily to record the work done - hard labor.  In a company where I work there are no strict requirements for logging or other daily reports, which probably makes my problem of lack of daily data a single, or at least not so popular (or not, maybe I am not the only such outsourcer?).  The month flies by unnoticed and with full immersion in work, instead of immersion in bureaucracy, since everything is built on trust.  And until recently, I coped with the task of compiling monthly reports, because almost every day I at least greeted my skype colleagues, chatted about this, including workflow, updated tickets, received letters.  But here's the trouble, the preserved data is not always available on the right day, in which at least kill yourself you can not remember what you did.  And at one such moment, while compiling such a report, it suddenly struck me, as I, a programmer, can solve this problem for myself from now on. <br><a name="habracut"></a><br>  Programmers, because they, like any other specialists, have a knowledge base in their field and should use it not only for work.  Like for example, doctors have a whole bunch of pills, syringes and other devices at home.  The mechanic is always a whole bunch of parts and tools, unscrew, nail, drill ... But I apparently fell under the classic phrase "shoemaker without shoes."  My PC is assembled on a table in pieces of boards and wires, the operating system has not been swapped for a million years, but oh well.  I may be a shoemaker without boots, but the problem still needs to be solved, and I decided to patch up my boots. <br><br>  Having formed an idea to solve a problem in my head, I first decided to discuss it with friends what they think about it.  As it turned out, I even threw a couple of links to ready-made solutions.  At first I was upset that my idea had already been implemented, on the other hand I did not even try to try the solutions offered to me, because I was convinced of the ease of implementation and security of my own decision.  Actually, what is the idea itself? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      My solution to the problem of logging was to write a spyware program that would do all this work for me and hang constantly in the system tray.  For a couple of minutes I came up with several functions for such a program.  Here are some of the features invented: <br><br><ul><li>  Screenshot </li><li>  Shooting short video clips screen </li><li>  Clipboard saving </li><li>  Start spying on a schedule (only during customized hours and only on weekdays) </li></ul><br>  This is a periodicity with a frequency of N seconds / minutes / hours (configurable in the program), i.e.  with N equal to 1 minute, we get 8 * 60 = 480 images for an eight-hour working day.  One shot takes ~ 700 KB, rounded up to a megabyte, so 480 megabytes of images will accumulate in one working day.  For a month it will be 14 gigabytes.  I agree, the figure is scary.  But I personally still have a place, and there is no need to save for more than a month, plus or minus.  As an option, you can use clouds with unlimited space (there seems to be such, not?), I personally do not use such services, I do not know.  But theoretically and in a vacuum, it is possible to accumulate data on work for arbitrarily months / years, while having access to your own data from everywhere.  Another optimization option is to reduce the image size before saving or lengthen the period N. <br><br>  So this is the minimum set of espionage tasks that came to my mind.  If you wrap everything up in a beautiful interface, then perhaps the process of reading logs will become even enjoyable.  I had C # on hand, in which I did some small task at work not so long ago.  Accordingly, the choice fell on C #. <br><br>  Using the free time in the evening, I began to implement the first function, since it is the easiest, and frankly, the only potentially useful in my task.  If someone else has not fully understood the essence, then here it is: from the screenshots you can understand what you did during the day.  Shooting a video is most likely a rudimentary idea, and will be deleted, because it does not carry much benefit.  But with the clipboard while I think.  At the moment, the function is not implemented, but it is intended to regularly save the clipboard (text) to the database on the hard disk.  This is nothing but a record of the form. <br><br>  id |  datetime |  buffer <br><br>  Actually, the shorter the N frequency, the more data the spy will collect.  From the contents of the clipboard, you can understand that you programmed and copied at a specific date and time. <br><br>  Of course, I decided to make the first implementation as simple and fast as possible.  So that the title of the program was not <b>Form1,</b> I introduced the first thing that <b>Work Spy</b> had to mind, and so my brainchild was called.  By the way, its original appearance, containing only one box with rich text (RichTextBox), which in turn was nothing but a simple window of the log where, when and what it saved: <br><br><img src="https://habrastorage.org/storage2/a37/156/5dd/a371565dde30a16145b9bc468c2f38b8.png"><br><br>  Writing took about 10 minutes. A couple of requests to google and now we‚Äôve already got some examples of the code for ‚Äúhow to take a screenshot of c #‚Äù.  My spy creates a folder, calling it today's date, and accordingly during the work of the program, using the <b>Timer</b> class, puts pictures of my two monitors inside (image size 3840x1080), whose name also consists of the date and time (I decided that I would use such template <b>12_03_2012__12_30_36.gif</b> ).  Image format - gif, in order to save space.  Despite the graininess of the image, everything is clearly visible on it. <br><br>  The first version is written, makes a minimum of gestures, all the settings so far are sewn into the code, instead of convenient elements on the form for setting up the program.  Test debugging is over, it's time to try running the program offline, rather than pressing F5.  With the first launch, I was congratulated by avast !, ‚Äúdrawing‚Äù attention to my program.  Congratulations from the antivirus looked like this: <br><br><img src="https://habrastorage.org/storage2/ad0/7e6/c34/ad07e6c34239b5f13ae1eca284b49741.png"><br><br>  It remains a mystery to me, as he identified the potential harm in these ~ 100 lines of code, but on the other hand, it is nice that even the simplest samopisny spy was able to suspect that something was wrong.  Not finding sufficient evidence of harm, avast!  apologized <br><br><img src="https://habrastorage.org/storage2/e21/4c7/c72/e214c7c726ac0944983d7f508f23bba7.png"><br><br>  I politely asked the respected avast!  open my program as usual, and not in the sandbox, because I trust it 100%. <br><br>  At the moment everything is still in manual test mode.  Daily start / close and view saved snapshots.  The program has worked so far for a week.  The result is already impressive.  If I open pictures from the launch day, I clearly see my browser, a text editor, in which I see tabs and the code of the project I'm working on.  Sometimes there are funny pictures where I watch a movie (probably a break, ayay ay, during the working day), or write a message on a social network.  It is the self-writing of the program that removes any excitement and fear for what is captured on the screen, but the most unexpected and unpredictable :) joke can be captured. <br><br>  Perhaps all that I wanted to tell.  The experiment continues, and I am sure that I will be satisfied by the end of the month.  It remains to agree with the willpower and finish the handles and legs to the body so that everything works as comfortable as possible.  The moral of the story is that 10 minutes and knowledge can solve big problems. <br><br>  In order to endow the article with benefits, I will leave links to the solutions that I have been advised to solve problems like mine.  I do not answer for the adequacy of the programs, because I did not even download them to watch. <br><br>  <a href="http://www.debugmode.com/wink/">www.debugmode.com/wink</a> <br>  <a href="http://taskwarrior.org/projects/show/taskwarrior">taskwarrior.org/projects/show/taskwarrior</a> </div><p>Source: <a href="https://habr.com/ru/post/141670/">https://habr.com/ru/post/141670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141661/index.html">Windows Project Glass: a parody of Google</a></li>
<li><a href="../141664/index.html">Buying like a game</a></li>
<li><a href="../141665/index.html">On experience and "derivatives"</a></li>
<li><a href="../141667/index.html">Anonymous chats for Android</a></li>
<li><a href="../141669/index.html">Trikopter (DIY Quadcopter: Part II.2)</a></li>
<li><a href="../141671/index.html">Useful metrics for project evaluation</a></li>
<li><a href="../141672/index.html">About pioneers</a></li>
<li><a href="../141673/index.html">Random sorting and output of random elements in XSLT</a></li>
<li><a href="../141674/index.html">MongoDB Secrets - Scalability and Performance (Workshop from the author)</a></li>
<li><a href="../141675/index.html">Translation of official Backbone.JS documentation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>