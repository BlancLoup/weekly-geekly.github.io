<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New in Cach√© 2015.1: SQL Index on Array Property Elements</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Cach√© 2015.1, it became possible to include a projection for collection properties into a separate column. Thus, for SQL data access to the collect...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New in Cach√© 2015.1: SQL Index on Array Property Elements</h1><div class="post__text post__text-html js-mediator-article">  In Cach√© 2015.1, it became possible to include a projection for collection properties into a separate column.  Thus, for SQL data access to the collection, you can use not only the child table, but simply as an additional column in which all values ‚Äã‚Äãof the collection are located.  Read more about it <a href="">here</a> . <br>  How and where it can be useful in practice, says this article. <br><a name="habracut"></a><br><br>  Sometimes it is useful (especially for the EAV model) in a class to use properties-arrays and to be able to quickly search by their elements: both the key and the value. <br><div class="spoiler">  <b class="spoiler_title">Consider a simple example.</b> <div class="spoiler_text">  <font><font color="#000080">Class User.eav Extends% Persistent</font></font> <font><font color="#000080"><br></font></font>  <font><font color="#000000">{</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#000080">Index</font> <font color="#000000">idx1 On attributes (ELEMENTS) [</font> <font color="#000080">Data</font> <font color="#000000">= entity];</font></font> <font><font color="#000000">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </font></font>  <font><font color="#000080">Index</font> <font color="#000000">idx2 On (attributes (KEYS), attributes (ELEMENTS)) [</font> <font color="#000080">Data</font> <font color="#000000">= entity];</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#000080">Property</font> <font color="#000000">entity;</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#000080">Property</font> <font color="#000000">attributes</font> <font color="#000080">As array Of% String</font> <font color="#000000">(</font> <font color="#000080">SQLTABLENAME</font> <font color="#000000">=</font> <font color="#800080">"attributes"</font> <font color="#000000">) [</font> <font color="#000080">SqlFieldName</font> <font color="#000000">=</font> <font color="#008000">attr</font> <font color="#000000">];</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#000080">/// do ## class (User.eav) .RepopulateAll ()</font></font> <font><font color="#000080"><br></font></font>  <font><font color="#000080">ClassMethod RepopulateAll</font> <font color="#000000">()</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#000000">{</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">% DeleteExtent</font> <font color="#000000">()</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#0000ff">set</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#0000ff">$ TR</font> <font color="#000000">(</font> <font color="#008000">"Pine ^ Sibi ^ psk cedar ^"</font> <font color="#000000">,</font> <font color="#008000">"^"</font> <font color="#000000">,</font> <font color="#0000ff">$ c</font> <font color="#000000">(769))</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#0000ff">set</font> <font color="#800000">obj</font> <font color="#000000">= ..</font> <font color="#0000ff">% New</font> <font color="#000000">()</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">set</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">entity</font> <font color="#000000">=</font> <font color="#008000">"Man"</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">attributes</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">SetAt</font> <font color="#000000">(22,</font> <font color="#008000">"Age"</font> <font color="#000000">)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">attributes</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">SetAt</font> <font color="#000000">(186,</font> <font color="#008000">"Growth"</font> <font color="#000000">)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">attributes</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#008000">"Vasya"</font> <font color="#000000">,</font> <font color="#008000">"Name"</font> <font color="#000000">)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">% Save</font> <font color="#000000">()</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#0000ff">set</font> <font color="#800000">obj</font> <font color="#000000">= ..</font> <font color="#0000ff">% New</font> <font color="#000000">()</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">set</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">entity</font> <font color="#000000">=</font> <font color="#008000">"Tree"</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">attributes</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">SetAt</font> <font color="#000000">(186,</font> <font color="#008000">"Age"</font> <font color="#000000">)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">attributes</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">SetAt</font> <font color="#000000">(22,</font> <font color="#008000">"Height"</font> <font color="#000000">)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">attributes</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#008000">"Pine"</font> <font color="#000000">,</font> <font color="#008000">"Family"</font> <font color="#000000">)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">attributes</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#800000">name</font> <font color="#000000">,</font> <font color="#008000">"Name"</font> <font color="#000000">)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#800000">obj</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">% Save</font> <font color="#000000">()</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#008000">/ *</font></font> <font><font color="#008000"><br><br></font></font>  <font><font color="#008000">;</font></font>  <font><font color="#008000">or</font></font> <font><font color="#008000"><br><br></font></font>  <font><font color="#008000">&amp; sql (insert into eav (entity) select 'Person' union select 'Tree')</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#008000">&amp; sql (insert into attributes (eav, element_key, attr)</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#008000">select 1, 'Age', 22 union</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#008000">select 1, 'Growth', 186 union</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#008000">select 1, 'Name', 'Vasya' union</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#008000">select 2, 'Age', 186 union</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#008000">select 2, 'Height', 22 union</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#008000">select 2, 'Family', 'Pine' union</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#008000">select 2, 'Name',: name)</font></font> <font><font color="#008000"><br></font></font>  <font><font color="#008000">* /</font></font> <font><font color="#008000"><br><br></font></font>  <font><font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">Reindex</font> <font color="#000000">()</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#000000">}</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#000080">/// do ## class (User.eav) .Reindex ()</font></font> <font><font color="#000080"><br></font></font>  <font><font color="#000080">ClassMethod</font> <font color="#000000">Reindex ()</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#000000">{</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do</font> <font color="#000000">..</font> <font color="#0000ff">% BuildIndices</font> <font color="#000000">(, 1)</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#0000ff">do $ system</font> <font color="#008080">.SQL</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">TuneTable</font> <font color="#000000">(</font> <font color="#008000">"SQLUser.eav"</font> <font color="#000000">, 1)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do $ system</font> <font color="#008080">.SQL</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">TuneTable</font> <font color="#000000">(</font> <font color="#008000">"SQLUser.attributes"</font> <font color="#000000">, 1)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#0000ff">do $ system</font> <font color="#008080">.OBJ</font> <font color="#000000">.</font></font>  <font><font color="#0000ff">Compile</font> <font color="#000000">(</font> <font color="#0000ff">$ classname</font> <font color="#000000">(),</font> <font color="#008000">"cu"</font> <font color="#000000">)</font></font> <font><font color="#000000"><br></font></font>  <font><font color="#000000">}</font></font> <font><font color="#000000"><br><br></font></font>  <font><font color="#000000">}</font></font> </div></div><br><br>  After filling ( <font color="#0000ff">do</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">User.eav</font> <font color="#000000">).</font> <font color="#0000ff">RepopulateAll</font> <font color="#000000">()</font> ) the following data will appear in our tables: <br><br>  <b>Eav</b> table: <br><table><tbody><tr><th>  ID </th><th>  entity </th></tr><tr><td>  one </td><td>  Person </td></tr><tr><td>  2 </td><td>  Tree </td></tr></tbody></table><br>  Table <b>attributes</b> : <br><table><tbody><tr><th>  eav </th><th>  ID </th><th>  attr </th><th>  element_key </th></tr><tr><td>  one </td><td>  1 || Age </td><td>  22 </td><td>  Age </td></tr><tr><td>  one </td><td>  1 || Name </td><td>  Vasya </td><td>  Name </td></tr><tr><td>  one </td><td>  1 || Growth </td><td>  186 </td><td>  Growth </td></tr><tr><td>  2 </td><td>  2 || Age </td><td>  186 </td><td>  Age </td></tr><tr><td>  2 </td><td>  2 || Height </td><td>  22 </td><td>  Height </td></tr><tr><td>  2 </td><td>  2 || Name </td><td>  Pine Siberian cedar </td><td>  Name </td></tr><tr><td>  2 </td><td>  2 || Family </td><td>  Pine </td><td>  Family </td></tr></tbody></table><br><br>  Global with data: <br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">USER</span></span>&gt;zw ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD=<span class="hljs-number"><span class="hljs-number">2</span></span> ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD(<span class="hljs-number"><span class="hljs-number">1</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD(<span class="hljs-number"><span class="hljs-number">1</span></span>,"attributes","")=<span class="hljs-number"><span class="hljs-number">22</span></span> ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD(<span class="hljs-number"><span class="hljs-number">1</span></span>,"attributes","")="" ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD(<span class="hljs-number"><span class="hljs-number">1</span></span>,"attributes","")=<span class="hljs-number"><span class="hljs-number">186</span></span> ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD(<span class="hljs-number"><span class="hljs-number">2</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD(<span class="hljs-number"><span class="hljs-number">2</span></span>,"attributes","")=<span class="hljs-number"><span class="hljs-number">186</span></span> ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD(<span class="hljs-number"><span class="hljs-number">2</span></span>,"attributes","")=<span class="hljs-number"><span class="hljs-number">22</span></span> ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD(<span class="hljs-number"><span class="hljs-number">2</span></span>,"attributes","")="ÃÅ ÃÅ ÃÅ" ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavD(<span class="hljs-number"><span class="hljs-number">2</span></span>,"attributes","")=""</code> </pre> <br><br>  Global with indexes: <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">USER</span></span>&gt;zw ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx1"," 186",<span class="hljs-number"><span class="hljs-number">1</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx1"," 186",<span class="hljs-number"><span class="hljs-number">2</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx1"," 22",<span class="hljs-number"><span class="hljs-number">1</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx1"," 22",<span class="hljs-number"><span class="hljs-number">2</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx1"," ",<span class="hljs-number"><span class="hljs-number">1</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx1"," ÃÅ ÃÅ ÃÅ",<span class="hljs-number"><span class="hljs-number">2</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx1"," ",<span class="hljs-number"><span class="hljs-number">2</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx2",""," 186",<span class="hljs-number"><span class="hljs-number">2</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx2",""," 22",<span class="hljs-number"><span class="hljs-number">1</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx2",""," 22",<span class="hljs-number"><span class="hljs-number">2</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx2",""," ",<span class="hljs-number"><span class="hljs-number">1</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx2",""," ÃÅ ÃÅ ÃÅ",<span class="hljs-number"><span class="hljs-number">2</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx2",""," 186",<span class="hljs-number"><span class="hljs-number">1</span></span>)=$lb("","") ^<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>.eavI("idx2",""," ",<span class="hljs-number"><span class="hljs-number">2</span></span>)=$lb("","")</code> </pre><br><br>  Now execute the following query: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> entity <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> eav <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">attributes</span></span>-&gt;<span class="hljs-keyword"><span class="hljs-keyword">attr</span></span> = <span class="hljs-number"><span class="hljs-number">22</span></span> entity  </code> </pre><br><br>  The query fulfills, but uses a full scan, not our indexes.  If you look at our tables in the SMP (System Management Portal), then we will not find idx1 and idx2 in them, although as we saw earlier, the data in them is generated. <br><br>  This happens because the SQL core ‚Äúsees‚Äù only those indexes on array collections that are based solely on the fields of the subtables array and necessarily contain the key, i.e.  propArray (KEY).  Both of our indexes contain an entity field that is not listed in the attributes sub-table. <br><br>  Also, the <font color="#000080">Index</font> idx3 On attributes (ELEMENTS) index will not be visible;  since it does not contain attributes (KEYS), but the indices: <br><ul><li>  <font color="#000080">Index</font> idx4 On (attributes (KEYS), attributes (ELEMENTS)); </li><li>  <font color="#000080">Index</font> idx5 On (attributes (ELEMENTS), attributes (KEYS)); </li></ul>  will be visible and therefore will be taken into account in queries, but they are not optimal for all types of queries. <br><br><h3>  So how can minimal efforts to achieve the visibility of indexes on the elements of the collection-array of the SQL-core? </h3><br><br>  In Cach√© 2015.1, it was possible to project a collection as a table field if this collection is projected into a sub-table using the methods <a href="">SetCollectionProjection / GetCollectionProjection</a> . <br>  This feature is off by default. <br><br>  In previous versions of these methods there is no, but you can try to enable this feature manually: <br><pre> <code class="hljs perl">%SYS&gt;set ^%SYS(<span class="hljs-string"><span class="hljs-string">"sql"</span></span>,<span class="hljs-string"><span class="hljs-string">"sys"</span></span>,<span class="hljs-string"><span class="hljs-string">"collection projection"</span></span>)=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  After the change it is necessary to recompile the classes. <br><br>  So, turn on this parameter and see what it gave us. <br><br>  In SMP, our indexes are now visible, and in the eav table there is a hidden field-collection attr.  However, our query still does not see idx1 / idx2 indices. <br><br>  To remedy the situation, we use the already known <a href="">FOR SOME% ELEMENT</a> predicate: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> entity <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> eav <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">some</span></span> %<span class="hljs-keyword"><span class="hljs-keyword">element</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">attr</span></span>) (%<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-number"><span class="hljs-number">22</span></span>) entity  </code> </pre><br><br>  The query now uses the idx1 index.  Few modify it: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> entity <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> eav <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">some</span></span> %<span class="hljs-keyword"><span class="hljs-keyword">element</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">attr</span></span>) (%<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> %<span class="hljs-keyword"><span class="hljs-keyword">key</span></span>= <span class="hljs-string"><span class="hljs-string">''</span></span>) entity </code> </pre><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> entity <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> eav <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">some</span></span> %<span class="hljs-keyword"><span class="hljs-keyword">element</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">attr</span></span>) (%<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> %<span class="hljs-keyword"><span class="hljs-keyword">key</span></span>= <span class="hljs-string"><span class="hljs-string">''</span></span>) entity </code> </pre><br><br>  In the last two examples, idx2 will be used instead of idx1. </div><p>Source: <a href="https://habr.com/ru/post/255203/">https://habr.com/ru/post/255203/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255193/index.html">The story of an attempt to become a startup or give a project in Open Source</a></li>
<li><a href="../255195/index.html">Manipulating the BEM structure with Bemy</a></li>
<li><a href="../255197/index.html">Automatic password management in Active Directory</a></li>
<li><a href="../255199/index.html">We turn from STM32F103 to K1986BE92QI. Or the first acquaintance with the Russian microcontroller</a></li>
<li><a href="../255201/index.html">Habr, hello from the ringcloud cloud</a></li>
<li><a href="../255205/index.html">Homomorphic encryption</a></li>
<li><a href="../255207/index.html">Complete energy autonomy or how to survive with solar panels in the outback (part 4. Made in Russia)</a></li>
<li><a href="../255209/index.html">Add a sidebar to your iOS app.</a></li>
<li><a href="../255211/index.html">Editing WebGL shaders on the fly - now in Chrome</a></li>
<li><a href="../255213/index.html">Webinar "New features of RAD Studio XE8"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>