<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Neural Network Compresses Photos Better JPEG</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A fragment of 32 √ó 32 pixels of the original image compressed by different methods. Illustration: Google 

 The developers at Google have shared their...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Neural Network Compresses Photos Better JPEG</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/f83/df5/972/f83df5972cfe4131a763dfcbc4ed9e96.jpg"><br>  <i>A fragment of 32 √ó 32 pixels of the <a href="">original image</a> compressed by different methods.</i>  <i><font color="gray">Illustration: Google</font></i> <br><br>  The developers at Google have shared their latest achievements in the application of neural networks for practical tasks.  On August 18, they published on ArXiv a scientific article ‚Äú <a href="http://arxiv.org/abs/1608.05148">Compression of full-size images using recurrent neural networks</a> ‚Äù ( <i>‚ÄúFull Resolution Image Compression with Recurrent Neural Networks‚Äù</i> ).  The article describes an innovative method of compressing photos using a neural network, shows the process of its learning and examples of its work. <br><br>  The developers inform that this is the first neural network in the world, which on most bitrates compresses photos better than JPEG, with or without entropy coding. <br><a name="habracut"></a><br>  The neural network for compressing Google images is based on the free <a href="https://www.tensorflow.org/">TensorFlow</a> machine learning <a href="https://www.tensorflow.org/">library</a> .  Two sets of data were used for training: 1) a ready set of images of 32 √ó 32 pixels;  2) 6 million photos from the Kodak Internet database of 1280 √ó 720 pixels. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Each image of 1280 √ó 720 from the second base was divided into fragments of 32 √ó 32 pixels.  The system then allocated 100 samples with the least effective compression, compared with PNG.  The idea is that these are the most ‚Äúdifficult‚Äù for compressing the image area - it is on them that the neural network should be trained, and the compression of the remaining areas will be much easier.  This ‚Äúcomplex‚Äù data set is presented in the table below as the ‚ÄúHigh Entropy Data Set‚Äù. <br><br>  Researchers from Google have experienced several options for the architecture.  Each of the models included a coder and a decoder on a recurrent neural network, a binarization module and a neural network for entropy coding.  The scientific work compares the effectiveness of several types of neural networks, and also presents new hybrid types of neural networks GRU and ResNet. <br><br>  To compare the compression efficiency, standard metrics for lossy quality algorithms were used - Multi-Scale Structural Similarity (MS-SSIM, presented in 2003) and the more recent Peak Signal to Noise Ratio - Human Visual System (PSNR-HVS, 2011).  The MS-SSIM metric was applied for each of the RGB channels separately, the results were averaged.  In the PSNR-HVS metric, color information is initially taken into account. <br><br>  MS-SSIM gives a rating on a scale from 0 to 1, and PSNR-HVS is measured in decibels.  In both cases, a higher value means a better match between the compressed image and the original.  To rank the models, a total estimate was used, calculated as the area of ‚Äã‚Äãthe image under the curve of the ratio of the degree of distortion and the amount of data (area under the rate-distortion curve, AUC) for all compression levels (bpp, bits per pixel). <br><br>  All models were trained in approximately 1,000,000 steps.  Entropy coding was not used.  The real AUC will be much higher when using entropy coding.  But even without it, all models showed results in MS-SSIM and PSNR-HVS better than JPEG. <br><br><img src="https://habrastorage.org/files/c1e/75b/692/c1e75b6928f74e6ca65248163ac5535f.png"><br><br>  The diagrams below show that all variants of the neural network work more efficiently with the use of an additional layer of entropy coding.  On relatively small 1280 √ó 720 images, the gain is small: between 5% at 2 bpp and 32% at 0.25 bpp.  The advantage will be much more noticeable only in really big photos.  In the Baseline LSTM model, the savings ranged from 25% by 2 bpp to 57% by 0.25 bpp. <br><br>  The first diagram shows the curve of the ratio of the degree of distortion and the amount of data (rate-distortion curve); the MS-SSIM metrics are plotted along the ordinate axis, and they vary depending on the level of compression - the bit-per-pixel value plotted along the abscissa axis.  The dashed lines correspond to the efficiency before the application of entropy coding, the solid lines after the application of entropy coding.  On the left are the two best models trained on a 32 √ó 32 pixel image data set.  On the right are the two best models trained on a high-entropy data set, that is, on real photographs that Google researchers broke into 32 √ó 32 fragments and identified the most difficult to compress. <br><br><img src="https://habrastorage.org/files/39d/009/542/39d00954262745c5b799718fd3b5292a.png"><br><br>  The following diagrams are the same for the PSNR-HVS metric. <br><br><img src="https://habrastorage.org/files/155/a0a/850/155a0a850a24405b84cee1f4b52783fc.png"><br><br>  The neural network still needs to be improved: some of its results do not look quite familiar to the human eye.  The authors of the scientific work admit that the statistics of the effectiveness of the RD-curve does not always correspond to the subjective perception of the eye: ‚ÄúThe visual system of human vision is more sensitive to certain types of distortion than to others,‚Äù they write. <br><br>  Nevertheless, this project is an important step towards the development of more efficient algorithms that will help even better compress images.  The developers are confident that it is possible to further improve efficiency on large images, if you use tricks borrowed from video codecs, as does WebP, created on the basis of the free VP8 video codec.  These are methods such as reusing fragments previously encoded.  In addition, they plan to conduct joint training of the entropy encoder (BinaryRNN) and the encoder in place (patch-based) on large images in order to find the optimal balance between the performance of the encoder in place and the predictive power of the entropy encoder. <br><br>  A few examples of how Google's neural network works in its current state, in the compression of real images.  As mentioned above, the human eye is more sensitive to certain types of distortion and less sensitive to others.  Therefore, even a picture that is highly rated by MS-SSIM and PSNR-HVS may sometimes not look as good as a low rating.  These are already flaws in existing metrics (or human vision). <br><br><img src="https://habrastorage.org/files/53c/71d/7bb/53c71d7bbb8e43a1b97a3130226bd849.jpg"><br>  <i>The original image, divided into fragments of 32 √ó 32 pixels.</i>  <i><font color="gray">Illustration: Google</font></i> <br><br><img src="https://habrastorage.org/files/89a/82a/ff1/89a82aff118b479eb1216a18e5936704.jpg"><br>  <i>A fragment of 32 √ó 32 pixels of the original image compressed by different methods.</i>  <i><font color="gray">Illustration: Google</font></i> <br><br><img src="https://habrastorage.org/files/2a1/ad5/405/2a1ad540584b41a2a2756833bf8a2ce9.jpg"><br>  <i>The original image, divided into fragments of 32 √ó 32 pixels.</i>  <i><font color="gray">Illustration: Google</font></i> <br><br><img src="https://habrastorage.org/files/236/d7d/9d4/236d7d9d41c6426aae931ce0638149f9.jpg"><br>  <i>A fragment of 32 √ó 32 pixels of the original image compressed by different methods.</i>  <i><font color="gray">Illustration: Google</font></i> <br><br>  TensorFlow is a highly scalable machine learning system that can work on a simple smartphone as well as on thousands of nodes in data centers.  Google uses TensorFlow for our entire spectrum of tasks, from speech recognition and Google Translate to Inbox answering machine and Google Photos search.  This library is ‚Äúfaster, smarter and more flexible than our old system, so it is much easier to adapt it to new products and research,‚Äù Google said in November 2015, when it <a href="https://geektimes.ru/post/265516/">put TensorFlow library for general use under the free Apache 2.0 license</a> . </div><p>Source: <a href="https://habr.com/ru/post/372607/">https://habr.com/ru/post/372607/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../372589/index.html">Doogee T5 security smartphone review: not expensive, but rich</a></li>
<li><a href="../372595/index.html">The operating director of "VKontakte" responded to the criticism of Durov and called 7 advantages of redesign</a></li>
<li><a href="../372599/index.html">Scientists have found the oldest tree in Europe, which is 1075 years old</a></li>
<li><a href="../372601/index.html">Intel Joule: details</a></li>
<li><a href="../372605/index.html">Linux 25 years</a></li>
<li><a href="../372609/index.html">Lenovo Phab 2 Pro - the world's first smartphone with Tango</a></li>
<li><a href="../372611/index.html">The 99.9% ghostly galaxy consists of dark matter and contains almost no stars.</a></li>
<li><a href="../372613/index.html">As I stepped on a rake and figured out with the NanoPi2</a></li>
<li><a href="../372615/index.html">VKontakte plans to launch an internal money transfer system</a></li>
<li><a href="../372617/index.html">Why we still do not have new generation batteries?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>