<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vs interface</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the principles of object-oriented design is programming at the interface level, not at the implementation level. Apparently, due to the fact th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vs interface</h1><div class="post__text post__text-html js-mediator-article"><p>  One of the principles of object-oriented design is programming at the interface level, not at the implementation level.  Apparently, due to the fact that the code in books and articles on design is presented mainly in Java, programmers in other languages, especially with dynamic typing, have difficulty transferring knowledge from these books and articles to their working programming language. </p><br><p> Often, the difficulty in understanding the principle of "programming at the interface level" lies in concentrating on the instrument, and not on the meaning.  Because of the presence in Java of the <code>interface</code> keyword, a distortion in the understanding of the principle occurs, and it becomes ‚Äúprogram using the <code>interface</code> ‚Äù.  Since Python does not have a tool in the form of the <code>interface</code> keyword, some Pythonists skip this principle. </p><br><p>  In the book Gangs of Four, examples are given in Smalltalk and C ++.  Both of these languages ‚Äã‚Äãdo not have the <code>interface</code> keyword, but this does not prevent the authors from applying the principle using the language constructs at their disposal: </p><br><blockquote>  Manipulating objects strictly through an abstract class interface has two advantages: <br><br><ul><li>  the client does not need to have information about the specific types of objects that he uses, provided that they all have the interface expected by the client; </li><li>  it is not necessary for the client to "know" about the classes with which the objects are implemented.  The client is only aware of the abstract class (or classes) that define the interface. </li></ul><br><br>  These advantages so significantly reduce the number of dependencies between subsystems, that one can even formulate the principle of object-oriented design for reuse: <em>program in accordance with the interface, and not with the implementation</em> . </blockquote><p>  But even the advantages cited in the quotation are not the only ones, if you look at the principle from a wider angle. </p><a name="habracut"></a><br><h2 id="realnyy-mir">  Real world </h2><br><p>  The most common definition of the interface from the Russian-language Wikipedia looks like this: </p><br><blockquote>  The interface is a ‚Äúcommon border‚Äù between the individual systems through which they interact;  a set of tools and rules that ensure the interaction of individual systems. </blockquote><p>  Man is a system, which means that each of us is faced daily with many interfaces for interacting with other systems.  Examples of interesting interfaces in the real world can be seen in the posts from Mosigra ( <a href="https://habrahabr.ru/company/mosigra/blog/232505/">one</a> , <a href="https://habrahabr.ru/company/mosigra/blog/251465/">two</a> , <a href="https://habrahabr.ru/company/mosigra/blog/308656/">three</a> , <a href="https://habrahabr.ru/company/mosigra/blog/283530/">four</a> ).  Interaction with a good interface occurs without unnecessary trouble, we do not notice how to use it.  Moreover, interacting with even the most terrible interface, we pay attention only to the inconvenience of the interface, while the implementation in both cases is hidden from our eyes. </p><br><p>  When working with a microwave oven, we use a set of tools: controls to turn on the oven, set the time, power, and the heating mode.  As well as a set of rules: in order to warm up the dish, you need to put it inside the oven, close the door and start heating up.  You have to agree that if we needed to change the electric circuit of the furnace to heat up the dinner, setting up the frequency of the magnetron, this would be inconvenient.  Controlling the oven with the help of the interface allows us not only to reduce the time and labor costs to achieve the ultimate goal - to warm up lunch, but also gives the opportunity to use the knowledge of the interface when working with microwave ovens of other types and from other manufacturers. </p><br><h2 id="mir-programmnogo-koda">  World of code </h2><br><p>  Conceptually, the meaning of interfaces in the program code does not differ from that in the real world.  The interface is all the same "common border" between separate systems.  Only in this case, systems are services, microservices, packages, classes, or even functions.  Each of these units of software code is a system with its own boundary, through which it is necessary to interact and which should not be violated. </p><br><p>  The situation described above about the need to change the electrical circuit of a microwave oven to heat a dinner seems absurd.  But the programmer has to deal with this in daily practice.  Even a bad name for a method that does not express its intent can lead to a disclosure of the implementation: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserCollection</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    def linear_search_for(user: User) -&gt; bool: for saved_user in self._all_users: if saved_user == user: return True return False</span></span></code> </pre> <br><p>  This name tells us about the algorithm used inside, as well as the data structure that underlies the <code>UserCollection</code> .  All this information is superfluous at this level of abstraction, poorly conveys intentions and inconvenient for further expansion.  To make the interface cleaner, let‚Äôs express in the name of the method ‚Äúwhat‚Äù the code does, and not ‚Äúhow‚Äù it does: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserCollection</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    def includes(user: User) -&gt; bool: '''    '''</span></span></code> </pre> <br><p>  Reflective names make a large contribution to the ability to program at the interface level, but just names are not enough to implement the principle.  For example, this simple function, which has a clear name, is difficult to use, knowing only the interface: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> utils <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DatabaseConfig <span class="hljs-comment"><span class="hljs-comment"># DatabaseConfig    , #     def is_password_valid(password: str) -&gt; bool: min_length = DatabaseConfig().password_min_length return len(password) &gt; min_length</span></span></code> </pre> <br><p>  The interface deceives us by stating that only a password is enough for work.  Calling this function in an environment where the required database is not raised will result in an error that will force you to turn to the implementation.  Enrich the interface to eliminate the need to access the implementation.  In this case, an explicit transmission of the <code>min_length</code> parameter is <code>min_length</code> : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   DatabaseConfig    def is_password_valid(password: str, min_length: int) -&gt; bool: return len(password) &gt; min_length</span></span></code> </pre> <br><p>  Implicit <code>DatabaseConfig</code> dependency resolved.  In addition to this, we obtained a testable function, which is a real black box with all the necessary input parameters and a known type of output parameter. </p><br><p>  Implicit dependencies reveal the implementation of any piece of software code.  Python allows you to write code that will be executed when you import the file.  At first glance, this may seem harmless, but the implicit dependency created in this way entails many problems: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># utils.py class DatabaseConfig: '''        ''' config = DatabaseConfig() #          def is_password_valid(password: str, min_length: int) -&gt; bool: return len(password) &gt; min_length</span></span></code> </pre> <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># user.py from utils import is_password_valid #      # DatabaseConfig     class User: def __init__(self, name: str, password: str): self.name = name self.password = password def change_password(self, new_password: str) -&gt; None: if not is_password_valid(new_password, min_length=6): raise Exception('Invalid password') self.password = new_password</span></span></code> </pre> <br><p>  Importing the User class into the interpreter or the test, if the required database is not running, will again end with an error that reveals the implementation.  There is no point in <code>from utils import is_password_valid</code> class interface, since the cause of the trouble in this case is the expression <code>from utils import is_password_valid</code> , namely the global variable that is created during the import.  Another disadvantage of a global variable is that it can cause inability to program at the interface level.  You can solve the problem by creating an instance of <code>DatabaseConfig</code> at the time the application starts and explicitly passing the instance to all interested objects. </p><br><p>  The absence of implicit dependencies and reflecting the essence of the name, protecting us from implementation details, still does not allow us to get all the benefits of programming at the interface level.  It's time to turn to programming strictly through the abstract class interface.  Kent Beck, in his book "Smalltalk Best Practice Patterns", writes: </p><br><blockquote>  I am in a good shape. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ... <br><br>  Replacing objects - Good style leads to easily replaceable objects.  ‚ÄúI‚Äôm trying to make it a bit different,‚Äù he said. </blockquote><p>  Using an interface defined by an abstract class instead of a specific class is a convenient technique for creating replaceable objects.  Python has the ability to create abstract classes using <a href="https://docs.python.org/3/library/abc.html">the abc standard library module</a> , but for code compactness, the examples will use an approach where unrealized methods of the abstract class throw <code>NotImplementedError</code> . </p><br><p>  Suppose we need to implement the display of the weather forecast for today and for the current week.  We receive the weather forecast from some third-party resource.  In order not to bind to a specific resource, as well as to the data format returned by the resource, it is necessary to formalize the way of communicating in the form of an abstract class, and the format of the data as a value object: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># weather.py from typing import List, NamedTuple class Weather(NamedTuple): max_temperature_: int avg_temperature_: int min_temperature_c: int class WeatherService: def get_today_weather(self, city: str) -&gt; Weather: raise NotImplementedError def get_week_weather(self, city: str) -&gt; List[Weather]: raise NotImplementedError</span></span></code> </pre> <br><p>  Without a specific implementation, the client of our code, relying on the provided interfaces, will already be able to start testing and developing, using instead of a real service substitute objects: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># test.py from client import WeatherWidget from weather import Weather, WeatherService class FakeWeatherService(WeatherService): def __init__(self): self._weather = Weather(max_temperature_ = 24, avg_temperature_ = 20, min_temperature_c = 16) def get_today_weather(self, city: str) -&gt; Weather: return self._weather def get_week_weather(self, city: str) -&gt; List[Weather]: return [self._weather for _ in range(7)] def test_present_today_weather_in_string_format(): weather_service = FakeWeatherService() widget = WeatherWidget(weather_service) expected_string = ('Maximum Temperature: 24 ¬∞C' 'Average Temperature: 20 ¬∞C' 'Minimum Temperature: 16 ¬∞C') assert widget.today_weather == expected_string</span></span></code> </pre> <br><p>  The interface gives us flexibility: if our users are not satisfied with the accuracy of the forecast, we can easily switch to another weather forecast resource by writing a class that implements the <code>WeatherService</code> interface. </p><br><p>  Using the principle of "program in accordance with the interface, but not with the implementation of" allows you to create a more flexible design of the application, relieve the head of the developer and improve communication within the team.  All this makes the system more suitable to support and add new functionality.  In Python, there is no <code>interface</code> keyword, but there are other ways to implement the principle: reflecting the essence of the name, eliminating implicit dependencies, and using abstract classes.  Let's pay more attention to the essence of the principles underlying the good code, and not focus all our attention on the tools. </p><br><p>  <strong>UPD</strong> <br>  <a href="https://habrahabr.ru/users/pacahon/" class="user_link">pacahon</a> suggested python-way interface for a <code>UserCollection</code> </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserCollection</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    def __contains__(user: User) -&gt; bool: '''    '''</span></span></code> </pre> <br><p>  The <code>__contains__</code> method allows <code>__contains__</code> to check the ownership of elements with <code>in</code> and <code>not in</code> .  If you use type-hints in the <code>__contains__</code> interface, PyCharm will tell you that <code>int</code> in this case is the wrong type: </p><br><pre> <code class="python hljs">print(<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> UserCollection())</code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/332578/">https://habr.com/ru/post/332578/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../332566/index.html">Video recordings from the CocoaHeads meeting on June 23, 2017 from Tutu.ru office</a></li>
<li><a href="../332568/index.html">The choice of algorithm for calculating quantiles for a distributed system</a></li>
<li><a href="../332570/index.html">Moya - how to stop worrying about the network part and start living</a></li>
<li><a href="../332572/index.html">Is it time to use CSS Grid Layout?</a></li>
<li><a href="../332574/index.html">AliveScript - a programming language for children 12+</a></li>
<li><a href="../332580/index.html">Protecting your site with ZIP bombs</a></li>
<li><a href="../332582/index.html">Yet another tutorial: launch dotnet core docker application on Linux</a></li>
<li><a href="../332584/index.html">Making an image recognition service using TensorFlow Serving</a></li>
<li><a href="../332586/index.html">Fix bugs in 1988 style</a></li>
<li><a href="../332588/index.html">How to create your own metro</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>