<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Search space strategies. AI driver</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I post a report on my experiment in machine learning. This time the theme of the experiment was the creation of an AI to control the model car. 

 As ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Search space strategies. AI driver</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d1e/a5c/6dc/d1ea5c6dc7b7c64b106e66db35f76515.png"></div><br>  I post a report on my experiment in machine learning.  This time the theme of the experiment was the creation of an AI to control the model car. <br><a name="habracut"></a><br>  As written on <a href="http://www.machinelearning.ru/wiki/index.php%3Ftitle%3D%25D0%259E%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D1%2581_%25D0%25BF%25D0%25BE%25D0%25B4%25D0%25BA%25D1%2580%25D0%25B5%25D0%25BF%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5%25D0%25BC">smart sites</a> , there are two basic ways to have a control object maximize a certain evaluation function: <br><br>  1) Program training with reinforcements (hello to Pavlov dogs) <br>  2) Conduct a direct search in the strategy space <br><br>  I decided to choose the second option. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  AI-driver </h2><br>  As a model problem, I chose a subtask from one championship on AI (when I solved it for the first time, I was not able to machine learning). <br><br>  There is an object.  It can turn right-left and accelerate back and forth (forward - faster, back - slower).  What is the fastest way to get this object from point A to point B? <br><br><img src="https://habrastorage.org/files/e59/479/e8c/e59479e8c867408ba43a832be4aa8e98.png"><br><div class="spoiler">  <b class="spoiler_title">Matlab simulation code</b> <div class="spoiler_text"><pre><code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evaluateNN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(input,nn)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">angle</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rmin</span></span></span><span class="hljs-function">=1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e100</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function">=1:20 % "" 20  %  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">=180*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">atan2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(-unit.y+trg.y,-unit.x+trg.x)</span></span></span><span class="hljs-function">/3.141-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">angle</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tangle&gt;180)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">-360; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tangle&lt;-180)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">+360; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqrt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">((unit.y-trg.y)</span></span></span><span class="hljs-function">^2+</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(unit.x-trg.x)</span></span></span><span class="hljs-function">^2); %  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fastSim</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(nn,[tangle;r])</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">=</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(10+(-2)</span></span></span><span class="hljs-function">)/2+ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">*</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(10-(-2)</span></span></span><span class="hljs-function">)/2; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">=</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(30+(-30)</span></span></span><span class="hljs-function">)/2+ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">*</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(30-(-30)</span></span></span><span class="hljs-function">)/2; % </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vx</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3.141*unit.angle/180)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vy</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3.141*unit.angle/180)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vx</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vy</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">angle</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">angle</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">; %,     . </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r&lt;rmin)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rmin</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">=-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rmin</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(q&gt;0)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre> <br></div></div><br>  In fact, the problem can be solved by writing down the differential equation of motion and solving it ... But I am not strong in diffuras.  Therefore, regularly faced with such problems: <br><img src="https://habrastorage.org/files/92e/400/7f3/92e4007f3cd14be683b9aee38ba0ea80.png"><br>  Unit turned back to the target.  Is it better for him to turn around and drive, or go in reverse? <br><img src="https://habrastorage.org/files/f00/aca/76f/f00aca76fdcb4130bf6b2e91b35c010b.png"><br>  Unit turned to the target under 70 degrees.  Is it better for me to accelerate and simultaneously turn, or first turn, and then accelerate?  How to choose a threshold that separates one strategy from another? <br>  Now, when I have an efficient optimizing algorithm and high-speed neural networks, I solved the problem by searching for strategies.  That is, I presented our task as a function, where the input values ‚Äã‚Äãare weights and shifts of neurons, and the output value is a numerical evaluation of the effectiveness of this strategy (this numerical estimate is called a quality function or a quality metric). <br><br>  Input network data: <br><br>  1) Direction to the target (from -180 to 180 degrees) <br>  2) Distance to the target <br>  3) Course speed of the control object <br>  4) Lateral speed of the control object <br><br>  Heading and side speeds are these things: <br><br><img src="https://habrastorage.org/files/5f9/ea5/fac/5f9ea5fac6f74ff196ee610ab74b7d8e.png"><br><br>  Output values ‚Äã‚Äã- the position of the steering wheel (from -30 to +30 degrees per stroke) and acceleration from the engine (from -2 to +10 cells / turn per turn). <br><br>  As a function of quality in a single test, I chose q = (- the minimum distance to the target).  Q is always negative, but the more Q, the higher we evaluate the quality of the algorithm.  Since I conduct several tests, it is necessary to derive some uniform quality metric from them. <br><br>  I took the worst quality value for all tests as a metric - that is, the bot wants to improve not the average, but the worst of the results.  I did so that AI did not seek to optimize the results of some tests to the detriment of the results of other tests. <br><br>  My neural network consisted of 2 layers of 7 neurons each, the activation function of each neuron is arctangent. <br><br>  A few minutes of training and ... <br><br><img src="https://habrastorage.org/files/b60/40b/961/b6040b961cc64d86a80b83eba2fd926d.png"><br><br>  AI began to be aimed at a target like this.  The red arrow is the orientation of the car.  That is, the bot backed up, simultaneously unfolded, and then moved from reverse to forward.  At the same time, he achieved the goal faster than the strategy of ‚Äúfirst at least partially turn around, then go‚Äù and than the strategy of ‚Äúgo backwards‚Äù. <br><br><h2>  AI-collector </h2><br>  We slightly change the problem statement.  All the same plane, all the same opportunities to accelerate / turn (this time the acceleration from -3 to 7, and the rotation from -30 to 30 degrees per turn).  Each trial is limited to 100 moves. <br><br>  But now there are several goals.  Each goal is fixed.  AI sees them in this way: <br><br><img src="https://habrastorage.org/files/064/861/a22/064861a22e4149e2bd40acbf93d5f174.png"><br><br>  The neural network has a viewing angle of 200 degrees, which is divided into 9 equal sectors (22 degrees each).  If a target hits one of the sectors, then a number equal to the distance to the target hits the corresponding sensor of the neural network.  If there is no target in the sector, then the number 1000 reaches the sensor (almost all distances in the simulation are less than this number). <br><br><img src="https://habrastorage.org/files/6a5/e22/a7c/6a5e22a7c1504904b3a6e53bb6aaf571.png"><br><br>  If the controlled object approaches the target at a distance of 10 or less, the target is destroyed, and the AI ‚Äã‚Äãgets 10 points (such as has eaten the target). <br><br>  The initial coordinates of the control object are zero (0,0).  The coordinates of the targets in the first test are: <br><br>  [50,100] [10,30] [100, -120] [60,75] <br><br>  These are typical coordinates.  All tests 6, and the coordinates of approximately the same order.  Goals are always 4. <br><br>  I put AI on training.  AI unsuccessfully tries to learn for several hours.  On average, he captures one goal per test (even slightly less).  I suppose the problem is that the function of the dependence of the reward on the coefficients is piecewise constant. <br><br><img src="https://habrastorage.org/files/da6/f57/2cd/da6f572cda5342a6b72608c00a01d98f.png"><br><br>  In such cases, my optimizer works rather poorly (and evolution in such cases does not cope much). <br><br>  Therefore, I do a little cheating.  I make each AI move get the number of points inversely proportional to the distance to each of the uncollected targets.  He gets 0.1 / r points for each goal.  That is, at a distance of 10 he will receive 0.001 points per goal, and ‚Äúeating‚Äù this goal will give 10 points.  The number of points obtained by AI varies very little, but the function becomes a piecewise variable, that is, it has a nonzero derivative. <br><br><img src="https://habrastorage.org/files/0bf/00e/2ab/0bf00e2ab49f44b4a57b2fded1d8fe76.png"><br><div class="spoiler">  <b class="spoiler_title">Simulation source code with driver finding key points</b> <div class="spoiler_text"><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evaluateNN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(input,nn)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">angle</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vx</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vy</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-function">=</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pickable</span></span></span><span class="hljs-function">=1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pickable</span></span></span><span class="hljs-function">=1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(5)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(6)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pickable</span></span></span><span class="hljs-function">=1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(7)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">input</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(8)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pickable</span></span></span><span class="hljs-function">=1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tsz</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(trg)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">=</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function">=</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensor</span></span></span><span class="hljs-function">=</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensorMax</span></span></span><span class="hljs-function">=5; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensorBound</span></span></span><span class="hljs-function">=70; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sectorSize</span></span></span><span class="hljs-function">=2*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensorBound</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensorMax</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">=-100; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rmin</span></span></span><span class="hljs-function">=1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e100</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function">=1:200 %  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">j</span></span></span><span class="hljs-function">=1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensorMax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">=1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e4</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">j</span></span></span><span class="hljs-function">=1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tsz</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">=180*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">atan2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(-unit.y+trg(j)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">,-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">)/3.141-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">angle</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tangle&gt;180)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">-360; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tangle&lt;-180)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-function">+360; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqrt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">((unit.y-trg(j)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">)^2+</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(unit.x-trg(j)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">)^2); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tangle(j)</span></span></span><span class="hljs-function">&gt;-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensorBound</span></span></span><span class="hljs-function"> &amp;&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tangle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensorBound</span></span></span><span class="hljs-function"> &amp;&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pickable</span></span></span><span class="hljs-function">==1) %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">target</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">field</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">view</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">floor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">((tangle(j)</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensorBound</span></span></span><span class="hljs-function">)/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sectorSize</span></span></span><span class="hljs-function">)+1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sensor(index)</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(index)</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; %     </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r(j)</span></span></span><span class="hljs-function">&lt;10 &amp;&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pickable</span></span></span><span class="hljs-function">==1) %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">picked</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">up</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">+10; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pickable</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; %      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r(j)</span></span></span><span class="hljs-function">&lt;50 &amp;&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pickable</span></span></span><span class="hljs-function">==1) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">+1/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; % :    </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vangle</span></span></span><span class="hljs-function">=180*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">atan2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(unit.vy,unit.vx)</span></span></span><span class="hljs-function">/3.141; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vr</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vy</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3.141*unit.angle/180)</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vx</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3.141*unit.angle/180)</span></span></span><span class="hljs-function">;%</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v</span></span></span><span class="hljs-function">-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">radial</span></span></span><span class="hljs-function">. </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Scalar</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">multing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vb</span></span></span><span class="hljs-function">=-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vx</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3.141*unit.angle/180)</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vy</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3.141*unit.angle/180)</span></span></span><span class="hljs-function">;%</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v</span></span></span><span class="hljs-function">-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">back</span></span></span><span class="hljs-function">. </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vx</span></span></span><span class="hljs-function">*</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(-y)</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vy</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> %  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fastSim</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(nn,[sensor'';vr;vb])</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">=</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4+(-1)</span></span></span><span class="hljs-function">)/2+ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">*</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4-(-1)</span></span></span><span class="hljs-function">)/2; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">=</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(30+(-30)</span></span></span><span class="hljs-function">)/2+ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">*</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(30-(-30)</span></span></span><span class="hljs-function">)/2; %  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3.141*unit.angle/180)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ay</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(3.141*unit.angle/180)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vx</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vx</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vy</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vy</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ay</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vx</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vy</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">angle</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">angle</span></span></span><span class="hljs-function">+</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answArr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(q&gt;0)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br></div></div><br>  At the same time, I combined the results of several tests as follows: I took the average result and the worst, and took the average from them. <br><br><pre> <code class="matlab hljs">nnlocal=ktonn(nn,k); arr=[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>]; input=[[<span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>,<span class="hljs-number"><span class="hljs-number">-120</span></span>,<span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">75</span></span>];[<span class="hljs-number"><span class="hljs-number">-50</span></span>,<span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">-100</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">-90</span></span>];[<span class="hljs-number"><span class="hljs-number">100</span></span>,<span class="hljs-number"><span class="hljs-number">-60</span></span>,<span class="hljs-number"><span class="hljs-number">-100</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>];[<span class="hljs-number"><span class="hljs-number">-100</span></span>,<span class="hljs-number"><span class="hljs-number">-10</span></span>,<span class="hljs-number"><span class="hljs-number">-25</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">-5</span></span>,<span class="hljs-number"><span class="hljs-number">-80</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>];[<span class="hljs-number"><span class="hljs-number">-10</span></span>,<span class="hljs-number"><span class="hljs-number">-70</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">-40</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>]; [<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">-100</span></span>,<span class="hljs-number"><span class="hljs-number">-20</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>,<span class="hljs-number"><span class="hljs-number">-30</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>,<span class="hljs-number"><span class="hljs-number">-10</span></span>];]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>) nncopy=nnlocal; val=evaluateNN(input(<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>,:),nncopy); sum_=sum_+val; arr(<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>)=val; countOfPoints=countOfPoints+<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; q=sum_/countOfPoints- sum(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(k))*<span class="hljs-number"><span class="hljs-number">0.00001</span></span>;</code> </pre><br>  The work went more cheerful.  A few tens of minutes - and voila: <br><br><img src="https://habrastorage.org/files/218/640/149/218640149d494516a48825644d05def9.png"><br><br>  So we pass the first test.  All targets (blue crosses) successfully captured. <br><br><img src="https://habrastorage.org/files/8db/df5/0e2/8dbdf50e206c41f29afb54be117d787f.png"><br><br>  So we pass the second test.  Three targets were captured (in order to capture that first target, we had to drive forward a little and then turn around. It looks like this in close-up: <br><br><img src="https://habrastorage.org/files/0d1/44b/a4e/0d144ba4eaa6424fb303ac5cd53ba15f.png"><br><br>  In the 3rd trial, too, 4 out of 4: <br><br><img src="https://habrastorage.org/files/407/268/697/407268697af04bb7bbc52ac3c1ed59c8.png"><br><br>  And in the 4th: <br><br><img src="https://habrastorage.org/files/1f9/53b/64b/1f953b64b7004b3db4721ba7c96fbf71.png"><br><br>  And in the 5th: <br><br><img src="https://habrastorage.org/files/b54/8d0/85a/b548d085a6cf4c13bef9983b212ea506.png"><br><br>  But in the 6th we already have 3 out of 4. <br><br><img src="https://habrastorage.org/files/3ef/944/f1b/3ef944f1b07e44e8ad5fed323c2ce19e.png"><br><br>  Now we will set new tests - those that were not in the training set (we will cross-test). <br><br><img src="https://habrastorage.org/files/166/5dc/75e/1665dc75e4fc4c5e9e87cf010ac54383.png"><br><br>  3 out of 4!  Frankly, I doubted to the last that AI could transfer the experience of the training sample to the test one. <br><br><img src="https://habrastorage.org/files/63f/eab/949/63feab9495544c44b87a08173ff1279c.png"><br><br>  I worked 3 goals, and missed a little past one. <br><br><img src="https://habrastorage.org/files/e56/a64/530/e56a6453088b425d9cfbee9098f4adc3.png"><br><br>  Well, here AI completely screwed up.  Worked 2 goals out of 4. <br><br><h2>  Conclusion </h2><br>  The report of the experiment should end with conclusions.  The conclusions are as follows: <br><br>  1) Learning by iterating strategy space is a promising technique.  But it is demanding of the optimizer - I used a rather confused algorithm for selecting parameters. <br>  2) A piecewise constant quality function is evil.  If a function does not have something that even remotely resembles a derivative, it will be very difficult to optimize it. <br>  3) 2 layers of 7 neurons - this is enough to make a simple autopilot.  Usually 14 neurons is a puff from which no useful function can be assembled. <br><br>  I would be grateful for the comments, comrades! <br><br>  If I like the article, I will tell you how I did a similar AI for a game like Mortal Kombat. </div><p>Source: <a href="https://habr.com/ru/post/323424/">https://habr.com/ru/post/323424/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323412/index.html">OOP is beautifully cracked with C ++ 14</a></li>
<li><a href="../323414/index.html">The history of the engineer-radiophysics, who decided to watch</a></li>
<li><a href="../323416/index.html">Yii2, quick start. The easiest site on Yii2 with static pages without using a database</a></li>
<li><a href="../323420/index.html">My Material Design Framework</a></li>
<li><a href="../323422/index.html">Search without internet. New beta application Yandex</a></li>
<li><a href="../323426/index.html">Duke Nukem 3D Source Code Analysis: Part 1</a></li>
<li><a href="../323430/index.html">GitHub Pages for the site on March 8</a></li>
<li><a href="../323434/index.html">Weekday programmers: how we finalized the cash software after the new law</a></li>
<li><a href="../323436/index.html">How we analyze vulnerabilities using neural networks and fuzzy logic</a></li>
<li><a href="../323438/index.html">HPE SecureMail - The Best Secure Email Software for 2017</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>