<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SCADA and mobile phones: an assessment of the safety of applications that turn a smartphone into a plant control panel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, mobile technology is an integral part of our lives, and sometimes penetrate where they should not be used. Convenience is often more important ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SCADA and mobile phones: an assessment of the safety of applications that turn a smartphone into a plant control panel</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/0e2/4e0/cd4/0e24e0cd4f444075858460e4d40ee421.png" alt="image"></div><br>  Today, mobile technology is an integral part of our lives, and sometimes penetrate where they should not be used.  Convenience is often more important than safety.  Now you can monitor the state of the process control system (automated process control system) or even manage it from a new Android or iOS smartphone.  Look for ‚ÄúHMI‚Äù (man-machine interface), ‚ÄúSCADA‚Äù (supervisory control and data acquisition system) or ‚ÄúPLC‚Äù (programmable logic controller) in the Google Play store, and you will be surprised at the number of results.  Moreover, many of these applications are developed by serious manufacturers: Siemens, GE, Omron, etc., and provide access, control and management of HMI, PLC, DCS (distributed control system) and SCADA-systems in the infrastructure of the industrial control system.  Are they safe?  Can an attacker harm by gaining access to an engineer‚Äôs tablet?  What vulnerabilities exist in these applications?  What attack vectors are possible? <a name="habracut"></a><br><br>  The goal is not only to find security errors in mobile applications for the process control system, but also to try to extrapolate the risks of these applications being compromised to the risks of compromising the entire infrastructure of the process control systems.  This approach differs from the usual view of mobile application security assessment: vulnerabilities with traditionally low levels of risk can expose the process control system to great risk, and vulnerabilities that are usually considered critical threats, on the contrary, are dangerous for the process control system with a very low probability. <br><br><h3>  Little about the process control system </h3><br>  Modern infrastructures for automated process control systems have a complex architecture consisting of such well-known elements as servers, PCs, network switches, software technologies (.Net, DCOM, XML, etc.), and more complex components: programmable controllers, transmitters, power drives, analog control signals, etc. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Lower level (1) </h4><br><img src="https://habrastorage.org/files/91f/23e/66f/91f23e66f10540d198199fca4b9a0c2a.png" alt="image"><br><br>  Here are the field devices.  As mentioned above, they are suitable for dirty work: for example, they can control the temperature and pressure in the reactor, control operations such as opening and closing valves, turning pumps on and off, etc. Many devices are often used at this level.  These can be low-level programmable logic controllers. <br>  In addition, at this level there can be transmitters and drives controlled by a remote terminal device (RTU, electronic device under the control of a microprocessor, which translates physical objects into signals understandable to a distributed control system or SCADA system by transmitting telemetry data to the host system and from the leading dispatching system to controlled objects).  This layer is the realm of low-level industrial protocols, such as Modbus, Modbus TCP, HART, Wireless HART, Profibus DP or PA, Foundation Fieldbus H1.  The engineers of the lower level of the process control system, electricians, technicians and other specialists work at this level of the process control system. <br><br><h4>  Intermediate Level (2) </h4><br><img src="https://habrastorage.org/files/242/47e/c55/24247ec551274356b0c4cc2b3d480be3.png" alt="image"><br><br>  At this level, you can find high-level PLCs, distributed control systems (DCS, process control systems, characterized by building distributed I / O systems and data processing decentralization), supervisory control and Data Acquisition systems (SCADA), software package designed to develop or provide real-time systems for collecting, processing, displaying and archiving information about a monitoring or control object) and human-machine interfaces (Hu  man-Machine Interface (HMI)), as well as servers such as OPC (Open Platform Communications, formerly OLE for Process Control - OLE for process control).  All intellectual activities are carried out here.  Based on data from lower levels, operators and automated systems make decisions and send commands to field devices.  Here goes the whole process of automation of production.  Operators, process engineers, process control system engineers, PLC programmers and software work with systems at this level. <br><br><h4>  Top Level (3) </h4><br><img src="https://habrastorage.org/files/89b/85e/6b8/89b85e6b825040fb836e66f97e072c81.png" alt="image"><br><br>  It integrates business and industrial processes.  This layer provides a link to the corporate network and enterprise resource planning (ERP) systems.  At this level there are various production asset management systems (PAS) and production process management systems (MES, providing the right information at the right time and showing decision-makers in the workplace how workshop conditions can be optimized to increase productivity).  Here, managers and engineering and technical personnel of the highest level work with the automated process control system. <br><br><h3>  Types of Mobile Applications for Process Control Systems and Associated Risks </h3><br>  <b>Control panel (1)</b> : directly configuration / monitoring / control of the production process and / or its components.  Roles in the process control system infrastructure: <br><ul><li>  PLC configuration.  Setting up and / or controlling the components of the process control system: PLC, HMI, connected to the PLC, RTU and others.  The mobile application connects to the process control system component via the industrial network (lower and middle levels of infrastructure).  It controls the state of the component or its (re) adjustment.  It can be considered an analogue of a standard portable terminal, hidden inside a Nexus or Xperia. </li><li>  Client for SCADA.  Control over the industrial process using SCADA-client or a virtual interface to connect to SCADA.  These applications allow process engineers to connect from a phone or tablet to a SCADA application and, if necessary, control the production process. </li><li>  Mobile HMI panel.  HMI-panel inside the mobile device to control or control several industrial components.  Allows the engineer to configure (and even program!) The HMI panel and connect its components to the PLC or other devices via Modbus / TCP, OPC or other protocols and interfaces. </li></ul><br>  All these applications have one important feature - the connection between the application and the industrial component occurs in a <u>supposedly safe environment</u> , somewhere at the lower and middle levels of the process control system. <br><br>  <b>OPC / MES client or archiving system (2)</b> : <b>archiving</b> applications allow an engineer or process owner to read and interpret some information from the middle and top level of the process control system components.  The data is read-only, and the user does not even have direct access to the PLC, HMI or SCADA - only the ability to view certain variables.  We included mobile clients for MES applications in this category.  They are usually used to read data from the archive server or aggregated data from the MES system.  A typical application from this category is a client (browser) for OPC.  It is connected not directly to the components of the process control system, but to the OPC server.  Connection usually occurs at the highest levels of infrastructure.  In addition, the connection can be made remotely.  This means that in such an application, encryption and authentication mechanisms should be implemented.  Although reading the aggregated data does not in itself pose a threat, this information can be used by an attacker to understand (reverse engineer) the industrial process and create a specialized attack scenario.  In addition, if the application is used outside the factory network, new threats appear: for example, the compromise of the engineer‚Äôs or manager‚Äôs phone through an application vulnerability. <br><br>  <b>Remote control SCADA (3)</b> : applications that allow remotely (from outside the factory network) to monitor / control the production process.  Although the solutions of the first category are suitable for this, the developers do not promote or even advertise this opportunity.  For all applications of this group, we have found the images / schemes / architectural drawings / documents from the developer, where the mobile client is used for remote control outside the industrial network (higher and lower levels).  Therefore, we assume that potential users will sometimes (or always) connect to the industrial process from public networks, unreliable home networks or via cellular communications.  It is also unclear in what environment such an application will work on Android and whether there will be any malware, root system and other risk factors.  The security and reliability requirements for such applications are the most stringent. <br><br><img src="https://habrastorage.org/files/8eb/048/42b/8eb04842b4ee41a68fd359684b1bfbde.png" alt="image"><br>  <i>Typical locations of mobile applications for process control systems</i> <br><br><h3>  Threats for different types of applications </h3><br><img src="https://habrastorage.org/files/6ad/bda/786/6adbda786cf143ec919d4950de8299e7.png" alt="image"><br><br><h4>  Remote Control </h4><br>  <b>The absence of server-side data verification from the point of view of the industrial process.</b>  Due to the fact that the server application completely trusts the data that came from the operator, and the correctness of the technological process depends entirely on the actions and commands that it sends, any shortcomings in data validation can lead to serious consequences.  At the same time, in a mobile application it is easier to make a mistake in discharging a number or accidentally set a negative parameter value.  Incorrect interpretation of values ‚Äã‚Äãcan also lead to a denial of service for both the server and client applications. <br><br>  <b>Compromise of data stored on an SD card</b> ‚Äî many applications store data on an SD card: logs, HMI projects, and other data.  Accordingly, they all have access to general information.  An application installed from third-party sources (or a fake from an official store) can read or modify this information ‚Äî for example, change the interface or functionality of a mobile HMI application. <br><br><h4>  OPC / MES client or archiving system </h4><br>  Since these applications are no longer in a protected circuit and are transmitted over general-purpose networks (the Internet), the <b>server</b> and the application <b>can be compromised</b> by intercepting data that goes from application to server.  An attacker can gain access to the authorization information, the configuration of the end device, any information about the state of the system, as well as replace the control commands. <br><br>  <b>Hiding alarms.</b>  Using the ability to intercept traffic, the attacker is able to change the response from the server in such a way that instead of information about the incident at the enterprise, the operator will receive a message that everything is in order, or, worse, opposite information.  In turn, untimely or false information can lead to the suspension of the technological process, while the operator understands where the problem is: in the equipment or still in the application. <br><br>  <b>Denial of service to the client and server system</b> can lead to delays in informing. <br><br><h4>  Remote control SCADA </h4><br>  Since applications of this type are positioned by software manufacturers precisely as a tool for remote control of SCADA servers, it is possible to intercept and change control commands, leak critical information, intercept and modify traffic in order to compromise the process. <br><br>  List of applications: the table below lists all tested mobile applications (sorted by type). <br><img src="https://habrastorage.org/files/10c/c9f/802/10cc9f8025bb4e5a88f931950daa46a3.png" alt="image"><br><br><h3>  Vulnerabilities and attack example </h3><br>  In general, 50 vulnerabilities were found, among which: unprotected or insufficiently protected data transfer and storage methods (including incorrect use of SSL or ‚Äúhomemade‚Äù cryptoalgorithms), remote attack on denial of access to the client and server, SQL injection, use of untrusted input data as technical process setup parameters, etc. Operating these security issues potentially allows for a series of dangerous attacks on both the application and the operator.  In the latter case, it is realistic to create a false idea of ‚Äã‚Äãthe current state of the process, which can lead to the adoption of wrong decisions with serious consequences for the enterprise. <br><br><img src="https://habrastorage.org/files/3b2/6f3/d05/3b26f3d05e3a4089a75dd8cd7068e93e.png" alt="image"><br><br><h4>  HMI Database Compromise </h4><br>  The data stored on the SD card can be accessed as follows: <br><br><ul><li>  Through physical access to the SD card; </li><li>  Thanks to the virus on the device; </li><li>  Any vulnerability of the platform or third-party application.  That is, by compromising a third-party application that is not related to the target mobile application, you can also access the SD card and modify the data. </li></ul><br>  During testing, it was revealed that a number of applications store the HMI database (electrical circuits, interfaces, connection parameters, HMI projects) on an SD card. The figure shows how it might look on a smartphone. <br><br><img src="https://habrastorage.org/files/794/bad/55d/794bad55d6424e1fa1949a958189c455.png" alt="image"><br>  <i>HMI project repository</i> <br><br>  As an example, take a very real HMI project.  This application moves some liquid from one container to another.  To control the process are buttons Start / Stop and flow sensor.  If the HMI project data is compromised (virus, other application vulnerability, direct access to the SD card memory from a PC, etc.), the attacker is able to slightly change its configuration or interface. <br><br><img src="https://habrastorage.org/files/b5c/358/184/b5c3581845ec47b18e9bba76bdd003fc.png" alt="image"><br>  <i>HMI flow sensor</i> <br><br>  It can replace events and the logic of components or, for example, data sources from sensors.  When the operator launches the application the next time, he will see, for example, something like this. <br><br><img src="https://habrastorage.org/files/8cd/f98/9a1/8cdf989a1eb64727ac5d38db0195ebfc.png" alt="image"><br>  <i>Changed interface</i> <br><br>  Now BOTH buttons start the process.  Of course, it can be hoped that physical or low-level regulators will prevent danger, but an attack will at least lead to an alarm or even a technological malfunction. <br><br><h4>  Storage and transfer of data in open form </h4><br>  Even if all the data that the application stores and transfers is encrypted, the encryption keys are often stored in the code of the application itself and are static. <br><img src="https://habrastorage.org/files/ced/8bd/734/ced8bd734b524b279c159fe0d8522d51.png" alt="image"><br>  <i>Encryption keys "wired" in the application code</i> <br><br>  That is, an attacker, having access to critical information that is encrypted, knowing what kind of application it is, can easily decrypt it. <br><br><h3>  findings </h3><br>  In the course of the study, we examined 20 Android applications that in one way or another interact with the infrastructure of an industrial control system.  We studied management solutions for PLC, OPC and MES clients, clients for remote SCADA control.  It should be noted that we could not find a single application without flaws and / or vulnerabilities.  Most of them have demonstrated problems with authentication and data integrity at the local or network level.  The most dangerous consequence of the exploitation of these vulnerabilities is the ‚Äúcompromise‚Äù of the operator, who inspires a false understanding of the current state of the technological process. <br><br>  The full text of the study can be found at the following link: <br>  <a href="http://dsec.ru/ipm-research-center/research/scada_and_mobile_phones_the_security_assessment_application_that_turns_your_smartphone_into_a_remote/">http://dsec.ru/ipm-research-center/research/scada_and_mobile_phones_the_security</a> </div><p>Source: <a href="https://habr.com/ru/post/265021/">https://habr.com/ru/post/265021/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265011/index.html">Gartner agency named IBM the Magic Quadrant leader in the category of mobile application development platforms.</a></li>
<li><a href="../265013/index.html">Client side CORS emulation: cross-browser solution of some user tasks without extensions</a></li>
<li><a href="../265015/index.html">Materials from the free on-site seminar "Kerio Control: Everything you wanted to know, but did not know who to ask"</a></li>
<li><a href="../265017/index.html">Optimization of data center operation at no extra cost</a></li>
<li><a href="../265019/index.html">Digest of the game industry: July</a></li>
<li><a href="../265023/index.html">Configure D-Link DIR-320 / NRU + 3G Rostelecom R41 (Sense R41)</a></li>
<li><a href="../265025/index.html">We document errors in Doxygen</a></li>
<li><a href="../265027/index.html">DATA CENTER EXPEDITION 2015: Asia Tour</a></li>
<li><a href="../265029/index.html">Statistical problems of identification of network structures</a></li>
<li><a href="../265031/index.html">QIWI launched Visa payWave on Android devices</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>