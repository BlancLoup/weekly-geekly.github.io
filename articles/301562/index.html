<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to solve family differences with 4 controllers and 2 smart hours in 1 month</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúSmart Home‚Äù is increasingly confidently migrating from the sphere of geek-exotic in the direction of fairly affordable technologies, with the help of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to solve family differences with 4 controllers and 2 smart hours in 1 month</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/c34/22e/340/c3422e340ee88de73f09a8d0a8ce5b10.png" alt="image"><br><br>  ‚ÄúSmart Home‚Äù is increasingly confidently migrating from the sphere of geek-exotic in the direction of fairly affordable technologies, with the help of which you can make your home more comfortable, more convenient, more energy-efficient and generally ‚Äúnice!‚Äù.  And in this article I would like to share with you my own experience of creating a ‚Äúsmart home‚Äù system in my apartment. <br><br><h1>  Little about sockets </h1><br>  My wife loves to turn off all the outlets.  When she leaves, she pulls everything out, and then I return home and insert it back.  I do not like it.  I tried different things: I asked, persuaded, convinced, threatened - nothing helped.  And then I decided that it was necessary to find a high-tech way to settle the conflict: somehow switch the sockets so that it would not be necessary to physically pull out the plugs throughout the apartment. <br><a name="habracut"></a><br>  Well, there is a soldering iron, hands too.  I started thinking about the implementation.  But immediately a lot of questions arose.  For example, which controller to use for control?  I had programming experience with Atmel AVR controllers.  Everything looks quite simple: a relay, a transistor for decoupling and control of one pin of the controller.  There were two tasks.  First, the controller and the relay must be powered, and secondly, the controller must be controlled.  With food presented three options.  The easiest is to power the batteries, but the batteries will sit down and have to be changed, which is inconvenient.  The second option is to place the 220 -&gt; 5 converters right next to the controller in each outlet.  The method is excellent, but I did not find ready-made compact converters, but I didn‚Äôt want to mess around with the converter myself, and I was also afraid to tinker and burn an apartment.  The third option is to connect external power to each outlet.  The issue of controlling the controller fell into two principal ways: radio control and wire control.  The wire version looks the simplest, but again requires the connection of a cord to each outlet.  For myself, I decided that when I would do the next repair in the apartment, I would foresee this and bring a wire to each outlet, for example, UTP 5th category.  But so far it was necessary to deal with the available untied sockets. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The last question that finally made me abandon the development of my own management system is ‚Äútesting for the living‚Äù.  Debugging minor bugs of architecture and firmware would have to be done right during the operation, which, of course, would have caused discontent of others. <br><br><img src="https://habrastorage.org/files/145/835/3ec/1458353ecd2e43d58fe92e279741f6b7.png" alt="image" width="250"><br><br>  I began to study the existing ready-made systems on which to build a "smart home".  I immediately decided that the communication modules should be wireless.  It remains to choose the technology.  First, there were two options - Wi-Fi and Bluetooth.  They are very common, for them a lot of ready-made solutions.  But Wi-Fi, running at 2.4 GHz, is not very convenient in terms of networking.  High distribution and the absence of any regulation when installing access points makes this frequency very noisy, but I want to have a more or less stable system so that I do not have to switch outlets when the neighbor router is working.  But this was not the most serious problem.  Much more terrible enemy Wi-Fi - microwave.  Its magnetron radiates at a frequency of 2.45 GHz, so when my home microwave turns on, nothing works around it.  Bluetooth audio streaming goes off, video streaming over Wi-Fi goes off, files don't download, pages don't open - nothing.  And no matter what design you have a microwave - built-in or free-standing, it will make noise in any way. <br><br><img src="https://habrastorage.org/files/b1a/3b3/3d5/b1a3b33d50bf41c9a324de51796d2c8c.png" width="250"><br><br>  Therefore, I also refused to use Wi-Fi and Bluetooth. <br><br><h1>  Z-wave </h1><br>  Began to study what other solutions exist.  For example, ZigBee has several frequency standards: there is 2.4 GHz, and there are around 1 GHz.  But then I came across an article on Habr√©, which told about Z-Wave.  I was impressed.  The basic Z-Wave modules are now being produced by only two companies in the world - these are Sigma and Mitsumi.  Its size is about a centimeter per centimeter.  In fact, it is a microcontroller with a transceiver.  It can even be reflashed, but most often, in finished form, they are mounted on top of the board, the UART is connected to it, and it works as a transceiver. <br><br><img src="https://habrastorage.org/files/ee8/edb/d33/ee8edbd337fd456e888a022a28864944.jpg" alt="image"><br><br>  All devices that want to get a ‚ÄúZ-Wave Compatible‚Äù badge must be certified.  The platform is closed, which gives some advantage in terms of compatibility.  For comparison: on sale there are a lot of Bluetooth solutions for homes, and almost all of them are incompatible with each other.  And all Z-Wave devices are compatible thanks to a single closed standard, which nevertheless evolves.  Paid SDK is available, it costs about 2 thousand dollars.  That is, if you are going to solder one thing at home - this is expensive.  And if you intend to set up production, then, dividing into 2 thousand devices, you will get only a dollar of difference - quite well. <br><br>  The communication range of the Z-Wave standard is about 30 m. One of its advantages is that the devices are lined up in a mesh network and there is a routing table in almost every module.  Any module, having caught a signal, knows whether to transmit it further or not.  That is, almost every module is also a repeater.  Almost, because in Z-Wave there are ‚Äúsleeping‚Äù devices that do not participate in relaying.  Such devices usually run on batteries and get in touch when needed. <br><br>  To prevent your network from adopting a neighbor network as its own, a token generated for each head controller is used.  Within the network there is a head controller and there are peripherals.  When the controller is first installed, its token is generated, after which the binding procedure occurs: any actuating device first binds to the controller, remembers its token, and after that the device is connected to the network. <br><br>  Amazon sells a mass of Z-Wave devices.  There are modules embedded in the socket and switches, there are modules for building a security system.  Locks, sirens, lights, smoke detectors, water leakage sensors - anything.  I even found an automatic cat feeder. <br><br>  As for the operating frequency, it is in the region of 900 kHz.  This frequency is not open to all countries in the world, so each country needs to be certified and get permission to use this technology, therefore carrier frequencies are slightly different in different countries.  For example, in Europe, the frequency is 868.42 MHz, in Russia - 869.0 MHz, in the USA and Canada - 908.42 MHz, in Hong Kong - 919.82 MHz, in Australia - 921.42 MHz. <br><br>  If you buy a module that is made for Europe, then you can programmatically convert it to the Russian frequency.  Similarly, you can programmatically switch the frequencies of devices made for Hong Kong and Australia.  But the American devices do not switch.  Therefore, there are three categories of identical devices, and you need to pay attention to what region they are made for.  Hong Kong and Australia, you are unlikely to meet, so pay attention only to the United States, Russia and Europe. <br><br>  When building a mesh network, the Explorer Frame mode is used.  In this mode, all devices go quiet, the controller starts a network scan, and the devices start responding in turn.  There is a kind of roll call, when each device builds its own routing table.  For example, it is recommended to turn on this mode after rearranging the furniture, because there is a possibility that the moved closet began to shield the signal between some devices, but opened the space between the others.  In general, it is believed that the standard ensures stable operation at a distance of 30 m in open spaces, and in apartments up to 10 m. Of course, the distance of stable communication between modules located in socket niches will be even less, but due to routing everything works quite stably. <br><br>  Now let's talk about commercial controllers.  The most common are two brands: Fibaro and Vera.  Fibaro has a series - Home Center and Home Center Light.  Vera also has two series of controllers, one more expensive, the second cheaper.  All of them support the basic sets of rules, and you can easily make it so that when you turn on one device, another is activated, and after a while it turns off or does something else.  But if you need to implement more complex behavior, you will have to program yourself.  Lua is used as a language. <br><br>  There is a third, less common brand - Zipabox, but these controllers, judging by the description, do not support advanced automation.  Nevertheless, Zipabox is interesting because it has expansion modules that fit together like a constructor. <br><br>  But we will now talk about another project related to Raspberry Pi.  This is a community project that has decided to make its own, as cheap as possible iron.  Today Raspberry Pi retail costs about 4,000 rubles.  On Amazon, you can buy for $ 50, with the current rate it is almost one and a half times cheaper.  On the Raspberry Pi, a web server with a user interface comes up, for which you can write automation on JS. <br><br>  As an iron expansion card is used, which was called RaZberry, it looks like this: <br><br><img src="https://habrastorage.org/files/49b/61c/19f/49b61c19fb534d8896d7c3aed65a4c65.jpg"><br><br>  It is put on the port of expansion Raspberry Pi: <br><br><img src="https://habrastorage.org/files/7c4/8c5/478/7c48c54787e643deb52212d6e87d8738.jpg"><br><br>  Here is an example of a control panel interface.  It is displayed in the browser, works well on tablets. <br><br><img src="https://habrastorage.org/files/e03/a52/364/e03a52364600481589fd8ae38a595943.png"><br><br>  Below is an example of settings.  You can see where all devices are working at what time, check connectivity, see the routing table, and so on. <br><br><img src="https://habrastorage.org/files/fda/27e/b56/fda27eb566d2420aa52360f752f1901e.png"><br><br><img src="https://habrastorage.org/files/50d/957/d6a/50d957d6aac0434d9a5c9d36eff39bbe.png"><br><br>  One of the advantages of Z-Wave.Me is a project open, here is a link to GitHub <a href="https://github.com/Z-Wave-Me/home-automation">github.com/Z-Wave-Me/home-automation</a> .  The development team is scattered around different countries - Russia, Germany and Switzerland, ‚Äúwith an office on the Internet,‚Äù as they write about themselves.  The interface can be downloaded for free from GitHub, if you wish, you can rebuild something yourself. <br><br>  All this is perfectly controlled from the admin panel, but this is not convenient for everyone: <br><br><img src="https://habrastorage.org/files/717/d55/047/717d55047a3941b7b0aa69eda94d2f73.png" width="250"><br><br><h1>  Control </h1><br>  I began to think how to implement a more convenient system management than from a computer through the admin panel.  Today there are applications for Android and iOS, and two years ago the official Android client left much to be desired.  I did not understand how to use it.  That is, I found, configured, connected, but could not use it.  At that time I was an adept of Windows Phone, for which there was no client.  I wrote a client on my knee for myself, and when the switches were out of sync, my wife turned to me for help. <br><br>  A year ago, in February-March 2015, the Pebble company launched a fundraiser to create a new version of the watch, called Pebble Time.  I supported the project, and by October the clock was already at my disposal.  I thought it was a great thing to manage a smart home.  After all, the phone is not always in my pocket, at home I just put it somewhere, and the watch is usually on my hand.  In addition, Pebble, in contrast to the watch on Android Wear or Apple Watch, connects to both iPhones (which I used by that time) and Android phones. <br><br><h1>  Pebble </h1><br>  Pebble has quite a few virtues. <br><br><img src="https://habrastorage.org/files/204/a68/fb9/204a68fb92be4a5d983edf30e9c44420.png"><br><br>  First, they work for a week on one charge.  Apple Watch users know this pain, when by the evening you need to look for exercises.  In addition, the Pebble screen always shows the time, because it is made on the basis of color electronic ink.  There is support for two main operating systems.  The watch is waterproof.  And they also have a hardware port.  Connect smart straps that you can do yourself (there is a detailed description on the site Pebble). <br><br>  But you have to pay for everything.  No touch screen - push-button control (four buttons).  But you do not need to constantly poll the touch screen, so that the clock is so long without recharging.  The second drawback - the display shows 64 colors. <br><br>  Work Pebble provides the operating system based on OpenRTOS.  Watch apps resemble web apps.  The frontend is executed on the clock and is written in C, and the backend works on the phone and is written in JS.  Web application developers are now horrified: where have you seen it - the front-end on C, and the backend on JS?  But this is easily explained: C, as the most compact language for compiling, is very convenient for creating embedded applications, and the plus JS is that it is equally well executed on the iPhone and Android.  JS works inside the phone and provides an interface for accessing the Internet and accessing GPS.  The clock itself has a built-in accelerometer, gyroscope and magnetic compass, that is, a basic set of iron. <br><br>  As a result, I wrote an application to manage my smart home system.  First for the latest version of the watch, and then realized support for the very first Pebble model, with a black and white screen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce3/39a/abc/ce339aabca1834ee0fe241093e1f5ce7.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/53a/821/3f4/53a8213f46787938a10ef131debf4eee.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/794/db2/1dc/794db21dc71d4150ba26b0d40813ea97.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/137/e0f/4ac/137e0f4ac24a977e4e91611965b50a6c.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/7eb/eb5/0f6/7ebeb50f6d463216db74de54b9b5fa1a.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/2bf/509/96c/2bf50996c8c0fd7316f1f736e3ccea16.png" alt="image"><br><br>  A little about the settings.  They are made in the form of an HTML page.  For Pebble development, it is advised to use the Slate Frontend Framework.  The page should be located on the web, which in itself is strange, because without connecting to the Internet you will not configure anything, but apparently, something was due to it. <br><br><img src="https://habrastorage.org/files/1b4/52b/f30/1b452bf3011a4f1f9b2ef7b45684c896.png" width="250"><br><br>  After I wrote the application, I put it in the official app store and forgot about it.  It was installed by 40 people, and I began to receive feedback. <br><br>  I have not programmed in C for a long time and remembered with horror that with memory allocation, and even worse, with its release, you need to work manually.  Therefore, in the first version, I made a static array for the eight devices that I had, and all this worked fine in my home.  But in networks, where more than eight devices, of course, did not work.  And the first response was from Denmark: ‚ÄúIs it possible to do more?‚Äù I, of course, said: ‚ÄúIt is possible‚Äù, and in one evening I transferred the application to dynamic arrays.  Comrade was happy, but not very long. <br><br>  It turned out that he had about 54 logical devices - switches and sensors, and one physical module can be several logical devices at once.  I, for example, have a sensor at home that is simultaneously a sensor for movement, temperature, humidity and illumination, and in the system it is visible as four sensors.  And the Dane is over 50, and he complained that in order to turn off something, he had to watch the entire list for hours on end.  I thought exactly one evening and came up with one thing.  In the admin panel of Z-Wave.Me you can hang tags on the device, and I decided to add a Pebble tag.  And in the clock settings, enter the mode when the screen displays only those devices that are marked with this tag.  That is, the user himself chooses what he wants to see, and marks the corresponding devices with this tag.  Fellow wrote it was just great.  Now he has five devices that he controls directly from his watch, and he is very pleased. <br><br>  Then another user of my program wrote to me; he had a different problem.  The application is able to display sensors, and could only control switches, with switches of type On / Off.  But there are many other controlled devices, such as dimmers, for which values ‚Äã‚Äãfrom 0 to 100% can be set.  Or RGB-modules on which you can set any color.  I agreed to add support for such devices, but asked to send the structure of its network to see how they look alive.  He sent, I looked - they look cool, but it's not clear what to do with it.  I got into the settings and found out that there are virtual devices in Z-Wave.Me.  Such a device can be set to type, for example, Multilevel Switch, and it turns into a virtual dimmer. <br><br><img src="https://habrastorage.org/files/d50/e9e/6a7/d50e9e6a738846bba15b2dd5eea79496.png"><br><br>  Manages nothing, but pretends that he is a dimmer.  But why ‚Äúdoes not control anything‚Äù?  Manages itself.  I can set the value from the clock, and he will show it to me in the dashboard.  This was enough for me to implement support for dimmers. <br><br>  Then I took up RGB.  This control LED stripes that can display any color.  RGB-lighting appeared in the standard Z-Wave not so long ago, so initially it looked like three dimmers in the system.  That is, all devices reported that they were three dimmers, and it was possible to separately control the red, green and blue channel.  For convenient work with old devices in modern control systems, a virtual RGB-lighting device has been created in which three dimmers can be set. <br><br><img src="https://habrastorage.org/files/895/f8e/f5d/895f8ef5d1974b26a4f8cdbbb263f7c6.png"><br><br>  Since we can already set Dummy Dimmer, we can do Dummy RGB.  It also worked well, but I haven‚Äôt yet implemented color management support, I sent only the dimmer control to the ‚Äúcustomer‚Äù.  And for him, I was just setting up support for a black and white clock. <br><br><h1>  Virtual devices </h1><br>  What else is the power of virtual devices in Z-Wave?  Take a virtual HTTP device.  And may you have any other device that is incompatible with the Z-Wave standard, but which is controlled by HTTP requests. <br><br><img src="https://habrastorage.org/files/243/8ea/209/2438ea2090d2489b8f2ac48b1ea1f62c.png"><br><br>  Then we write an HTTP request for inclusion: the address to pull, the request for shutdown and the request that needs to be sent to get the status of the device.  Most likely, a device that does not support Z-Wave does not support the answer in the On / Off format. <br>  To support it, you can enter Inline JavaScript, which will convert the response from your device to on or off.  And having a virtual device, we can continue to do anything.  For example, to integrate into this system any device based on ESP8266 controllers.  That is, we make three ends to which the device is able to respond, and then any strapping. <br><br><h1>  Scenes </h1><br>  This is a set of states of logic devices.  The scene cannot be turned on or off, it can only be activated.  I, for example, made the scene Away, which I activate when leaving the house. <br><br><img src="https://habrastorage.org/files/a01/153/2c0/a011532c01444987984da22f950d4260.png"><br><br>  She turns off the lights in the bathroom, in the toilet, turns off the sockets in the bathroom and in the kitchen.  Activating the scene Away turns off everything that I have at home managed.  I also have a back scene.  It turns back two sockets, but not the light.  After all, when you return, you turn on the light when you need it. <br><br>  As a plan, there is an idea to put mechanized valves and shut off the water with one touch, leaving home.  The valves are quite expensive.  But the flooding of neighbors can cost even more.  Again, there are autonomous leakage sensors.  Put them in the bathroom, in the toilet, in the kitchen, and in the event of a leak, the valves will automatically overlap. <br><br>  And the last.  Managing the clock is good, but you can only manage it at home.  And if you want to manage from the outside, you can make a bot for Telegram.  He is simple, he is sent a Light command, he asks: ‚ÄúWhere?‚Äù - and shows the pictograms of the toilet and bathroom.  Choose a place, he asks: "What to do?" - And shows a glowing light bulb and a black one.  You choose black, and he says: ‚ÄúOk, the lights in the bathroom are turned off.‚Äù <br><br><img src="https://habrastorage.org/files/ce2/a02/574/ce2a02574ffe4a0bb46b7cc9cd7d644c.png" width="250"><img src="https://habrastorage.org/files/761/e40/fbe/761e40fbe53b4d87b97cea780fa99dab.png" width="250"><img src="https://habrastorage.org/files/bd0/152/066/bd01520667d442c3b61e8a7861d8f1da.png" width="250"><br><br><h1>  Conclusion </h1><br>  I had a fascination with the "smart home" in rush.  At some point I got the idea, ordered the modules, built one that controlled only the light in the toilet and bathroom.  I also ordered a motion sensor, temperature and humidity.  Hanged in the bathroom and made a cool automation: the light in the toilet automatically turns off after 15 minutes, if you forget to turn it off, and the light in the bathroom turns on at the entrance, according to the motion sensor, and turns off after 15 minutes.  Everything is cool, except that it is impossible to live with it.  It turned out that 15 minutes in the toilet is actually not enough, especially if Wi-Fi is well caught there.  And he is caught well.  The increase in the waiting period did not help, so I have turned off this automation and ordered another motion sensor. <br><br>  Automation in the bathroom is simple: you enter - the light turns on, you exit - it turns off.  Conveniently.  However, at first I set it up not very well.  The motion sensor stood at the entrance, and when you enter the shower and pull the curtain, it does not see you.  Therefore, after 15 minutes the light goes out.  It is necessary to open the curtain, give up and pull the curtain back.  The problem was solved by moving the sensor to the middle of the bathroom so that it would react to movement on either side of the curtain. <br><br>  Now we mainly use the activation of scenes when leaving and returning home.  But in the future, when there will be more controlled devices, there will be more interesting rules for management. </div><p>Source: <a href="https://habr.com/ru/post/301562/">https://habr.com/ru/post/301562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../301548/index.html">How to automate business processes from order to sale using open software</a></li>
<li><a href="../301550/index.html">Mobile Device Management with Microsoft Intune</a></li>
<li><a href="../301554/index.html">Configuring the service OpenVPN + LDAP authentication</a></li>
<li><a href="../301556/index.html">UX for beginners: a practical guide. Part 2</a></li>
<li><a href="../301558/index.html">Detailed instructions for installing the Let's Encrypt SSL certificate on a server with CMS Bitrix and Nginx</a></li>
<li><a href="../301564/index.html">Game Industry Digest: April</a></li>
<li><a href="../301566/index.html">Using Java arrays to insert, retrieve, and modify PostgreSQL arrays</a></li>
<li><a href="../301568/index.html">How vulnerable are our data?</a></li>
<li><a href="../301570/index.html">Recover ePMP firmware from Cambium Networks via TFTP</a></li>
<li><a href="../301574/index.html">Corporate laboratories - best practices for information security</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>