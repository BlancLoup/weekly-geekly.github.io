<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>FPGA Debug Board - Frankenstein. Christmas tree controller</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Another series about FPGA and debugging board Frankie. Previous series 1 , 2 , 3 . 


 Making a controller of Christmas tree garlands is not easy, but...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>FPGA Debug Board - Frankenstein. Christmas tree controller</h1><div class="post__text post__text-html js-mediator-article"><p>  <em>Another series about FPGA and debugging board Frankie.</em>  <em>Previous series <a href="https://habrahabr.ru/post/316234/">1</a> , <a href="https://habrahabr.ru/post/316586/">2</a> , <a href="https://habrahabr.ru/post/317876/">3</a> .</em> </p><br><p><img src="https://habrastorage.org/files/334/6ce/c6f/3346cec6fac448bdbfc5125265b0b3f3.gif" align="left">  Making a controller of Christmas tree garlands is not easy, but very simple!  Hello World on FPGA is a blinking LED.  A "Happy New Year" on the FPGA is a flash of several LEDs.  The principle is simple, as in previous articles: create a counter that divides the frequency of the clock generator, select bits from the counter word, to get the desired speed.  A few bits of this word will give us a specific display step (depending on the number of selected bits of 1, 2, 4, 8, etc. steps).  Depending on the step number, set the values ‚Äã‚Äãfor N LEDs. </p><br><p>  To control a real garland, you can take some kind of shield with an electromagnetic relay.  I found myself <a href="">like this</a> , on 8 relays.  <a href="">Wiring diagram</a>  <a href="">Schematic diagram</a> . </p><br><a name="habracut"></a><br><h1>  The basis of the project </h1><br><pre><code class="hljs ruby"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">epm7064_test</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">clk</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">leds</span></span></span><span class="hljs-class">);</span></span> input wire clk; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    output wire [<span class="hljs-number"><span class="hljs-number">7</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>] leds; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>   / reg [<span class="hljs-number"><span class="hljs-number">31</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>] cnt; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>         always @(posedge clk) cnt &lt;= cnt + <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">'b1; //      assign leds = ... //      endmodule</span></span></code> </pre> <br><h3>  Normal alternation </h3><br><p><img src="https://habrastorage.org/files/755/de6/7e0/755de67e00874b188c88e50cecd236a3.gif" align="left">  With the usual alternation of light bulbs, we light the even light bulbs in the first step, and the odd light bulbs in the second step.  Steps 2, so we only need one bit from the counter word.  The numbers of light bulbs at each step will be given by the word - constant. <br clear="left"></p><br><pre> <code class="hljs scala">... wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant1 = (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>]) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b01010101</span></span> : <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b10101010</span></span>; assign leds = variant1; ...</code> </pre> <br><h3>  Running light </h3><br><p><img src="https://habrastorage.org/files/ce2/64c/428/ce264c428c8a487289bb065a4cceecda.gif" align="left">  A light to run through 8 light bulbs needs 8 steps.  To do this, you need to select 3 bits from the counter word (2 ^ 3 = 8).  It is worth noting that the output we get is inverted, because to turn on the relay, we have to issue 0. <br clear="left"></p><br><pre> <code class="hljs scala">... wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant2 = (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11111110</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d1</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11111101</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d2</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11111011</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d3</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11110111</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d4</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11101111</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d5</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11011111</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d6</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b10111111</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d7</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b01111111</span></span> : <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11111111</span></span>; assign leds = variant2; ...</code> </pre> <br><h3>  Normal Alternation v2 </h3><br><p><img src="https://habrastorage.org/files/296/14d/021/29614d021cc6470fb26cfe89ad571566.gif" align="left">  The same as in the first version, just combine the bulbs in pairs. <br clear="left"></p><br><pre> <code class="hljs scala">... wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant3 = (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>]) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b00110011</span></span> : <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11001100</span></span>; assign leds = variant3; ...</code> </pre> <br><h3>  Double running lights </h3><br><p><img src="https://habrastorage.org/files/334/6ce/c6f/3346cec6fac448bdbfc5125265b0b3f3.gif" align="left">  This is a variation of a single running light, but here it will take two times less steps. <br clear="left"></p><br><pre> <code class="hljs scala">... wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant4 = (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d0</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11001100</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d1</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b01100110</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d2</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b00110011</span></span> : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d3</span></span>) ? <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b10011001</span></span> : <span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11111111</span></span>; assign leds = variant4; ...</code> </pre> <br><h3>  Random lights </h3><br><p><img src="https://habrastorage.org/files/1d3/b3a/338/1d3b3a3386c84f6da5c641ca385c2a4d.gif" align="left">  This is the most interesting part.  In order to generate pseudo-random sequencing, I used <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B3%25D0%25B8%25D1%2581%25D1%2582%25D1%2580_%25D1%2581%25D0%25B4%25D0%25B2%25D0%25B8%25D0%25B3%25D0%25B0_%25D1%2581_%25D0%25BB%25D0%25B8%25D0%25BD%25D0%25B5%25D0%25B9%25D0%25BD%25D0%25BE%25D0%25B9_%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B9_%25D1%2581%25D0%25B2%25D1%258F%25D0%25B7%25D1%258C%25D1%258E">LFSR</a> .  Code samples can be directly taken from <a href="http://electronics.stackexchange.com/questions/30521/random-bit-sequence-using-verilog">this link</a> .  I took on the least amount of bits.  The algorithm is already proven, but for some reason he did not want to work!  The reason was that the register should not have a zero value, and when you turn on the FPGA, it turns out zero in each bit.  But I applied the Initial section !!!  In general, for not love to read the documentation, the truth came through the experiments.  On the FPGA of the EPM7000 series, the initial sections do not work.  The same problem, by the way, was on Lattice 4064. All this suggests that in larger FPGAs of the Cyclone class, initial blocks are generated into some kind of additional hardware piece.  And in order to do the initialization in EPM, I added another counter to generate a reset signal.  When this signal arrives, the pseudo-random sequence generator register is assigned the original value.  After that, the "generator" earned. </p><br><p>  For reasons of economy, I did not create a generator for every bit.  Most likely, there would not be enough resources.  The fact is that the generator can produce the next value on a cad cycle, and we need to update the light bulbs not on each cycle, so one generator is used to fill in the values ‚Äã‚Äãof all the light bulbs. </p><br><pre> <code class="hljs erlang">... reg [<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] res_gen_reg; //    wire reset = ~(res_gen_reg==<span class="hljs-number"><span class="hljs-number">3</span></span>'b111); // ,    <span class="hljs-number"><span class="hljs-number">1</span></span>,      <span class="hljs-number"><span class="hljs-number">8</span></span> always @(posedge clk) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> //    ,    ,     //  .  ,        //         .   //     res_gen_reg &lt;= (res_gen_reg==<span class="hljs-number"><span class="hljs-number">3</span></span>'b111) ? res_gen_reg : res_gen_reg + <span class="hljs-number"><span class="hljs-number">1</span></span>'b1; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> reg [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant5; //        ,    reg [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] d; //      always @(posedge clk) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reset) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> d &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; //    <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> else <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cnt[<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>]==<span class="hljs-number"><span class="hljs-number">21</span></span>'d0) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> //      d &lt;= { d[<span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>], d[<span class="hljs-number"><span class="hljs-number">6</span></span>] ^ d[<span class="hljs-number"><span class="hljs-number">5</span></span>] }; //     //          variant5[cnt[<span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">21</span></span>]] &lt;= d[<span class="hljs-number"><span class="hljs-number">5</span></span>]; //    <span class="hljs-number"><span class="hljs-number">8</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> assign leds = variant5; ...</code> </pre> <br><h3>  Putting it all together </h3><br><p>  We still have FPGA resources, so we can take the high bits of the counter and use them to switch the type of running lights.  It‚Äôs easier when there are 2, 4, 8 types, but we have five of them.  Therefore, I will sort through 4 of them, and in the intervals between them I will insert the fifth version (or rather, the first).  In general, there is a field for experimentation.  There are still free resources, because 58 cells out of 64x were spent. </p><br><pre> <code class="hljs scala">assign leds = (cnt[<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d1</span></span>) ? variant2 : (cnt[<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d3</span></span>) ? variant3 : (cnt[<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d5</span></span>) ? variant4 : (cnt[<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'d7</span></span>) ? variant5 : variant1;</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">completely</b> <div class="spoiler_text"><pre> <code class="hljs matlab">module epm7064_test(clk, leds); input wire clk; output wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] leds; reg [<span class="hljs-number"><span class="hljs-number">31</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] cnt; initial cnt &lt;= <span class="hljs-number"><span class="hljs-number">32</span></span>'d0; always @(posedge clk) cnt &lt;= cnt + <span class="hljs-number"><span class="hljs-number">1</span></span>'b1; wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant1 = (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>]) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b01010101 : <span class="hljs-number"><span class="hljs-number">8</span></span>'b10101010; wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant2 = (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d0) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b11111110 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d1) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b11111101 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d2) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b11111011 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d3) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b11110111 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d4) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b11101111 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d5) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b11011111 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d6) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b10111111 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d7) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b01111111 : <span class="hljs-number"><span class="hljs-number">8</span></span>'b11111111; wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant3 = (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>]) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b00110011 : <span class="hljs-number"><span class="hljs-number">8</span></span>'b11001100; wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant4 = (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span>'d0) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b11001100 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span>'d1) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b01100110 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span>'d2) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b00110011 : (cnt[<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span>'d3) ? <span class="hljs-number"><span class="hljs-number">8</span></span>'b10011001 : <span class="hljs-number"><span class="hljs-number">8</span></span>'b11111111; reg [<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] res_gen_reg; wire reset = ~(res_gen_reg==<span class="hljs-number"><span class="hljs-number">3</span></span>'b111); always @(posedge clk) begin res_gen_reg &lt;= (res_gen_reg==<span class="hljs-number"><span class="hljs-number">3</span></span>'b111) ? res_gen_reg : res_gen_reg + <span class="hljs-number"><span class="hljs-number">1</span></span>'b1; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> reg [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] variant5; reg [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] d; always @(posedge clk) begin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reset) begin d &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> begin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cnt[<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>]==<span class="hljs-number"><span class="hljs-number">21</span></span>'d0) begin d &lt;= { d[<span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>], d[<span class="hljs-number"><span class="hljs-number">6</span></span>] ^ d[<span class="hljs-number"><span class="hljs-number">5</span></span>] }; variant5[cnt[<span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">21</span></span>]] &lt;= d[<span class="hljs-number"><span class="hljs-number">5</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> assign leds = (cnt[<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d1) ? variant2 : (cnt[<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d3) ? variant3 : (cnt[<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d5) ? variant4 : (cnt[<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>] == <span class="hljs-number"><span class="hljs-number">3</span></span>'d7) ? variant5 : variant1; endmodule</code> </pre> </div></div><br><iframe width="560" height="315" src="https://www.youtube.com/embed/0ot269OInSk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  findings </h3><br><p>  It would seem a meaningless project, but allowed me to learn about such nuances as the inoperability of initial on this series.  I used to think that this is generally a feature of the manufacturer (Lattice, Xilinx or Altera).  And from the comments it turned out that the number of flashing this FPGA is only about 100 times.  New knowledge comes, it means all this is not in vain! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/318726/">https://habr.com/ru/post/318726/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318716/index.html">Animated Lines in iOS</a></li>
<li><a href="../318718/index.html">Coordinated work of macro and micro base stations in the creation of heterogeneous networks as the key to the development of mobile broadband</a></li>
<li><a href="../318720/index.html">Microservice at Golang</a></li>
<li><a href="../318722/index.html">Routing orthogonal connections in chart editors</a></li>
<li><a href="../318724/index.html">Platform to quickly create a RESTful API</a></li>
<li><a href="../318728/index.html">Results of the year: The great pre-New Year digest of ITMO University</a></li>
<li><a href="../318732/index.html">As we star rating crushed</a></li>
<li><a href="../318736/index.html">Annual Report Habrapost - 2016</a></li>
<li><a href="../318738/index.html">How to bring the project to mind with the help of PERT-diagrams</a></li>
<li><a href="../318740/index.html">Data retrieval bike</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>