<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>GSM base station hid in an office printer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="GSM Base Station 

 Intelligence agencies and intelligence agencies around the world use fake base stations (IMSI-traps, the Americans call StingRay),...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>GSM base station hid in an office printer</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/19e/ea3/458/19eea3458cf148b0830f9a19e0496a63.jpg"><br>  <i>GSM Base Station</i> <br><br>  Intelligence agencies and intelligence agencies around the world use fake base stations (IMSI-traps, the Americans call StingRay), which operate in a <a href="https://en.wikipedia.org/wiki/Stingray_phone_tracker">passive or active mode</a> .  In passive mode, the fake station simply analyzes the signal from the surrounding base stations.  Much more interesting when the device is transferred to the active mode.  In this case, the IMSI trap forces the surrounding client devices of the cellular communication to connect to themselves, disconnecting them from the operator‚Äôs base station (MTS, VimpelCom, etc.).  The task is accomplished by broadcasting a more powerful signal than the surrounding stations (for more information on the operation of fake base stations, see the article <a href="https://papers.ssrn.com/sol3/papers.cfm%3Fabstract_id%3D2440982"><i>‚ÄúThe Brave New World of Cell-Site Simulators‚Äù</i></a> (Albany Law School: 11‚Äì12. Doi: 10.2139 / ssrn. 2440982). <br><a name="habracut"></a><br>  Fake base stations are used not only by special services, but also by other people.  For example, in the last season <i>Mr.</i>  <i>Robot</i> hackers installed a femto (a low-power and miniature cellular communication station) right in the FBI office, having the opportunity to listen to their conversations.  In business, competitors can use such a device to quietly listen to conversations from the other side.  In Russia, Natalya Kasperskaya <a href="https://geektimes.ru/post/275790/">suggests installing</a> spy femtocells in the offices of commercial companies so that management can safely record conversations of employees and visitors. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/cb1/522/72b/cb152272beb9ff10fb0ae696b630ed1c.jpg"><br>  <i>The device is connected to the fake cellular station <a href="https://criticalengineering.org/projects/prism-the-beacon-frame/">PRISM: The Beacon Frame</a> .</i>  <i>As part of a research project, the station sends a notification of the connection to the subscriber‚Äôs phone.</i>  <i>This special services infrastructure works without sending notifications.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Such gadgets are very popular in the modern era, because so many people constantly use cellular communication, transferring confidential information through these channels, without using end-to-end encryption.  It is very convenient to identify people by their phone numbers. <br><br>  Heroes of the show <i>Mr.</i>  <i>Robot</i> put a femtocell under the table next to the router.  Obviously, in this form, it cannot work for a long time, because sooner or later the ‚Äúextra‚Äù device will be noticed by a cleaning woman or an occasional agent who will bend down.  In addition, the femtocell has a very small radius of action, so it is unlikely that she will be able to kill the signal of a real base station for subscriber devices on adjacent floors.  It is guaranteed to work except in the same office, and then - as lucky. <br><br>  To correct this deficiency, the office needs to install a more powerful base station.  But how to disguise it?  An excellent solution was proposed by New Zealand engineer Julian Oliver.  He designed the <a href="https://julianoliver.com/output/stealth-cell-tower">base station</a> design <a href="https://julianoliver.com/output/stealth-cell-tower">disguised as an HP office printer</a> . <br><br>  On the streets, base stations are disguised as objects of the environment - <a href="http://rhizome.org/editorial/2014/may/20/stealth-infrastructure/">trees or lanterns</a> . <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/db8/7b6/e8a/db87b6e8a769a6e7a6edd3bf53162550.jpg"><br>  <i>Cellular station, poorly disguised as a palm tree.</i>  <i>Marrakesh, Morocco</i> <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/997/ebd/9fe/997ebd9fe8b85e36bb37bc92788b5bd7.jpg"><br>  <i>Cellular station, disguised as a lamp, for some reason, put next to this lamp.</i>  <i>Milton Keynes, United Kingdom</i> <br><br>  The Hewlett-Packard Laserjet 1320 laser printer for office space looks as natural as a lantern on the street.  He will not cause suspicion.  At least as long as it continues to work properly.  For demonstration purposes in the Oliver project, the printer is set to automatically print metadata about intercepted calls and SMS messages, along with the text of these messages. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/e82/6e5/95f/e826e595fc53dca9c3be288f958404c9.jpg"><br><br>  The author explained in detail how the fake base station works.  A BladeRF programmable SDR transceiver was placed in the printer case (this wonderful device was <a href="https://habrahabr.ru/company/dsec/blog/193618/">told</a> in Habr√©).  In the photo it is fixed at the top right.  The transceiver connects to the Raspberry Pi 3 miniature board (bottom left), and all the hacker electronics are connected to the printer‚Äôs motherboard (the largest board in the photo). <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/f97/310/466/f97310466a66f829ee1f0787d8c51c6a.jpg"><br><br>  For power, a car USB adapter is used that converts the printer 21‚àí22 V to 5 V, necessary for the transceiver and the ‚Äúraspberry‚Äù.  Such adapters are usually inserted into the vehicle's cigarette lighter (12‚àí24 V) to power portable electronics. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/557/bbf/3f5/557bbf3f55d3c71ac48887ce256706d9.jpg"><br><br>  The cartridge compartment is slightly modified to fit two omnidirectional antennas (TX and AX) connected via an SMA cable to a BladeRF transceiver. <br><br>  The author of the paper says that they chose a Hewlett-Packard Laserjet 1320 printer for several reasons.  First, it has a strikingly inconspicuous appearance - a completely faceless design that does not attract attention.  Secondly, the internal cavities in the housing are ideal for accommodating all electronics and cables.  No detail comes out and is not visible from the outside, except the standard power cable.  When the USB adapter is plugged into a standard connector, the Hewlett-Packard Laserjet 1320 functions normally as a regular office printer. <br><br>  Raspberry Pi 3 was chosen after unsuccessful attempts to ensure stable operation of the <a href="http://yatebts.com/">YateBTS</a> base station controller <a href="http://yatebts.com/">program</a> under Intel Edison, Beaglebone Black and even I-MX6 Marsboard.  Unlike the ancient OpenBTS, the YateBTS program is more demanding on processor performance. <br><br>  The fake base station software in the printer runs on top of the open source YateBTS code.  For demonstration purposes, developed several scripts.  For example, one of them filters the log, forms a PDF document and sends it to print. <br><br><blockquote><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash readonly FH=/home/pi/yate.log rm -f $FH # Start the BTS, log to $FH and background yate 2&gt;&amp;1 -l $FH &amp; sleep 1 echo "Starting up..." last=" " while true; do # Poll every 10 seconds sleep 10 # Check log for new sniffed 'call route' entries and do some subbing cur=$(cat $FH | grep -A 16 "Sniffed\ 'call.route'" | sed -e "s/param\['//" \ -e "s/'\]//" -e 's/thread.*//' -e 's/time\=[0-9].*//' \ -e 's/\ data=(.*//' -e 's/\ retval=.*//' \ -e 's/\ tmsi.*//' -e 's/ybts/Stealth\ Cell\ Tower/' \ -e 's/Sniffed/Monitored\ =/' -e '/^\s*$/d' \ -e 's/^\s*//' | tail -n 13) if [ "$cur" != "$last" ]; then if [ ${#cur} -gt 1 ]; then echo "New SMS events detected" # Test to see if an IMSI is in the string. If not, look it up and put it in if [[ $cur != *imsi* ]]; then caller=$(echo "$cur" | grep "caller" | awk '{ print $3 }' | sed "s/'//g" \ | tr -cd '[:print:]') imsi=$(cat /usr/local/etc/yate/tmsidata.conf | grep "$caller" \ | cut -d '=' -f 1) cur=$(echo "$cur" | sed -e "s/\ called\ .*/imsi\ =\ '$imsi'/" ) fi # Make it all uppercase event=$(echo -e \\n"$cur" | tr 'az' 'A-Z') echo "printing file..." echo "$event" &gt; printme # Format a postscript file with enscript enscript -r --header='SMS EVENT RECORD|%W|%* UTC' -i2cm --margins=10:10:30:10 \ -o printme.ps -f Courier@15/12 printme # Convert to PDF ps2pdfwr printme.ps printme.pdf # Send it to the print queue for immediate processing lp -U pi -o a4 -q 100 -d hp_LaserJet_1320_2 printme.pdf fi last=$cur fi done</span></span></code> </pre> </blockquote><br>  Another script randomly selects one of the phone numbers that connected to the base station, calls it and reproduces the classic hit Stevie Wonder <i>"I Just Called To Say I Love You"</i> . <br><br><blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash readonly HOST=127.0.0.1 readonly PORT=5038 readonly DATA=/usr/local/share/yate/sounds/stevie.au readonly TMSI=/usr/local/etc/yate/tmsidata.conf readonly CC=49 #MSISDN prefix, matching that of definition in yate conf. callone () { # Play "I Just Called To Say I Love You" by Stevie Wonder, on pickup echo "call wave/play/$DATA $mt" | netcat -i 1 -q 1 $HOST $PORT # Or, setup channel and route to IAX/SIP # echo "call 'iax/iax:$PORT@11.22.33.44/$PORT' $mt" | netcat -q 1 $HOST $PORT } callall() { for mt in ${UES[@]} #override $mt do echo "calling $mt" callone done } while true; do tmsilen=$(wc -l $TMSI | awk '{ print $1 }') ues=($(cat $TMSI | grep -A $tmsilen ues | sed 's/\[ues\]//' | cut -d ',' -f 3)) if [ ! -z $ues ]; then ueslen=${#ues} RANGE=$ueslen select=$RANDOM let "select%=$RANGE" mt=${ues[$select]} callone fi sleep 30 done</span></span></code> </pre> </blockquote><br>  Compiled binaries for Raspberry Pi 3: <a href="">yate_r-pi3_4.4.11-v7_debian-8.0.tar.gz</a> . <br><br>  Good luck with your experiments! </div><p>Source: <a href="https://habr.com/ru/post/398893/">https://habr.com/ru/post/398893/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../398881/index.html">Hacking Landauer</a></li>
<li><a href="../398883/index.html">All about how Europe‚Äôs tallest skyscraper is built</a></li>
<li><a href="../398885/index.html">Prices for popular electronics of the past in today's money: the 1990s</a></li>
<li><a href="../398887/index.html">Paper money - when and why they appeared</a></li>
<li><a href="../398889/index.html">NASA Report on EmDrive Success Tests Published</a></li>
<li><a href="../398895/index.html">How I reprogrammed my brain to begin to understand math</a></li>
<li><a href="../398897/index.html">Yandex launched the service "Health"</a></li>
<li><a href="../398899/index.html">Masterkeys Pro L: customize all fields</a></li>
<li><a href="../398901/index.html">LipNet neural network reads lips with 93.4% accuracy</a></li>
<li><a href="../398903/index.html">The everlasting beauty of the cosmos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>