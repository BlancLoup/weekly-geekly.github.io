<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to keep the original color of your code from Visual Studio in the publication on Habrahabr. Compare colors. Poll</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habrayuzer! In this post, I will tell you how you can make your code on Habr√© more "alive" thanks to a simple way to preserve its original color s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to keep the original color of your code from Visual Studio in the publication on Habrahabr. Compare colors. Poll</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habrayuzer!  In this post, I will tell you how you can make your code on Habr√© more "alive" thanks to a simple way to preserve its original color scheme.  And also I propose to compare various color code options. <a name="habracut"></a><br><br><h4>  Foreword </h4><br>  Now I am in the process of writing my first article for Habr about web services.  And from the very beginning I decided that the source codes will be highlighted with a third-party habr-highlighter, since the standard <b>&lt;source&gt; tag</b> in my opinion does not give a qualitative effect of syntax highlighting.  However, I found only one alternative highlighter - <a href="http://highlight.hohli.com/">http://highlight.hohli.com</a> .  The result of his coloring, unfortunately, did not inspire me.  At the end of the post I show it in the number of 6 color options for direct comparison.  Once there used to be another HighLater - <b>Source Code Highlighter</b> , described on Habr√© <a href="http://habrahabr.ru/post/24959/">here</a> and <a href="http://habrahabr.ru/post/40669/">here</a> , but it has <a href="http://virtser.net/projects">not been working</a> for a long time.  Then I remembered that the code from Visual Studio fully retains its appearance when copying to Word, this simple technique became the basis of my method. <br><br><h4>  Method </h4><br>  The idea is simple: the code is copied to Word, the document is saved as an html web page and the function converts the html code to habra-compatible.  Consider an example.  This simple code, when saved, gives the following <b>&lt;body&gt;</b> content, where I marked all the <b>&lt;span&gt;</b> tags in blue, pink - the color of the style, and brown - the displayed text itself. <br><blockquote>  <font color="blue">private</font> <font color="black">&nbsp;</font>  <font color="blue">void</font> <font color="black">Hello () {</font> <br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="#2B91AF">MessageBox</font> <font color="black">.Show (</font> <font color="#A31515">"Hello Habrahabr!"</font> <font color="black">);</font> <br>  <font color="black">}</font> <br></blockquote><div class="spoiler">  <b class="spoiler_title">Hello.htm</b> <div class="spoiler_text"><blockquote>  &lt;body lang = RU style = 'tab-interval: 35.4pt'&gt; <br>  &lt;div class = WordSection1&gt; 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      &lt;p class = MsoNormal style = 'margin-bottom: 0cm; margin-bottom: .0001pt; line-height: <br>  normal; mso-layout-grid-align: none; text-autospace: none '&gt; <font color="#0107FF">&lt;span</font> lang = EN-US <br>  style = 'font-size: 9.5pt; font-family: Consolas;  <font color="#FF3399">color: black</font> ; background: white; <br>  mso-highlight: white; mso-ansi-language: EN-US ' <font color="#0107FF">&gt; &lt;span</font> <br>  style = 'mso-spacerun: yes' <font color="#0107FF">&gt;</font> <font color="#0107FF">&lt;/ span&gt; &lt;/ span&gt; &lt;span</font> class = GramE <font color="#0107FF">&gt; &lt;span</font> <br>  lang = EN-US style = 'font-size: 9.5pt; font-family: Consolas;  <font color="#FF3399">color: blue</font> ; background: <br>  white; mso-highlight: white; mso-ansi-language: EN-US ' <font color="#0107FF">&gt;</font> <b><font color="#C00000">private</font></b> <font color="#0107FF">&lt;/ span&gt; &lt;/ span&gt; &lt;span</font> <br>  lang = EN-US style = 'font-size: 9.5pt; font-family: Consolas;  <font color="#FF3399">color: black</font> ; background: <br>  white; mso-highlight: white; mso-ansi-language: EN-US ' <font color="#0107FF">&gt;</font> <font color="#0107FF">&lt;/ span&gt; &lt;span</font> lang = EN-US <br>  style = 'font-size: 9.5pt; font-family: Consolas;  <font color="#FF3399">color: blue</font> ; background: white; <br>  mso-highlight: white; mso-ansi-language: EN-US ' <font color="#0107FF">&gt;</font> <b><font color="#C00000">void</font></b> <font color="#0107FF">&lt;/ span&gt; &lt;span</font> lang = EN-US <br>  style = 'font-size: 9.5pt; font-family: Consolas;  <font color="#FF3399">color: black</font> ; background: white; <br>  mso-highlight: white; mso-ansi-language: EN-US ' <font color="#0107FF">&gt;</font> <b><font color="#C00000">Hello () {</font></b> &lt;o: p&gt; &lt;/ o: p&gt; <font color="#0107FF">&lt;/ span&gt;</font> &lt;/ p&gt; <br><br>  &lt;p class = MsoNormal style = 'margin-bottom: 0cm; margin-bottom: .0001pt; line-height: <br>  normal; mso-layout-grid-align: none; text-autospace: none '&gt; &lt; <font color="#0107FF">span</font> lang = EN-US <br>  style = 'font-size: 9.5pt; font-family: Consolas;  <font color="#FF3399">color: black</font> ; background: white; <br>  mso-highlight: white; mso-ansi-language: EN-US '&gt; <font color="#0107FF">&lt;span</font> <br>  style = 'mso-spacerun: yes'&gt; <font color="#0107FF">&lt;/ span&gt; &lt;/ span&gt; &lt;span</font> class = GramE&gt; &lt; <font color="#0107FF">span</font> <br>  lang = EN-US style = 'font-size: 9.5pt; font-family: Consolas;  <font color="#FF3399">color: # 2B91AF</font> ; <br>  background: white; mso-highlight: white; mso-ansi-language: EN-US '&gt; <b><font color="#C00000">MessageBox</font></b> &lt;/ <font color="#0107FF">span</font> &gt; &lt; <font color="#0107FF">span</font> <br>  lang = EN-US style = 'font-size: 9.5pt; font-family: Consolas;  <font color="#FF3399">color: black</font> ; background: <br>  white; mso-highlight: white; mso-ansi-language: EN-US '&gt; <b><font color="#C00000">.Show (</font></b> <font color="#0107FF">&lt;/ span&gt; &lt;/ span&gt; &lt;span</font> <br>  lang = EN-US style = 'font-size: 9.5pt; font-family: Consolas;  <font color="#FF3399">color: # A31515</font> ; <br>  background: white; mso-highlight: white; mso-ansi-language: EN-US ' <font color="#C00000">&gt; <b>&amp; quot; Hello</b></font> <br>  <b><font color="#C00000">Habrahabr</font></b> <b><font color="#C00000">! &amp;</font></b> <b><font color="#C00000">Quot</font></b> <b><font color="#C00000">;</font></b>  <font color="#0107FF">&lt;/ span&gt; &lt;span</font> lang = EN-US style = 'font-size: 9.5pt; font-family: <br>  Consolas;  <font color="#FF3399">color: black</font> ; background: white; mso-highlight: white; mso-ansi-language: <br>  EN-US '&gt; <b>);</b>  &lt;o: p&gt; &lt;/ o: p&gt; <font color="#0107FF">&lt;/ span&gt;</font> &lt;/ p&gt; <br><br>  &lt;p class = MsoNormal&gt; <font color="#0107FF">&lt;span</font> lang = EN-US style = 'font-size: 9.5pt; line-height: 115%; <br>  font-family: Consolas;  <font color="#FF3399">color: black</font> ; background: white; mso-highlight: white; <br>  mso-ansi-language: EN-US '&gt; <font color="#0107FF">&lt;span</font> style =' mso-spacerun: yes' <font color="#0107FF">&gt;</font> <font color="#0107FF">&lt;/ span&gt; &lt;/ span&gt; &lt;span</font> <br>  style = 'font-size: 9.5pt; line-height: 115%; font-family: Consolas;  <font color="#FF3399">color: black</font> ; <br>  background: white; mso-highlight: white ' <font color="#0107FF">&gt;</font> <b><font color="#C00000">}</font></b> <font color="#0107FF">&lt;/ span&gt;</font> &lt;/ p&gt; <br><br>  &lt;/ div&gt; <br>  &lt;/ body&gt; </blockquote></div></div><br>  As you can see, each line of the source code is converted into a <b>&lt;p&gt; tag</b> , inside which the text is formatted using nested <b>&lt;span&gt;</b> tags, and its color is stored in the <b>style</b> attribute.  The transformation algorithm becomes clear: for each <b>&lt;p&gt; tag</b> from <b>"/ html / body / div / p"</b> to produce a recursive translation of its contents into a new html document, setting the text color using the <b>&lt;font&gt;</b> tag.  Under the spoiler is the full source code of the resulting method, which looks in accordance with my original color scheme.  To work with html used library <b><a href="http://htmlagilitypack.codeplex.com/">Html Agility Pack</a></b> . <br><br><div class="spoiler">  <b class="spoiler_title">HabraCodeFormatter.cs</b> <div class="spoiler_text"><blockquote><ol><li>  <font color="blue">using</font> System; </li><li>  <font color="blue">using</font> System.IO; </li><li>  <font color="blue">using</font> HtmlAgilityPack; </li><li></li><li>  <font color="blue">namespace</font> HabraCode { </li><li>  <font color="blue">public</font> <font color="blue">static</font> <font color="blue">class</font> <font color="#0085AC">HabraCodeFormatter</font> { </li><li>  <font color="blue">const</font> <font color="blue">char</font> <b><font color="#804000">spaceClassic</font></b> = ( <font color="blue">char</font> ) <b>32</b> ; </li><li>  <font color="blue">const</font> <font color="blue">char</font> <b><font color="#804000">spaceNbsp</font></b> = ( <font color="blue">char</font> ) <b>160</b> ; </li><li></li><li>  <font color="blue">public</font> <font color="blue">static</font> <font color="blue">void</font> <font color="#C71288">Format</font> ( <font color="blue">string</font> fileHtm, <font color="blue">bool</font> withLineNumbers = <font color="blue">false</font> ) { </li><li>  <font color="blue">var</font> info = <font color="blue">new</font> <font color="#0085AC">FileInfo</font> (fileHtm); </li><li>  <font color="blue">string</font> destFile = info.  <font color="#C75612">DirectoryName</font> + <font color="#A31515">"\\"</font> + info.  <font color="#C75612">Name</font> .  <font color="#C71288">Replace</font> (info. <font color="#C75612">Extension</font> , <font color="blue">null</font> ) + <font color="#A31515">"_result.txt"</font> ; </li><li>  <font color="#C71288">Format</font> (fileHtm, destFile, withLineNumbers); </li><li>  } </li><li></li><li></li><li>  <font color="blue">public</font> <font color="blue">static</font> <font color="blue">void</font> <font color="#C71288">Format</font> ( <font color="blue">string</font> fileHtm, <font color="blue">string</font> fileDest, <font color="blue">bool</font> withLineNumbers = <font color="blue">false</font> ) { </li><li>  <font color="blue">var</font> doc = <font color="blue">new</font> <font color="#0085AC">HtmlDocument</font> (); </li><li>  doc.  <font color="#C71288">Load</font> (fileHtm); </li><li>  <font color="blue">var</font> nodes = doc.  <font color="#C75612">DocumentNode</font> .  <font color="#C71288">SelectNodes</font> ( <font color="#A31515">"/ html / body / div / p"</font> ); </li><li>  <font color="blue">int</font> spacesToDelete = <font color="#C71288">getSpacesToDelete</font> (nodes [ <b>0</b> ]); </li><li></li><li>  <font color="blue">var</font> result = <font color="blue">new</font> <font color="#0085AC">HtmlDocument</font> (); </li><li>  <font color="blue">var</font> rootNode = result.  <font color="#C71288">CreateElement</font> ( <font color="#A31515">"</font> <font color="#C71288">blockquote</font> <font color="#A31515">"</font> ); </li><li>  result.  <font color="#C75612">DocumentNode</font> .  <font color="#C71288">AppendChild</font> (rootNode); </li><li></li><li>  <font color="blue">if</font> (withLineNumbers) { </li><li>  <font color="blue">var</font> nodeOl = result.  <font color="#C71288">CreateElement</font> ( <font color="#A31515">"ol"</font> ); </li><li>  rootNode.  <font color="#C71288">AppendChild</font> (nodeOl); </li><li>  rootNode = nodeOl; </li><li>  } </li><li></li><li>  <font color="blue">foreach</font> ( <font color="blue">var</font> node <font color="blue">in</font> nodes) { </li><li>  <font color="blue">if</font> (withLineNumbers) { </li><li>  <font color="blue">var</font> nodeLi = doc.  <font color="#C71288">CreateElement</font> ( <font color="#A31515">"li"</font> ); </li><li>  nodeLi.  <font color="#C71288">AppendChildren</font> (node. <font color="#C75612">ChildNodes</font> ); </li><li>  node.  <font color="#C71288">RemoveAllChildren</font> (); </li><li>  node.  <font color="#C71288">AppendChild</font> (nodeLi); </li><li>  } </li><li></li><li>  <font color="blue">int</font> refSpaces = spacesToDelete; </li><li>  <font color="#C71288">translateNode</font> (node, rootNode, <font color="blue">ref</font> refSpaces); </li><li>  rootNode.  <font color="#C71288">AppendChild</font> (result. <font color="#C71288">CreateTextNode</font> ( <font color="#0085AC">Environment</font> . <font color="#C75612">NewLine</font> )); </li><li>  } </li><li></li><li>  result.  <font color="#C71288">Save</font> (fileDest); </li><li>  } </li><li></li><li></li><li>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">int</font> <font color="#C71288">getSpacesToDelete</font> ( <font color="#0085AC">HtmlNode</font> node) { </li><li>  <font color="blue">for</font> ( <font color="blue">int</font> index = <b>0</b> ; index &lt;node. <font color="#C75612">InnerText</font> . <font color="#C75612">Length</font> ; index ++) { </li><li>  <font color="blue">if</font> (! <font color="#C71288">isSpace</font> (node. <font color="#C75612">InnerText</font> [index])) { </li><li>  <font color="blue">return</font> index; </li><li>  } </li><li>  } </li><li></li><li>  <font color="blue">return</font> <b>0</b> ; </li><li>  } </li><li></li><li></li><li>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">void</font> <font color="#C71288">translateNode</font> ( <font color="#0085AC">HtmlNode</font> node, <font color="#0085AC">HtmlNode</font> destParent, <font color="blue">ref</font> <font color="blue">int</font> spacesToDelete) { </li><li>  <font color="#0085AC">HtmlNode</font> destNode = destParent; </li><li></li><li>  <font color="blue">switch</font> (node. <font color="#C75612">Name</font> ) { </li><li>  <font color="blue">case</font> <font color="#A31515">"o: p"</font> : </li><li>  <font color="blue">case</font> <font color="#A31515">"p"</font> : </li><li>  <font color="blue">break</font> ; </li><li></li><li>  <font color="blue">case</font> <font color="#A31515">"span"</font> : </li><li>  <font color="blue">string</font> color = <font color="#C71288">getColor</font> (node); </li><li></li><li>  <font color="blue">if</font> (color! = <font color="blue">null</font> ) { </li><li>  destNode = destParent.  <font color="#C75612">OwnerDocument</font> .  <font color="#C71288">CreateElement</font> ( <font color="#A31515">"font"</font> ); </li><li>  destNode.  <font color="#C71288">SetAttributeValue</font> ( <font color="#A31515">"color"</font> , color); </li><li>  } </li><li>  <font color="blue">break</font> ; </li><li></li><li>  <font color="blue">case</font> <font color="#A31515">"#text"</font> : </li><li>  <font color="blue">string</font> text = <font color="#C71288">translateText</font> (node. <font color="#C75612">InnerText</font> , <font color="blue">ref</font> spacesToDelete); </li><li>  destNode = destParent.  <font color="#C75612">OwnerDocument</font> .  <font color="#C71288">CreateTextNode</font> (text); </li><li>  <font color="blue">break</font> ; </li><li></li><li>  <font color="blue">case</font> <font color="#A31515">"b"</font> : </li><li>  <font color="blue">case</font> <font color="#A31515">"li"</font> : </li><li>  destNode = destParent.  <font color="#C75612">OwnerDocument</font> .  <font color="#C71288">CreateElement</font> (node. <font color="#C75612">Name</font> ); </li><li>  <font color="blue">break</font> ; </li><li></li><li>  <font color="blue">default</font> : </li><li>  <font color="blue">throw</font> <font color="blue">new</font> <font color="#0085AC">InvalidOperationException</font> ( <font color="#A31515">"Unexpected node.Name"</font> + node. <font color="#C75612">Name</font> ); </li><li>  } </li><li></li><li>  <font color="blue">if</font> (! <font color="#C71288">ReferenceEquals</font> (destNode, destParent)) { </li><li>  destParent.  <font color="#C75612">ChildNodes</font> .  <font color="#C71288">Add</font> (destNode); </li><li>  } </li><li></li><li>  <font color="blue">if</font> (node. <font color="#C75612">HasChildNodes</font> ) { </li><li>  <font color="blue">foreach</font> ( <font color="#0085AC">HtmlNode</font> child <font color="blue">in</font> node. <font color="#C75612">ChildNodes</font> ) { </li><li>  <font color="#C71288">translateNode</font> (child, destNode, <font color="blue">ref</font> spacesToDelete); </li><li>  } </li><li>  } </li><li>  } </li><li></li><li></li><li>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">string</font> <font color="#C71288">translateText</font> ( <font color="blue">string</font> text, <font color="blue">ref</font> <font color="blue">int</font> spaces) { </li><li>  <font color="blue">if</font> ( <font color="blue">string</font> . <font color="#C71288">IsNullOrEmpty</font> (text)) { </li><li>  <font color="blue">return</font> text; </li><li>  } </li><li></li><li>  text = text.  <font color="#C71288">Replace</font> ( <font color="#A31515">"http: //"</font> , <font color="#A31515">"http &amp; # 58; //"</font> ); </li><li>  text = text.  <font color="#C71288">Replace</font> ( <font color="#A31515">"\ r \ n"</font> , <font color="#A31515">""</font> ); </li><li></li><li>  <font color="blue">if</font> (spaces&gt; <b>0</b> &amp;&amp; text. <font color="#C75612">Length</font> &gt; = spaces &amp;&amp; <font color="#C71288">isSpace</font> (text. <font color="#C71288">Substring</font> ( <b>0</b> , spaces))) { </li><li>  text = text.  <font color="#C71288">Remove</font> ( <b>0</b> , spaces); </li><li>  spaces = <b>0</b> ; </li><li>  } </li><li></li><li>  text = text.  <font color="#C71288">Replace</font> ( <b><font color="#804000">spaceClassic</font></b> . <font color="#C71288">ToString</font> (), <font color="#A31515">"&amp; nbsp;"</font> ); </li><li>  text = text.  <font color="#C71288">Replace</font> ( <b><font color="#804000">spaceNbsp</font></b> . <font color="#C71288">ToString</font> (), <font color="#A31515">"&amp; nbsp;"</font> ); </li><li>  <font color="blue">return</font> text; </li><li>  } </li><li></li><li></li><li>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">bool</font> <font color="#C71288">isSpace</font> ( <font color="blue">char</font> ch) { </li><li>  <font color="blue">return</font> (ch == <b><font color="#804000">spaceClassic</font></b> || ch == <b><font color="#804000">spaceNbsp</font></b> ); </li><li>  } </li><li></li><li></li><li>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">bool</font> <font color="#C71288">isSpace</font> ( <font color="blue">string</font> text) { </li><li>  <font color="blue">foreach</font> ( <font color="blue">char</font> ch <font color="blue">in</font> text) { </li><li>  <font color="blue">if</font> (! <font color="#C71288">isSpace</font> (ch)) { </li><li>  <font color="blue">return</font> <font color="blue">false</font> ; </li><li>  } </li><li>  } </li><li></li><li>  <font color="blue">return</font> <font color="blue">true</font> ; </li><li>  } </li><li></li><li></li><li>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">string</font> <font color="#C71288">getColor</font> ( <font color="#0085AC">HtmlNode</font> node) { </li><li>  <font color="blue">var</font> attr = node.  <font color="#C75612">Attributes</font> [ <font color="#A31515">"style"</font> ]; </li><li></li><li>  <font color="blue">if</font> (attr == <font color="blue">null</font> || attr. <font color="#C75612">Value</font> == <font color="blue">null</font> ) { </li><li>  <font color="blue">return</font> <font color="blue">null</font> ; </li><li>  } </li><li></li><li>  <font color="blue">string</font> [] values ‚Äã‚Äã= attr.  <font color="#C75612">Value</font> .  <font color="#C71288">Split</font> ( <font color="blue">new</font> [] { <font color="#A31515">';'</font> }); </li><li></li><li>  <font color="blue">foreach</font> ( <font color="blue">string</font> value <font color="blue">in</font> values) { </li><li>  <font color="blue">const</font> <font color="blue">string</font> <b><font color="#804000">prefixColor</font></b> = <font color="#A31515">"color:"</font> ; </li><li>  <font color="blue">string</font> trimmed = value.  <font color="#C71288">Trim</font> (); </li><li></li><li>  <font color="blue">if</font> (trimmed. <font color="#C71288">StartsWith</font> ( <b><font color="#804000">prefixColor</font></b> )) { </li><li>  <font color="blue">return</font> trimmed.  <font color="#C71288">Remove</font> ( <b>0</b> , <b><font color="#804000">prefixColor</font></b> . <font color="#C75612">Length</font> ); </li><li>  } </li><li>  } </li><li></li><li>  <font color="blue">return</font> <font color="blue">null</font> ; </li><li>  } </li><li>  } </li><li>  } </li></ol></blockquote></div></div><br>  Probably, many will call my code coloring too motley, and therefore inconvenient, but it significantly improves my process of working with the source code.  This is a very simple way to increase your efficiency a bit.  A little comment on the code.  The class contains two overloads of the Format method, where the required parameter is the path to the source html file, and the flag of adding line numbers is optional.  The second overload allows you to explicitly specify the target file, otherwise the result will be saved as [original_name] _result.txt.  The getSpacesToDelete method allows you to find the number of leading spaces in the first line in order to remove them in all subsequent lines. <br><br>  Setting the font and colors of source code in Visual Studio is done in <b>Tools&gt; Options&gt; Environment&gt; Fonts and Colors</b> .  However, initially it is not at all possible to set its own color for a method or property.  But if you use ReSharper, this possibility appears.  To do this, in the <b>ReSharper&gt; Options&gt; Code Inspection&gt; Settings</b> menu, you must enable the <b>Color identifires</b> item.  And here you can experience a light cognitive dissonance, because the methods will become turquoise - the colors in the traditional scheme have such a color, and the classes will become dark blue - all this can be seen below, where I compare the colors. <br><br>  In my diagram, classes, keywords, and other elements have a classic color, but they add their own colors for methods and properties.  For those who want to try it, quote setting.  Save the xml as a spoiler as a file with the .vssettings extension in UTF-8 encoding without a BOM, for example, HabraCode.vssettings, and import the settings using the <b>Tools&gt; Import and Export Settings&gt; Import ...</b> menu <b>.</b> You can set the encoding, for example, using <a href="http://notepad-plus-plus.org/">Notepad ++</a> .  By default, the wizard also saves all your current settings along the way - to be able to roll back changes.  After importing, the font will be reset to default, and if you had a custom one, you will have to specify it again.  Also in the ‚ÄúPlain Text‚Äù setting, I slightly reduced the whiteness of the background, reducing from absolute to #FAFAFA. <br><br><div class="spoiler">  <b class="spoiler_title">HabraCode.vssettings</b> <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ApplicationIdentity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10.0"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ToolsOptions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ToolsOptionsCategory</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Environment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">RegisteredName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Environment"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ToolsOptions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Environment_Group"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">RegisteredName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Environment_Group"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Environment_FontsAndColors"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Category</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{1EDA5DD4-927A-43a7-810E-7FD247D0DA1D}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{DA9FB551-C724-11d0-AE1F-00A0C90FFFC3}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">RegisteredName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Environment_FontsAndColors"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PackageName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Visual Studio Environment Package"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyValue</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Version"</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FontsAndColors</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Categories</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">GUID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{A27B4E24-A735-4D1D-B8E7-9716E1E3D8E0}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Items</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Plain Text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00FAFAFA"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Literal"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Yes"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Number"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Yes"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Namespace Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Mutable Local Variable Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--:  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x001515A3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String(C# @ Verbatim)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x001515A3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--: - --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Extension Method Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x008812C7"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Method Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x008812C7"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Operator Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x008812C7"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--, , : - --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Event Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x001256C7"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Field Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x001256C7"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--:  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Class Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00AC8500"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Delegate Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00AC8500"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Enum Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00AC8500"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Static Class Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00AC8500"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Interface Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00AC8500"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Struct Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00AC8500"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Type Parameter Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00AC8500"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- todo  bug. NotImplementedException: --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Todo Item"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x000000F5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Yes"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Todo Item Marker on Error Stripe"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x000000F5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"No"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- string.Format:  + bold--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Format String Item"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00AC8500"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Yes"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--:  + bold --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReSharper Constant Identifier"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x00004080"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0x02000000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BoldFont</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Yes"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Items</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Category</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Categories</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FontsAndColors</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Category</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Category</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserSettings</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><h4>  Comparison </h4><br>  Now I propose to compare 6 variants of code coloring by the example of one of the methods.  It cannot be argued that some kind of coloring is in principle the best, because, as you know, there are no comrades to taste and color.  But I am interested in the collective opinion of the habr-community. <br><br>  <b>1. &lt;source lang = "cs"&gt;</b> <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getColor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HtmlNode node</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> attr = node.Attributes[<span class="hljs-string"><span class="hljs-string">"style"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (attr == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || attr.Value == <span class="hljs-literal"><span class="hljs-literal">null</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] values = attr.Value.Split(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> [] {<span class="hljs-string"><span class="hljs-string">';'</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> values){ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> prefixColor = <span class="hljs-string"><span class="hljs-string">"color:"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> trimmed = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Trim(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (trimmed.StartsWith(prefixColor)){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> trimmed.Remove(<span class="hljs-number"><span class="hljs-number">0</span></span>, prefixColor.Length); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre><br>  <b>2. Black-and-white code</b> (obtained through HabraCodeFormatter with discarded color and bold) <br><blockquote>  private static string getColor (HtmlNode node) { <br>  var attr = node.Attributes ["style"]; <br><br>  if (attr == null || attr.Value == null) { <br>  return null; <br>  } <br><br>  string [] values ‚Äã‚Äã= attr.Value.Split (new [] {';'}); <br><br>  foreach (string value in values) { <br>  const string prefixColor = "color:"; <br>  string trimmed = value.Trim (); <br><br>  if (trimmed.StartsWith (prefixColor)) { <br>  return trimmed.Remove (0, prefixColor.Length); <br>  } <br>  } <br><br>  return null; <br>  } <br><br></blockquote><br>  <b>3. http://highlight.hohli.com</b> <br><blockquote>  <font color="#0600FF">private</font> <font color="#0600FF">static</font> <font color="#6666cc">string</font> getColor <font color="#008000">(</font> HtmlNode node <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#0600FF">var</font> attr <font color="#008000">=</font> node <font color="#008000">.</font>  <font color="#0000FF">Attributes</font> <font color="#008000">[</font> <font color="#666666">"style"</font> <font color="#008000">]</font> <font color="#008000">;</font> <br><br>  <font color="#0600FF">if</font> <font color="#008000">(</font> attr <font color="#008000">==</font> <font color="#0600FF">null</font> <font color="#008000">||</font> attr <font color="#008000">.</font> <font color="#0600FF">Value</font> <font color="#008000">==</font> <font color="#0600FF">null</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#0600FF">return</font> <font color="#0600FF">null</font> <font color="#008000">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#6666cc">string</font> <font color="#008000">[</font> <font color="#008000">]</font> values <font color="#008000">=</font> attr <font color="#008000">.</font>  <font color="#0600FF">Value</font> <font color="#008000">.</font>  <font color="#0000FF">Split</font> <font color="#008000">(</font> <font color="#008000">new</font> <font color="#008000">[</font> <font color="#008000">]</font> <font color="#008000">{</font> <font color="#666666">';'</font> <font color="#008000">}</font> <font color="#008000">)</font> <font color="#008000">;</font> <br><br>  <font color="#0600FF">foreach</font> <font color="#008000">(</font> <font color="#6666cc">string</font> <font color="#0600FF">value</font> <font color="#0600FF">in</font> values <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#0600FF">const</font> <font color="#6666cc">string</font> prefixColor <font color="#008000">=</font> <font color="#666666">"color:"</font> <font color="#008000">;</font> <br>  <font color="#6666cc">string</font> trimmed <font color="#008000">=</font> <font color="#0600FF">value</font> <font color="#008000">.</font>  <font color="#0000FF">Trim</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">;</font> <br><br>  <font color="#0600FF">if</font> <font color="#008000">(</font> trimmed <font color="#008000">.</font> <font color="#0000FF">StartsWith</font> <font color="#008000">(</font> prefixColor <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#0600FF">return</font> trimmed <font color="#008000">.</font>  <font color="#0600FF">Remove</font> <font color="#008000">(</font> <font color="#FF0000">0</font> , prefixColor <font color="#008000">.</font> <font color="#0000FF">Length</font> <font color="#008000">)</font> <font color="#008000">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0600FF">return</font> <font color="#0600FF">null</font> <font color="#008000">;</font> <br>  <font color="#008000">}</font> </blockquote><br>  <b>4. Standard Visual Studio Color</b> <br><blockquote>  <font color="blue">private</font> <font color="black">&nbsp;</font>  <font color="blue">static</font> <font color="black">&nbsp;</font>  <font color="blue">string</font> <font color="black">getColor (</font> <font color="#2B91AF">HtmlNode</font> <font color="black">node) {</font> <br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">var</font> <font color="black">attr = node.Attributes [</font> <font color="#A31515">"style"</font> <font color="black">];</font> <br><font color="black">&nbsp;</font><br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">if</font> <font color="black">(attr ==</font> <font color="blue">null</font> <font color="black">|| attr.Value ==</font> <font color="blue">null</font> <font color="black">) {</font> <br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">return</font> <font color="black">&nbsp;</font>  <font color="blue">null</font> <font color="black">;</font> <br>  <font color="black">}</font> <br><font color="black">&nbsp;</font><br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">string</font> <font color="black">[</font> <font color="black">] values ‚Äã‚Äã= attr.Value.Split (</font> <font color="blue">new</font> <font color="black">[] {</font> <font color="#A31515">';'</font> <font color="black">});</font> <br><font color="black">&nbsp;</font><br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">foreach</font> <font color="black">(</font> <font color="blue">string</font> <font color="black">value</font> <font color="blue">in</font> <font color="black">values) {</font> <br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">const</font> <font color="black">&nbsp;</font>  <font color="blue">string</font> <font color="black">prefixColor =</font> <font color="#A31515">"color:"</font> <font color="black">;</font> <br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">string</font> <font color="black">trimmed = value.Trim ();</font> <br><font color="black">&nbsp;</font><br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">if</font> <font color="black">(trimmed.StartsWith (prefixColor)) {</font> <br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">return</font> <font color="black">trimmed.Remove (0, prefixColor.Length);</font> <br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="black">}</font> <br>  <font color="black">}</font> <br><font color="black">&nbsp;</font><br><font color="black">&nbsp;&nbsp;&nbsp;&nbsp;</font>  <font color="blue">return</font> <font color="black">&nbsp;</font>  <font color="blue">null</font> <font color="black">;</font> <br>  <font color="black">}</font> <br></blockquote><br>  <b>5. Standard Reshaper Color</b> <br><blockquote>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">string</font> <font color="darkcyan">getColor</font> ( <font color="darkblue">HtmlNode</font> node) { <br>  <font color="blue">var</font> attr = node.  <font color="purple">Attributes</font> [ <font color="#A31515">"style"</font> ]; <br><br>  <font color="blue">if</font> (attr == <font color="blue">null</font> || attr. <font color="purple">Value</font> == <font color="blue">null</font> ) { <br>  <font color="blue">return</font> <font color="blue">null</font> ; <br>  } <br><br>  <font color="blue">string</font> [] values ‚Äã‚Äã= attr.  <font color="purple">Value</font> .  <font color="darkcyan">Split</font> ( <font color="blue">new</font> [] { <font color="#A31515">';'</font> }); <br><br>  <font color="blue">foreach</font> ( <font color="blue">string</font> <b>value</b> <font color="blue">in</font> values) { <br>  <font color="blue">const</font> <font color="blue">string</font> <b><font color="purple">prefixColor</font></b> = <font color="#A31515">"color:"</font> ; <br>  <font color="blue">string</font> trimmed = <b>value</b> .  <font color="darkcyan">Trim</font> (); <br><br>  <font color="blue">if</font> (trimmed. <font color="darkcyan">StartsWith</font> ( <b><font color="purple">prefixColor</font></b> )) { <br>  <font color="blue">return</font> trimmed.  <font color="darkcyan">Remove</font> (0, <b><font color="purple">prefixColor</font></b> . <font color="purple">Length</font> ); <br>  } <br>  } <br><br>  <font color="blue">return</font> <font color="blue">null</font> ; <br>  } <br><br></blockquote><br>  <b>6. Author's colors</b> <br><blockquote>  <font color="blue">private</font> <font color="blue">static</font> <font color="blue">string</font> <font color="#C71288">getColor</font> ( <font color="#0085AC">HtmlNode</font> node) { <br>  <font color="blue">var</font> attr = node.  <font color="#C75612">Attributes</font> [ <font color="#A31515">"style"</font> ]; <br><br>  <font color="blue">if</font> (attr == <font color="blue">null</font> || attr. <font color="#C75612">Value</font> == <font color="blue">null</font> ) { <br>  <font color="blue">return</font> <font color="blue">null</font> ; <br>  } <br><br>  <font color="blue">string</font> [] values ‚Äã‚Äã= attr.  <font color="#C75612">Value</font> .  <font color="#C71288">Split</font> ( <font color="blue">new</font> [] { <font color="#A31515">';'</font> }); <br><br>  <font color="blue">foreach</font> ( <font color="blue">string</font> value <font color="blue">in</font> values) { <br>  <font color="blue">const</font> <font color="blue">string</font> <b><font color="#804000">prefixColor</font></b> = <font color="#A31515">"color:"</font> ; <br>  <font color="blue">string</font> trimmed = value.  <font color="#C71288">Trim</font> (); <br><br>  <font color="blue">if</font> (trimmed. <font color="#C71288">StartsWith</font> ( <b><font color="#804000">prefixColor</font></b> )) { <br>  <font color="blue">return</font> trimmed.  <font color="#C71288">Remove</font> ( <b>0</b> , <b><font color="#804000">prefixColor</font></b> . <font color="#C75612">Length</font> ); <br>  } <br>  } <br><br>  <font color="blue">return</font> <font color="blue">null</font> ; <br>  } <br><br></blockquote></div><p>Source: <a href="https://habr.com/ru/post/242341/">https://habr.com/ru/post/242341/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242331/index.html">What is missing engineering education</a></li>
<li><a href="../242333/index.html">False correlations from the open data of the Perm region</a></li>
<li><a href="../242335/index.html">FLProg is an alternative Arduino programming environment. Project Description</a></li>
<li><a href="../242337/index.html">Testing the performance of forks Mysql on real data</a></li>
<li><a href="../242339/index.html">WGDC Competition: Final Close</a></li>
<li><a href="../242343/index.html">Online conference Stratoplan PRO + People and the year in Habr√©</a></li>
<li><a href="../242347/index.html">Sam Altman: How to form a start-up team and culture?</a></li>
<li><a href="../242349/index.html">NetApp Certification</a></li>
<li><a href="../242351/index.html">XMonad + XMobar =</a></li>
<li><a href="../242353/index.html">Problems in the implementation and sale of electronic document management systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>