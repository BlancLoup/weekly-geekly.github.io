<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A fistful of relays. Part 2 - Register File</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="More than a year has passed since I started writing about developing a computer with electromagnetic relays . Today I finished work on the second modu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A fistful of relays. Part 2 - Register File</h1><div class="post__text post__text-html js-mediator-article">  More than a year has passed since I started writing <a href="http://habrahabr.ru/post/220865/">about developing a computer with electromagnetic relays</a> .  Today I finished work on the second module of the computer - the register file. <br><br><img src="https://habrastorage.org/files/ae4/56c/510/ae456c51068548a2841e2fb9071c8049.jpg"><br><a name="habracut"></a><br>  Now it has become clear that the computer will consist of 4 blocks: an <a href="http://habrahabr.ru/post/220865/">ALU</a> , a register file, a control block, a memory block and peripherals. <br><br>  The block of registers is the easiest to organize - in each register there are 8 relays for storing bits, a relay for resetting and several relays for connecting the register to the bus. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/d1f/4a3/f54/d1f4a3f549cb409ab9415e421ee7f136.png"><br><br>  But nevertheless I was the first to do the <a href="http://habrahabr.ru/post/220865/">ALU</a> in order to understand the construction of logic circuits on the relay.  In addition, this immediately turned out to be an 8-bit calculator, which now sometimes includes colleagues (for quite some time now the computer has moved to my place of work). <br><br><h1>  How the relay saves data </h1><br>  Usually, the relay is not used for data storage, but only switches signals.  But if you add feedback to his work, the result may be an RS trigger.  So that once the relay does not turn off, but retains this on state, it is necessary to apply a voltage to the winding through its normally open contacts.  When the contacts close, this voltage will keep the relay on: <br><br><img src="https://habrastorage.org/files/ca5/a30/227/ca5a302279e440f4898e00e15af7d56d.png"><br><br>  Now to turn off this relay, it is necessary to break the connection between the power source and the winding.  To do this, use an additional relay responsible for resetting the trigger: <br><br><img src="https://habrastorage.org/files/765/e7a/e2b/765e7ae2b73542cbaa771756fe5129fb.png"><br><br>  Why bother dropping a relay at all?  The fact is that the easiest way to write a given value there is to reset the old one and to apply (or not to apply) the voltage to save the new state. <br>  Since the register is always reset entirely, the same reset relay is used for all its bits. <br><br>  The contacts of all the switches in the data storage relay are paralleled.  This is done to improve reliability - if one contact fails, the current will go through the other. <br><br><h1>  Computer architecture </h1><br>  Initially, I planned that the address bus at the computer would be 12-bit.  So you can easily split the entire address space into several 8-bit groups and connect different devices to them.  At the same time, address arithmetic will be simplified to 8-bit (almost like working with memory segments in 8086). <br><br>  Therefore, there were 2 types of registers in the register file - 4 pieces of 8-bit GPR, 2 pieces of ‚Äúsegment‚Äù 4 bits each, and 2 pieces with 8-bit offsets.  In this case, from the ‚Äúsegment‚Äù and ‚Äúoffsets‚Äù it was possible to form 2 full addresses, since the registers were added into fixed pairs, such as HL, DE, or BC in Z80.  But at the same time, any of the registers could be used as an input or output for an ALU. <br><br>  The changes began with the fact that I "suddenly" made the segment registers 8-bit.  This did not fundamentally change the architecture (the address bus remained 12-bit), but it gave more possibilities for calculations. <br><br>  Then I figured that even a simple summation of 256 memory cells would take several tens of minutes.  So I decided to narrow the address bus to 8 bits.  Because of this, the system of commands greatly simplified: <br><ol><li>  There is no need for separate commands 12-bit increment, 12-bit transfer, 12-bit load values. </li><li>  The transition, subroutine and load 8-bit values ‚Äã‚Äãare combined into one with minor differences. <br>  As a side effect, the value load command got the option of conditional execution. </li><li>  Memory management teams have options with an immediate address value. </li></ol><br><br>  Thanks to all this, the control module circuit also became easier.  The number of relays that will be required for it has greatly decreased.  Including due to the fact that it is not necessary to separately implement an instruction counter (since it moved to the register module in the form of an almost ordinary register). <br><br>  The result was something similar to the ARM processor's Thumb mode, but even simpler - 8 registers of 8 bits each.  One register serves as a return address, and the other serves as an instruction counter.  Any register can be used as any of the command arguments. <br>  The only exception is that only 4 out of 8 registers can be used as an address for reading (or writing) from memory. <br><br>  The buses to which the registers are connected, it turned out 3 pieces - 2 for transferring data (for example, an instruction code or operands to an ALU) and one for transmitting an address. <br><br><h1>  Design </h1><br>  The most difficult (or rather, tedious) was to make the plates with the names of registers.  Last time I ordered a laser engraving.  But the devices used for this purpose have a very small work area and this was not enough for my tablets.  Therefore, I took up photolithography.  I studied for a long time to glue / spray, exhibit and show a photoresist, until I got at least something acceptable.  The ideal is still far away, but this is not the last block in the computer. <br><br><img src="https://habrastorage.org/files/ac0/b37/485/ac0b374859f145a8a0059d2a104f92f0.jpg"><br><br>  I did not embed toggle switches to load values ‚Äã‚Äãinto registers in this block.  After all, the register module can immediately be connected to the ALU and use its toggle switches. <br><br>  Another feature of this module is that there are no additional LEDs for displaying signals.  All stored data can be monitored using control LEDs built into the relay.  Therefore, to remove the dump registers enough to have a camera. <br><br><img src="https://habrastorage.org/files/117/067/15e/11706715ea744d93b06d433a551a5be6.jpg"><br><br>  Today I already have two blocks of the future computer - a register file and an ALU.  But both of them are controlled by external signals and therefore can make calculations only in the calculator mode.  The housing for the control module is almost ready, so soon it will be possible to start launching circuits that make ticking sounds on their own. <br><br><h1>  What could be done better </h1><br>  Due to the fact that I abandoned the paired registers, the need for a double data bus disappeared. <br>  Now it is really needed only in one place - when retrieving instructions.  The size of all instructions is 16 bits, so a 16-bit bus is needed to load the entire instruction code in one clock cycle.  To connect the second argument to the ALU could use the address bus.  Due to this, it would be possible to save 8 relays in a block of registers (and, perhaps, a couple more in the control unit). <br><br>  I used bolts for a Phillips screwdriver to fasten the caption plates, since the old school version was over.  Does anyone know where you can get brass bolts with straight slot?  Last time I bought them in a hobby shop in Helsinki.  But it is quite expensive, and again I will not get there in the near future. <br><br><img src="https://habrastorage.org/files/d8f/dbf/609/d8fdbf60927a413c97ffcb7e29c5bf5e.jpg"><br><br>  Still need to somehow improve the negative mask printed on a laser printer.  Now black-flooded fields turned out to be slightly transparent.  Therefore, on some plates because of this, small points appeared.  Maybe someone knows how to win it? <br><br><h1>  Bonus </h1><br>  The following video is a working prototype clock generator.  I‚Äôll probably increase the frequency a bit to get about 5 clocks per second. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/uVY6qsk3CsQ%3Ffeature%3Doembed&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhrNAcvRF6uk1mcISKxIYrAI5M3nA" frameborder="0" allowfullscreen=""></iframe><br><br>  Project page on github: <a href="https://github.com/Dovgalyuk/Relay">github.com/Dovgalyuk/Relay</a> </div><p>Source: <a href="https://habr.com/ru/post/258337/">https://habr.com/ru/post/258337/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258327/index.html">Let's Lab. IS-IS routing protocol. Part 4 (final)</a></li>
<li><a href="../258329/index.html">DevConf 2015: 38 parrots or how a conference of communities of developers is trying to survive in the blockade of import substitution</a></li>
<li><a href="../258331/index.html">HTML page on Canvas</a></li>
<li><a href="../258333/index.html">All publications by Habrahabr, Hiktaims, Megamind in one place</a></li>
<li><a href="../258335/index.html">Vulnerability in KCodes NetUSB in D-Link, NETGEAR, TP-LINK, Trendnet, ZyXEL and other routers</a></li>
<li><a href="../258343/index.html">Apple has released the first update for Watch OS</a></li>
<li><a href="../258351/index.html">Three-dimensional figures of Soma as an idea for the children's designer</a></li>
<li><a href="../258353/index.html">Data retention on de-energized SSDs decreases with increasing temperature</a></li>
<li><a href="../258359/index.html">MBLT15 conference tomorrow</a></li>
<li><a href="../258363/index.html">Image Optimization for Google PageSpeed</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>