<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to crack a picture and (not) get BTC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="My attention was attracted by the work of American artist Andy Bach (Andy Bauch) in the form of paintings from Lego blocks. According to the author, t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to crack a picture and (not) get BTC</h1><div class="post__text post__text-html js-mediator-article">  My attention was attracted by the <a href="https://andybauch.com/">work of</a> American artist Andy Bach (Andy Bauch) in the form of paintings from Lego blocks.  According to the author, the private keys to the purses of various cryptocurrencies, including Bitcoin, are encrypted in them.  The cost of assets and addresses of the purses are on the page <a href="https://newmoney.andybauch.com/">newmoney.andybauch.com</a> <br><br>  <b>Challenge accepted</b> <br><br>  For example, take the most visual picture of Bitcoin Initially Valued at $ 60. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/ek/e2/0f/eke20fuezdir2os-recexn6c9no.jpeg" width="300"><br><br>  It encrypts the private key to the address <a href="https://blockchain.info/address/1HvEJG5JR84MVpncXcDVBqx65uY5odr6fP">1HvEJG5JR84MVpncXcDVBqx65uY5odr6fP</a> which contained ~ 0.14 Bitcoin (~ $ 1200). <br><a name="habracut"></a><br>  On blockchain.info we see the text prompt ‚ÄúRadix 6‚Äù, remember it and move on. <br><br>  With a keen eye we investigate and notice the following points: <br><br><ul><li>  Squares are only 6 colors, which means that we have 6-character encoding (radix 6) </li><li>  Vertical straight lines every 3 squares dividing them into blocks, starting with the first </li><li>  The pattern goes from left to right, consists of 30 blocks and then repeats. </li></ul><br>  6 characters are not enough to encode a classic WIF or HEX private key in 270 characters, but for a private key there is a mini format, it consists of just 30 characters and works on the principle of a brainwallet - sha256 ("mini_private_key"). <br><br>  A feature of this format is the obligatory beginning with the letter S, an example is S6c56bnXQiBjk9mqSYE7ykVQ7NzrRy. <br><br><img src="https://habrastorage.org/webt/1c/5c/ze/1c5cze9oq-uygli1oxwu2snlbjk.jpeg"><br><br>  We‚Äôll look at the picture for the last time and write out all the colors of the squares in the first 30 blocks, with the exception of the blue vertical dividers, for convenience we will mark the colors with one letter: Y = Yellow, G = Gray, R = Red, B = Blue, L = Light Blue, D = Dark Green <br><br>  It turns out: <br><br><pre><code class="python hljs"><span class="hljs-string"><span class="hljs-string">'YGR'</span></span>, <span class="hljs-string"><span class="hljs-string">'LBY'</span></span>, <span class="hljs-string"><span class="hljs-string">'LBL'</span></span>, <span class="hljs-string"><span class="hljs-string">'YBR'</span></span>, <span class="hljs-string"><span class="hljs-string">'LGY'</span></span>, <span class="hljs-string"><span class="hljs-string">'YYY'</span></span>, <span class="hljs-string"><span class="hljs-string">'LBY'</span></span>, <span class="hljs-string"><span class="hljs-string">'YBL'</span></span>, <span class="hljs-string"><span class="hljs-string">'YDY'</span></span>, <span class="hljs-string"><span class="hljs-string">'LGY'</span></span>, <span class="hljs-string"><span class="hljs-string">'GRG'</span></span>, <span class="hljs-string"><span class="hljs-string">'GRR'</span></span>, <span class="hljs-string"><span class="hljs-string">'GDR'</span></span>, <span class="hljs-string"><span class="hljs-string">'LBD'</span></span>, <span class="hljs-string"><span class="hljs-string">'LBY'</span></span>, <span class="hljs-string"><span class="hljs-string">'YDL'</span></span>, <span class="hljs-string"><span class="hljs-string">'LBG'</span></span>, <span class="hljs-string"><span class="hljs-string">'YYB'</span></span>, <span class="hljs-string"><span class="hljs-string">'LYY'</span></span>, <span class="hljs-string"><span class="hljs-string">'GRL'</span></span>, <span class="hljs-string"><span class="hljs-string">'YYD'</span></span>, <span class="hljs-string"><span class="hljs-string">'YGR'</span></span>, <span class="hljs-string"><span class="hljs-string">'YDR'</span></span>, <span class="hljs-string"><span class="hljs-string">'LBD'</span></span>, <span class="hljs-string"><span class="hljs-string">'GYD'</span></span>, <span class="hljs-string"><span class="hljs-string">'YRR'</span></span>, <span class="hljs-string"><span class="hljs-string">'GRY'</span></span>, <span class="hljs-string"><span class="hljs-string">'GYD'</span></span>, <span class="hljs-string"><span class="hljs-string">'GRR'</span></span>, <span class="hljs-string"><span class="hljs-string">'LGG'</span></span></code> </pre> <br>  We know that the first letter is S, and our coding is 6-digit, so you need to find out which color is responsible for which digit. <br><br>  For numeric conversions, install the baseconvert package. <br><br><pre> <code class="bash hljs">pip install baseconvert</code> </pre> <br>  Convert the letter S to hexadecimal <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -n <span class="hljs-string"><span class="hljs-string">"S"</span></span> | od -A n -t x1 53</code> </pre> <br>  With the help of another utility, we will convert the result into a 6-digit encoding. <br><br><pre> <code class="bash hljs">python3 -m baseconvert --string <span class="hljs-literal"><span class="hljs-literal">true</span></span> --number 53 --input-base 16 --output-base 6 215</code> </pre><br>  From this we conclude that <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Y</span></span> = <span class="hljs-number"><span class="hljs-number">2</span></span> G = <span class="hljs-number"><span class="hljs-number">1</span></span> R = <span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre> <br>  Half of the problem is solved.  Since we don‚Äôt have so much time, we‚Äôll find the remaining 3 values ‚Äã‚Äãby brute force, we‚Äôll have a lot of options and immediately write a small script that will generate a private mini-key. <br><br><div class="spoiler">  <b class="spoiler_title">solve.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3 import baseconvert values = ['YGR', 'LBY', 'LBL', 'YBR', 'LGY', 'YYY', 'LBY', 'YBL', 'YDY', 'LGY', 'GRG', 'GRR', 'GDR', 'LBD', 'LBY', 'YDL', 'LBG', 'YYB', 'LYY', 'GRL', 'YYD', 'YGR', 'YDR', 'LBD', 'GYD', 'YRR', 'GRY', 'GYD', 'GRR', 'LGG'] replace = {'Y':'2', 'G':'1', 'R':'5', 'B':'0', 'L':'3', 'D':'4'} #   key = [] base = 6 for char in values: for i, j in replace.items(): char = char.replace(i, j) v = baseconvert.base(char, base, 16, string=True) v = bytearray.fromhex(v).decode('ascii') key.append(v) print(''.join(key))</span></span></code> </pre><br></div></div><br>  Running ... <br><br><pre> <code class="bash hljs">python3 solve.py SnoMtVnKbtCGApncmTzEXSep4kD4Gs</code> </pre> <br>  According to the mini private key specification, we can verify its validity by adding a question mark to the end and hashing sha256.  If the first two characters are zeros, then the key is considered valid. <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -n SnoMtVnKbtCGApncmTzEXSep4kD4Gs? | sha256sum 00edc14de4c175a2a8ccb213e4d5deee738782a8213c25328a7b035d3c728866</code> </pre> <br>  We were lucky the private key was valid. <br><br>  Now go to <a href="https://www.bitaddress.org/">www.bitaddress.org</a> (so faster) and paste the resulting private key into the Wallet Details tab. <br><br>  We take a private key in WIF format (5KfNkSeQwNgjHr7cRErzDmq5XdUm8qc94YM3iEN5YaMYoA2UGky) and import it into a bitcoin client. <br><br><img src="https://habrastorage.org/webt/wq/jp/gc/wqjpgcg7ftbansr9qhpscde1r7o.png" width="600"><br><br>  So, what do we have here? .. <br><br><img src="https://habrastorage.org/webt/pk/2k/zo/pk2kzods79a-g17_cxamgtlmbfs.png" width="600"><br><br>  Oops ... Someone was quicker and took the prize.  However, satisfaction from the solved problem was still obtained. <br>  UPD: $ 20 and $ 30 <a href="https://habrahabr.ru/post/351950/">took</a> <a href="https://habrahabr.ru/users/sopaxt/" class="user_link">SopaXT</a> </div><p>Source: <a href="https://habr.com/ru/post/352014/">https://habr.com/ru/post/352014/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352004/index.html">What is a digital handwritten signature (CRP)</a></li>
<li><a href="../352006/index.html">Key Application Metrics - Mobile Landmarks 2018 Report</a></li>
<li><a href="../352008/index.html">Top 10 errors in C ++ projects for 2017</a></li>
<li><a href="../352010/index.html">Overview of the second day of Data Science Weekend 2018. Data Engineering, ETL, search services and more</a></li>
<li><a href="../352012/index.html">Resizing images on the site</a></li>
<li><a href="../352016/index.html">Transparency and trust</a></li>
<li><a href="../352020/index.html">Work with notifications about events of IOT objects and GPS trackers</a></li>
<li><a href="../352022/index.html">Hacking Team is back in business: ESET has discovered new spyware samples of the company</a></li>
<li><a href="../352024/index.html">3CX v15.5 Update 4 Beta - speech recognition through Microsoft Speech and updated Call Flow Designer</a></li>
<li><a href="../352028/index.html">IT asset management: how myths affect projects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>