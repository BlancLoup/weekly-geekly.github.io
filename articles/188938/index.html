<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neural network in practice: The task of a traveling salesman</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, dear habro users. 
 I would like to share the practical application of one of the neurodynamic algorithms, in the continuation of my p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neural network in practice: The task of a traveling salesman</h1><div class="post__text post__text-html js-mediator-article"> Good afternoon, dear habro users. <br>  I would like to share the practical application of one of the neurodynamic algorithms, in the continuation of my post. <a href="http://habrahabr.ru/post/188368/">Modeling the neural network of the Boltzmann Machine</a> . <br>  Implementation on the example of solving the traveling salesman problem. <br>  I will remind a little of what its essence is. <br><img src="https://habrastorage.org/getpro/habr/post_images/808/98f/d63/80898fd63aec2d4dd47a65d107e250f0.jpg" alt="image"><br><br><a name="habracut"></a><br>  The task of the traveling salesman (traveling salesman (Fr. commis voyageur, outdated) - traveling sales broker) is to find the most profitable route passing through the specified cities.  In terms of the task, the criterion of the route profitability (shortest, cheapest, aggregate criterion, etc.) and the corresponding matrices of distances, costs, etc. are indicated. As a rule, it is indicated that the route should pass through each city only once - in such case, the choice is carried out among Hamiltonian cycles. <br><br>  To solve this problem, a network consisting of 100 neurons is used. <br>  When assigning weights, there must be a guarantee that the neural network provides a solution that matches the correct tour.  It becomes clear why the assignment of weights is most significant for achieving a good solution when using the Boltzmann machine and the Hopfield network.  Hopfield and Tank suggested one way to assign weights to the Boltzmann machines.  The main idea is to impose fines on incorrect tours and at the same time minimize the length of the tour.  The Aarts approach makes it possible to formally establish assignments by associating with the task, while many other approaches for assigning weights are heuristic.  Of course, it does not necessarily mean that the resulting algorithm works well, so Aarts offers several modifications designed to improve the performance of large tasks. <br><img src="https://habrastorage.org/getpro/habr/post_images/95a/790/7b5/95a7907b53290213f761088c6a68a2ff.jpg" alt="image"><br>  Fig.14 Fig.  15 <br>  Figures (14) and (15) illustrate the connections made to each network node.  They are divided into two types.  Connections of distances for which the weights are chosen in such a way that if the network is in a state that corresponds to the tour, these weights will reflect the energy cost of the connection (p-1) of the tour city with p city, and p - the city with the city (p + 1). <br>  The figure (14) shows the distance connections.  Each node (i, p) has prohibiting links to two adjacent columns, whose weights reflect the cost of connecting the three cities. <br>  Figure (15) shows the exclusive connections.  Each node (i, p) has prohibiting links to all elements in the same row and column. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Exclusive connections prohibit two elements from being in the same row or column at the same time.  Exclusive connections allow the network to be set to the state of the corresponding tour. <br>  Since all connections are so far prohibiting, we need to provide the network with some incentive to include elements, by manipulating thresholds.  Intuitively, we can see that some arrangements, such as those shown in figures (14) and (15), may have the desired effect, but the following theorem shows how to accurately select weights.  Consider the following set of parameters: <br><br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3DSt%3D(%5CTheta%26space%3Bip:%26space%3B0%26space%3B%5Cleq%26space%3Bi,%26space%3Bp%26space%3B%5Cleq%26space%3BN-1)"><img src="https://habrastorage.org/getpro/habr/post_images/7d8/631/f35/7d8631f355c026e06bcf0494ef92fb0f.gif" title="St = (\ Theta ip: 0 \ leq i, p \ leq N-1)"></a> <br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3DSd%26space%3B%3D(wipjq:%26space%3Bi%26space%3B%5Cneq%26space%3Bj%26space%3B%5Ccup%26space%3Bq%26space%3B%5Cequiv%26space%3Bp%26space%3B%5Cpm%26space%3B1(mod%26space%3BN))"><img src="https://habrastorage.org/getpro/habr/post_images/0dd/31d/66e/0dd31d66e5f32f6b27cd607b9e2af649.gif" title="Sd = (wipjq: i \ neq j \ cup q \ equiv p \ pm 1 (mod N))"></a> <br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3DSe%26space%3B%3D%26space%3B(eipjq%26space%3B:%26space%3B(i%26space%3B%3D%26space%3Bj%26space%3B%5Ccup%26space%3Bp%26space%3B%5Cneq%26space%3Bq)%26space%3B%5Ccap%26space%3B(i%26space%3B%5Cneq%26space%3Bj%26space%3B%5Ccup%26space%3Bp%26space%3B%3D%26space%3Bq))"><img src="https://habrastorage.org/getpro/habr/post_images/bdf/4a5/492/bdf4a549220923ad5972535be6cd50f8.gif" title="Se = (eipjq: (i = j \ cup p \ neq q) \ cap (i \ neq j \ cup p = q))"></a> <br>  (13) <br><br>  Where, dij is the distance between i and j cities, N is the number of cities, eipjq is the energy between neurons (j, q) and (i, p). <br>  Note that each element in Figures (14) and (15) is in the table, therefore any particular element is identified by two signatures.  Œ∏ip is the input of the element (i, p), and wipjq is the weight from the element (j, q) to (i, p). <br>  Select weights and inputs so that <br><br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3D%5Cforall%26space%3B%5CTheta%26space%3Bip%26space%3B%5Cin%26space%3BSt:%26space%3B%5CTheta%26space%3Bip%26space%3B%253C%26space%3B-%26space%3Bmin%26space%3B(%26space%3Bdik%26space%3B%26plus%3B%26space%3Bdil:%26space%3Bk%26space%3B%5Cneq%26space%3Bl,%26space%3B0%26space%3B%5Cleq%26space%3Bk,%26space%3Bl%26space%3B%5Cleq%26space%3BN-1)"><img src="https://habrastorage.org/getpro/habr/post_images/de7/532/fad/de7532fada809c653ce3c7f85ef04a33.gif" title="\ forall \ Theta ip \ in St: \ Theta ip <- min (dik + dil: k \ neq l, 0 \ leq k, l \ leq N-1)"></a> <br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3D%5Cforall%26space%3Bwipjq%26space%3B%5Cin%26space%3BSd%26space%3B:%26space%3Bwipjq%26space%3B%3D%26space%3B-%26space%3Bdij"><img src="https://habrastorage.org/getpro/habr/post_images/2b3/eba/282/2b3eba282e1a603aa8477fb95c93a02a.gif" title="\ forall wipjq \ in Sd: wipjq = - dij"></a> <br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3D%5Cforall%26space%3Beipjq%26space%3B%5Cin%26space%3BSe%26space%3B:%26space%3Beipjq%26space%3B%253C%26space%3Bmin%26space%3B(%26space%3B%5CTheta%26space%3Bip,%26space%3B%5CTheta%26space%3Biq)"><img src="https://habrastorage.org/getpro/habr/post_images/b54/eec/cce/b54eecccee181e604c257ff86beea7ad.gif" title="\ forall eipjq \ in Se: eipjq <min (\ Theta ip, \ Theta iq)"></a> <br>  (14) <br><br>  Then <br>  1. Feasibility.  Correct states of network tours correspond exactly to the local minimum of energy <br>  2. Streamlining.  The energy function is order saving according to the length of the tour. <br>  The proof is fairly straightforward and depends on the demonstration that the states of the tours correspond exactly with the local minimum of energy.  In a Boltzmann asynchronous machine, the local energy minima correspond exactly with fixed points.  The disadvantage of the algorithm is that in the synchronous case, some local minima of energy can also correspond to two cycles, which complicates the assignment of weights in the synchronous case. <br>  When solving the traveling salesman problem, the functioning of the network is as follows: <br>  1. Calculated scales, taking into account the task, according to the algorithm described above. <br>  2. Input signal <br>  3. The neurons are activated according to the Boltzmann learning algorithm, except that the weights remain always the same. <br>  4. Repeat steps 2 and 3 until the energy reaches the global minimum (i.e., during n calculations, does not change its state). <br><br>  <b>Optimization of the algorithm</b> <br><br>  Solving the problem with the help of the ‚ÄúAnnealing Simulation‚Äù algorithm, in addition to the correct selection of weights, the input vector, threshold values ‚Äã‚Äãand dimensions, the parameter t (temperature) is equally important. <br>  The metal is annealed, heating it to a temperature above its melting point, and then letting it cool down slowly.  At high temperatures, atoms, having high energies and freedom of movement, randomly accept all possible configurations.  With a gradual decrease in temperature, the energy of atoms decreases, and the system as a whole tends to adopt a configuration with minimal energy.  When cooling is complete, a global minimum energy state is reached. <br><br>  At a fixed temperature, the energy distribution of the system is determined by the Boltzmann probability factor. <br>  Hence it is obvious: there is a finite probability that the system has high energy even at low temperatures.  In a similar way, there is a small but calculated probability that a kettle with water on fire will freeze before it boils. <br>  The statistical distribution of energy allows the system to exit from local minima of energy.  At the same time, the probability of high-energy states decreases rapidly with decreasing temperature.  Therefore, at low temperatures, there is a strong tendency to occupy a low-energy state. <br><br>  For a more flexible temperature change, the entire graph was divided into intervals in which the user can change the temperature drop rate himself (up to 50 iterations, from 50 to 120 iterations, more than 120 iterations). <br>  In the process of practical research the following patterns were derived: <br>  1. At high temperatures, the energy behaves erratically, when at low temperatures it becomes almost deterministic. <br>  2. Changing the temperature to any constant in any interval, most often the algorithm finds a path between all cities, but at most it is far from optimal. <br>  3. To obtain the most accurate answer, it is necessary at low temperatures to significantly reduce the rate of fall of the parameter t, which is not the case for high temperatures.  When the temperature is maximum, the speed of the fall has almost no effect on the result. <br>  In the course of these studies, we found that temperature is much more important than any other parameter involved in the calculations, in order to achieve the most accurate result (in this case, the shortest path between cities).  This can be achieved by reducing the rate of decline of the parameter t in the final part of the calculations.  In the network model we use, it is recommended to perform a decrease in the interval ‚Äúafter 120 iterations‚Äù. <br>  For a visual representation of the results obtained in the network modeling program developed by us, we present a graph of the temperature at which the optimum result was achieved. <br><img src="https://habrastorage.org/getpro/habr/post_images/bd2/2fe/05a/bd22fe05a17e4844e04223bccc54f57e.jpg" alt="image"><br>  Studies have also been made in the area of ‚Äã‚Äãneural network activation.  In addition to the standard change of state in each individual neuron, selected at random, activation is performed by a group of neurons (in this model, the group includes 10 neurons).  Each neuron in this group changes its state to the opposite.  This method of activation allows you to even more parallelize the computation process, which leads to a more rapid finding of the right solution.  The number of calculation steps was reduced from 534 to 328. <br>  Thus, it is possible to optimize this neural network not only with respect to accuracy, changing the temperature graph, but also the speed of finding the right answer, by increasing the number of neurons that change their state at one time. </div><p>Source: <a href="https://habr.com/ru/post/188938/">https://habr.com/ru/post/188938/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../188928/index.html">Social games: server, client and shared event bus</a></li>
<li><a href="../188930/index.html">Assemble 2013</a></li>
<li><a href="../188932/index.html">Big bot attack on Wordpress sites</a></li>
<li><a href="../188934/index.html">Ten Books on Astronautics</a></li>
<li><a href="../188936/index.html">Kickstarter banned GMO</a></li>
<li><a href="../188940/index.html">The police found pirated software on Roskomnadzor‚Äôs computers, or where is our open source software?</a></li>
<li><a href="../188942/index.html">Prepros: an open-source file compiler for front-end development.</a></li>
<li><a href="../188944/index.html">Domestic phone with two screens: development history</a></li>
<li><a href="../188952/index.html">Course lectures "Startup". Peter Thiel. Stanford 2012. Session 18</a></li>
<li><a href="../188954/index.html">Maybe it's time to descend from the clouds?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>