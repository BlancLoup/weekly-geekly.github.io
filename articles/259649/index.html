<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Problems of recognition of ID-documents on mobile devices on the example of machine-readable zones</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fig. 1 - Passport of the Russian Federation with MRZ-zone (Image source: en.wikipedia.org/wiki/Russian_passport ) 

 Hello, today we want to tell you ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Problems of recognition of ID-documents on mobile devices on the example of machine-readable zones</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/5f3/144/b34/5f3144b3401f40b1b048a15be23e348a.jpg"><br>  Fig.  1 - Passport of the Russian Federation with MRZ-zone (Image source: <a href="http://en.wikipedia.org/wiki/Russian_passport">en.wikipedia.org/wiki/Russian_passport</a> ) <br><br>  Hello, today we want to tell you about the features of the problem of identification of identity documents, using a mobile phone.  As an example, we consider the problem of recognizing machine-readable zones of the MRZ in images and frames of a video stream received from a camera of a mobile device. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <hr><br><h2>  1. What is MRZ? </h2><br><br>  Machine-Readable Zone (MRZ - Machine-Readable Zone) is a part of an identity document, made in accordance with international recommendations, enshrined in the <a href="http://www.icao.int/publications/pages/publication.aspx%3Fdocnum%3D9303">document Doc 9303 - Machine Readable Travel Documents of the International Civil Aviation Organization</a> . <br><br>  An example of a machine-readable zone, made in accordance with these recommendations, is the MRZ of foreign passports of citizens of the Russian Federation (Fig. 1 - below). <br><br><hr><br><h2>  2. Recognition of MRZ using scanners (including specialized ones) </h2><br><br>  Consider the features of the use of scanning equipment in the task of optical recognition of documents.  When scanning the document is located in a plane perpendicular to the optical axis at a fixed distance from the recording matrix.  This achieves homotheticity of the original document and its image, and minor distortions with small deviations from such an arrangement are easily detected and corrected.  During the scanning process, the document is stationary during the exposure, therefore, defects associated with the displacement of the original document (blurring) of the image are excluded.  Illumination in the scanner is formed by special powerful backlight lamps, which guarantee stable illumination characteristics and the absence of shadows. <br><br>  A special case of scanning equipment is specialized document readers and hardware-software systems, in which the image is obtained according to the principles of a flatbed, planetary or slit scanner.  The document in such devices is either pressed against the glass, or is inserted into a special slot (Fig. 2), which practically eliminates the deformation of the scanned document page. <br><br><img width="20%" src="https://habrastorage.org/files/491/06e/480/49106e480b964ab896c9ffb862594b66.png"><img width="20%" src="https://habrastorage.org/files/e91/d3d/fd0/e91d3dfd0770420383a5842a371c0c13.png"><img width="20%" src="https://habrastorage.org/files/cc5/240/de3/cc5240de390a4675bcfc48eed411c503.png"><img width="20%" src="https://habrastorage.org/files/01e/b93/f80/01eb93f80f76445a8cb5a9c2f4d26386.png"><br>  Fig.  2 - Examples of the location of the document when using readers <br><br>  Such readers make it possible to obtain images of documents in various lighting schemes (white, infrared, ultraviolet, white to the light).  At the same time, for optical recognition, a scheme with white and infrared illumination can be used, which gives a high-contrast image with a low level of interference from background padding and protection elements. <br><br><img src="https://habrastorage.org/files/6ee/600/553/6ee60055320741cba7d9bad4d2e8552a.png"><br>  Fig.  3 - Scan of the passport of Japan in the white and infrared bands (Image source: <a href="http://bersisteknoloji.com.tr/index_htm_files/Regula%25208703_en.pdf">bersisteknoloji.com.tr/index_htm_files/Regula%208703_en.pdf</a> ) <br><br>  The known mutual arrangement of the elements of illumination (lamps, LEDs) relative to the working surface on which the document resides allows completely eliminating (in the process of designing the device) or significantly simplifying the glare compensation (in the process). <br><br>  Depending on the model of this kind, specialized equipment allows obtaining images in a resolution of 200 DPI and higher, with the majority of modifications having the ability to obtain images with a resolution sufficient for optical text recognition (300-400 DPI). <br><br>  Thus, scanning devices provide high-quality images with minimal distortion, which allows optical text recognition with high quality and high reliability. <br><br><hr><br><h2>  3. Shooting with small digital cameras </h2><br><br><h3>  3.1.  Common problems </h3><br><br>  Compared to scanners, the optical design of the camera is more complex and in itself introduces more distortion due to aberrations, glare and reflections inside the optical system.  The use of photosensors (matrices) and analog electronics by devices for recording images inevitably leads to distortion of images, called digital noise.  Sources of digital noise is the process of digitizing the analog signal itself (signal quantization errors, thermal noise and charge transfer on the matrix) and its further amplification.  Digital noise is noticeable in the image as a superimposed mask of pixels of random color and brightness.  Noise is more noticeable on monochromatic areas of the image, especially on dark ones.  Unlike scanning, when quality lighting is guaranteed, when shooting with digital cameras, there is often a lack of illumination, and the effect of digital noise naturally increases many times over.  Another source of distortion is image compression algorithms, which is especially typical for frames of a video stream. <br><br><img width="18%" src="https://habrastorage.org/files/567/3bd/50e/5673bd50e3d6409d89bea61d7ca98fe5.jpg"><img width="18%" src="https://habrastorage.org/files/a17/d83/094/a17d83094bd047bbaa343e1cc71d4c33.jpg"><img width="18%" src="https://habrastorage.org/files/dd1/04c/141/dd104c141aa045b687d6f6b6da43cf8a.jpg"><img width="18%" src="https://habrastorage.org/files/f84/7eb/6d4/f847eb6d4ce9494f9e7f4da5f9a140a0.jpg"><img width="18%" src="https://habrastorage.org/files/8b4/31d/24b/8b431d24b7c1457caa00b8d74c37c8d8.jpg"><br>  Fig.  4 - Examples of distorted images of the symbols of the MRZ document <br><br>  Depending on the characteristics of the lens and the position of the document relative to the plane of focus, some or all of the document image may be ‚Äúblurred‚Äù.  If due to the movement of the document or camera itself there is a shift during exposure, then ‚Äúblurring‚Äù appears (Fig. 5), which is enhanced in low light conditions. <br><br><img width="13%" src="https://habrastorage.org/files/2ba/03d/427/2ba03d427cc547e486a4628ac79b979c.jpg"><img width="13%" src="https://habrastorage.org/files/a1a/a21/13b/a1aa2113b3a5464497db9a4eec52f993.jpg"><img width="13%" src="https://habrastorage.org/files/2d9/056/7db/2d90567dbde34ba0a5edb00f58bbb5ca.jpg"><img width="13%" src="https://habrastorage.org/files/24b/ac1/47d/24bac147da884bc9bd0d6b48b646348a.jpg"><img width="13%" src="https://habrastorage.org/files/48b/af6/d2a/48baf6d2a49a45a9b18e16183153c912.jpg"><img width="13%" src="https://habrastorage.org/files/f3a/58f/97a/f3a58f97a2e74762ad16a1250b48e6a4.jpg"><img width="13%" src="https://habrastorage.org/files/c46/81b/e0a/c4681be0ad104c528b9a2007a8f21f91.jpg"><br>  Fig.  5 - Examples of ‚Äúblurred‚Äù symbol images <br><br><h3>  3.2.  Projective and nonlinear distortions </h3><br><br>  Unlike scanners when shooting with a camera, the document itself is located in an arbitrary plane relative to the plane of the focused image.  Deviation from the plane perpendicular to the optical axis leads to projective distortion of the document image.  With minor deviation angles, it is possible to recognize the machine-readable zone without additional projective correction, but in the general case it is necessary to estimate the parameters of the projective basis and produce optical recognition for the projectively corrected image.  In this case, errors are possible in determining the parameters of the projective correction, which leads to geometric distortions of symbol images.  Moreover, as an object of the physical world, the original document is subject to mechanical deformations.  For example, documents made on paper are subject to ‚Äúbending‚Äù and ‚Äútwisting‚Äù (most often along or across the main reading direction), and sometimes ‚Äúwaves‚Äù occur when the bends in different parts of the page are multidirectional.  When shooting with a camera, it is difficult or simply impossible to ensure the absence of deformations (Fig. 6). <br><br><img src="https://habrastorage.org/files/295/6df/194/2956df19417046d8aa721ad714c1321c.png"><br><img src="https://habrastorage.org/files/8ad/e2c/3b0/8ade2c3b03574409a4f22e016a46e56d.png"><br><img src="https://habrastorage.org/files/2bc/cd8/419/2bccd841948949ce894231678be9f36f.png"><br>  Fig.  6 - Different deformations <br><br>  Mechanical deformation of the document page is combined with projective image distortion.  Even in projective normalization, the characters in the image aligned in parallel lines on the source document may not have baselines.  Moreover, not only the lines themselves, but also the images of individual characters are distorted.  That is, even after proper projective normalization of the entire document, the image of a symbol from a region physically deformed on the original document will differ from the image of the same symbol from the undeformed region. <br><br><img width="10%" src="https://habrastorage.org/files/ca8/f60/178/ca8f6017848c4e86be561571a52d48f4.jpg"><img width="10%" src="https://habrastorage.org/files/f16/e44/d43/f16e44d432194ecf80b1e6a483286747.jpg"><img width="10%" src="https://habrastorage.org/files/e0f/eaf/62d/e0feaf62dccc4e98bc85b4e4da29273c.jpg"><img width="10%" src="https://habrastorage.org/files/003/d41/ee3/003d41ee38984c9d8bd1a252566f4ee8.jpg"><img width="10%" src="https://habrastorage.org/files/d90/b50/e63/d90b50e63a1c4e1f8282c384b8977e92.jpg"><img width="10%" src="https://habrastorage.org/files/c5a/31b/26d/c5a31b26d81d4be8933347231cc14ed3.jpg"><img width="10%" src="https://habrastorage.org/files/5ab/20b/42b/5ab20b42b97b4c70b39364fcfe5db429.jpg"><img width="10%" src="https://habrastorage.org/files/ad5/7ec/311/ad57ec31179a4225befc51b1f35b28fc.jpg"><img width="10%" src="https://habrastorage.org/files/93f/bdc/93c/93fbdc93c5664c11ae1f6b60a22675ed.jpg"><br>  Fig.  7 - Examples of distorted symbol images due to projective and non-linear deformations. <br><br><h3>  3.3.  Background problems </h3><br><br>  For the machine-readable zone, ICAO 9303 establishes that typing should be visually legible and black (at wavelengths B425 ‚Äì B680 according to the ISO 1831 standard), and the paint should absorb well in the near infrared range (in the B900 range in accordance with ISO 1831).  Thus, the requirements for contrast are imposed only for the infrared region of the spectral range.  In practice, this leads to the fact that, subject to the standard, some countries use inks to print the background filling of the machine-readable zone, which are ‚Äútransparent‚Äù in the infrared range and, at the same time, rather ‚Äúdense‚Äù in the optical (Fig. 8). <br><br><img width="16%" src="https://habrastorage.org/files/296/a34/806/296a348067594b3c8dea483ee93af06f.png"><img width="22%" src="https://habrastorage.org/files/b8d/f47/f5e/b8df47f5e7ab45b8b522e4f5e497cbfe.png"><img width="22%" src="https://habrastorage.org/files/88a/41f/0ff/88a41f0ffef844b9bacc2299fba4f34e.png"><img width="32%" src="https://habrastorage.org/files/1d2/2ee/565/1d22ee56554e4f528e129b343ca5d4ad.png"><br>  Fig.  8 - Examples of zones with ‚Äúdark‚Äù and ‚Äúvariegated‚Äù filling in the optical range <br><br>  For small-format cameras of mobile devices, shooting in the infrared range is impossible; therefore, inhomogeneous background significantly complicates the process of optical zone recognition, especially in ‚Äúunsuccessful‚Äù lighting conditions. <br><br>  The document lighting scheme in scanners minimizes the appearance of shadows and highlights, even for ‚Äúglossy‚Äù pages of documents.  When shooting a camera in natural scenes on the images often occur differences in brightness (shadows, reflections, reflexes, etc.) and color distortions that complicate the task of image analysis and recognition, for example, due to the loss of existing or the appearance of fake object borders.  The pages of most documents with a machine-readable zone are either made of special plastic or covered with a protective film and have good reflective properties.  Such physical properties of objects in the survey result in glare on the document (Fig. 9).  Additionally, document security elements often contain areas with ‚Äúholographic‚Äù elements that also distort the image. <br><br><img width="39%" src="https://habrastorage.org/files/fcb/a29/31f/fcba2931f52d47a780272f4d660a8ada.png"><img width="30%" src="https://habrastorage.org/files/023/1d5/40b/0231d540bd7f4d9aa12e7d58c05bc35e.png"><img width="20%" src="https://habrastorage.org/files/de4/d92/ba5/de4d92ba57e0491e8da19e66eb4bc84c.png"><br>  Fig.  9 - Fragments of the zone: highlight from an extended light source, holographic protection elements <br><br><h3>  3.4.  Problems using the OCR-B font </h3><br><br>  Consider the effect of the above difficulties when using small-format digital cameras on the recognition of single characters. <br><br>  For printing lines of text in the machine readable zone, ICAO 9303 establishes a valid subset of OCR-B characters, with some characters having similar outlines. <br><br>  The most difficult to distinguish among themselves are the letter ‚ÄúO‚Äù and the digit zero, whose images differ only in proportions and a slight difference in the ‚Äúcurvature‚Äù.  The insignificance of differences in outlines under conditions of even minor distortions or not very high resolution leads to the fact that even a person either distinguishes them with great difficulty or cannot distinguish them at all (Fig. 10). <br><br><img width="20%" src="https://habrastorage.org/files/c57/b85/a2d/c57b85a2d73f4845b10097583f7dd5f9.png"><img width="20%" src="https://habrastorage.org/files/135/dbf/63b/135dbf63b0aa46b895626f15895fa12c.png">  - - - - - <img width="20%" src="https://habrastorage.org/files/ee1/2fa/8fb/ee12fa8fbfc348caa696f700e46f2e1b.png"><img width="20%" src="https://habrastorage.org/files/6b0/ad9/796/6b0ad9796c2748dab9681a4490748346.png"><br>  Fig.  10 - Examples of hard-to-distinguish characters 0 (zero, left) and O (letter, right) <br><br>  Thus, when using small-format digital cameras for obtaining images of documents, in general, it is impossible to guarantee a high quality image of a symbol.  This leads to a significantly lower quality and reliability of the recognition results of individual characters, and contextual processing mechanisms begin to play a significantly more important role (compared to scanning). <br><br><hr><br><h2>  4. Problems of language model </h2><br><br>  In modern systems of recognition and identification of structured documents, statistical correction mechanisms are used to improve the accuracy of recognition.  These mechanisms use information about the structure of the document, about the ‚Äúcontext‚Äù of recognition, and rely on the language model of the document being recognized (or of a recognized field).  Algorithms of a similar statistical correction, or post-processing, are based on a group of related methods, such as Hidden Markov Models (HMM), finite automata, N-gram and dictionary methods, and mechanisms using weighted end converters (Weighted Finite-State Transducers, WFST). <br><br><h3>  4.1.  Context power </h3><br><br>  Consider some text field F. From the point of view of the structure of a document, field F has some semantic structure.  From the point of view of the presentation of the document, the F field also has some syntactic structure.  On the basis of the semantics of the document and the syntactic structure of the presentation of the document for the field, you can define some language model.  For example, let F be the ‚Äúdate of birth of the holder‚Äù of the machine-readable zone of a foreign passport of the Russian Federation.  Then, according to the semantic structure, F contains information about the year, month and birthday of the holder.  Since the MRZ of the foreign passport of the Russian Federation is made in accordance with the recommendations of ICAO 9303, a separate fixed position is allocated for the F field in the MRZ data structure (the second line of the MRZ, characters 14-19, with the checksum in the 20th symbol) and the syntactic structure is defined for it : the date is written in the format YYMMDD, where YY is the last two decimal digits of the year, MM is the decimal representation of the month number, DD is the decimal representation of the day number in the month, or as a string ‚Äú&lt;&lt;&lt;&lt;&lt;‚Äù of six placeholders, if date of birth is unknown.  The checksum is represented as one decimal digit and its value is calculated by the algorithm specified by the ICAO recommendations 9303. <br><br>  Based on certain semantic and syntactic field structures, a language model can be defined that will encode a set of possible field values.  Such a language model can be presented in several ways, for example, using a BNF grammar, or in the form of a regular language encoded by a state machine.  One of the possible ways of representing a language model is to build a testing grammar G on a set of all possible strings composed of alphabet characters based on the predicate of the word P. That is,  the word S corresponds to the language model G if the predicate P takes the true value on the word S.  Since the ICAO 9303 document provides for each field some rules restricting the set of possible field values ‚Äã‚Äã(ie, reinforcing the predicate P), as well as a checksum mechanism, the representation of the field language model as a testing grammar G is quite convenient. <br><br>  The task of statistical correction of the recognition result of the field F with the checking grammar G is quite simple: in the weighted set of possible alternative values ‚Äã‚Äãof the field F to find the value with the maximum weight on which the predicate P is executed.  If the number of all possible values ‚Äã‚Äãof F is finite (for example, the maximum field length is limited), one can define ‚Äúcontext power‚Äù as the ratio of the power of the falsity area of ‚Äã‚Äãthe predicate P to the power of the set of all possible values ‚Äã‚Äãof F. The greater this ratio, the more powerful the field context, and accordingly, the greater the likelihood of successful correction of the recognition result.  For example, from all possible lines of length 7, consisting of decimal digits, less than 0.4% are valid dates (taking into account the checksum), respectively, the context power for this field exceeds 99.6%. <br><br><h3>  4.2.  MRZ Document Code </h3><br><br>  The field "document code" (document code) is a two-character type identifier of the MRZ-document.  The document code is located at the very beginning of the first line of the MRZ zone, regardless of the type of the MRZ document, and the alphabet of its first character is strictly fixed ('P' for passports, 'V' for visas, 'A', 'C' or 'I 'for other identity documents), which allows you to build a sufficiently reliable procedure for correcting the recognition result for this symbol.  However, the second character of the document code is left to the discretion of the issuing organization.  Since the total checksum (see clause 4.7) does not cover the ‚Äúdocument code‚Äù field, a language model (besides the general alphabet limit) for the second character of the document type cannot be built in the general case.  It is also worth noting that there are organizations that issue special documents that resemble MRZ documents in their syntactic structure, but they are not.  Such documents may contain the first symbol of the document code, which is not stipulated by the ICAO standard 9303. An example of such documents is the MRZ-like zone on a driver's license of the Republic of Moldova of the sample of 1995-2010 (Fig. 11).  The structure of the MRZ-like zone on this type of documents coincides with the structure of documents of type TD-2, provided for in ICAO 9303, with the exception of the ‚Äúdocument code‚Äù field. <br><br><img width="90%" src="https://habrastorage.org/files/eb2/f9c/65a/eb2f9c65a78b4ae3b4fc2d726b3efc37.jpg"><br>  Fig.  11 - MRZ-like zone on Moldova‚Äôs driver‚Äôs license sample 1995-2010 (Image source: <a href="http://www.skyscrapercity.com/showthread.php%3Ft%3D1540248">www.skyscrapercity.com/showthread.php?t=1540248</a> ) <br><br><h3>  4.3.  Issuer Code and Citizenship </h3><br><br>  The fields ‚Äúissuing state / authority‚Äù and ‚Äúcitizenship‚Äù (nationality) define, respectively, the unique code of the organization that issued the document containing the MRZ-zone and the nationality of the document holder.  These codes are based on three-letter state codes in accordance with ISO 3166-1 with some extensions (codes corresponding to special non-governmental organizations authorized to issue identity documents and codes for persons without definite citizenship have been added).  The language model of both fields can be a dictionary - i.e.  just a finite set of all possible three-letter codes.  The share of admissible codes from all possible three-letter words is ~ 1.4%, therefore the context power of such a language model is rather high - ~ 98.6%. <br><br><h3>  4.4.  Document holder name </h3><br><br>  The ‚Äúname‚Äù field is one of the most difficult fields from the standpoint of standardization, taking into account the diversity of the name structure in different countries and in different languages.  ICAO 9303 describes some of the design requirements for a name, on the basis of which primary verification rules can be made: the ‚Äúname‚Äù field can consist of one or two sections, separated by two placeholders (‚Äú&lt;‚Äù), each section can consist of one or multiple words separated by a single placeholder character.  Each word must consist only of letters of the Latin alphabet.  There are no additional verification mechanisms provided by ICAO 9303 (the total checksum of the MRZ document for the ‚Äúname‚Äù field does not apply).  For the ‚Äúname‚Äù field, you can use well-known post-processing methods for similar fields, such as N-gram models and dictionary methods. <br><br><h3>  4.5.  Document number and personal number </h3><br><br>  The fields ‚Äúdocument number‚Äù and ‚Äúpersonal number‚Äù (personal number / optional data) are fields with a weakly fixed syntactic structure, in connection with which it is difficult to build a sufficiently powerful statistical correction mechanism.  The alphabet of these fields is not limited (i.e. limited only by the characters possible in the MRZ document).  If there is a recommendation for the ‚Äúdocument number‚Äù field, according to which the number should not contain placeholders in the beginning and middle of the number (i.e., the field can be supplemented with placeholders with the required length, but only at the end), then the syntactic structure of the field ‚Äú personal number ‚Äùis completely left to the discretion of the organization issuing the document.  Both fields have a checksum, but even with its use, the effectiveness of the post-processing mechanism is not high enough: since the alphabet contains both letters and numbers, the effectiveness of post-processing drops due to the features of calculating the checksum according to the algorithm described in ICAO 9303 (see clause 4.7).  The power of the context for both fields can be increased using the result of other fields, such as the ‚Äúissuing authority code‚Äù.  Some organizations issuing identity documents define their own syntactic structure for the ‚Äúdocument number‚Äù and ‚Äúpersonal number‚Äù fields.  Accordingly, after the recognition result of the ‚Äúissuing authority code‚Äù field has been obtained (and corrected, see clause 4.3), the syntactic structure of the ‚Äúdocument number‚Äù and / or ‚Äúpersonal number‚Äù fields can be specified if the limitations of the issuing organization are known in advance. <br><br><h3>  4.6.  Dates of birth and expiration of the document </h3><br><br>  The syntactic structure of the ‚Äúbirth date‚Äù and ‚Äúexpiry date‚Äù fields is described above in paragraph (4.1).  These fields are the most successful from the point of view of the language model - the alphabet of their symbols is rigidly fixed (only numbers, with the exception of the separately considered case of an unknown date) and a language model with a sufficiently powerful context can be built on the basis of the semantic structure of the date field.  When building a combined post-processing algorithm for several fields, you can also take into account the fact that the document‚Äôs expiration date cannot be earlier than the holder‚Äôs birth date, so the context power for considering these fields together can be further increased. <br><br><h3>  4.7.  Checksums </h3><br><br>  According to ICAO 9303, a checksum is provided for the fields ‚Äúdocument number‚Äù, ‚Äúdate of birth‚Äù, ‚Äúexpiration date‚Äù and ‚Äúpersonal number‚Äù.  There is also a so-called ‚Äúcomposite check digit‚Äù (composite check digit), with the help of which the repeated validation of these four fields takes place.  However, the total checksum is not provided for in all types of documents (it is not in the so-called MRV-A and MRV-B - in the variants of machine-readable visas).  The checksum occupies one character of the MRZ-zone for each field, and is calculated as follows: <br><br><ul><li>  Each field symbol is assigned its weight.  The first character is assigned a weight of 7, the second - 3, the third - 1. The fourth - 7, the fifth - 3, etc.  repeating the weights 7, 3 and 1 cyclically. <br></li><li>  The code of each character is multiplied by its weight.  The code of the placeholder symbol ('&lt;') is equal to zero, the code of each decimal digit is equal to the value of this digit, the code of each letter of the Latin alphabet is 9 + &lt;letter number in the alphabet&gt; (The code of the letter 'A' is 10, the code of the 'B' is 11 and so on. The code of the letter 'Z' is 35). </li><li>  The resulting works are summarized.  The value of the check digit is the remainder of the amount received modulo 10. </li></ul><br><br>  Since the final sum of weighted character codes is taken modulo 10, a significant number of collisions occur.  Particular difficulties are caused by collisions on pairs of characters that are difficult to distinguish by single-character recognition mechanisms in the recognition conditions of mobile devices from the camera (see clauses 3.1, 3.2).  So, the same codes (taken modulo 10) have the characters' F 'and' P ',' H 'and' R ',' G 'and' 6, 'S' and '8'.  In such fields as ‚Äúdocument number‚Äù and ‚Äúpersonal number‚Äù, both numbers and letters of the Latin alphabet can be found, and the checksum is the main method of validation.  However, if at the single character recognition stage one of the characters from the above pairs was mistakenly recognized as another member of this pair, the checksum will not change, and the likelihood that after the post-processing the field recognition result will be greatly reduced. <br>  The weights by which the character codes of the field being tested are multiplied also raise questions.  For example, weights 7 and 3, applied to neighboring symbols, add up to 10. This means that the same symbols (or different symbols, but with the same modulo 10 codes) with weights 7 and 3 together will give a zero contribution to checksum, no matter what characters it is.  This in turn means that if there is a local distortion in the photo or on the frame of the video stream on which recognition of the MRZ document occurs, due to which two adjacent characters were recognized with an error (for example, the pair of digits' 00 'was recognized as a pair of letters' OO '), and these two characters are in the field positions with weights 7 and 3, then they cannot be corrected with the checksum.  This is especially pronounced for the fields ‚Äúdocument number‚Äù and ‚Äúpersonal number‚Äù, since these fields have the widest alphabet of all fields of the MRZ document (both numbers and letters are allowed in their records). <br><br>  In order to increase the reliability of the mechanism of validation of sensitive data, ICAO 9303 contains a general checksum for some types of MRZ documents.  However, the total checksum does not apply to the entire MRZ document, but only to those of its fields that are already protected by its own checksum. <br><br>  As a result, from the point of view of language modeling in order to build mechanisms for correcting the recognition results of a MRZ document, some fields provided for by ICAO 9303 allow building sufficiently powerful contexts.  However, for individual fields (such as ‚Äúdocument number‚Äù, ‚Äúpersonal number‚Äù), the definition of a more strict syntactic structure would increase the recognition quality, both in systems working with cameras of mobile devices, and in traditional systems based on scanners.  Also, improving the quality and reliability of recognition of MRZ documents would allow the introduction of checksums for all significant fields, or for total checksums that apply to the entire document. <br><br><hr><br><h2>  5. Conclusion </h2><br><br>  We have described to you the main problems that we had to face when developing our software Smart 3D OCR MRZ - Software Developer Kit for offline recognition of MRZ documents on mobile devices.  In the future, we plan to provide you with an overview article on the architecture and a number of articles on the algorithms that we use in our developments related to the recognition of documents in a video stream. </div><p>Source: <a href="https://habr.com/ru/post/259649/">https://habr.com/ru/post/259649/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259637/index.html">Method of teaching programming: ‚Äúnote-taking‚Äù</a></li>
<li><a href="../259639/index.html">What did you want to know about the Android Animation Framework, but were afraid to ask</a></li>
<li><a href="../259641/index.html">We write chat for the local network using C ++ Builder. Server part</a></li>
<li><a href="../259645/index.html">Configuring VPLS Multihoming on Juniper Routers</a></li>
<li><a href="../259647/index.html">Developed by the University of Alabama will help passive cooling systems for servers and ordinary PCs.</a></li>
<li><a href="../259651/index.html">SaaS, PaaS, IaaS, or your hardware: What do domestic IT companies use?</a></li>
<li><a href="../259653/index.html">Restore databases using Veeam Explorer for Microsoft SQL Server</a></li>
<li><a href="../259655/index.html">We write chat for the local network using C ++ Builder. Client part</a></li>
<li><a href="../259657/index.html">Why in Russia there are so few committers in large open source projects</a></li>
<li><a href="../259663/index.html">Online store trump card: online shopping usability study</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>