<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Understanding Dagger 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Below you will see a free translation of an article by Miquel Beltran published on 
 Medium February 12, 2016. The purpose of the article is to develo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Understanding Dagger 2</h1><div class="post__text post__text-html js-mediator-article">  Below you will see a free translation of an article by <i><a href="https://medium.com/%40Miqubel">Miquel Beltran</a></i> published on <br>  <i><a href="https://medium.com/%40Miqubel/understanding-dagger-2-367ff1bd184f">Medium</a></i> February 12, 2016.  The purpose of the article is to develop an understanding of the basic mechanism of the work of <i>Dagger 2</i> . <br><a name="habracut"></a><br>  I found that most guides explaining how <i>Dagger</i> works are too complicated.  Even <a href="http://google.github.io/dagger/users-guide.html">the Google / Square guide is</a> too hard to understand if you don‚Äôt have a clear idea of ‚Äã‚Äãhow <a href="https://en.wikipedia.org/wiki/Dependency_injection">dependency injection</a> works. <br><br>  To understand this, I created a <a href="https://github.com/miquelbeltran/java-dagger-example">very simple Java project</a> with several classes that shows how <i>Dagger</i> works. <br><br>  In this article I will explain the main components of the <i>Dagger</i> .  The article is aimed at those who do not use this library, but plans. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Project structure </h4><br><pre><code class="hljs cs">apply plugin: <span class="hljs-string"><span class="hljs-string">'java'</span></span> repositories { jcenter() } dependencies { testCompile <span class="hljs-string"><span class="hljs-string">'junit:junit:4.12'</span></span> compile <span class="hljs-string"><span class="hljs-string">'com.google.dagger:dagger:2.0'</span></span> compile <span class="hljs-string"><span class="hljs-string">'com.google.dagger:dagger-compiler:2.0'</span></span> }</code> </pre> <br>  This is the code for the <i>build.gradle</i> file.  Standard java plugin and <i>JUnit</i> will be used to create unit tests.  Do not forget to add the dagger-compiler library to the dependencies (this was my first mistake). <br><br>  <i>A note from <a href="https://habrahabr.ru/users/foal/" class="user_link">foal</a> regarding the dagger-compiler dependency:</i> <i><br></i> <blockquote>  <i>For Dagger ‚Ä° and other APT-based products, it is better to use the gradle-apt-plugin.</i>  <i>This will make the compilation of your project more transparent and safe, since two different classpaths will not be confused - one to compile your code and the second to generate it.</i> </blockquote><br><h4>  Show me the code </h4><br>  In this example there will be two classes: <br><br><ul><li>  <b>GameData:</b> This class provides the data needed by the <i>GameSession</i> class.  In our case, just a string. </li><li>  <b>GameSession:</b> This class requires <i>GameData</i> .  We will inject a dependency using <i>Dagger</i> , instead of passing the <i>GameData</i> parameter or creating an instance inside the <i>GameSession</i> . </li></ul><br>  <b>Without dependency injection</b> , something like the following would <i>turn out</i> : the <i>GameData</i> class is created inside the <i>GameSession</i> .  Some developers will agree that this is a bad practice.  For example, if another <i>GameData</i> instance is <i>required</i> for testing, it will not be possible to create it. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String hello = <span class="hljs-string"><span class="hljs-string">"Hello Dagger"</span></span>; }</code> </pre><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameSession</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameData data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameData(); }</code> </pre><br>  <i>Dagger</i> will take care of us <i>injecting the GameData instance</i> into the <i>GameSession</i> class <i>variable</i> .  You only need to specify this using the <code>@Inject</code> annotation. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String hello = <span class="hljs-string"><span class="hljs-string">"Hello Dagger"</span></span>; }</code> </pre><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.inject.Inject; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameSession</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameData data; }</code> </pre><br>  Now you need to create classes that determine how dependency injection will be implemented, these are <i>Component</i> and <i>Module</i> . <br><br><ul><li>  <b>Module</b> identifies all injection providers.  That is, it determines the methods that specific instances will return to us for injection into the dependent class.  In this case, you need to determine the supplier who will return us <i>GameData</i> . </li><li>  <b>Component</b> is the interface that <i>Dagger</i> will use to generate code to implement dependencies for us. </li></ul><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dagger.Component; <span class="hljs-meta"><span class="hljs-meta">@Component</span></span>(modules = GameModule.class) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GameSession obj)</span></span></span></span>; }</code> </pre><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dagger.Module; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dagger.Provides; <span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-function">GameData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">providesGameData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameData(); } }</code> </pre><br><ul><li>  <b>GameModule</b> contains the annotated <code>@Provides</code> , which tells <i>Dagger</i> that it is one of those functions that returns an instance of <i>GameData</i> . </li><li>  It is also necessary to note the <i>GameModule</i> class with the <i>@Module</i> annotation. </li><li>  The <b>GameComponent</b> interface defines the injection function.  This function will be used in the <i>GameSession</i> class and will <i>inject</i> an instance of the <i>GameData</i> class <i>into it</i> , which will be <i>returned by the GameModule.providesGameData ()</i> function. </li></ul><br>  <b>All magic is in this moment</b> .  Dagger understands that the <i>GameSata</i> class requires a <i>GameData</i> class, that the <i>GameModule</i> class determines how an instance of <i>GameData</i> will be obtained;  That it is necessary to use the <i>GameComponent</i> interface to start the injection, called from the <i>GameSession</i> class. <br><br><h4>  Using Component </h4><br>  The following unit test shows how to embed a <i>GameData</i> class into an instance of a <i>GameSession</i> class <i>created</i> using the generated class of type <i>Component</i> . <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.junit.Test; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> org.junit.Assert.*; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameSessionTest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testGameSession</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ GameSession session = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameSession(); DaggerGameComponent.create().inject(session); assertEquals(<span class="hljs-string"><span class="hljs-string">"Hello Dagger"</span></span>, session.data.hello); } }</code> </pre><br><ol><li>  The <b>DaggerGameComponent</b> class <b>is</b> generated by <i>Dagger</i> , including the <i>create ()</i> function. </li><li>  This class implements the <i>GameComponent</i> interface in which we can call the <i>inject ()</i> method and pass an instance of the <i>GameSession to it</i> . </li><li>  The <i>inject ()</i> method <i>takes</i> care of <i>embedding</i> all dependencies for the <i>GameSession</i> . </li><li>  Finally, we can see that the <i>data</i> field of the <i>GameSession</i> class <i>is</i> set. </li></ol><br>  This example is simple; it misses a lot of <i>Dagger</i> functionality.  As I said, this example helped me understand the basics, and I hope that it will help you. <br>  Now that you have a general idea of ‚Äã‚Äãhow <i>Dagger 2</i> works, I recommend <a href="http://google.github.io/dagger/users-guide.html">going back to the original documentation and try to understand the CoffeeMaker example</a> . </div><p>Source: <a href="https://habr.com/ru/post/343212/">https://habr.com/ru/post/343212/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343202/index.html">33 independent blogs on UI design, web development and programming</a></li>
<li><a href="../343204/index.html">"Punch It, Chewie": simulated the work of a 56-qubit quantum computer</a></li>
<li><a href="../343206/index.html">‚ÄúBypassed Turing‚Äù: a new approach to captcha recognition</a></li>
<li><a href="../343208/index.html">Configuring Authentication in SAP Netweaver AS Java (Part 2 of 3)</a></li>
<li><a href="../343210/index.html">We solve the problem of finding the length of the largest increasing subsequence</a></li>
<li><a href="../343216/index.html">"Write letters ..." or train to work with data on appeals of citizens to the government of Moscow (DataScience)</a></li>
<li><a href="../343218/index.html">Security Week 47: Blue Tooth Toys, Green-Eyed Taxi With Drain And Bilge Tetris</a></li>
<li><a href="../343220/index.html">How we prepared Crystal for production</a></li>
<li><a href="../343222/index.html">Text captchas are easily recognized by deep learning neural networks.</a></li>
<li><a href="../343224/index.html">The digest of interesting materials for the mobile developer # 231 (November 20 - November 26)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>