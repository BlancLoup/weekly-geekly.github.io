<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Elegant strings</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagine that we need to do something with strings in .net. Something is not very difficult, but not quite simple. For example, for proper formatting, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Elegant strings</h1><div class="post__text post__text-html js-mediator-article">  Imagine that we need to do something with strings in .net.  Something is not very difficult, but not quite simple.  For example, for proper formatting, place spaces after commas in the text.  What does .net offer out of the box? <br>  Something like this: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> str = <span class="hljs-string"><span class="hljs-string">"..."</span></span>; str.Replace(<span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">", "</span></span>);</code> </pre> <br><br>  Wait, but we wanted to <i>set</i> spaces, but not <i>replace</i> commas! .. <br><a name="habracut"></a><br>  Ok, let's go further. <br>  Let's introduce censorship.  We will not allow in our texts, say, the word "bear".  Here so easily.  We will replace each "bear" with an ellipsis. <br>  Yeah, substitute.  So it is logical to use all the same method Replace.  No sooner said than done: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> str = <span class="hljs-string"><span class="hljs-string">"         .    ,    ."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = str.Replace(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"..."</span></span>);</code> </pre><br><br>  Hmm, dots instead of the first bear appeared, but the second was too proud and began with a capital letter.  And our method before him was saved.  We'll have to run a second time and change the proud "Bears" as well. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> str = <span class="hljs-string"><span class="hljs-string">"         .    ,    ."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = str.Replace(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"..."</span></span>).Replace(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"..."</span></span>);</code> </pre><br>  Fuh, it turned out.  Not very nice, but it works.  But does it work?  Suddenly come such a "MEDVED"? <br>  We thought, tensed and cut off such insolent ones too.  But at what cost! <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> str = <span class="hljs-string"><span class="hljs-string">"         .    ,    ."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = str.IndexOf(<span class="hljs-string"><span class="hljs-string">""</span></span>, StringComparison.CurrentCultureIgnoreCase); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (index &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { str = str.Remove(index, <span class="hljs-string"><span class="hljs-string">""</span></span>.Length); str = str.Insert(index, <span class="hljs-string"><span class="hljs-string">"..."</span></span>); index = str.IndexOf(<span class="hljs-string"><span class="hljs-string">""</span></span>, StringComparison.CurrentCultureIgnoreCase); }</code> </pre><br>  Something in this code is wrong.  And there are two problems: <br><ol><li>  Slow execution due to re-creation of lines at each step due to immunity </li><li>  A low-level piece of utilitarian code, which is usually referred to in a class called <code>Util</code> and forgotten, in the middle of a pretty semantically verified project (well, at least you can use fantasies?) </li></ol><br>  At the same time, there is a solution for improving the speed - rewrite using <code>StringBuilder</code> . <br>  But what to do with quietly grumbling aesthetic feeling? <br><br>  Agree, the existing interface for working with strings in .net is morally obsolete.  It is archaic, not flexible enough and makes you write a lot of strange code for seemingly ordinary and simple operations time after time. <br>  Don't forget to check for <code>null</code> yet.  Checks index boundary values.  And if you please correctly deal with the lengths of the lines. <br><br>  So the idea of ‚Äã‚Äãa fluent library interface for working with strings was born. <br>  <i>Modern, readable, and equally well tested.</i> <br><br>  Let's see what came of it. <br><br>  An example of an insert operation: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> t = <span class="hljs-string"><span class="hljs-string">"      .    !     "</span></span> .Insert(<span class="hljs-string"><span class="hljs-string">",    "</span></span>).After(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).IgnoringCase().From(The.Beginning); t.Should().Be(<span class="hljs-string"><span class="hljs-string">"      .    ,    !     "</span></span>);</code> </pre><br>  It reads as <code>Insert "    " after second "" ignoring case from the beginning.</code>  Although what is it me?  And so everything is clear. <br><br>  Delete something: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> t = <span class="hljs-string"><span class="hljs-string">"    -&gt;    -&gt;,    -&gt;"</span></span> .Remove(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); transformed.Should().Be(<span class="hljs-string"><span class="hljs-string">"    -&gt;    -&gt;,    -&gt;"</span></span>);</code> </pre><br><br>  And now we delete everything, taking into account the register: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> t = <span class="hljs-string"><span class="hljs-string">"       "</span></span>.RemoveAll(<span class="hljs-string"><span class="hljs-string">""</span></span>).IgnoringCase(); t.Should().Be(<span class="hljs-string"><span class="hljs-string">"      "</span></span>);</code> </pre><br><br>  Or even like this: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> t = <span class="hljs-string"><span class="hljs-string">"Some very long string"</span></span>.RemoveChars(<span class="hljs-string"><span class="hljs-string">'e'</span></span>, <span class="hljs-string"><span class="hljs-string">'L'</span></span>, <span class="hljs-string"><span class="hljs-string">'G'</span></span>).IgnoringCase(); t.Should().Be(<span class="hljs-string"><span class="hljs-string">"Som vry on strin"</span></span>);</code> </pre><br><br>  So: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> t = <span class="hljs-string"><span class="hljs-string">"     , "</span></span>.RemoveVowels().For(<span class="hljs-string"><span class="hljs-string">"ru"</span></span>); t.Should().Be(<span class="hljs-string"><span class="hljs-string">"     , "</span></span>);</code> </pre><br><br>  There was a place to extend the standard logic: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isEmptyOrWhiteSpace = <span class="hljs-string"><span class="hljs-string">" "</span></span>.IsEmpty().OrWhiteSpace(); isEmptyOrWhiteSpace.Should().Be(<span class="hljs-literal"><span class="hljs-literal">true</span></span>);</code> </pre><br><br>  Pass there: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> indexes = <span class="hljs-string"><span class="hljs-string">"    ,         "</span></span> .IndexesOf(<span class="hljs-string"><span class="hljs-string">""</span></span>).IgnoringCase(); indexes.Should().ContainInOrder(<span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">44</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>);</code> </pre><br><br>  And back: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> indexes = <span class="hljs-string"><span class="hljs-string">"    ,         "</span></span> .IndexesOf(<span class="hljs-string"><span class="hljs-string">""</span></span>).From(The.End); indexes.Should().ContainInOrder(<span class="hljs-number"><span class="hljs-number">44</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>);</code> </pre><br><br>  And the example with bears is compact and easy to read: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> str = <span class="hljs-string"><span class="hljs-string">"         .    ,    ."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = str.ReplaceAll(<span class="hljs-string"><span class="hljs-string">""</span></span>).With(<span class="hljs-string"><span class="hljs-string">"..."</span></span>).IgnoringCase();</code> </pre><br><br>  The project is being actively written.  Many interfaces have already been developed, and most are even implemented and tested. <br>  But there is still a lot of work and the help of the community will be very helpful. <br><br>  Quickly you can try using <a href="https://nuget.org/packages/dokas.FluentStrings/">NuGet</a> . <br>  And help a project on <a href="https://github.com/MSayfullin/FluentStrings">GitHub</a> or <a href="https://fluentstrings.codeplex.com/">CodePlex</a> . </div><p>Source: <a href="https://habr.com/ru/post/176809/">https://habr.com/ru/post/176809/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../176793/index.html">Notebook Stand. How it was</a></li>
<li><a href="../176795/index.html">Statistical tests in R. Part 3: Quantitative data tests</a></li>
<li><a href="../176801/index.html">Gamification - the game as a motivation in business</a></li>
<li><a href="../176803/index.html">Practical tips for choosing a cloud provider</a></li>
<li><a href="../176805/index.html">Why do we hang a television in the office?</a></li>
<li><a href="../176813/index.html">Minifest (minimalist developers manifesto)</a></li>
<li><a href="../176815/index.html">We write toy OS on C #</a></li>
<li><a href="../176817/index.html">We continue to optimize costs with Yota</a></li>
<li><a href="../176819/index.html">Vulnerability in mail.ru mail, allowing you to change the password on any mailbox without a secret question</a></li>
<li><a href="../176823/index.html">Running Windows under Linux KVM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>