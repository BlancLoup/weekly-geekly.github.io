<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I manually fought a virus spamming tmp files everywhere and creating autoruns in the roots of disks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 I got into the hands of the file format pif. This is a shortcut to the MS-DOS program, as Windows itself describes it. The name he had ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I manually fought a virus spamming tmp files everywhere and creating autoruns in the roots of disks</h1><div class="post__text post__text-html js-mediator-article"><h1>  Introduction </h1><br>  I got into the hands of the file format pif.  This is a shortcut to the MS-DOS program, as Windows itself describes it.  The name he had was the same as the name of the folder in which he lay.  Since the folder was received via Yandex.Disk from a friend (he, like me, does not have an antivirus installed on the system), I didn‚Äôt suspect anything, or rather, I didn‚Äôt have time to make out how this file system object should, accidentally launch it.  When I realized that I had launched, it was already too late.  I packed this folder in a zip-archive and sent it for scanning on VirusTotal.  Here is the <a href="https://www.virustotal.com/ru/file/f5498280cd666de20dcbd902d5c9b87a816562817ae665f6a2f7bd92e01955b6/analysis/1427475630/">result</a> . <br><a name="habracut"></a><br><h1>  Symptoms caused by a virus </h1><br><ul><li>  1. Creating your own files in the System32, Windows and user temp folders (% tmp%); </li><li>  2. Run these files; </li><li>  3. Creation in the roots of all available disks of their files; </li><li>  4. The ban on editing the registry; </li><li>  5. Prevent display of hidden files and folders; </li><li>  6. Creation in all network folders of all computers that it finds through the network of executable files and rar-archives with the name of the parent folder; </li><li>  7. Continuous spam temp files (with the extension ‚Äútmp‚Äù) in the same network folders. </li></ul><br>  It is possible that here is an incomplete list of symptoms.  If you know more, please add in the comments. <br><br><h1>  Virus destruction </h1><br>  Before starting this part of the article I would like to draw your attention to the fact that all further actions on deleting files and completing processes are absolutely at your own peril and risk.  We kindly ask you: if you are not sure whether it is a suspicious file, look for its name in the search engine first, in order not to accidentally delete the system file, such as "ctfmon.exe", "csrss.exe" or "lsass.exe". <br><br>  Although I already had the experience of removing such a virus (a friend had infected his computer a little earlier), I went to Yandex to see how it was being destroyed by the people.  The names of this virus turned out, as always, a lot.  This is what the most famous antivirus is called: <br><ul><li>  AVG - Generic_r.TT; </li><li>  Ad-Aware - Trojan.Dropper.VIO; </li><li>  Agnitum - Trojan.MulDrop! 4ElCgmJSsOY; </li><li>  Avast - Win32: Chydo [Drp]; </li><li>  Comodo - Worm.Win32.AutoRunAgent.TV2; </li><li>  DrWeb - Trojan.MulDrop5.14836; </li><li>  ESET-NOD32 - Win32 / AutoRun.Agent.TV; </li><li>  Kaspersky - Worm.Win32.AutoRun.iea; </li><li>  Microsoft - TrojanDropper: Win32 / Pykspa.A ... </li></ul><br>  You can see the remaining names by clicking on the link to VirusTotal indicated in the first part of the article.  Having entered one or another name alternately in the Yandex search and I didn‚Äôt find a description of the normal way to get rid of this virus, I decided to write this article. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Let's get down to business. </h1>  First, open the task manager and find the files of this virus in the processes.  Its files have unmatched names consisting of a certain number of letters of the English alphabet, arranged in a completely random order.  For example: "aekswdk.exe", "ufqwfvjecot.exe", "zmbsfvlbtndtaojc.exe" and so on.  It is clear that the standard in the operating system is not so strangely named files, and it is unlikely what a normal program will create such files.  There may be two or more such suspicious processes.  They monitor one after another, that is, at the completion of one - the second immediately launches it back;  at the completion of the second, it launches the first with lightning speed, and so on.  Consequently, the task before me was to simultaneously complete all these malicious processes so that they would not start each other and give themselves a normal deletion.  This was helped by the utility "KillProc" from, unfortunately, an unknown author.  You can take it <a href="">here</a> or, if you wish, and the ability to program to write yourself.  It consists of only two files: executable and text.  The name of the process is separately written on the text line on each line, and the executable at startup completes all these processes in the order in which they appear in the text file.  I registered each process three times just in case, arranging the names in random order and running the utility.  Since the utility runs fairly quickly, the processes were instantly completed, before they could start each other.  After that, it would seem, it is necessary to clean the autoload, but this was not the case.  Since editing this registry has been forbidden to us, we must first allow it.  To do this, go to the start and select the command "Run" or press the key combination Windows + r, where we type "gpedit.msc" and press enter.  We are in the group policy edit window.  There we open the user configuration, administrative templates, the "System" item and in the list of parameters we find the "Make registry editing tools unavailable" option.  Click the right mouse button and select "Properties", then change the position of the radio button to "Disable" and apply the changes.  Next, we calmly open the registry (click Windows + r and enter ‚Äúregedit‚Äù without quotes), we move along the path HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run and in the list of parameters we also look for files with the name consisting of an incomprehensible set of English letters  Suspicious are subject to removal.  After the autoload is cleaned, we restore the display of hidden files and folders in the system.  To do this, go to the registry along the path HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Explorer \ Advanced and look for the ‚ÄúHidden‚Äù option in the list.  Make a right click on it, click the "Edit" item and prescribe a unit.  Next, go to another registry path: HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ Advanced \ Folder \ Hidden \ SHOWALL and find the parameter "CheckedValue", the value of which is also changed by one.  After the registry editor, we can close freely and go to the control panel and folder settings, where on the ‚Äúview‚Äù tab we mark the display of hidden files and folders, as well as protected system files.  Then we clean the roots of all our disks from the files ‚Äúautorun.inf‚Äù and bat-files with names like ‚Äúralyhtfrfvht.bat‚Äù, ‚Äúrcpepdrfvnbpug.bat‚Äù and so on.  (Warning: do not accidentally delete ‚ÄúAUTOEXEC.BAT‚Äù).  You also need to clear the temp folder, which you can open by typing "% tmp%" in the Run window that is already familiar to us and delete in the Windows and System32 folders those files that you deleted from the autoload and the processes you completed. <br><br><h4>  Sources used </h4><br><ul><li>  <a href="">wecrasoft.narod.ru/soft/KillProc.zip</a> - A small but useful utility KillProc; </li><li>  <a href="http://vindavoz.ru/win_obwee/409-vosstanovit-pokazyvat-skrytye-fayly-i-papki.html">vindavoz.ru/win_obwee/409-vosstanovit-pokazyvat-skrytye-fayly-i-papki.html</a> - How to restore the display of hidden files and folders; </li><li>  <a href="http://roadvictory.ru/blockreestr.html">roadvictory.ru/blockreestr.html</a> - How to restore registry editing, if it is prohibited by the system administrator. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/356466/">https://habr.com/ru/post/356466/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../356452/index.html">They will count everyone: in the Russian Federation they will create an electronic database of citizens on the basis of these registry offices</a></li>
<li><a href="../356454/index.html">The Ministry of Communications and Mass Media developed a draft law on the full regulation of the Russian Internet</a></li>
<li><a href="../356456/index.html">Roskomnadzor warned portal ‚ÄúJudicial decisions‚Äù for publishing a judicial decision</a></li>
<li><a href="../356460/index.html">The largest social project in the world</a></li>
<li><a href="../356462/index.html">More efficient secret voting protocol</a></li>
<li><a href="../356468/index.html">Comparison of employee activity monitoring systems: the struggle for working hours</a></li>
<li><a href="../356472/index.html">There are no vulnerabilities in Sberbank online</a></li>
<li><a href="../356554/index.html">When is the PIN code requested when paying?</a></li>
<li><a href="../356556/index.html">Russian authorities have prepared a "plan to protect the Russian segment of the Internet from external influence"</a></li>
<li><a href="../356558/index.html">Protected anonymous service ProtonMail from CERN developers began sending invites</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>