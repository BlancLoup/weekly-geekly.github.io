<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Submission of auto-requests on the FTS website in USR on python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The FTS website at egrul.nalog.ru/index.html has a wonderful service for checking counterparties or their own companies. 

 The essence of the verific...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Submission of auto-requests on the FTS website in USR on python</h1><div class="post__text post__text-html js-mediator-article">  The FTS website at <a href="https://egrul.nalog.ru/index.html">egrul.nalog.ru/index.html</a> has a wonderful service for checking counterparties or their own companies. <br><br>  The essence of the verification is reduced to submitting a request to the Unified State Register of Legal Entities (single register of facts of legal entities' details) and receiving an extract from the registry right there online. <br><br>  Working with the service does not cause any difficulties: entered into the OGRN field, clicked the ‚ÄúSearch‚Äù button and clicked the ‚ÄúDownload‚Äù button below.  All statement received. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How can automation help here?  Very simple. <br><br>  If your holding consists of n-number of legal entities, then even such work as copy-pasting of the OGRN in the search bar of the service can be annoying. <br><br>  Let's get rid of the routine and automate the process of submitting and downloading extracts from the Unified State Register of Legal Entities! <br><a name="habracut"></a><br>  In our case, the program will ‚Äúpick up‚Äù one OGRN from the previously prepared excel table, enter the value in the service line, press the necessary buttons. <br><br>  Ideally, the program will work like this: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/4SFv-qA7nnE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Let's get started <br><br>  To begin with, we will prepare an excel spreadsheet, where we will add OGRNs, according to which we will work, in a column: <br><br><img src="https://habrastorage.org/webt/4-/q9/jo/4-q9jowp4ndp03msxj8z_0ionxg.jpeg"><br><br>  The number of OGRN does not matter (you can even download the entire Unified Register), the main thing is that they should all be in column A. <br><br>  Name the statement file as EGRY.xlsx and save it in the working directory python. <br><br>  Now create the file itself with the program - egrul.py. <br><br>  The first lines of the program, as usual, begin with the import of the necessary modules, then we select the browser (in my case, Chrome) and ‚Äúgo in‚Äù to the website: <br><br><img src="https://habrastorage.org/webt/6a/3z/ef/6a3zefaigfnu2dxzhmu8jheluxo.png"><br><br>  Next, we run a cycle on all OGRN in the excel table: <br><br><img src="https://habrastorage.org/webt/bu/lj/lg/buljlghlss8pktru_uily7tpz30.png"><br><br>  Here you need to pay attention to the values ‚Äã‚Äãof x at the beginning of the cycle: <br><br><img src="https://habrastorage.org/webt/yg/dh/bv/ygdhbvi-abyjioabexasn-ewhmy.png"><br><br>  2- this is the starting cell with OGRN (starting), which corresponds to A2 in the excel table.  The final cell will be A9, although the number in the cycle is 10. <br><br>  It must be borne in mind that all OGRNs are processed and the last value is not lost. <br>  Between the filings of requests to the Unified State Register of Legal Entities, the program lasts a pause of 30 seconds.  This may seem unacceptably long and this period will want to be shortened.  This can be done by changing the value in the string time.sleep (30) to, for example, time.sleep (10).  However, in this case, you can get under the sanctions of the FTS service and get the captcha.  This captcha can be circumvented, but this is a topic for a separate post.  And in this program, it is better to leave a delay between 30 seconds for submitting requests and go quietly to drink tea while the program is working for you. <br><br>  Link to the program - <a href="https://yadi.sk/d/hwJ1nGWIZmOOMw">here</a> . <br><br>  The link to the excel test table is <a href="https://yadi.sk/i/qwcLgf2cbkjj4A">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/455808/">https://habr.com/ru/post/455808/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../4558/index.html">For the sins of MTS and Beeline, Megafon will answer</a></li>
<li><a href="../45580/index.html">Computer addiction does not exist</a></li>
<li><a href="../455800/index.html">Matrix 1.0 - Decentralized Messaging Protocol Release</a></li>
<li><a href="../455802/index.html">How to collect "Olympic" thanks to email-mailings. Case Black Star</a></li>
<li><a href="../455806/index.html">The birth and death of the album: we understand how music formats have changed over the past 100 years</a></li>
<li><a href="../455812/index.html">Building a microservice architecture on Golang and gRPC, part 2 (docker)</a></li>
<li><a href="../455816/index.html">How to create a cool action for Google Assistant. Just AI's life hacking</a></li>
<li><a href="../45582/index.html">Another testing of 5 browsers from extremetech.com</a></li>
<li><a href="../455820/index.html">VM performance analysis in VMware vSphere. Part 2: Memory</a></li>
<li><a href="../455826/index.html">Auto watering colors with remote control</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>