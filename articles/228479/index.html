<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Musical programmable school bell "Schoolboy-4"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="annotation 
 On Habr√©, more than once did the description of working with the TL-MR3020 router in terms of expanding its capabilities based on openwrt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Musical programmable school bell "Schoolboy-4"</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/016/1fd/bd1/0161fdbd13226b2fa148c49f51fcf7e7.jpg"><br><br><h4>  annotation </h4><br>  On Habr√©, more than once did the description of working with the TL-MR3020 router in terms of expanding its capabilities based on openwrt firmware.  I want to show another version of the finalization of the router, in which he can become a full-fledged participant in the school learning process.  The article provides a description of the device and the procedure for working with the ‚ÄúSchoolboy-4‚Äù music programmable school bell. <br><a name="habracut"></a><br><h4>  Module "Schoolboy-4" </h4><br>  For those who can't wait to try it at work, I suggest immediately flashing your router with an alternative <a href="http://cyber-place.ru/showthread.php%3Ft%3D720">CyberWrt</a> firmware and choosing this module in the Modules / test menu, then clicking Install and after a while you will be able to experiment on your own.  For full-fledged work, a usb sound card is needed, which is inserted in the photo directly into the router case. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/834/a16/a4f/834a16a4fe4e12864e4ef621416b7058.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Introduction </h4><br>  In Russia and the world there are several dozens of different implementations of automated bell systems.  The first such systems appeared in the USSR, and in some places they still worked.  Many of them simply automate the delivery of traditional loud battle calls.  Some part allows instead of the usual calls to use the wired broadcasting system, which is usually included in the notification system at school. <br><br>  The variant described below is the 4th school bell under the straightforward name ‚ÄúSchoolboy‚Äù.  The first two versions were performed by my friend, Zhenya Penner, who implemented them on the AVR.  I picked up the baton and the third option was based on a mobile phone as a Java2ME application.  All of them worked for many years faithfully and in some schools in the Urals and in Siberia. <br><br>  If we look at the <a href="https://github.com/ViacheslavMezentsev/schoolbell">sources</a> , we see that the next call is a set of shell and javascript scripts.  Calling is controlled by shell scripts using the crond service.  The web interface is written in javascript using the jQuery library.  The router is connected via audio card to the amplifier of the wired broadcasting system.  Access to the management can be organized both via a local wired network and via WiFi. <br><br>  At the moment, prototypes of the Shkolnik-4 call have been installed in two schools and have been in trial operation for several months. <br><br><h4>  Interface </h4><br>  The general view and interface description are presented below. <br><br><h5>  Settings </h5><br>  There are not many settings: <br><br>  <b>An automatic machine</b> is a mode in which at 1 minute of the first every day an automatic change of schedule occurs according to the annual plan.  If the automatic mode is turned off, the schedule will be constant (see below). <br><br>  <b>Schedule</b> - select the schedule for the manual switching mode. <br><br>  <b>Preview</b> - the time in minutes for which preliminary calls are made, if they are enabled (see the Schedules tab). <br><br>  <b>Melody</b> - melody for a preliminary call.  All melodies due to space restrictions in the router are limited to a set of five. <br><br>  The <b>Sync</b> button sets the time on the router from the browser.  The fact is that the TL-MR3020 is synchronized via the network, but if it is not there, then the epoch of unix is ‚Äã‚Äãset.  RTC chips on board there.  This is one of the drawbacks of this router for this application. <br><br>  The <b>Stop</b> button stops the crond service, and <b>Restart</b> restarts. <br><br>  Button <b>Test</b> tests the sound path, playing a short sound file. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/614/aa5/3c4/614aa53c4525b308ad328b65fed23559.png"><br><br><h5>  Plan </h5><br>  This is just a children's coloring.  ‚ÄúDunk‚Äù the brush in the schedule and we need what we need for the current year.  Do not forget to save your creativity by clicking on the <b>Save</b> button.  This plan is needed for automatic mode change schedule. <br><img src="https://habrastorage.org/getpro/habr/post_images/142/f97/4f9/142f974f9fe9c40420a647e9cc1aeb08.png"><br><br><h5>  Schedules </h5><br>  You cannot add or remove schedules in the current version, but you can edit them.  We select the schedule from the list, a set of calls for it appears below.  Add / remove lines, change the melody, include or exclude a call from the crond task assignment, enable or exclude an additional preliminary call.  Everything is intuitive.  You can also play the current melody, but it will be played in the browser, and not through the audio card. <br>  The <b>Apply</b> button is needed if several schedules change at once.  First you need to <b>Apply</b> current changes to go to the next schedule, and then click <b>Save</b> .  After that, all changes will be saved. <br><img src="https://habrastorage.org/getpro/habr/post_images/de1/928/1f8/de19281f8a49ee419c42767c586bf9cb.png"><br><br>  The <b>System Log</b> and <b>Debug</b> tabs contain specific information for setting up a call.  CyberWrt module "Schoolboy-4" immediately ready for use after installation.  If the crond service is not running, then instead of the WORKING inscription, it will be STOPPED.  No calls will be made. <br><br><h4>  Operating procedure </h4><br>  1. Install the module or build it yourself for your system. <br>  2. Edit schedules, save. <br>  3. Make an annual plan, save. <br>  4. Turn on the automatic mode, save. <br>  5. Button Restart. <br><br>  <b>Note</b>  If the router is not connected to the local network or for another reason cannot be synchronized via the network to set the time, then this operation must be performed manually (the <b>Synchronize</b> button).  Unfortunately, the time zone also needs to be changed manually in the configuration file, which requires special knowledge. <br><br><h4>  Benefits </h4><br>  - replacement of the person, always exact giving of calls; <br>  - more pleasant psychological atmosphere in school; <br>  - the ability to customize control via a local network or WiFi ( <b>qualification required</b> ); <br>  - call setup is carried out through the browser of a smartphone, tablet, laptop or PC; <br>  - work in manual mode (selected schedule) or automatic - according to the annual plan. <br><br><h4>  disadvantages </h4><br>  - a wired broadcasting system is required (the bell is connected to the free input of the amplifier); <br>  - 5 melodies are pre-installed (usually no longer required), there is no possibility to upload yours via the interface yet; <br>  - the router on which the call is based does not have the ability to save time when the power is turned off, but it can synchronize over the network if it is configured to work on a network where there is Internet access.  Therefore, when turned on, you need to perform a synchronization operation through the interface. <br>  - 4 arbitrary schedules are available for changing (in the future it will be possible to add an arbitrary number, although this is usually not required); <br><br><h4>  Files </h4><br>  action.cgi - a handler for post requests from the page; <br>  index.cgi - required as part of the CyberWrt module; <br>  json.cgi - JSON parser on the shell script; <br>  scheduler.cgi - create tasks for crond; <br><br>  main.html - main page; <br>  style.css - tab styles; <br><br>  jquery-1.11.0.min.js - jQuery library; <br>  main.js - contains classes for working with objects on the page: schedules, settings, plan, etc. <br>  webtoolkit.base64.js - Base64 codec; <br><br>  * .json - configuration files; <br>  * .mp3 - melodies; <br><br>  log.txt is a message log, cyclically overwritten. <br><br><h4>  Other </h4><br>  The source code is free, free and at your own risk, as they say.  As a sound card fit simple Chinese for 150 p.  (it is depicted in the photo above, screwed with a clip).  If you want to establish such a call in your school, then go to arrange directly at the reception to the school principal, in private.  I don‚Äôt need any implementation bonuses, it would be nice to know if such a device would work somewhere.  The only thing I would accept as a gift for the collection are old Soviet calls like "Electronics". <br><br><h4>  Links </h4><br>  1. <a href="https://github.com/ViacheslavMezentsev/schoolbell">Sources on github</a> . <br>  2. <a href="https://yadi.sk/i/pruAv3qUW9LPE">Schoolboy-3.</a>  <a href="https://yadi.sk/i/pruAv3qUW9LPE">User Guide</a> (pdf). <br>  3. <a href="http://cyber-place.ru/showthread.php%3Ft%3D1183">CyberWrt module "Schoolboy-4"</a> (forum thread). <br>  4. <a href="http://habrahabr.ru/post/229623/">Musical programmable school bell "Schoolboy-3</a> . <a href="http://habrahabr.ru/post/229623/">"</a> </div><p>Source: <a href="https://habr.com/ru/post/228479/">https://habr.com/ru/post/228479/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../228461/index.html">Vkontakte launched unpromising mobile gaming platform?</a></li>
<li><a href="../228463/index.html">Digest photo news # 6: the best materials of the end of June</a></li>
<li><a href="../228465/index.html">Through the eyes of Moscow subscribers. Rating of mobile operators for the 2nd quarter in dynamics</a></li>
<li><a href="../228469/index.html">Computing Graphs, Speculative Locks and Arenas for Tasks at Intel¬Æ Threading Building Blocks (continued)</a></li>
<li><a href="../228477/index.html">Cluster analysis (for example, consumer segmentation) Part 1</a></li>
<li><a href="../228481/index.html">Dyn-DNS Services: Microsoft blocks ‚Äúgood‚Äù and ‚Äúbad‚Äù users</a></li>
<li><a href="../228483/index.html">The line of "smart" watches Samsung Gear Live will be released on the platform Android Wear</a></li>
<li><a href="../228485/index.html">Rust 0.11.0 released</a></li>
<li><a href="../228487/index.html">Scanning film using DSLR</a></li>
<li><a href="../228489/index.html">10 interesting tasks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>