<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vim-like control with xmodmap</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The implementation of the Vim-like control described in the previous article has a couple of significant drawbacks: it fits only to the GTK environmen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vim-like control with xmodmap</h1><div class="post__text post__text-html js-mediator-article">  The implementation of the Vim-like control described in the <a href="http://habrahabr.ru/post/266669/">previous article</a> has a couple of significant drawbacks: it fits only to the GTK environment and a modifier key is required to move the cursor through the edited elements.  It turns out, in general, not quite and Vim-like, as was rightly noted in the comments.  Therefore, it was decided to describe his experience in building a keyboard-like keyboard environment using xmodmap and the command shell. <br><br><a name="habracut"></a><br>  The first thing to do is create a directory for xmodmap resource files, for example ~ / .keytoggle. <br><br>  The second is to remove the current keyboard layout: <pre><code class="hljs ruby">$xmodmap -pke &gt;~<span class="hljs-regexp"><span class="hljs-regexp">/.keytoggle/input</span></span>-keymap.rc</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Next, create a file <br><div class="spoiler">  <b class="spoiler_title">~ / .keytoggle / control-keymap.rc</b> <div class="spoiler_text"><pre> <code class="hljs erlang-repl">!{{{ override latin keycode <span class="hljs-number"><span class="hljs-number">24</span></span> = q Q keycode <span class="hljs-number"><span class="hljs-number">25</span></span> = w W keycode <span class="hljs-number"><span class="hljs-number">26</span></span> = e E keycode <span class="hljs-number"><span class="hljs-number">27</span></span> = r R keycode <span class="hljs-number"><span class="hljs-number">28</span></span> = t T keycode <span class="hljs-number"><span class="hljs-number">29</span></span> = y Y keycode <span class="hljs-number"><span class="hljs-number">30</span></span> = u U keycode <span class="hljs-number"><span class="hljs-number">31</span></span> = i I keycode <span class="hljs-number"><span class="hljs-number">32</span></span> = o O keycode <span class="hljs-number"><span class="hljs-number">33</span></span> = p P keycode <span class="hljs-number"><span class="hljs-number">34</span></span> = bracketleft keycode <span class="hljs-number"><span class="hljs-number">35</span></span> = bracketright keycode <span class="hljs-number"><span class="hljs-number">38</span></span> = a A keycode <span class="hljs-number"><span class="hljs-number">39</span></span> = s S keycode <span class="hljs-number"><span class="hljs-number">40</span></span> = d D keycode <span class="hljs-number"><span class="hljs-number">41</span></span> = f F keycode <span class="hljs-number"><span class="hljs-number">42</span></span> = g G keycode <span class="hljs-number"><span class="hljs-number">43</span></span> = h H keycode <span class="hljs-number"><span class="hljs-number">44</span></span> = j J keycode <span class="hljs-number"><span class="hljs-number">45</span></span> = k K keycode <span class="hljs-number"><span class="hljs-number">46</span></span> = l L keycode <span class="hljs-number"><span class="hljs-number">47</span></span> = semicolon colon keycode <span class="hljs-number"><span class="hljs-number">48</span></span> = apostrophe quotedbl keycode <span class="hljs-number"><span class="hljs-number">49</span></span> = Escape Escape Escape Escape !keycode <span class="hljs-number"><span class="hljs-number">49</span></span> = grave asciitilde keycode <span class="hljs-number"><span class="hljs-number">52</span></span> = z Z keycode <span class="hljs-number"><span class="hljs-number">53</span></span> = x X keycode <span class="hljs-number"><span class="hljs-number">54</span></span> = c C keycode <span class="hljs-number"><span class="hljs-number">55</span></span> = v V keycode <span class="hljs-number"><span class="hljs-number">56</span></span> = b B keycode <span class="hljs-number"><span class="hljs-number">57</span></span> = n N keycode <span class="hljs-number"><span class="hljs-number">58</span></span> = m M keycode <span class="hljs-number"><span class="hljs-number">59</span></span> = comma less keycode <span class="hljs-number"><span class="hljs-number">60</span></span> = period greater !}}} !{{{ override numbers ! keycode <span class="hljs-number"><span class="hljs-number">10</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> exclam <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> exclam ! keycode <span class="hljs-number"><span class="hljs-number">11</span></span> = <span class="hljs-number"><span class="hljs-number">2</span></span> at <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> quotedbl ! keycode <span class="hljs-number"><span class="hljs-number">12</span></span> = <span class="hljs-number"><span class="hljs-number">3</span></span> numbersign <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> numerosign ! keycode <span class="hljs-number"><span class="hljs-number">13</span></span> = <span class="hljs-number"><span class="hljs-number">4</span></span> dollar <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> semicolon ! keycode <span class="hljs-number"><span class="hljs-number">14</span></span> = <span class="hljs-number"><span class="hljs-number">5</span></span> percent <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> percent ! keycode <span class="hljs-number"><span class="hljs-number">15</span></span> = <span class="hljs-number"><span class="hljs-number">6</span></span> asciicircum <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> colon ! keycode <span class="hljs-number"><span class="hljs-number">16</span></span> = <span class="hljs-number"><span class="hljs-number">7</span></span> ampersand <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> question ! keycode <span class="hljs-number"><span class="hljs-number">17</span></span> = <span class="hljs-number"><span class="hljs-number">8</span></span> asterisk <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> asterisk ! keycode <span class="hljs-number"><span class="hljs-number">18</span></span> = <span class="hljs-number"><span class="hljs-number">9</span></span> parenleft <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> parenleft ! keycode <span class="hljs-number"><span class="hljs-number">19</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> parenright <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> parenright !}}} !{{{ bindings !esc keycode <span class="hljs-number"><span class="hljs-number">9</span></span> = grave asciitilde !h keycode <span class="hljs-number"><span class="hljs-number">43</span></span> = Left Left !j keycode <span class="hljs-number"><span class="hljs-number">44</span></span> = Down Down !k keycode <span class="hljs-number"><span class="hljs-number">45</span></span> = Up Up !l keycode <span class="hljs-number"><span class="hljs-number">46</span></span> = Right Right !p keycode <span class="hljs-number"><span class="hljs-number">33</span></span> = Prior Prior !n keycode <span class="hljs-number"><span class="hljs-number">57</span></span> = Next Next !d !keycode <span class="hljs-number"><span class="hljs-number">40</span></span> = Delete Delete ![ keycode <span class="hljs-number"><span class="hljs-number">34</span></span> = Home Home !] keycode <span class="hljs-number"><span class="hljs-number">35</span></span> = End End !m keycode <span class="hljs-number"><span class="hljs-number">58</span></span> = F7 !}}}</code> </pre></div></div><br><br>  All the bindings are described in the comments, I will note only that in my case the REMAPs Ctrl-CapsLock, Esc- ~ and some more personal reassignments are used. <br><br>  Actually, the switching of input-editing modes is performed simply by performing xmodmap with the resource we need.  You can hang on a couple of hotkeys, and you can write a script like this: <br><div class="spoiler">  <b class="spoiler_title">~ / bin / kt</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash DIR="$HOME/.keytoggle" function toggle(){ if [ -e $DIR/lock ] then xmodmap $DIR/input-keymap.rc rm $DIR/lock else xmodmap $DIR/control-keymap.rc touch $DIR/lock fi } function show(){ if [ -e $DIR/lock ] then echo -- else echo -- INSERT -- fi } case $1 in t) toggle;; *) show;; esac</span></span></code> </pre></div></div><br><br>  The call ‚Äúkt t‚Äù changes the mode, without arguments - gives to standard output a state that can be displayed in the status line of the window manager, via osd_cat or any other notifier to taste.  For example, like this: <br><div class="spoiler">  <b class="spoiler_title">~ / .ion3 / main / cfg_statusbar.lua</b> <div class="spoiler_text"><pre> <code class="lua hljs">mod_statusbar.<span class="hljs-built_in"><span class="hljs-built_in">create</span></span>{ screen=<span class="hljs-number"><span class="hljs-number">0</span></span>, pos=<span class="hljs-string"><span class="hljs-string">'bl'</span></span>, fullsize=<span class="hljs-literal"><span class="hljs-literal">true</span></span>, systray=<span class="hljs-literal"><span class="hljs-literal">true</span></span>, template=<span class="hljs-string"><span class="hljs-string">"%date"</span></span>.. <span class="hljs-string"><span class="hljs-string">"[ %&gt;workspace_name ]"</span></span>.. <span class="hljs-string"><span class="hljs-string">"[ %exec_xkb ]"</span></span>.. <span class="hljs-string"><span class="hljs-string">"[ M: %exec_mounted ]"</span></span>.. <span class="hljs-string"><span class="hljs-string">"%filler"</span></span>.. <span class="hljs-string"><span class="hljs-string">"%&gt;exec_lt"</span></span> } mod_statusbar.launch_statusd{ <span class="hljs-built_in"><span class="hljs-built_in">load</span></span>={ update_interval=<span class="hljs-number"><span class="hljs-number">10</span></span>*<span class="hljs-number"><span class="hljs-number">1000</span></span>, }, <span class="hljs-built_in"><span class="hljs-built_in">date</span></span>={ date_format=<span class="hljs-string"><span class="hljs-string">'[ %H:%M ]'</span></span>, }, exec = { lt={ program = <span class="hljs-string"><span class="hljs-string">"mps s"</span></span>, retry_delay = <span class="hljs-number"><span class="hljs-number">3</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>, }, xkb={ program = <span class="hljs-string"><span class="hljs-string">"kt"</span></span>, retry_delay = <span class="hljs-number"><span class="hljs-number">1</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>, }, mounted={ program =<span class="hljs-string"><span class="hljs-string">"fmounted"</span></span>, retry_delay=<span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>, }, } }</code> </pre></div></div><br><br>  And the final chord - hang up switching modes on the hotkey.  For example, my switch was assigned to &lt;Super_R&gt;: <br><pre> <code class="hljs mel">$grep <span class="hljs-string"><span class="hljs-string">'kt t'</span></span> ~/.ion3/main/cfg_ion.lua kpress(<span class="hljs-string"><span class="hljs-string">"Super_R"</span></span>, <span class="hljs-string"><span class="hljs-string">"ioncore.exec_on(_, 'kt t')"</span></span>),</code> </pre><br><br>  Such an implementation does not depend on the used toolkit, but it will also greatly please Vim lovers, who have to work a lot with Windows via rdp, I think. <br><br>  Why did I give up on all this?  Virtually all the software I need every day has an out-of-the-box Vim style control.  As a result, the need for additional keyboard mode simply disappeared.  It was replaced by the mod1 + [hjklqw] combinations described in the previous article in some input fields (webkit, dwb command line).  By the way, I use these shortcuts when editing in Vim - sometimes it's faster than changing modes. </div><p>Source: <a href="https://habr.com/ru/post/266745/">https://habr.com/ru/post/266745/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266729/index.html">We log context of exceptions</a></li>
<li><a href="../266731/index.html">Run a mega-manual from Stackoverflow</a></li>
<li><a href="../266733/index.html">Why SMS is limited to 160 characters, and Twitter messages - 140 characters?</a></li>
<li><a href="../266735/index.html">Snaql. Raw SQL in Python projects</a></li>
<li><a href="../266743/index.html">Python 3.5; async / await</a></li>
<li><a href="../266747/index.html">Once again about type casting in C ++ or the arrangement of all points above the cast</a></li>
<li><a href="../266749/index.html">Group the same applications from different stores by icon</a></li>
<li><a href="../266753/index.html">Walking across tiles</a></li>
<li><a href="../266757/index.html">With 100,000,000 days a year</a></li>
<li><a href="../266759/index.html">PostgreSQL 9.5: what's new? Part 2. TABLESAMPLE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>