<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Plunging into performance</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, my name is Steve Souders and I work for Google on a team that ‚Äúmakes the internet faster‚Äù. This is incredibly cool. There are more than 50 people ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Plunging into performance</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/fa8/1b0/e3d/fa81b0e3de774c8c870b90e8f2d03b95.jpg"><br><br>  Hi, my name is Steve Souders and I work for Google on a team that ‚Äúmakes the internet faster‚Äù.  This is incredibly cool.  There are more than 50 people in the team and our task is to make the whole Internet faster, not only Google services.  In addition, I help Airbnb, Twitter, Facebook, just sent a detailed description of the performance improvement system on Pinterest.  We want to make the global network faster.  I mainly write code, create various utilities and analyze what happens on web pages and browsers, and much more.  And today I will talk about many of the things that I have already done. <br><br>  <i>This post is based on the speech of Steve Souders.</i> <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/ipgo93g4Xak%3Ffeature%3Doembed&amp;xid=17259,15700023,15700043,15700186,15700190,15700253&amp;usg=ALkJrhgeV_cIMzUKILWSBTVvlegEUn6Z-g" frameborder="0" allowfullscreen=""></iframe><br><a name="habracut"></a><br>  I have a lot of detailed materials on my site.  Here I propose to plunge into the atmosphere of increased productivity. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Useful tools: <br><ul><li>  Google Analytics </li><li>  Soasta (lognormal) mPulse </li><li>  Torbit insight </li><li>  New Relic RUM </li><li>  Episodes ( <a href="http://stevesouders.com/episodes/">http://stevesouders.com/episodes/</a> ) </li></ul><br><h4>  Metrics </h4><br>  Let's start by talking about metrics.  In the context of performance, this means that we actually mean speed.  I want web pages, web browsers to work faster.  So, how can we measure it.  After all, if we do not track changes, we will not be able to really understand what we are doing, and we will simply do something blindly.  Another thing that I constantly repeat: you always need to fix indicators in a bad state of affairs.  Be sure to do this before you start something to correct and measure, because everything you do should improve the result.  People usually get so hung up on the product itself, try to fix something and eventually forget to track the indicators.  And from this point of view, they lose a very significant part of the whole optimization.  Also, many are afraid to show bad results to their boss.  Then I recommend to show them without dynamics.  Just fix at least, make one or two improvements, and then show how cool it has become and what excellent work you have done, and then you can ask the authorities and the premium. <br><br>  When it comes to performance, we usually measure speed: how quickly certain processes happen, and usually we focus on the window ... There is one way to get these measurements from real users.  It is called RUM - real user monitoring, which means ‚Äúuser monitoring‚Äù.  Real people, real metrics.  We simply put Javascript on your page and track the load time from the user. <br><br>  Approximately, the Google Analytics tool has been running for about a year.  At first, such measurements were included only for those who put the necessary tick, and after 6 months of testing, this function was turned on by everyone.  Anyone who currently has Google Analytics on the site can open the settings, go to the "Behavior" block and see the information about the speed of loading the site.  By default, the last month is displayed, but you can see the average.  For example, I am interested in the server response time, because now I often swear with my hosting provider because of this parameter.  Also here you can see various graphs, peaks over the last month, the response time of the HTML document.  With Google Analytics you can monitor a lot.  You can even choose nothing and not build any special diagrams, but just look at the basic values ‚Äã‚Äãand analyze. <br><br>  Also here you can see the distribution by country (everyone loves to look at world maps with data).  We immediately see in which countries our site loads slowly, and in which quickly.  You can see how many exit points have been analyzed.  Much, of course, depends on which country the server is in, and which country the user is in.  But sometimes the speed is too small, for unknown reasons. <br><br>  Now you know about this data view, it has long been available in your dashboard in Analytics.  Also in Google Analytics you can track various download times.  For example, you want to know how long the picture is loaded on your site.  You can add an image and have GA track its load time. <br><br>  Of course, Google Analytics is not a panacea, but just one of the options, there are other tools.  For example, mPulse from Lognormal, which was acquired by Soasta.  Or Insight from the company Torbit.  People are involved in data analysis and performance improvements.  And RUM-products are now a lot.  There are those that are embedded in the browser, there are some third-party programs.  On my website, you can find the code for the Episodes system, which I did for Relic a couple of years ago.  It is open source, so you can download and watch. <br><br><h4>  Optimization </h4><br>  If I want to make the site faster, then I will try to halve the loading time of the site itself.  So first measure the total load time, and then the time to connect to the server.  And if everything is in order with the server, then start working with the site itself - optimize the database, check Javascript or CSS.  After all, something also inhibits the work of the site. <br><br>  As a tool to help optimize load time, I can recommend: <br><ul><li>  jQuery handler named "Measure" </li><li>  SpriteMe ( <a href="http://spriteme.org/">http://spriteme.org/</a> ) </li><li>  ReqiureJS </li><li>  Labjs </li><li>  yepnope </li><li>  Headjs </li><li>  YUI Loader </li><li>  ControlJS ( <a href="http://controljs.org/">http://controljs.org/</a> ) </li></ul><br>  By the way, there is one subtlety.  In Safari, we will not see the total load time or server response time.  But the latter is one of the most important parameters.  Most often, the server response time is 10% of the total time.  If you get it much more, then you should focus on it. <br><br>  I love statistics from real users.  If I have a lot of visitors, then I can check the various parameters and find out why my site loads longer in one place or another.  I love real data, because it is the behavior of real people, here you can see information about their equipment, connection, geographical location and much more. <br><br>  One more thing.  What if the page doesn't load after clicking on the link?  Suppose a user has a slow Internet when it takes 60 seconds to load a page.  In fact, after 20 seconds, people usually leave this page.  In any case, the worst loading time is better to never take into account.  I set the time for myself at 10 or 20 seconds, everything that is longer is cut off.  True, it is worth looking at the general statistics, because if most users download in 40 seconds, it is stupid to cut them off with a limit of 20. In general, there is such an approach, but you should not use it thoughtlessly. <br><br><h4>  Synthetic tests </h4><br>  An alternative to testing on real users is synthetic tests.  For example, you are in a lab where you use a tool to load pages every minute, or use a service like Keynote or Compuware.  In fact, one of the best synthetic tools today is WebPagetest.  He, of course, does not do everything that is needed, but if I need to give a person advice on where to start, then I would advise you to start with this service.  This is an open source project. <br><br>  You can check your site right now.  Everything is pretty simple there.  Shows the load time, the number of requests how much the page weighs, how long it takes to load certain elements, the table is especially good with all sources and time for each, etc.  A lot of information that can be useful.  This is only a synthetic test, but very convenient. <br><br>  Useful tools: <br><ul><li>  Keynote Systems </li><li>  Compuware </li><li>  WebPagetest ( <a href="http://www.webpagetest.org/result/130312_7E_1F11/">http://www.webpagetest.org/result/130312_7E_1F11/</a> ) </li></ul><br><h4>  Optimization </h4><br>  One more thing I want to talk about.  Open the site <a href="http://www.airbnb.com/">www.airbnb.com</a> in Internet Explorer.  What will we see here?  The site has about 5 scripts and three sets of styles in the document headers.  Most likely, these scripts will be applied regardless of which page we are on.  And what do you usually do when there is a header with some of these scripts, links, style sets and tags?  Just dropping them, right?  So, if we do this, then some processes will start a little faster.  And this is important.  In any case, we have a long page, two sets of styles, a script, a couple of pictures, another script, another pair of pictures, and so on.  There is a kind of blocking that must be eliminated, and everything will work faster. <br><br>  Take a look at the same site, but already in Chrome.  The big picture loads pretty quickly.  The boot sequence is different here.  HTML document, script, style, style, script, script, script, script, image.  Completely different download.  And after all in the document the order of loading is not specified in any way.  This is all Chrome's ‚Äúinitiative‚Äù.  Since 2008, we have been working to ensure that sites load faster thanks to the so-called ‚Äúspeculative download‚Äù.  Previously, everything happened like this: when you start downloading a script, nothing else can happen at this moment.  If there are three scripts in a row, then the first one will load, execute, then the second one, execute, and so on.  This is all very long, alas.  As it is implemented in the above browsers: I start downloading the first script and can continue to parse the document, because the script can do something that will change the state of the DOM.  But what if I do an advanced parsing, very easy, which only searches for a few specific tags, for example, IMG, link, IFRAME.  And if I see them, then I just throw out these requests. <br><br>  And now, in many modern browsers, advanced speculative parsing is presented, so that we can load several things in parallel.  Look at all these scripts that are downloaded in parallel, and style sheets, and other files.  This all happens due to speculative, forward parsing.  This technology allowed an average of 30% faster download sites. <br><br>  For the user is very important interaction with the page.  Without this page, a person simply looks at a funny little form.  In IE, his request number is 6, and in Chrome 18. This is how Chrome works: it does not preload any images before the first draw event.  And the output to the screen is blocked when scripts and style sheets are downloaded.  Scripts and CSS are preloaded, Chrome already has resources that block rendering, which in turn blocks the start of loading images.  So, this image, according to the code, is blocked.  What we really have to do, and I have already spoken to the Chrome developers, is to make the system smarter.  This is a new code, so we learn while we do.  In general, it is quite interesting, gives a 3% increase in speed.  We should consider really big pictures, special backgrounds, and maybe make more resolutions for them and load them early. <br><br>  I wrote one useful tool, <a href="http://stevesouders.com/cuzillion/%3Fc0%3Dhj1dfff3_0_f">Cuzillion</a> .  He has a great slogan ‚ÄúBecause there are zillions of pages to check.‚Äù  Suppose I just need to make a test page, because I am tired of doing a bunch of test pages in PHP.  This script is loaded in a couple of seconds, another couple of seconds go to download the image.  Items are loaded in staggered order.  Of course, it could be done in parallel, but, according to the logic of things, it is still necessary.  The total page load time will be, say, 4 seconds. <br><br>  If we put the image above the script, we will get a solution to the problem and make the download faster.  But we can not put the image in the beginning, but you can move the scripts down.  Also here you can create scripts in javascript.  But if you go this way and write everything on JS, then you can put it above the script.  And now, if we create a page, the download will be parallel and the total time will be, for example, 2 seconds instead of 4.  Suppose a page has an image that sets the tone for the entire page.  What can you do with it?  Put it dynamically to the very top, up to all the scripts, and they will be able to put the picture as the IMG value relevant for this page. <br><br>  Useful links: <br><ul><li>  Browserscope ( <a href="http://www.browserscope.org/">http://www.browserscope.org/</a> ) </li><li>  Partiline ( <a href="http://partiline.org/">http://partiline.org/</a> ) </li></ul><br><br>  I also want to tell you about HAR.  This is the HPR file format, JSON format.  Today it is an industrial standard.  The main idea of ‚Äã‚Äãthe HAR file is to capture all the information from the diagram and provide the ability to re-create the diagram from the file.  Diagrams saved in files can be sent by mail, published, and anyone can view them.  Those who will do performance analysis systems can also take a HAR file and perform an analysis based on it.  That is, HAR is a very useful tool that I would like to draw your attention to, because  it can be used to record what is happening on the sites, including the speed of various processes. <br><br>  Useful links: <br><ul><li>  <a href="http://www.softwareishard.com/blog/har-12-spec/">http://www.softwareishard.com/blog/har-12-spec/</a> </li><li>  HAR to pagespeed <a href="http://stevesouders.com/flint/">http://stevesouders.com/flint/</a> </li></ul><br><br>  But another project, HTTP Archive <a href="httparchive.org/">http://httparchive.org/</a> .  It was launched about two years ago.  This is part of an online archive with archive.org, we run it every two weeks.  Now there are about 300,000 links.  We took the Top 300,000 addresses in the world and analyze them, we get statistics.  We even have a mobile version, but it is not very popular.  We have only two iPhones, and other phones are much slower than computers, so you can only watch 5000 links.  Here you can see statistics, charts and all page resources.  Two years ago, we looked at only 10,000 pages.  I hope this will be useful for your tasks. <br><br>  By the way, I will very briefly touch on the topic of mobile phones.  It's all very simple: on the phone the site is very slow.  How long does it take to download?  There was no way to find out.  And then I made LoadTimer. <br><br>  Let's pretend that you launched Loadtimer.org on your phone.  You can select different addresses and click Start.  It took me an hour to do this thing.  It's just an iFrame, it loads your address in itself, it measures the time and shows you.  There is nothing complicated here and this ‚Äúbrowser‚Äù can load any page, you can check it on your phone even now.  So far this is probably all that can be done interesting in the mobile web segment. <br><br>  Useful links: <br><ul><li>  LoadTimer ( <a href="http://loadtimer.org/">http://loadtimer.org/</a> ) </li><li>  MobilePerf bookmarklet ( <a href="http://mobileperf.org/mobileperfbkm.php">http://mobileperf.org/mobileperfbkm.php</a> ) </li><li>  pcapperf ( <a href="http://pcapperf.appspot.com/">http://pcapperf.appspot.com/</a> ) </li></ul><br>  That's all.  Thank. <br><br><img src="https://habrastorage.org/files/a33/b03/ca2/a33b03ca2356459fa39dd55a59230670.jpg"></div><p>Source: <a href="https://habr.com/ru/post/239829/">https://habr.com/ru/post/239829/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../239817/index.html">Smart charging cable Bleep backs up data at the same time as charging a smartphone</a></li>
<li><a href="../239821/index.html">One more step towards driving safety from Volvo</a></li>
<li><a href="../239823/index.html">Logbroker: collecting and supplying large amounts of data in Yandex</a></li>
<li><a href="../239825/index.html">How I created a technique for learning C #</a></li>
<li><a href="../239827/index.html">Translation time October 26, 2014 or hit by work on carelessness</a></li>
<li><a href="../239833/index.html">A computer for the blind becomes available</a></li>
<li><a href="../239835/index.html">Transition to cloud video analytics: problems and solutions</a></li>
<li><a href="../239837/index.html">English to Malibu</a></li>
<li><a href="../239841/index.html">Google used camel in the desert of Liva for Google Street View</a></li>
<li><a href="../239845/index.html">Google introduced the x86 64-bit Android L emulator for developers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>