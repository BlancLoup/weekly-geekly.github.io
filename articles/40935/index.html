<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Typing and PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I don‚Äôt know about you, but it rarely happens to me that during debugging an application I‚Äôve been poking around in the kernel and libraries for a lon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Typing and PHP</h1><div class="post__text post__text-html js-mediator-article"> I don‚Äôt know about you, but it rarely happens to me that during debugging an application I‚Äôve been poking around in the kernel and libraries for a long time, just to find out that the error was on the surface itself, say in the wrong parameter.  And then you think ‚Äúif it was not too lazy to add validation at the input of the function, I would save so much of my time!‚Äù.  This is not difficult to do, but I do not want to spoil the transparency of business logic with a bunch of secondary conditions.  In essence, this is a cross-cutting functionality and the AOP approach would be useful here, but officially PHP still does not support AOP.  What to do?  I now see the following solution. <br><br><a name="habracut"></a><br><br>  <b>// libs / Validate.php</b> <br> <code>final class Validate { <br> const Integer = 1; <br> const Title = 2; <br> const Variable = 3; <br> const TemplateFileName = 4; <br> const Boolean = 5; <br> const UserFileSection = 6; <br> const Gender = 7; <br> const Age = 8; <br> const Email = 9; <br> <br> static function _checkStrLength($val, $strLen, $min=false, $max=false) { <br> if($min AND $strLen&lt;$min) throw new Exception ("'{$val}' is less than {$min} characters long"); <br> if($max AND $strLen&gt;$max) throw new Exception ("'{$val}' is greater than {$max} characters long"); <br> } <br> <br> static function type($val, $type) { <br> switch ($type) { <br> case self::Integer: <br> if (strval(intval($val)) != $val) throw new Exception ("'{$val}' does not appear to be an integer"); <br> break; <br> case self::Title: <br> self::_checkStrLength($val, UTF8::strlen($val), 1, 255); <br> break; <br> case self::Variable: <br> self::_checkStrLength($val, UTF8::strlen($val), false, 32); <br> if(!preg_match("/^[a-zA-Z][a-zA-Z0-9_]*$/is", $val)) throw new Exception ("'{$val}' contains invalid characters for a variable name"); <br> break; <br> case self::TemplateFileName: <br> if(!file_exists(BASEDIR."/custom/views/xml/{$val}")) throw new Exception ("'{$val}' file not found"); <br> break; <br> case self::Boolean: <br> if(!is_bool($val)) throw new Exception ("'{$val}' does not appear to be an boolean"); <br> break; <br> case self::UserFileSection: <br> if($val!="avatar" AND $val!="file" AND $val!="marketplace" AND $val!="image" ) throw new Exception ("'{$val}' user file section is not valid"); <br> break; <br> case self::Gender: <br> if($val!="male" AND $val!="female" AND $val!="undefined" ) throw new Exception ("'{$val}' gender is not valid"); <br> break; <br> case self::Age: <br> if(($val&lt;4 AND $val&gt;99) OR $val==69 ) throw new Exception ("'{$val}' age is not valid"); <br> break; <br> case self::Email: <br> if (!eregi("^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[az]{2,3})$", $val)) throw new Exception ("'{$val}' emaiol address is not valid"); <br> break; <br> } <br> } <br> }</code> <br> <br>  <b>// Example.php</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>Class Page { <br> function add($parent_id, $title, $var, $template, array $permissions, $site_id, $activity_flag) <br> { <br> try { <br> Validate::type($parent_id, Validate::Integer); <br> Validate::type($site_id, Validate::Integer); <br> Validate::type($title, Validate::Title); <br> Validate::type($var, Validate::Variable ); <br> Validate::type($template, Validate::TemplateFileName ); <br> Validate::type($activity_flag, Validate::Boolean); <br> } catch (Exception $e) { <br> throw new Exception($e-&gt;getMessage()); <br> return false; <br> } <br> } <br> //... <br> } <br> <br> $p = new Page(); <br> <br> try { <br> $p-&gt;add(10,"Title", "var", "test.xml", array(), 1, 1); <br> } catch (Exception $e) { <br> echo 'Caught exception: ', $e-&gt;getMessage(), "\n"; <br> } <br></code> <br><br>  We start the class of the validator and define types for variables and their properties in it.  Now, at the input of the function, it suffices to verify the passed parameters with the corresponding types. <br>  For example: <br> <code>try { <br> Validate::type($login, Validate::Variable); <br> Validate::type($real_name, Validate::Title); <br> Validate::type($real_email, Validate::Email); <br> Validate::type($real_gender, Validate::Gender); <br> Validate::type($real_age, Validate::Age); <br> } catch (Exception $e) { <br> throw new Exception($e-&gt;getMessage()); <br> return false; <br> } <br></code> <br>  I do not pretend to a pattern with this decision, but perhaps it will be useful to someone. <br><br>  <b>Updated 09.28.08</b> <br></div><p>Source: <a href="https://habr.com/ru/post/40935/">https://habr.com/ru/post/40935/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../40927/index.html">Practice using LinqToSql: Using Linq to automate calls to stored procedures.</a></li>
<li><a href="../40929/index.html">Banned on Yandex</a></li>
<li><a href="../40930/index.html">Yandex is</a></li>
<li><a href="../40931/index.html">Impressions of the PMD Eclipse plugin</a></li>
<li><a href="../40932/index.html">You did not see Yandex?</a></li>
<li><a href="../40936/index.html">Ford said "do the advertising yourself"</a></li>
<li><a href="../40937/index.html">Which site do you check internet for?</a></li>
<li><a href="../40941/index.html">Porn Safe to Watch at Work</a></li>
<li><a href="../40943/index.html">Qwate.ru Search Engine - What's New?</a></li>
<li><a href="../40946/index.html">Sales of iPhone 3G in Russia will begin on the night of October 3?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>