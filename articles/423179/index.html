<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The book "Guide to the architecture of cloud applications"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This guide has structured guidelines for designing scalable, resilient, and highly available cloud applications. It is designed to help you make decis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The book "Guide to the architecture of cloud applications"</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://azure.microsoft.com/ru-ru/campaigns/cloud-application-architecture-guide/%3Fwt.mc_id%3DAID729732_QSG_270347"><img align="left" width="250" src="https://habrastorage.org/webt/zk/ns/pq/zknspqark8ose3vto4iom_kbdaq.jpeg"></a>  This guide has structured guidelines for designing scalable, resilient, and highly available cloud applications.  It is designed to help you make decisions about architecture, no matter what cloud platform you use. <br><br>  The guide is organized as a sequence of steps ‚Äî choosing an architecture ‚Üí choosing technologies for computing and storing data ‚Üí designing an Azure application ‚Üí choosing templates ‚Üí verifying an architecture.  For each of them are recommendations that will help you in developing the architecture of the application. <br><a name="habracut"></a><br><br>  Today we publish part of the first chapter of this book.  You can download the full version for free at the <a href="https://azure.microsoft.com/ru-ru/campaigns/cloud-application-architecture-guide/%3Fwt.mc_id%3DAID729732_QSG_270347">link</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <hr><br><h2>  Table of contents </h2><br><ul><li>  The choice of architecture - 1; </li><li>  The choice of technologies for computing and storing data - 35; </li><li>  Designing an Azure Application: Design Principles - 60; </li><li>  Designing an Azure application: quality scores - 95; </li><li>  Designing an Azure Application: Design Patterns - 103; </li><li>  Template Catalog - 110; </li><li>  Architecture checklists - 263; </li><li>  The conclusion is 291; </li><li>  Azure Reference Architecture - 292; </li></ul><br><h2>  Choice of architecture </h2><br>  The first decision you need to make when designing a cloud application is to choose an architecture.  The choice of architecture depends on the complexity of the application, its application, its type (IaaS or PaaS) and the tasks for which it is intended.  It is also important to take into account the skills of the development team and the project managers, as well as the availability of the finished architecture of the application. <br><br>  The choice of architecture imposes certain restrictions on the structure of the application, limiting the choice of technologies and other elements of the application.  These limitations are associated with both the advantages and disadvantages of the chosen architecture. <br><br>  The information in this section will help you find a balance between them when implementing a particular architecture.  This section lists ten design principles to keep in mind.  Following these principles will help create a more scalable, resilient, and manageable application. <br><br>  We have identified a set of architectural options that are commonly used in cloud applications.  A section dedicated to each of them contains: <br><br><ul><li>  description and logic of the architecture; </li><li>  recommendations on the scope of this architecture; </li><li>  advantages, disadvantages and recommendations for use; </li><li>  Recommended deployment option using suitable Azure services. </li></ul><br><h4>  Overview of Architecture Options </h4><br>  This section provides a brief overview of the selected architecture options, as well as general recommendations for their use.  More information can be found in the relevant sections, available on the links. <br><br><h4>  N-tier </h4><br>  N-tier architecture is most often used in enterprise applications.  To manage dependencies, an application is divided into layers, each of which is responsible for a certain logical function, for example, data presentation, business logic, or data access.  A layer can call to other layers below.  However, such a division into horizontal layers may cause additional difficulties.  For example, it may be difficult to make changes to one part of an application without affecting its other elements.  Therefore, to frequently update such an application is not easy, and developers will have to add new functions less often. <br><br>  N-tier architecture is a natural choice when porting already used applications built on a multi-tier architecture.  Therefore, this architecture is most often used in IaaS solutions (infrastructure as a service) or in applications that combine IaaS with managed services. <br><br><img src="https://habrastorage.org/webt/at/qq/rq/atqqrqyydelrti2zaumzbdxjxxo.png"><br><br><h4>  Web Interface - Queue - Worker </h4><br>  For PaaS solutions, the ‚Äúweb interface - queue - worker role‚Äù architecture is suitable.  With this architecture, the application has a web interface that processes HTTP requests and a server worker role that is responsible for operations that are performed for a long time or are demanding of computing resources.  An asynchronous message queue is used for interaction between the interface and the server working role. <br><br>  The "web interface - queue - worker role" architecture is suitable for relatively simple tasks demanding of computational resources.  Like the N-tier architecture, this model is easy to understand.  The use of managed services simplifies deployment and operation.  But when creating applications for complex subject areas, it is difficult to control dependencies.  The web interface and the worker role can easily grow to large monolithic components that are difficult to maintain and update.  As with the N-tier architecture, this model is characterized by a lower frequency of updates and limited opportunities for improvement. <br><br><img src="https://habrastorage.org/webt/x2/1z/nr/x21znrgjcymzqtdu58fsl_ls4aa.png"><br><br><h4>  Microservices </h4><br>  If the application is designed to solve more complex problems, try to implement it based on the microservice architecture.  Such an application consists of many small independent services.  Each service is responsible for a separate business function.  Services are loosely coupled and use API contracts to communicate. <br><br>  A small team of developers can work on creating a separate service.  Services can be deployed without complex coordination between developers, which makes it easy to update them regularly.  The architecture of microservices is more difficult to implement and manage than the previous two approaches.  It requires a mature culture of managing the development process.  But if everything is organized correctly, such an approach helps to increase the frequency of new versions, accelerate the introduction of innovations and make the architecture more resilient. <br><br><img src="https://habrastorage.org/webt/xb/wq/v-/xbwqv-3-fq2yn_bdp-fq_de9-ie.png"><br><br><h4>  CQRS </h4><br>  The CQRS architecture (Command and Query Responsibility Segregation, distribution of responsibility between teams and requests) allows you to divide read and write operations between separate models.  As a result, the parts of the system responsible for changing the data are isolated from the parts of the system that are responsible for reading the data.  Moreover, read operations can be performed in a materialized view that is physically separated from the database to which it is being written.  This allows independent scaling of the reading and writing processes and optimizing the materialized view for executing queries. <br><br>  The CQRS model is best used for a subsystem of a larger architecture.  In general, it should not be applied to the entire application, since this will unnecessarily complicate its architecture.  It performs well in collaboration systems, where a large number of users simultaneously work with the same data. <br><br><img src="https://habrastorage.org/webt/dp/wb/xh/dpwbxh6upc37vxvmx7hdacfdboi.png"><br><br><h4>  Event Based Architecture </h4><br>  The event-based architecture uses a publish-subscription model in which providers publish events, and consumers subscribe to them.  Suppliers are independent of consumers, and consumers are independent of each other. <br><br>  The event-based architecture is well-suited for applications that need to quickly receive and process large amounts of data with low latency, such as the Internet of things.  In addition, this architecture is well manifested in cases where different subsystems must handle the same event data in different ways. <br><br><img src="https://habrastorage.org/webt/hp/vf/mw/hpvfmw4c0gzltzrkhecwb4xl8hg.png"><br><br><h4>  Big data, big calculations </h4><br>  Big data and big computations are special architectures used to solve particular problems.  When using the big data architecture, large data sets are divided into fragments, which are then processed in parallel for analysis and reporting purposes.  Large computing is also called high performance computing (HPC).  This technology allows you to distribute computing between multiple (thousands) of processor cores.  These architectures can be used for simulation, 3D-rendering and other similar tasks. <br><br><h4>  Architecture options as limitations </h4><br>  The architecture acts as a constraint in the design of the solution, in particular, it determines which elements can be used and which connections between them are possible.  Constraints set the "form" of the architecture and allow you to make a choice from a narrower set of options.  If the limitations of the chosen architecture are met, the properties characteristic of this architecture appear. <br><br>  For example, microservices have the following limitations: <br><br><ul><li>  each service is responsible for a separate function; </li><li>  services are independent of each other; </li><li>  data is available only for the service that is responsible for them.  Services do not exchange data. </li></ul><br>  Following these limitations leads to the creation of a system in which services can be deployed independently of each other, faults are isolated, frequent updates are possible, and new technologies are easily added to the application. <br><br>  Before choosing an architecture, make sure that you understand the underlying principles and the associated limitations.  Otherwise, you can get a solution that externally corresponds to the chosen architecture model, but it does not fully reveal the potential of this model.  It is also important to be guided by common sense.  Sometimes it is more reasonable to refuse from this or that restriction than to strive for cleanliness of architecture. <br><br>  The following table shows how dependencies are managed in each of their architectures, and for which tasks this or that architecture is most suitable. <br><br><img src="https://habrastorage.org/webt/hg/ac/6t/hgac6towdl1iflxacojntx8-l4a.png"><br><br><h4>  Analysis of the advantages and disadvantages </h4><br>  Restrictions create additional difficulties, so it is important to understand what you have to sacrifice when choosing one or another architecture option, and be able to answer the question whether the advantages of the chosen option outweigh its disadvantages for a particular task in a particular context. <br><br>  The following are some of the drawbacks to consider when choosing an architecture: <br><br><ul><li>  <b>Complexity.</b>  Is the use of a complex architecture justified for your task?  Conversely, is the architecture too simple for a complex task?  In this case, you risk getting a system without a clear structure, since the architecture used does not allow you to manage dependencies correctly. </li><li>  <b>Asynchronous messaging and coherence ultimately.</b>  Asynchronous messaging helps to separate services and increase reliability (thanks to the possibility of re-sending messages) and scalability.  However, it creates certain difficulties, such as the semantics of a one-time transfer only and the problem of consistency in the long run. </li><li>  <b>Interaction between services.</b>  If you divide the application into separate services, there is a risk that the data exchange between the services will take too much time or lead to network overload (for example, when using micro-services). </li><li>  <b>Controllability.</b>  How difficult will it be to manage the application, monitor its operation, deploy updates and perform other tasks? </li></ul><br><h2>  N-tier architecture </h2><br>  In the N-tier architecture, the application is divided into logical layers and physical layers. <br><br><img src="https://habrastorage.org/webt/k0/qc/3z/k0qc3zf0bmj9w9zixiwr2e3fqkw.png"><br><br>  Layers are a responsibility sharing and dependency management mechanism.  Each layer has its own area of ‚Äã‚Äãresponsibility.  The higher layers use the services of the lower layers, but not vice versa. <br><br>  Levels are physically separated and work on different computers.  One level can access another directly or using asynchronous messages (message queue).  Although each layer should be placed on its own level, it is not necessary.  At one level you can place multiple layers.  Physical level separation makes the solution not only more scalable and fault tolerant, but also slower, since the network is often used for interaction.  A traditional three-tier application consists of the presentation, intermediate, and database levels.  Intermediate level is optional.  More complex applications can consist of more than three levels.  The diagram above shows an application with two intermediate levels responsible for different functional areas. <br><br>  An n-tier application can have a closed layer architecture or an open layer architecture. <br><br><ul><li>  In a closed architecture, an arbitrary layer can only access the nearest lower layer. </li><li>  In an open architecture, an arbitrary layer can refer to any underlying layers. </li></ul><br>  The closed layer architecture limits the dependencies between the layers.  However, its use may excessively increase network traffic if a particular layer simply forwards requests to the next layer. <br><br><h4>  Scopes of architecture </h4><br>  N-tier architecture is typically used in IaaS applications, where each layer runs on a separate set of virtual machines.  However, the N-tier application does not have to be a clean IaaS application.  It is often convenient to use managed services for some components of the solution, especially for caching, messaging and data storage. <br><br>  N-tier architecture is recommended to be used in the following cases: <br><br><ul><li>  simple web applications; </li><li> Migrate a local application to Azure with minimal refactoring </li><li>  consistent deployment of local and cloud applications. </li></ul><br>  The N-tier architecture is common among normal local applications, so it is well suited for migrating existing applications to Azure. <br><br><h4>  Benefits </h4><br><ul><li>  The ability to transfer applications between local deployment and the cloud, as well as between cloud platforms. </li><li>  Less need for training for most developers. </li><li>  The natural continuation of the traditional model of applications. </li><li>  Support for heterogeneous environments (Windows / Linux). </li></ul><br><h4>  disadvantages </h4><br><ul><li>  It is easy to get an application in which the intermediate level performs only CRUD operations in the database, increasing query processing time and without bringing any benefit. </li><li>  Monolithic architecture will not allow the development of individual components by independent development teams. </li><li>  Managing an IaaS application is more difficult than an application based on managed services only. </li><li>  It may be difficult to manage network security in large systems. </li></ul><br><h4>  Recommendations </h4><br><ul><li>  Use automatic scaling at variable load.  See Auto Scaling Tips. </li><li>  Use asynchronous messaging to separate layers from each other. </li><li>  Cache semi-static data.  See Caching Guidelines. </li><li>  Ensure high database availability with a solution such as Always On Availability Groups in SQL Server. </li><li>  Install a web application firewall (WAF) between the interface and the Internet. </li><li>  Place each level in its own subnet;  use subnets as security boundaries. </li><li>  Restrict access to the data tier by allowing only requests from intermediate tiers. </li></ul><br><h4>  N-tier architecture on virtual machines </h4><br>  This section provides guidelines for building an N-tier architecture when using virtual machines. <br><br><img src="https://habrastorage.org/webt/lt/wy/90/ltwy90ykt4cyungzwsk1cunzc28.png"><br><br>  This section provides guidelines for building an N-tier architecture when using virtual machines.  Each layer consists of two or more virtual machines located in an accessibility set or in a scalable set of virtual machines.  Using multiple virtual machines provides fault tolerance in the event of a failure of one of them.  To distribute requests between virtual machines of the same level, load balancers are used.  The level can be scaled horizontally by adding new virtual machines to the pool. <br><br>  Each level also fits inside its own subnet.  This means that their internal IP addresses are in the same range.  This makes it easy to apply network security group (NSG) rules and routing tables to individual levels. <br><br>  Web tier and business tier status is not monitored.  Any virtual machine can handle any requests for these levels.  The data tier must consist of a replicated database.  For Windows, we recommend using SQL Server with Always On availability groups for high availability.  For Linux, choose a database that supports replication, such as Apache Cassandra. <br><br>  Access to each level is limited to Network Security Groups (NSG).  For example, access to the database tier is allowed only for the business tier. <br><br><h4>  Additional features </h4><br><ul><li>  N-tier architecture does not have to consist of three levels.  In more complex applications, as a rule, more levels are used.  In this case, use routing through layer 7 to redirect requests to a specific layer. </li><li>  Levels limit the decision regarding scalability, reliability and security.  It is recommended to use different levels for services with different requirements for these characteristics. </li><li>  Apply automatic scaling using scalable sets of virtual machines. </li><li>  Find in the architecture elements that can be implemented using managed services without serious refactoring.  In particular, pay attention to caching, messaging, storage, and databases. </li><li>  For increased security, place the application behind the perimeter network.  The perimeter network includes virtual network components that provide security, such as firewalls and packet inspectors.  For more information, see Perimeter Network Reference Architecture. </li><li>  For high availability, place two or more virtual network components in the availability set and add a load balancer to distribute Internet requests between them.  For more information, see Deploying Virtual Network Components for High Availability. </li><li>  Do not allow direct access to virtual machines running application code using RDP and SSH.  Instead, operators must enter the node base.  This is a network-hosted virtual machine used by administrators to connect to other virtual machines.  At the site-bastion NSG rules are configured, allowing access via RDP and SSH protocols only from approved public IP addresses. </li><li>  You can extend your Azure virtual network to your local network using a network-to-site virtual private network (VPN) or Azure ExpressRoute.  For more information, see Hybrid Network Reference Architecture. </li><li>  If your organization uses Active Directory for identity management, you can extend the Active Directory environment to your Azure virtual network.  For more information, see Identity Management Reference Architecture. </li><li>  If a higher level of availability is required than that provided by the Azure Service Level Agreement for virtual machines, replicate the application between the two regions and configure Azure Traffic Manager to fail over.  For more information, see Running Windows virtual machines in several regions and Running Linux virtual machines in several regions. </li></ul><br><hr><br>  Download the full version of the book for free and study it at the link below. <br><br>  ‚Üí <a href="https://azure.microsoft.com/ru-ru/campaigns/cloud-application-architecture-guide/%3Fwt.mc_id%3DAID729732_QSG_270347"><b>Download</b></a> </div><p>Source: <a href="https://habr.com/ru/post/423179/">https://habr.com/ru/post/423179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423169/index.html">Startup of the day (July-August 2018)</a></li>
<li><a href="../423171/index.html">How Discord simultaneously serves 2.5 million voice chats using WebRTC</a></li>
<li><a href="../423173/index.html">Minimum time - maximum pain</a></li>
<li><a href="../423175/index.html">Why write your game engine?</a></li>
<li><a href="../423177/index.html">The book "Microsoft Azure Security Infrastructure"</a></li>
<li><a href="../423181/index.html">Azure Developer Guide</a></li>
<li><a href="../423183/index.html">The book "Fundamentals of Microsoft Azure"</a></li>
<li><a href="../423185/index.html">Do not eat it! Useful 3D sugar printing</a></li>
<li><a href="../423187/index.html">Root and intermediate certificates of authorized Certification Authorities of Russia</a></li>
<li><a href="../423189/index.html">Research: half the companies patch vulnerabilities during the month - why?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>