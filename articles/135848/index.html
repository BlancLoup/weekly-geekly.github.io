<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CRACKL @ B Contest 2010. Analysis of the first task</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ended 2010, there were global reforms on the resource. These were troubled times. And in this harsh time, the idea of ‚Äã‚Äãcreating a local tournament is...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CRACKL @ B Contest 2010. Analysis of the first task</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/b69/2be/91f/b692be91f4c58d2b339621912ac7788b.png" align="right"><br>  Ended 2010, there were global reforms on the resource.  These were troubled times.  And in this harsh time, the idea of ‚Äã‚Äãcreating a local tournament is born.  This idea was very well received by the local community.  After some time, 3 assignments were created (although it was planned to be 5), the jury members and the evaluation system were selected.  And so it began. <br><a name="habracut"></a><br><h5>  Foreword </h5><br>  The first task was <a href="http://narod.ru/disk/36792799001/cracklab.ru_contest_2010_part1.rar.html">KeyGenMe</a> by PE_Kill.  The task was to write KeyGen'a, which was supposed to generate multiple keys for a single name.  Here is the original description of the author: <br><blockquote>  <i>Here you have a KeyGenMe.</i>  <i>The name speaks for itself - you need to write a key generator,</i> <i><br></i>  <i>which will be successfully tested in KeyGenMe.</i>  <i>For any name, the generator must</i> <i><br></i>  <i>issue many unique serial numbers.</i>  <i>KeyGenMe is packed with unpretentious homemade</i> <i><br></i>  <i>packer.</i> <i><br><br></i>  <i>I would like to warn.</i>  <i>KeyGenMe is not as complicated as it may seem, but not trivial.</i> <i><br></i>  <i>and requires a non-standard approach.</i>  <i>A small plus will be provided unpacked.</i> <i><br></i>  <i>KeyGenMe option.</i> <i><br><br></i>  <i>Good luck!</i> </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Analysis </h5><br>  As you can see from the description, the keygenmes are covered with a homemade packer, which causes some antiviruses to give out false positives.  Well, I didn't bother with him and took it off with <a href="">QU</a> .  Then I opened the unpacked file in OllyDbg and saw the code on the EP (Entry point), which was written in Delphi with keygens.  Knowing this, I decided to shove keygenmes into the IDR ( <a href="http://kpnc.org/idr32/ru/index.htm">Interactive Delphi Reconstructor</a> ), which would recognize my VCL and Delphi run-time functions.  This is only needed for two things: <br><ul><li>  creating a .map file for importing it into OllyDbg; </li><li>  finding the function of processing the test button. </li></ul><br>  After the complete analysis of the file has ended, create a .map file. <br><img src="https://habrastorage.org/storage2/c6a/af6/0d5/c6aaf60d51501515d5b2611e03d67ef5.png"><br><br>  And find the address of the button click handler. <br><img src="https://habrastorage.org/storage2/818/b40/496/818b40496ce3da591c562d77b7c69c2d.png"><br><br>  To use the .map file in OllyDbg you will need to install the <a href="http://code.google.com/p/mapimp/">mapimp</a> plugin.  By default, the .map file is saved in the same folder with which the program was opened and with the same name as the program, if everything is done correctly and the plugin is installed, then when opening the keygens in a pop up message should appear prompting you to download the .map file, click "Yes" and everything is fine.  If something is wrong, then you can download it manually through the main menu. <br>  All preparations are made.  Go to OllyDbg to the address of the processing function of pressing the check button, which you had to remember / write / copy from IDR.  And we see how the name and the serial number comes first (it is not so important), but the most interesting goes further. <br><img src="https://habrastorage.org/storage2/0bb/ea7/efb/0bbea7efbe1124cf8e70f0198b61a3fd.png"><br>  Namely, TKeyEngine.Create creates an instance of the TKyeEngine class. According to the logic of things, this class is the heart of the whole regChem.  It is followed by two functions; the result of the second participates in one of the conditions immediately following its call.  That's all they concluded.  So, a little more detail about each of them. <br><br>  In the first function, we encounter another insignificant thing, which, as it were, should have complicated the analysis - this is a small obfuscation, which is easily removed by the mask mask. <br><img src="https://habrastorage.org/storage2/79e/9ba/649/79e9ba649eee26c220d91cffba13da5e.png"><br>  It will also be further in the child functions.  Therefore, I simply found the address of the first meeting with a mask search and this address became the starting point.  In the script, we will search from here until the <s>dawn of the</s> end, until all these sections are flooded (it‚Äôs really looking for a long time, a few minutes, well, there was no calculation for optimizing a single operation, so it would come down). <br><blockquote><pre><code class="cpp hljs">MOV addr, <span class="hljs-number"><span class="hljs-number">0046B</span></span>ED9 @loop: FIND addr, #EB033BC?<span class="hljs-number"><span class="hljs-number">7</span></span>?# CMP $RESULT, <span class="hljs-number"><span class="hljs-number">0</span></span> JE @<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> MOV addr, $RESULT FILL addr, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">90</span></span> ADD addr, <span class="hljs-number"><span class="hljs-number">5</span></span> JMP @loop @<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>: RET</code> </pre> </blockquote><br>  Well, before meeting this obfuscation there were a couple of actions - this is that a 16-byte array is made from the name for the subsequent "simple" manipulations, people with a weak psyche who didn‚Äôt see so much code that needed to be analyzed were terrified  But "the devil is not so bad as he is painted."  A more detailed analysis revealed that it does not carry a deep semantic load.  I here about this big cycle with a switch in 10001 * 16 iterations. <br><img src="https://habrastorage.org/storage2/514/d41/1a5/514d411a50ccb037526f116400c3842b.png"><br>  It is enough to rip it.  True, this ripped piece of code will be over 12k lines, but after cleaning it from the buttons after deobfuscation, there will be a little less than 6k lines.  But before you rip it, you can bring it into a more correct form.  Because  Since all regshema works with a class instance, then this array is somewhere inside with a shift of 5 bytes relative to the pointer to this instance.  Therefore, it is necessary to correct all offsets for transferring to our ripped code only an array, no frills.  For this, I wrote this script. <br><blockquote><pre> <code class="cpp hljs">MOV addr, <span class="hljs-number"><span class="hljs-number">0046B</span></span>ED9 @loop: OPCODE addr CMP $RESULT_2, <span class="hljs-number"><span class="hljs-number">3</span></span> JB @next MOV temp, addr ADD temp, $RESULT_2 SUB temp, <span class="hljs-number"><span class="hljs-number">2</span></span> MOV val, [temp], <span class="hljs-number"><span class="hljs-number">1</span></span> CMP val, <span class="hljs-number"><span class="hljs-number">43</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> JE @ok CMP val, <span class="hljs-number"><span class="hljs-number">53</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> JNE @next @ok: INC temp MOV val, [temp], <span class="hljs-number"><span class="hljs-number">1</span></span> SUB val, <span class="hljs-number"><span class="hljs-number">5</span></span> MOV [temp], val, <span class="hljs-number"><span class="hljs-number">1</span></span> @next: ADD addr, $RESULT_2 CMP addr, <span class="hljs-number"><span class="hljs-number">004707</span></span>A1 JA @<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> JMP @loop @<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>: RET</code> </pre> </blockquote><br>  Then you can rip this whole thing.  It was possible to stuff all this with the help of asm-inserts, but some troubles arose that I could not solve in a reasonable time, so it was decided to put this all into an asm file as a separate function and connect it to the project, which immediately solved all the problems.  There are two more hesitations on ripped code, it uses a local variable of one byte in size and located not at the beginning of the stack, but just not there and not here ebp-5, you could replace it all, but I again followed the path of the smallest Resistance allocated under the local needs of the stack of 8 bytes (such as taking into account the alignment).  And the second stumble is that there is still a call for one more function, but it is small only 2 commands, we rip / rewrite manually (I don‚Äôt even know what is faster) and replace call names with our own.  That's all, a quarter of the way behind. <br><br>  So we finished the analysis of the first function that worked only with the name, but the second one is already working with the serial and the fact that it pulls it out and the data from the first function.  Immediately upon entering the second function there will be a check on the validity of the entered serial and its conversion. <br><img src="https://habrastorage.org/storage2/58f/c85/d69/58fc85d6900b641f17d1846eaef55316.png"><br>  The first is to check the length and location of hyphens in it, from which it will be possible to know that the serial has the form: <br>  XXXXX-XXXXX-XXXXX-XXXXX-XXXXX-XXXXX-XXXXX-XXXXX <br><br><img src="https://habrastorage.org/storage2/e9a/c10/9ae/e9ac109ae872cd03c5dcac15bd94548f.png"><br>  Next, hyphens are cut from it and the resulting string is decoded.  The decoding function is a standard algorithm that I didn‚Äôt quickly figure out.  The key clue is that the characters of the serial are checked against the alphabet. <br><img src="https://habrastorage.org/storage2/e44/604/8ec/e446048ec5e1b946f99a140ce9d20d39.png"><br>  Googling this alphabet, it was found that this is <a href="http://en.wikipedia.org/wiki/Base32">Base32</a> , a decoding function.  After which we have an array of 25 bytes in size, and which is then split into three parts, the first is an array of 16 bytes, the second is a value of 1 byte, and the third is an array of 8 bytes. <br><img src="https://habrastorage.org/storage2/60b/8d0/6dd/60b8d06dda1fa263452d800850e49ae0.png"><br><blockquote><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KEY</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> SomeBytes[<span class="hljs-number"><span class="hljs-number">16</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> SomeCount; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CipherText[<span class="hljs-number"><span class="hljs-number">2</span></span>]; } KEY, *LPKEY;</code> </pre> </blockquote><br>  As you can see, the third element of the structure I have a meaningful name, looking ahead to say that there should be an encrypted string, which is compared with the reference line in the most recent test.  So, the verification of the serial and its decomposition into components is complete.  When exiting this function there will be a check that the KEY.SomeCount is greater than 32, if so, then we go further.  Next comes a small loop, in which the swap in WORD is a KEY.SomeBytes and an array, which is derived from the name, it serves more to stretch the code, since  it has no logical meaning, because  then work with the same array and with their respective elements, the first with the first, the second with the second, and so on. <br>  And then there is another switch.  Those who have the first did not discourage all desire, then the second weed out even more people.  By itself, it is simple, for each value of a byte, the function is called by the same prototype, but the functions are different for everyone. <br><img src="https://habrastorage.org/storage2/7a3/289/c00/7a3289c00f16075b78030656782c713b.png"><br>  From this place in more detail.  So, the array again comes into play, which was obtained from the name (I will tell you a secret that he will participate further in one more function).  It will serve as a certain pcode, depending on what value of the byte is this and the action will be executed.  And the elements of the KEY.SomeBytes array will serve as the input value to these functions.  And those functions to which it is transferred have a similar uncomplicated logic, a byte that is fed into it is parsed bit by bit, depending on whether this or that bit is set, a small series of actions are performed on a single byte. <br><img src="https://habrastorage.org/storage2/c3d/8f9/9f4/c3d8f99f44116af9e49da4814d015abe.png"><br>  Each such function has its own actions for each bit, but the most important thing is that if there is one specific bit, the result of all these manipulations is placed in a certain position in KEY.CipherText and the separate counter is incremented, provided that it is greater than eight (t .e. 8 replacements were made in KEY.CipherText) completes the function with an error.  There is also another counter, which increases with each operation, i.e.  if the bit is set, except for the very first one, when we receive a byte, over which all these gestures occur.  In the analysis of all this vulnerability was revealed, which allowed to completely ignore all these manipulations.  It lies in the fact that if the bit responsible for writing to KEY.CipherText is not set, then KEY.CipherText will never change, which is very cool, it allows you to leave KEY.CipherText in a virgin form, in the one we set. <br><img src="https://habrastorage.org/storage2/8af/169/42d/8af16942dbe1793a528479ee88d91291.png"><br>  And the fact that there is a need to build a table of masks for each value of a byte, in which this bit will not be taken into account.  You also need to prevent the establishment of bits, which turns out a byte at the beginning, it is necessary for easy counting of bits for the second counter (we need it for one check).  To avoid this routine of searching for bits for each byte value, I wrote a small script that finds the necessary bits, and also creates the necessary masks from them and writes them to the table. <br><blockquote><pre> <code class="cpp hljs">MOV addr, <span class="hljs-number"><span class="hljs-number">004707F</span></span>C ALLOC <span class="hljs-number"><span class="hljs-number">100</span></span> CMP $RESULT, <span class="hljs-number"><span class="hljs-number">0</span></span> JE @error MOV table, $RESULT PUSHA MOV c, <span class="hljs-number"><span class="hljs-number">0</span></span> @loop: FIND addr, #<span class="hljs-number"><span class="hljs-number">751190909090900F</span></span>B643260FB6440326884304# CMP $RESULT, <span class="hljs-number"><span class="hljs-number">0</span></span> JE @<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> MOV cl, [$RESULT - <span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-number"><span class="hljs-number">1</span></span> MOV addr, $RESULT ADD addr, <span class="hljs-number"><span class="hljs-number">13</span></span> FIND addr, #<span class="hljs-number"><span class="hljs-number">751E90909090900</span></span>FB643260FB65304885403269090909090FE4326# CMP $RESULT, <span class="hljs-number"><span class="hljs-number">0</span></span> JE @<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> MOV bl, [$RESULT - <span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-number"><span class="hljs-number">1</span></span> OR bl, cl NOT bl MOV [table + c], bl, <span class="hljs-number"><span class="hljs-number">1</span></span> MOV addr, $RESULT ADD addr, <span class="hljs-number"><span class="hljs-number">20</span></span> INC c CMP c, <span class="hljs-number"><span class="hljs-number">100</span></span> JE @<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> JMP @loop @<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>: POPA DM table, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-string"><span class="hljs-string">"table.bin"</span></span> FREE table, <span class="hljs-number"><span class="hljs-number">100</span></span> @error: RET</code> </pre> </blockquote><br>  After this cycle, the bit counter is compared with the KEY.SomeCount value, if they are equal, then we are already at the finish line.  Next comes the function call to which KEY.CipherText is passed as data and an array with a name as a key, inside there will be several more occurrences until we get to the desired function, by the constants in it it was immediately clear that this is something from the <a href="http://ru.wikipedia.org/wiki/TEA">TEA</a> family of algorithms, where the delta is used, it was determined that it is something with <a href="http://ru.wikipedia.org/wiki/XTEA">XTEA</a> .  What it turned out, with only a small change in the original algorithm. <br><img src="https://habrastorage.org/storage2/065/e3a/764/065e3a7648fa6617b7762938f388caa4.png"><br>  As you can see from the screen, I analyzed each step to find out where the modification was made.  It consisted in the fact that the position of brackets was changed in two places, i.e.  priority action. <br>  Original: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xtea_decipher</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> num_rounds, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *v, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *k)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> v0=v[<span class="hljs-number"><span class="hljs-number">0</span></span>], v1=v[<span class="hljs-number"><span class="hljs-number">1</span></span>], delta=<span class="hljs-number"><span class="hljs-number">0x9E3779B9</span></span>, sum=delta*num_rounds; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; num_rounds; i++) { v1 -= (((v0 &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) ^ (v0 &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) + v0) ^ (sum + k[(sum&gt;&gt;<span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">3</span></span>]); sum -= delta; v0 -= (((v1 &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) ^ (v1 &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) + v1) ^ (sum + k[sum &amp; <span class="hljs-number"><span class="hljs-number">3</span></span>]); } v[<span class="hljs-number"><span class="hljs-number">0</span></span>]=v0; v[<span class="hljs-number"><span class="hljs-number">1</span></span>]=v1; }</code> </pre> <br>  Modified: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xtea_decipher</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> num_rounds, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *v, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *k)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> v0=v[<span class="hljs-number"><span class="hljs-number">0</span></span>], v1=v[<span class="hljs-number"><span class="hljs-number">1</span></span>], delta=<span class="hljs-number"><span class="hljs-number">0x9E3779B9</span></span>, sum=delta*num_rounds; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; num_rounds; i++) { v1 -= ((((v0 &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) ^ (v0 &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) + v0) ^ sum) + k[(sum&gt;&gt;<span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">3</span></span>]; sum -= delta; v0 -= ((((v1 &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) ^ (v1 &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) + v1) ^ sum) + k[sum &amp; <span class="hljs-number"><span class="hljs-number">3</span></span>]; } v[<span class="hljs-number"><span class="hljs-number">0</span></span>]=v0; v[<span class="hljs-number"><span class="hljs-number">1</span></span>]=v1; }</code> </pre> <br><br>  So, everything is over, it remains to cross the finishing tape.  In the place of which there is a comparison of data after decryption with the word CRACKLAB, from which it follows that this word had to be encrypted. <br>  That's it, we write keygen. <br><br><h5>  Total </h5><br>  To write keygens, we need: ripped code to create an array from the name, the implementation of Base32Encoding, the implementation of the modified XTEA, a table of masks and a little finish your code.  First, the dump of the table is translated into an array, which can be inserted into the code, everyone can do it as it is more convenient for him.  The serial generation algorithm has the following form: <br><ol><li>  Name =&gt; name_array [16] </li><li>  Morf (name_array) </li><li>  KEY.SomeBytes [i] = random () &amp; table [name_array [i]] </li><li>  KEY.SomeCount = bitscount (KEY.SomeBytes) </li><li>  KEY.CipherText = xtea_encode (‚ÄúCRACKLAB‚Äù) </li><li>  SerialBase = Base32Encode (KEY) </li><li>  Serial = InsertDefis (SerialBase) </li></ol><br><br>  My keygen: <a href="https://github.com/reu-res/CRACKLAB-Contest-2010">github.com/reu-res/CRACKLAB-Contest-2010</a> <br><br>  In the next article I will analyze the second task, which will probably be more interesting than this.  Attention SPOILER!  There you will find analysis VM (well, the author said so), the implementation of which differs from ordinary implementations, which are similar in structure to each other.  See you. </div><p>Source: <a href="https://habr.com/ru/post/135848/">https://habr.com/ru/post/135848/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../135838/index.html">Let's play snowballs?</a></li>
<li><a href="../135840/index.html">PyS60: Tale of how to write a notepad for Symbian</a></li>
<li><a href="../135844/index.html">Who teaches whom: student teacher or student teacher?</a></li>
<li><a href="../135845/index.html">Budget option of virtual PBX with non-budget features</a></li>
<li><a href="../135846/index.html">Recipe cooking 1U server at home</a></li>
<li><a href="../135849/index.html">Mindbloom Life Game - interactive tree of self-improvement</a></li>
<li><a href="../135850/index.html">Structuring JS Assets in Rails 3.1 (Styx)</a></li>
<li><a href="../135851/index.html">XNA: Display text in system fonts</a></li>
<li><a href="../135853/index.html">In China, buyers of goods in online stores will be obliged to indicate real data</a></li>
<li><a href="../135855/index.html">Errrr - Simplest Error Recorder</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>