<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MPS. Making a simple extension for the JAVA language</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction  The audience of Habr is quite heterogeneous, and it is difficult to write a text that is equally suitable for experienced DSL architects...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MPS. Making a simple extension for the JAVA language</h1><div class="post__text post__text-html js-mediator-article"><h5>  <b>Introduction</b> </h5>  The audience of Habr is quite heterogeneous, and it is difficult to write a text that is equally suitable for experienced DSL architects and, at the same time, accessible for inquiring minds of interested students.  We assume a whole series of articles about MPS in order to consistently bring our reader from simple to more complex things. <br><br>  Immediately it should be noted that MPS users have two completely different roles - ‚Äú <b>language developer</b> ‚Äù and ‚Äú <b>language developer</b> ‚Äù.  For the ‚Äúdeveloper in the language‚Äù, MPS is just an IDE, very close in its behavior to the majority of IDEs for familiar programming languages.  Moreover, for the ‚Äúdeveloper in the language‚Äù there is a plugin that allows you to program in the language created in MPS, directly from IntelliJ IDEA.  Next we focus on the role of ‚Äúlanguage developer‚Äù. <a name="habracut"></a><br><br>  This is the first article in which we will show how an existing language, in this case Java, can be extended with new constructions in MPS.  First, we will talk a little about the basic principles of MPS and introduce a few special concepts.  At the end of the article there will be a screencast in which we will write our own extension of the Java language.  To understand further articles, we recommend repeating these steps yourself.  We promise in the comments and direct messages to help all who have difficulties. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Before reading this article, we recommend that you read Konstantin Solomatov <a href="http://habrahabr.ru/post/66094/">habrostaty</a> , which describes what DSL is and who needs them.  It also explains how the MPS approach differs from the previous approach to the development of DSL (based on lexers and parsers), and how it relates to the projection editor. <br><br><h5>  <b>MPS Concepts</b> </h5>  <b>AST</b> <br>  As you already understood from the previous <a href="http://habrahabr.ru/post/66094/">article</a> , MPS operates with the <b>syntax tree of the</b> program, or <b>AST</b> (Abstract Syntax Tree). <br><br>  This tree consists of <b>nodes</b> ( <b>node</b> ), each of which has: <br><ul><li>  Child nodes </li><li>  Properties (string, numeric, logical, etc.) </li><li>  Links to other nodes </li></ul><br><br>  Nodes in MPS are combined into <b>models</b> .  A model in MPS is an analog package in the Java language. <br><br>  <b>Concept</b> <br>  Each AST node has a type that determines the composition of this node, its behavior when editing, generating, etc.  This type in MPS is called a <b>concept</b> .  In a rough approximation, the concept and node are in the same relationship as the class and object in the Java language. <br><br>  The concept declaration in MPS describes what data will be stored in the nodes of this concept.  The rest of the concept's behavior (editor, type constraints, generator) is described in the <b>aspects of the</b> concept of the same name - editor, typesystem, generator ... <br><br>  <b>A language</b> is simply a set of concepts and their aspects. <br><br>  Generation <br>  Analog compilation in MPS is called <b>generation</b> .  As a result of generation from the model files on the disk are obtained. <br><br>  Generation has 2 stages: <br>  <b>Model-to-Model transformation</b> .  At this stage, the MPS converts the source AST according to the rules described in the generator aspect of the language.  The result is another AST, in a lower level language. <br>  <b>Model-to-Text transformation</b> .  At this stage, the MPS takes the model obtained in the first step and converts each of its nodes to text, and then writes this text to a file on disk. <br><br>  With the basic concepts finished, let's now get acquainted with the MPS on the example of the following problem. <br><br><h5>  <b>Formulation of the problem</b> </h5>  In practice, quite often you have to write a conditional operator in the form: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (condition) { statement; }</code> </pre> <br><br>  In our example, we are going to implement a special notation for the construction in MPS that will allow us to write the same code shorter: <br><br><pre> <code class="java hljs">? condition : statement;</code> </pre> <br><br>  The new construct will be an extension of the Java language, it can be used anywhere in the code where the use of a conditional operator is permissible.  Of course, you can do without this extension, but in this article our goal will not be the invention of a new language, but only a demonstration of how to create language extensions in the MPS environment. <br><br><h5>  <b>We put MPS on our computer</b> </h5>  This is the easiest stage.  You need to go to the official website of JetBrains and <a href="http://confluence.jetbrains.com/display/MPS/JetBrains%2BMPS%2BEAP%2BDownload%2BPage">download</a> the MPS distribution.  The installation process is available to any habrowser (if not available, that user is clearly not from the habrowheader).  In this article I will give an example for MPS 3.0 installed on MacOS X, but on other operating systems, everything looks the same. <br><br>  Next, we offer our reader to see a small screencast of how to make a simple extension of the Java language in MPS: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/gDhX3-BJ2sQ%3Ffeature%3Doembed&amp;xid=17259,15700021,15700043,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhhVbXV4lJTsohU60FdAOv-u7qXWLg" frameborder="0" allowfullscreen=""></iframe><br><br><h5>  <b>Summarizing</b> </h5>  In this example, we wrote about 10 lines of code to extend the language, but the description of the process was rather lengthy.  Of course, it is rather difficult to start writing your own languages ‚Äã‚Äãor extensions from scratch, but the development of the project implies a simpler approach in the future. <br>  In this article, we got to know the MPS environment more closely and now everyone can add a little bit of syntactic sugar to their Java jug. <br><br>  Related Links <br>  <a href="http://habrahabr.ru/post/66178/">habrahabr.ru/post/66178</a> <br>  <a href="http://habrahabr.ru/post/122358/">habrahabr.ru/post/122358</a> <br>  <a href="http://habrahabr.ru/post/122650/">habrahabr.ru/post/122650</a> <br>  <a href="http://habrahabr.ru/post/68313/">habrahabr.ru/post/68313</a> <br>  <a href="http://habrahabr.ru/post/169711/">habrahabr.ru/post/169711</a> <br>  <a href="http://habrahabr.ru/post/74367/">habrahabr.ru/post/74367</a> <br><br>  <a href="http://confluence.jetbrains.com/display/MPSD2/Basic%2Bnotions">confluence.jetbrains.com/display/MPSD2/Basic+notions</a> <br>  <a href="http://www.jetbrains.com/mps/documentation/index.html">www.jetbrains.com/mps/documentation/index.html</a> <br>  <a href="http://confluence.jetbrains.com/display/MPS/Welcome%2Bto%2BJetBrains%2BMPS%2BSpace">confluence.jetbrains.com/display/MPS/Welcome+to+JetBrains+MPS+Space</a> <br>  <a href="http://confluence.jetbrains.com/display/MPSD2/MPS%2BUser%2527s%2BGuide">confluence.jetbrains.com/display/MPSD2/MPS+User%27s+Guide</a> </div><p>Source: <a href="https://habr.com/ru/post/180723/">https://habr.com/ru/post/180723/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180711/index.html">Kim Dotcom and two-factor authentication</a></li>
<li><a href="../180715/index.html">Google acquired the manufacturer of flying wind turbines</a></li>
<li><a href="../180717/index.html">Fast neutron reactors - that‚Äôs the hope of mankind!</a></li>
<li><a href="../18072/index.html">Cognitive Story About David Ire's Gmail Vulnerability</a></li>
<li><a href="../180721/index.html">The Adventures of Cosmic Joe</a></li>
<li><a href="../180725/index.html">Windows Internal</a></li>
<li><a href="../180729/index.html">"Witch Hunt" - an unpopular view of copyright, licensed products and copyright issues in Russia</a></li>
<li><a href="../18073/index.html">Our Christmas trees</a></li>
<li><a href="../180731/index.html">We teach the "iron horse" to share electricity</a></li>
<li><a href="../180735/index.html">3D printer UP! - review and first print</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>