<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We control the laptop fan through DSDT in Linux and not only</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I do not know why, but I always perceived the cooling systems in laptops as a kind of closed black box. The dullness of the algorithms, according to w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We control the laptop fan through DSDT in Linux and not only</h1><div class="post__text post__text-html js-mediator-article">  I do not know why, but I always perceived the cooling systems in laptops as a kind of closed black box.  The dullness of the algorithms, according to which the fan began to howl hysterically when the processor was still quite cold, was pretty annoying in many laptops, but it seemed to me that all the parameters there were nailed by manufacturers and you can change them only by picking up the BIOS or just inserting any adjustable resistors into right places.  I didn‚Äôt want to do either one or the other, so I never even seriously thought about it. <br><br>  No, of course, I heard about all sorts of programs that can interfere with the management of cooling, and someone seems to be using them successfully, but I personally had no luck with them, or rather, I was not lucky with the iron on which I tried to start them.  For example, some time ago I tried to configure fancontrol on a rather old HP nc8430 laptop with Ubuntu.  As a result, the famous sensor-detect script could not find a single fan in the system, and without this the fancontrol does not work.  At various forums, people periodically appear with similar problems, but no one can really help them. <br><br>  Then I once again abandoned this topic and returned to it only the other day, when I read reviews, looking for a new laptop for myself, and already seemed to choose the good Sony S15 for almost everyone, as I read about it in one of the reviews, never stops at all, even when exactly you can.  I no longer want a constantly noisy laptop, but I don‚Äôt want to choose as always, considering that I need 15 ", I don‚Äôt want the TN matrix anymore, and the budget is limited. You know how it is. Maybe everything is on it "So fancontrol will start and everything will be fine, but if not? No reports on how to install it on this laptop could be found. This prompted me to once again dig up the topic of fan control software and go through a rather complicated but very exciting quest. <br><a name="habracut"></a><br><h4>  As it is in windows </h4><br>  I decided that if I manage to deal with the cooling of my HP, then I will probably cope with the new Sony.  If not, have to look for another laptop.  Googling a little, I managed to find out that under Windows there is a wonderful program Notebook Hardware Control, it is free, everyone praises it.  Well, you have to try.  Rebooted in Windows, downloaded, launched - the program really works.  You can set the temperature at which the fan is turned off altogether, run at low speed, medium and high, and most importantly, you can set the fan motor power in percent for all three modes.  It is power, not revolutions per second, but what difference does it make. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It turned out that in this laptop, by default, the lowest revolutions correspond to 55% of power.  That is, either the fan is completely silent, or it buzzes quite loudly at its 55%, and when the temperature rises even louder: 70%, 80% and 100%.  In this case, he is silent only up to 50 degrees, and then immediately begins to work.  The processor is quite hot - Core 2 Duo T7600, less than 50 degrees it happens only immediately after switching on, then the temperature quickly becomes higher, even at zero load, and already does not want to fall below 50 C in any way, only if you unwind the fan to full and leave so for a few minutes, and then when the room is not very hot.  At the default 55%, the fan simply has no chance to cool the processor back below 50 C. Although it may be necessary to simply try to change the thermal paste, but now it's not about that. <br><br>  With the help of the program, I just set the minimum power to 30% and raised the minimum temperature at which the fan turns on to 60 C. The body temperature at the same time almost did not change to the touch, as it was quite hot, it remained, but it became much quieter.  During the daytime, a fan at 30% power can be heard only if you bring an ear to it.  At night in a quiet room it is quite audible, but tolerable.  It is much better than it was.  If you raise the minimum temperature a little more and put the processor and video card into power saving mode, you can get an absolutely quiet laptop, only the hard drive can be heard rotating, but this can be solved only by replacing it with an SSD, which in general would be good to do.  In short, it is possible to fully control the temperature and noise.  There would be a fairy tale end, but this is under Windows, and I need it under Linux! <br><br><h4>  How is it under linux </h4><br>  Under Linux there is no such program.  And how it works, I honestly still do not fully understand, and at that time I was there only peeped on keywords that were very useful later: ACPI and DSDT.  I'll come back to them later.  In the meantime, I rebooted back to Ubuntu and began to carefully study the pre-googled path in sysfs: / sys / class / thermal.  It turned out that: <br><pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">lrwxrwxrwx</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> cooling_device0 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> cooling_device1 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> cooling_device2 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> cooling_device3 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> cooling_device4 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> cooling_device5 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> cooling_device6 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> cooling_device7 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> cooling_device8 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">26</span></span> cooling_device9 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> thermal_zone0 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> thermal_zone1 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> thermal_zone2 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> thermal_zone3 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> thermal_zone4 lrwxrwxrwx <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">0</span></span> Jan <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> thermal_zone5</code> </pre> <br><br>  As many as 10 cooling_devices and 6 thermal_zones.  With thermal zones, everything is more or less clear; the temperatures of the CPU, GPU, some other three points are not particularly important.  And the last thermal_zone5 is not at all the temperature, as it turned out by experience, but the current fan power.  Bravo HP!  Now I understand why sensors-detect did not find anything, it‚Äôs such a mess that the devil‚Äôs leg breaks.  This is how you can simply change any power in thermal_zone5 / temp.  The file is read-only, which is understandable. <br><br>  Now let's look at cooling_device *, why are there 10 of them?  Inside each folder there is something like this: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">drwxr-xr-x</span></span> 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Jan</span></span> 10 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:35</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">power</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-rw-r--r--</span></span> 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.0K</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Jan</span></span> 10 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:35</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cur_state</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lrwxrwxrwx</span></span> 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Jan</span></span> 10 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:35</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">device</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-r--r--r--</span></span> 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.0K</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Jan</span></span> 10 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:35</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">max_state</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lrwxrwxrwx</span></span> 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Jan</span></span> 11 2013 <span class="hljs-selector-tag"><span class="hljs-selector-tag">subsystem</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-r--r--r--</span></span> 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.0K</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Jan</span></span> 10 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:35</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">type</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-rw-r--r--</span></span> 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.0K</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Jan</span></span> 11 2013 <span class="hljs-selector-tag"><span class="hljs-selector-tag">uevent</span></span></code> </pre><br><br>  In the type files for cooling_device, Fan is written from 0 to 6, Processor is written in 7-8, and LCD is written in 9-8.  Hmm, I know for sure that I have only one fan in my laptop.  Processors, one can say, really two and there is one LCD screen, this is true.  But these are not cooling devices, why are they here?  Okay, we will try to understand further in this mess.  In cur_state files, it is either 0 or 1. Yeah, it looks like some sort of spreading bitmask.  If you try to write zeros to all cur_state with ‚Äúecho 0 |  sudo tee / sys / thermal / cooling_device * / cur_state ", then the fan will stop.  And if you write a unit in cooling_device3 / cur_state, then the fan will spin by 55%.  Hooray, I managed to control the fan manually in Ubunt.  There could be some demon on the Python, which would put the necessary power at certain temperatures, but firstly, only ‚Äústandard‚Äù powers from the set of 0, 55, 70, 80, 100 can be set this way, and now I It is necessary 30. And secondly, something else in the system changes these bits.  We should try to figure out what exactly this is doing and how it can be influenced.  In other words, ‚Äúwe have to go deeper‚Äù.  Then I remembered the first keyword suggested by that Windows program: ACPI. <br><br><h4>  ACPI </h4><br>  It seems there is such a demon in Ubunt acpid.  Maybe he controls all this?  But no, judging by the description, he only watches pressing the off button, lowering the lid, and all that.  Indeed, even if it is stopped, the fan will continue to work as if nothing had happened, just as the power varies depending on the temperature.  But I also saw in the program that there is a lot of things in ACPI, including a certain DSDT (Differentiated System Description Table) table, which is not really a table, but rather a code in a language called AML (ACPI Machine Language) .  More precisely, the code is written in ASL (ACPI Source Language), and then compiled into AML, that is, AML is a bytecode, which, in turn, is easy to decompile back into ASL.  I hope I did not confuse you, dear readers.  In addition to DSDT, there are other tables - SSDT, etc., they also have AML-code and data, but the most interesting is usually contained in DSDT.  In the code of these tables there is a description of all the devices of the computer and the algorithms for controlling their power supply, including, of course, the fan. <br><br>  Once there is a bytecode, then there must be an interpreter somewhere that will execute it.  Indeed, the core of each OS that supports ACPI must contain a virtual machine to execute the DSLT AML code and other tables.  There is it in Linux.  So there was something that changes these bitiki in cur_state files, this is the kernel itself. <br><br>  Table code can be taken in sysfs, in the / sys / firmware / acpi / tables / directory.  But first you need to install the Intel compiler for ASL / AML, on Debian-based systems this is done like this: ‚Äúsudo apt-get install iasl‚Äù.  Then simply by making ‚Äúsudo cat / sys / firmware / acpi / tables / DSDT&gt; /tmp/dsdt.dat‚Äù and ‚Äúiasl -d /tmp/dsdt.dat‚Äù, we will get the source code for DSDT in the /tmp/dsdt.dsl file .  ASL, though difficult to read, is a rather simple language in itself, apparently, specially designed so that it is easier to write its interpreter, since for each OS it should be its own.  I pretty quickly figured out how to change the fan power, just looking for the very power (55, 70, 80, 100) transferring to hexadecimal system and they were immediately found.  The build is done with the iasl -tc /tmp/dsdt.dsl command. <br><br>  At the same time errors and warnings can come out, and in those lines that you did not touch.  Everyone says that this is happening because almost all the BIOS manufacturers use the compiler from Microsoft, and he just ignores many errors, Intel's much more severe.  But I have a version that programmers simply refuse to write normally in this stupid language.  Among other things, I found in my DSDT a rather annoying typo in the name of the method that returns the current screen backlight level because of this, the kernel always cursed when loading ‚Äú[Firmware Bug]: ACPI: No _BQC method, cannot determine initial brightness‚Äù, and Out of sleep, the backlight settings always went astray.  So even if everything is all right with cooling, you still have a reason to look at your DSDT.  The network is full of <a href="http://forums.gentoo.org/viewtopic.php%3Ft%3D122145">recipes for</a> how to correct certain errors in DSDT, here I will not dwell on this in detail. <br><br>  It turns out that if we can decompile, edit and compile back into DSDT bytecode and other tables, then we can do anything with the power of any devices.  Now you just need to somehow slip the patched DSDT into the kernel.  It is dangerous to do this, you can burn something through negligence, so think 100 times if you need it before you do anything described below. <br><br><h4>  How to make the kernel perform patched DSDT </h4><br>  The entire AML code is stored in the BIOS and the kernel, by default, takes it from there.  The first thing that comes to mind is to make your BIOS image with the patched DSDT and flash it.  The risk of getting a brick is very high, but with a successful outcome, all changes will be immediately available in all the operating systems that you use.  But, of course, there are better and safer ways. <br><br>  Before writing this article, I looked at what was on Habr√© on this topic and was very jealous of how easy it is to do in <a href="http://habrahabr.ru/post/150887/">FreeBSD</a> . <br>  For Linux, HowTo is often advised to rebuild the kernel from source by integrating your DSDT there.  There are many such instructions, there is nothing complicated, <a href="http://habrahabr.ru/post/128449/">there is about it</a> on Habr√© <a href="http://habrahabr.ru/post/128449/">too</a> , so I won‚Äôt repeat it again. <br><br>  Previously, before the 2.6 version of the kernel, there was a convenient way to boot through the initrd, but then Linus came and said that it was bad to do so, but it was either good or nothing, and the method was removed.  Linus will have to believe, since he says that it is necessary, it means it is necessary. <br>  <a href="http://www.matrix44.net/blog/%3Fp%3D1072">They say</a> that it is still possible to transfer the required DSDT via the GRUB2 kernel.  I really didn't want to rebuild the core and I decided to try it.  At first, I only wrote DSDT to the config file, the author of that article worked this way, but the kernel didn‚Äôt load it at all, it had something like this in the log: <br><pre> <code class="hljs pgsql">ACPI <span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span>: AE_NO_ACPI_TABLES, <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> loading namespace <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ACPI <span class="hljs-keyword"><span class="hljs-keyword">tables</span></span> (<span class="hljs-number"><span class="hljs-number">20110623</span></span>/tbxface<span class="hljs-number"><span class="hljs-number">-642</span></span>) ACPI: Unable <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">load</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">System</span></span> Description <span class="hljs-keyword"><span class="hljs-keyword">Tables</span></span> PM: Registering ACPI NVS region at d7fe5600 (<span class="hljs-number"><span class="hljs-number">76288</span></span> bytes) ACPI: Interpreter disabled.</code> </pre><br><br>  Accordingly, ACPI did not work at all.  A terrible thing, by the way.  Wi-fi did not work for me at this, the shutdown button turned off everything at once, and did not start a normal shutdown.  In short, you can not use it at all.  Then I tried to transfer all the tables in parameters in general, it turned out like this: <br><pre> <code class="hljs vhdl">ACPI: RSDP <span class="hljs-number"><span class="hljs-number">0009</span></span>f500 <span class="hljs-number"><span class="hljs-number">00024</span></span> (v03 ) ACPI: XSDT d74ad95c <span class="hljs-number"><span class="hljs-number">00084</span></span> (v01 <span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">00000000</span></span>) ACPI: SSDT d74aca78 <span class="hljs-number"><span class="hljs-number">004</span></span>B9 (v01 HP CpuPm <span class="hljs-number"><span class="hljs-number">00003000</span></span> INTL <span class="hljs-number"><span class="hljs-number">20100528</span></span>) ACPI: SSDT d74acf31 <span class="hljs-number"><span class="hljs-number">000</span></span>A0 (v01 HP Cpu1Tst <span class="hljs-number"><span class="hljs-number">00003000</span></span> INTL <span class="hljs-number"><span class="hljs-number">20100528</span></span>) ACPI: SSDT d74acfd1 <span class="hljs-number"><span class="hljs-number">00232</span></span> (v01 HP Cpu0Tst <span class="hljs-number"><span class="hljs-number">00003000</span></span> INTL <span class="hljs-number"><span class="hljs-number">20100528</span></span>) ACPI: SSDT d74ad203 <span class="hljs-number"><span class="hljs-number">002E0</span></span> (v01 HP HPQSAT <span class="hljs-number"><span class="hljs-number">00000001</span></span> INTL <span class="hljs-number"><span class="hljs-number">20100528</span></span>) ACPI: SSDT d74ad4e3 <span class="hljs-number"><span class="hljs-number">00059</span></span> (v01 HP HPQNLP <span class="hljs-number"><span class="hljs-number">00000001</span></span> INTL <span class="hljs-number"><span class="hljs-number">20100528</span></span>) ACPI: TCPA d74ad53c <span class="hljs-number"><span class="hljs-number">00032</span></span> (v02 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: MCFG d74ad56e <span class="hljs-number"><span class="hljs-number">0003</span></span>C (v01 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: APIC d74ad5aa <span class="hljs-number"><span class="hljs-number">00068</span></span> (v01 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: HPET d74ad612 <span class="hljs-number"><span class="hljs-number">00038</span></span> (v01 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: SLIC d74ad64a <span class="hljs-number"><span class="hljs-number">00176</span></span> (v01 HPQOEM SLIC-MPC <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: FACS d74ad7c0 <span class="hljs-number"><span class="hljs-number">00040</span></span> ACPI: FACP d74ad800 <span class="hljs-number"><span class="hljs-number">000</span></span>F4 (v04 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000003</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: DSDT d749d420 <span class="hljs-number"><span class="hljs-number">0</span></span>F658 (v01 HP nc8430 <span class="hljs-number"><span class="hljs-number">00010000</span></span> INTL <span class="hljs-number"><span class="hljs-number">20100528</span></span>) ACPI <span class="hljs-literal"><span class="hljs-literal">Error</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Null</span></span> physical address <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ACPI table [FACS] (<span class="hljs-number"><span class="hljs-number">20110623</span></span>/tbutils-<span class="hljs-number"><span class="hljs-number">459</span></span>) &lt;...&gt; ACPI <span class="hljs-literal"><span class="hljs-literal">Warning</span></span>: Could <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">map</span></span> the FACS table (<span class="hljs-number"><span class="hljs-number">20110623</span></span>/utxface-<span class="hljs-number"><span class="hljs-number">168</span></span>) ACPI: Unable <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> enable ACPI</code> </pre><br><br>  This time there was an attempt to load DSDT, but apparently there is some kind of link to the FACS table, which cannot be resolved in this environment.  Having suffered a bit with this, after 20 system reboots, I did not manage to make everything work in this way.  Spitting on everything, put the core to reassemble and went to bed, in the morning everything worked as it should: <br><pre> <code class="hljs cs">ACPI: RSDP <span class="hljs-number"><span class="hljs-number">000f</span></span>96a0 <span class="hljs-number"><span class="hljs-number">00024</span></span> (v02 HP ) ACPI: XSDT d7fe57c8 <span class="hljs-number"><span class="hljs-number">0007</span></span>C (v01 HPQOEM SLIC-MPC <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: FACP d7fe5684 <span class="hljs-number"><span class="hljs-number">000F</span></span>4 (v04 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000003</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: Override [DSDT- nc8430], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span>: tainting kernel ACPI: DSDT @ <span class="hljs-number"><span class="hljs-number">0xd7fe5acc</span></span> Table <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>, replaced with: ACPI: DSDT c181c9e0 <span class="hljs-number"><span class="hljs-number">0F</span></span>658 (v01 HP nc8430 <span class="hljs-number"><span class="hljs-number">00010000</span></span> INTL <span class="hljs-number"><span class="hljs-number">20100528</span></span>) ACPI: FACS d7ff7e80 <span class="hljs-number"><span class="hljs-number">00040</span></span> ACPI: SLIC d7fe5844 <span class="hljs-number"><span class="hljs-number">00176</span></span> (v01 HPQOEM SLIC-MPC <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: HPET d7fe59bc <span class="hljs-number"><span class="hljs-number">00038</span></span> (v01 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: APIC d7fe59f4 <span class="hljs-number"><span class="hljs-number">00068</span></span> (v01 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: MCFG d7fe5a5c <span class="hljs-number"><span class="hljs-number">0003</span></span>C (v01 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: TCPA d7fe5a98 <span class="hljs-number"><span class="hljs-number">00032</span></span> (v02 HP <span class="hljs-number"><span class="hljs-number">30</span></span>A3 <span class="hljs-number"><span class="hljs-number">00000001</span></span> HP <span class="hljs-number"><span class="hljs-number">00000001</span></span>) ACPI: SSDT d7ff5e97 <span class="hljs-number"><span class="hljs-number">00059</span></span> (v01 HP HPQNLP <span class="hljs-number"><span class="hljs-number">00000001</span></span> MSFT <span class="hljs-number"><span class="hljs-number">0100000</span></span>E) ACPI: SSDT d7ff5ef0 <span class="hljs-number"><span class="hljs-number">00326</span></span> (v01 HP HPQSAT <span class="hljs-number"><span class="hljs-number">00000001</span></span> MSFT <span class="hljs-number"><span class="hljs-number">0100000</span></span>E) ACPI: SSDT d7ff6a6b <span class="hljs-number"><span class="hljs-number">0025F</span></span> (v01 HP Cpu0Tst <span class="hljs-number"><span class="hljs-number">00003000</span></span> INTL <span class="hljs-number"><span class="hljs-number">20060317</span></span>) ACPI: SSDT d7ff6cca <span class="hljs-number"><span class="hljs-number">000</span></span>A6 (v01 HP Cpu1Tst <span class="hljs-number"><span class="hljs-number">00003000</span></span> INTL <span class="hljs-number"><span class="hljs-number">20060317</span></span>) ACPI: SSDT d7ff6d70 <span class="hljs-number"><span class="hljs-number">004</span></span>D7 (v01 HP CpuPm <span class="hljs-number"><span class="hljs-number">00003000</span></span> INTL <span class="hljs-number"><span class="hljs-number">20060317</span></span>) &lt;...&gt; ACPI: Interpreter enabled</code> </pre><br><br>  It would be possible to open champagne and celebrate success, but in my head it was a thought that one could do something better.  After all, that program under Windows allowed me to change everything on the go.  It turns out that it can also be done in Linux, here is the <a href="http://www.kernel.org/doc/Documentation/acpi/method-customizing.txt">documentation</a> .  This method is almost never written on the forums, and the method is really wonderful.  Usually, it is necessary to redefine one or two methods, and if at the same time you do not need to reboot, then this is a beauty in general. <br><br>  I prepared a .aml file with a rewritten method of fan management and, happily anticipating how everything will work fine now, I type ‚Äúsudo cat ./fan-speeds.aml&gt; / sys / kernel / debug / acpi / custom_method‚Äù and ... I get ‚Äúzsh: permission denied : / sys / kernel / debug / acpi / custom_method ".  How is permission denied?  I did not forget to make sudo, the / sys / kernel / debug / acpi / directory judging by the permissions is open for writing to root, there are no immutable attributes and other things there.  WTF?  <a href="http://cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2011-1021">It turned out</a> that this feature was declared a hole, since supposedly there are such environments where the root can not do everything.  For example, it cannot load kernel modules after the system has fully booted.  Why and to whom it is necessary, I honestly even suppose to be afraid, but true.  It seems that in any Ubunt root, they can definitely do anything, so it‚Äôs not very clear why their Security Team <a href="http://ubuntu.5.n6.nabble.com/changing-perms-on-sys-kernel-debug-by-default-td724101.html">also believes</a> that this is a very serious vulnerability.  Fortunately, they didn‚Äôt cut it out of the kernel at all, but simply turned it off in the default config and made it possible to load separately as a module.  Well, to assemble one module is not the same as the whole kernel, and the connection of modules to us in Ubunt, thank God, has not been banned yet. <br><br>  I already had the kernel sources, so according to the <a href="https://wiki.ubuntu.com/KernelCustomBuild">instructions</a> I assembled, installed and enabled the custom_method module.  Now everything worked just fine. <br><br>  It remains as it should, and not diagonally read <a href="http://www.acpi.info/spec.htm">the ACPI specification</a> at your leisure and think about what else can be improved in a laptop.  I‚Äôm not exactly afraid of software problems in notebook cooling systems now.  I hope that you now too, if you suddenly feared before. </div><p>Source: <a href="https://habr.com/ru/post/165401/">https://habr.com/ru/post/165401/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165385/index.html">Linux :: two, three, five ... mouse pointers</a></li>
<li><a href="../165389/index.html">What do the CIOs of 2013 expect?</a></li>
<li><a href="../165395/index.html">NeoAxis 3D Game Engine updated to version 1.3</a></li>
<li><a href="../165397/index.html">A simple x86 assembly program: Sieve of Eratosthenes</a></li>
<li><a href="../165399/index.html">Influence of glial cells on synaptic communication: rather yes, or rather no?</a></li>
<li><a href="../165403/index.html">15,000 FPS. Hardcore tricks part 2 - well, a non-standard window</a></li>
<li><a href="../165405/index.html">Explore Mars with NASA</a></li>
<li><a href="../165417/index.html">How to take aura pictures with a webcam</a></li>
<li><a href="../165421/index.html">Developers can now respond to comments on Google Play</a></li>
<li><a href="../165423/index.html">IBM Watson supercomputer learned street lingo: it was necessary to clean its memory</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>