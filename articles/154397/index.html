<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to speed up the loading of your site using compress.php, which will combine and compress JS + CSS into Gzip</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Detailed instructions given on code.google will allow you to: 



- Compress all the numerous JS scripts and CSS styles 
- Merge all the files in one ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to speed up the loading of your site using compress.php, which will combine and compress JS + CSS into Gzip</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/08c/57c/b1c/08c57cb1c32be61bbcba9ee827ac0e32.png" alt="Accelerate the site using Google" align="left">  Detailed instructions given on <a href="http://code.google.com/p/compress/">code.google</a> will allow you to: <br><br><ul><li>  Compress all the numerous JS scripts and CSS styles </li><li>  Merge all the files in one JS and one CSS </li><li>  Compress the resulting two files into GZIP format, which almost all browsers understand and can unpack on the fly </li><li>  Prescribe a .htaccess that forces browsers to cache these two files </li></ul><br>  All this will happen when you run a single compress.php script <br><br>  For example, the result of compressing scripts on my site: <br><ul><li>  JS: compressed in gzip 26 698 B, compressed without gzip 95 796 B, was 120 147 B </li><li>  CSS: compressed in gzip 46,049 B, compressed without gzip 160,001 B, it was 281,870 B </li></ul><br>  It turns out that the traffic saving is <b>329,270</b> B. But the main gain for download speed is that now not 14 files are loaded, but only 2 (and this is much faster, since the browser does not waste time requesting).  Moreover, this is done only once, and not dynamically by the server itself (especially since not all servers support such compression configuration to save processor resources). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the end, it turns out: <br><pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"min/styles_1349888114.cssgz"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"min/all_1349888114.jsgz"</span></span></span><span class="hljs-tag"> /&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><a name="habracut"></a><br><br>  The instructions are surprisingly simple: <br><ol><li>  Download the <a href="http://code.google.com/p/compress/downloads/list">compress.php</a> script </li><li>  Download <a href="http://code.google.com/p/cssmin/downloads/list">cssmin.php</a> , <a href="https://github.com/rgrove/jsmin-php/">jsmin.php scripts</a> </li><li>  Upload these 3 scripts to the root of your site * </li><li>  Create a file compress_timestamp.php in the root of the site and set permissions on it so that the compress.php script can overwrite this file * </li><li>  Create an empty min folder in the root of your site </li><li>  In your index.php, include the following code in your header: <br><pre> <code class="hljs bash">&lt;?php require_once(<span class="hljs-string"><span class="hljs-string">'compress_timestamp.php'</span></span>); // timestamp   ,   .  <span class="hljs-variable"><span class="hljs-variable">$compress_stamp</span></span>=unix_timestamp <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stripos(<span class="hljs-variable"><span class="hljs-variable">$_SERVER</span></span>[<span class="hljs-string"><span class="hljs-string">'HTTP_ACCEPT_ENCODING'</span></span>],<span class="hljs-string"><span class="hljs-string">'GZIP'</span></span>)!==<span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-variable"><span class="hljs-variable">$gz</span></span>=<span class="hljs-string"><span class="hljs-string">'gz'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-variable"><span class="hljs-variable">$gz</span></span>=null; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;script src="min/js_schedule_'</span></span>.<span class="hljs-variable"><span class="hljs-variable">$compress_stamp</span></span>.<span class="hljs-string"><span class="hljs-string">'.js'</span></span>.<span class="hljs-variable"><span class="hljs-variable">$gz</span></span>.<span class="hljs-string"><span class="hljs-string">'" /&gt;'</span></span>,PHP_EOL; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;link rel="stylesheet" type="text/css" href="min/css_schedule_'</span></span>.<span class="hljs-variable"><span class="hljs-variable">$compress_stamp</span></span>.<span class="hljs-string"><span class="hljs-string">'.css'</span></span>.<span class="hljs-variable"><span class="hljs-variable">$gz</span></span>.<span class="hljs-string"><span class="hljs-string">'" /&gt;'</span></span>,PHP_EOL; ?&gt;</code> </pre><br></li><li>  Edit the compress.php file, and list your scripts and styles in the appropriate place: <br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> file_compress(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'css_schedule.css'</span></span></span><span class="php">,</span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">array</span></span></span><span class="php">(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'./CSS/menu.css'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'./CSS/ThreeColumnFixed.css'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'./CSS/sprite.css'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'./CSS/iCal.css'</span></span></span><span class="php">)); file_compress(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'js_schedule.js'</span></span></span><span class="php">,</span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">array</span></span></span><span class="php">(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'./js/all1.js'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'./js/jquery.js'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'./js/love_habrahabr.js'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">'./love_4pda.js'</span></span></span><span class="php">)); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  It is for these magical functions (packaged into one file and compressing it) that we started everything.  The necessary files will be created in the MIN folder in the GZipped and normal version.  If the browser is old, the usual JS and CSS formats will be displayed, if the new one is JSGZ and CSSGZ. <br></li><li>  Remotely run the script compress.php and everything will happen automatically </li><li>  Download site to check </li></ol><br><br>  <i>* for simplicity, we save all files to the root of the site, but it is better not to do this for security reasons</i> <br><br>  Now your site loads faster, your JS and CSS code is harder to decipher for fans to break something. <br><br>  Every time you change the scripts on the site, you need to run compress.php before loading the site, everything else happens automatically. <br><br>  Do not forget that the links to the pictures in your CSS styles should now be called taking into account that the CSS is in the MIN folder. <br><br><hr><br><br>  If you want to further speed up the site, there is a simple solution.  Set the headers of static files so that browsers caches them for a long time.  This can be done by putting the .htaccess file in the site root: <br><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">## EXPIRES CACHING ## </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;IfModule mod_expires.c&gt;</span></span></span><span class="hljs-meta"> ExpiresActive On ExpiresByType image/jpg </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 year"</span></span></span><span class="hljs-meta"> ExpiresByType image/jpeg </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 year"</span></span></span><span class="hljs-meta"> ExpiresByType image/gif </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 year"</span></span></span><span class="hljs-meta"> ExpiresByType image/png </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 year"</span></span></span><span class="hljs-meta"> ExpiresByType audio/mp3 </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 year"</span></span></span><span class="hljs-meta"> ExpiresByType audio/wav </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 year"</span></span></span><span class="hljs-meta"> ExpiresByType text/css </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 month"</span></span></span><span class="hljs-meta"> ExpiresByType application/pdf </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 month"</span></span></span><span class="hljs-meta"> ExpiresByType text/x-javascript </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 month"</span></span></span><span class="hljs-meta"> ExpiresByType application/x-shockwave-flash </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 month"</span></span></span><span class="hljs-meta"> ExpiresByType image/x-icon </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 1 year"</span></span></span><span class="hljs-meta"> ExpiresDefault </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"access 2 days"</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;/IfModule&gt;</span></span></span><span class="hljs-meta"> ## EXPIRES CACHING ##</span></span></code> </pre><br><br>  Afterword: The article is aimed at beginners, since the pros are already doing all this with the help of (with difficult settings for beginners) cumbersome platforms.  I do not urge to use exactly compress.php, but with its help you can be convinced of the need to combine and compress JS scripts and CSS styles. <br><br>  <a href="http://code.google.com/p/compress/">Source code.google</a> <br>  By Arn Burkhoff </div><p>Source: <a href="https://habr.com/ru/post/154397/">https://habr.com/ru/post/154397/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../154383/index.html">Google Nexus 7 comes to Russia</a></li>
<li><a href="../154385/index.html">Special font for finding errors after OCR</a></li>
<li><a href="../154387/index.html">Game "Life": model the evolution</a></li>
<li><a href="../154389/index.html">Curiosity Panoramas for 59 salt</a></li>
<li><a href="../154395/index.html">Another way to debug Android applications on a virtual device</a></li>
<li><a href="../154399/index.html">Database structure for route encyclopedia</a></li>
<li><a href="../154403/index.html">Ubuntu developers can now thank financially</a></li>
<li><a href="../154405/index.html">Dealing with information security incidents</a></li>
<li><a href="../154407/index.html">Gmail Show M. Later</a></li>
<li><a href="../154409/index.html">HP Wireless Networks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>