<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>1C-Bitrix on Raspberry Pi 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Our colleagues and partners, the web studio Oroblanko, decided to make an interesting experiment: run 1C-Bitrix on the Raspberry Pi 2 microcomputer. W...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>1C-Bitrix on Raspberry Pi 2</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/b2d/c2e/41b/b2dc2e41bcad42ae9f285b341b65b62b.jpg" align="left">  Our colleagues and partners, the web studio Oroblanko, decided to make an interesting experiment: run 1C-Bitrix on the Raspberry Pi 2 microcomputer. What we wrote about <a href="http://www.oroblancostudio.com/ru/blog/1c-bitrix-on-raspberry-pi-2.html">in</a> detail <a href="http://www.oroblancostudio.com/ru/blog/1c-bitrix-on-raspberry-pi-2.html">on our blog</a> .  With their kind permission we publish the results.  :) <br><br>  * * * <br><br>  Just say why we need it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Understand whether it is possible at all.  Ensure that the Raspberry Pi 2 is a computer, not a toy. <br><br>  Understand how fast and stable Bitrix will work on such a weak computer (and whether it will work at all). <br><br>  Confirm your own qualifications of specialists in setting up servers, because the task is not trivial. <br><br>  If everything works out, then we will dispel the old legend that ‚ÄúBitrix is ‚Äã‚Äãheavy, slow and cumbersome‚Äù and that it needs large computational resources. <a name="habracut"></a><br><br>  <a href="http://www.oroblancostudio.com/ru/blog/obzor-raspberry-pi-2.html">Some time ago we bought a Raspberry Pi 2</a> , collected it and connected it to a TV.  The machine seemed quite brisk, onboard 1 GB of memory and a quad-core processor plus Debian, which in the version for Raspberry is called Raspbian.  And since we are certified partners of 1C-Bitrix, our hands were itching to cross Raspberry with Bitrix and see what happens. <br><br>  We chose the pure form of the experiment using the Raspberry Pi 2 in the default configuration and did not connect additional HDD or SSD to the computer, leaving MicroSD as the main carrier, and for us to have more fun and the computer would not be bored, take the most ‚Äúheavy‚Äù Bitrix configuration.  Editorial "Business" and the decision "online store".  So that immediately, as they say, a sledgehammer on the head. <br><br>  SD cards - specific carrier.  The most time-consuming operation is recording.  The memory card is not the slowest, in addition, this moment is taken into account in Raspbian and all user write operations to disk are cached in RAM (delayed write), so from the user's point of view everything ‚Äúflies‚Äù.  But how will the machine work with writing to the card in the server configuration?  We do not know.  But we will try. <br><br>  We also understood that apache + mysqld is a resource-intensive piece, and under load there is a real overflow of RAM, the system will start using a swap and will ‚Äúsit on the disk‚Äù, as a result the server will ‚Äúlie down‚Äù.  Therefore, we immediately relied on nginx and Beatrix composite operation mode, which will minimize our risks. <br><br><h4>  <b>Getting started</b> </h4><br>  We put on a typewriter regular Raspbian and Midnight Commander for convenience.  Raspbian is chosen for the lack of glitches and maximum lickiness and stability.  Disable graphics mode (X server) to save resources.  Then we do everything through SSH. <br><br>  Be sure to execute commands <br><br><pre><code class="bash hljs">apt-get update apt-get upgrade</code> </pre> <br>  It turned out to be important.  If you do not upgrade the packages, then memcached and nginx will be crooked, and we are faced with this. <br><br><h4>  <b>We put Bitrix</b> </h4><br>  Download the installer web environment. <br><br><pre> <code class="bash hljs">wget http://repos.1c-bitrix.ru/yum/bitrix-env.sh chmod +x bitrix-env.sh ./bitrix-env.sh</code> </pre><br>  The script says, ‚ÄúWhat kind of crap do you give me?‚Äù And falls out.  Look what's wrong.  Yeah, first of all the script checks that it is run on a system that supports the x86 command set.  And we him ARM slipped.  Well, okay, people who dealt with the EU-1040 and DEC VAX, do not frighten.  The script, we did not rule.  We put everything manually, open the necessary ports. <br><br>  What we put: <br><br><ul><li>  mysql </li><li>  apache </li><li>  php with the required extensions (for example, geoip) </li><li>  gd </li><li>  nagios </li><li>  munin </li><li>  catdoc </li><li>  xpdf </li><li>  freetype </li><li>  apc </li></ul><br>  Nginx and memcached are not yet installed, as it is interesting to see how it will work on a pure Apache. <br><br>  Download the Bitrix distribution and start the installation process.  It is still put! <br><br><h4>  <b>Interesting</b> </h4><br>  So, at us on Raspberry Pi 2 the Bitrix, on the pure Apache, without nginx and memcached was got.  We connect caching of APC.  So, APC for Raspbian works in Emulated mode.  That is, it seems to be there for those who need it, but in fact it does not exist.  Therefore, in fact, it does not increase the speed of the site. <br><br>  Another interesting thing.  Memcached in Raspbian does not allow to work with sockets.  No matter how you customize, do not register.  It does not create a socket, even burst.  The only way to use memcached is to access the stub 127.0.0.1. <br><br>  Overclocking needs to be turned off.  It leads to unstable operation and freezing of the computer.  It is necessary to set the default frequency of 900 MHz. <br><br><h4>  <b>Performance</b> </h4><br>  The performance bar of Bitrix when testing on a pure Apache produces 6.5 - 7.0 ‚Äúparrots‚Äù, which is generally not so bad.  On some commercial hosting there are such indicators.  But it is interesting that after connecting memcached, the speedometer ‚Äúdrops‚Äù to 3.5 - 4.0 ‚Äúparrots‚Äù, although memcached really speeds up the site.  What is the reason for this behavior of the speedometer is not clear.  Also here - interesting. <br><br><img src="https://habrastorage.org/files/38d/048/b74/38d048b7483e4be5a037f37a84eb69b5.jpg"><br><br>  Apache for Raspbian is not optimized in any way.  Which leads to a bunch of hanging processes and memory overflow.  Therefore, we had to correct the settings by limiting the number of servers and the consumption of RAM. <br><br>  MySQL also required tuning to optimize the server for memory and performance. <br><br>  In general, the system works, but it is obviously hard.  Let's see how things change with nginx. <br><br><h4>  <b>Overclocking</b> </h4><br>  As I already mentioned, before installing nginx, you need to upgrade the system.  Otherwise, nginx is set up crookedly and, interestingly, the Apache is knocked out.  Therefore, we had two iterations of the installation.  Without the update system and with the update. <br><br>  After installing nginx, of course, we configure the frontend and backend (two-tier architecture), turn on the composite mode in Bitrix and tune the nginx settings, giving it all the pictures and ready html files from the composite cache. <br><br>  We enable CDN in Bitrix settings in order to maximally unload the server and bring all possible statics out. <br><br>  After connecting nginx and accumulating the composite cache, the site starts to work very quickly.  Like this: <br><br><img src="https://habrastorage.org/files/6c8/ac5/f7e/6c8ac5f7e9f649f9aac2571db5789e8d.jpg"><br><br><h4>  <b>Finalize</b> </h4><br>  We forward the port through NAT to see the server outside and hang it on the domain.  We check the security scanner, set up proactive protection and run tests of the quality monitor.  We configure the backup of the entire system to an external Synology server and put our microserver on external monitoring.  The average memory consumption of the system is 400-700 MB.  While normal flight. <br><br><img src="https://habrastorage.org/files/227/c92/309/227c92309fd94e33889050adb40212ec.jpg"><br><br><img src="https://habrastorage.org/files/dc8/36c/35c/dc836c35c2794625ba710587da9309d6.png"><br><br><img src="https://habrastorage.org/files/dbb/22b/78a/dbb22b78a8994f68bdb634ec3606d01e.jpg"><br><br><h4>  <b>Results</b> </h4><br>  We did it!  And it seems like nobody except us was perverted, we are the first in the world. <br><br>  Bitrix can work on anything, a proven fact. <br><br>  For normal performance, the following are required: composite mode, nginx, and apache + mysqld configuration. <br><br>  Even on Raspberry, the Bitrix can work fast. <br><br><h4>  <b>Project configuration</b> </h4><br>  1C-Bitrix, edited "Business" + solution "Online Store". <br><br>  Composite caching and CDN for static content are enabled. <br><br>  Computer <br><br>  Raspberry pi 2 <br><br>  Broadcom BCM2836 quad-core ARMv7 processor <br><br>  1GB RAM <br><br>  Media - Micro SD card 32 GB <br><br>  The channel speed is 30 Mbit / s or less. <br><br>  Os raspbian <br><br>  <a href="http://raspberry.oroblanco.ru/">Poke the mouse or finger on the site on Bitrix and Raspberry Pi 2 here (raspberry.oroblanco.ru)</a> . <br><br><img src="https://habrastorage.org/files/900/b4b/146/900b4b146fad4060b4650629789154ad.jpg"><br><br>  Author: Dmitry Ivanov <br><br>  Original: <a href="http://www.oroblancostudio.com/ru/blog/1c-bitrix-on-raspberry-pi-2.html">www.oroblancostudio.com/ru/blog/1c-bitrix-on-raspberry-pi-2.html</a> </div><p>Source: <a href="https://habr.com/ru/post/276409/">https://habr.com/ru/post/276409/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276397/index.html">What is the future of email: Opinions of the creator of Wikipedia, engineers and entrepreneurs from Silicon Valley</a></li>
<li><a href="../276399/index.html">What experts in Data Science and Big Data are discussing today</a></li>
<li><a href="../276401/index.html">The book "Hello World! Entertaining programming ¬ª</a></li>
<li><a href="../276403/index.html">Moira: Realtime Alerting</a></li>
<li><a href="../276407/index.html">Parse Server Migration Guide for Developers</a></li>
<li><a href="../276411/index.html">Recognize emotions in a UWP application using the Project Oxford API</a></li>
<li><a href="../276413/index.html">Installing SuiteCRM 7.5. Integration with Asterisk via Callinize - community Edition</a></li>
<li><a href="../276415/index.html">Google has released an update for Android</a></li>
<li><a href="../276417/index.html">The end of the era of global CSS</a></li>
<li><a href="../276419/index.html">Qt Dungeons: Monster Cooking Recipes (Part 1: Editing Heterogeneous Data)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>