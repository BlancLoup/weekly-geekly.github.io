<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Harbor - Registry for Docker Containers with Out-of-Box Security</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On July 31, CNCF announced the adoption of a new Open Source project, characterized as a cloud native registry, Harbor, in its sandbox (that is, at th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Harbor - Registry for Docker Containers with Out-of-Box Security</h1><div class="post__text post__text-html js-mediator-article">  On July 31, CNCF <a href="https://www.cncf.io/blog/2018/07/31/cncf-to-host-harbor-in-the-sandbox/">announced</a> the adoption of a new Open Source project, characterized as a cloud native registry, <a href="https://goharbor.io/">Harbor,</a> in its sandbox (that is, at the earliest stage of support).  On his website, they explain to us that the product was created to manage images of Docker containers in a secure environment. <br><br><img src="https://habrastorage.org/webt/to/ed/6i/toed6ijlvl_n0r90t6rgvmzbixa.png"><br><br>  It would seem that there is already a Docker Registry (or, say, Quay from CoreOS), but it is obvious that new solutions do not appear and do not ripen to use in production just like that - especially, Open Source solutions ... and even more so, falling into CNCF.  This review article aims to shed light on the causes of the emergence of Harbor, its key features and features. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Harbor's first focus: network and enterprise </h2><br>  The history of the project begins in 2016, in March of which the first public release took place - 0.1.0.  Its creation was backed <b>by VMware</b> engineers who described the project as an ‚Äúenterprise-class registry server‚Äù, which, based on the Docker development, ‚Äúexpands the capabilities of the Docker Registry by adding more functions to it, which are usually required in an enterprise‚Äù. <br><br>  At that time, the emphasis was more on the possibility of using this registry within the company, in particular, potentially improving productivity by storing images in the corporate network: ‚Äú[Harbor] is very useful for users of containers who do not have a good internet connection.  For example, Harbor improves the performance of Chinese developers by eliminating the difficulty of downloading images from the public Internet ‚Äù <i>(from <a href="">README to Harbor 0.1.0</a> )</i> . <br><br>  <i><b>Note</b> : Harbor's orientation on China, confirmed by the presence of appropriate localization from the first releases, was not accidental: the creation of the project as such was <a href="https://blog.imaginea.com/docker-private-registry-using-harbor-2/">initiated by</a> the Chinese division of the company (VMware China R &amp; D).</i> <br><br>  What has become commonplace for the cloud native ecosystem, Harbor was <b>written</b> from the very beginning <b>in Go</b> and licensed under the Apache License 2.0.  If we talk about the functionality of the project, then in the first release, the authors laid down some of the actual and to this day features, such as: <br><br><ul><li>  role-based access control ( <b>RBAC</b> , which allows to organize users and repositories in the form of ‚Äúprojects‚Äù and issue different rights to images within these projects), as well as support for LDAP and AD for user authentication; </li><li>  <b>Web-based user interface</b> for viewing repositories, searching for them, managing projects; </li><li>  <b>audit of</b> all operations; </li><li>  <b>REST API</b> to manage. </li></ul><br><img src="https://habrastorage.org/webt/jj/jw/gx/jjjwgxrboqn0rq3tpcut7_ydbqc.png"><br>  <i>Project management in the Harbor web interface</i> <br><br><h2>  Harbor Evolution: Safety </h2><br>  In 2017, VMware found a logical use for its new project - integration with other solutions of the company for containers.  In particular, <a href="http://vrelevant.net/containers-vms-and-vmware-session-5/"><b>vSphere Integrated Containers</b></a> (VIC), which, while not being a full-fledged PaaS (Platform as a Service) or CaaS (Containers as a Service), were actively developing, offered some kind of foundation for working with containers.  Today, for example, <a href="https://vmware.github.io/vic/">vSphere Integrated Containers Engine</a> , which is an executable container environment for vSphere, has grown.  This is how VIC solution engineer VMware (Nate Reid) described at that time: <br><br><blockquote>  <i>‚ÄúThe VIC takes the skeleton of a single Docker host and scales it to multiple ESXi hosts.</i>  <i>His proposed architecture for orchestration is similar to Swarm, Kubernetes (K8s), and Mesos.</i>  <i>However, there are some nuances, and there are no tasks to replace all these products.</i>  <i>VIC provides a container for the network, allows you to get their names, offers the HTML5 control panel (Admiral; for more details about it, see <a href="https://habr.com/company/flant/blog/338332/">our Docker GUI Review</a> - <b>approx. Translation</b> ), corporate level registry (Harbor), many similar Docker commands, integration with vSphere tools.</i>  <i>[..]</i> <i><br><br></i>  <i>If you need orchestration support with Kubernetes and / or VMware-based CI / CD capabilities from VMware, you should look at VMware PKS and / or Pivotal Cloud Foundry.</i>  <i>These are CaaS and PaaS class solutions. ‚Äù</i> </blockquote><br>  At the same time, the issue of <b>security of Docker images</b> is becoming increasingly important.  In early 2018, Pivotal‚Äôs brotherly engineers for VMware <a href="https://content.pivotal.io/blog/using-vmware-s-harbor-with-pks-and-why-kubernetes-needs-a-container-registry">cite</a> a <a href="http://dance.csc.ncsu.edu/papers/codaspy17.pdf">study</a> that even the latest versions of images posted on the Docker Hub (both from the community and official ones) contain numerous vulnerabilities (an average of 70 per image). <br><br>  It was then that Harbor appeared with its new safety-oriented purpose and already on the mentioned ‚Äúsoil‚Äù of CaaS - in the <b>Pivotal Container Service (PKS)</b> : <br><br><blockquote>  <i>‚ÄúThis is [the presence of vulnerabilities and other security issues in Docker images] and there is a reason that we have included so many useful additions that make PKS safe and secure!</i>  <i>[..]</i> <i><br><br></i>  <i>Since Kubernetes itself does not deal with such issues [secure image management], we worked with friends from VMware to turn Harbor into PKS. ‚Äù</i> </blockquote><br>  What is so safe added to Harbor (besides those already implemented in the RBAC project and audit)?  Two main directions are indicated: <br><br><ol><li>  <b>Vulnerability scan</b> .  To do this, Harbor implements CVE acquisition using known databases (NIST NVD, Ubuntu CVE Tracker, Red Hat Security Data, etc.) and automatically scanning each container image for their presence when performing push and pull operations.  If a vulnerability is found, operations are canceled depending on the security settings, and the image itself is flagged, which will be visible to the registry administrator.  To realize this opportunity, Harbor <a href="https://github.com/goharbor/harbor/issues/2042">integrated</a> with <a href="https://github.com/coreos/clair"><b>Clair</b></a> from CoreOS. </li><li>  <b>Signature images</b> .  Here we also use the <a href="https://github.com/theupdateframework/notary"><b>groundwork of</b></a> another project - <a href="https://github.com/theupdateframework/notary"><b>Notary</b></a> <i>(we mentioned it in <a href="https://habr.com/company/flant/blog/340366/">this article</a> )</i> - which makes a signature when pushing images, and then validates such signatures with each pull. </li></ol><br>  The general scheme of applying Harbor to PKS is as follows: <br><br><img src="https://habrastorage.org/webt/va/2s/cz/va2sczdfs6gzhomzofl4gb3mioi.png"><br><br><h2>  Harbor today </h2><br>  So, by offering a registry of container images for use on-premises and ensuring security in various aspects of working with them, today Harbor has evolved to the following architecture, which apparently combines functions from other Open Source projects: <br><br><img src="https://habrastorage.org/webt/5w/5i/lx/5w5ilxohbp2zf-6l5suz8fdieec.png"><br><br>  In addition to the already mentioned Docker Registry, Clair and Notary, implementing the key features of Harbor, in this scheme you can also see the presence of two other DBMS: <br><br><ol><li>  PostgreSQL ( <a href="https://github.com/goharbor/harbor/issues/4145">previously</a> here was MySQL / MariaDB), which is used to store metadata about projects, users and their roles, images; </li><li>  Redis - for <a href="https://github.com/goharbor/harbor/issues/2171">storing sessions</a> . </li></ol><br><img src="https://habrastorage.org/webt/gt/zm/lx/gtzmlxpeuwevt1bugxmhqa4s2h4.jpeg"><br>  <i>Databases in Harbor Architecture</i> <br><br>  Some details about the overall internal structure of Harbor can also be found in <a href="https://github.com/goharbor/harbor/wiki/Architecture-Overview-of-Harbor">this wiki page</a> referenced by the <a href="https://goharbor.io/docs/">official</a> project <a href="https://goharbor.io/docs/">documentation</a> <i>(however, it is suspected that some of the details on the architecture might be out of date in some places)</i> .  You can also find links to <a href="">Harbor installation</a> instructions and its <a href="">deployment to Kubernetes</a> .  The latter, however, has been declared obsolete (based on older versions, does not support Clair and Notary), and instead it is proposed to use the <a href="https://github.com/goharbor/harbor/tree/master/contrib/helm/harbor">Helm-chart</a> . <br><br>  The current version of Harbor - <a href="">v1.5.2</a> , released in late July.  Requirements for a Linux-based machine on which a fresh release of the registry is installed - Docker version 17.03.0-ce (or higher) and Docker Compose 1.10.0+, as well as Python and OpenSSL. <br><br>  A very interesting innovation for the future version of Harbor (already released <a href="https://github.com/goharbor/harbor/releases/tag/v1.6.0-rc1">v1.6.0-rc1</a> ) is <b>support for the Helm charts</b> : ‚ÄúHarbor, starting from version 1.6.0, will become a composite cloud native registry that will support both image management and chart management‚Äù .  Other <a href="">development plans</a> include OAuth 2.0 support for user authentication, the ability to deploy on multiple sites for fault tolerance and load balancing, collecting repository statistics and a utility for migration to Harbor. <br><br><h2>  Instead of conclusion </h2><br>  Harbor is an example of a successful project from the modern cloud world, which managed to find its niche and establish itself, simultaneously integrating the capabilities of other Open Source tools.  The evidence of his success is not only the inclusion of CNCF in the list of projects, but also 5000+ stars on <a href="https://github.com/goharbor/harbor">GitHub</a> , and a rather active developer community. <br><br><h2>  PS </h2><br>  Read also in our blog: <br><br><ul><li>  " <a href="https://habr.com/company/flant/blog/350928/">CNCF Guide to Open Source Solutions (and more) for cloud native</a> "; </li><li>  ‚Äú <a href="https://habr.com/company/flant/blog/353808/">OPA and SPIFFE - two new projects at CNCF for the security of cloud applications</a> ‚Äù; </li><li>  ‚Äú <a href="https://habr.com/company/flant/blog/344098/">Four releases 1.0 from CNCF and major announcements about Kubernetes from KubeCon 2017</a> ‚Äù; </li><li>  ‚Äú <a href="https://habr.com/company/flant/blog/417079/">Package Manager for Kubernetes - Helm: Past, Present, Future</a> ‚Äù; </li><li>  ‚Äú <a href="https://habr.com/company/flant/blog/335218/">CNCF offered a free open source cloud for DevOps / microservices</a> ‚Äù; </li><li>  " <a href="https://habr.com/company/flant/blog/337448/">Statistics on basic operating systems in images on Docker Hub</a> ". </li></ul></div><p>Source: <a href="https://habr.com/ru/post/419727/">https://habr.com/ru/post/419727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../419715/index.html">You do not know how to work with transactions.</a></li>
<li><a href="../419717/index.html">Embedded architecture design</a></li>
<li><a href="../419719/index.html">[bookmark] 23 recommendations for the protection of Node.js applications</a></li>
<li><a href="../419721/index.html">Biomarkers of aging. Frailty panel. Part 1</a></li>
<li><a href="../419725/index.html">Darts, dice and coins: discrete sampling algorithms</a></li>
<li><a href="../419729/index.html">Charity event ‚ÄúGive wings to children‚Äù</a></li>
<li><a href="../419731/index.html">Mini-review of a dental photopolymer 3D-printer MoonRay S</a></li>
<li><a href="../419733/index.html">Git happens! 6 typical git errors and how to fix them</a></li>
<li><a href="../419735/index.html">I / Q Signal Study with SDR using Adobe Audition</a></li>
<li><a href="../419743/index.html">What's wrong with popular articles telling that foo is faster than bar?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>