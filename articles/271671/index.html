<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Expansion of EPLAN functionality. Creating a simple Add-Ina in C #</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Expanding EPLAN functionality with Add-In on C # 
 EPLAN is a platform for end-to-end design, covering the following industries: electrical engineerin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Expansion of EPLAN functionality. Creating a simple Add-Ina in C #</h1><div class="post__text post__text-html js-mediator-article"><h4>  Expanding EPLAN functionality with Add-In on C # </h4><br><img src="https://habrastorage.org/files/0d2/872/0e4/0d28720e4f264fe49570d839b95150ea.jpg" align="right">  EPLAN is a platform for end-to-end design, covering the following industries: electrical engineering, instrumentation and automation, hydraulics / pneumatics and mechanics (design of cabinets and harnesses).  Due to the open architecture and standard integration modules, EPLAN can be cost-effectively integrated with a wide range of third-party solutions: mechanical design systems, ERP and PDM systems, building design systems, industrial plants and ships. <br><a name="habracut"></a><br><h5>  EPLAN application </h5><br>  ‚Ä¢ Automotive <br>  ‚Ä¢ Mechanical Engineering <br>  ‚Ä¢ Metallurgy <br>  ‚Ä¢ Chemical and pharmaceutical industry <br>  ‚Ä¢ Food industry <br>  ‚Ä¢ Mining of oil and gas <br>  ‚Ä¢ Pipeline transportation <br>  ‚Ä¢ Oil and gas processing <br>  ‚Ä¢ Heat and power generation <br>  ‚Ä¢ Transmission and distribution of electricity <br>  ‚Ä¢ Railway transport <br>  ‚Ä¢ Water supply and sanitation <br>  ‚Ä¢ Machine tool industry <br>  ‚Ä¢ Light industry <br>  ‚Ä¢ Building Automation <br><br><h5>  Main modules of the platform </h5><br>  ‚Ä¢ EPLAN Electric P8 - Modular and scalable solution for electrical design, automatic creation of design and working documentation. <br>  ‚Ä¢ EPLAN Fluid - Software for designing pneumatic / hydraulic automation, lubrication and cooling systems and automatic creation of relevant design and working documentation. <br>  ‚Ä¢ EPLAN ProPanel - 3D design of electrical cabinets with the transfer of data in production.  Virtual three-dimensional modeling, the creation of two-and three-dimensional drawings, a three-dimensional image of wired and routing schemes, the presence of templates for the operation of drilling equipment and integration with CNC machines <br>  ‚Ä¢ EPLAN PrePlanning - software for preliminary (draft) design of objects and generation of project documentation. <br>  ‚Ä¢ EPLAN Engineering Center - Solution for functional design.  In this module, the user will touch the project‚Äôs boundary parameters, and the design itself is carried out automatically by the system according to certain rules. <br><br><h5>  About the expansion of the functional </h5><br>  EPLAN is a flexible platform that allows you to extend functionality with scripts and add-ins.  Consider only add-ins, since scripts (scripts) give much less freedom of action. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An add-in is an add-on that complements and extends the basic functionality offered by EPLAN.  An add-in is created using the EPLAN API, which, in turn, uses dotNET and supports 3 programming languages: Visual Basic, C ++ and C #.  The procedure for creating Add-In is the same for all the above languages.  Information on the EPLAN API is in the EPLAN API-Support (in * .chm format), supplied with the documentation. <br><br><h5>  Add-Ina creation process </h5><br>  Consider directly the process of creating Add-Inov. <br><br>  1. To begin with, as the dotNET environment is used, we create the Class Library project in MS Visual Studio. <br>  2. Next, we connect the EPLAN API library to the project. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d5c/eb5/132/d5ceb513242e4d52857dee7cc47bcf48.JPG"></div><br><br>  3. We write the initialization code Add-In <br>  To register and initialize the Add-Ina, our class must inherit the IEplAddIn interface (for more, see EPLAN API-Support).  Create a menu item in the EPLAN Main Menu and add one action (Action) to it. <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Eplan.EplApi.ApplicationFramework; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Eplan.EplApi.Gui; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Test</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AddInModule</span></span>:<span class="hljs-title"><span class="hljs-title">IEplAddIn</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnRegister</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bLoadOnStart</span></span></span><span class="hljs-function">)</span></span> { bLoadOnStart = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnUnregister</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnInit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnInitGui</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Menu OurMenu = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Menu(); OurMenu.AddMainMenu(<span class="hljs-string"><span class="hljs-string">""</span></span>, Menu.MainMenuName.eMainMenuUtilities, <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">"ActionTest"</span></span>, <span class="hljs-string"><span class="hljs-string">" ,    "</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnExit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } }</code> </pre> <br>  The <i><b>OnRegister</b></i> and <i><b>OnUnregister methods</b></i> are called once, when the Add-Ina is first connected and deleted, respectively. <br>  The <i><b>OnExit</b></i> method <i><b>is</b></i> called when you close EPLANa. <br>  The <i><b>OnInit</b></i> method is called when loading EPLANa to initialize the Add-Ina. <br>  The <i><b>OnInitGui</b></i> method <i><b>is</b></i> called when loading EPLANa to initialize the Add-Ina and the user interface. <br><br>  4. Write the action code (Action), which will be in our menu.  An Action must inherit the IEplAction interface (more details in EPLAN API-Support). <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Windows.Forms; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Eplan.EplApi.ApplicationFramework; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Eplan.EplApi.DataModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Eplan.EplApi.HEServices; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Test.Action_test</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Action_Test</span></span>:<span class="hljs-title"><span class="hljs-title">IEplAction</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnRegister</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Ordinal</span></span></span><span class="hljs-function">)</span></span> { Name = <span class="hljs-string"><span class="hljs-string">"ActionTest"</span></span>; Ordinal = <span class="hljs-number"><span class="hljs-number">20</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Execute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ActionCallingContext oActionCallingContext</span></span></span><span class="hljs-function">)</span></span> { SelectionSet Set = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SelectionSet(); Project CurrentProject = Set.GetCurrentProject(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ProjectName = CurrentProject.ProjectName; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ProjectCompanyName = CurrentProject.Properties.PROJ_COMPANYNAME; DateTime ProjectCreationDate = CurrentProject.Properties.PROJ_CREATIONDATE; MessageBox.Show(<span class="hljs-string"><span class="hljs-string">" : "</span></span> + ProjectName + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" : "</span></span> + ProjectCompanyName + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">"  : "</span></span> + ProjectCreationDate.ToShortDateString()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetActionProperties</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ActionProperties actionProperties</span></span></span><span class="hljs-function">)</span></span> { } } }</code> </pre><br>  The <i><b>OnRegister</b></i> method registers our Action with the specified name. <br>  The <i><b>Execute</b></i> method is executed when calling Actiona from the EPLAN platform.  In this case, the <i><b>Execute</b></i> method selects the current project, reads three fields from it, namely, the project name, company name and creation date, and then displays them in the <i><b>MessageBox</b></i> . <br>  The <i><b>GetActionProperties</b></i> method returns the description of our Actiona (for documentation only). <br><br>  5. The name of the compiled DLL must comply with the following rule: <br><br>  <i><b>Eplan.EplAddIn.XXXX.dll</b></i> <br>  where <i><b>XXXX</b></i> is the name of your Add-Ina <br><br><h5>  Add-in connection </h5><br>  To the Add-In platform is connected as follows: <br><br>  1. We carry out "Service programs" <br>  - ‚ÄúAPI-AddIns ...‚Äù <br><br><img src="https://habrastorage.org/files/c58/2bd/b6f/c582bdb6f7f4450296490a5634fcf40f.jpg"><br><br>  2. Click on the button "Download" <br><br><img src="https://habrastorage.org/files/e8b/722/2a5/e8b7222a59f34c07b1793166ee7c2984.jpg"><br><br>  3. In the window that opens, select the Add-In and click "Open" <br><br><img src="https://habrastorage.org/files/e60/6ad/ba5/e606adba5ee24d9d9403efa6e92fac6e.jpg"><br><br>  4. Click on the "OK" button.  The add-in is loaded and ready to go. <br><br><img src="https://habrastorage.org/files/3f6/7c7/a91/3f67c7a916c84b208bd33e888f66217c.jpg"><br>  When the Add-In is loaded, the ‚ÄúTest‚Äù menu item is initialized, revealing which we see our Action (Action), described in Action_Test. <br><br><h5>  Let's look at the result of the Add-Ina: </h5><br><img src="https://habrastorage.org/files/3ee/eab/397/3eeeab397fac408fa1897d503d3af3ed.jpg"><br><br>  Click on the menu item "Test" - "Information on the project" <br><br><img src="https://habrastorage.org/files/b49/c7f/c86/b49c7fc86c3943898ea7ef3367a14f31.jpg"><br><br>  The EPLAN platform provides great basic functionality.  However, sometimes actions are required that are not included in it.  In the simplest cases, you can create and connect scripts (scripts), but if you need deep access to data, you need to use the API, create and use Add-In. <br><br><h5>  useful links </h5><br>  1. <a href="http://www.eplan-russia.ru/ru/start">EPLAN in Russia</a> <br>  2. <a href="http://asutpforum.ru/">Forum ACS TP</a> </div><p>Source: <a href="https://habr.com/ru/post/271671/">https://habr.com/ru/post/271671/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271657/index.html">Separate UI from UX</a></li>
<li><a href="../271661/index.html">New Samsung 950 Pro PCIe SSD: Everything You Need to Know</a></li>
<li><a href="../271663/index.html">Android Autostart application at boot: theory and practice</a></li>
<li><a href="../271665/index.html">Become a member of the 1st Free International School on Software Development Techniques</a></li>
<li><a href="../271669/index.html">Sidechains: how many-sided cryptocurrencies?</a></li>
<li><a href="../271673/index.html">Free hosting control panels. Beautiful perfection</a></li>
<li><a href="../271675/index.html">Return support for Windows XP in the new assembly Vivaldi 1.0.334.3</a></li>
<li><a href="../271677/index.html">Bitwise sorting with a human face</a></li>
<li><a href="../271679/index.html">What's new in the field of data storage</a></li>
<li><a href="../271681/index.html">Young hackers 414s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>