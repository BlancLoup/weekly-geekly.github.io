<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Redux vs React Context API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A new Context API has been added to React 16.3. New in the sense that the old Context API was off-screen, most people either did not know about its ex...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Redux vs React Context API</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/fg/fp/ik/fgfpikxzusi8yqxz5vioyhdjgxm.png"><br><br>  A new Context API has been added to React 16.3.  <i>New</i> in the sense that the <i>old</i> Context API was off-screen, most people either did not know about its existence, or did not use it, because the documentation advised to avoid using it. <br><br>  However, now the Context API is a full-fledged part of React, open for use (not as it used to be, officially). <br><a name="habracut"></a><br>  Immediately after the release of React 16.3, there were articles that proclaimed the death of Redux due to the new Context API.  If you asked Redux about this, I think he would answer - ‚Äúthe reports of my death are <a href="https://blog.isquaredsoftware.com/2018/03/redux-not-dead-yet/">greatly exaggerated</a> .‚Äù 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this post I want to talk about how the new Context API works, how it looks like Redux, when you can use Context instead of Redux, and why Context does not replace Redux in each case. <br><br>  <b>If you just need an overview of the Context API, you can <a href="https://daveceddia.com/context-api-vs-redux/">follow the link</a> .</b> <br><br><h3>  Sample React Application </h3><br>  I'm going to assume that you have an understanding of how to work with a state in React (props &amp; state), but if not, I have a free 5-day course that will help <a href="https://daveceddia.com/pure-react-email-course/">you learn about it</a> . <br><br>  Let's look at an example that will lead us to the concept used in Redux.  We'll start with a simple version of React, and then see how it looks in Redux and, finally, with Context. <br><br><img src="https://habrastorage.org/webt/tq/8q/ze/tq8qzesfpe66d4kveo0p6y10cv0.png"><br><br>  In this application, user information is displayed in two places: in the navigation bar in the upper right corner and in the sidebar next to the main content. <br><br>  (You may notice that there is a great similarity with Twitter. Not by chance! One of the best ways to hone your React skills is to <a href="https://daveceddia.com/learn-react-with-copywork/">copy (create replicas of existing sites / applications)</a> . <br><br>  The structure of the component looks like this: <br><br><img src="https://habrastorage.org/webt/ld/x0/3j/ldx03joils7rg-6cszxkur0dm_u.png"><br><br>  Using pure React (props only) we need to store user information high enough in the tree so that it can be passed on to the components that need it.  In this case, user information must be in the App. <br><br>  Then, in order to pass information about the user to the components that need it, the application must pass it to Nav and Body.  They, in turn, will pass it to UserAvatar (hurray!) And Sidebar.  Finally, Sidebar should pass it on to UserStats. <br><br>  Let's take a look at how this works in the code (I put everything in one file to make it easier to read, but in fact it will probably be divided into separate files, following some kind of <a href="https://daveceddia.com/react-project-structure/">standard structure</a> ). <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-dom"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"./styles.css"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> UserAvatar = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ user, size }</span></span></span><span class="hljs-function">) =&gt;</span></span> ( &lt;img className={`user-avatar ${size || ""}`} alt="user avatar" src={user.avatar} /&gt; ); const UserStats = ({ user }) =&gt; ( &lt;div className="user-stats"&gt; &lt;div&gt; &lt;UserAvatar user={user} /&gt; {user.name} &lt;/div&gt; &lt;div className="stats"&gt; &lt;div&gt;{user.followers} Followers&lt;/div&gt; &lt;div&gt;Following {user.following}&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; ); const Nav = ({ user }) =&gt; ( &lt;div className="nav"&gt; &lt;UserAvatar user={user} size="small" /&gt; &lt;/div&gt; ); const Content = () =&gt; &lt;div className="content"&gt;main content here&lt;/div&gt;; const Sidebar = ({ user }) =&gt; ( &lt;div className="sidebar"&gt; &lt;UserStats user={user} /&gt; &lt;/div&gt; ); const Body = ({ user }) =&gt; ( &lt;div className="body"&gt; &lt;Sidebar user={user} /&gt; &lt;Content user={user} /&gt; &lt;/div&gt; ); class App extends React.Component { state = { user: { avatar: "https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b", name: "Dave", followers: 1234, following: 123 } }; render() { const { user } = this.state; return ( &lt;div className="app"&gt; &lt;Nav user={user} /&gt; &lt;Body user={user} /&gt; &lt;/div&gt; ); } } ReactDOM.render(&lt;App /&gt;, document.querySelector("#root"));</code> </pre> <br><br>  <a href="https://codesandbox.io/s/q8yqx48074">Sample CodeSandbox Code</a> <br><br>  Here the App <a href="https://daveceddia.com/where-initialize-state-react/">initializes the state</a> containing the ‚Äúuser‚Äù object.  In a real application, you will most likely <a href="https://daveceddia.com/ajax-requests-in-react/">retrieve this data from the server</a> and save it in state for rendering. <br><br>  As for props forwarding (‚Äúprop drilling‚Äù), <i>this is not a problem</i> .  It works fine.  ‚ÄúForwarding props‚Äù is the perfect example of React work.  But forwarding to the depth of the state tree can be a little annoying when writing.  And annoy more and more if you have to transfer a lot of props (and not just one). <br><br>  Nevertheless, there is a big minus in this strategy: it creates a connection between the components that should not be connected.  In the example above, Nav should accept the ‚Äúuser‚Äù prop and pass it to UserAvatar, even if Nav does not need it. <br><br>  The closely related components (for example, those that transfer props to their children) are more difficult to reuse, since you must attach them to new parents whenever you use them in a new place. <br><br>  Let's see how we can improve this. <br><br><h3>  Before using Context or Redux ... </h3><br>  If you can find a way to <i>unify the</i> structure of your application and take advantage of the transfer of props to descendants, this can make your code cleaner without having to resort to deep probros props, <i>Context</i> , or <i>Redux</i> . <br><br>  In this example, children props is a great solution for components that should be universal, such as Nav, Sidebar and Body.  Also know that you can pass JSX to <i>any</i> prop, not just children - so if you need more than one ‚Äúslot‚Äù for connecting components, keep this in mind. <br><br>  Here is an example of a React application in which Nav, Body and Sidebar take child elements and display them as is.  Thus, the person who uses the component does not need to worry about the transfer of certain data that is required by the component.  He can simply display what he needs in place, using the data he already has in scope.  This example also shows how to use any prop to transfer children. <br><br>  (Thanks to Dan Abramov for <a href="https://twitter.com/dan_abramov/status/1021850499618955272">this offer</a> !) <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-dom"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"./styles.css"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> UserAvatar = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ user, size }</span></span></span><span class="hljs-function">) =&gt;</span></span> ( &lt;img className={`user-avatar ${size || ""}`} alt="user avatar" src={user.avatar} /&gt; ); const UserStats = ({ user }) =&gt; ( &lt;div className="user-stats"&gt; &lt;div&gt; &lt;UserAvatar user={user} /&gt; {user.name} &lt;/div&gt; &lt;div className="stats"&gt; &lt;div&gt;{user.followers} Followers&lt;/div&gt; &lt;div&gt;Following {user.following}&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; ); //  children   . const Nav = ({ children }) =&gt; ( &lt;div className="nav"&gt; {children} &lt;/div&gt; ); const Content = () =&gt; ( &lt;div className="content"&gt;main content here&lt;/div&gt; ); const Sidebar = ({ children }) =&gt; ( &lt;div className="sidebar"&gt; {children} &lt;/div&gt; ); // Body   sidebar  content,    , //    . const Body = ({ sidebar, content }) =&gt; ( &lt;div className="body"&gt; &lt;Sidebar&gt;{sidebar}&lt;/Sidebar&gt; {content} &lt;/div&gt; ); class App extends React.Component { state = { user: { avatar: "https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b", name: "Dave", followers: 1234, following: 123 } }; render() { const { user } = this.state; return ( &lt;div className="app"&gt; &lt;Nav&gt; &lt;UserAvatar user={user} size="small" /&gt; &lt;/Nav&gt; &lt;Body sidebar={&lt;UserStats user={user} /&gt;} content={&lt;Content /&gt;} /&gt; &lt;/div&gt; ); } } ReactDOM.render(&lt;App /&gt;, document.querySelector("#root"));</code> </pre> <br><br>  <a href="https://codesandbox.io/s/mj19ywz0oy">Sample CodeSandbox Code</a> <br><br>  If your application is too complex (more complicated than this example!), It may be difficult to understand how to adapt the pattern for children.  We'll see how you can replace props probros with Redux. <br><br><h3>  Redux example </h3><br>  I will quickly review an example on Redux so that we can better understand how Context works, so if you do not have a clear understanding of how Redux works, first read <a href="https://daveceddia.com/how-does-redux-work/">my introduction to Redux</a> (or watch the <a href="https://www.youtube.com/watch%3Fv%3DsX3KeP7v7Kg%26feature%3Dyoutu.be">video</a> ). <br><br>  Here is our React application, converted to use Redux.  User information has been moved to the Redux store, which means that we can use the react-redux connect function to directly transfer user prop to the components that need them. <br><br>  This is a big victory in terms of getting rid of connectedness.  Take a look at Nav, Body and Sidebar, and you will see that they no longer accept or transfer user prop.  No longer play hot potatoes with props.  No more useless links. <br><br>  Reducer does little here;  it's pretty simple.  I have something else about how <a href="https://daveceddia.com/what-is-a-reducer/">Redux reducers work</a> and <a href="https://daveceddia.com/immutable-updates-react-redux/">how to write the immutable code</a> that is used in them. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-dom"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    createStore, connect, and Provider: import { createStore } from "redux"; import { connect, Provider } from "react-redux"; //  reducer       . const initialState = {}; function reducer(state = initialState, action) { switch (action.type) { //    action SET_USER  state. case "SET_USER": return { ...state, user: action.user }; default: return state; } } //  store  reducer'   . const store = createStore(reducer); // Dispatch' action     user. store.dispatch({ type: "SET_USER", user: { avatar: "https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b", name: "Dave", followers: 1234, following: 123 } }); //   mapStateToProps,      state (user) //     `user` prop. const mapStateToProps = state =&gt; ({ user: state.user }); //  UserAvatar    connect(),    //`user` ,      . //     2 : // const UserAvatarAtom = ({ user, size }) =&gt; ( ... ) // const UserAvatar = connect(mapStateToProps)(UserAvatarAtom); const UserAvatar = connect(mapStateToProps)(({ user, size }) =&gt; ( &lt;img className={`user-avatar ${size || ""}`} alt="user avatar" src={user.avatar} /&gt; )); //   UserStats    connect(),    // `user` . const UserStats = connect(mapStateToProps)(({ user }) =&gt; ( &lt;div className="user-stats"&gt; &lt;div&gt; &lt;UserAvatar /&gt; {user.name} &lt;/div&gt; &lt;div className="stats"&gt; &lt;div&gt;{user.followers} Followers&lt;/div&gt; &lt;div&gt;Following {user.following}&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; )); //    Nav      `user`. const Nav = () =&gt; ( &lt;div className="nav"&gt; &lt;UserAvatar size="small" /&gt; &lt;/div&gt; ); const Content = () =&gt; ( &lt;div className="content"&gt;main content here&lt;/div&gt; ); //   Sidebar. const Sidebar = () =&gt; ( &lt;div className="sidebar"&gt; &lt;UserStats /&gt; &lt;/div&gt; ); //   Body. const Body = () =&gt; ( &lt;div className="body"&gt; &lt;Sidebar /&gt; &lt;Content /&gt; &lt;/div&gt; ); //  App    ,     . const App = () =&gt; ( &lt;div className="app"&gt; &lt;Nav /&gt; &lt;Body /&gt; &lt;/div&gt; ); //     Provider, //   connect()    store. ReactDOM.render( &lt;Provider store={store}&gt; &lt;App /&gt; &lt;/Provider&gt;, document.querySelector("#root") );</span></span></code> </pre><br><br>  <a href="https://codesandbox.io/s/943yr0qp3o">Sample CodeSandbox Code</a> <br><br>  Now you probably wonder how Redux achieves this magic.  Amazing.  How does React not support the transfer of props to several levels, and can Redux do this? <br><br>  The answer is that Redux uses the <i>context</i> function React (context feature).  Not a modern Context API (not yet), but an old one.  One that in the React documentation is told not to use if you are not writing your library or do not know what you are doing. <br><br>  The context is similar to the computer bus following each component: to get the power (data) passing through it, you only need to connect.  And react-redux connect does exactly that. <br><br>  However, this Redux feature is only the tip of the iceberg.  Transferring data to just the right place is the most <i>obvious</i> of the features of Redux.  Here are some other benefits you get out of the box: <br><br>  <b>connect is a pure function</b> <br><br>  connect automatically makes the connected components "clean", that is, they will be re-rendered only when their props change - that is, when their Redux state slice changes.  This prevents unnecessary re-rendering and speeds up the application. <br><br>  <b>Easy debugging with Redux</b> <br><br>  Writing out actions and reducers is balanced by the amazing debugging ease Redux provides you. <br><br>  With <a href="https://github.com/zalmoxisus/redux-devtools-extension">the Redux DevTools extension,</a> you get an automatic log of all actions performed by your application.  At any time, you can open it and see what actions were launched, what payload they had, and state before and after the action. <br><br><img src="https://habrastorage.org/webt/go/km/oi/gokmoivlzezzfb-wjkhujjyxep8.gif"><br><br>  Another great feature that Redux DevTools provides is debugging with the help of <i>‚Äútime travel‚Äù</i> , so you can click on any previous action, and go to this point in time, up to the current one.  The reason this works is that each action updates the store in the <i>same way</i> , so you can take a list of the recorded status updates and play them without any side effects, and finish in the right place. <br><br>  There are also tools like <a href="https://logrocket.com/">LogRocket</a> , which basically give you permanent Redux DevTools in <i>production</i> for each of your users.  Got a bug report?  No problem.  View this user session in LogRocket, and you can see a repetition of what he did and which actions were launched.  It all works using the Redux action stream. <br><br>  <b>Extending Redux with Middleware</b> <br><br>  Redux supports the concept of middleware (a fancy word for "a function that runs every time an action is sent").  Writing your own middleware is not as difficult as it may seem, and allows you to use some powerful tools. <br><br>  For example‚Ä¶ <br><br><ul><li>  Do you want to send an API request every time the action name starts with FETCH_?  You can do this using middleware. </li><li>  Want a centralized place for logging events in your analytical software?  Middleware is a good place for this. </li><li>  Want to prevent action from starting at a specific point in time?  You can do this using middleware, invisible to the rest of your application. </li><li>  Want to intercept an action that has a JWT token, and automatically save it in localStorage?  Yes, middleware. </li></ul><br>  Here is a good <a href="https://medium.com/%40jacobp100/you-arent-using-redux-middleware-enough-94ffe991e6">article</a> with examples of how to write redux middleware. <br><br><h4>  How to use React Context API </h4><br>  But maybe you do not need all these oddities of Redux.  Perhaps you don‚Äôt need simple debugging, tuning, or automatic performance improvements ‚Äî all you want to do is transfer data easily.  Maybe your application is small, or you just need to quickly do something and deal with the subtleties later. <br><br>  The new Context API will probably suit you.  Let's see how it works. <br><br>  I posted a quick <a href="https://egghead.io/lessons/react-pass-props-through-multiple-levels-with-react-s-context-api">lesson</a> on Context API on Egghead, if you like looking more than reading (3:43). <br><br>  Here are 3 important components of the Context API: <br><br><ul><li>  React.createContext function that creates context </li><li>  Provider (returns createContext), which sets the "electrical bus", <br>  passing through the component tree </li><li>  Consumer (also returns createContext), which is absorbed into <br>  "Electrical bus" to extract data </li></ul><br>  Provider is very similar to Provider in React-Redux.  It takes on a value that can be anything you want (it can even be a store Redux ... but that would be stupid).  Most likely, this is an object containing your data and any actions that you want to perform with the data. <br><br>  Consumer works a bit like the connect function in React-Redux, connecting to the data and making it available to the component that uses it. <br><br>  Here are the highlights: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     context //    2 : { Provider, Consumer } // ,   ,  UpperCase,  camelCase //  ,          , //        . const UserContext = React.createContext(); // ,     context, //   Consumer. // Consumer   "render props". const UserAvatar = ({ size }) =&gt; ( &lt;UserContext.Consumer&gt; {user =&gt; ( &lt;img className={`user-avatar ${size || ""}`} alt="user avatar" src={user.avatar} /&gt; )} &lt;/UserContext.Consumer&gt; ); // ,      "user prop", //   Consumer    context. const UserStats = () =&gt; ( &lt;UserContext.Consumer&gt; {user =&gt; ( &lt;div className="user-stats"&gt; &lt;div&gt; &lt;UserAvatar user={user} /&gt; {user.name} &lt;/div&gt; &lt;div className="stats"&gt; &lt;div&gt;{user.followers} Followers&lt;/div&gt; &lt;div&gt;Following {user.following}&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; )} &lt;/UserContext.Consumer&gt; ); // ...    ... // ... (      `user`). //  App   context ,  Provider. class App extends React.Component { state = { user: { avatar: "https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b", name: "Dave", followers: 1234, following: 123 } }; render() { return ( &lt;div className="app"&gt; &lt;UserContext.Provider value={this.state.user}&gt; &lt;Nav /&gt; &lt;Body /&gt; &lt;/UserContext.Provider&gt; &lt;/div&gt; ); } }</span></span></code> </pre><br><br>  <a href="https://codesandbox.io/s/q9w2qrw6q4">Sample CodeSandbox Code</a> <br><br>  Let's take a look at how this works. <br><br>  Remember, we have 3 parts: the context itself (created using React.createContext) and two components that interact with it (Provider and Consumer). <br><br>  <b>Provider and Consumer work together</b> <br><br>  Provider and Consumer are interconnected and inseparable.  They only know how to interact with each other.  If you create two separate contexts, say ‚ÄúContext1‚Äù and ‚ÄúContext2‚Äù, then Provider and Consumer Context1 will not be able to communicate with Provider and Consumer Context2. <br><br>  <b>Context does not contain state</b> <br><br>  Note that context <i>does not have its own state</i> .  This is just a feed for your data.  You must pass the value to the Provider, and this value is passed to any Consumer that knows how to find it (the Provider is tied to the same context as the Consumer). <br><br>  When you create a context, you can pass a ‚Äúdefault value‚Äù as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Ctx = React.createContext(yourDefaultValue);</code> </pre><br><br>  The default value is what the Consumer will receive when placed in a tree without Provider above it.  If you do not pass it, the value will be undefined.  Note that this <i>is the default value</i> , not the <i>initial</i> value.  ontext does not save anything;  it simply distributes the data you transmit to it. <br><br>  <b>Consumer uses Render Props pattern</b> <br><br>  The connect Redux function is a higher order component (abbreviated as HoC).  It wraps another component and passes props into it. <br><br>  Consumer, by contrast, expects the child component to be a function.  It then calls this function during rendering, passing the value it received from Provider somewhere above it (or the default value from the context, or undefined if you don‚Äôt pass the default value). <br><br>  <b>Provider takes one value</b> <br><br>  Just one value, like prop.  But remember that the value can be anything.  In practice, if you want to pass several values ‚Äã‚Äãdown, you must create an object with all the values ‚Äã‚Äãand pass this object down. <br><br><h3>  Context API flexible </h3><br>  Since creating a context gives us two components to work with (Provider and Consumer), we can use them as we want.  Here are a couple of ideas. <br><br>  <b>Wrap a Consumer in a HOC</b> <br><br>  Don't like the idea of ‚Äã‚Äãadding a UserContext.Consumer around every place that needs it?  This is your code!  You have the right to decide what will be the best choice for you. <br><br>  If you prefer to get the value as a prop, you can write a small wrapper around the Consumer as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">withUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Component</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConnectedComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;UserContext.Consumer&gt; {user =&gt; &lt;Component {...props} user={user}/&gt;} &lt;/UserContext.Consumer&gt; ); } }</code> </pre><br>  After that, you can rewrite, for example, UserAvatar using the withUser function: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> UserAvatar = withUser(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ size, user }</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">img</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">`</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">user-avatar</span></span></span></span><span class="xml"><span class="hljs-tag"> ${</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span></span><span class="xml"><span class="hljs-tag"> || ""}`} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"user avatar"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{user.avatar}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> ));</span></span></code> </pre><br>  And voila, context can work the same way as connect Redux.  Minus automatic cleanliness. <br><br>  Here is an example of <a href="https://codesandbox.io/s/jpy76nm1v">CodeSandbox</a> with this HOC. <br><br>  <b>Keep State in Provider</b> <br><br>  Remember that Provider is just a channel.  It does not save any data.  But this does not prevent you from making your <i>own</i> data wrapper. <br><br>  In the example above, the data is stored in the App, so the only thing you need to understand is the components Provider + Consumer.  But maybe you want to create your own store.  You can create a component to store the state and pass them through the context: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserStore</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ state = { <span class="hljs-attr"><span class="hljs-attr">user</span></span>: { <span class="hljs-attr"><span class="hljs-attr">avatar</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.gravatar.com/avatar/5c3dd2d257ff0e14dbd2583485dbd44b"</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"Dave"</span></span>, <span class="hljs-attr"><span class="hljs-attr">followers</span></span>: <span class="hljs-number"><span class="hljs-number">1234</span></span>, <span class="hljs-attr"><span class="hljs-attr">following</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span> } }; render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;UserContext.Provider value={</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.state.user}&gt; {</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.props.children} &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/UserContext.Provider&gt; ); } } /</span></span></span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/ ...    ... const App = () =&gt; ( &lt;div className="app"&gt; &lt;Nav /</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; &lt;Body </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/&gt; &lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">div&gt; </span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ReactDOM</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;UserStore&gt; &lt;App </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/&gt; &lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">UserStore&gt;, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">document</span></span></span></span><span class="hljs-function"><span class="hljs-params">.querySelector(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"#root"</span></span></span></span></span><span class="hljs-function">) );</span></span></code> </pre><br>  Now the user data is contained in its <i>own</i> component, the only task of which is this data.  Cool.  The app can again become clean (stateless).  I think it looks a bit cleaner. <br><br>  Here is an example of <a href="https://codesandbox.io/s/jpy76nm1v">CodeSandbox</a> with this UserStore. <br><br>  <b>Throw actions down through context</b> <br><br>  Remember that the object passed through the Provider may contain everything you want.  This means that it may contain functions.  You can even call them actions. <br><br>  Here is a new example: a simple room with a switch to switch the background color - oh, I mean light. <br><br><img src="https://habrastorage.org/webt/di/s4/r1/dis4r10ujowkvv5pn9mgx9b6jbs.gif"><br><br>  State is stored in the store, which also has the function of switching light.  Both state and function are passed through the context. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-dom"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"./styles.css"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  context. const RoomContext = React.createContext(); // ,     //   . class RoomStore extends React.Component { state = { isLit: false }; toggleLight = () =&gt; { this.setState(state =&gt; ({ isLit: !state.isLit })); }; render() { //  state  onToggleLight action return ( &lt;RoomContext.Provider value={{ isLit: this.state.isLit, onToggleLight: this.toggleLight }} &gt; {this.props.children} &lt;/RoomContext.Provider&gt; ); } } //    ,    , //       RoomContext. const Room = () =&gt; ( &lt;RoomContext.Consumer&gt; {({ isLit, onToggleLight }) =&gt; ( &lt;div className={`room ${isLit ? "lit" : "dark"}`}&gt; The room is {isLit ? "lit" : "dark"}. &lt;br /&gt; &lt;button onClick={onToggleLight}&gt;Flip&lt;/button&gt; &lt;/div&gt; )} &lt;/RoomContext.Consumer&gt; ); const App = () =&gt; ( &lt;div className="app"&gt; &lt;Room /&gt; &lt;/div&gt; ); //     RoomStore, //           . ReactDOM.render( &lt;RoomStore&gt; &lt;App /&gt; &lt;/RoomStore&gt;, document.querySelector("#root") );</span></span></code> </pre><br>  Here is a full working example in <a href="https://codesandbox.io/s/jvky9o0nvw">CodeSandbox</a> . <br><br>  <b>So after all, what to use, Context or Redux?</b> <br><br>  Now that you've seen both ways - which one should you use?  I know that you just want to hear the answer to this question, but I have to answer - "depends on you." <br><br>  It depends on how big your application is now or how fast it will grow.  How many people will work on it - just you or a big team?  How experienced are you or your team in working with the functional concepts on which Redux relies (such as immunity and pure functions). <br><br>  A disastrous mistake that permeates the entire JavaScript ecosystem is the idea of <i>competition</i> .  There is an idea that each choice is a zero-sum game: if you use <i>library</i> A, you should not use its competitor <i>library</i> B. What happens when a new library comes out, which is something better than the previous one, it should supplant the existing one.  That everything should be either / or that you should either choose the newest and best, or be upstaged along with the developers from the past. <br><br>  The best approach is to look at this wonderful choice with an example of a set of tools.  This is like choosing between using a screwdriver or a powerful screwdriver.  For 80% of cases, the screwdriver will do the job easier and faster than a screwdriver.  But for the other 20% a screwdriver would be the best choice (little space, or a thin object).  When I bought a screwdriver, I did not immediately throw out the screwdriver, he did not replace it, but simply gave me another option.  Another way to solve the problem. <br><br>  Context does not "replace" Redux, nothing more than React "replaced" Angular or jQuery.  Hell, I still use jQuery when I need to do something quickly.  I still occasionally use server-side EJS templates instead of deploying React.  Sometimes React is more than you need to complete a task.  The same goes for Redux. <br><br>  Today, if Redux is more than you need, you can use context. <br><br>  Learning React can be hard - so many libraries and tools! <br><br>  My advice?  Ignore them all :) <br><br>  For step-by-step learning, read my book <a href="https://daveceddia.com/pure-react/%3Futm_campaign%3Dafter-post">Pure React</a> . </div><p>Source: <a href="https://habr.com/ru/post/419449/">https://habr.com/ru/post/419449/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../419437/index.html">AR - Augmented Reality (article plus video)</a></li>
<li><a href="../419439/index.html">How e-commerce survive major promotions. Getting ready for peak web loads [Part 2]</a></li>
<li><a href="../419441/index.html">SpaceX for the first time re-uses the Falcon 9 Block 5 rocket today</a></li>
<li><a href="../419443/index.html">NASA will fly again to the moon, making all the elements of aircraft</a></li>
<li><a href="../419445/index.html">Unit Tests for Arduino Projects</a></li>
<li><a href="../419451/index.html">Step-by-step creating a symfony 4 bundle</a></li>
<li><a href="../419453/index.html">Numerical methods for solving systems of nonlinear equations</a></li>
<li><a href="../419457/index.html">RabbitMQ - SQL Server</a></li>
<li><a href="../419461/index.html">Ventilation of the bathroom with the mind</a></li>
<li><a href="../419467/index.html">From the light bulb to the vacuum cleaner and the drone - as we taught Alice to control hundreds of devices</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>