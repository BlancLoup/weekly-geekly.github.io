<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis of all tasks and results of Yandex. Algorithm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Just a couple of hours ago, the open programming championship Yandex . Algorithm 2013 ended in St. Petersburg. The competitions consisted of several o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analysis of all tasks and results of Yandex. Algorithm</h1><div class="post__text post__text-html js-mediator-article">  Just a couple of hours ago, the open programming championship <a href="http://algorithm.contest.yandex.ru/">Yandex</a> . <a href="http://algorithm.contest.yandex.ru/">Algorithm 2013</a> ended in St. Petersburg.  The competitions consisted of several online rounds of 100 minutes each; over 3,000 programmers from 84 countries fought for the victory.  According to the results of the three qualifying rounds, the top 25 reached the final. <br><br> <a href="http://habrahabr.ru/company/yandex/blog/191030/"><img src="https://habrastorage.org/getpro/habr/post_images/515/9ae/540/5159ae5402577032f85d8ea6d3b1a02b.jpg" alt="image"></a> <br><br>  The finalists had to solve six algorithmic problems in 100 minutes.  First place was taken by the recent winner of <a href="http://habrahabr.ru/company/yandex/blog/186316/">ACM ICPC 2013</a> in the team of NRU ITMO Gennady Korotkevich (tourist), who scored the least of the penalty time.  Second place went to a graduate of NRU ITMO Eugene Kapun (eatmore).  Third place was taken by the representative of Taiwan, Shi Bisyun. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The preparation of tasks for the championship was attended by experts from several countries: Russia, Belarus, Poland and Japan.  The main compilers of the tasks were the developers of the Minsk office of Yandex (they, like all employees of the company, were not allowed to participate in the competitions).  We asked all authors to parse the tasks that they prepared for the participants of Yandex.Algorithm.  By the way, all the tasks could not be solved by anyone, the best result - three solved problems - showed only three participants. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/349/6a9/214/3496a92142d35abad7dd24b453b3e8d3.jpg" alt="image"><br><br><h4>  Problem A. Reduce! </h4><br>  <i>Author of the task and analysis: Jakub Pachocki, Warsaw U</i> <br><br>  <u>Input file name</u> : stdin <br>  <u>Output file name</u> : stdout <br>  <u>Time limit</u> : 8 seconds <br>  <u>Memory limit</u> : 512 megabytes <br><br>  Usually at team programming competitions, in addition to the full name of the university, the abbreviated is given.  At one very prestigious competition, teams plan to spread out so that, of the two teams, the team with the lexicographically smallest shortened name sits closer to the sideboard.  With this in mind, the coaches of each university strive to shorten the name of the university so that the result is lexicographically minimal. <br><br>  Denote as a <i>word a</i> non-empty substring of the name of the university, which consists of letters, and neither the symbol immediately before this substring, nor the symbol immediately after it are letters.  In the abbreviation of the name of the university, it is allowed to replace any suffix of a word with a dot (‚Äú.‚Äù). <br><br>  Wherein: <br><ul><li>  It is not allowed to replace the whole word with a dot. </li><li>  If the word remains unchanged (that is, an empty suffix is ‚Äã‚Äãselected), the dot is not put. </li></ul><br>  It is allowed not to shorten the name of the university at all, leaving it unchanged. <br>  When comparing names, all characters that are not Latin letters are deleted, all upper-case Latin letters are replaced with corresponding lower-case letters and the resulting strings are compared with each other. <br><br>  <u>The input file format.</u>  The first line of the input file contains the name of the university.  The name may contain uppercase and lowercase Latin letters, spaces, commas (",") and hyphens ("-"). <br>  It is guaranteed that the line does not begin or end with a space and does not contain two consecutive spaces.  The number of characters (including spaces) in the input file does not exceed 10 <sup>6</sup> . <br><br>  <u>The format of the output file.</u>  Print the lexicographically smallest abbreviated university name.  It is forbidden to change the capitalization of letters and the position of non-letter characters in comparison with the original name.  If the lexicographically smallest <br>  few cuts, output any. <br><br><table><tbody><tr><td>  <b>stdin</b> </td><td>  <b>stdout</b> </td></tr><tr><td>  University of warsaw </td><td>  Uni.  of W </td></tr><tr><td>  Saint Petersburg National Research University of Mechanics and Optics </td><td>  Sain.  Pe  Na.  Research Uni.  of I., M. and O. </td></tr><tr><td>  University of Illinois at Urbana-Champaign </td><td>  Uni.  of I. at U.-C </td></tr><tr><td>  , Carnegie -, - MelloN -, -, - University- </td><td>  , Ca .--, - MelloN -, -, - U.- </td></tr><tr><td>  Udmurtian university </td><td>  Udm.  U. </td></tr></tbody></table><br><br>  <u>Note.</u>  ‚ÄúUni.  Of W. ‚Äùis the lexicographically smallest abbreviation for‚Äú University of Warsaw ‚Äù, since the string‚Äú uniofw ‚Äùis lexicographically smaller than the lines corresponding to other options, for example,‚Äú uow ‚Äù,‚Äú uniofwa ‚Äù,‚Äú universityofwarsaw ‚Äù. <br><br>  <b>Solutions to Problem A.</b> <br><br>  After parsing the input, the task is as follows: <br><br><blockquote>  For <i>n</i> lines <i>s</i> <sub>1</sub> , ... <i>s</i> <sub>n of</sub> total length <i>N,</i> find their non-empty prefixes <i>p</i> <sub>1</sub> , ..., <i>p</i> <sub>n</sub> such that <br><br>  <i>p</i> <sub>1</sub> <i>p</i> <sub>2</sub> ... <i>p</i> <sub>n</sub> <br><br>  is lexicographically smallest. </blockquote><br><br>  Suppose that we have already found <i>p</i> <sub>k + 1</sub> , ..., <i>p</i> <sub>n</sub> such that the string <i>p</i> <sub>k + 1</sub> <i>p</i> <sub>k + 2</sub> ... <i>p</i> <sub>n</sub> is lexicographically smallest.  Note that this choice of <i>p</i> <sub>k + 1</sub> , ..., <i>p</i> <sub>n</sub> is optimal for any choice of <i>p</i> <sub>1</sub> , ..., <i>p</i> <sub>k</sub> .  This follows from the fact that if for two strings <i>t</i> and <i>t '</i> <i>t</i> &lt; <i>t'</i> is true, then <i>wt</i> &lt; <i>wt '</i> for any row <i>w</i> . <br><br>  How to effectively find the optimal prefix <i>p</i> <sub>k</sub> for given <i>p</i> <sub>k + 1</sub> , ...., <i>p</i> <sub>n</sub> ? <br>  Let <i>t</i> : = <i>p</i> <sub>k + 1</sub> <i>p</i> <sub>k + 2</sub> ... <i>p</i> <sub>n</sub> .  We need to find a non-empty prefix <i>p of the</i> string <i>s</i> <sub>k</sub> such that the string <i>pt</i> is lexicographically minimal. <br><br>  There is an algorithm that allows you to effectively compare the <i>pt</i> and <i>p't</i> lines using a hash: <br><ul><li>  using binary search we find the largest common prefix of the <i>pt</i> and <i>p't strings</i> ; </li><li>  compare the characters immediately following this prefix. </li></ul><br>  When using a randomized hash, the algorithm works in (log <i>N</i> ) with a very high probability. <br>  In order to find <i>p</i> <sub>k</sub> , you need to hold |  <i>s</i> <sub>k</sub> |  - 1 such comparisons, which gives time <nobr>(|</nobr> <i>s</i> <sub>k</sub> | log <i>N</i> ) to calculate <i>p</i> <sub>k</sub> .  Summing up all <i>s</i> <sub>k</sub> , we get the running time of the algorithm ( <i>N</i> log <i>N</i> ). <br><br><h4>  Problem B. Anyuta and ‚Äúbitwise AND‚Äù </h4><br>  <i>The authors of the task and analysis are Alexey Tolstikov and Roman Udovichenko.</i> <br>  <u>Input file name</u> : stdin <br>  <u>Output file name</u> : stdout <br>  <u>Time limit</u> : 2 seconds <br>  <u>Memory limit</u> : 512 megabytes <br><br>  Little Annie decided to study bit operations on numbers.  Today she studied the operation ‚Äúbitwise AND‚Äù.  Bitwise AND is a binary operation, the action of which is equivalent to applying a logical AND to each pair of bits that are at the same positions in binary representations of operands (leading zeroes are valid in binary representation).  In other words, if both corresponding bits of the operands are 1, the resulting binary bit is 1;  if at least one bit of the pair is 0, the resulting binary bit is 0. <br><br>  By a surprising coincidence, just today Anyuta‚Äôs parents brought two sets of numbers from work.  Dad brought from work a set of <i>A</i> , consisting of <i>P</i> numbers, and a mother - a set of <i>B</i> , consisting of <i>M</i> numbers.  All numbers in the sets were integer, non-negative, and not exceeding 65535. In addition, the numbers in the sets were numbered starting from 1. <br><br>  Joyful Anyuta immediately began to apply the operation under study to the numbers from these sets.  In order not to offend any of the parents, she applied bitwise AND to those pairs of numbers, one of which was from my father's set, and the other from my mother's. <br><br>  While Annie was fascinated with calculations, it became interesting for parents how many ways their daughter could get a certain number <i>X</i> ?  The number of different methods can be calculated as the number of different pairs <i>(i, j)</i> such that <nobr>1 ‚â§</nobr> <i>i</i> ‚â§ <i>P</i> , 1 ‚â§ <i>j</i> ‚â§ <i>M</i> , A <sub>i</sub> <i>AND</i> <i>B</i> <sub>j</sub> = <i>X.</i>  Since Anyuta's parents are no less inquisitive than their daughter, they want to find the desired number of ways not only for one number <i>X</i> , but immediately for <i>K</i> numbers <i>X <sub>i</sub></i> .  Help your parents! <br><br>  <u>The input file format.</u>  The first line contains three integers <i>P</i> , <i>M</i> and <i>K</i> (1 ‚â§ <i>P</i> , <i>M</i> , <i>K</i> ‚â§ 10 <sup>5</sup> ), separated by spaces - the number of numbers in the set of dad, the number of numbers in the set of mom, and the number of numbers of interest to parents, respectively.  The second line contains <i>P</i> numbers <i>A <sub>i</sub></i> separated by spaces ‚Äî the set of numbers that dad brought.  The third line contains <i>M</i> numbers <i>B <sub>i</sub></i> , separated by spaces ‚Äî the set of numbers that mom brought.  The fourth line contains <i>K</i> numbers <i>X</i> <sub>i</sub> separated by spaces - a set of numbers for which you need to count the required number of pairs.  All numbers in sets <i>A</i> , <i>B,</i> and <i>X are</i> integers, non-negative, and do not exceed 65535. <br><br>  <u>The format of the output file.</u>  Output <i>K</i> lines containing one number each.  The number in the <i>i-</i> th line should be equal to the number of ways to get the number <i>X</i> <sub>i</sub> by applying the bitwise AND operation to the numbers in sets <i>A</i> and <i>B</i> according to the rules described in the condition. <br><br>  <b>Examples</b> <br><table><tbody><tr><td>  <b>stdin</b> </td><td>  <b>stdout</b> </td></tr><tr><td>  4 4 4 <br>  1 2 3 4 <br>  1 2 3 4 <br>  1 2 3 4 </td><td>  3 <br>  3 <br>  one <br>  one </td></tr><tr><td>  1 2 3 <br>  0 <br>  12 <br>  0 1 2 </td><td>  2 <br>  0 <br>  0 </td></tr></tbody></table><br><br>  <b>Solution of Problem B</b> <br><br>  Given two arrays A and B, consisting of non-negative integers up to 2 <sup>16</sup> .  An array of Q queries is also given, also containing numbers up to 2 <sup>16</sup> .  For each query <i>k</i> , it is necessary to say how many pairs ( <i>i</i> , <i>j</i> ) there are such that <i>Ai</i> AND <i>Bj</i> = <i>Qk</i> . <br><br>  The number of elements in each array is up to 100k (although it is immediately clear that there are no more than 2 <sup>16</sup> different ones, but all the same, the same must be processed, so let there be arrays up to 100k). <br><br>  We will consider the answer immediately for all requests. <br><br>  We introduce the following notation <i>f</i> ( <i>x</i> , <i>S</i> ) - the set of elements from the sequence <i>S</i> , which contain all the bits from <i>x</i> and possibly some more (that is, numbers such that <i>x</i> &amp; <i>y</i> = <i>x</i> ). <br>  Note that if <nobr><i>a</i> ‚àà <i>f</i> ( <i>x</i> , <i>A</i> )</nobr> and <nobr><i>b</i> ‚àà <i>f</i> ( <i>x</i> , <i>B</i> )</nobr> , then <nobr>( <i>a</i> &amp; <i>b</i> ) &amp; <i>x</i> = <i>x</i></nobr> , i.e.  <i>a</i> &amp; <i>b</i> contains all the same bits as <i>x</i> , again, perhaps some more. <br><br>  Let <i>g</i> ( <i>x</i> ) be the number of pairs of indices ( <i>i</i> , <i>j</i> ) such that <i>A</i> <sub>i</sub> &amp; <i>B</i> <sub>j</sub> = <i>x</i> , it is easy to see that <img src="https://habrastorage.org/getpro/habr/post_images/e86/730/5f7/e867305f72d4ca4592bac06944c7a13d.png">  .  Thus, from all possible pairs of indices we subtract those for which <i>A</i> <sub>i</sub> &amp; <i>B</i> <sub>j</sub> &gt; <i>x</i> . <br><br>  Let <i>B</i> be the maximum number of bits in the numbers in the input.  Then |  <i>f</i> ( <i>x</i> , <i>S</i> ) |  can be calculated in time O (| <i>S</i> | + 3 <sup>B</sup> ) for all <i>x</i> (using the method of enumerating all subsets of bits <i>x</i> ).  The values ‚Äã‚Äãof <i>g</i> ( <i>x</i> ) can be calculated in O (3 <sup>B</sup> ) time; however, in this case one should use enumeration of not all subsets of bits <i>x</i> , but all supersets. <br><br>  The total time of the described solution is O ( <i>P</i> + <i>M</i> + <i>K</i> + 3 <sup>B</sup> ) ( <i>B</i> = 16). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cea/43b/91a/cea43b91af219e6d0535204218ebac85.jpg" alt="image"><br><br><h4>  Problem C. Bees </h4><br>  <i>Problem by jakubr (Jakub Radoszewski)</i> <br>  <u>Input file name</u> : stdin <br>  <u>Output file name</u> : stdout <br>  <u>Time limit</u> : 5 seconds <br>  <u>Memory limit</u> : 512 megabytes <br><br>  The hobby of the beekeeper Baytazar is the study of figures, which are formed in honeycombs with honey brought by bees.  Each such figure is a connected set of hexagonal cells with side 1, inside of which there are no ‚Äúholes‚Äù. <br><br>  More formally, we call a <i>figure without ‚Äúholes‚Äù a</i> subset of unit hexagons of a regular hexagonal grid such that any two unit hexagons belonging to it are connected by a path, all hexagons of which also belong to this set and any two neighboring hexagons (in the sense of this path) have a common side , and any two unit hexagons that do not belong to this subset are connected by a path, none of the cells of which belong to this set and any two adjacent (in the sense of this path) hexagonal  Nicknames have a common side. <br><br>  Baytazar wants to make a complete list of possible values ‚Äã‚Äãof the perimeter and the number of cells in such patterns.  He asked you to write a program that, using two given numbers <i>n</i> and <i>p,</i> ascertains whether there is a figure without ‚Äúholes‚Äù consisting of <i>n</i> cells, the perimeter of which is equal to <i>p</i> . <br><br>  For example, in the picture below, <i>n</i> = 4, and <i>p</i> = 18. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/702/20a/336/70220a3360e8b3d4e16582dd4c170000.png" alt="image"><br><br>  <u>The input file format.</u>  The first line of input contains the number of test cases <i>T</i> (1 ‚â§ <i>T</i> ‚â§ 1000).  Each of the following <i>T</i> lines defines a test case and contains two integers <i>n</i> and <i>p</i> (1 ‚â§ <i>n</i> , <i>p</i> ‚â§ 1000) - the required area and the perimeter of the figure. <br><br>  <u>The format of the output file</u> .  For each test case, in the order in which they appear in the input file, print the answer on a separate line.  If there are no figures with the given parameters, output "NO".  Otherwise, output a string of <i>p</i> characters composed of the letters ‚ÄúL‚Äù and ‚ÄúR‚Äù, specifying a detour along the perimeter of the figure (clockwise or against it), while ‚ÄúL‚Äù denotes a left turn, and ‚ÄúR‚Äù denotes a right turn. <br><br>  If there are several correct answers, output any of them. <br><br><table><tbody><tr><td>  <b>stdin</b> </td><td>  <b>stdout</b> </td></tr><tr><td>  3 <br>  4 18 <br>  3 18 <br>  3 12 </td><td>  RLRRRRLRLRLRRRRLRL <br>  NO <br>  LRRRLRRRLRRR </td></tr></tbody></table><br><br>  <b>Solution of Problem C</b> <br><br>  The challenge is to build a polygon on a hexagonal grid, <br>  consisting of <i>n</i> single cells and <i>p</i> sides, or make sure that a polygon with these parameters does not exist. <br><br>  We fix the number of cells <i>n</i> and study the possible values ‚Äã‚Äãof <i>p</i> such that a polygon with <i>p</i> sides exists.  Obviously, <i>p</i> must be even. <br><br>  It is also easy to see that <i>p</i> cannot be greater than 4 <i>n</i> + 2 (the perimeter of a polygon consisting of <i>n</i> cells running in a row and bordering on a side; let's call such a polygon a <i>chain</i> ). <br><br>  On the other hand, from general considerations it is clear that the polygon of the minimum perimeter is a kind of large hexagon.  Formally, its perimeter is given by the formula <img src="https://habrastorage.org/getpro/habr/post_images/aae/6f3/61c/aae6f361c3d49f1d2f58824f9be70371.png">  . <br><br>  It turns out that these restrictions are not only necessary, but also sufficient. <br><br>  The construction algorithm is as follows: we start with a chain consisting of <i>n</i> cells and having a maximum perimeter.  Further, while the perimeter of our polygon is larger than <i>p</i> , we remove one cell from the ‚Äútail‚Äù of the polygon and add this cell to the ‚Äúhead‚Äù, completing the large hexagon layer by layer (see arrow 1 in the illustration). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b3/4ff/18a/8b34ff18abe7b521902bfd3eaeb268ab.png"><br><br>  This move reduces the perimeter by 2, 4, or 6, so ultimately we will have to increase the perimeter by 2 or 4 by moving some cells (for example, moving the cell from the ‚Äútail‚Äù according to arrow 2 in the figure). <br><br>  In some implementations, it will be necessary to separately analyze cases for small values ‚Äã‚Äãof <i>n</i> , as well as cases when the perimeter is close to the minimum value for a given <i>n</i> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fe8/e58/da7/fe8e58da79f7c72f36ef20e638dd85fd.jpg" alt="image"><br><br><h4>  Problem D. Anyuta and cubes </h4><br>  <i>The author of the task and analysis is Roman Udovichenko.</i> <br><br>  <u>Input file name</u> : stdin <br>  <u>Output file name</u> : stdout <br>  <u>Time limit</u> : 2 seconds <br>  <u>Memory limit</u> : 512 megabytes <br><br>  Little Anya loves to play with cubes.  She has <i>N</i> positions, arranged in a row and numbered from 1 to <i>N</i> , in which she likes to build towers of cubes. <br>  The tower is a few cubes lying one on another.  Tower height is the number of cubes in it.  The tower number corresponds to the position in which this tower is built. <br><br>  Initially, all positions are empty.  Every minute the following happens. <br><ol><li>  Annie looks consistently at positions with numbers from <i>N</i> - 1 to 1. </li><li>  If at some position <i>i</i> there are cubes, and the height of the tower is greater than or equal to the height of the tower at position <i>i</i> + 1, Anyuta transfers one cube from the <i>i</i> -th position to ( <i>i</i> + 1) -th. </li><li>  After Annie has looked through all the positions, she adds one die to the tower in position number 1. </li></ol><br><br>  <u>An example</u> .  Let the number of positions <i>N</i> = 6, and the heights of the towers be <nobr>5 0 1 3 4 1</nobr> (numbering the positions from 1 to <i>N</i> from left to right).  Then the next minute will happen next. <br><ol><li>  Anuta will look at position 5: the height of the tower in her is 4, while the height of the tower in the next position is 1. Anyuta will move one cube from position 5 to position 6. The heights of the towers will be <nobr>5 0 1 3 3 2</nobr> . </li><li>  Anuta will look at position 4: the height of the tower in it is 3, and the height of the tower in the next position is 3. Annuta will transfer one cube from position 4 to position 5. The heights of the towers will be <nobr>5 0 1 2 4 2</nobr> . </li><li>  From position 3 to position 4, Annie will not carry the cube, because the height of the tower at position 4 is greater than the height of the tower at position 3. </li><li>  From position 2 to position 3, Anjuta will not roll over the cube, because in position 2 there are no cubes. </li><li>  Finally, from position 1 to position 2, Annie will transfer one die.  The heights of the towers will be equal to <nobr>4 1 1 2 4 2</nobr> . </li><li>  After these actions, Annie will add one die to position number 1, and the heights of the towers will become equal to <nobr>5 1 1 2 4 2</nobr> . </li></ol><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ef/f20/4ec/3eff204eccf708b4f70d95b52690bb2d.png"><br>  <i>Change of tower heights within a minute in the example described above.</i> <br><br>  Once, Anyuta got tired of playing, and she decided to calculate how many cubes she would have in certain positions after a certain number of minutes.  Since Annie is still small and there are so many cubes, she turned to you for help. <br>  More formally, you need to answer Q requests of the form "how many will be in the sum of cubes in the towers with numbers from <i>S</i> <sub>i</sub> to <i>F</i> <sub>i</sub> inclusively after <i>B</i> <sub>i</sub> minutes".  Requests are independent: in each request, it is assumed that initially all positions are empty, and after that i&gt; B <sub>i</sub> minutes passes. <br><br>  <u>The input file format</u> .  The first line of the input contains two integers <i>N</i> and <i>Q</i> (2 ‚â§ <i>N</i> ‚â§ 10 <sup>18</sup> , 1 ‚â§ <i>Q</i> ‚â§ 100 000) - the number of positions for the towers and the number of queries, respectively.  Each of the following <i>Q</i> lines contains three integers <i>S</i> <sub>i</sub> , <i>F</i> <sub>i</sub> and <i>B</i> <sub>i</sub> (1 ‚â§ <i>S</i> <sub>i</sub> ‚â§ <i>F</i> <sub>i</sub> ‚â§ <i>N</i> , 1 ‚â§ <i>B</i> <sub>i</sub> ‚â§ 10 <sup>18</sup> ) - the starting and ending positions for the request and the number of minutes elapsed after start pansing action. <br><br>  <u>The format of the output file</u> .  Print Q lines, one for each query.  On each line print a single number - the answer to the query.  Answer the queries in the order they appear in the input. <br><br>  Examples <br><table><tbody><tr><td>  stdin </td><td>  stdout </td></tr><tr><td>  10 3 <br>  1 1 1 <br>  1 10 100 <br>  10 10 11 <br></td><td>  one <br>  100 <br>  2 </td></tr><tr><td>  1 billion 2 <br>  1 1234 412412314 <br>  100000000000 999999999999 <br>  1000000000010 </td><td>  1234 <br>  900000000006 </td></tr></tbody></table><br><br>  <b>Solution of Problem D</b> <br><br>  First you need to understand how the cubes move in positions.  Consider, for example, the case when <i>N</i> = 5. <br><br>  In the first five minutes, the cubes will ‚Äúcrawl‚Äù one by one from position number 1 to position <i>N</i> , until one die appears in each position and the heights of the towers are equal to [1, 1, 1, 1, 1]. <br>  In the sixth minute, the die from the fourth position will move to the fifth, the cubes will move to the left one position to the right, and a new die will appear in position number 1: [1, 1, 1, 1, 2]. <br>  In the seventh minute, the cubes will only move from positions (3,2,1) to positions (4,3,2), respectively, and the heights will become [1, 1, 2, 2]. <br><br>  In the eighth minute, the cubes will move from positions 1-4: [1, 1, 1, 2, 3]. <br><br>  Continuing the simulation, we get: <br><ul><li>  9th minute: [1, 1, 2, 2, 3] </li><li>  10th minute: [1, 1, 2, 3, 3] </li><li>  11th minute: [1, 1, 2, 3, 4] </li></ul><br>  After another 4 minutes the heights of the towers will become equal [1, 2, 3, 4, 5].  After another 5 minutes, the heights will be [2, 3, 4, 5, 6], after another 5 ~ - [3, 4, 5, 6, 7]. <br><br>  Thus, it is easy to notice the following pattern: <br><ol><li>  In the first <i>N</i> minutes, the heights of the towers are [1, ..., 1, 0, ..., 0]; </li><li>  Further, the heights of the towers are either [1, ..., 1, 2, 3, ..., <i>x</i> ], or <nobr>[1, ..., 1, 2, 3, ...,</nobr> <i>k</i> - 1, <i>k</i> , <i>k</i> , <i>k</i> + 1, ..., <i>x</i> ]; </li><li>  Later <img src="https://habrastorage.org/getpro/habr/post_images/cb9/e41/bc4/cb9e41bc41ef47e3f974bb82e8b869d8.png">  minutes after the beginning of the height of the towers have the form <nobr>[1, 2, 3, ...,</nobr> <i>N</i> - 1, <i>N</i> ]; </li><li>  After that, one cube is added to all towers in a circle. </li></ol><br>  Considering the above, to answer each query, you must first calculate what kind of towers heights have now, and then apply some simple mathematical formulas related to arithmetic progressions. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/296/7b6/97c/2967b697cd3800ba17fdcdd2d8f010e3.jpg"><br><br><h4>  Problem E. Mathematical magic </h4><br>  <i>The author of the task and work is Oleg Khristenko</i> <br>  <u>Input file name</u> : stdin <br>  <u>Output file name</u> : stdout <br>  <u>Time limit</u> : 2 seconds <br>  <u>Memory limit</u> : 512 megabytes <br><br>  Once Vasya was preparing for a maths Olympiad and fell asleep.  Vasya dreamed of David Blaine saying the following: <br><br>  ‚ÄúNow I will demonstrate mathematical magic.  Look here: I write on the blackboard in a row <i>N</i> positive integers, greater than one and less than 2 <sup>63</sup> .  Some of these numbers are repeated: at least one of them is equal to some other number in the row.  Below them, I write on the board a series of <i>K</i> &lt; <i>N</i> positive integers, greater than one and less than 2 <sup>63</sup> , some of which also repeat.  Multiply the numbers in both sets ... the product of the numbers from the second set is exactly one more than the product of the numbers from the first set. <br><br>  And now I remove some repetitions in the top row of numbers: the set of numbers present in the top row remains the same, but at least one element of the row I erase.  I do the same with the bottom row ... again, not a single number of the series has disappeared at all, just some of the numbers have become smaller.  Again, multiply the sets ... and see that the product of numbers from the second set is again exactly one more than the product of numbers from the first set.  Magic!" <br><br>  Vasya woke up, but could only remember <i>N.</i>  Help him regain focus. <br><br>  <u>The input file format</u> .  The first line of the input file contains a single integer <i>N</i> (2 ‚â§ <i>N</i> ‚â§ 100) - the number of numbers in the set originally written by David Blaine. <br><br>  <u>The format of the output file</u> .  In the first line print the set originally written by David Blaine, in the second - the one that was written from the bottom, in the third and fourth - variants of these sets after David made the deletions.  The numbers within each set must be sorted in non-decreasing order, must be greater than one and must not exceed 2 <sup>63</sup> - 1. <br><br>  If there are no sets satisfying the condition and constraints, output one word ‚ÄúImpossible‚Äù instead.  If there are several such sets, output any of them. <br><br><table><tbody><tr><td>  stdin </td><td>  stdout </td></tr><tr><td>  2 </td><td>  Impossible </td></tr><tr><td>  3 </td><td>  2 2 2 <br>  3 3 <br>  2 <br>  3 </td></tr></tbody></table><br><br>  <b>Parsing task E</b> <br><br>  For <i><i>N</i></i> = 2, there is no solution (since <i>K</i> &lt; <i><i>N</i></i> , one number is written out in the lower part, and it is impossible to cross out multiples).  For <i><i>N</i></i> = 3, the solution is 8, 9, 2, 3 ({222}, {33}, {2}, {3}). It can be shown that this solution is unique.  For <i><i>N</i></i> = 4, there is no solution.  The proof is given at the end of the analysis. <br><br>  We construct a solution for <i><i>N</i></i> ‚â• 5. <br><br>  For any <i>N</i> &gt; 4, we take the numbers 2 (2 <sup><i>N</i> -3</sup> -1) and 2 <sup><i>N</i> -1</sup> (2 <sup><i>N</i> -3</sup> -1) as <i>b</i> and <i>a</i> . <br>  Obviously, they are representable as the product of a certain number of twos and the number 2 <sup><i>N</i> ‚Äì3</sup> ‚Äì1, <i>a</i> is represented as a product of <i>N</i> factors, and <i>a</i> is divided by <i>b</i> .  Check the conditions on <nobr><i>a</i> +1</nobr> and <nobr><i>b</i> +1</nobr> .  <nobr><i>a</i> + 1 = (2 <sup><i>N</i> -2 -2</sup> ) + 1 = 2 <sup><i>N</i> - 2</sup> - 1</nobr> , and <nobr><i>b</i> + 1 = 2 <sup><i>N</i> -2</sup> (2 <sup><i>N</i> -2</sup> - 2) + 1 = (2 <sup><i>N</i> -2</sup> ) <sup>2</sup> - 2 * 2 <sup><i>N</i> -2</sup> + 1 = (2 <sup><i>N</i> -2</sup> - 1) <sup>2</sup></nobr> , that is, we obtain that <nobr><i>a</i> + 1 = ( <i>b</i> +1) <sup>2</sup></nobr> , and thus <br>  we obtain sets of two and one numbers, respectively, satisfying the condition of the problem. <br><br>  For 5 ‚â§ <i>N</i> ‚â§ 65, the answer thus generated is automatically suitable. <br><br>  Further, we note that if the set <i><i>q</i></i> <sub>1</sub> , ..., <i><i>q</i></i> <sub>k</sub> is a solution to the problem for <i>N</i> = k, and <nobr><i><i>q</i></i> <sub>k</sub> = <i>r</i> <sub>1</sub> ¬∑ <i>r</i> <sub>2</sub></nobr> , then the set <nobr><i><i>q</i></i> <sub>1</sub> , ..., <i>q</i> <sub>k-1</sub> , <i>r</i> <sub>1</sub> , <i>r</i> <sub>2</sub></nobr> is the solution of the problem for <nobr><i>N</i> = k + 1</nobr> (we simply represent in the expansion of the number <i>b the</i> number <nobr>{ <i>q</i> <sub>k</sub> } as the product of the numbers <i>r</i> <sub>1</sub> and <i>r</i> <sub>2</sub> ).</nobr>  <nobr>Similarly, the decomposition of one of the factors into the product of two smaller ones translates the pair</nobr> <nobr>( <i>a</i> +1)</nobr> , <nobr>( <i>b</i> +1)</nobr> into the correct pair. <br><br>  Therefore, we will try to decompose <nobr>2 <sup><i>N</i> -3</sup> - 1</nobr> into factors not exceeding <nobr>2 <sup>63</sup> - 1</nobr> , thereby obtaining from the same formula a solution for numbers from <nobr><i>N</i> + 1</nobr> to <nobr><i>N</i> + D - 1</nobr> , where <i>D</i> is the number of prime divisors of <nobr>2 <sup><i>N</i> -3</sup> - 1</nobr> .  In the case of <i>N</i> &gt; 65, it is required to decompose <nobr>2 <sup><i>N</i> -2</sup> - 1</nobr> into factors not exceeding <nobr>2 <sup>63</sup> - 1</nobr> . <br><br>  If <i>N</i> has a residue of 0 modulo 6, then <i>N</i> - 2 is divided by 2, <i>N</i> - 3 is divided by 3, and thus <nobr>2 <sup><i>N</i> -2</sup> - 1</nobr> is represented as <nobr>(2 <sup>( <i>N</i> -2) / 2</sup> - 1) (2 <sup>( <i>N</i> -2) / 2</sup> + 1)</nobr> , and <nobr>2 <sup><i>N</i> -3</sup> - 1 - as</nobr> <nobr>(2 <sup>( <i>N</i> -3) / 3</sup> - 1) (2 <sup>(2 <i>N</i> -6) / 3</sup> + 2 <sup>( <i>N</i> -3) / 3</sup> + 1)</nobr> .  It is easy to see that when <i>N</i> ‚â§ 95, both factors do not exceed <nobr>2 <sup>63</sup> - 1</nobr> .  And if so, then all their subsequent expansions also satisfy the requirements of the problem. <br><br>  If <i>N</i> has a remainder of 5 modulo 6, then <nobr><i>N</i> - 2</nobr> is divided by 3, and <nobr><i>N</i> - 3 -</nobr> by 2, respectively, we use the same decomposition. <br><br>  Thus, we start with <i>N</i> = 63 (2 <sup>60</sup> -1 should be decomposed into a large number of factors, and <nobr>2 <sup>61</sup> -1</nobr> satisfies the requirement of the task), and then we iterate over all <i>N</i> not exceeding 96 and giving 0 or 5 when divided by 6, making the first decomposition of <nobr>2 <sup><i>N</i> -3</sup> - 1</nobr> into factors in the manner described in the previous paragraph (then expanding each of the factors ‚Äúup to the stop‚Äù) and, also in accordance with this method, decomposing <nobr>2 <sup><i>N</i> -2</sup> - 1</nobr> into two factors.  At the same time, the number of factors <i>K</i> in the set <nobr><i>a</i> + 1</nobr> will be four (the square of the number goes into the square of the product of two numbers), thus the condition <i>K</i> &lt; <i>N</i> is satisfied. As a result of the search, we get that: <br><br><ul><li>  With <i>N</i> = 63, we get <i>D</i> = 13 factors, that is, we generate answers for <nobr>64 ‚â§</nobr> <i>N</i> ‚â§ 75. </li><li>  For <i>N</i> = 71, we get <i>D</i> = 7 multipliers; we generate answers for <i>N</i> from 72 to 77 inclusive. </li><li>  When <i>N</i> = 77, we get <i>D</i> = 4 multipliers; we generate answers for <i>N</i> from 78 to 81 inclusive. </li><li>  When <i>N</i> = 78, we get <i>D</i> = 7 factors, we generate answers for <i>N</i> from 79 to 84 inclusive. </li><li>  When <i>N</i> = 83, we get <i>D</i> = 11 multipliers; we generate answers for <i>N</i> from 84 to 93 inclusive. </li><li>  When <i>N</i> = 90, we get <i>D</i> = 6 multipliers; we generate answers for <i>N</i> from 91 to 95 inclusive. </li><li>  When <i>N</i> = 95, we get <i>D</i> = 9 multipliers; we generate answers for <i>N</i> from 96 to 100 (even up to 104) inclusive. </li></ul><br><br>  Thus, the algorithm finds solutions for all <i>N</i> ‚â§ 100. <br><br><h5>  Proof of the impossibility of solving with <i>N</i> = 4 </h5><br>  Since <i>N</i> = 4, then, by the condition of the problem, <i>a</i> + 1 is decomposed into three factors or less.  To be that cross out, at least two of them must be repeated.  Also, by the condition of the problem, <i>a</i> is divided by <i>b</i> , that is, <nobr><i>a</i> = <i>x</i> <i>b</i></nobr> , <nobr><i>x</i> &gt; 1</nobr> . <br><br>  First, let us analyze all the variants of the set for <nobr><i>a</i> + 1</nobr> (and the corresponding set for <nobr><i>b</i> + 1</nobr> ): <br><br><ol><li>  <i>u</i> <sup>2</sup> , ~ <i>u</i> ; </li><li>  <i>u</i> <sup>3</sup> , ~ <i>u</i> ; </li><li>  <i>uv</i> <sup>2</sup> , <i>uv</i> ; </li><li>  <i>u</i> <sup>3</sup> , <i>u</i> <sup>2</sup> . </li></ol><br><br>  In the case of 3 <nobr><i>a</i> + 1 = <i>uv</i> <sup>2</sup></nobr> .  Then <nobr><i>b</i> + 1 = <i>uv</i> ;</nobr>  <nobr><i>x</i> <i>b</i> + 1 = <i>uv</i> <sup>2</sup></nobr> , subtract, <nobr><i>uv</i> ( <i>v</i> - 1) = <i>b</i> ( <i>x</i> - 1)</nobr> .  Since <i>uv</i> and <i>b</i> are mutually simple, <nobr><i>v</i> - 1</nobr> is divisible by <i>b</i> , since <nobr><i>v</i> &gt; 1</nobr> , <nobr><i>v</i> - 1 = <i>y</i> <i>b</i> ‚â• <i>b</i></nobr> nobr&gt;, <nobr><i>v</i> ‚â• <i>b</i> + 1</nobr> .  Since <i>u</i> &gt; 1, then <nobr><i>uv</i> &gt; <i>v</i> ‚â• <i>b</i> +</nobr> .  Contradiction. <br><br>  Since this argument does not use the fact that <nobr><i>u</i> ‚â† <i>v</i></nobr> , the case <nobr><i>a</i> + 1 = u <sup>3</sup></nobr> and <nobr><i>b</i> + 1 = u <sup>2 is</sup></nobr> considered automatically. <br><br>  Cases 1 ( <i>u</i> <sup>2</sup> , ~ <i>u</i> ) and 2 ( <i>u</i> <sup>3</sup> , ~ <i>u</i> ) <i>remain</i> .  For them, consider the options for a set of four factors for <i>a</i> and a corresponding set for <i>b</i> . <br><br>  I. <i>a</i> = <i>x</i> <sup>2</sup> <i>y</i> <i>z</i> , <i>b</i> = <i>x</i> <i>y</i> <i>z</i> ; <br><br>  Ii.  <i>a</i> = <i>x</i> <sup>2</sup> <i>y</i> <sup>2</sup> , <i>b</i> = <i>x</i> <i>y</i> <sup>2</sup> ; <br><br>  Iii.  <i>a</i> = <i>x</i> <sup>3</sup> <i>y</i> , <i>b</i> = <i>x</i> <sup>2</sup> <i>y</i> ; <br><br>  Iv.  <i>a</i> = <i>x</i> <sup>4</sup> , <i>b</i> = <i>x</i> <sup>3</sup> ; <br><br>  V. a = <i>x</i> <sup>2</sup> <i>y</i> <sup>2</sup> , <i>b</i> = <i>x</i> <i>y</i> ; <br><br>  Vi.  <i>a</i> = <i>x</i> <sup>4</sup> , <i>b</i> = <i>x</i> <sup>2</sup> ; <br><br>  VII.  <i>a</i> = <i>x</i> <sup>3</sup> <i>y</i> , <i>b</i> = <i>x</i> <i>y</i> ; <br><br>  Viii.  <i>a</i> = <i>x</i> <sup>4</sup> , <i>b</i> = <i>x</i> . <br><br>  Variants II ‚Äì IV are obtained from variant I by substituting <i>z</i> = <i>y</i> , <i>z</i> = <i>x</i> and <nobr><i>z</i> = <i>y</i> = <i>x,</i></nobr> respectively.  Similarly, option VI is a special case of option V. <br><br>  In <i>option I,</i> replace <i>y</i> <i>z</i> with <i>t</i> . <br><br>  1. <i>x</i> <sup>2</sup> <i>t</i> + 1 = <i>v</i> <sup>2</sup> , <i>x</i> <i>t</i> + 1 = <i>v</i> , whence <i>x</i> <sup>2</sup> <i>t</i> + 1 = <i>x</i> <sup>2</sup> <i>t</i> <sup>2</sup> + 2 <i>x</i> <i>t</i> + 1. Since all terms are positive and <i>x</i> <sup>2</sup> <i>t</i> <sup>2</sup> &gt; <i>x</i> <sup>2</sup> <i>t</i> (since <i>t</i> &gt; 1), then the right side is larger than the left. <br><br>  2. <i>x</i> <sup>2</sup> <i>t</i> + 1 = v <sup>3</sup> , <i>x</i> <i>t</i> + 1 = <i>v</i> .  By a similar substitution and opening of the brackets, we get <nobr><i>x</i> <sup>2</sup> <i>t</i> = <i>x</i> ^ 3 <i>t</i> <sup>3</sup> + 3 <i>x</i> <sup>2</sup> <i>t</i> <sup>2</sup> + 3 <i>x</i> <i>t</i></nobr> , all the terms are positive, <i>x</i> <sup>2</sup> <i>t</i> &lt; <i>x</i> <sup>3</sup> <i>t</i> <sup>3</sup> . <br><br>  <i>Option V</i> <br><br>  1. <i>x</i> <sup>2</sup> <i>y</i> <sup>2</sup> + 1 = v <sup>2</sup> .  Immediately does not happen for integers <i>x</i> , <i>y</i> , <i>v</i> &gt; 1. <br><br>  2. <i>x</i> <sup>2</sup> <i>y</i> <sup>2</sup> + 1 = v <sup>3</sup> , <i>x</i> <i>y</i> + 1 = <i>v</i> .  When substituting and casting similar ones, we get that the sum <nobr>( <i>x</i> <i>y</i> ) <sup>3</sup> + 2 ( <i>x</i> <i>y</i> ) <sup>2</sup> + 3 <i>x</i> <i>y</i></nobr> is 0, which is impossible for <i>x</i> , <i>y</i> &gt; 1. <br><br>  <i>Option VII</i> <br><br>  1. <i>x</i> <sup>3</sup> <i>y</i> + 1 = v <sup>2</sup> , <i>x</i> <i>y</i> + 1 = v, rewrite as <nobr><i>x</i> <sup>3</sup> <i>y</i> + 1 = <i>x</i> <sup>2</sup> <i>y</i> <sup>2</sup> + 2 <i>x</i> <i>y</i> + 1</nobr> and then as <nobr><i>x</i> <i>y</i> ( <i>x</i> <sup>2</sup> - <i>x</i> <i>y</i> ) = 2</nobr> .  It turns out that 2 is divided by <i>x</i> <i>y</i> , which for <i>x</i> &gt; 1 and <i>y</i> &gt; 1 cannot be. <br><br>  2. <i>x</i> <sup>3</sup> <i>y</i> + 1 = v <sup>3</sup> , <i>x</i> <i>y</i> + 1 = <i>v</i> .  We substitute, we get that <nobr><i>x</i> <sup>3</sup> <i>y</i> = <i>x</i> <sup>3</sup> <i>y</i> <sup>3</sup> + ...</nobr> (obviously positive numbers are indicated by ellipses), which is impossible for <i>y</i> &gt; 1. <br><br>  <i>Option VIII</i> <br><br>  Let <i>x</i> <sup>4</sup> + 1 be divided by <i>x</i> + 1. But <nobr><i>x</i> <sup>4</sup> + 1 = ( <i>x</i> + 1) ( <i>x</i> - 1) ( <i>x</i> <sup>2</sup> + 1) + 2</nobr> , that is, we obtain that 2 is divided by <i>x</i> + 1. Contradiction with the fact that <i>x</i> &gt; 1. <br><br>  We analyzed all cases and everywhere came to a contradiction, that is, with <i>N</i> = 4, there is no solution. <br><br><h4>  Problem F. Zebra Hippo and stripes </h4><br>  <i>The author of the task and work is rng58 (Makoto Soejima)</i> <br>  <u>Input file name</u> : stdin <br>  <u>Output file name</u> : stdout <br>  <u>Time limit</u> : 2 seconds <br>  <u>Memory limit</u> : 512 megabytes <br><br>  The Hippo zebra has 10 <sup>18</sup> stripes, numbered with consecutive integers from 0 to 10 <sup>18</sup> - 1. At time 0, only the strip with the number <nobr>5‚ãÖ 10 <sup>17</sup> is black, the rest are white.</nobr>  <nobr>At time</nobr> <nobr><i>t</i> ( <i>t</i> &gt; 0), the</nobr> color of the stripes satisfies the following rules: <br><br><ul><li>  <i>x</i> -     <i>t</i> ‚Äî 1  ,         <i>t</i> . </li><li>     <i>t</i> ‚Äî 1  ,     ,  <i>D</i>  <i>x</i> - ,   ( ,     <i>y</i> ,  10 <sup>18</sup>    | <i>x</i> ‚Äî y| ‚â§ <i>D</i> , <i>y</i> -     <i>t</i> -1  ),     <i>t</i> <i>x</i> -    <br> . </li><li>     <i>x</i> -     <i>t</i>   . </li></ul><br>         10 <sup>9</sup> + 7    <i>t</i> .     ,       . <br><br> <u>  </u> .           <i>t</i>  D (1 ‚â§ <i>t</i> ‚â§ 10 <sup>9</sup> , 1 ‚â§ D ‚â§ 50),  . <br><br> <u>  </u> .     ‚Äî          <i>t</i>  10 <sup>9</sup> + 7 <br><br> <u></u> <br><br><table><tbody><tr><td> stdin </td><td> stdout </td></tr><tr><td> 5 1 </td><td>  36 </td></tr><tr><td> 2 3 </td><td>  1849 </td></tr></tbody></table><br><br> <b>  F</b> <br><br>    ,           .         .      : <nobr>500 000 000 000 000 000+ <i>x</i> -</nobr>   <i>x</i> -. <br><br>      :  ,     <i>t</i> ,       .     : <br><br>        0,   <i>A</i> . <br><br>  Cycle: <br><ul><li>       ,   . </li><li>  <i>x</i> ‚Äî   . </li><li>   <i>d</i> (0 &lt; <i>d</i> ‚â§ <i>D</i> ) ,  ( <i>x</i> + <i>d</i> )-  .   <i>d</i> ,   . </li><li>  <i>d</i>   <i>A</i>     ( <i>x</i> + <i>d</i> )- . </li></ul><br>  The end of the cycle. <br><br>     ,   <i>t</i>     <i>A</i> . <br><br>  <i>f</i> ( <i>a</i> <sub>1</sub> , <i>a</i> <sub>2</sub> ,..., <i>a</i> <sub>k</sub> ) ‚Äî  ,      <br> <i>A</i> ={ <i>a</i> <sub>1</sub> , <i>a</i> <sub>2</sub> ,..., <i>a</i> <sub>k</sub> }. <br><br>   { <i>a</i> <sub>1</sub> , <i>a</i> <sub>2</sub> ,..., <i>a</i> <sub>k</sub> }       , : <br><br><ul><li> 0-, <i>a</i> <sub>1</sub> -, ( <i>a</i> <sub>1</sub> + <i>a</i> <sub>2</sub> )-     ‚Äî . </li><li>   <i>i</i>   ( <i>a</i> <sub>1</sub> +...+a <sub>i</sub> +1)-  ( <i>a</i> <sub>1</sub> +...+a <sub><i>i</i> -1</sub> + <i>D</i> )-  . </li></ul><br>   <i>f</i> ( <i>a</i> <sub>1</sub> , <i>a</i> <sub>2</sub> ,..., <i>a</i> <sub>k</sub> ) = 2 <sup><i>a</i> <sub>1</sub> -1 + <i>a</i> <sub>1</sub> + <i>a</i> <sub>2</sub> -D-1 + <i>a</i> <sub>2</sub> + <i>a</i> <sub>3</sub> - <i>D</i> -1 +...</sup> . <br><br>        ,    <nobr><i>f</i> ( <i>a</i> <sub>1</sub> , <i>a</i> <sub>2</sub> ,..., <i>a</i> <sub>k</sub> ) ( <i>k</i> ‚â§ <i>T</i> ).</nobr> <br><br>  <i>dp</i> [ <i>t</i> ][ <i>a</i> ] ( <i>t ‚â§ T, a ‚â§ D</i> ) ‚Äî  <i>f</i> ( <i>a</i> <sub>1</sub> , <i>a</i> <sub>2</sub> ,..., a <sub>t-1</sub> , a). <br><br>       : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e08/bb5/12b/e08bb512b217b783b51156959dddb200.png"><br><br>     1 + <i>dp</i> [1][ <i>D</i> ] +‚Ä¶ + <i>dp</i> [ <i>T</i> ][ <i>D</i> ],      <i>O(TD)</i> . <br><br>   ,      .  <i>v <sub>t</sub></i> ‚Äî  <nobr>( <i>dp</i> [ <i>t</i> ][0],‚Ä¶, <i>dp</i> [ <i>t</i> ][ <i>D</i> ])</nobr> .     ,  <i>v</i> <sub>t+1</sub> = <i>v</i> <sub>t</sub> ¬∑ <i>A</i>   <i>t</i> ( <i>A</i> ‚Äî    <br> <nobr>( <i>D</i> +1) √ó ( <i>D</i> +1)).</nobr> <br><br>        <nobr><i>v</i> <sub>0</sub> ‚ãÖ ( <i>A</i> + <i>A</i> <sup>2</sup> +‚Ä¶ + <i>A</i> <sup>T</sup> )</nobr> ,   . <br><br>    ‚Äî O( <i>D</i> <sup>3</sup> ‚ãÖ <i>log T</i> ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/28e/ccb/7c0/28eccb7c0f513f9d0566676335246e1e.jpg" alt="image"><br><br>      .            ACM ICPC 2013   (Niyaz Nigmatullin)    (mikhailOK),  Facebook Hacker Cup, Google Code Jam  . 2011,          (Petr), - VK Cup 2012   (s-quark)       . <br><br>     , , , , , ,    .   ‚Äî   Google, ¬´¬ª  Facebook. </div><p>Source: <a href="https://habr.com/ru/post/191030/">https://habr.com/ru/post/191030/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../191010/index.html">Why study TDD is difficult and what to do about it. Part 1</a></li>
<li><a href="../191014/index.html">External components in 1C 8.2</a></li>
<li><a href="../191018/index.html">Five pitfalls when using shared_ptr</a></li>
<li><a href="../191022/index.html">The concept of the Ministry of Communications and Mass Media: I want a substantive conversation</a></li>
<li><a href="../191024/index.html">Inforza - a new channel to attract customers for studios and agencies</a></li>
<li><a href="../191032/index.html">Python inside. Process structures</a></li>
<li><a href="../191044/index.html">Rootkit Avatar and HiddenFsReader</a></li>
<li><a href="../191048/index.html">IBM Unveils New Wind and Solar Prediction System</a></li>
<li><a href="../191052/index.html">Nginx has a paid version - Nginx Plus</a></li>
<li><a href="../191054/index.html">STM32 vs Arduino</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>