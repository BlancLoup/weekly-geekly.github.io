<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Java and iCalendar work</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, I had to parse and then output the necessary information from the iCalendar . After stubborn searching, I stumbled upon the iCal4J li...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Java and iCalendar work</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago, I had to parse and then output the necessary information from the <a href="http://en.wikipedia.org/wiki/ICalendar">iCalendar</a> .  After stubborn searching, I stumbled upon the <b>iCal4J</b> library.  Looking closely at its functionality, I realized - this is what I need.  Let's try to put it into practice. <br><br><h5>  Calendar preparation </h5><br>  In Google Calendar, I created a small calendar consisting of several different events ranging from 30 minutes to 6 hours.  Then I downloaded the calendar in iCal format to my laptop.  If anyone does not know, this is done like this: go to the Google calendar settings and in the section ‚ÄúPrivate address of the calendar‚Äù click on the green button ‚ÄúICAL‚Äù.  Everything, calendar is loaded on the device. <br><a name="habracut"></a><br><h5>  Java preparation </h5><br>  The next step was to load the library and connect it to the project.  Unpacked and pointed out to the development environment a folder with * .jar library files.  Also in the folder with the project was downloaded my downloaded calendar file.  Everything is ready to write code! <br><br><h5>  Download calendar </h5><br>  There are two options for loading the calendar - from a file and parsing the string with the contents of the calendar.  We will choose the first method (the second is not significantly different from it). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//      FileInputStream fin = new FileInputStream("calendar.ics"); //          Calendar CalendarBuilder builder = new CalendarBuilder(); Calendar calendar = builder.build(fin);</span></span></code> </pre> <br><br><h5>  Show all events </h5><br>  Let's now try to bring somewhere (well, at least to the console) all the events from our calendar. <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//    ComponentList listEvent = calendar.getComponents(Component.VEVENT); for (Object elem : listEvent) { //         ,   listEvent   Object VEvent event = (VEvent) elem; //   // getValue()   ,    .   getName()  toString()       DESCRIPTION String description = event.getDescription().getValue(); //    String title = event.getSummary().getValue(); System.out.println(title + " : " + description); }</span></span></code> </pre><br>  It is worth paying attention to the first line, namely Component.VEVENT.  So we specify that we want to receive calendar events.  If you do not explicitly indicate what we want to extract from the calendar, we will receive a list that also contains To-Do components (VTODO), notes (VJOURNAL), and other components such as VFREEBUSY, VALARM and VTIMEZONE. <br><br><h5>  Applying filters </h5><br>  In order to display the elements, in my case of the event, in a certain period of time, you can apply filters. <br><br><pre> <code class="java hljs">java.util.Calendar today = java.util.Calendar.getInstance(); today.set(java.util.Calendar.HOUR_OF_DAY, <span class="hljs-number"><span class="hljs-number">0</span></span>); today.clear(java.util.Calendar.MINUTE); today.clear(java.util.Calendar.SECOND); <span class="hljs-comment"><span class="hljs-comment">//     1  Period period = new Period(new DateTime(today.getTime()), new Dur(1, 0, 0, 0)); //      Filter filter = new Filter(new PeriodRule(period)); //     List eventsToday = filter.filter(calendar.getComponents(Component.VEVENT)); // ,  eventsToday   ,    </span></span></code> </pre><br><br>  At the time of writing, the following entries were stored in my calendar (in the format ‚ÄúTitle‚Äù: ‚ÄúDescription‚Äù [‚ÄúStart Time‚Äù]): <br><blockquote>  Event 1: Event 1 - November 1 [7 Nov 2013 13:00:00 GMT] <br>  Event 5: Event 5 - November 12 [12 Nov 2013 12:00:00 GMT] <br>  Event 3: Event 3 - November 10 [10 Nov 2013 19:30:00 GMT] <br>  Event 2: Event 2 - November 9 [9 Nov 2013 08:30:00 GMT] <br>  Event 4: Event 4 - November 11 [11 Nov 2013 08:00:00 GMT] <br>  Event 6: Event 6 - November 13 [13 Nov 2013 09:30:00 GMT] <br></blockquote><br>  After applying the filter to display the planned events (November 11), I received only one event - Event 4: <br><blockquote>  Event 4: Event 4 - November 11 [11 Nov 2013 08:00:00 GMT] </blockquote><br>  Increasing the period to three days ... <br><pre> <code class="java hljs">Period period = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Period(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(today.getTime()), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dur(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>));</code> </pre><br>  ... I got this picture: <br><blockquote>  Event 5: Event 5 - November 12 [12 Nov 2013 12:00:00 GMT] <br>  Event 4: Event 4 - November 11 [11 Nov 2013 08:00:00 GMT] <br>  Event 6: Event 6 - November 13 [13 Nov 2013 09:30:00 GMT] </blockquote><br><br><h5>  Creating an empty calendar </h5><br>  iCal4j also supports creating a calendar from scratch.  Everything is simple here.  Create a calendar object, add the necessary fields to it. <br><br><pre> <code class="java hljs">Calendar calendar = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Calendar(); calendar.getProperties().add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProdId(<span class="hljs-string"><span class="hljs-string">"-//habrahabr"</span></span>)); calendar.getProperties().add(Version.VERSION_2_0); calendar.getProperties().add(CalScale.GREGORIAN);</code> </pre><br><br><h5>  Adding a new event to the calendar </h5><br>  Here, with the creation of an event, everything is not so simple, but if you look at it, everything will go pretty quickly. <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//    TimeZoneRegistry registry = TimeZoneRegistryFactory.getInstance().createRegistry(); TimeZone timezone = registry.getTimeZone("Europe/Minsk"); VTimeZone tz = timezone.getVTimeZone(); //  10   18:00 java.util.Calendar startDate = new GregorianCalendar(); startDate.setTimeZone(timezone); startDate.set(java.util.Calendar.MONTH, java.util.Calendar.NOVEMBER); startDate.set(java.util.Calendar.DAY_OF_MONTH, 10); startDate.set(java.util.Calendar.YEAR, 2013); startDate.set(java.util.Calendar.HOUR_OF_DAY, 18); startDate.set(java.util.Calendar.MINUTE, 0); startDate.set(java.util.Calendar.SECOND, 0); //       20:00 java.util.Calendar endDate = new GregorianCalendar(); endDate.setTimeZone(timezone); endDate.set(java.util.Calendar.MONTH, java.util.Calendar.NOVEMBER); endDate.set(java.util.Calendar.DAY_OF_MONTH, 10); endDate.set(java.util.Calendar.YEAR, 2013); endDate.set(java.util.Calendar.HOUR_OF_DAY, 20); endDate.set(java.util.Calendar.MINUTE, 0); endDate.set(java.util.Calendar.SECOND, 0); //   String eventName = "- "; DateTime start = new DateTime(startDate.getTime()); DateTime end = new DateTime(endDate.getTime()); VEvent meeting = new VEvent(start, end, eventName); //        meeting.getProperties().add(tz.getTimeZoneId()); //    Calendar icsCalendar = new Calendar(); icsCalendar.getProperties().add(new ProdId("-//habrahabr")); icsCalendar.getProperties().add(CalScale.GREGORIAN); //      icsCalendar.getComponents().add(meeting);</span></span></code> </pre><br><br><h5>  Save calendar to file </h5><br>  After working with the calendar, we certainly need to save it.  It is best to save back to the file. <br><br><pre> <code class="java hljs">FileOutputStream fout = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(<span class="hljs-string"><span class="hljs-string">"calendar.ics"</span></span>); CalendarOutputter out = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CalendarOutputter(); out.output(calendar, fout);</code> </pre><br><br><h5>  Conclusion </h5><br>  We reviewed the basic features of the library iCal4j.  Of course, its capabilities are not limited to simply parsing the calendar and creating events.  The library also allows you to attach files to events, create events with an indication of the venue in the coordinates, create guest lists and much more.  In addition, the library can be used in the development of Android applications. <br><br>  References: <br><ol><li>  <a href="http://en.wikipedia.org/wiki/ICalendar">ICalendar Description</a> </li><li>  <a href="http://build.mnode.org/projects/ical4j/apidocs/index.html">ICal4j Documentation</a> </li><li>  <a href="http://wiki.modularity.net.au/ical4j/index.php%3Ftitle%3DMain_Page">iCal4j Wiki (here you can download the library)</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/201660/">https://habr.com/ru/post/201660/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201650/index.html">Geopolitical simulator - the history of creation and development</a></li>
<li><a href="../201652/index.html">How to quickly and accurately assess the project without TK</a></li>
<li><a href="../201654/index.html">What does it mean to be a junior developer</a></li>
<li><a href="../201656/index.html">Shortest Common Superstring Problem</a></li>
<li><a href="../201658/index.html">PubSub in a browser using webboxes and the WAMP protocol</a></li>
<li><a href="../201662/index.html">Oracle Certification Manual</a></li>
<li><a href="../201666/index.html">AMD hell or how I was tormented with a graphics card from AMD on Linux</a></li>
<li><a href="../201668/index.html">Use external Windows Azure Mobile Services authentication in a WPF desktop application</a></li>
<li><a href="../201670/index.html">SassyStudio - SCSS / SASS / Compass support in Visual Studio</a></li>
<li><a href="../201674/index.html">Asynchronous utm tag mining</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>