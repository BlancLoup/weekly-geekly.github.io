<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Anti-virus systems with cloud architecture</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Information occupies one of the most important places in the life of our society, therefore the protection of information is an integra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Anti-virus systems with cloud architecture</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  Information occupies one of the most important places in the life of our society, therefore the protection of information is an integral part of its use. <br><br>  The protection of information is most often considered in the context of the protection of its carriers.  Media protection requires sophisticated and diverse software and hardware.  With the existence of many architectural solutions of carriers, there is the same set of their protections. <br><a name="habracut"></a><br><h4>  Protection methods </h4><br>  Malicious software is constantly being improved, in connection with this, antivirus vendors are constantly updating the database of already known signatures (code sections of a known virus software that detects this software) or completely prohibit software modification and addition, as well as files in critical places on the computer. <br><br>  To combat the new threats, they use heuristic and signature-based analysis and proactive (behavioral) protection, which analyze the software in the process and identify suspicious actions.  Also often used method checks checksums. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  New methods of masking </h4><br>  Now conceptually new rootkits based on working outside the operating system have begun to appear. <br><br>  One of these methods is used in Boot rootkits.  They rewrite the boot record (MBR - master boot record) and after loading the BIOS execute malicious code, and only then the operating system is loaded. <br><br>  More interesting is the class of rootkits, which are based on the use of hardware virtualization called Blue Pill (English "Blue Pill").  For the first time, this class of rootkits was publicly demonstrated in the form of a demonstration program by Joanna Rutkovskaya at the Black Hat Briefings conference on August 3, 2006 as a sample implementation for the Microsoft Windows Vista operating system [1]. <br><br><h4>  Disguise Method - Blue Pill </h4><br>  The Blue Pill concept is to capture a running instance of the operating system (it is captured when the OS starts) with a thin hypervisor and virtualizing it with the rest of the computer. <br><br>  The previous operating system will still maintain links to all devices and files in it, but almost everything, including hardware interrupts, data requests, and even system time will be intercepted by the hypervisor, which will send fake replies. <br><br>  The only way to discover the ‚Äúblue pill‚Äù is to determine if the implementation loaded into the virtual environment does not function as expected.  Virtualization can be detected during a time attack based on external time sources [1]. <br><br><h4>  Existing protection methods </h4><br>  The implementation of protection against such threats is divided into two classes: <br><ol><li>  Complete prohibition of work or modification of information outside the OS at the hardware level; </li><li>  Timely detection and neutralization of threats during the operation of the OS (RedPill (English "Red Pill") [2], time attack, performance attack [1]). </li></ol><br>  Protection at the hardware level is difficult to implement and expensive, and there are currently no reliable ways to detect and neutralize such threats. <br><br>  The method of detecting the virtualization form by the thin hypervisor ‚ÄúRed Pill‚Äù was proposed by Joanna Rutkovskaya.  It is based on counting the number of interrupt vector tables in the main memory of a computer.  This method can adequately work only on systems with a single processor core. <br><br>  Attacks in time and in performance are based on the distortion of the time and speed characteristics of a computer when a hypervisor is deployed. <br><br><h4>  Cloud computing and the future of anti-virus systems </h4><br>  With the development of telecommunication systems, many antivirus companies have begun to pay attention to cloud computing [3, 4, 5]. <br><br>  The concept of cloud computing is to provide end users with remote dynamic access to services, applications (including operating systems and various infrastructure) and computing resources of various capacities [Fig.  1] [6]. <br><img src="https://habrastorage.org/storage/beccb45c/53d0c04c/c3c28b46/3741d683.png"><br>  Figure 1 - The Internet cloud and its users <br><br>  Cloud computing is divided into two types: <br><ol><li>  Platform clouds; </li><li>  Service clouds; </li></ol><br>  Platform clouds provide access to any platform.  This may be an operating system, a system for scientific calculations, etc. <br><br>  Cloud services provide only services.  Typically, users do not have access to broad cloud settings, data, and configurations.  Anti-virus systems are beginning to actively use both types of clouds. <br><br>  Platform clouds are highly specialized and usually serve as a large calculator and accumulator of statistics on the performance of desktop anti-virus systems or a database of the latest signatures.  Cloud services are used to provide users with the ability to download suspicious files to the cloud and anti-virus analysis without consuming user‚Äôs computer resources [5]. <br><br><h4>  Organization of antivirus work with the cloud </h4><br>  The details of the work of commercial anti-virus systems with anti-virus clouds are hidden commercial secrets.  But analyzing open sources we can distinguish several ways of organizing the work of anti-virus clouds: <br><ul><li>  Work with metadata and hash functions of executable files.  Their analysis in the cloud by an expert system [7]; </li><li>  Transfer of actual virus signatures in frequent and small portions on the user's computer [5]; </li><li>  SONAR technology (setting hazard points of an application, on operations performed by it and analyzing in the cloud) [3]. </li></ul><br>  All the above technologies have their advantages and disadvantages, but cloud computing is starting to play the main role here.  Antivirus cloud computing takes over all the problems inherent in clouds.  They also add antivirus software problems [7]. <br><br><h4>  Disadvantages of modern cloud antivirus systems </h4><br>  Modern cloud antiviruses operate with such concepts as metadata, hash functions, rating system of hazard assessment of objects.  All these approaches do not provide a fitting rebuff to fundamentally new software.  They are extensively fighting threats, only increasing equipment capacity and speeding up response times to new epidemics. <br><br>  Also a serious problem is the operation of antivirus systems in unprotected environments [Fig.  2.].  For this reason, many anti-virus tools contain integrity protection mechanisms, but this problem is still relevant today [8, 9]. <br><img src="https://habrastorage.org/storage/7de3d8e9/3bb68c7d/d25953be/a1720778.png"><br>  Figure 2 - Problems of working in unprotected environments <br><br>  Cloud anti-virus systems have made only a small step towards the development of all cloud computing capabilities.  These steps are designed to reduce the consumption of user resources, speed up the update of virus signatures [7] and create an expert base of modern threats.  Such a decision will not become a ‚Äúsilver bullet‚Äù [10].  It did not introduce new methods of dealing with malware, but only modified the already very outdated approaches. <br><br><h4>  Protection against rootkits with hardware virtualization </h4><br>  All approaches used in the work of modern anti-virus systems are helpless against rootkits running outside the OS and fundamentally new malware [1, 11]. <br><br>  Malicious programs in the form of a thin hypervisor partially or not at all use OS resources, do not infect its files, work with computer hardware without using OS drivers, they are completely invisible for modern anti-virus systems, including cloud ones. <br><br>  Cloud computing can solve this problem by moving the infection decision making system to a secure cloud environment. <br><br><h4>  Cloud Antivirus with Secure Runtime </h4><br>  The cloud is used for serious calculations to reduce the load on clients.  In anti-virus systems, it serves as a fast channel for the distribution of new anti-virus databases, as well as an accumulator of known threats. <br><br>  You can go ahead and make the whole cloud one big anti-virus environment.  In this case, only users acting as sensors will be located on the users computer.  They will cyclically take readings of the characteristics of client computers, and send them to the cloud.  A statistical calculation of changes in the characteristics of user computers will be carried out in the cloud.  In this case, when a user is infected with a new virus, the cloud will enter the distorted indications of the characteristics of the computer in its database, and the expert system will conclude that the computer is infected.  If the user's computer is connected to the network, but there is no connection with the client of the anti-virus system, then this computer is considered compromised, and measures should be taken to detect and neutralize the malware. <br><br>  The main, and the most difficult, in this approach will be to identify the characteristics of computers that are distorted when malware is introduced into a user's computer, and to transfer them safely to the cloud computer. <br><br>  Such an approach will make it possible to react to new threats much faster, because there is only one node making the decision.  This will allow avoiding epidemics that are now becoming increasingly widespread. <br><br>  In client computers, antivirus software should still have the means of self-defense, secure transmission over the network, as well as detection of ‚Äúelementary‚Äù virus threats (‚Äúelementary‚Äù threats that this anti-virus system can fight). <br><br><h4>  The concept of creating a secure execution environment </h4><br>  In the ideal case, a protected execution environment is considered to be the execution of programs whose actions and their possible consequences are completely known.  These programs are executed in the OS, about which everything is also known (for example, there is access to the source codes).  Thus, the possibility of hidden implementation of software "bookmarks" and undocumented features will be excluded.  The OS runs on a computer and devices that are assembled from components manufactured under proper control by known technology.  In this case, the possibility of introducing hardware "bookmarks" and undocumented features will be excluded.  And then food, premises, buildings, etc. Also, access to work with computers should be strictly regulated and limited to a trusted circle of persons. <br><br>  In life, the creation of a real protected environment is necessary for various government and military departments.  Especially if they are dealing with state secrets, the security of the country depends on their work. <br>  In other areas of the use of computers, this mode is almost not used in view of its high cost and reduced flexibility. <br><br>  A lot of hardware and software solutions on the current market cannot provide a secure execution environment, so programs acquire protection mechanisms: integrity monitoring, anti-debugging techniques, packaging and obfukation (writing trash code into an executable module, in order to complicate the study of software). <br><br>  A protected environment should be understood as the collection of information, analysis and decision-making on the infection of a client computer in an environment that is outside the area of ‚Äã‚Äãinformation collection.  This environment has greater reliability and controllability compared to the client computer, and cannot be compromised due to infection of the client computer. <br><br>  Creation of a protected runtime environment requires serious material and resource costs, as well as serious complication of software.  When data are not a state secret, it is believed that protection will be effective if more resources are required to overcome it than the data itself costs.  Therefore, it is always necessary to find trade-offs that allow for obtaining reasonably reliable software or hardware solutions at an acceptable cost. <br><br><h4>  Evaluation of the security and effectiveness of the proposed solution </h4><br>  The client computer may be compromised, but the cloud will remain in a working state, because the cloud only receives data from the client for statistics and calculations, any necessary information can be sent back. <br><br>  If the client of the anti-virus system completely refuses, the cloud can notify the user about the existing problems with his computer in any other available way (mobile text message, email, the website of the anti-virus system). <br><br>  In this case, only the client part can fail, the cloud calculator remains operable regardless of the state of the client computers. <br><br>  Of course, when exchanging cloud messages with the client of the anti-virus system, a sufficient level of quality control of incoming messages should be provided, integrity monitoring and identification of the client computer should be implemented. <br><br>  The proposed solution is more efficient than conventional desktop anti-virus systems with a centralized signature database update server: <br><ul><li>  By performance.  All computational operations are transferred to the cloud, thereby reducing the load on the user's computer; </li><li>  By latency.  The rate of detection of new threats and alerts available customers about the new danger increases; </li><li>  By security.  The cloud can not be compromised by the client, so the database of threats will always be relevant and intact; </li><li>  By relevance.  The expert system in the decision on the infection takes into account all the data collected from client computers.  There are more opportunities for analysis than the approach with the identification of signatures. </li><li>  On the introduction of new solutions.  New methods for detecting and neutralizing virus threats will be primarily introduced into the cloud, thereby reducing the impact on decision-making when software is outdated on a client computer. </li></ul><br>  It is worth mentioning that few anti-virus systems have a full-fledged cloud architecture.  This is due to the novelty of cloud computing, as an approach to ensuring anti-virus security. <br><br><h4>  Identification of control characteristics </h4><br>  Security experts have suggested several ways to determine the load of a thin hypervisor to the primary OS: <br><ul><li>  Attack on time; </li><li>  Performance attack; </li><li>  The method of counteraction "Red pill". </li></ul><br>  The time attack is based on an external time source.  This time source is controlled by the execution time of commands and individual operations on the user computer.  If there is a loaded hypervisor in memory, its code is also executed, and it also interferes with the operation of the OS and individual programs.  When executing an extraneous code on a computer, the execution time of commands is distorted, and an attack by time becomes feasible. <br><br>  The performance attack is based on a decrease in the performance of the user computer when executing a foreign code on it. <br>  The ‚ÄúRed Pill‚Äù countermeasures method is based on counting the number of interrupt vector tables in computer RAM.  This method can adequately work only on systems with a single processor core. <br><br>  The actual method of detecting a thin hypervisor can be considered control of the composition and characteristics of the equipment.  A working hypervisor, for complete control over the user computer, must completely virtualize the work of operating the OS with the equipment.  Due to the diversity and differences in the characteristics of the equipment, a thin hypervisor must have a huge set of sub-modules for working with equipment.  In this case, you can rely on the same reaction time and performance of individual equipment when searching for a hypervisor.  Naturally, all analysis should be conducted on a secure computer or cloud. <br><br>  For example, when checking the RAM of a user computer, its volume will decrease when a thin hypervisor is running.  Some security experts have expressed the view that during checks of this kind, the hypervisor can unload itself from memory, thereby hiding from the antivirus.  With such actions of the hypervisor, standard methods of anti-malware software become available: disk scanning, signature analysis, analysis of boot areas, etc. <br><br>  It is worth paying attention to the technology of dynamic changes in the performance of processors, buses, memory and storage devices.  In modern portable computers, there are many technologies designed to save energy when working on batteries, reduce noise and heating equipment.  In most cases, these technologies dynamically change the performance of a computer to achieve the desired effect.  In such cases, the interpretation of statistical data received from the client should be modified to reflect changing performance (input of correction factors).  In this paper, issues of dynamic changes in computer performance are not considered, because they do not affect the demonstration of the presented approaches and algorithms. <br><br>  A time attack, a performance attack, the Red Pill counter method, equipment control, all these methods of detecting the work of a thin hypervisor will seriously repel malware when properly implementing an antivirus and making an infection decision system in a secure environment, such as a cloud. <br><br><h4>  findings </h4><br>  The advantages of cloud antivirus include: <br><ul><li>  Security of the decision making environment; </li><li>  Improved performance; </li><li>  Reduced response time to new threats; </li><li>  Maintaining the relevance of the database of threats; </li><li>  Accelerated introduction of new anti-malware tools; </li><li>  Hidden decision making logic; </li><li>  The inability to verify the effectiveness of masking a new malware without entering information about it in the database of cloud threats; </li><li>  Minimize false positives. </li></ul><br>  There are also disadvantages too; many of them arise due to the use of cloud computing, so all the drawbacks of cloud computers are inherent in cloud anti-virus systems: <br><ul><li>  Problems downloading network connections on slow links; </li><li>  Impossibility of effective anti-virus scanning by user request without a serious increase in the number of client calls to the cloud; </li><li>  The inoperability of the anti-virus system in the absence of a connection to the cloud (local computer, without connecting to the network). </li></ul><br>  As you can see, the advantages of cloud anti-virus systems are much greater.  The current accelerated development of telecommunications networks will make most of the problems of using cloud computing irrelevant.  Also a very big advantage is the secure runtime created.  It allows you to bring modern anti-virus tools to a new level in the fight against modern threats. <br><br>  List of used sources <br><ol><li>  The blue pill concept <a href="http://ru.wikipedia.org/wiki/Blue_Pill">ru.wikipedia.org/wiki/Blue_Pill</a> </li><li>  The concept of "red pill" <a href="http://ru.wikipedia.org/wiki/Red_Pill">ru.wikipedia.org/wiki/Red_Pill</a> </li><li>  Ilyin, Stepan.  Cloud computing against viruses <a href="http://www.xakep.ru/magazine/xa/130/034/1.asp">www.xakep.ru/magazine/xa/130/034/1.asp</a> </li><li>  Krupin, Andrei.  Cloud Antivirus <a href="http://www.computerra.ru/terralab/softerra/424961">www.computerra.ru/terralab/softerra/424961</a> </li><li>  Krupin, Andrei.  Cloud antiviruses in theory and practice <a href="http://www.3dnews.ru/software/cloud-ativiruses-1">www.3dnews.ru/software/cloud-ativiruses-1</a> </li><li>  About cloud computing <a href="http://www.parallels.com/ru/spp/understandingclouds">www.parallels.com/ru/spp/understandingclouds</a> </li><li>  Mashevsky, Yuri.  Anti-virus weather forecast: cloudy <a href="http://www.antivirus-navigator.com/articles/kaspersky-cloud.htm">www.antivirus-navigator.com/articles/kaspersky-cloud.htm</a> </li><li>  A small study of self-defense products Dr.  Web <a href="http://habrahabr.ru/blogs/virus/110508">habrahabr.ru/blogs/virus/110508</a> </li><li>  Antivirus self-defense <a href="http://habrahabr.ru/blogs/virus/98322">habrahabr.ru/blogs/virus/98322</a> </li><li>  Fredrick Brooks.  Mythical man-month or how software systems are created.  Publisher "Symbol Plus", 2001. </li><li>  Whistler Bootkit <a href="http://habrahabr.ru/blogs/virus/96850">habrahabr.ru/blogs/virus/96850</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/121197/">https://habr.com/ru/post/121197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../121188/index.html">Youtube removed its logo from the videos</a></li>
<li><a href="../121189/index.html">Haskell Quest Tutorial - Forest</a></li>
<li><a href="../121190/index.html">Transfer of GPS data (NMEA) from Android to Windows</a></li>
<li><a href="../121193/index.html">Creation of another casual game on a Flash platform with physics. Part I</a></li>
<li><a href="../121195/index.html">Release eyeOS 2.5 webOS</a></li>
<li><a href="../121199/index.html">Ended the last qualifying round of Google Code Jam 2011</a></li>
<li><a href="../121201/index.html">Google eBookstore introduced the ability for children to draw on books</a></li>
<li><a href="../121202/index.html">About the benefits of prefixes</a></li>
<li><a href="../121203/index.html">When antivirus is powerless</a></li>
<li><a href="../121206/index.html">Pavel Durov on new privacy settings</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>