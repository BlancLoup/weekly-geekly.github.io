<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HighLoad in the platform for online auto parts stores</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the past topic, we promised to talk about the internal structure of our platform www.abcp.ru (SaaS solution). Today we will tell about the most int...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HighLoad in the platform for online auto parts stores</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/nodasoft/blog/250721/"><img src="https://habrastorage.org/getpro/habr/post_images/230/d05/09c/230d0509cee9c9f4f17477aa70666c01.jpg" alt="image"></a> <br><br>  In the <a href="http://habrahabr.ru/company/nodasoft/blog/249871/">past topic,</a> we promised to talk about the internal structure of our platform <a href="http://www.abcp.ru/">www.abcp.ru</a> (SaaS solution).  Today we will tell about the most interesting module of the platform - warehouses for storage of price lists. <a name="habracut"></a><br><br><h4>  How was the beginning? </h4><br>  Already in the second year of the platform, we were faced with growing customer needs in the volume of price list lines that need to be stored in a database.  At this point, the data was simply stored in one table of ordinary MySQL.  It turned out that a typical store wants to connect 7 million items of goods to its store, but cannot pay more than 5,000 rubles a month.  We were not ready for such a turn, either technically or economically, so we kept our customers as best we could, and at that time we developed a storage system that could withstand large amounts of data (up to 50 billion records). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To constrain system performance with data growth, we performed many software optimizations and even bought serious Hewlett-Packard StorageWorks storage systems for 25 thousand euros, where we placed our MySQL database (calculated on the high speed of the disk system), but these improvements were not long enough was going on. <br><br>  As it turned out, the stress phase for our team will last more than two years.  If we knew the real terms of development, it would be a strong blow to our motivation.  But we did not know :) So we did it all. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b2/25c/85a/7b225c85a59a9df3a1ab6cf20494d1cf.png" alt="image"><br><br><h4>  Choosing a solution </h4><br>  The input data was as follows: the system should keep a lot of records (determined that 50 billion will be more than enough), about half of this data can be updated daily.  It is necessary to achieve decentralization in data storage and to allow partial degradation in case of problems with the equipment. <br><br>  At that time, we only knew about HighLoad that it‚Äôs very cool, that there are some conferences on this topic and that the Internet is full of interesting articles.  It was fashionable to use solutions in NoSQL projects, say words like ‚Äúsharding‚Äù and all that.  We also knew that Oracle is a very powerful database that can scale, and therefore considered such an option. <br><br>  After much suffering, we dropped: <br><br><ol><li>  Powerful Oracle Subd.  Since  it is expensive and it is difficult. </li><li>  Many different real NoSQL.  Since  at that time, they were not reliable enough or could not withstand the requirements of the mixed reading / update load. </li></ol><br>  As a result, won the usual MySQL (innoDB).  Proven solution, free, many professionals.  We have already stepped on all the rakes with it, so for our team this DBMS was ideal for creating a new version of storing price lists with the stated characteristics.  The word ‚Äúsharding‚Äù also helped us. <br><br><h4>  And that's what we did </h4><br>  The new price list storage system is a distributed version based on simple, inexpensive and understandable MySQL, which we use in NoSQL mode, i.e.  just INSERT, UPDATE, DELETE and SELECT.  Without any JOIN and with the minimum quantity of conditions in WHERE. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1fa/4bd/908/1fa4bd9085872b34f6d68e1320b3996b.png" alt="image"><br><br>  At the moment, the service stores ~ 750 million records of goods sold.  During the day, sellers completely update one third of the information (~ 250 million records).  The number of UPDATE operations is about 10 times greater than the number of SELECT operations.  The speed of filling / updating prices in the service at the moment is 30,000 positions per second, which makes it possible to update the aforementioned ~ 250 million in 10% of the daily time. <br><br>  The scheme looks like a reference example of the horizontal scaling of the database, but, of course, everything inside the new service is much more complicated.  For faster updates, separate modules (also in sharding format) were developed to convert the zoo of price lists into a reference format, and separate diff services that calculate the difference between price lists (this works faster than a full price list update). ).  Another solution that fully justified itself was the implementation of the RabbitMQ server as the ‚Äúheart‚Äù of the system.  The very use of asynchronous queues prompted our team to a number of ideas that would significantly speed up the operation of the system. <br><br>  Of course, we have achieved excellent economic performance.  For example, if we significantly expand the position storage subsystem in warehouses, then the monthly cost of storing / using one million items will be ~ 100 rubles.  Even with the current exchange rate. <br><br>  Also, selecting the most optimal equipment for the created modules, we received an additional economic gain of about 10-20%. <br><br>  If you are developing projects in the field of auto parts trade, you can use our API to store price lists and search for them (access is available upon request). <br><br>  For today, see you in the next topic! </div><p>Source: <a href="https://habr.com/ru/post/250721/">https://habr.com/ru/post/250721/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../250709/index.html">Monitoring Methods in DWDM Systems (Part 2)</a></li>
<li><a href="../250711/index.html">Studying the project folder structure in Unity - version control systems</a></li>
<li><a href="../250715/index.html">Wide Search (BFS) in C #</a></li>
<li><a href="../250717/index.html">Last night amazon fell in europe</a></li>
<li><a href="../250719/index.html">Implementing messaging between browser tabs</a></li>
<li><a href="../250723/index.html">Ara, yes? Or the modular smartphone of the future</a></li>
<li><a href="../250725/index.html">Results of testing algorithms of Russian biometric companies in the world market</a></li>
<li><a href="../250727/index.html">DIY Math Package for Android</a></li>
<li><a href="../250729/index.html">How to simplify the verification of a bank card holder for online payments?</a></li>
<li><a href="../250731/index.html">JMeter: Forget Beanshell Sampler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>