<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Drupal 7 - Module for subscribing to new materials by email</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 I know about the existence of modules SimpleNews, Notifications, etc. There are even instructions on how to do this with existing modules. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Drupal 7 - Module for subscribing to new materials by email</h1><div class="post__text post__text-html js-mediator-article"><h6>  Foreword </h6><br>  <i>I know about the existence of modules SimpleNews, Notifications, etc.</i>  <i>There are even <a href="http://xandeadx.ru/blog/drupal/706">instructions on</a> how to do this with existing modules.</i>  <i>It seems to me that there is too much to do in order to make the simplest email list available on the site.</i>  <i>I decided to correct this situation a little.</i>  <i>The module does not claim to originality and genius.</i>  <i>I wanted to make the module easy to configure and use.</i> <br><br><h4>  Email Subscribe module </h4><br><h5>  Page with module settings: </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/e69/bff/3c5/e69bff3c5475ba13e39071c9284d0f4f.gif"><br><a name="habracut"></a><br>  Here you can configure the following parameters: <br><ul><li>  an email address from which users will receive letters; </li><li>  types of materials that are included in the list; </li><li>  mailing interval; </li><li>  the number of letters sent in one cron launch; </li><li>  letter templates for new content notification, email confirmation, subscription cancellation, subscription renewal. </li></ul><br><h5>  Page with the list of subscribed users: </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/cb5/9cd/224/cb59cd224dc4edf828aa8aef8d130b68.gif"><br><br><h4>  Algorithm of the module </h4><br>  There is a table: <br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> <span class="hljs-string"><span class="hljs-string">`email_subscribe_readed_nodes`</span></span> ( <span class="hljs-string"><span class="hljs-string">`rn_id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">bigint</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> AUTO_INCREMENT <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Field ID'</span></span>, <span class="hljs-string"><span class="hljs-string">`rn_nid`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Node ID'</span></span>, <span class="hljs-string"><span class="hljs-string">`rn_sid`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Subscribe user id'</span></span>, <span class="hljs-string"><span class="hljs-string">`rn_status`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">smallint</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'0-email don'</span></span>t send, <span class="hljs-number"><span class="hljs-number">1</span></span>-email has been sented.<span class="hljs-string"><span class="hljs-string">', `datechange` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '</span></span><span class="hljs-built_in"><span class="hljs-built_in">Date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">change</span></span><span class="hljs-string"><span class="hljs-string">', PRIMARY KEY (`rn_id`), KEY `rn_nid` (`rn_nid`), KEY `rn_sid` (`rn_sid`), KEY `rn_status` (`rn_status`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;</span></span></code> </pre> <br><ul><li>  When you confirm your email or create a new material, this table is populated with values ‚Äã‚Äãfrom node ID and subscription user ID. </li><li>  When you confirm email, all materials currently published for the current user are marked as read. </li><li>  When creating a material, the created material is marked for each reader as not read. </li><li>  When you run cron, email is sent to users who have unread materials, and this material is marked read. </li></ul><br><h4>  User interface </h4><br>  There is a block and a page with a subscription form.  You can turn off the menu link because, it seems to me, the block is more convenient.  The block is disabled by default.  The user enters an email address and then there are several scenarios: <br><ul><li>  If the user has not been previously registered, an email is sent to him with a link to an email confirmation; </li><li>  If the user has not confirmed the email, they will be asked to reconfirm their email; </li><li>  If the user is subscribed, they will be asked to cancel the subscription; </li><li>  If the user canceled the subscription, you will be prompted to renew the subscription. </li></ul><br>  In all cases, the user is sent an email with a link to confirm the selected action. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Waiting for comments and suggestions. <br><br>  The module is under BSD licenses.  The source code on <a href="https://github.com/servekon/drupal7_email_subscribe">Github</a> and <a href="https://drupal.org/sandbox/servekon/2172267">in the sandbox on drupal.org</a> . <br><br>  <b>UPD:</b> <br>  Fixed a small bug: for registered users, the default subscription form was their email, for anonymous users there was an error that the $ user object does not have a mail property. <br>  <b>UPD 2:</b> <br>  Fixed bug: in the form of subscription $ form ["# action"] was relative, not absolute (the slash was lost). <br>  <b>UPD 3:</b> <br>  Slightly changed the algorithm for filling the ‚Äúemail_subscribe_readed_nodes‚Äù table.  Previously, only published materials were included; now, non-published ones with ‚ÄúNot read‚Äù status are also included. <br>  <b>UPD 4 dated 03/20/2015:</b> <br>  Updated to version 1.0.3.2. <br>  <b>UPD 5 of 03/26/2015:</b> <br>  <a href="https://habrahabr.ru/post/208854/">Updated to version 1.0.3.3</a> . <br>  <b>UPD 5 from 12/24/2015:</b> <br>  <a href="https://habrahabr.ru/post/208854/">Updated to version 1.0.4</a> . <br>  <b>UPD 6 of 12/12/2016:</b> <br>  <a href="https://habrahabr.ru/post/208854/">Updated to version 1.0.5</a> . <br>  <b>UPD 7 dated 1/18/2017:</b> <br>  <a href="https://habrahabr.ru/post/208854/">Updated to version 1.0.5.1</a> . </div><p>Source: <a href="https://habr.com/ru/post/208854/">https://habr.com/ru/post/208854/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208836/index.html">200 milliseconds of freedom</a></li>
<li><a href="../208840/index.html">The digest of interesting news and materials from the world of PHP No. 33 (January 1 - January 12, 2014)</a></li>
<li><a href="../208844/index.html">CES 2014: Budget Thermal Imager from Smartphone</a></li>
<li><a href="../208846/index.html">How to get 36 terabytes in the cloud for free and forever</a></li>
<li><a href="../208852/index.html">Business-oriented storage systems ETERNUS DX S3</a></li>
<li><a href="../208856/index.html">How endless scrolling in mobile applications destroys content consumption</a></li>
<li><a href="../208858/index.html">Chef for beginners</a></li>
<li><a href="../208862/index.html">Where articles are bought and who writes them</a></li>
<li><a href="../208864/index.html">NAVIA - unmanned electric vehicle</a></li>
<li><a href="../208866/index.html">Deploy using Salt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>