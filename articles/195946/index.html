<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Integration of TecDoc DB with an online auto parts store</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The writing of the article was the result of working in a rather interesting project, the result of which should be an online store, with the possibil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Integration of TecDoc DB with an online auto parts store</h1><div class="post__text post__text-html js-mediator-article">  The writing of the article was the result of working in a rather interesting project, the result of which should be an online store, with the possibility of linking the nomenclature to the <a href="http://www.tecdoc.de/russia/">‚ÄúTecDoc‚Äù</a> parts catalog. <br>  ‚ÄúTecDoc‚Äù product is a kind of database that includes not only links between manufacturers of spare parts and specific parts of a catalog, but also contains images of goods, as well as the recommended price and, most importantly, the ability to search for analogues. <br><br><a name="habracut"></a><br>  To link the site with the catalog ¬´TecDoc¬ª, its database had to be downloaded to MySQL.  We will not dwell on this, since this information can be found on the World Wide Web without problems. <br><br>  This online store sells parts for cars. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The basis of the online store - CMS <a href="http://www.hostcms.ru/">"HostCMS"</a> .  Since the customer had a license for this CMS, he had to work, so to speak, with what is.  Although out of the box, this product can also please with its capabilities. <br><br>  The main refinement of the online store is the possibility of linking the goods to the catalog - the ‚ÄúTecDoc‚Äù database, taking into account that the nomenclature can be downloaded either from the price list in the * .xls format, or manually - through the control panel of the site. <br><br>  For the user, there are tools to find the product in the store: <br><ul><li>  By name and company </li><li>  According to the original number from TecDoc, </li><li>  According to the internal catalog number of the online store, </li><li>  By category tree, </li><li>  And most importantly using the tool "Your car". </li></ul><br><br>  Now for more details on solving each of the tasks. <br><br><h2>  Import goods. </h2><br>  The very first task was to load a new item from the generated price list. <br>  Since the price list was in the * .xls format, and there is no ready tool for working with this format in this CMS - it was decided to use <a href="http://phpexcel.codeplex.com/">‚ÄúPHPExcel‚Äù</a> <br>  "PHPExcel" is a fairly handy tool that allows you not only to read data from a file, but also to generate its own files. <br><br>  In order for everything to look beautiful, we created a module in the control panel of the site and displayed a link to it in the list of installed modules. <br>  After clicking on the link, the form for downloading the file is displayed to the administrator.  If you look at this part from the programmer's side, everything is standard, that is, a form has been created, the file is received, renamed, and transferred to the correct directory.  It is advisable to add all sorts of checks like file type, protection against "XSS", etc. <br><br>  In the form, the administrator selects a file that should successfully upload to the server. <br>  So the file is uploaded to the server.  Now we have two options: <br>  1. Run the entire file for processing.  A good option, but if there are tens of thousands of records there, then the import process will be uncontrollable. <br>  2. The second option, we used it. <br>  2.1 After downloading a file, the number of filled lines is determined. <br>  2.2 Generated script that sends line numbers for processing <br>  2.2.1 Import process is displayed in percent <br>  2.2.2 The result of import is displayed in the form of a table growing down during the import. <br>  2.3 From the resulting table, the administrator can see the result and possible actions on each item. <br>  For specifics, here is an example of products from the price list. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/2e6/f60/6c7/2e6f606c72b12856fac952edc055647b.png"></a> <br><br>  When the script sends line numbers to be processed, we will receive an array of properties for each item.  That is, each line in the price list corresponds to a separate product, and for this product we pull out properties such as price, quantity, analogs of the ‚ÄúTecDoc‚Äù catalog, etc. <br>  If you need to create a tool in which the price list fields can change, you should write an identifying attribute in the first row of each column (for example, 'V.numb', 'Name.manufacturer', etc.), and the second line will be the title for columns.  As a result, the import will have to start from the third line.  And before importing, we need to determine the fields we need, based on the identification attributes. <br><br>  Our further steps are to link the internal number to the catalog goods of the store and the TecDoc base. <br>  1. Search the catalog by internal number <br>  2. If the product is found, the characteristics for it are updated (such as prices and quantity) <br>  3. If the product is not found in the store do a search on "TecDoc" <br>  3.1 If for a given original number and corresponding to it analogues found 1 product go to the "addition of a new product" <br>  3.2 If several products are found, we display a link to ‚Äúselect one of the goods‚Äù <br>  3.3 If the product is not found, we give a link to "the choice of any product" <br>  3.4 If there are several products or none have been found, then we make modifications to the analogue records (deleting unnecessary characters or splitting into an array, when there are several numbers in the same field, separated by the symbol ‚Äú/‚Äù). If, after performing operations with values, one position is found, we perform ‚Äú adding a new product " <br>  4. ‚ÄúAdding a new product‚Äù - a new product is created in the catalog, based on the fields in the price list, the missing properties of the product receive default values.  The entry ‚ÄúAdded‚Äù appears in the result table. <br>  5. "Select one of the goods" - a dialog box, is the result of the script.  The script is activated by clicking on the product, for which several positions are found in TecDoc.  It accepts the found ‚ÄúTecDoc‚Äù position numbers, and allows you to select the necessary one among them: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/861/a5a/94b/861a5a94ba291393c6177b3b1276f2d3.png"><br><br>  6. "Select any product" - the dialog box is the result of the script.  The script is activated by clicking on the product, for which no positions were found in TecDoc and allows you to select the necessary part among all manufacturers: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e66/c9f/fdf/e66c9ffdf29e64260c1853ebb67664f2.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b0/846/69e/9b084669e03e69b78ffcb316cdfad4c9.png"><br><br>  Appearance of the module: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/294/a46/868/294a46868e23218436c583f53c811d35.png"><br><br><br>  Import process: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b65/75d/787/b6575d787ec99cf7f769ba8a8efcbf4c.png"><br><br><br><br><h2>  MySQL </h2><br>  All queries can be found using the search on the Internet. <br>  The given queries were modified for the specialization of a particular task, as well as for optimizations.  But much can be understood by reviewing the following tasks: <br><br>  <b>Task 1. Search for image address</b> <br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> CONCAT(GRA_TAB_NR, <span class="hljs-string"><span class="hljs-string">'/'</span></span>,GRA_GRD_ID, <span class="hljs-string"><span class="hljs-string">'.'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(LOWER(DOC_EXTENSION)=<span class="hljs-string"><span class="hljs-string">'jp2'</span></span>, <span class="hljs-string"><span class="hljs-string">'jpg'</span></span>, LOWER(DOC_EXTENSION))) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-type"><span class="hljs-type">PATH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> LINK_GRA_ART <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> GRAPHICS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> GRA_ID = LGA_GRA_ID <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> DOC_TYPES <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> DOC_TYPE = GRA_DOC_TYPE <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> LGA_ART_ID = @ARTICLE <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> (GRA_LNG_ID = <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> GRA_LNG_ID = <span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> GRA_DOC_TYPE &lt;&gt; <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> GRA_GRD_ID</code> </pre> <br><br>  Add the path to the image catalog, make the existence check, resize - if needed, and you can safely display it on the site. <br><br>  <b>Task 2. Search for analogues:</b> <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ARL_KIND, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> (ART_LOOKUP.ARL_KIND = <span class="hljs-number"><span class="hljs-number">2</span></span>, SUPPLIERS.SUP_BRAND, BRANDS.BRA_BRAND) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> BRAND, ARL_DISPLAY_NR <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ART_LOOKUP <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> BRANDS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> BRA_ID = ARL_BRA_ID <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> ARTICLES <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> ARTICLES.ART_ID = ART_LOOKUP.ARL_ART_ID <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> SUPPLIERS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> SUPPLIERS.SUP_ID = ARTICLES.ART_SUP_ID <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ARL_ART_ID = @ART_ID <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> ARL_KIND <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ARL_KIND, BRA_BRAND, ARL_DISPLAY_NR <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span></code> </pre><br>  This request can be used when importing goods, slightly modify it in order to verify the compliance of this product and its counterparts. <br><br>  <b>Task 3. Displaying information about the product</b> <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ART_ARTICLE_NR, SUP_BRAND, DES_TEXTS.TEX_TEXT <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ART_COMPLETE_DES_TEXT, DES_TEXTS2.TEX_TEXT <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ART_DES_TEXT, DES_TEXTS3.TEX_TEXT <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ART_STATUS_TEXT <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ARTICLES <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> DESIGNATIONS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> DESIGNATIONS.DES_ID = ART_COMPLETE_DES_ID <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> DESIGNATIONS.DES_LNG_ID = @LNG_ID <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> DES_TEXTS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> DES_TEXTS.TEX_ID = DESIGNATIONS.DES_TEX_ID <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> DESIGNATIONS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DESIGNATIONS2 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> DESIGNATIONS2.DES_ID = ART_DES_ID <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> DESIGNATIONS2.DES_LNG_ID = @LNG_ID <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> DES_TEXTS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DES_TEXTS2 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> DES_TEXTS2.TEX_ID = DESIGNATIONS2.DES_TEX_ID <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> SUPPLIERS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> SUP_ID = ART_SUP_ID <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> ART_COUNTRY_SPECIFICS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> ACS_ART_ID = ART_ID <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> DESIGNATIONS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DESIGNATIONS3 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> DESIGNATIONS3.DES_ID = ACS_KV_STATUS_DES_ID <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> DESIGNATIONS3.DES_LNG_ID = @LNG_ID <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> DES_TEXTS <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DES_TEXTS3 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> DES_TEXTS3.TEX_ID = DESIGNATIONS3.DES_TEX_ID <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> ART_ID = @ART_ID;</code> </pre><br><br>  Do not forget about @LNG_ID - and put there a value, for example equal to 16, for the Russian language. <br><br><br><h2>  Search for goods. </h2><br>  <b>Catalog</b> <br>  The easiest option is when a visitor enters the catalog, he is listed on all the products, divided into pages.  Here, I think, there are no questions.  The programmer displays all the products catalog. <br><br>  <b>Filtration</b> <br>  As a filter, you can create a category tree, and allow the visitor to navigate in it.  For example: <br>  -Cars <br>  --Body <br>  --- Body Parts / Fender / Buffer <br>  --- Glazing / mirrors <br>  --- Covers / hoods / doors / sliding roof / folding roof <br>  --- Additional headlight / accessories <br>  --- Lighting system / alarm <br>  --Engine <br>  --- Gaskets <br>  ---Lubrication system <br>  ---Cylinder head <br>  --- Air supply system <br>  - Release system <br>  --- Installation details <br>  --- Carbamide injection <br>  --- Silencer Assembly <br>  ---Catalyst <br>  ---The Lambda probe <br><br>  And now when choosing a filter to display, only those parts of the catalog that are associated with this category, that is, we add filtering by category, thanks to the binding to the position from ‚ÄúTecDoc‚Äù.  Updating the list of products in the catalog when choosing a filter can be done both dynamically using Ajax and with updating the page. <br>  Below is the query that displays the tree subcategories for the category cars (10001): <br><br><pre> <code class="php hljs">SELECT STR_ID, STR_ID_PARENT, TEX_TEXT <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> STR_DES_TEXT, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(EXISTS( SELECT * FROM SEARCH_TREE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> SEARCH_TREE2 WHERE SEARCH_TREE2.STR_ID_PARENT &lt;=&gt; SEARCH_TREE.STR_ID LIMIT <span class="hljs-number"><span class="hljs-number">1</span></span> ), <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DESCENDANTS FROM SEARCH_TREE INNER JOIN DESIGNATIONS ON DES_ID = STR_DES_ID INNER JOIN DES_TEXTS ON TEX_ID = DES_TEX_ID WHERE STR_ID_PARENT &lt;=&gt; <span class="hljs-number"><span class="hljs-number">10001</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> DES_LNG_ID = <span class="hljs-number"><span class="hljs-number">16</span></span>;</code> </pre><br><br><br>  Since the query will be executed literally on each page of the directory, it is desirable to add its result to the cache.  Yes, and in general, should study the bottlenecks, giving a large load and delay. <br>  The ‚ÄúCaching‚Äù module in this CMS can be very useful.  Although if you look around, then probably any framework will allow you to cache the most loaded places on the site. <br><br>  <b>Search by internal number</b> <br>  This section will not cause questions, because here we check the product number, and if it exists, we will display the page of this position.  You can add this section by auto-filling when entering the article number for the user. <br><br>  <b>Search by original number</b> <br>  It seems that we have everything to solve this problem.  We can easily display all the products in the catalog, taking into account the original number or the number of its analogue, added to the additional properties of the product. <br>  But‚Ä¶ <br>  The speed of execution of such a query is rather slow  Even using all sorts of optimizations for the MySQL server, the result is distressing. <br><br>  <a href="http://sphinxsearch.com/">‚ÄúSphinx‚Äù</a> (search engine) was used more than once in projects, and this technology always allowed only to improve the project.  And this time when using ‚ÄúSphinx‚Äù we were surprised: <br><ul><li>  Easy integration and customization. </li><li>  Indexing speed. </li><li>  And finally, the search speed. </li></ul><br><br>  Corrected the configuration file for the needs of the project, re-indexed, and the search speed really increased, compared with the absence of "Sphinx". <br><br>  <b>Keyword Search</b> <br>  Since the problem in speed was with the original number, it was decided that the main search should also be done using the ‚ÄúSphinx‚Äù technology. <br>  In addition, this technology allows you to use: <br><ul><li>  additional attributes when searching, </li><li>  distributed search </li><li>  Russian language support </li><li>  create multiple indexes. </li></ul><br><br>  By the way, at the beginning of the project, your car tool was mentioned. <br>  This tool allows you to select a single vehicle modification from the entire TecDoc catalog and view all products related to this vehicle anyway. <br>  The tool is a set of fields that are updated dynamically depending on the choice of the previous field.  For example, after choosing the car's production year, the available car brands are selected, then choose the model and type of engine.  The result of his work is shown below: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/681/8c7/593/6818c7593606c19ec116e8e6c4cd1108.png"><br><br>  As a result, the main modifications of this car are displayed, among which we choose the one we need.  After selecting a car, the catalog will open, but your car will already be the filter, and the site should remember the user's car and allow them to switch between them and choose a new car. <br><br><h2>  Summarize </h2><br>  Despite the high threshold of entry, the task was not difficult, but routine.  In order to write this module we can advise the study of the following approaches, technologies and tools: <br><ul><li>  OOP without him, it will be difficult here ... </li><li>  Basis, so to say the backbone of the site <a href="http://www.mysql.com/">"MySQL"</a> , <a href="http://php.net/">"PHP"</a> , <a href="http://ru.wikipedia.org/wiki/HTML">"HTML"</a> , <a href="http://ru.wikipedia.org/wiki/JS">"JS"</a> , <a href="http://ru.wikipedia.org/wiki/CSS">"CSS"</a> . </li><li>  Understanding the principle of the CMS "HostCMS" </li><li>  Ability to work with the "API" of other developers </li><li>  Search "Sphinx" </li><li>  Ability to investigate the loaded sites of the site and optimize the code </li><li>  Desirable <a href="http://jquery.com/">"jQuery"</a> or <a href="http://prototypejs.org/">"Prototype"</a> </li><li>  And naturally, it‚Äôs true that the ability to work with some kind of ‚ÄúIntegrated Development Environment‚Äù is debatable. </li></ul><br><br>  And most importantly, a similar result can be achieved without the use of ready-made engines, but, for example, on your own autos-catalog of cars or on the Internet store, developed using frameworks. <br><br>  PS As a supplement, I cite a couple of scripts from the project that are at least inconclusive, well, you can understand the essence of them. <br>  <b>The script responsible for splitting the process into requests is responsible for adding from the list, as well as informing about the import process:</b> <br><pre> <code class="php hljs">&lt; script&gt; <span class="hljs-comment"><span class="hljs-comment">// knum1,knum2,knum3,knum4,knum5 -   // inum -   // pz,pr -  // lim -  // wh1, wh2 -    // count -  // art_id -   //name -    //num_fnd -   tecDoc var from = 3; var to = 3; var percent = 0; var chk = 0; var cond = ''; function get_list(fromf,tof) { $.post( "/admin/import_excel_new/get_list.php", { from: fromf, to: tof },outputt ); function outputt(data) { if(chk == 0) { from += 1; to += 1; percent = ( from / cond ) * 100; } else { from = cond; percent = ( from / cond ) * 100; } if ((to - cond) &gt; 0) { to = cond; chk = 1; get_list(from,to); to = 0; }else if((to - cond) == 0) { chk = 1; get_list(from,to); to = 0; } document.getElementById("perc").innerHTML=percent.toFixed(2)+"%"; $("#progressbar").children(".ui-progressbar-value").css("width", percent+"%"); document.getElementById("tab_cont").innerHTML+=data; if(chk == 1) { $("#progressbar").css("display", "none"); $("#progresspercent").css("display", "none"); } if ( chk == 0) { get_list(from,to); //setTimeout(get_list, 100, from, to); } } } alert("   ,       !"); get_list(from,to); function createWindow(count,art_id,inum,knum1,knum2,name,knum3,knum4,knum5,wh1, wh2,pz,pr,num_fnd,lim) { $.post( "/admin/import_excel_new/get_tab.php", { id: art_id, num_fnd: num_fnd },outputt2 ); function outputt2(data) { document.getElementById("inum").innerHTML=inum; document.getElementById("cntnt").innerHTML=data; document.getElementById("btn").innerHTML="&lt;input type=\"button\" name=\"add\" id=\"add_id\" style=\"float:right; margin-top:5px;\" value=\"\" onclick=\"insert_item(\'"+count+"\', \'"+inum+"\',\'"+knum1+"\',\'"+knum2+"\',\'"+name+"\', \'"+knum3+"\',\'"+knum4+"\',\'"+knum5+"\',\'"+wh1+"\', \'"+wh2+"\',\'"+pz+"\',\'"+pr+"\',\'"+num_fnd+"\', \'"+lim+"\')\" /&gt;"; } document.getElementById("open_block").style.display="block"; } function loadNum() { bnum = document.getElementById("brand_id").value; $.post( "/admin/import_excel_new/get_number.php", { num: bnum },outputt11 ); function outputt11(data) { document.getElementById("list_num").innerHTML=data; } } function insert_item(count,inum,knum1,knum2,name,knum3,knum4,knum5,wh1,wh2,pz, pr,num_fnd,lim) { if (document.getElementById("opt_id_1").checked === true) art_id=document.getElementById("art_list_id").value; else if (document.getElementById("opt_id_2").checked === true) art_id=document.getElementById("txtnum_id").value; if(document.getElementById("txtnum_id").value!="") { $.post( "/admin/import_excel_new/insert_item.php", { count: count, id: art_id, inum: inum, knum1: knum1, knum2: knum2, name: name, knum3: knum3, knum4: knum4, knum5: knum5, wh1: wh1, wh2: wh2, pz: pz, pr: pr, num_fnd: num_fnd, lim: lim },outputt3 ); function outputt3(data) { document.getElementById("id_"+inum).innerHTML="&lt;span style=\'color:green;\'&gt;&lt;/span&gt;"; document.getElementById("id_opt_"+inum).innerHTML="&lt;a style=\"cursor:pointer; text-decoration:underline; color:#0090ff;\" onclick=\"createWindow(\'1\',\'"+data+"\', \'"+inum+"\',\'"+knum1+"\',\'"+knum2+"\',\'"+name+"\',\'"+knum3+"\',\'"+knum4+"\',\'"+knum5+"\', \'"+wh1+"\',\'"+wh2+"\',\'"+pz+"\',\'"+pr+"\',\'"+num_fnd+"\',\'"+lim+"\')\"&gt;&lt;/a&gt;"; } } document.getElementById(\'open_block\').style.display=\'none\'; } &lt;/ script&gt;</span></span></code> </pre><br>  <b>The function of adding goods based on the part number and manufacturer</b> <br><pre> <code class="php hljs">&lt; ?php <span class="hljs-comment"><span class="hljs-comment">// $DataBase -    // $knum1,$knum2,$knum3,$knum4,$knum5 -   // $inum -   // $pz,$pr -  // $user -   // $date -  // $lim -  // $wh1, $wh2 -    // $nameProizvoditel, $numberProizvod -  ,    function addToCatalogForNoTecdoc($DataBase,$knum1,$knum2,$knum3,$knum4, $knum5,$inum,$pr,$user,$date,$pz,$lim,$wh1,$wh2,$nameProizvoditel,$numberProizvod){ $symbols = array("`"," ", "~", "!", "@", "#", "$", "%", "^", "&amp;", "*", "(", ")", "-", "_", "=", "+", "/", "\\", "|", "?", ":", ";", "\"", "'", "‚Ññ", ",", "."); $numberProizvodVithSymbols = str_replace($symbols, '', $numberProizvod); $nameProizvoditelUpper=strtoupper($nameProizvoditel); $query = " SELECT DISTINCT IF (ART_LOOKUP.ARL_KIND IN (3, 4), BRANDS.BRA_BRAND, SUPPLIERS.SUP_BRAND) AS brand, ART_LOOKUP.ARL_SEARCH_NUMBER AS NUMBER, `ARL_ART_ID` AS item_id, `ARL_SEARCH_NUMBER` AS num_fnd, `DES_TEXTS`.`TEX_TEXT` AS item_txt FROM ART_LOOKUP LEFT JOIN BRANDS ON BRANDS.BRA_ID = ART_LOOKUP.ARL_BRA_ID INNER JOIN ARTICLES ON ARTICLES.ART_ID = ART_LOOKUP.ARL_ART_ID INNER JOIN SUPPLIERS ON SUPPLIERS.SUP_ID = ARTICLES.ART_SUP_ID INNER JOIN DESIGNATIONS ON DESIGNATIONS.DES_ID = ARTICLES.ART_COMPLETE_DES_ID INNER JOIN DES_TEXTS ON DES_TEXTS.TEX_ID = DESIGNATIONS.DES_TEX_ID WHERE ART_LOOKUP.ARL_SEARCH_NUMBER = '".$numberProizvodVithSymbols."' AND ART_LOOKUP.ARL_KIND IN (1, 2, 3, 4) AND DESIGNATIONS.DES_LNG_ID = 16 AND (BRANDS.BRA_BRAND='".$nameProizvoditelUpper."' OR SUPPLIERS.SUP_BRAND='".$nameProizvoditelUpper."') GROUP BY brand, NUMBER ;"; $result1 = $DataBase-&gt;query($query); $row1 = mysql_fetch_array($result1); echo '&lt;div class="'.$inum.'" style="display: none;"&gt;&lt;b&gt;'; var_dump($query); echo '&lt;/b&gt;'; echo '&lt;pre&gt;'; var_dump($row1); echo '&lt;/pre&gt;&lt;/div&gt;'; $art_id=$row1["item_id"]; $txt = $row1['item_txt']; $brand = $row1['brand']; $rez=array(); if($row1){ $rez['status']=true; }else{ $rez['status']=false; } if($rez['status']){ // $DataBase-&gt;Insert('shop_items_catalog_table', array( 'shop_currency_id' =&gt; '4', 'shop_shops_id' =&gt; '3', 'shop_items_catalog_name' =&gt; $brand.': '.$txt, 'shop_items_catalog_marking' =&gt; $art_id, 'shop_vendorcode' =&gt; $knum1, 'shop_extension' =&gt; $inum, 'shop_items_catalog_price' =&gt; $pr, 'users_id' =&gt; $user, 'shop_items_catalog_date_time' =&gt; $date, 'shop_items_catalog_putoff_date' =&gt; $date, 'shop_items_catalog_weight'=&gt;0 )); $last_id = mysql_insert_id(); // function addToMarking($DataBase,$marking_id, $vendor_id){ if(trim($vendor_id)!="" &amp;&amp; $vendor_id!=" "){ $DataBase-&gt;Insert('marking', array('marking_id' =&gt; $marking_id, 'vendor_id' =&gt; $vendor_id)); } } addToMarking($DataBase,$art_id, $numberProizvod); addToMarking($DataBase,$art_id, $knum1); addToMarking($DataBase,$art_id, $knum2); addToMarking($DataBase,$art_id, $knum3); addToMarking($DataBase,$art_id, $knum4); addToMarking($DataBase,$art_id, $knum5); // function addToShop_warehouse_items_table($DataBase,$shop_warehouse_id, $shop_items_catalog_item_id, $shop_warehouse_items_count, $users_id){ if(trim($vendor_id)!="" &amp;&amp; $vendor_id!=" "){ $DataBase-&gt;Insert('shop_warehouse_items_table', array( 'shop_warehouse_id' =&gt; $shop_warehouse_id, 'shop_items_catalog_item_id' =&gt; $shop_items_catalog_item_id, 'shop_warehouse_items_count' =&gt; $shop_warehouse_items_count, 'users_id' =&gt; $users_id )); } } $whResult=0; if(trim($wh1)!=""){ $whResult=$wh1; }else{ $whResult=0; } addToShop_warehouse_items_table($DataBase,4, $last_id, $whResult, $user); if(trim($wh2)!=""){ $whResult=$wh2; }else{ $whResult=0; } addToShop_warehouse_items_table($DataBase,3, $last_id, $whResult, $user); addToShop_warehouse_items_table($DataBase,5, $last_id, 0, $user); function addToShop_prices_to_item_table ($DataBase,$last_id, $prices, $p){ $DataBase-&gt;Insert('shop_prices_to_item_table', array('shop_items_catalog_item_id' =&gt; $last_id, 'shop_list_of_prices_id' =&gt; $prices, 'shop_prices_to_item_value' =&gt; $p)); } // addToShop_prices_to_item_table ($DataBase,$last_id, 4, $pz); addToShop_prices_to_item_table ($DataBase,$last_id, 5, $pr); // $DataBase-&gt;Insert('shop_properties_items_table', array('shop_items_catalog_item_id' =&gt; $last_id, 'shop_list_of_properties_id' =&gt; 155, 'shop_properties_items_value' =&gt; $lim)); $param = array(); $param['item_id'] = $last_id; $param['path'] = 'item_' . $last_id; $DataBase-&gt;Update('shop_items_catalog_table', array('shop_items_catalog_item_id' =&gt; $param['item_id'], 'shop_items_catalog_path' =&gt; $param['path'] ), " `shop_currency_id` = '4' and `shop_shops_id` = '3' and `shop_items_catalog_name` = '".$brand . ': ' . $txt."' and `shop_items_catalog_marking` = ".$art_id ." and `shop_vendorcode` = '".$knum1."' and `shop_extension` = '".$inum."' and `shop_items_catalog_price` = ".$pr." " ); // $img=getImgForARTid($DataBase,$art_id); if($img) { $DataBase-&gt;Insert('shop_properties_items_table', array('shop_items_catalog_item_id' =&gt; $last_id, 'shop_list_of_properties_id' =&gt; 164, 'shop_properties_items_value' =&gt; $img)); } $img=''; } $rez['str_item']=$art_id; $rez['str_num_find']=$row1["num_fnd"]; return $rez; } </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br><br><br>  <b>PS</b> To receive our new articles before others or simply not to miss new publications - subscribe to us on <a href="http://www.facebook.com/SECLGROUP">Facebook</a> , <a href="http://vk.com/seclgroup">VK</a> , <a href="https://twitter.com/SECL">Twitter</a> , <a href="http://secl-adv.livejournal.com/">LiveJournal</a> and <a href="http://www.linkedin.com/groups/SECL-GROUP-3940132">LinkedIn</a> <br><br>  <b>PPS</b> Very soon the course starts in our business school Digitov: <a href="http://digitov.com/course/programming-Junior-PHP-Developer-courses">I want to become Junior PHP Developer!</a>  Subscribe to the course now and you can buy it at a discount. <br><br>  Article prepared <br>  Vladimir, Middle PHP Developer, <a href="http://seclgroup.ru/">SECL Group</a> <br>  Nikita, CEO, <a href="http://seclgroup.ru/">SECL Group</a> </div><p>Source: <a href="https://habr.com/ru/post/195946/">https://habr.com/ru/post/195946/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../195934/index.html">Migrating to Chef Server 11</a></li>
<li><a href="../195938/index.html">KINS client part leaked</a></li>
<li><a href="../19594/index.html">Flood as foreboding. Documentary.</a></li>
<li><a href="../195942/index.html">Impressions of forty days of open source daily work on GitHub.</a></li>
<li><a href="../195944/index.html">We do not need your coffee</a></li>
<li><a href="../195948/index.html">Lock-free data structures. Basics: Atomicity and atomic primitives</a></li>
<li><a href="../19595/index.html">V-IM [Vkontakte Instant Messanger]</a></li>
<li><a href="../195950/index.html">Fast tracks on google maps</a></li>
<li><a href="../195954/index.html">New configuration of dedicated servers</a></li>
<li><a href="../195956/index.html">Old typewriter with Arduino and Raspberry Pi as a printer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>