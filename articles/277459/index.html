<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automating stock purchases: large transaction processing architecture</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A short background: a few years ago we were able to achieve the appearance on the Russian market of ETF financial instruments - clusters of stocks. Th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automating stock purchases: large transaction processing architecture</h1><div class="post__text post__text-html js-mediator-article">  A short background: a few years ago we were able to achieve the appearance on the Russian market of ETF financial instruments - clusters of stocks.  The most fun part after the legal coordination of this whole story with the state (more precisely, the states, given that the calculations are checked through Dublin, and our 6 data centers are located in London) was IT integration with bridges between exchanges in different countries. <br><br>  <b>Fortunately, we were not the first to solve this problem, and there were already ready-made ‚Äúlibrary solutions‚Äù.</b>  However, we took the file and started modifying the existing systems. <a name="habracut"></a><br><br><h4>  What is the problem from the point of view of the financial market? </h4><br>  You want to buy our ETF on the aggregate of IT companies on the world market, say, for 100 thousand rubles - as a portfolio investment next to your bank account.  You have a bank of those that conduct brokerage activities, and you already have the opportunity to make the necessary purchases directly through the Internet bank or application.  And you see prices for all securities - ‚Äúglass‚Äù.  Prices suit you, and you send a purchase request. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Since the sum of 100 thousand rubles is almost ridiculous for the bank, nothing further happens.  Your broker takes and buys securities at the stated price on the secondary market, that is, from someone else who is on the stock exchange and sells their securities.  This Brownian motion takes place constantly and without stopping.  There is no "I can not buy because no one has" - it happens "I can not buy at such and such a price."  And I remind you that you already know the purchase price on your request. <br><br>  Transactions of less than 0.5-2 million dollars are made on the secondary market (mainly on the exchange), larger applications can be withdrawn from the fund directly through an authorized participant. <br><br><h4>  Big deal </h4><br>  Let me remind you, ETF is a security that represents a share of a cluster of companies' stocks.  For example, there is a legal entity in Ireland, which buys shares of only certain IT companies in a certain proportion (by index) - and ETF is the share of this legal entity.  This legal entity does not do anything else - there are neither staff, nor debts, nor management - such a ‚Äúbag for securities‚Äù filled with shares. <br><br>  Accordingly, when new ETFs are needed in the market, an authorized participant needs to make a DVP transaction (delivery-versus-payment, delivery versus payment): <br><ol><li>  Take money from the Russian market to a certain intermediate "cache" </li><li>  To assign the task of a robotic trading platform to buy new shares in the USA in exact accordance with the index. When generating new subscriptions, deals are made in London through the trading wing of FinEx Capital Management.  The purchase of securities is carried out by block transactions using the powerful automated trading platform Charles River, which gives simultaneous access to a dozen brokers through which you can purchase valuable stocks worldwide. </li><li>  Ensure that everything is done correctly (stocks are only those that make up the index) with the help of a custodian depository - BoNY (assets worth $ 30 trillion in custody). </li><li>  Cluster these stocks as new ETFs in Euroclear. </li><li>  Transfer money through an international bridge to the settlement center of Ireland, and the ETF to the Russian depository (NSD). </li><li>  After clearing (information of all calculations), you will in fact return the money ‚Äúfrozen‚Äù earlier and receive in return pointers to securities in your account. </li></ol><br><br><h4>  Where do ETFs come from for transactions of less than $ 0.5-2 million? </h4><br>  ETFs can be put on the secondary market by traders (professional participants or private traders) who are ready to give ETF or other securities at certain prices.  As a rule, first such a feeder is a market maker who signs new shares with the help of BNY Mellon, and then sells it on the market.  The target amount of shares that the market maker must offer is determined when the fund is launched.  That is, to start trading, you must first ensure this standard-set amount, which guarantees some transactions.  Later on, various private investors and funds are added on top of this volume, which ‚Äúrevolve around‚Äù in free movement. <br><br>  As soon as we otlitinga (that is, became compatible with domestic systems for IT and the legal part), we are immediately obliged by law and the stock exchange to put the market maker and give it liquidity.  In the case of an ETF, liquidity is limited by the capacity of the primary asset (ETF MSCI Information Technology). <br><br>  Our main market maker is one of the world leaders Goldenberg Hehmeyer, with a narrow spread on the market.  We have a clear agreement with the IB about the target spread (the difference between the purchase and sale prices).  Accordingly, market makers constantly move ruble stock quotes and set a ‚Äúglass‚Äù based on the prices of shares included in the index, the target spread. <br><br>  If you need a lot and fast - you go to an authorized participant and buy at a price determined closer to the close of the day.  Further, the scheme works out with the release of new ETFs (but you pay about $ 500 for Bony for the entire transaction hemorrhoids). <br><br><h4>  So what's up with integration? </h4><br>  So, in London, we have an ETF provider that can do fill ETFs with shares of different companies, collecting them into a cluster in accordance with the index.  For example, do an ETF for IT companies.  In Ireland, a cash bag filled with stocks is registered (40% of European funds are created in Ireland, because there is the most pleasant legislation for collective investment).  There is also an independent organization verifying each transaction that stores and controls assets - the custodian depository (Bank of New York Mellon). <br><br>  In the <a href="https://habrahabr.ru/company/finex/blog/277455/">previous post,</a> I talked about the terrible IT-bridges between countries - all this does not concern us, because we do not even look at the transport level, all this is done by the Moscow Exchange.  We are ‚Äúon API‚Äù, that is, through the Quick platform, we knock there and give instructions. <br><br><img src="https://habrastorage.org/files/502/25f/47e/50225f47e23144d8b51df3adaa839c3f.png" alt="image"><br><br><h4>  "Last mile" </h4><br>  If you want to start selling ETF portfolios directly to customers, we do all of the tasks in terms of back office and accounting systems through Kvik (which can do some basic things, but not full accounting), but through the domestic Turbo9 system.  This is a software for accounting transactions and accounting rights of many customers.  By and large - an analogue of 1C, only for securities.  Turbo9 is integrated with Kvik - the system receives information from it and distributes the papers, rights and obligations between customers.  And through it, orders are made.  The client sends a request to us, we put it in Turbo9, Turbo9 gives it on our behalf to Quick, picks up the ETF from the exchange to us (this is a process that includes checking Boni and other things in London and Ireland, but for Quik this is already "black box "), And then Turbo9 transfers the paper to a specific client.  This is the essence of brokerage. <br><br>  All this could be done directly, but, I remind you, the goal was to reduce the level of costs.  After all, the advantage of ETF as opposed to active trading is to repeat the index as well as possible.  As a result, a small number of staff needed to manage a large document flow.  Let me remind you, we are now 10 people. <br><br>  Turbo9 was not chosen by chance.  Some of our specialists worked with her in other brokerage and management companies, and they knew exactly what and how it should be.  Plus, we knew where the developers live and what the name of their children is. <br><br>  At the very beginning, we compared Turbo9 with BackQORT.  It can be said that both systems have comparable implementation costs, basic accounting organization functionality and the ability to integrate with other information systems.  But Turbo9 is more flexible from the point of view of the implementation of the functionality that is not included in the box.  In the process of implementation, we had to solve a number of specific tasks: to build a unique process of rebalancing portfolios with our own calculation algorithm, the ability to conduct consolidated transactions with their subsequent distribution to end customers, full integration with the personal account on the site, including identification in the ESIA, two-way exchange of electronic copies of documents use of electronic signature to sign them.  Opportunities Turbo9 allowed to realize this in a short time.  The same electronic signature by other means would have been solved for almost a year - and here we have the opportunity to develop new features, ‚Äúincrementing‚Äù modules to the main system due to a very well thought-out architecture. <br>  You can also note a lower cost of ownership Turbo9 compared with a similar solution based on BackQORT.  Pay attention, it is possession, not implementation. <br><br><h4>  Total </h4><br>  We raised our own Turbo9 accounting system for the ‚Äúlast mile‚Äù.  Then they used a standard platform for the API of the Moscow Exchange.  In order to work with the exchange, it was necessary to create a market-maker and give it the necessary liquidity, and then to be listed in NSD.  The Moscow Exchange routes all resources through NSD and international bridges, in our case through Euroclear.  Bondi's Custodian from London scans every ‚Äúintra protocol‚Äù transaction at the top level of the transport stack.  Shares are also purchased ‚Äúinside the protocol‚Äù.  Warranties are given by NSD Euroclear and Barclays Bank. <br><br>  Bottom line - one order for the purchase of ETF in Russia launches a huge automated chain consisting of many subsystems.  Now you understand about how cunning it works. <br><br>  By the way, answering the frequent question of why we do not keep the Russian development office - in our country there is a serious prejudice against the work of a developer in the financial structure.  The reason is very simple: tests are made "for slaughter", that is, the day of the code can actually be tested for six months with the active participation of the developer.  This is an incredibly boring, dull, repetitive job with a bunch of regulations that discourage many from banks. <br><br><h4>  And now links </h4><br><ul><li>  About <a href="http://habrahabr.ru/company/finex/blog/271449/">why you need only 10 people</a> to manage an asset of billions of dollars (IT infrastructure in Habr√©) </li><li>  <a href="http://geektimes.ru/company/finex/blog/266186/">What is ETF</a> (buying a piece of a cluster of shares of T + 2) </li><li>  <a href="http://habrahabr.ru/company/finex/blog/273651/">IT risks when buying stocks</a> </li><li>  <a href="http://geektimes.ru/company/finex/blog/268314/">Why I do not believe in banks in 15 years</a> </li><li>  <a href="https://geektimes.ru/company/finex/blog/269368/">How to buy a piece of Google from Russia, and what are the pitfalls</a> </li><li>  <a href="https://habrahabr.ru/company/finex/blog/277455/">How financial bridges work between countries</a> </li><li>  And <a href="http://geektimes.ru/company/finex/blog/268086/">what generally traded on the stock exchange and why prices change so quickly</a> . </li></ul></div><p>Source: <a href="https://habr.com/ru/post/277459/">https://habr.com/ru/post/277459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277449/index.html">Web file manager Sprut.IO in OpenSource</a></li>
<li><a href="../277451/index.html">Dynamic data binding in HTML and JS</a></li>
<li><a href="../277453/index.html">Neon: Node + Rust</a></li>
<li><a href="../277455/index.html">How is the "compatibility" of financial transactions on rough IT-examples</a></li>
<li><a href="../277457/index.html">We test the layout correctly</a></li>
<li><a href="../277461/index.html">Traits out of the box</a></li>
<li><a href="../277463/index.html">Xeon Phi: Why do coprocessors use to create trading applications</a></li>
<li><a href="../277465/index.html">Initialized controllers in symfony and working with annotations</a></li>
<li><a href="../277467/index.html">The new locker "Locky"</a></li>
<li><a href="../277471/index.html">What's new in Windows Server 2016 RDS. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>