<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Counting objects in a binary image. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="annotation 
 This article is written in the continuation of the first part of the article about working with binary images, which describes how to cou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Counting objects in a binary image. Part 2</h1><div class="post__text post__text-html js-mediator-article"><h4>  annotation </h4><br><img src="https://habrastorage.org/storage/habraeffect/07/29/0729d01d8aecca1dfa71c3e867ec44da.png" alt="image" align="left">  This article is written in the continuation of the <a href="http://habrahabr.ru/blogs/image_processing/119244/">first part of the</a> article about working with binary images, which describes how to count objects.  However, there is little confusion from a single count, often I want to know some geometrical parameters of recognizable objects.  It seems that there is to count - I recognized the number of eights - the area is 19, I calculated the number of sevens - the area is 7 (see the picture in the Annotation). <br>  Doing so, we will be forced to use an additional pass through the image, it is desirable to avoid this - in favor of increasing the efficiency of implementation.  As planned, this topic describes how to calculate the geometric characteristics of objects without an additional pass. <br>  And also: the form factor and the roses of Guido Grande and the difference between a square and a rectangle, and it is different from a star. <a name="habracut"></a><br><br>  <b>Previous parts of the article:</b> <br>  <a href="http://habrahabr.ru/blogs/image_processing/119244/">Part 1</a> <br><br><h4>  Counting objects and calculating geometric features </h4><br><img src="https://habrastorage.org/storage/habraeffect/ee/93/ee9322493c4f7ad5a5bd699652e35246.png" alt="image" align="left">  At the very beginning we will deal with the area.  In the <a href="http://habrahabr.ru/blogs/image_processing/119244/">previous article</a> , 5 positions of the ABC-mask were considered, the fifth position included the merging of two marked-up connected areas, which turned out to be under different but equivalent numbers. <br>  Add to the source code - in each of the conditional positions the following logic: <br><ul><li>  For positions from 1st to 5th: they should increase the area of ‚Äã‚Äãthe object with the current mark by one. </li><li>  For the 5th position, in addition, when regions are combined under equivalent numbers B and C, we perform S (B) = S (B) + S S. </li></ul><br>  For brevity, I will give the source script code only with new lines in each of the positions. <br><blockquote>  <font color="black"><font color="#0000ff">if</font> A == 0 <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">elseif</font> B == 0 &amp; C == 0 <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">/.../</font> <font color="black"><br></font>  <font color="black">Squares (cur) = Squares (cur) + 1;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">elseif</font> B ~ = 0 &amp; C == 0 <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">/.../</font> <font color="black"><br></font>  <font color="black">Squares (B) = Squares (B) + 1;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">elseif</font> B == 0 &amp; C ~ = 0 <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">/.../</font> <font color="black"><br></font>  <font color="black">Squares ¬© = Squares ¬© + 1;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">elseif</font> B ~ = 0 &amp; C ~ = 0 <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">Squares (B) = Squares (B) + 1;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">if</font> B == C <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">Im (i, j) = B;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">else</font></font> <font color="black"><br></font>  <font color="black">/.../</font> <font color="black"><br></font>  <font color="black">Squares (B) = Squares (B) + Squares ¬©;</font> <font color="black"><br></font>  <font color="black">Squares ¬© = 0;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">end</font></font> <font color="black"><br></font>  <font color="black">/.../</font> <font color="black"><br></font>  <font color="black">end</font> <br>  <font color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br>  <b>Listing 1</b> - Changes in the script code for calculating the area of ‚Äã‚Äãmarked objects. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Counting the perimeter of the object is a little more complicated.  As in the situation of area if B == 0 or C == 0 <br>  we also need to increase the perimeter.  However, this will not be enough.  Let us introduce another ABC mask, the same corner (black mask in the figure), but inverted by 180 degrees (purple mask in the figure).  This will add to us three more possible situations, but they should be considered only within the framework of position number 5. <br><blockquote>  <font color="black"><font color="#0000ff">elseif</font> B ~ = 0 &amp; C ~ = 0 <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">Squares (B) = Squares (B) + 1;</font> <font color="black"><br><br></font>  <font color="black"><font color="#0000ff">if</font> B == C <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">Im (i, j) = B;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">else</font></font> <font color="black"><br></font>  <font color="black">Im (i, j) = B;</font> <font color="black"><br></font>  <font color="black">Im (Im == C) = B;</font> <font color="black"><br></font>  <font color="black">Squares (B) = Squares (B) + Squares ¬©;</font> <font color="black"><br></font>  <font color="black">Squares ¬© = 0;</font> <font color="black"><br></font>  <font color="black">Perimetrs (B) = Perimetrs (B) + Perimetrs ¬©;</font> <font color="black"><br></font>  <font color="black">Perimetrs ¬© = 0;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">end</font></font> <font color="black"><br><br></font>  <font color="black">A = Im (i, j);</font> <font color="black"><br></font>  <font color="black">kn = j + 1;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">if</font> kn&gt; n <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">kn = n;</font> <font color="black"><br></font>  <font color="black">B = 0;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">else</font></font> <font color="black"><br></font>  <font color="black">B = Im (i, kn);</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">end</font></font> <font color="black"><br><br></font>  <font color="black">km = i + 1;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">if</font> km&gt; m <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">km = m;</font> <font color="black"><br></font>  <font color="black">C = 0;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">else</font></font> <font color="black"><br></font>  <font color="black">C = Im (km, j);</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">end</font></font> <font color="black"><br><br></font>  <font color="black"><font color="#0000ff">if</font> B == 0 &amp; C == 0 <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">Perimetrs (A) = Perimetrs (A) + 1;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">elseif</font> B ~ = 0 &amp; C == 0 <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">Perimetrs (A) = Perimetrs (A) + 1;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">elseif</font> B == 0 &amp; C ~ = 0 <font color="#0000ff">then</font></font> <font color="black"><br></font>  <font color="black">Perimetrs (A) = Perimetrs (A) + 1;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">end</font></font> <font color="black"><br><br></font>  <font color="black"><font color="#0000ff">end</font></font> <br>  <font color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br>  <b>Listing 2</b> - Changes in the script code for counting the perimeter of the object. <br><br>  Summarizing this principle, it can be argued that using the ABC mask and object marking algorithm, any geometric signs that have the property of linearity when merging regions can be calculated, that is, let object 3 consist of two parts: Obj3 = Obj1 + Obj2, then its sign F (Obj3) = F (Obj1) + F (Obj2).  An example of this could be the center of gravity of an object. <br><br><h4>  Form factor </h4><br>  From school, we all know that for any geometric figure you can calculate the area and perimeter.  For example, for a <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D0%25BA%25D1%2580%25D1%2583%25D0%25B6%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D1%258C">circle, the</a> formulas look like <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/5e/29/5e2999dded2067eebf8c822578d10628.png" alt="image"></div><br>  Consider the interesting relationship (3), which binds in itself both the area and the perimeter - this is one of the types of form factors.  Substituting into it the appropriate formulas for the area and perimeter of a circle, it is easy to understand that for circles of any radius the form factor is 0. <br>  However, everything is quite simple for a circle, but what about more complex shapes?  In the article we will look at the so-called <a href="http://en.wikipedia.org/wiki/Luigi_Guido_Grandi">Guido Grande</a> roses (Figure 1). <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/55/e0/55e08679612cad0bde9b7d09ea061c0f.png" alt="image"></div><br>  <b>Figure 1</b> - The set of Guido Grande roses. <br><br>  For ease of implementation, so as not to get involved in the polar coordinate system, I redid the initial formulas for Cartesian coordinates (4), but they are <b>not equivalent to the</b> initial construction rules, but the result is similar and suitable for our purposes (Figure 1). <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/4e/df/4edf391039e7d950d7fcddf9c1b427c0.png" alt="image"></div><br>  How does the form factor (3) behave depending on the variable parameter of the rose?  This is demonstrated in the graph in Figure 2. <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/4b/2d/4b2d1ed475fb99aee556b76504a62d82.png" alt="image"></div><br>  <b>Figure 2</b> - Form factor (3) of the Guido-Grandi rose along the horizontal axis depending on the variable parameter along the vertical axis. <br><br>  A linear relationship becomes obvious; I am sure that it has an analytical record and the formula for this can be derived quite easily.  but let it be a little puzzle for readers. <br>  As a result, using a simple relationship between the area and the perimeter, we received a sign by which to <b>identify the</b> figure - to recognize.  In practice, this feature is only one of many in the feature vector.  Since it is even resistant to homothety distortions (similarity, scale), but due to errors in the contour of the figure generated by binarization and quantization, it is calculated with an accuracy of + (-) 0.15, while varying the radius of the rose. <br><br>  Now let's see how to distinguish squares and rectangles using this attribute.  For brevity, only an illustration is shown - Figure 3. <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/f2/26/f226854fe3d408884952410bad6fe719.png" alt="image"></div><br>  <b>Figure 3</b> - Changing the form factor when extruding a square into a rectangle. <br>  Here the dependence is already non-linear, it is obvious from the analytical formula. <br><br>  There are many similar heuristic factors of the form, which include the compactness of the figure. <br><br><h4>  Conclusion </h4><br>  <a href="">Here</a> you can download the SciLab script for your experiments, which includes: <br><ul><li>  Construction of the contour of stars. </li><li>  Fill using the algorithm from <a href="http://habrahabr.ru/blogs/image_processing/116374/">this article.</a> </li><li>  Marking and counting area and perimeter. </li><li>  Calculation of the form factor. </li></ul><br>  The archive is encrypted with the password, which is specified in the first comment, I apologize for such inconveniences, but this is for the purpose of protection from copy-pasters, which, as a rule, do not copy comments. <br><br>  Thanks to all who read, waiting for your comments.  If someone is familiar with the literature where form factors are described, I ask you to give references, I could not find anything before publication in order to have self-criticism. <br><br>  <b>UPD:</b> 06/06/11 15:28 </div><p>Source: <a href="https://habr.com/ru/post/119706/">https://habr.com/ru/post/119706/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../119696/index.html">Likester. Facebook Trends</a></li>
<li><a href="../119697/index.html">Creating a simple 3D application with ShiVa3D</a></li>
<li><a href="../119699/index.html">Tron lightcycle: Tron style PC modding</a></li>
<li><a href="../119700/index.html">LW cryptography: ciphers for RFID systems</a></li>
<li><a href="../119703/index.html">MongoDB features</a></li>
<li><a href="../119707/index.html">Free Windows images for testing sites in Internet Explorer</a></li>
<li><a href="../119711/index.html">How to finish the game</a></li>
<li><a href="../119712/index.html">Super-brand secrets: Apple (translation)</a></li>
<li><a href="../119720/index.html">Laptop Review Lenovo ThinkPad X220</a></li>
<li><a href="../119721/index.html">CSS3 sprite animation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>