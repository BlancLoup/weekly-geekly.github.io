<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Protecting the site from spammers and account hijacking</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will not be anything fundamentally new, but some will be very interested in the view from the spammer (already former) with experience. T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Protecting the site from spammers and account hijacking</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage3/f88/adc/a35/f88adca35698118af0b6ba6c49ba44fb.jpg" alt="image" align="right">  This article will not be anything fundamentally new, but some will be very interested in the view from the spammer (already former) with experience.  The idea to write on Habr came long ago, after reading <a href="http://habrahabr.ru/post/151084/">this article</a> , which only caused a smile.  It so happened that a long time ago, at the time of studying at the university, I was looking for remote work, because it is difficult to survive on a stipend, not to mention some kind of entertainment.  Then one friend invited me to a company where he worked himself.  The work was simple - to leave links to certain sites anywhere, adding a message to them, i.e.  regular spam  Here, as you understand, absolutely no captcha, checking cookies or javascript will save the situation, since a real person is registered using a regular browser.  Regarding automatic spam, the situation is similar if they are scripted browser versions.  However, there are ways to make life difficult for spammers and, if not completely removed, then significantly reduce the flow of spam to your site. <br><br clear="left"><a name="habracut"></a><br>  When I wrote that I was a former spammer, I did not mean that I completely changed my occupation.  Now I am the author of one of the browser automation systems, the name of which I will not name, so as not to be considered for advertising.  However, some situations will be somehow connected with this program, since most protection circumvention methods are decided at the engine level and such protection ceases to be protection once and for all (I apologize for the tautology). <br><br><h4>  Protection from hitting the site in the resource base </h4><br>  The resource base is a huge trashcan with a list of sites on which you can potentially build a link.  Such databases are used to refuel all spamming programs that will try to do their dirty work.  The success rate is not very high, about 5-10% (depending on the quality of the base), however, having a million sites in the database (and this is not even a big base), you can get 50,000-100,000 links, which is already a lot.  Naturally, this is not done at one time, since the site in the blink of an eye will be in the search engines bath, but you can build and gradually promote more than one site at a time.  But this is another question, and we return to the topic.  The most popular and logical way to search for sites for databases is the correct use of all the same search engines.  And sites are searched for footprints (distinctive features) of their platforms.  For example, a spammer once managed to leave a link on a site that uses WordPress.  He decides to add as many similar sites as possible to his resource base, he opens google and enters something like ‚Äúinurl: wp-login.php‚Äù, after which you can safely add sites to your base (of course, all this is done automatically).  If he needs a specific subject, for example, "real estate", then the request will be: "real estate inurl: wp-login.php".  Adding such keywords can also bypass the search engine limit on the maximum number of displayed results.  Hence the logical conclusion: get rid of footprints.  For popular CMS there are a lot of plugins that make ‚Äúbeautiful links‚Äù - use them.  Also, do not forget to remove ‚ÄúPowered by blah-blah‚Äù from the site‚Äôs footers, and if you want to pay tribute to the developers, change the text or replace it with a picture. <br>  Of course, there are more sophisticated ways in which spammers make up the base, but their review itself will draw on the article.  If society shows interest in this issue, then perhaps I will write about everything in much more detail. <br><br><h4>  Linkbuilder protection </h4><img src="https://habrastorage.org/storage3/270/8b9/d33/2708b9d339302b1b98d803519aae2717.jpg" align="right"><br>  Linkbuilders are people who are supposed to make quality spam.  Their peculiarity is that they pass practically everywhere where, according to the idea, only a person must pass.  The productivity of linkbuilders is much lower than that of programs, and is about 40 links per day.  They try to answer thematic questions in the comments, from which their identification is often difficult. <br>  The most radical step to protect against them will be the introduction of message moderation.  It can be facilitated by any rules, such as "moderation only messages with links" or "moderation of users who have messages less than 5".  I would also add moderation by the date of registration, the spammer is unlikely to remember your site after 5 days or so. <br>  If any moderation is unacceptable for you, you can often stop the spammer during the registration phase.  Most spammers use the so-called "temporary mail" services.  The most famous and popular among them is mailinator.  Its popularity is due to the fact that it is referred to by thousands of domains that are not in open sources, and you can also add your own.  Those.  The spammer buys (or registers a free) domain, links it to the mailinator and gets its own mail server, with which it can send spam until the domain reaches the spam database.  However, such domains can be detected, since  their MX Record refers to the one-time mail service.  MX Record of native domains does not refer to the service, but redirects to it when a GET request is made.  It does not hurt to check the ownership of mail domains to such services.  If you don‚Äôt want an extra load on your servers, do these JavaScript checks, although this will lower the level of protection, but linkbilders are rarely intelligent and well, if they know such a word. <br>  And, of course, I will not forget to add such services as ‚Äúblack lists‚Äù.  They check for IP and Email in their spam databases, connect using a simple API, and provide good basic protection. <br>  It is also quite important to not show the spammer that you know that he is a spammer.  If your triggers have identified a spammer, you do not need to display him in big red letters about what bad things he does - he will simply change the proxy / mail and try again.  A reasonable solution would be to display a pseudo service message, for example, ‚ÄúTechnical work is being done, registration is temporarily disabled‚Äù or to simulate some kind of a 500th error (Internal Error). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Spam protection </h4><br>  This item can be divided into two plausible scenes: your site is only one of the vast base of the spammer and your site is the goal.  In the first case, everything is quite simple: just remove the footprints, slightly correct the registration page (more on that later) and, most likely, no one will break through.  It is much harder to protect against mass registration if the spammer needs a lot of accounts on your site.  In the article to which I referred at the beginning, there is a share of common sense, but only a share.  It is known that captcha is not a guarantee of protection against bots for a long time, there are a lot of services where all your captchas are solved by Hindus for a penny.  But removing the captcha from the registration page is a very stupid decision, since registration will not only be absolutely free for the spammer, but also incredibly quick (the Hindu captcha solution takes an average of 30 seconds).  As for the hidden fields, then, for example, in my program it has long been taken into account that in the automatic mode you only need to fill in the visible fields that have a non-zero height and width.  Thus, even those spammers who do not know anything about it easily bypass this ‚Äúprotection‚Äù.  In addition to the methods described earlier, as well as telephone validation (which I do not consider at all for obvious reasons), I can advise only one really very difficult to work around: captcha, where you need to perform some kind of action, like putting together a simple puzzle.  A good example of such a captcha is PlayThru. <br>  Do not interfere even customize the registration page.  It is unlikely that an ordinary user will read the source code, so why call the fields (here I mean the attributes ‚Äúname‚Äù and ‚Äúid‚Äù) with such obvious names as ‚Äúusername‚Äù, ‚Äúemail‚Äù?  Any self-respecting program will cope with this form of registration in automatic mode.  The desirable minimum is to make these attributes simply unreadable or swap them specifically (for example, the login field is called ‚Äúemail‚Äù).  But it is possible (and desirable) to go even further - to make these attributes dynamic.  You ask how the server handles dynamic parameter names?  I can offer hidden input with an encryption key algorithm known only to you.  Thus the sequence is as follows: <br>  The server generates a random key -&gt; The server encrypts the names of the attributes -&gt; The user receives a page with encrypted input attributes and hidden input with your key -&gt; When submitting the form, the server decrypts the attributes and determines which one is responsible for what. <br>  But, in order for this approach to work by 100%, the fields must be of the same size, type, displayed in random order on the page and, preferably, add one or more fields "Leave this field blank."  And the final touch will be the use of images of the same size and dynamic address instead of the label. <br>  But you can go even further and not transfer the hidden key values ‚Äã‚Äãdirectly to the input, but provide it with a JavaScript function dynamically generated on the server that should return the necessary key.  This will negate any attempts to register with the help of programs that stupidly send POST requests. <br>  Of course, this is all complicated, but it will perfectly protect your site with little or no inconvenience to real users. <br><br><h4>  And what about the authorization form? </h4><br>  It all depends on the site.  Many do not understand why in the Habr√©, to log in, you should always enter the captcha.  I agree that this is bad form, but it is one of two ways I know of how to protect your accounts.  Such methods take place where some privileges can be tied to an account, which should not be available to everyone by default.  On Habr√© it invites, on some other sites - money or pegged digital purchases.  Any account can hijack and no matter how difficult your password is.  They do this with the help of brute based on the purchased email: password type databases.  And the bases are sold in millions of lines for ridiculous money.  Mined, as far as I know, plums from various forums through SQL vulnerabilities.  So think about how many accounts you can spin with a database with real mail / login and password combinations.  In general, to protect yourself, ideally each site should have a different password.  Then, if the base of this site is drained, nothing threatens you.  To remember all the passwords, you can, for example, add a couple of letters from the name of the site on which you are registering to one main password.  But this is a completely different topic, and we will return to ours.  Brutus is carried out by sending POST requests to the authorization address and, if there is no such problem as a captcha, then all this will happen very quickly and, moreover, free of charge.  But if you add a captcha, then a brutal will take ten times more time and checking the base of 1 million lines will cost about $ 1,400.  But, as I wrote above, there is another way to protect the site without a captcha, which, oddly enough, seems to me more reliable.  Its essence is to bind to a specific browser and / or IP, and when the user logs in from another computer, then ask him to answer the secret question.  I have already met such implementations and, perhaps, habr developers should do something like that.  As an additional protection, you can use the encryption key trick, then creating a brute program for such a site would be theoretically possible, but extremely difficult. <br><br><h4>  At last </h4><br>  Very rarely I met sites that were really serious about protection, despite their colorful statements.  The accounts of such giants as Twitter, Skype, Sony, PayPal are very easily stolen, as evidenced by their extensive sales market.  It is much harder to hijack accounts, for example, VK or Google.  If the site does not have a mandatory confirmation of a mobile phone number, then write an autoregistrar is a matter of a couple of hours, no one goes further than adding hidden fields.  And in vain, I even imagine the terrible amount they spend manual cleaning. <br><br>  <b>UPD</b> <br>  As the <a href="http://habrahabr.ru/users/evocatus/" class="user_link">evocatus</a> user <a href="http://habrahabr.ru/users/evocatus/" class="user_link">suggested</a> , there is another method to determine brute, regardless of the proxy and user-agent.  Its essence is to check and compare installed plugins and fonts. </div><p>Source: <a href="https://habr.com/ru/post/197414/">https://habr.com/ru/post/197414/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197390/index.html">Office of the future on about. Russian - how we implemented IT systems</a></li>
<li><a href="../197392/index.html">"Boost.Asio C ++ Network Programming". Chapter 7: Boost.Asio - additional topics</a></li>
<li><a href="../197398/index.html">Imagination like that of esmeralda</a></li>
<li><a href="../197402/index.html">What gives startup IDCEE 2013 Startup Alley</a></li>
<li><a href="../197412/index.html">Samsung galaxy note 10.1 n8020 and yota</a></li>
<li><a href="../197416/index.html">Writing an HTML5 game in 20 minutes, or an introduction to the Phaser framework</a></li>
<li><a href="../197418/index.html">Techno Anarchism</a></li>
<li><a href="../197420/index.html">Meet the free and free font Imperial</a></li>
<li><a href="../197422/index.html">Convenient utilities for android</a></li>
<li><a href="../197424/index.html">Digging into the data as a degree of freedom</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>