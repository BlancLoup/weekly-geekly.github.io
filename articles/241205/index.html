<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How vGate helps in investigating security incidents in a virtual infrastructure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Modern virtual data centers, as a rule, are well protected from outside attacks. Traditionally, firewalls, antiviruses, IPS / IDS and other components...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How vGate helps in investigating security incidents in a virtual infrastructure</h1><div class="post__text post__text-html js-mediator-article">  Modern virtual data centers, as a rule, are well protected from outside attacks.  Traditionally, firewalls, antiviruses, IPS / IDS and other components are used in virtual infrastructures (VIs), but for some reason they often forget about attacks from the inside, completely trusting the administrators of the VIs.  At the same time, the specificity of the virtual infrastructure implies a greater number of privileged users compared to the physical environment, which automatically creates a separate group of incidents related to intentional (for example, copying protected information) or unintentional actions (for example, the administrator accidentally turned off the host) for the VI.  Thus, in the virtual infrastructure, it is necessary to control and restrict the access of privileged users, as well as to be able to retrospectively analyze their actions to detect and investigate incidents. <br><a name="habracut"></a><br><h4>  Stand </h4><br>  In order to show what incidents are possible in the virtual infrastructure, we deployed a virtual server on the VMware platform.  To protect the simulated VIs, use certified vGate R2.  Its main functions are: <br><ul><li>  control of access to various objects of VI through enhanced authentication and separation of powers between administrators of VI and IB administrators; </li><li>  protection of VMs and confidential data that is stored and processed on these machines; </li><li>  protection of VI in accordance with the requirements of regulators. </li></ul><br>  In addition, vGate has a number of tools that can be used to detect and investigate information security incidents.  Such mechanisms include ‚ÄúAudit‚Äù and ‚ÄúReports‚Äù.  About this in more detail. <br><br>  ‚ÄúAudit‚Äù in vGate logs security events (for example, unauthorized access to the infrastructure, creating or deleting VMs, changing VMs, etc.) and collecting them from all protected resources (ESX servers, VMware vCenter Server, vGate authorization server).  Using Audit, you can filter security events (by different categories), configure the list of logged events, send security events via SNMP / SMTP protocols, and maintain an event log in a text document. <br>  Using the "Reports", you can monitor the system and receive various reports, for example, on the most frequent information security events, access to the HMI during off-hours, attempts to unauthorized changes to the settings controlled by policies, access to VM files and control of the HI, and others. <br><br>  Next, we will try to simulate the actions of the attacker and show what incidents can occur in the virtual infrastructure and how they can be identified and investigated using vGate.  Our virtual stand consists of: <br><ul><li>  from a server with VMware vCenter and two ESXi hosts (host number 1 and host number 2); </li><li>  vGate authorization server (deployment option when routing is performed by vGate authorization server), which also houses the information security administrator's workstation (we will call it AIB for short); </li><li>  AWS of the administrator of virtual infrastructure No. 1 (AVI 1), which has access to confidential information (on the AWS, the vGate and VMware vSphere Client authentication agent is installed);  AWS of Administrator of Virtual Infrastructure No. 2 (AVI 2), which does not have access to confidential information (vGate and VMware vSphere Client authentication agent is installed on AWS). </li></ul><br><h4>  Simulated situations </h4><br><h5>  Incident number 1. Password selection </h5><br>  When trying to access the authentication server, AVI 1 receives the following message through an agent: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/31c/5f8/091/31c5f80914b045d8abacffb70df5f710.jpg"><br><br>  AVI asks for help from the AIB, which, applying filtering in audit events, found out that on the computer with IP 192.168.2.143 three attempts were made to enter the AVI 1 password (the number of attempts to enter a password incorrectly is configured by the vGate password policy) 1 has been blocked.  AIB knows that IP 192.168.2.143 belongs to AWP AVI 2. Thus, AIB found out that AVI 2 recognized the login of AVI 1 and tried to find the password for its account. <br><br><img src="https://habrastorage.org/files/870/4e9/513/8704e9513b58464daf43665db908d151.jpg"><br><br><img src="https://habrastorage.org/files/93a/136/103/93a1361035314089b50ed19ddb2865b4.jpg"><br><br><img src="https://habrastorage.org/files/bd1/b66/5c6/bd1b665c67db485385e70e98cf42e2ea.jpg"><br><br><img src="https://habrastorage.org/files/d51/63e/19e/d5163e19e97249d58bf47b186d5b358b.jpg"><br><br><h5>  Incident number 2. VM cloning </h5><br>  There was a leak of confidential information that was processed on the WIN7 virtual machine. The AIB filters events by categories: <br><br><img src="https://habrastorage.org/files/1c1/189/3a6/1c11893a690c43c6abe6d662896cb59e.jpg"><br><br>  And it finds in the list an event related to the WIN7 virtual machine: <br><br><img src="https://habrastorage.org/files/107/646/381/1076463814854d48ba432cfa8057fc25.jpg"><img src="https://habrastorage.org/files/549/179/19e/54917919ecc24bc5bdcf970215680362.jpg"><br><br>  He finds out that AVI 1 has cloned this VM, which requires further proceedings to clarify the reason for AVI 1‚Äôs actions. <br><br><h5>  Incident number 3. Violation of the integrity of the VM </h5><br>  VM1 virtual machine does not start, but personal data is processed on this machine and integrity monitoring is set for it in accordance with the security policies in effect in the organization.  The AIB filters audit events by the ‚Äútext contains‚Äù parameter and enters the name of the VM1 virtual machine. <br><br><img src="https://habrastorage.org/files/43c/64a/b63/43c64ab639564fc5bccfa910a3fe8b1c.jpg"><br><br>  It turns out that the integrity of the vmx file has been compromised, namely, the amount of RAM in the virtual machine has been changed. <br><br><img src="https://habrastorage.org/files/be5/b25/9b4/be5b259b4ea14e1180a185779a74115b.jpg"><br><br>  After reviewing earlier events, the AIB finds out that AVI 1 has changed the VM configuration. <br><br><img src="https://habrastorage.org/files/8a7/66a/5b7/8a766a5b713944e091f17d4600a67822.jpg"><br><br><h5>  Incident number 4. Violation of the availability of VM </h5><br>  When a user tries to access a virtual machine, a user is denied due to a virtual machine being unavailable.  The AIB filters audit events by the ‚Äútext contains‚Äù parameter and enters the name of the virtual machine. <br><br><img src="https://habrastorage.org/files/752/26d/b59/75226db599fe487aa4309ad57f7bf152.jpg"><br><br>  As a result of applying the AIB filter, all security events related to this virtual machine will be available.  AIB finds out that AVI 1 changed the settings of the virtual machine, deleted it or performed other actions with the virtual machine, which led to its inaccessibility. <br><br><img src="https://habrastorage.org/files/08d/f4c/1ab/08df4c1abace44f4bcd60b14e987b20b.jpg"><br><br><h5>  Incident number 5. Analysis of open ports </h5><br>  AIB during the periodic monitoring of events formed the report "The most frequent events of IB" <br><br><img src="https://habrastorage.org/files/943/f2a/d50/943f2ad50bb04768ad3ca01eaaf17ff2.jpg"><br><br>  The report often includes the event ‚ÄúAttempt of unauthorized access to the protected object‚Äù.  The AIB for further analysis filters out audit events by the type of warning events and the access control category. <br><br><img src="https://habrastorage.org/files/f42/a03/c5f/f42a03c5fbfb4605a7282a9b74e91467.jpg"><br><br>  As a result of applying the filter, the AIB sees recurring events in which the subject and the access object are the same, and the destination ports are different.  From which it can be concluded that AVI 2 (IP 192.168.2.143) ran software for analyzing open ports. <br><br><img src="https://habrastorage.org/files/56d/327/c41/56d327c4141a4a50a90d9fe2500794e9.jpg"><img src="https://habrastorage.org/files/814/2ca/831/8142ca83169c4f6883bb16febaefdef8.jpg"><br><br><img src="https://habrastorage.org/files/f5e/ba5/dd7/f5eba5dd701a4d7d9a629888a90d1105.jpg"><br><br><h5>  Incident number 6. Exhaustion of resources </h5><br>  The user of VM WIN7 cannot access it, or the performance of this VM is slowed down.  The user contacts AVI 1, who sees that new VMs have appeared on this host.  AVI 1 refers to the AIB about what happened. <br><br><img src="https://habrastorage.org/files/b92/6f5/096/b926f50968a04db492bbd8391538444e.jpg"><br><br><img src="https://habrastorage.org/files/b19/b97/75a/b19b9775a0d24eb99b47ed8190072d88.jpg"><img src="https://habrastorage.org/files/540/c99/36d/540c9936da6e472aad2933a13af4feed.jpg"><br><br>  The AIB in audit events applies additional filtering by event category.  By selecting the category ‚ÄúVirtual Machines‚Äù in the list of events associated with virtual machines, it finds the events of cloning and launching AVI 2 of several virtual machines.  Accordingly, the AIB concludes that AVI 2, through the cloning and subsequent launch of a large number of virtual machines, caused the exhaustion of the computing resources of the host. <br><br><h5>  Incident number 7. Turn off VM </h5><br>  The WIN7 virtual machine has an agentless anti-virus installed (or, for example, an intrusion detection / prevention system) that protects all the virtual machines on this host, but, nevertheless, a virus infection has occurred.  Having made a selection of events related to this virtual machine, AIB found out that AVI 1 turned off this machine, which is a reason to find out the reasons. <br><br><h4>  Conclusion </h4><br>  The examples considered are fairly simple, but their main goal was to show vGate incident detection functionality, which can be used to identify more complex incidents.  Each of the considered incidents can be prevented by using the appropriate settings and vGate policies, as well as by setting up prompt notifications to security administrators about suspicious and malicious actions.  If vGate, for example, is integrated with the SIEM system, it will add up to even more tools for detecting and investigating incidents not only in the virtual infrastructure, but also in the entire infrastructure as a whole. </div><p>Source: <a href="https://habr.com/ru/post/241205/">https://habr.com/ru/post/241205/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../241195/index.html">0day detected in MS14-060 update</a></li>
<li><a href="../241197/index.html">SSH access to Jelastic cloud</a></li>
<li><a href="../241199/index.html">Another unnecessary extension for Google Chrome?</a></li>
<li><a href="../241201/index.html">Five dead-end conversations between the manager and the manager</a></li>
<li><a href="../241203/index.html">The final program of the Mobile Developers Conference was published #MBLTDev</a></li>
<li><a href="../241209/index.html">Features of working with the Google Drive API</a></li>
<li><a href="../241211/index.html">Step-by-step guide to creating a trading robot in Python</a></li>
<li><a href="../241213/index.html">Google's Lollipop OS, new Nexus and a list of billions of companies in the mobile market - and other news of the week for a mobile developer</a></li>
<li><a href="../241215/index.html">GLPI and the latest time zone updates in Windows</a></li>
<li><a href="../241217/index.html">Localization of applications for OS X</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>