<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Data structures in pictures. ArrayList</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings to you, habra people! 

 It occurred to me to write a few articles about how some data structures are implemented in Java. I hope the articl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Data structures in pictures. ArrayList</h1><div class="post__text post__text-html js-mediator-article">  Greetings to you, habra people! <br><br>  It occurred to me to write a few articles about how some data structures are implemented in Java.  I hope the articles will be useful for visuals (our pictures are all), aspiring java-visuals, as well as those who already know how to write new ArrayList (), but have little idea what happens inside. <br><br><img src="https://habrastorage.org/storage1/8ce732f8/e6d46bea/e258a346/4f7e5f56.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Today we will talk about ArrayList <br><br>  <i>ArrayList - implements the List interface.</i>  <i>As you know, in Java, arrays have a fixed length, and after an array is created, it cannot grow or shrink.</i>  <i>ArrayList can change its size during program execution, and it is not necessary to specify the dimension when creating an object.</i>  <i>ArrayList elements can be absolutely any type including null.</i> <br><br><a name="habracut"></a><br><br><h3>  Object creation </h3><br><pre><code class="java hljs">ArrayList&lt;String&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;String&gt;();</code> </pre> <br>  The <b>newly</b> created list object contains the <b>elementData</b> and <b>size</b> properties. <br><br>  The storage of <b>elementData</b> values ‚Äã‚Äãis nothing more than an array of a certain type (specified in generic), in our case <b>String []</b> .  If a constructor without parameters is called, then by default an array of 10 elements of type Object will be created (with conversion to a type, of course). <br><br><pre> <code class="java hljs">elementData = (E[]) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object[<span class="hljs-number"><span class="hljs-number">10</span></span>];</code> </pre> <br> <a href=""><img src="https://habrastorage.org/storage1/ddb168b8/4a0ff0d5/43889eac/c437e2fb.png"><br></a> <br>  You can use the <b>ArrayList (capacity)</b> constructor and specify your initial list capacity. <br><br><br><h3>  Adding items </h3><br><pre> <code class="java hljs">list.add(<span class="hljs-string"><span class="hljs-string">"0"</span></span>);</code> </pre> <br> <a href=""><img src="https://habrastorage.org/storage1/3720b293/cf78ff93/c9343de2/f9e8c1b7.png"><br></a> <br><br>  The following things happen inside the <b>add (value)</b> method: <br><br>  1) it is checked whether there is enough space in the array to insert a new element; <br><br><pre> <code class="java hljs">ensureCapacity(size + <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br>  2) an element is added to the end (according to the <b>size</b> value) of the array. <br><br><pre> <code class="java hljs">elementData[size++] = element;</code> </pre> <br>  We will not consider the whole method <b>ensureCapacity (minCapacity)</b> , we‚Äôll dwell only on a couple of interesting places.  If there is not enough space in the array, the new capacity is calculated using the formula <b>(oldCapacity * 3) / 2 + 1</b> .  The second point is copying items.  It is implemented using the <b>native</b> <b>System.arraycopy ()</b> method, which is not written in Java. <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// newCapacity -    elementData = (E[])new Object[newCapacity]; // oldData -       System.arraycopy(oldData, 0, elementData, 0, size);</span></span></code> </pre><br><br>  The following cycle demonstrates alternately adding 15 elements: <br><pre> <code class="java hljs">list.add(<span class="hljs-string"><span class="hljs-string">"1"</span></span>);</code> </pre> <br> <a href=""><img src="https://habrastorage.org/storage1/44742fc7/7d6f5cb5/d75ad62e/d5b70d56.png"><br></a> <br>  <b>...</b> <br><br><pre> <code class="java hljs">list.add(<span class="hljs-string"><span class="hljs-string">"9"</span></span>);</code> </pre> <br> <a href=""><img src="https://habrastorage.org/storage1/6a399826/5504984d/2d6e3d4a/502b0fef.png"><br></a> <br><br><pre> <code class="java hljs">list.add(<span class="hljs-string"><span class="hljs-string">"10"</span></span>);</code> </pre> <br>  When adding the 11th element, the check shows that there is no space in the array.  Accordingly, a new array is created and <b>System.arraycopy () is</b> called. <br><br> <a href=""><img src="https://habrastorage.org/storage1/e599f79f/7a50da6d/c4ee905d/79f11337.png"><br></a> <br>  After this, the addition of elements continues. <br><br> <a href=""><img src="https://habrastorage.org/storage1/652cfaca/aaf41ba4/4fe0b427/7170a7bc.png"><br></a> <br>  <b>...</b> <br><br><pre> <code class="java hljs">list.add(<span class="hljs-string"><span class="hljs-string">"14"</span></span>);</code> </pre> <br> <a href=""><img src="https://habrastorage.org/storage1/c848d485/82158846/8d02bb6b/e8e21fa8.png"><br></a> <br><br><br><h3>  Adding to the "middle" list </h3><br><pre> <code class="java hljs">list.add(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">"100"</span></span>);</code> </pre> <br>  Adding an element to a position with a specific index occurs in three stages: <br><br>  1) it is checked whether there is enough space in the array to insert a new element; <br><br><pre> <code class="java hljs">ensureCapacity(size+<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><br>  2) a place is prepared for a new element using <b>System.arraycopy ()</b> ; <br><br><pre> <code class="java hljs">System.arraycopy(elementData, index, elementData, index + <span class="hljs-number"><span class="hljs-number">1</span></span>, size - index);</code> </pre><br> <a href=""><img src="https://habrastorage.org/storage1/b68ec001/369d8f50/7a73cd2c/6632cbaf.png"><br></a> <br>  3) overwrites the value of the element with the specified index. <br><br><pre> <code class="java hljs">elementData[index] = element; size++;</code> </pre><br> <a href=""><img src="https://habrastorage.org/storage1/48afc31a/8207337a/7d7d71f2/2ff2ae09.png"><br></a> <br><br>  As you can guess, in cases when an element is inserted by index and there is no free space in your array, the call to <b>System.arraycopy ()</b> happens twice: the first one is to <b>ensureCapacity ()</b> , the second one in the <b>add</b> method itself <b>(index, value)</b> , which will obviously affect the speed of the whole operation of adding. <br><br>  In cases where you need to add another collection to the source list, and also to the ‚Äúmiddle‚Äù, you should use the <b>addAll</b> method <b>(index, Collection)</b> .  And although this method is likely to call <b>System.arraycopy ()</b> three times, in the end it will be much faster than elementwise adding. <br><br><br><h3>  Deleting items </h3><br>  You can delete items in two ways: <br>  - by index <b>remove (index)</b> <br>  - by value <b>remove (value)</b> <br><br>  Deleting an item by index is pretty easy. <br><br><pre> <code class="java hljs">list.remove(<span class="hljs-number"><span class="hljs-number">5</span></span>);</code> </pre> <br>  First, determine how many elements need to be copied <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> numMoved = size - index - <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br>  then copy the elements using <b>System.arraycopy ()</b> <br><br><pre> <code class="java hljs">System.arraycopy(elementData, index + <span class="hljs-number"><span class="hljs-number">1</span></span>, elementData, index, numMoved);</code> </pre><br>  reduce the size of the array and forget about the last element <br><br><pre> <code class="java hljs">elementData[--size] = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Let gc do its work</span></span></code> </pre><br><br>  When deleting by value, all elements of the list are scanned in the loop until a match is found.  Only the first found item will be deleted. <br><br>  <b>Addition 1:</b> As <a href="http://habrahabr.ru/users/mikemirzayanov/" class="user_link">MikeMirzayanov</a> correctly noted, when deleting elements, the current value of capacity does not decrease, which can lead to peculiar memory leaks.  Therefore, do not neglect the <b>trimToSize ()</b> method. <br><br><br><h3>  Results </h3><br>  - Quick access to elements by index in time O (1); <br>  - Access to elements by value in linear time O (n); <br>  - Slow when elements are inserted and deleted from the ‚Äúmiddle‚Äù of the list; <br>  - Allows you to store any values ‚Äã‚Äãincluding null; <br>  - Not synchronized. <br><br><br><h3>  Links </h3><br>  <a href="http://www.java2s.com/Open-Source/Java-Document/6.0-JDK-Core/Collections-Jar-Zip-Logging-regex/java/util/ArrayList.java.htm">ArrayList source</a> <br>  Source <a href="">ArrayList</a> from JDK7 <br>  Sources JDK <a href="http://download.java.net/openjdk/jdk6/">OpenJDK &amp; trade 6 Source Release - Build b23</a> <br><br><br>  Write in the comments wishes / comments and whether it makes sense to continue. </div><p>Source: <a href="https://habr.com/ru/post/128269/">https://habr.com/ru/post/128269/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128262/index.html">Ciklum supported the meeting of the Kiev Python-club</a></li>
<li><a href="../128264/index.html">Streams.js: deferred (lazy) calculations in Javascript</a></li>
<li><a href="../128265/index.html">Web Standards Song</a></li>
<li><a href="../128267/index.html">Plastic Logic 100 in real life</a></li>
<li><a href="../128268/index.html">Dave Mendlen transferred from Microsoft to DevExpress</a></li>
<li><a href="../128270/index.html">Microsoft has implemented an analogue of Synergy (control of several PCs with one mouse)</a></li>
<li><a href="../128271/index.html">YAF - the fastest php framework *</a></li>
<li><a href="../128273/index.html">Multilingual Django Starter Models</a></li>
<li><a href="../128274/index.html">Work for Watson</a></li>
<li><a href="../128275/index.html">Lock-free memcache API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>