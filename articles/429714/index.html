<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Easier than MQTT? MQTT / UDP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I wanted to write a detailed article on this topic, but, obviously, my hands do not reach. Therefore a brief message. I developed and implemented in s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Easier than MQTT? MQTT / UDP</h1><div class="post__text post__text-html js-mediator-article">  I wanted to write a detailed article on this topic, but, obviously, my hands do not reach.  Therefore a brief message.  I developed and implemented in several languages ‚Äã‚Äãin the form of a prototype code version of the MQTT protocol under the working name MQTT / UDP.  For the impatient and those who are already clear and obvious, the code <a href="https://github.com/dzavalishin/mqtt_udp">on Gitkhab</a> <br><br>  <b>What for</b> <br><br>  I live in an apartment that is almost completely controlled by my own smart home system for several years.  Control of light, climate, sensors, easy automation, that's all. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      During this time, I found out (yes, by the way, I understood it before) that the main feature of UD systems is reliability. <br><br>  All systems with a central site are by definition unreliable.  Hence, the desire to get an interconnect system component (and there are a lot of them in a real smart home) without using any central hub. <br><a name="habracut"></a><br>  At the same time, we proceed from the assumption that, in general, the traffic of UD systems is small - the sensors rarely need an update more than once a minute, the rest of the data are eventual (they turn on the light), and the traffic is completely unimportant.  Even every second update of all data in the system is not only a disaster, but even a significant problem. <br><br>  The logical conclusion - UDP Broadcast is the perfect tool. <br><br>  (Yes, I assume that the internal network of the apartment is closed by a firewall.) <br><br>  <b>What are the advantages:</b> <br><br>  Incredibly simple implementation.  A minimal microcontroller with tiny memory will be able to send a UDP packet.  For the sensor, even UDP reception is not needed. <br><br>  Extremely low latency.  There is no forward in the central hub, the UDP packet delivery time is practically the minimum time quantum in the modern system. <br><br>  There is no central point of failure in the hub / broker.  Consider a simple circuit: two temperature sensors, a heated floor controller, and a heating controller.  With the use of MQTT / UDP, the failure of any part of such a system does not lead to the failure of the system as a whole. <br><br>  Low network traffic.  Below is nowhere.  TCP and confirmations only add traffic, but do not add reliability.  Failed sensor will not work from receiving TCP ACK.  A failure, and so we reveal the absence of updates. <br><br>  The unreliability of the UDP protocol itself is insignificant - the sensors still update the data regularly, and the loss of counting is completely unnoticed, and the disappearance of a command from, for example, a switch, is visually confirmed by a failure of the target system.  What does a man do?  Clicks again.  However, this is the main limit to the applicability of the protocol.  Ideal for repetitive surveys. <br><br>  No system configuration required.  No one needs to register the address of the broker, hub, etc.  However, the sensor configuration is still needed - you need to register the sensor identifier.  But when transferring other parts of the system to other servers, reconfiguration of the response components is not required. <br><br>  Separately, it is interesting that this data exchange model fits well with natural broadband media, such as a radio channel or RS / 485.  I have not experimented with this, and the protocol in such environments needs to be controlled.  It makes sense here to apply CRC16 from modbus, by the way. <br><br>  The disadvantages are also obvious: the reliability of delivery is determined only by the hardware and the traffic on the network, well, and if an enemy has snuck into the network, the protocol is immediately defeated.  True, let's be frank, hacking other typical protocols of the smart home is a matter of seconds, so this is a controversial drawback of MQTT / UDP.  Another unobvious negative is a maximum of one receiver per IP address. <br><br>  <b>What has been done and is in the source repository:</b> <br><br><ul><li>  Client / server implementations in multiple languages.  There are C, Python and Java.  I didn‚Äôt master Lua (couldn‚Äôt put everything you need, how do you live in it?) And Codesys (couldn‚Äôt put together a package, who invented this language?). </li><li>  Minimum Gate to Traditional Python MQTT </li><li>  Primitive tool for displaying MQTT / UDP traffic on the network </li></ul><br>  <b>What would I do if I had more time:</b> <br><br><ul><li>  Would write a module for openHUB. </li><li>  Would make a protocol variant on JSON on another port and a converter into the main format and port.  Or gate in both directions. </li><li>  Would make a sales pig for the main platforms.  For Arduino, I made an approach to weight and really tested the code, but did not design everything properly.  For Raspberry test examples are suitable for Python. </li><li>  Would make a digital signature and encryption, but it is unclear how. </li><li>  Multicast </li></ul><br>  Thank you for this, <a href="https://github.com/dzavalishin/mqtt_udp">welcome to the repository.</a> <br><br>  PS: <a href="https://habr.com/post/240053/">A similar approach, but with multicast, is described in this article.</a> </div><p>Source: <a href="https://habr.com/ru/post/429714/">https://habr.com/ru/post/429714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../429704/index.html">Connecting Multipath LUN SHD to Windows Server 2008 and Windows Server 2012</a></li>
<li><a href="../429706/index.html">A1: 2017 - Injections (Part 3 and Last)</a></li>
<li><a href="../429708/index.html">A piece of the program HolyJS 2018 Moscow</a></li>
<li><a href="../429710/index.html">Carbon Dioxide on ISS</a></li>
<li><a href="../429712/index.html">Introduction to React Hooks</a></li>
<li><a href="../429716/index.html">5 best games on the PC for learning English</a></li>
<li><a href="../429718/index.html">I want everything at once! We study the memory HyperX Predator DDR4 RGB, with a frequency of 4000 MHz</a></li>
<li><a href="../429720/index.html">As a novice developer to survive the interview and not go crazy at work</a></li>
<li><a href="../429722/index.html">How we made payment via Google Pay at Yandex.Cash [updated]</a></li>
<li><a href="../429724/index.html">Useful review. 28 books that influenced my thinking, inspired or made better</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>