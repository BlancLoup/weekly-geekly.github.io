<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The dark side of the ZRF</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Those who read my series of articles devoted to Zillions of Games might have the impression that I was completely satisfied with this product. Of cour...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The dark side of the ZRF</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/781/ba3/9a2/781ba39a2338bbc0815f8a69a7d3ca07.jpg">  Those who read my series of <a href="http://habrahabr.ru/post/211100/">articles</a> devoted to <a href="http://zillionsofgames.com/">Zillions of Games</a> might have the impression that I was completely satisfied with this product.  Of course, it is not.  ZoG is unique in that it allows you to quickly and practically ‚Äúon the knee‚Äù to develop a prototype of almost any logical game, but this does not mean that it is perfect.  Today, I want to talk about what I do not like about this project. <br>  Of course, this criticism is not needed by itself.  I am fully aware that with completely stopped product development (by the way, this is one of those moments that I don‚Äôt like), such criticism, as a means of feedback from the developer, is completely useless.  Therefore, I am not going to write any letters to the creators of the product - the engine has long been gone. <br><br>  ZoG showed a possible course of action, the very possibility of creating such a universal game engine, but if you want something to be done, you will have to do it yourself.  This work is not easy and I am not at all sure that I will be able to cope with it (at least alone).  In any case, as the very first step, it will be useful to understand what is bad with what is already there.  Why start a new product development?  I will try to tell about it ... <br><a name="habracut"></a><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/3c5/642/2ca/3c56422ca18c006cbbb91611776f61af.jpg">  Compared to the variety of all sorts of rules, which I described in the previous <a href="http://habrahabr.ru/post/219989/">article</a> , the concept of <a href="http://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B0%25D1%2585%25D0%25BC%25D0%25B0%25D1%2582%25D1%258B">Chess</a> looks very simple.  In part, this illusion is supported by the fact that, most of us, are familiar with Chess from early childhood.  Of course, this simplicity is deceptive!  And the point here is not even in the exotic rules of " <a href="http://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B7%25D1%258F%25D1%2582%25D0%25B8%25D0%25B5_%25D0%25BD%25D0%25B0_%25D0%25BF%25D1%2580%25D0%25BE%25D1%2585%25D0%25BE%25D0%25B4%25D0%25B5">taking on the aisle</a> " and <a href="http://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25BE%25D0%25BA%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B0">castling</a> (because of which the <b>cascade</b> and <b>set-attribute</b> commands had to be added to ZRF).  I propose to deal with a deeper question underlying the game itself.  What should the King do under the check? <br><br>  First of all, the King cannot remain in check!  The next move, we must eliminate the threat (if this is not possible, the situation has a different name - mate).  We can leave the King on the field who is not under combat, shut off another figure from the Shah (this is not possible if the Shah is set by the Horse) or eat an attacking figure.  With the latest version, everything is also not easy.  It is possible to eat an attacking piece by the King only if it is not protected by another piece, and in the case of a double check, there is one of the attacking pieces, not leading the King out from the battlefield of the other, also impossible.  All this may seem obvious, but I want to make it clear that the implementation of such behavior can be very complex.  How is this implemented in ZRF? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      very simple: <br><br><pre><code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">loss-condition</span></span> (<span class="hljs-name"><span class="hljs-name">White</span></span> Black) (<span class="hljs-name"><span class="hljs-name">checkmated</span></span> King))</code> </pre> <br>  If the magic word <b>checkmated</b> appears in the condition of a player‚Äôs defeat, the core of the program <b>knows</b> how to fix the checkmate, and, at the same time, how to take the King out of the check.  But such ‚Äústitching‚Äù of such complex logic into the core of a product may not be the most successful thought, when implementing a universal engine.  The concept of mate itself is far from being found in all the games of the Chess family, and it is still necessary to take the King out from under the ‚ÄúShah‚Äù to them.  I have already said <a href="http://habrahabr.ru/post/213391/">earlier</a> that the processing logic of <b>checkmated</b> , can lead to the King‚Äôs not quite adequate behavior, and the refusal to use this condition almost completely breaks the whole endgame game in ZoG. <br><br>  It is quite natural that the situation with the correct matting is complicated in various ‚Äúnational‚Äù varieties of Chess.  So in <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2591%25D0%25B3%25D0%25B8">Shogi</a> , it is forbidden to checkmate a pawn (in this case, you can checkmate with a regular pawn and shake a pawn), and in <a href="http://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B0%25D1%2582%25D0%25B0%25D1%2580_%25D0%25B8_%25D1%2585%25D0%25B8%25D0%25B0%25D1%2588%25D0%25B0%25D1%2582%25D0%25B0%25D1%2580">Shatar</a> , the process of mating is even more confused (for example, you cannot checkmate Kone).  It is obvious that the capabilities of one single <b>checkmated</b> keyword are completely insufficient for a correct description of the rules of these games. <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/614/7cc/0f7/6147cc0f70458f80cf5244ab61b9c322.jpg">  With Checkers, everything is also not at all smooth.  The main difference from Chess is the obligatory take and the possibility of a series of takes.  To implement these rules, partial moves ( <b>add-partial</b> ) and <b>move</b> priorities ( <b>move-priorities</b> ) are introduced in ZRF.  The mechanism of priorities is not very convenient to use, but it works.  A player will not be able to make a non-priority move if he has the possibility of a priority move  But this is not the end!  In some types of Checkers (for example, in international 100-cell Checkers), from all possible moves with a take, the player must choose the option of taking the maximum number of pieces (in this case, ladies can be taken into account or not taken into account). <br><br>  This logic is reintroduced into the core: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">option</span></span> <span class="hljs-string"><span class="hljs-string">"maximal captures"</span></span> true)</code> </pre><br>  In addition to this option, there are a number of other options used by AI ZoG: <br><br><ul><li>  <b>"Include off-pieces"</b> - enabling or disabling the registration of figures in reserve when determining the conditions of victory and defeat </li><li>  <b>"Pass partial"</b> - controls the ability to interrupt the chain of takeings generated by the <b>add-partial</b> command </li><li>  <b>"Pass turn"</b> - controlling the possibility of skipping the course </li><li>  <b>...</b> </li></ul><br>  As a control parameter, an option is passed a boolean value that enables or disables the option.  For some options, it is allowed to pass the value <b>2</b> or <b>forced</b> .  For example, the following command: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">option</span></span> <span class="hljs-string"><span class="hljs-string">"maximal captures"</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre><br>  ... includes a "maximum capture" mode, taking into account the ladies. <br><br>  There is no system in the list of options provided.  Moreover, in the same list there are options that have nothing to do with AI, for example, " <b>animate captures</b> ", " <b>highlight goals</b> ", " <b>show moves list</b> ", ... This mechanism can hardly be called universal. <br><br>  A similar lack of a systematic approach passes through the entire ZRF as a ‚Äúred thread‚Äù.  For example, there is a convenient <b>relative-config</b> command for defining ‚Äú3 in a row‚Äù positions.  Here is how it is used in " <a href="http://ru.wikipedia.org/wiki/Zillions_of_Games">Tic-tac-toe</a> ": <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">win-condition</span></span> (<span class="hljs-name"><span class="hljs-name">XO</span></span>) (<span class="hljs-name"><span class="hljs-name">or</span></span> (<span class="hljs-name"><span class="hljs-name">relative-config</span></span> man n man n man) (<span class="hljs-name"><span class="hljs-name">relative-config</span></span> man e man e man) (<span class="hljs-name"><span class="hljs-name">relative-config</span></span> man ne man ne man) (<span class="hljs-name"><span class="hljs-name">relative-config</span></span> man nw man nw man) )</code> </pre><br>  Simple and convenient.  The only problem is that this command is allowed to be used only inside the game completion checks <b>win-condition</b> , <b>loss-condition</b> or <b>draw-condition</b> .  In addition, it reacts to any occurrence of the specified configuration (no matter on whose course it occurs).  As a result, in the implementation of " <a href="http://zillionsofgames.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D956">Mills</a> " I have to fuss: <br><br><div class="spoiler">  <b class="spoiler_title">three-story checks</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> Check-for-3 (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> first? false) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> second? false) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> third? false) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> fourth? false) a1 (<span class="hljs-name"><span class="hljs-name">while</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? next)(<span class="hljs-name"><span class="hljs-name">not-flag</span></span>? fourth?)) (<span class="hljs-name"><span class="hljs-name">if</span></span> friend? (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">not-flag</span></span>? first?) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> first? true) else (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">not-flag</span></span>? second?) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> second? true) else (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">not-flag</span></span>? third?) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> third? true) else (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> fourth? true) ) ) ) ) next ) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">not-flag</span></span>? fourth?)) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">am-Black</span></span>?) (<span class="hljs-name"><span class="hljs-name">change-type</span></span> Jumping z0) <span class="hljs-comment"><span class="hljs-comment">;set permanent flag else (change-type Jumping z1) ;set permanent flag ) )</span></span></code> </pre><br></div></div><br>  Something similar had to do to me, with the implementation of one of the options <a href="http://habrahabr.ru/post/212835/">Thud</a> .  But the possibility of using the <b>relative-config</b> analog, when performing a move, would be very useful in many games, for example, in <a href="http://skyruk.livejournal.com/274559.html">Chaturanga</a> with its ‚Äútriumph of elephants‚Äù.  In <a href="http://en.wikipedia.org/wiki/Hasami_shogi">Hasami Shogi,</a> such an opportunity would allow one to correctly implement <a href="http://www.youtube.com/watch%3Fv%3D5EcpCGDu1Bw%26list%3DPL587865CAE59EB84A">complex rules for</a> locking figures at the edge and in the corner of the board. <br><br>  Another extremely useful feature would be to implement <b>mark / back</b> commands <a href="http://www.di.fc.ul.pt/~jpn/cv/ZRF2.htm">without limiting the nesting level</a> .  The <b>mark</b> command remembers the current position in the course of calculating the move, and the <b>back</b> allows you to return to it.  It would seem, what could be more natural than using the stack to save positions?  But no, nested <b>mark</b> calls are not supported!  Sorry, it would be convenient ... <br><br>  But back to the fundamental.  What happens in Chess if we put a piece on the field occupied by an opponent?  It is well known to everyone - the opponent's figure will be removed from the board.  This is how everything is implemented in ZoG (and this behavior cannot be changed).  If we give the <b>add</b> command on a busy field, the figure that was placed there earlier will be removed from the board.  You do not need to execute the <b>capture</b> command (moreover, if we execute <b>capture</b> , the figure that we walk will be deleted).  A board cell cannot contain more than one shape. <br><br>  But this is far from true for all games!  For example, in <a href="http://cyclowiki.org/wiki/%25D0%25A0%25D1%2583%25D1%2581%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B5_%25D1%2588%25D0%25B0%25D1%2585%25D0%25BC%25D0%25B0%25D1%2582%25D1%258B">Russian Chess</a> it would be much more convenient to store an ordered list of pieces in a cell of the board.  The same goes for the <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2582%25D0%25BE%25D0%25BB%25D0%25B1%25D0%25BE%25D0%25B2%25D1%258B%25D0%25B5_%25D1%2588%25D0%25B0%25D1%2588%25D0%25BA%25D0%25B8">Post Bars</a> .  Of course, I cannot say that this served as an insurmountable obstacle in the implementation of the latter.  The pillars were <a href="http://zillionsofgames.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D1767">implemented</a> , but the complexity of the decision did not have a positive effect on its performance or on the quality of the game. <br><br>  And this is not the only (and not even the most important) trouble of the <b>add</b> command!  In ZRF, the <b>add</b> family commands combine two functions: <br><br><ol><li>  Indication of the field on which the figure is placed, performed the move </li><li>  Completing the formation of a variant (or part) of the course </li></ol><br>  Do you already understand what the problem is?  From this completely inappropriate combination of two fundamentally different actions in the same team, it immediately follows that a move (move or reset) must be completed by putting a piece on some board field (in this case, other pieces can be eaten).  There are no other options!  Try to implement on ZRF <a href="http://en.wikipedia.org/wiki/Andernach_chess">Andernach</a> .  I tried it three times, nothing happened!  The fact is that, in this version of the game, when taken, the figure changes color to the color of the taken figure.  This means that the move we end is no longer his figure ... <br><br>  It would have cost the developers to divide the <b>add</b> command into the actual team of setting the piece on the board and the command of explicitly ending the move ( <b>end-move</b> for example) and heaps of problems could have been avoided!  For example, it would be possible to capture enemy pieces without moving their pieces.  By the way, in ZSG (notation of ZoG moves) there is such an opportunity, but it is used only for the ‚Äúinitial setup‚Äù of the board.  In general, this moment, indeed, seriously complicates the development process using ZRF. <br><br>  The fact that you can only walk with your figure is also not always true.  For example, in the " <a href="http://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B0%25D1%2588%25D0%25BA%25D0%25B8">Stavropol checkers</a> ", the player can walk the opponent's pieces.  In ZRF this can be achieved by making all the pieces neutral (belonging to the third player not participating in the game), but this solution is not at all obvious and rather cumbersome. <br><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/6d1/d1f/86c/6d1d1f86c70fb3e01927b6072f6c867b.jpg">  Another disadvantage of ZRF is the complete lack of any arithmetic operations in it.  It's not scary, as long as we restrict ourselves to Chess and Checkers, but there are games in which the execution of arithmetic operations is necessary when calculating the turn!  Of course, I'm talking about <a href="https://en.wikipedia.org/wiki/Rithmomachy">ritmomachia</a> .  This medieval game is not particularly popular in our time, but it definitely challenges the versatility of the game engine.  Here are the conditions under which the figures can be fought in this game: <br><br><ul><li>  If the numeric value matches the value of the figure performing the fight </li><li>  If the result of multiplying the numerical value of the figure by the number of empty cells separating it from the opponent's figure coincides with the value of this figure </li><li>  If the numerical value of the figure coincides with the sum of the values ‚Äã‚Äãof the enemy figures surrounding it </li><li>  If the figure is surrounded by enemy figures from all four sides (vertically and horizontally) </li></ul><br>  Arithmetic can be useful not only when calculating the course.  In <a href="https://play.google.com/store/apps/details%3Fid%3Dair.hirobado.mod">this</a> game, for example, to determine the winner, it is required to calculate the area of ‚Äã‚Äãall the squares built on the board.  Also, the ability to associate numeric values ‚Äã‚Äã(eg hit points) with figures and fields of the blackboard can be useful.  ZRF allows only boolean values ‚Äã‚Äã(attributes) to be attached to figures; as for fields, boolean flags attached to them can only be used locally when calculating the course.  Global numerical values ‚Äã‚Äã(not associated with fields or figures) could be used to implement a variety of counters (for example, playing time). <br><br>  The standard ZoG does not have such features, but they are implemented in the <a href="http://zillionsofgames.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D1452">Axiom Development Kit</a> .  This is worth to tell more.  The fact is that ZoG allows you to use <a href="http://zillionsofgames.com/progsample.html">extensions</a> that can be developed, for example, using C ++.  The cost of using such extensions is to completely eliminate the use of the built-in AI ZoG.  In fact, the extension uses ZoG exclusively as a means of visualizing moves.  When developing such an extension, AI has to take care of itself. <br><br>  Of course, this feature is not very suitable for ordinary ZoG users.  Axiom developers took care of them by providing, with the extension, their own AI.  In addition, this version of the AI ‚Äã‚Äãis much better than the staff copes with the games on the "seizure of the territory" and "connection", such as <a href="http://zillionsofgames.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D1471">Hex</a> .  In addition, as a programming language, Axiom uses <a href="http://en.wikipedia.org/wiki/Forth_%2528programming_language%2529">Forth Script</a> , which provides support for arithmetic operations. <br><br>  Unfortunately, being an extension of ZoG, Axiom is forced to use an interface designed to interact with extensions.  I will allow myself to bring it here: <br><br><div class="spoiler">  <b class="spoiler_title">Engine.h</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Engine.h // // Copyright 1998-2000 Zillions Development // // Header file for plug-in DLL engine to Zillions #include "EngineDLL.h" DLL_Result FAR PASCAL DLL_Search(long lSearchTime, long lDepthLimit, long lVariety, Search_Status *pSearchStatus, LPSTR bestMove, LPSTR currentMove, long *plNodes, long *plScore, long *plDepth); DLL_Result FAR PASCAL DLL_MakeAMove(LPCSTR move); DLL_Result FAR PASCAL DLL_StartNewGame(LPCSTR variant); DLL_Result FAR PASCAL DLL_CleanUp(); DLL_Result FAR PASCAL DLL_IsGameOver(long *lResult, LPSTR zcomment); DLL_Result FAR PASCAL DLL_GenerateMoves(LPCSTR moveBuffer);</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">EngineDLL.h</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// EngineDLL.h // // Copyright 1998-2000 Zillions Development // // Shared DLL plug-in for DLL engine and Zillions #include "windows.h" typedef enum { kKEEPSEARCHING = 0, kSTOPSOON = 1, kSTOPNOW = 2 } Search_Status; typedef enum { DLL_OK = 0, DLL_OK_DONT_SEND_SETUP = 1, // only supported in 1.0.2 and higher! DLL_GENERIC_ERROR = -1, DLL_OUT_OF_MEMORY_ERROR = -2, DLL_UNKNOWN_VARIANT_ERROR = -3, DLL_UNKNOWN_PLAYER_ERROR = -4, DLL_UNKNOWN_PIECE_ERROR = -5, DLL_WRONG_SIDE_TO_MOVE_ERROR = -6, DLL_INVALID_POSITION_ERROR = -7, DLL_NO_MOVES = -8 } DLL_Result; enum { UNKNOWN_SCORE = -2140000000L, LOSS_SCORE = -2130000000L, DRAW_SCORE = 0, WIN_SCORE = 2130000000L }; // ***** REQUIRED ROUTINES // DLL_Search // // The DLL should search from the current position. If it returns DLL_OK it should // also return the best move found in str; however, it should not make the move // internally. A separate call to MakeAMove() will follow to make the move the // engine returns. // // -&gt; lSearchTime: Target search time in milliseconds // -&gt; lDepthLimit: Maximum moves deep the engine should search // -&gt; lVariety: Variety setting for engine. 0 = no variety, 10 = most variety // -&gt; pSearchStatus: Pointer to variable where Zillions will report search status // -&gt; bestMove: Pointer to a string where engine can report the best move found so far // -&gt; currentMove: Pointer to a string where engine can report the move being searched // -&gt; plNodes: Pointer to a long where engine can report # of positions searched so far // -&gt; plScore: Pointer to a long where engine can report current best score in search // -&gt; plDepth: Pointer to a long where engine can report current search depth // // Returns DLL_OK or a negative error code typedef DLL_Result (FAR PASCAL *SEARCH)(long lSearchTime, long lDepthLimit, long lVariety, const Search_Status *pSearchStatus, LPSTR bestMove, LPSTR currentMove, long *plNodes, long *plScore, long *plDepth); // DLL_MakeAMove // // The DLL should try to make the given move internally. // // -&gt; move: notation for the move that the engine should make // // Returns DLL_OK or a negative error code typedef DLL_Result (FAR PASCAL *MAKEAMOVE)(LPCSTR move); // DLL_StartNewGame // // The DLL should reset the board for a new game. // // -&gt; variant: The variant to be played as it appears in the variant menu // // Returns DLL_OK, DLL_OK_DONT_SEND_SETUP, DLL_OUT_OF_MEMORY_ERROR, or // DLL_GENERIC_ERROR typedef DLL_Result (FAR PASCAL *STARTNEWGAME)(LPCSTR variant); // DLL_CleanUp // // The DLL should free memory and prepare to be unloaded. // // Returns DLL_OK, DLL_OUT_OF_MEMORY_ERROR, or DLL_GENERIC_ERROR typedef DLL_Result (FAR PASCAL *CLEANUP)(void); // ***** OPTIONAL ROUTINES // DLL_IsGameOver // // This optional function is called by Zillions to see if a game is over. If // not present, Zillions uses the goal in the ZRF to decide the winner. // // -&gt; lResult: Pointer to the game result which the DLL should fill in when // called. If the game is over the routine should fill in WIN_SCORE, // DRAW_SCORE, or LOSS_SCORE. Otherwise the routine should fill in // UNKNOWN_SCORE. // -&gt; zcomment: Pointer to a 500-char string in Zillions which the DLL can optionally // fill in, to make an announcement about why the game is over, such // as "Draw by third repetition". The DLL should not modify this // string if there is nothing to report. // // Returns DLL_OK or a negative error code typedef DLL_Result (FAR PASCAL *ISGAMEOVER)(long *lResult, LPSTR zcomment); // DLL_GenerateMoves // // You can use GenerateMoves in your DLL to tell Zillions the legal moves for // any position in the game. // // -&gt; moveBuffer: Pointer to a 1024-char sting which the DLL should fill in when // called. Initial call should be with moveBuffer set to "". Each call // to GenerateMoves should fill in the next available move from the // current position, with a final "" when no more moves are available. // All moves must be in valid Zillions move string format. // // Returns DLL_OK or a negative error code typedef DLL_Result (FAR PASCAL *GENERATEMOVES)(LPCSTR moveBuffer);</span></span></code> </pre><br></div></div><br>  As you can see, this interface is designed exclusively for transmitting the ZoG core, the moves generated by the AI.  A move must be formed (in an undocumented) ZSG notation.  Additionally, the extension can determine the condition of the completion of the game, but it does not control the correctness of moves - this part remains in ZRF!  From this simple fact it follows that all the shortcomings of ZRF, about which I spoke above (except for the lack of support for arithmetic) remain in force. <br><br>  In fact, in the case of Axiom, the situation is even worse.  The interface for interacting with extensions does not provide access to the rules of the game written in ZRF (let me remind you that we cannot do without them).  Since Axiom AI, for its work, should have access to these rules, they have to be <b>duplicated</b> in the Forth Script language!  There is, however, a utility that automates this process.  All this makes the development, with the use of Axiom, is not at all a simple matter. <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/9d5/d81/716/9d5d817168bafb37bf3773ad09a598b0.jpg">  Continuing my story about the shortcomings of ZRF, I just can not get past the <a href="http://ru.wikipedia.org/wiki/%25D0%2598%25D0%25B3%25D1%2580%25D0%25B0_%25D1%2581_%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25BE%25D0%25B9_%25D0%25B8%25D0%25BD%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B5%25D0%25B9">games with incomplete information</a> .  There are implementations of <a href="http://zillionsofgames.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D1524">such</a> <a href="http://zillionsofgames.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D201">games</a> on ZRF, but are they fair?  They just hide some of the information from the <b>person</b> .  AI perfectly sees all the figures!  You must agree that such a ‚Äúone gate‚Äù game has little in common with the fact that all players have incomplete information.  Apparently, this is one of the reasons why so few card games are implemented for ZoG.  Not very interesting to play with someone who knows all your cards.  There is another side to this question.  I have already <a href="http://habrahabr.ru/post/213391/">mentioned</a> <a href="http://www.battlevschess.com/en/">Battle vs Chess</a> more than once.  Most of the missions in the campaigns of this game are based on the fact that people and computers play according to different rules.  For example, in the ‚ÄúPoint of no return‚Äù mission it is required to lure the enemy's pieces to the mines located on the field.  But if the AI ‚Äã‚Äãknows the location of the mines, it simply will not go to these fields!  What is the point of making a move, as a result of which you simply lose a piece?  In order for the game to proceed as it was intended by the developers, the computer must ‚Äúthink‚Äù that it plays by the usual rules.  This is also a variant of the game with incomplete information. <br><br>  Another sore point of ZRF is the lack of support for coalitions.  <a href="http://ru.wikipedia.org/wiki/%25D0%2595%25D0%25BD%25D0%25BE%25D1%2585%25D0%25B8%25D0%25B0%25D0%25BD%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B5_%25D1%2588%25D0%25B0%25D1%2585%25D0%25BC%25D0%25B0%25D1%2582%25D1%258B">Enochian chess</a> can be a good touchstone in this respect.  This game is played "couple for a couple."  Allied kings do not threaten each other and can easily be located on neighboring cells.  If one of the Allied kings is taken (there is no mate in Enochian chess), his pieces are ‚Äúfrozen‚Äù.  They cannot walk, they cannot be taken.  They just stand and block the fields.  But the second king can regain control of these figures, ascending the lost ally to the ‚Äúthrone‚Äù!  As a result, the sequence of moves remains the same, but the player goes "for himself, and for that guy."  It is very difficult to implement all this in ZRF. <br><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/cc2/605/060/cc2605060350a4029bca4bc2233f92ed.jpg">  We talked a lot about AI, now you can talk a little bit about what might not seem very important - about the design.  As an illustration, I propose to consider the game <a href="http://zillionsofgames.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D821">Surakarta</a> .  Yes, it is implemented on ZRF, but try to watch how it <a href="http://www.youtube.com/watch%3Fv%3D2itOq_vh9jY">plays</a> .  All clear?  I do not really.  The capture, in this game, is carried out according to completely unique rules.  The figure must "ride" on one or more side loops and hit the opponent's figure from behind.  But ZoG does not know how to animate such a complex movement!  As a result, the party turns into a rebus.  It would be nice, at the level of the game, to be able to connect your visualizer.  But, even in a ZRF file, the rules of visualization are mixed with the rules of AI.  It is clear that it was easier for developers, but now, 3D-visualization, so simple, is no longer connected (if only because it requires completely different resources). <br><br>  Summarizing this long article, you can see that most of the problems rest on closed source codes of the product.  If the source codes were open, it would be possible to "finish" the functionality and "tie" their visualizers.  It would be possible to achieve a better game for individual games, such as Chess, by adding their libraries of debuts and heuristics.  It would be possible to port the product to various platforms, including iOS and Android.  But there are no sources.  And if we have to write our own, we should not forget that we should not repeat the mistakes of others.  It is worth making the source open! <br></div><p>Source: <a href="https://habr.com/ru/post/221779/">https://habr.com/ru/post/221779/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221767/index.html">Monetization of gaming applications</a></li>
<li><a href="../221769/index.html">IT service or service in IT - how to make the client a little happier?</a></li>
<li><a href="../221771/index.html">Firefox 29+ interface and customization</a></li>
<li><a href="../221773/index.html">Programming is a career dead end?</a></li>
<li><a href="../221777/index.html">Tax deduction for programmers (program authors)</a></li>
<li><a href="../221781/index.html">Processes in the development of the payment system</a></li>
<li><a href="../221785/index.html">Ps. "" Anti "terrorist" package of bills</a></li>
<li><a href="../221789/index.html">Social media is nonsense. The Brandon Mendelsohn Book</a></li>
<li><a href="../221791/index.html">Berkshelf and Chef cookbook dependencies</a></li>
<li><a href="../221795/index.html">Zabbix + Communigate Pro: we monitor the message queue on the selected domains and hosts</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>