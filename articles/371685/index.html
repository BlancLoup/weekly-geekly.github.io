<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Smart home start</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The idea of ‚Äã‚Äãcreating a smart home (UD) originated in the head long before the appearance of your own house (apartment). From time to time I studied ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Smart home start</h1><div class="post__text post__text-html js-mediator-article">  The idea of ‚Äã‚Äãcreating a smart home (UD) originated in the head long before the appearance of your own house (apartment).  From time to time I studied articles about the smart home, looked for various solutions online and tried them on my own vision of the smart home.  Gradually, a picture of the future project emerged in my head.  And when the long-awaited moment came, the apartment was acquired, I began to put my ideas into practice.  I am a practitioner by nature, it‚Äôs easier for me to start immediately doing something in the gland without writing, unnecessary words, plans and calculations on paper, so the whole project was in my head and constantly adjusted. <br><br>  The choice was made at 99% in the direction of wired devices, plus all devices should be as low as possible.  Initially I planned to do everything on microcontrollers, but after learning about the existence of the Arduino, the choice fell on her, because  simplified manufacture of end devices, it was not necessary to make the board yourself. <br><br>  During the repair phase, a twisted pair cable was laid in all possible directions - lighting, windows, doors, radiators, water meters, heat meters, an electric meter, intercom, TV, computer, projector, air conditioning, access shield, motion sensors, balcony, all switches and sockets ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Power wiring was redone.  I refused the switchgear, and all the wiring from each chandelier, switch, sockets are tightened instead of installing an electrical panel.  Additionally, the power wiring is stretched to each window, to power the controllers and power supply for roller blinds.  In total, the two-room apartment took about 1 kilometer of various wires. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Electrical board</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b2e/3ac/fad/b2e3acfad55f490f9f1ab4cfe3764456.jpg"><br></div></div><br>  The heart of the system is the server based on the Asus EeeBox nettop, on which <a href="http://iobroker.net/">iobroker runs</a> .  All controllers communicate with the server using the MQTT protocol. <br><br>  In each window there is a room controller built on the Arduino UNO + Ethernet Shield W5100, each of which collects the following information: <br><br><div class="spoiler">  <b class="spoiler_title">Controller in the window frame</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/328/c54/2e7/328c542e7c254d3f86c42a2cad0906c4.jpg"><br><br><img src="https://habrastorage.org/files/d7a/902/eb9/d7a902eb946745d2968801ebf2aefc95.jpg"><br></div></div><br><ul><li>  radiator temperature (DS18b20) </li><li>  room temperature and humidity (DHT22) </li><li>  light level (photoresistor) </li><li>  CO sensor (MQ7, it is planned to replace it with a more reliable sensor) </li><li>  volume sensors (DSC LC-100PI, converted to 5V power supply, which has a built-in light sensor and CO sensor) <br><br><div class="spoiler">  <b class="spoiler_title">Volume sensor</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/c4c/f2a/6a4/c4cf2a6a4808443fa975d311030da23a.jpg"><br></div></div></li><li>  in the bedroom and living room, in addition, temperature sensors DS18b20, which are installed inside the KIP-125 intake valves </li><li>  servo-drive control (SG90) which is installed on the KIP-125 intake flap valves <div class="spoiler">  <b class="spoiler_title">Servo valve KIP-125</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/d66/1ba/288/d661ba288c3646358387d6753121c37c.jpg"><br></div></div></li><li>  open window sensor (reed switch) </li></ul><br>  The lighting is controlled by a separate controller built on the Arduino Mega + Ethernet Shield W5100. <br><br><div class="spoiler">  <b class="spoiler_title">Lighting Controller Assembly</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/94b/111/74d/94b11174deb24ca9870885123239beb1.jpg"><br></div></div><br>  The switches are the usual Schneider Electric reversible switches from the Unica series with a redesigned backlight for 5V.  The backlight is powered by a field effect transistor from the PWM lighting controller (CO). <br><br><div class="spoiler">  <b class="spoiler_title">Switch</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/242/6b3/4c0/2426b34c04fb4d39ba58d33dbe10502a.jpg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Alteration of the backlight switch under 5V</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/e6c/a22/5ce/e6ca225ce1ff40268d7558fe0561253a.jpg"><br></div></div><br>  Switches commute 12V which through the divider arrive at the input of the CO.  The KO program inverts the output state when the switch is switched, i.e.  if the light is on, switching the switch will turn off the light and vice versa.  The disadvantage of this decision is that the switches do not have the on / off position, and one of the advantages is the easy organization of the emergency mode, in which the switches switch the lighting relay (Finder) directly bypassing the CO. <br><br><div class="spoiler">  <b class="spoiler_title">Emergency mode fee</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/8a3/9cf/d27/8a39cfd27d2740b8bc8596b75c9071f2.jpg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Lighting Control Relay</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/a64/f80/399/a64f803993f34f92a85a30e60ca89e04.jpg"><br></div></div><br>  In the bathroom, in addition to the usual switch, there is a visitor counter on the IR sensors.  If visitors are greater than 0, the light is on. <br><br><div class="spoiler">  <b class="spoiler_title">Visitor counter to the bathroom</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b10/4b5/1e2/b104b51e26044db98066f4f55df7385d.jpg"><br></div></div><br>  Additionally, management and control of individual devices is organized: <br><br><ul><li>  The TV (LG, not smart) is not controlled via Ethernet, but is controlled via RS232.  To control the set Arduino UNO + Ethernet Shield W5100. <div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/77a/07d/46f/77a07d46fdf442ac86c16cf15e39ed97.jpg"><br></div></div></li><li>  A projector (BENQ) is similar to a television. </li><li>  The ONKYO receiver is controlled both via Ethernet and RS232, iobroker has a driver to control ONKYO receivers via ethernet, so it works out of the box. </li><li>  intercom control (Cyfral, coordinate).  The opening of the access door (on the relay) and the monitoring of the doorphone call are organized, when the doorphone calls on the TV, the image from the access camera is turned on, a message is received on the phone that contains a link to open the door. <br><br><div class="spoiler">  <b class="spoiler_title">Control intercom</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/88d/04d/355/88d04d3551e1447898f5a3325e6d4ac1.jpg"><br><br><img src="https://habrastorage.org/files/40e/8da/134/40e8da1344724edea1ef5fc6a0e5fde6.jpg"><br></div></div><br></li><li>  water heater control (Termex).  Management and control is organized on Arduino pro mini + NRF24, powered by a built-in heater management board.  Implemented on, off, switching the heating mode and setting the temperature.  Switching taps only with your hands, hot water is not often turned off, and spend ~ 5 tr.  There is no desire for cranes with a drive, so it does not strain.  How to turn off the hot water, I want to conduct an energy efficiency experiment, maintain the set water temperature around the clock, or turn off the water heater or lower the set temperature for the night and absence. <br><br><div class="spoiler">  <b class="spoiler_title">Water heater management from the web of the muzzle</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/cd8/398/38c/cd839838cc484cd0ba5cddc6bfc7d773.jpg"><br></div></div></li><li>  leakage protection system management (Aquastorozh).  Organized on a bunch of Arduino pro mini + NRF24. <br><br><div class="spoiler">  <b class="spoiler_title">Aquastorozhom management</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/5e8/55a/7dd/5e855a7dd9ce4ad883300810f4980fc2.jpg"><br></div></div></li><li>  water consumption meters (meters with pulse output).  I count impulses Arduino pro mini and give data on the UART controller ‚Äúbath‚Äù (Arduino UNO + Ethernet Shield W5100). <br><br><div class="spoiler">  <b class="spoiler_title">Water meter</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/6b8/330/14a/6b833014adf947448f7a8c1339a1101b.jpg"><br></div></div></li><li>  electricity meter (with pulse output).  I consider pulses as a water meter. </li></ul><br>  The management of the DD is organized through the web from both a computer and a phone or tablet.  Plus, the management of voice commands via the phone using the Tasker application is organized. <br><br><div class="spoiler">  <b class="spoiler_title">Automation Cabinet</b> <div class="spoiler_text">  Work chaos. <br><br><img src="https://habrastorage.org/files/dbd/faf/3ea/dbdfaf3eabf045c98b83f18546d8cfc4.jpg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Some more photos</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/34d/8c8/f3e/34d8c8f3ec754c49b772adf4b91e75b7.jpg"><br><br><img src="https://habrastorage.org/files/6a5/162/8e2/6a51628e2e1149e6b3a92f26b5ee4089.jpg"><br></div></div><br>  PS This is the first iteration of my DD and not all is completed yet.  If some moments will be interesting to readers, then I will reveal in more detail in the following articles. <br><br>  <a href="https://geektimes.ru/post/270140/">Part Two - Bathroom Visitor Counter</a> </div><p>Source: <a href="https://habr.com/ru/post/371685/">https://habr.com/ru/post/371685/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../371675/index.html">Monoglot Word - get rid of the excessive multilingualism of MS Office 2016 on Mac</a></li>
<li><a href="../371677/index.html">About the Spreadtrum SC7731G chipset using the example of a DEXP Ursus NS210 tablet</a></li>
<li><a href="../371679/index.html">Found a planet at a trillion kilometers away from its star</a></li>
<li><a href="../371681/index.html">US Congressmen want to ban the purchase of Russian RD-180 rocket engines</a></li>
<li><a href="../371683/index.html">Artificial intelligence for the first time in the world won a professional go</a></li>
<li><a href="../371687/index.html">How solitary confinement affects the brain</a></li>
<li><a href="../371689/index.html">Rutracker: summing up the preliminary results of the ‚Äúeternal‚Äù blocking</a></li>
<li><a href="../371691/index.html">Top 10 best videos Apple. Winter nostalgia</a></li>
<li><a href="../371693/index.html">AGAT - a bad copy of Apple?</a></li>
<li><a href="../371695/index.html">How to listen to Soviet citizens. A bit of history and modern realities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>