<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Scripting for budget activation (part 1)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago, I had the opportunity to participate in a large international project as part of an activation team. The essence of the project was to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Scripting for budget activation (part 1)</h1><div class="post__text post__text-html js-mediator-article">  Some time ago, I had the opportunity to participate in a large international project as part of an activation team.  The essence of the project was to automate the execution of a number of commands on Cisco equipment.  Development of activation scripts was conducted on JavaScript.  The main idea that I brought out of this project was that the development and debugging of JavaScript activation scripts is extremely time-consuming.  Intensive development was carried out for 1 year, and only our activation group included about 10 developers (testers required no less). <br><br>  In June of this year, local management already made me happy with a new activation project, in which Cisco routers changed to PBX Alcatel S12 and M200.  The second difference of this project was that I had to develop the entire activation part for me alone, from scratch, for half a year. <br><a name="habracut"></a><br>  Of course, I didn‚Äôt even think to use JavaScript or something similar for activation scripts.  I needed a budget script option.  After some reflection, I decided to store activation scripts in an Oracle database, using the following structure for storage: <br><br><img src="http://habrastorage.org/getpro/habr/post_images/2c5/d90/f71/2c5d90f71cf7923779eb20d667d3d723.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This diagram shows that the script parts (AE_SCRIPT_PART), which are a script (AE_SCRIPT) or a command (AE_COMMAND), are linked into a hierarchical structure using the AE_SUBSCRIPT table (originally AE_SCRIPT_PART simply contained the PARENT field referring to the same table, but this solution prevented the reuse of script fragments).  Table AE_SETTING is used to bind to the scripts and commands the values ‚Äã‚Äãof a number of settings defined by AE_SETTING_TYPE, such as the execution condition (if_condition) or the loop variable (for_each). <br><br>  Initially, it was possible to create command templates (AE_COMMAND_TEMPLATE) associated with a set of predefined settings, but this possibility was redundant and, at present, almost not used.  In fact, this data scheme allows you to store <a href="http://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a> . <br><br>  In order not to get lost in all this disgrace, parallel to the filling of the script in the database, the following Excel-file was kept: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/cc2/707/265cc2707c8318f2e3800853291bdd5b.png" alt="image"><br><br>  This made it possible to develop, but to transfer this work (or part of the work) to another employee, in this form, of course, was not possible.  Of course, I started thinking about more friendly scripting. <br><br>  About a month ago, I was asked to conduct a series of classes on the architecture of the new activation project (not only scripting, but the entire project as a whole).  When developing one of the presentations, the following picture was drawn: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd5/868/117/dd58681175ffb4ac99d440059c4e19de.png" alt="image"><br><br>  The text in the bottom arrow served as the prototype of the scripting language being developed.  I just thought that it would be nice using Perl, for example, to remove the script description from the database and present it in a compact, readable form in order to check it for errors. <br><br>  Then I thought a little more and decided to use PL / SQL, not Perl.  Indeed, with a single call to the stored procedure, I could generate the script text in CLOB, and it was no worse than the script in a text file.  Here is the result: <br><br><div class="spoiler">  <b class="spoiler_title">ae_scripting.sql</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">replace</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> <span class="hljs-keyword"><span class="hljs-keyword">body</span></span> ae_scripting <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> g_if_setting <span class="hljs-keyword"><span class="hljs-keyword">constant</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">'if_condition'</span></span>; g_foreach_setting constant varchar2(100) default 'foreach_var'; g_target_setting constant varchar2(100) default 'target_platform'; g_if_statement constant varchar2(100) default 'if'; g_foreach_statement constant varchar2(100) default 'foreach'; procedure extract(p_id in number) as cursor c_cmd is <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> d.id, d.nm, d.lv, d.type_id, p.name platform, t0.value target, f.direction_id direction <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> lv, sys_connect_by_path(to_char(c.nm, <span class="hljs-string"><span class="hljs-string">'00000'</span></span>), <span class="hljs-string"><span class="hljs-string">'/'</span></span>) pt, sys_connect_by_path(c.id, <span class="hljs-string"><span class="hljs-string">'.'</span></span>) nm, c.id <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, c.type_id <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> a.id <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, a.type_id type_id, b.parent_id parent_id, b.order_num nm <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ae_script_part a, ae_subscript b <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> b.child_id(+) = a.id ) c <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> c.id = p_id <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">prior</span></span> c.id = c.parent_id <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> pt ) d <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ae_script e <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (e.id = d.id) <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ae_command f <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (f.id = d.id) <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ae_platform p <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (p.id = e.platform_id) <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ae_setting t0 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (t0.object_id = d.id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> t0.setting_type_id = <span class="hljs-number"><span class="hljs-number">1000001</span></span>); r_cmd c_cmd%rowtype; cursor c_par(p_cmd_id number) is <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> t.name <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, s.value <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ae_script_part a <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ae_setting s <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (s.object_id = a.id) <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ae_setting_type t <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (t.id = s.setting_type_id) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> a.id = p_cmd_id <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> t.name, s.value <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ae_script_part a <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ae_command c <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (c.id = a.id) <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ae_setting s <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (s.object_id = c.template_id) <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ae_setting_type t <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> (t.id = s.setting_type_id) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> a.id = p_cmd_id; r_par c_par%rowtype; l_str varchar2(1000) default null; l_lob CLOB; l_lvl number default 0; l_plv number default 0; l_cnt number default null; l_stt varchar2(50) default null; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ae_script_src <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> = p_id; <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> ae_script_src(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (p_id, empty_clob()); <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-built_in"><span class="hljs-built_in">text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> l_lob <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ae_script_src <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> = p_id; dbms_lob.open(l_lob, dbms_lob.lob_readwrite); open c_cmd; loop fetch c_cmd into r_cmd; exit when c_cmd%notfound; while r_cmd.lv &lt;= l_plv loop l_str := ' ' || lpad('}', 2 * l_lvl) || chr(13) || chr(10); dbms_lob.writeappend(l_lob, length(l_str), l_str); l_plv := l_plv - 1; l_lvl := l_lvl - 1; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>; l_str := '[' || trim(to_char(r_cmd.id, '000000')) || '] '; if not r_cmd.direction is null then if r_cmd.direction = '1' then l_str := l_str || '&lt;'; else l_str := l_str || '&gt;'; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; else l_str := l_str || ' '; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; l_str := l_str || lpad(' ', 2 * r_cmd.lv); if not r_cmd.platform is null then l_str := l_str || 'platform:' || r_cmd.platform || '; '; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; if not r_cmd.target is null then l_str := l_str || 'target:' || r_cmd.target || '; '; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; open c_par(r_cmd.id); l_stt := null; loop fetch c_par into r_par; exit when c_par%notfound; if l_stt is null and r_par.name = g_if_setting then l_str := l_str || g_if_statement || ' (' || r_par.value || ') { '; l_stt := r_par.name; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; if l_stt is null and r_par.name = g_foreach_setting then l_str := l_str || g_foreach_statement || ' (' || r_par.value || ') { '; l_stt := r_par.name; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>; close c_par; open c_par(r_cmd.id); loop fetch c_par into r_par; exit when c_par%notfound; if l_stt is null or l_stt &lt;&gt; r_par.name then if r_par.name &lt;&gt; g_target_setting then l_str := l_str || r_par.name || ':' || r_par.value || '; '; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>; close c_par; <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> l_cnt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ae_subscript <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> parent_id = r_cmd.id; if r_cmd.type_id = 1 and l_cnt &gt; 0 then if l_stt is null then l_str := l_str || '{'; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; l_lvl := l_lvl + 1; l_plv := r_cmd.lv; else if not l_stt is null then l_str := l_str || ' }'; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; l_plv := r_cmd.lv - 1; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; l_str := l_str || chr(13) || chr(10); dbms_lob.writeappend(l_lob, length(l_str), l_str); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>; close c_cmd; while l_lvl &gt; 0 loop l_str := ' ' || lpad('}', 2 * l_lvl) || chr(13) || chr(10); dbms_lob.writeappend(l_lob, length(l_str), l_str); l_lvl := l_lvl - 1; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>; dbms_lob.close(l_lob); <span class="hljs-keyword"><span class="hljs-keyword">commit</span></span>; exception when others then if c_cmd%isopen then close c_cmd; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; if c_par%isopen then close c_par; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; if dbms_lob.isopen(l_lob) = 1 then dbms_lob.close(l_lob); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">rollback</span></span>; raise; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> ae_scripting; /</code> </pre> <br></div></div><br>  After building the connect by script tree with the query, the rest is almost trivial.  Some difficulties were associated only with generating the correct sequence of procedural brackets '{' and '}' that define nesting scripts.  For the if_condition and foreach_var settings, more familiar forms of the if and foreach statements are generated. <br><br>  Here is the result of the work of this (the whole script I do not cite): <br><br><div class="spoiler">  <b class="spoiler_title">1420.ae</b> <div class="spoiler_text"><pre> <code class="cpp hljs">[<span class="hljs-number"><span class="hljs-number">001420</span></span>] target:ats.type; foreach (params) { [<span class="hljs-number"><span class="hljs-number">003101</span></span>] platform:S<span class="hljs-number"><span class="hljs-number">-12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dou_off.dou = <span class="hljs-string"><span class="hljs-string">'REDIRECT_NOANSWER'</span></span>) { [<span class="hljs-number"><span class="hljs-number">031010</span></span>] &lt; text:MODIFY-SUBSCR:DN=K'%s,CFWD=DEACT&amp;CFWDNOR.; var_list:phone; [<span class="hljs-number"><span class="hljs-number">001041</span></span>] &gt; regexp:(.+); var_list:error_text; is_error:<span class="hljs-number"><span class="hljs-number">1</span></span>; [<span class="hljs-number"><span class="hljs-number">001008</span></span>] platform:M<span class="hljs-number"><span class="hljs-number">-200</span></span>; var_list:is_redirect_param = <span class="hljs-number"><span class="hljs-number">1</span></span>; } [<span class="hljs-number"><span class="hljs-number">003111</span></span>] platform:S<span class="hljs-number"><span class="hljs-number">-12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dou_off.dou = <span class="hljs-string"><span class="hljs-string">'REDIRECT_BUSY'</span></span>) { [<span class="hljs-number"><span class="hljs-number">031110</span></span>] &lt; text:MODIFY-SUBSCR:DN=K'%s, CFWD=DEACT&amp;CFWDBSUB.; var_list:phone; [<span class="hljs-number"><span class="hljs-number">001041</span></span>] &gt; regexp:(.+); var_list:error_text; is_error:<span class="hljs-number"><span class="hljs-number">1</span></span>; [<span class="hljs-number"><span class="hljs-number">001008</span></span>] platform:M<span class="hljs-number"><span class="hljs-number">-200</span></span>; var_list:is_redirect_param = <span class="hljs-number"><span class="hljs-number">1</span></span>; } [<span class="hljs-number"><span class="hljs-number">003121</span></span>] platform:S<span class="hljs-number"><span class="hljs-number">-12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dou_off.dou = <span class="hljs-string"><span class="hljs-string">'REDIRECT_AUTOINF'</span></span>) { [<span class="hljs-number"><span class="hljs-number">031210</span></span>] &lt; text:MODIFY-SUBSCR:DN=K'%s, CFWD=DEACT&amp;CFWDFIXA.; var_list:phone; [<span class="hljs-number"><span class="hljs-number">001041</span></span>] &gt; regexp:(.+); var_list:error_text; is_error:<span class="hljs-number"><span class="hljs-number">1</span></span>; [<span class="hljs-number"><span class="hljs-number">001008</span></span>] platform:M<span class="hljs-number"><span class="hljs-number">-200</span></span>; var_list:is_redirect_param = <span class="hljs-number"><span class="hljs-number">1</span></span>; } [<span class="hljs-number"><span class="hljs-number">003131</span></span>] platform:S<span class="hljs-number"><span class="hljs-number">-12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dou_off.dou = <span class="hljs-string"><span class="hljs-string">'REDIRECT'</span></span>) { [<span class="hljs-number"><span class="hljs-number">031310</span></span>] &lt; text:MODIFY-SUBSCR:DN=K'%s, CFWD=DEACT&amp;CFWDUVAR.; var_list:phone; [<span class="hljs-number"><span class="hljs-number">001041</span></span>] &gt; regexp:(.+); var_list:error_text; is_error:<span class="hljs-number"><span class="hljs-number">1</span></span>; [<span class="hljs-number"><span class="hljs-number">001008</span></span>] platform:M<span class="hljs-number"><span class="hljs-number">-200</span></span>; var_list:is_redirect_param = <span class="hljs-number"><span class="hljs-number">1</span></span>; } [<span class="hljs-number"><span class="hljs-number">003071</span></span>] platform:S<span class="hljs-number"><span class="hljs-number">-12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dou_off.dou = <span class="hljs-string"><span class="hljs-string">'SET_ALARM_CLOCK'</span></span>) { [<span class="hljs-number"><span class="hljs-number">030710</span></span>] &lt; text:MODIFY-SUBSCR:DN=K'%s,ALMCALL=DEACT.; var_list:phone; [<span class="hljs-number"><span class="hljs-number">001041</span></span>] &gt; regexp:(.+); var_list:error_text; is_error:<span class="hljs-number"><span class="hljs-number">1</span></span>; [<span class="hljs-number"><span class="hljs-number">001009</span></span>] var_list:is_alarm_param = <span class="hljs-number"><span class="hljs-number">1</span></span>; } }</code> </pre><br></div></div><br>  Each line of the script (with the exception of closing procedural brackets) defines a script or command.  The command is determined by the symbols '&lt;' and '&gt;', which determine the direction of data transfer (to and from equipment).  Settings are determined by the following sequence: <br><br><pre> <code class="sql hljs">&lt; &gt;:&lt;&gt;;</code> </pre><br>  The symbol ';'  is a settings separator and should not be used inside the setting value (generally speaking, in S12 commands this symbol is used as a command separator, but I finish the commands with the symbol '.' and the need to use ';' within the command does not arise).  In any case, it is not at all difficult to add shielding of service characters within values. <br><br>  An important but not obligatory part of the script is the numbers in square brackets.  These are the recommended ID values ‚Äã‚Äãfor placing a script or command in the database.  By specifying the same ID value for commands or scripts, you can achieve re-use of a script fragment (provided that the marked fragments are really identical) by placing this fragment in the database once.  If the ID value is not specified, it is assigned automatically when the script is loaded into the database. <br><br>  So, I learned how to extract scripts from the description in the database and present them in a compact and visual form, but the appetite comes with eating, and I want more.  Indeed, how great it would be to be able to fix the script in text form and load it back into the database. <br><br>  In the next <a href="http://habrahabr.ru/post/165101/">article</a> , I will deal with the implementation of this feature. <br></div><p>Source: <a href="https://habr.com/ru/post/162865/">https://habr.com/ru/post/162865/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../162851/index.html">6 Ways to kill Agile</a></li>
<li><a href="../162855/index.html">We test the site on game consoles. Part I</a></li>
<li><a href="../162857/index.html">International Student School CSEDays on algorithms and complexity theory</a></li>
<li><a href="../162859/index.html">Casper free font that is not on Google Web Fonts</a></li>
<li><a href="../162863/index.html">Interview with Jeff "Cheezy" Morgan</a></li>
<li><a href="../162867/index.html">Ainol Launches Novo 9 Firewire Tablet Computer with Quad-Core Processor and Retina Display for $ 230</a></li>
<li><a href="../162873/index.html">How much does an iOS developer earn?</a></li>
<li><a href="../162875/index.html">IT Career Map</a></li>
<li><a href="../162877/index.html">Autonomous radio Thermometer on msp430, NRF24L01 + and solar powered</a></li>
<li><a href="../162881/index.html">Integration of the 1C-Bitrix template</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>