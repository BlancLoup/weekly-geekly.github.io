<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to work with MS Access in Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many people use Acces ... even in production ... even to this day. Therefore, there are times when someone wants to connect to this database from some...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to work with MS Access in Linux</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/ba7/72e/f3e/ba772ef3e07c4fc796398a051133458c.png" align="left">  Many people use <a href="https://en.wikipedia.org/wiki/Microsoft_Access">Acces</a> ... even in production ... even to this day.  Therefore, there are times when someone wants to connect to this database from some unexpected place.  For example, from a unix server.  Of course, you want to connect for a reason, and to use data from Access in a web application.  And, without any doubt, there will be a desire to use this data together with information from other, more modern databases. <br><br>  So, I want to describe several approaches to communicating with a creature called MS Access.  Therefore, the initial task is as follows: establish a connection with MS Access from a Ruby on Rails application or from PostgreSQL (using <a href="https://wiki.postgresql.org/wiki/Foreign_data_wrappers">FDW</a> ) and access data, preferably in real time. <br><br>  Below I will try to collect all the information related to the task described above and try to describe non-trivial cases and underwater stools.  I hope this description will save time for someone ... or just, to some extent, amuse the respected audience. <br><a name="habracut"></a><br>  Immediately <a href="https://habr.com/ru/post/309126/">tldr</a> for those who are only interested in the facts and opinion of the author on this issue. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Conversion to CSV </h4><br>  To begin with, I will describe a simple working solution.  It is guaranteed to work on Ubuntu 14.04.  Should work on other Linux distributions.  And does not require any <s>higher / sacred</s> knowledge, skills and other magic. <br><br>  There is such a thing <a href="http://mdbtools.sourceforge.net/">mdbtools</a> .  It is put very simply: <br><br><pre><code class="bash hljs">sudo apt-get install mdbtools</code> </pre> <br>  Details about its dependencies, manual build, package features, and much more can be found on the <a href="https://github.com/brianb/mdbtools">GitHub page</a> . <br><br>  This package provides a bunch of different tools for working with Access.  We will not consider the whole bunch, but dwell on one thing.  The one that can turn mdb files into csv: <br><br><pre> <code class="bash hljs">mdb-export <span class="hljs-string"><span class="hljs-string">'mdb-file'</span></span> <span class="hljs-string"><span class="hljs-string">'table-name'</span></span> &gt; result.csv</code> </pre> <br>  As a result, we obtain a csv-file with the contents of the specified table.  Further, this file can be subjected to all conceivable and inconceivable treatments and tortures, because csv is an insanely simple and widespread format. <br><br><h3>  Query execution in MS Access </h3><br>  Now a more difficult task: to execute a SQL query, having in your hands an mdb file and a machine with something unix.  It is not hard to guess that you need to put a couple more packages and create several configs. <br><br>  First, you'll need <a href="https://en.wikipedia.org/wiki/Open_Database_Connectivity">ODBC</a> .  This is the standard API for communicating with the database.  In Unix, <a href="http://www.unixodbc.org/">unixODBC</a> exists for this purpose.  Its installation is very simple: <br><br><pre> <code class="bash hljs">sudo apt-get install unixodbc libmdbodbc1</code> </pre> <br>  The second package contains <i>libmdbodbc.so</i> , which will be needed just below. <br><br>  The next step is to find a suitable ODBC driver for MS Access.  The closest available driver is from mdbtools.  Next, you need to dig into the configs: describe the driver and declare the database. <br><br>  The driver is described in <b>/etc/odbcinst.ini</b> : <br><br><pre> <code class="bash hljs">[MDBTools] Description = MDBTools Driver Driver = libmdbodbc.so Setup = libmdbodbc.so FileUsage = 1 UsageCount = 1</code> </pre><br>  And the database is announced in /etc/odbc.ini: <br><br><pre> <code class="bash hljs">[testdb] Description = <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> Driver = MDBTools Database = /opt/db/MS_Access.mdb</code> </pre> <br>  It is worth noting that in the ‚ÄúDriver‚Äù you need to specify the name of the driver, which is described in odbcinst.ini. <br><br>  More about odbcinst.ini and odbc.ini can be found <a href="http://www.gdal.org/drv_pgeo.html">here</a> . <br><br>  So, the configuration is done.  Now you can proceed to query.  For this purpose, we use the <a href="http://manpages.ubuntu.com/manpages/trusty/en/man1/isql.1.html">isql</a> utility from the unixODBC package: <br><br><pre> <code class="bash hljs">isql testdb</code> </pre> <br>  If everything is done correctly, then a console should appear to execute queries: <br><br><pre> <code class="bash hljs">SQL&gt; SELECT * from <span class="hljs-string"><span class="hljs-string">""</span></span> +------------+-----------------------------------------------------+ |  |  | +------------+-----------------------------------------------------+ | 1 |  | | 2 |   | | 3 |  | | 4 |  | +------------+-----------------------------------------------------+ SQLRowCount returns 4 4 rows fetched</code> </pre> <br>  Lastly, it is worth noting that there is an analogue of isql with unicode support.  It is called iusql. <br><br><h4>  Oddities isql </h4><br>  To be honest, the isql utility is quite easy.  It has a lot of restrictions on syntax and no user friendliness and understanding.  For example: put a semicolon at the end of the expression - get an error and try to guess what it is.  There are no tips, tips and other delights of modern development here.  This is not PotgreSQL, which will kindly say that you were mistaken in the expression and suggest the correct version.  Here you just send and do not even tell the reason.  Therefore, for at least some ease of working with isql, the <a href="https://github.com/DuGuille/pyodbc-cli">pyodbc-cli</a> shell was created.  With its help, you can somehow weaken the fight against isql and focus on writing queries. <br><br><h4>  Exotic table / column encodings </h4><br>  There are a lot of rumors about the 'Charset' parameter, which affects the staked page used.  Here is an example of using this parameter: <br><br><pre> <code class="bash hljs">[testdb] Description = <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> Driver = MDBTools Database = /opt/db/MS_Access.mdb Charset = CP1251</code> </pre><br>  The effect of this parameter on the work of isql was not observed. In isql, I can work with both mdb files containing Cyrillic and regular Unicode mdb files.  At the same time, the iusql utility, regardless of the 'Charset' parameter, produced many question marks (like these::) when working with a Cyrillic mdb file. <br><br><h4>  Alternatives for isql </h4><br>  The alternative for isql is <a href="http://linux.die.net/man/1/mdb-sql">mdb-sql</a> from the mdbtools package.  Ini-files are not needed for this utility.  You just need to set it on a specific mdb file: <br><br><pre> <code class="bash hljs">mdb-sql /opt/db/MS_Access.mdb</code> </pre> <br>  The <a href="http://linux.die.net/man/1/mdb-sql">man page</a> will respond well to all questions about using the utility.  The only feature: the utility could not swallow the above Cyrillic mdb file.  There were no problems with Unicode files. <br><br><h3>  Ruby / Rails Path </h3><br>  It is now the middle of 2016, the last release of MS Access was on September 22, 2015.  But bad luck, the latest work on the adapter for ActiveRecord is dated 2008.  Therefore, I, as is customary, have two news: good and bad. <br><br>  I'll start with the good: there is an <a href="https://github.com/fhwang/odbc-rails">odbc-rails</a> and its reincarnation <a href="https://github.com/dosire/activerecord-odbc-adapter">activerecord-odbc-adapter</a> . <br><br>  And now the bad: as noted above, the latest commits to the adapter's repository are dated 2008 and support for Rails and ActiveRecord versions one and two is announced;  therefore, I do not know how to run it on Rails 3+ (and can it even be done at all).  The reasons for my ignorance are approximately as follows.  First: the adapter has bad documentation (or rather its absence).  And secondly: there is no desire to go into the source, to understand and bring them back to life.  So if you have enough knowledge, experience and time - you can finish and describe how to use it.  Good luck in this case! <br><br><h4>  Ruby-ODBC </h4><br>  Since everything is sad with the adapter, you can look in other directions.  One side is called <a href="https://github.com/larskanis/ruby-odbc">ruby-odbc</a> . <br><br>  The last update of this heme is dated 2011, but, at the moment, it is more or less working.  To install the heme you need to perform some simple steps: <br><br><pre> <code class="bash hljs">sudo apt-get install unixodbc unixodbc-dev gem install ruby-odbc</code> </pre> <br>  Without the unixodbc-dev package, compiling the native extension will fail with the error: <u>ERROR: sql.h not found</u> . <br><br>  Further, we assume that ODBC is configured in the system (that is, <b>odbcinst.ini</b> and <b>odb.ini</b> are present).  In this case, you can open irb and do the following: <br><br><pre> <code class="ruby hljs"><span class="hljs-number"><span class="hljs-number">001</span></span> &gt; <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'odbc'</span></span> =&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-number"><span class="hljs-number">002</span></span> &gt; client = ODBC.connect(<span class="hljs-string"><span class="hljs-string">"testdb"</span></span>) =&gt; #&lt;odbc::database:0x00000000e38d98&gt; <span class="hljs-number"><span class="hljs-number">003</span></span> &gt; statement = client.prepare <span class="hljs-string"><span class="hljs-string">'SELECT * FROM ""'</span></span> =&gt; #&lt;odbc::statement:0x00000000e11608 @_a="[]," @_h="{}," @_c0="{}," @_c1="{}," @_c2="{}," @_c3="{}"&gt; <span class="hljs-number"><span class="hljs-number">004</span></span> &gt; statement.execute =&gt; #&lt;odbc::statement:0x00000000e11608 @_a="[]," @_h="{}," @_c0="{}," @_c1="{}," @_c2="{}," @_c3="{}"&gt; <span class="hljs-number"><span class="hljs-number">005</span></span> &gt; first_row = statement.fetch =&gt; [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"\xD0\x94\xD0\xBE\xD0\xBA\xD1\x83\xD0\xBC\xD0\xB5\xD0\xBD\xD1\x82\xD0\xB0\xD1\x86\xD0\xB8\xD1\x8F\x00"</span></span>] <span class="hljs-number"><span class="hljs-number">006</span></span> &gt; first_row[<span class="hljs-number"><span class="hljs-number">1</span></span>].force_encoding(<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>) =&gt; <span class="hljs-string"><span class="hljs-string">"\u0000"</span></span></code> </pre> <br>  More information about the syntax and available ruby-odbc heme commands can be found in the <a href="https://github.com/larskanis/ruby-odbc/tree/master/test">ruby-odbc / test</a> directory on GitHub. <br><br><h4>  Mdb gem </h4><br>  <a href="https://github.com/cph/mdb">This gem</a> provides DSL'ku to work with mdb-files.  And she looks pretty cute.  But there is a nuance: gem is just a ruby ‚Äã‚Äãwrapper over the above described mdbtools.  That is, the hem converts mdb to csv and processes this csv in memory.  No magic and direct access to the database. <br><br><h3>  Alternative to ODBC driver </h3><br>  There is a <a href="http://www.easysoft.com/products/data_access/odbc-access-driver/index.html">commercial version of the ODBC driver for MS Access</a> .  But there is no factual information about him.  In the optimistic version, this adapter will help with advanced queries in Access (the driver from mdbtools does not know much: no LIMIT, GROUP, AS, etc.).  But this is only speculation.  What will be in fact can be found only by buying it, or by taking a 14-day trial, which is available after registering on the site.  In addition to this information, there were neither user reviews, nor any bug reports, nor any references to the fact that someone used the driver and he helped him with something. <br><br><h3>  PotgreSQL Path </h3><br>  For Postgres, there is an extension <a href="https://github.com/pramsey/pgsql-ogr-fdw">OGR</a> .  It is part of <a href="http://www.gdal.org/">GDAL</a> .  Which, in turn, is a huge library for converting raster and vector formats of geospatial data.  For our current purposes, the purpose of the library has absolutely no meaning.  The main thing is that it is stated that it can work with mdb-format. <br><br><h4>  Installation </h4><br>  First you need to put a few dependencies: <br><br><pre> <code class="bash hljs">sudo apt-get install gdal-bin libgdal-dev sudo apt-get install postgis postgresql-9.3-postgis-2.1</code> </pre> <br>  This team will pull in a ton of dependencies ... but this is normal.  The first set of packages for ogr_fdw, the second for postgis. <br><br>  Step two: gather <a href="https://github.com/pramsey/pgsql-ogr-fdw">pgsql-ogr-fdw</a> from sources.  Here is a small bash-style manual: <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git@github.com:pramsey/pgsql-ogr-fdw.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> pgsql-ogr-fdw sudo apt-get install postgresql-server-dev-9.3 sudo apt-get install checkinstall make sudo checkinstall</code> </pre> <br>  Yes, you can take make install, but we do not want the <a href="https://habrahabr.ru/post/130868/">seals to suffer</a> .  In the dialog that appears from checkinstall, it is necessary to correct the ‚Äúversion‚Äù parameter.  It is necessary to make it in the format "numbers separated by dots" (for example: '0.1.0').  Otherwise, with default values, the package build will drop. <br><br>  Step three: go and put the extensions in Postgres: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> EXTENSION ogr_fdw; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> EXTENSION postgis;</code> </pre> <br>  There is a suspicion that postgis is superfluous, but in the Readme on GitHub it is said that both are needed, therefore I will leave this question to inquisitive readers. <br><br>  Step four: time to create FDW.  In ogr_fdw there are two possible ways to work with Access.  The first uses system ODBC.  Details on this option can be found <a href="http://www.gdal.org/drv_odbc.html">here</a> .  The second is more interesting, uses the MDB format from OGR, which provides direct access to the file using <a href="http://jackcess.sourceforge.net/">Jackcess</a> .  Details on this option are <a href="http://www.gdal.org/drv_mdb.html">here</a> .  Below I will describe both ways. <br><br>  Finally, one note: OGR is an extremely powerful thing;  The ability to work with MS Access is a small part of the whole variety of available formats and, dear reader, it may quite reasonably be said that this is firing from a cannon on sparrows ... but the choice is not great and there has been no other tool to find it.  And yes, here is a <a href="http://www.gdal.org/ogr_formats.html">list of all formats supported by OGR</a> . <br><br><h4>  ORG ODBC format </h4><br>  This approach uses the ODBC system settings and works by analogy with the above osql and ruby-odbc, but inside the database.  All available options for initializing FDW are presented on the <a href="http://www.gdal.org/drv_odbc.html">GDAL ODBC driver</a> page.  Below I will give only a simple example of use. <br><br>  Actually, here it is: <br><br><pre> <code class="sql hljs">postgres=<span class="hljs-comment"><span class="hljs-comment"># CREATE SERVER testdb_access postgres-# FOREIGN DATA WRAPPER ogr_fdw postgres-# OPTIONS( postgres(# datasource 'ODBC:testdb', postgres(# format 'ODBC'); CREATE SERVER postgres=# CREATE FOREIGN TABLE access_sections ( postgres(# "" decimal, postgres(# "" varchar) postgres-# SERVER testdb_access postgres-# OPTIONS (layer ''); CREATE FOREIGN TABLE postgres=# SELECT * FROM access_sections; ERROR: unable to connect to layer to "" HINT: Does the layer exist?</span></span></code> </pre> <br>  As far as I understood from the OGR, layer documentation, in our case, it is equivalent to the database table. <br><br>  A list of all layers can be obtained using the <a href="http://www.gdal.org/ogrinfo.html">ogrinfo</a> utility: <br><br><pre> <code class="bash hljs">$ ogrinfo -al <span class="hljs-string"><span class="hljs-string">'ODBC:testdb'</span></span> geometry_columns is not a table <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> this database Got no result <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-string"><span class="hljs-string">'SELECT f_table_name, f_geometry_column, geometry_type FROM geometry_columns'</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> INFO: Open of `ODBC:testdb<span class="hljs-string"><span class="hljs-string">' using driver `ODBC'</span></span> successful.</code> </pre> <br>  Based on this message, we can assume that everything works, but the target database (that is, the mdb file) does not contain the required Geo-data format and the OGR stumbles upon this unfortunate misunderstanding.  I do not know how to wean him to forcefully check the format of the provided database.  But <a href="http://www.postgresonline.com/journal/archives/346-Querying-MS-Access-and-other-ODBC-data-sources-with-OGR_FDW.html">some write</a> that this approach works fine under Windows.  In general, if you know how to reason with OGR ODBC and get it to work with an arbitrary mdb file, please say so, do not keep this knowledge in yourself. <br><br>  A separate question: how PG will work with Cyrillic (and with any other non-Latin) table and column names.  On the one hand, Postgres doesn't matter what the table / column name is, wrap them in double quotes and at least you can use special characters.  On the other hand: who knows whether it is applicable to FDW, and it is not yet possible to check on a specific example. <br><br><h4>  ORG MDB format </h4><br>  This approach is based on the <a href="http://jackcess.sourceforge.net/">Jackcess</a> Java library.  Since this is Java and it has its own rich inner world, this approach has no links with system ODBC and, therefore, problems with drivers for MS Access are alien to it.  But there are other features that I will describe below. <br><br>  Immediately I‚Äôll warn you that due to the ‚Äúrich‚Äù documentation on the entire described process, the lack of extensive experience with Java and some monstrosity of the target package, we were able to assemble the working version in 3 days and ~ 20 complete rebuilds of the package.  Therefore, I will immediately say about some things: <br><br><ul><li>  This approach is only suitable for working with unencrypted mdb files (that is, with files without a password); </li><li>  since this is a package build, all the dependencies described below, paths, versions, and other attributes are valid for my particular case and environment, you may not be able to do this at all, and it‚Äôs not recommended to copy and paste commands. </li></ul><br>  So, everything written below is a more detailed version of the original official description of the <a href="http://www.gdal.org/drv_mdb.html">GDAL ACCESS MDB database driver</a> . <br><br>  First: you need to put openjdk-6-jdk. <br><br><pre> <code class="bash hljs">sudo apt-get install openjdk-6-jdk</code> </pre> <br>  After a <a href="https://github.com/OSGeo/gdal">brief</a> , thoughtful reading of the <a href="https://github.com/OSGeo/gdal">source code for GDAL</a> , it <a href="https://github.com/OSGeo/gdal">seemed</a> that he supported openjdk-7-jdk.  But I could not get it to work with the 7th version. <br><br>  Next, you need libgdal-dev. <br><br><pre> <code class="bash hljs">sudo apt-get install libgdal-dev</code> </pre> <br>  Here you need to remember the version of the package.  It is directly related to the version of the GDAL package.  In my case, this is version <u>1.10.1</u> . <br><br>  <u><b>Note:</b></u> mdb format support starts from version <u>1.9.0</u> . <br><br>  And lastly, you need to demolish the gdal-bin package, since we are going to build the extended version of it from source. <br><br><pre> <code class="bash hljs">sudo apt-get remove gdal-bin</code> </pre> <br>  Secondly: you need to download several JARs (ancient and not so), namely: jackcess-1.2.2.jar, commons-lang-2.4.jar and commons-logging-1.1.1.jar;  then put them in lib / ext.  In my case, the full path to this directory is: <b>/ usr / lib / jvm / java-6-openjdk-amd64 / jre / lib / ext</b> .  The aforementioned versions of JARs can be found inside <a href="">this utility</a> .  For me, everything works with any later version of commons-logging (1. *), with any other minor version of commons-lang (2. *) and jackcess (1. *).  Errors appeared only when using the next major jaccess version (2.1.4). <br><br>  Thirdly: you need to download and configure GDAL. <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git@github.com:OSGeo/gdal.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> gdal/gdal/ git checkout 1.10</code> </pre> <br>  Here you need to go to the branch corresponding to the version of the libgdal-dev package, which was installed in the item number of times.  Otherwise, the compiled binary will be incompatible with libraries. <br><br>  Next you need to call configure.  There are two ways to call.  Plain: <br><br><pre> <code class="bash hljs">./configure --with-java=yes --with-jvm-lib-add-rpath=yes --with-mdb=yes</code> </pre>  and with explicit directions: <br><br><pre> <code class="bash hljs">./configure --with-java=/usr/lib/jvm/java-6-openjdk-amd64 \ --with-jvm-lib=/usr/lib/jvm/java-6-openjdk-amd64/jre/lib/amd64/server \ --with-jvm-lib-add-rpath=yes \ --with-mdb=yes</code> </pre><br>  The second option may be useful if there are several versions of Java on the system (for example, openjdk-6-jdk and openjdk-7-jdk) or if the first option did not produce the desired result. <br><br>  After the end of configure, you need to find the cherished word 'yes' opposite the MDB format. <br><br>  Fourthly: you need to find a cup of tea / coffee or something stronger and run the assembly package. <br><br><pre> <code class="bash hljs">sudo checkinstall</code> </pre> <br>  Here you need to answer a couple of simple questions and wait.  In my case, it was necessary to wait about 10 minutes. <br><br>  Here it should be noted that the package will be weighty, about 300MB.  Of course, you can throw out all unnecessary from it, collect it with your hands and approach the size of the gdal-bin package from the repository (~ 900Kb), but this goes beyond the narrative and, therefore, will not be described. <br><br>  Fifth: if something went wrong, the package build fell off, then Google and a bright mind to help you. <br><br>  Sixthly: if everything went well, then after checkinstall the package should have been automatically installed and now you need to check whether the received binaries support the mdb format: <br><br><pre> <code class="bash hljs">$ ogrinfo --formats | grep MDB -&gt; <span class="hljs-string"><span class="hljs-string">"MDB"</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">readonly</span></span>)</code> </pre><br>  If there was no information about mdb in the ogrinfo output, go to the beginning of this section, re-read the manuals, look at the dependencies, system parameters, <a href="https://habrahabr.ru/post/308462/">moon phase</a> and other attributes that may affect the compilation and the final binary, and try to rebuild the whole economy again. <br><br>  If the team and the output match, then everything is fine and the most muddy part is behind.  Now ogrinfo can work with mdb files and provide information about their contents: <br><br><pre> <code class="bash hljs">$ ogrinfo /opt/db/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>-database.mdb INFO: Open of `/opt/db/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>-database.mdb<span class="hljs-string"><span class="hljs-string">' using driver `MDB'</span></span> successful. 1: closeouts 2: economics</code> </pre><br>  Seventh: you can now configure FDW in Postgres.  Here is a small script with an example of this action: <br><br><pre> <code class="sql hljs">postgres=<span class="hljs-comment"><span class="hljs-comment"># CREATE SERVER acc FOREIGN DATA WRAPPER ogr_fdw OPTIONS ( datasource '/opt/db/test-database.mdb', format 'MDB' ); CREATE SERVER postgres=# CREATE FOREIGN TABLE economics( ID integer) SERVER acc OPTIONS(layer 'economics'); CREATE FOREIGN TABLE postgres=# SELECT * FROM economics; id ---- 1 2 3 4 5 (5 rows)</span></span></code> </pre><br>  And, in general, everything.  In conclusion of this section I will say a few words about the "encrypted" mdb-files. <br><br>  If FDW cannot pull data out of Access, ogrinfo swears like this: <br><br><pre> <code class="bash hljs">Exception <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> thread <span class="hljs-string"><span class="hljs-string">"main"</span></span> com.healthmarketscience.jackcess.UnsupportedCodecException: Decoding not supported. Please choose a CodecProvider <span class="hljs-built_in"><span class="hljs-built_in">which</span></span> supports reading the current database encoding. at com.healthmarketscience.jackcess.DefaultCodecProvider<span class="hljs-variable"><span class="hljs-variable">$UnsupportedHandler</span></span>.decodePage(DefaultCodecProvider.java:115)</code> </pre><br>  then, most likely, you have a password-protected mdb file.  In this case, you should look at the <a href="http://jackcess.sourceforge.net/faq.html">FAQ from Jaccess</a> and think about finishing the OGR Access driver.  As far as I understand, there is a project <a href="http://jackcessencrypt.sourceforge.net/">Jackcess Encrypt</a> .  This project provides CryptCodecProvider, which, in turn, provides an implementation of the CodecProvider interface for Jackess and supports some encryption formats for mdb files.  But, unfortunately, the current driver from GDAL does not know how to work with Jackcess Encrypt and, therefore, does not support encrypted files.  So, there is a good direction to work in the open source camp. <br><br><h3>  Other FDW </h3><br>  A list of all existing FDW for Postgres can be found on the <a href="https://wiki.postgresql.org/wiki/Foreign_data_wrappers">official wiki page</a> .  There is a <a href="https://github.com/ZhengYang/odbc_fdw">ZhengYang / odbc_fdw</a> , in which the last commit is dated 2011.  And <a href="https://github.com/CartoDB/odbc_fdw">CartoDB / odbc_fdw</a> , which is actively developed and supports Postgres 9.5+.  So the choice is small. <br><br><h3>  Conclusion </h3><a name="tldr"></a><br>  Working with MS Access is painful ... doubly painful if you need to do it under Linux.  So immediately good advice: pull data from any data into any modern database and get rid of the car of problems.  If you can not pull out, then work with the access in Windows.  There is a normal driver provided by Microsoft "out of the box", there are at least some articles and configuration examples about the docking of Access and Postgres in Windows and, in general, products of the same company usually work well with each other.  If there is no such possibility either, then you have two options again: turn everything into CSV and work with it or try to directly access the mdb file.  The first option is simple, works out of the box and does not require special skills.  The second option is much more complicated, takes time, nerves, straight arms, has a set of restrictions, pitfalls and other unpleasant things.  Therefore, choose wisely. <br><br><h3>  Links </h3><br><ul><li>  <a href="http://www.sarasafavi.com/installing-gdalogr-on-ubuntu.html">The blog of a certain girl SARA SAFAVI about GDAL / OGR under Ubuntu</a> </li><li>  <a href="http://stackoverflow.com/questions/13420653/odbc-connection-to-ms-access-on-ubuntu/13428683">MS Access Stackoverflow for Ubuntu</a> </li><li>  <a href="https://www.opennet.ru/openforum/vsluhforumID9/8157.html">OpenNet thread</a> </li><li>  and many many links courtesy of good <a href="https://www.google.com/">google</a> corporation </li></ul></div><p>Source: <a href="https://habr.com/ru/post/309126/">https://habr.com/ru/post/309126/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309110/index.html">Logic hoster: not caught - not a thief. How to prove the opposite. Service Overview HostTracker Part 3</a></li>
<li><a href="../309112/index.html">Huawei Connect 2016 Shanghai</a></li>
<li><a href="../309114/index.html">Visualization of the photo portfolio. Part 2: Word embedding</a></li>
<li><a href="../309118/index.html">Alexey Ragozin on JVM diagnostic interfaces on jug.msk.ru</a></li>
<li><a href="../309124/index.html">LXC in QoS service (replace ifb with veth)</a></li>
<li><a href="../309128/index.html">Automating the maintenance of correspondence between the names of layers in the editor and code using CodeDom</a></li>
<li><a href="../309130/index.html">Communication Arrangements</a></li>
<li><a href="../309132/index.html">Once again about the benefits of backups or the story of my failure</a></li>
<li><a href="../309136/index.html">ADM interface - what is ‚ÄúTetrad‚Äù</a></li>
<li><a href="../309138/index.html">Learning OpenGL ES2 for Android Lesson ‚Ññ4. Textures</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>