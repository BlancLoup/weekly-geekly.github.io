<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WIKIzualize it, WIKIzualize it!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good evening, dear friends! 

 Recently, walking through the vast expanses of the Internet, I came across the amazing work of Chris Harrison , after s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WIKIzualize it, WIKIzualize it!</h1><div class="post__text post__text-html js-mediator-article">  Good evening, dear friends! <br><br>  Recently, walking through the vast expanses of the Internet, I came across the amazing work of <a href="http://www.chrisharrison.net/">Chris Harrison</a> , after sitting a little in shock, I thought, ‚ÄúIs it hard to visualize Wikipedia or not?‚Äù And decided to try it! <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/6a9/c8e/0da/6a9c8e0daa9092ee76acd670c98c3679.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So let's get started! <br><a name="habracut"></a><br><br><h2>  Instruments and tools </h2><br>  First of all, it is necessary to decide what we will visualize and by what means.  And having a little studied what is and how my choice fell on the following means: <br><ul><li>  <a href="http://en.wikipedia.org/w/api.php">MediaWiki API</a> </li><li>  <a href="http://www.python.org/">Python language</a> </li><li>  <a href="http://networkx.lanl.gov/pygraphviz/">PyGraphviz module</a> </li></ul><br><br>  The developers of the Wiki API described it just fine, so you should not translate the description literally to understand how to call one or another method. <br><br>  On Habr√© already wrote about the package Graphviz, so I think you should not re-describe it.  But I immediately read the description of the dot language and <a href="http://lib.custis.ru/index.php/Graphviz">graphviz</a> tools and <a href="http://lib.custis.ru/index.php/Graphviz">I</a> almost started writing my own .dot files. <br><br>  I was rescued by a python module called PyGraphviz, which allows you to conveniently work with the structure of the graph, which is then written into a .dot file. <br><br><h2>  The basics </h2><br>  So we will visualize cross-articles from Wikipedia.  To do this, we need to call the method by reference: <br> <code><a href="http://ru.wikipedia.org/w/api.php%3Faction%3Dquery%26format%3Dxml%26titles%3D%25D0%2597%25D0%2590%25D0%2593%25D0%259E%25D0%259B%25D0%259E%25D0%2592%25D0%259E%25D0%259A_%25D0%25A1%25D0%25A2%25D0%2590%25D0%25A2%25D0%25AC%25D0%2598%26prop%3Dlinks"></a> ru.wikipedia.org/w/api.php?action=query&amp;format=xml&amp;titles=_&amp;prop=links</code> <br>  where <b>action</b> is the type of method, <b>format</b> is the output format of the response, in our case it is XML, <b>prop</b> - we ask for cross-references <b>links</b> <br><br>  at the output we get the following answer: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">api</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">query</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">normalized</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">n</font> <font color="#ff0000">from</font> <font color="#0000ff">= "Habrahabr"</font> <font color="#ff0000">to</font> <font color="#0000ff">= "Habrahabr"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">normalized</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pages</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">page</font> <font color="#ff0000">pageid</font> <font color="#0000ff">= "340809"</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "Habrahabr"</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">links</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "2006"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "2006"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "2007"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "Digg.com"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "Linux.org.ru"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "News 2.0"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "Newsland"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "Pligg"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "Slashdot"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">pl</font> <font color="#ff0000">ns</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">title</font> <font color="#0000ff">= "URL"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">links</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">page</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">pages</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">query</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">query-continue</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">links</font> <font color="#ff0000">plcontinue</font> <font color="#0000ff">= "340809 | 0 | Blog"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">query-continue</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">api</font> <font color="#0000ff">&gt;</font> </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Which is processed using any DOM or SAX method. <br><br><h2>  Programming </h2><br>  So for processing, I used SAX and inherited my class from xml.sax.handler.ContentHandler: <br> <code>class LinksListHandler(xml.sax.handler.ContentHandler):</code> <br>  Further, the main challenges are redefined: <br><ul><li>  startElement </li><li>  endElement </li></ul><br><br>  The procedure for working with a query is as follows: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  def get_links (page): </li><li>  #See wiki api documentation http: <font color="#008000">//en.wikipedia.org/w/api.php</font> </li><li>  query_val = { <font color="#A31515">'action'</font> : <font color="#A31515">'query'</font> , </li><li>  <font color="#A31515">'prop'</font> : <font color="#A31515">'links'</font> , </li><li>  <font color="#A31515">'titles'</font> : page, </li><li>  <font color="#A31515">'format'</font> : <font color="#A31515">'xml'</font> } </li><li>  url = wiki_url () + <font color="#A31515">'?'</font>  + urllib.urlencode (query_val) </li><li>  request = urllib2.Request (url) </li><li></li><li>  verbose_message ( <font color="#A31515">"Wiki url:"</font> + url) </li><li>  <font color="#0000ff">try</font> : </li><li>  response = urllib2.urlopen (request) </li><li>  except urllib2.HTTPError: </li><li>  print <font color="#A31515">"HTTP request error!"</font> </li><li>  sys.exit (1) </li><li>  #verbose_message ( <font color="#A31515">"Response xml: \ n"</font> + response.read ()) </li><li>  lh = LinksListHandler () </li><li>  saxparser = xml.sax.make_parser () </li><li>  saxparser.setContentHandler (lh) </li><li>  saxparser.parse (response) </li><li></li><li>  <font color="#0000ff">return</font> lh.links </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br><h2>  Graphing </h2><br>  Using the PyGraphviz module, the work is quite simple: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  def make_wiki_graph (wiki_page, depth): </li><li>  gv = AGraph () </li><li></li><li>  page_list = [wiki_page] </li><li>  temp_list = [] </li><li></li><li>  verbose_message ( <font color="#A31515">'Create graph for'</font> + wiki_page) </li><li>  pageLinks = get_links (wiki_page) </li><li>  gv.add_node (wiki_page) </li><li>  <font color="#0000ff">for</font> i <font color="#0000ff">in</font> range (depth): </li><li>  print <font color="#A31515">'&gt;&gt;&gt;&gt; Get'</font> + str (i) + <font color="#A31515">'level'</font> </li><li>  <font color="#0000ff">for</font> page <font color="#0000ff">in</font> page_list: </li><li>  list = get_links (page) </li><li>  node = gv.get_node (page) </li><li>  node.attr [ <font color="#A31515">'fontsize'</font> ] = <font color="#A31515">"% i"</font> % (MIN_FONT * 2 * (depth - i)) </li><li>  <font color="#0000ff">for</font> link <font color="#0000ff">in</font> list: </li><li>  verbose_message (page + <font color="#A31515">"=&gt;"</font> + link) </li><li>  gv.add_edge (page, link) </li><li>  temp_list.append (link) </li><li>  page_list = temp_list </li><li>  temp_list = [] </li><li>  <font color="#0000ff">return</font> gv </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><h2>  results </h2><br>  Article "Mathematics" with 4 levels of nesting <br><img src="https://habrastorage.org/getpro/geektimes/post_images/166/cab/18d/166cab18d136c11b880f52afac0157df.png" alt="image"><br>  Article "Habrahabr" with 5 levels of nesting <br><img src="https://habrastorage.org/getpro/geektimes/post_images/d12/215/9f1/d122159f1d659a60f8580a9df7c3b38f.png" alt="image"><br><br>  Others: <br>  <a href="">Socrates</a> <br>  <a href="">Habrahabr 3 levels</a> <br><br>  <a href="http://bukin.su/viz/">Other examples</a> <br><h3>  <a href="http://bukin.su/viz/dict2viz.py">Script itself</a> </h3></div><p>Source: <a href="https://habr.com/ru/post/56209/">https://habr.com/ru/post/56209/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../56202/index.html">Feedback on the 8th meeting of StartupPoint</a></li>
<li><a href="../56203/index.html">Save IE6 - sign the petition!</a></li>
<li><a href="../56205/index.html">Jay (Saurik) has sold Cydia</a></li>
<li><a href="../56206/index.html">Action from Nokia in Ukraine: break the iPhone</a></li>
<li><a href="../56207/index.html">Tab key and users</a></li>
<li><a href="../5621/index.html">Two bugs on blogs and rss feeds</a></li>
<li><a href="../56210/index.html">MySQL Calculator</a></li>
<li><a href="../56211/index.html">April 1 at Kinopoisk.ru. SEX on the main page.</a></li>
<li><a href="../56212/index.html">7 stages of web application development</a></li>
<li><a href="../56213/index.html">April 1st New competition from Microsoft for ** nix and Mac users.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>