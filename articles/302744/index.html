<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Resize images in the browser. Things could get worse</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Meet this Manya. Manyu was struck by a terrible disease and now she needs your help. Manya grew up an ordinary girl, a cheerful happy child. But a lit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Resize images in the browser. Things could get worse</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/aba/a34/902/abaa34902b674d4aa82adc5ed8bfc71c.jpeg"></p><br><p>  Meet this Manya.  Manyu was struck by a terrible disease and now she needs your help.  Manya grew up an ordinary girl, a cheerful happy child.  But a little more than a year ago, <a href="https://habrahabr.ru/post/252175/">doctors put a terrible diagnosis on her</a> - aliasing.  And she began to look like this. </p><br><p><img src="https://habrastorage.org/files/aba/a34/902/abaa34902b674d4aa82adc5ed8bfc71c.jpeg"><img src="https://habrastorage.org/files/612/66b/36e/61266b36ebf44e8990086007a0049cfb.jpg"></p><br><p>  As it turned out, the reason for this was the greed and greed of browser manufacturers who decided to save on image resize algorithms and apply the lowest quality filters.  Then Mania was saved - she completed a course of consecutive non-multiple two decreases, which reduced aliasing and restored its former sharpness.  But now she is in danger again. </p><a name="habracut"></a><br><p> What has changed this year?  The good news is that <a href="https://html.spec.whatwg.org/multipage/scripting.html">a standard has emerged</a> designed to control the quality of rasterization of images on canvas.  News is even better: this standard is implemented in the browser: mobile Safari from version 9.3 and desktop from version 9.1.  And judging by the results, the <code>high</code> value corresponds to the <a href="https://habrahabr.ru/post/243285/">method of convolutions</a> with a bicubic or very similar filter.  Those.  the result is really very good.  It would seem that it is possible to <a href="https://github.com/uploadcare/uploadcare-widget/blob/0f21ae5aece475ef05edf505e54db017f89bab12/app/assets/javascripts/uploadcare/utils/image-processor.coffee">wrap the code</a> crammed in the previous article in <code>if ('imageSmoothingQuality' in context)</code> and wait for the same property to appear in other browsers.  But something went wrong. </p><br><p><img src="https://habrastorage.org/files/aba/a34/902/abaa34902b674d4aa82adc5ed8bfc71c.jpeg"><img src="https://habrastorage.org/files/339/192/270/3391922705544998a1d2841c60f2fbe8.jpg"></p><br><p>  Something went wrong and Manu was attacked by another attack - Manya became soapy.  It turned out that Google is also preparing a surprise for Masha, having implemented the desired property and so far, hiding it behind the <code>chrome://flags/#enable-experimental-canvas-features</code> flag <code>chrome://flags/#enable-experimental-canvas-features</code> .  Here it is only implemented not in good faith, but with anything.  Instead of correct, clear, Orthodox convolutions, the technique used in games is used for the <code>high</code> value: using supersampling, <a href="https://ru.wikipedia.org/wiki/MIP-%25D1%2582%25D0%25B5%25D0%25BA%25D1%2581%25D1%2582%25D1%2583%25D1%2580%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">mip levels</a> are created for the image, and then the closest size is resized using the same cheap method with a fixed number of source points. </p><br><p>  Why does this method work in games?  For two reasons.  First: in a dynamic game, you do not have time to consider each texture separately, whether it is soapy or not.  Much more on the perception affects the overall picture and special effects than such trifles.  Second: very tight time constraints, for which, by the way, the constant complexity of this method is relatively to the size of the final image (screen resolution in the case of games). </p><br><p>  Why this method is not suitable for resizing in applications for working with graphics?  Yes, because it is not a resize method at all, hello.  This is an application of two solutions, none of which is able to meet the quality requirements - and so it is together.  It has neither a mathematical justification, nor a stability of the result with respect to the input parameters.  For example, a picture that is optimized to 244 pixels wide may turn out nothing like this, and a graphic to 243 will be all in soap.  Moreover, this is not acceptable for the <code>imageSmoothingQuality</code> property specially created for this occasion.  Well, if I put <code>high</code> , then I guess I mean that I need exactly good quality.  Why bother to implement a new property at all if it gives a worse result than can be achieved by fiddling with an existing solution?  Here, for example, on the right, Manya is presented by successive non-multiple two decreases.  Absolutely healthy and happy baby. </p><br><p><img src="https://habrastorage.org/files/aba/a34/902/abaa34902b674d4aa82adc5ed8bfc71c.jpeg"><img src="https://habrastorage.org/files/3ca/e31/7f8/3cae317f84324e5ca0faa17b41f2f066.jpeg"></p><br><p>  If you suddenly do not feel sympathy and sympathy for small children, then here is a friend of you, Manechkin, mandrill Poupus.  He suffered the same trouble.  From left to right: </p><br><ul><li>  blurred picture after resize in Chrome with <code>imageSmoothingQuality = 'high'</code> </li><li>  high-quality pictures from Safari </li><li>  more or less high-quality picture after resizing in Chrome by the method of successive decreases without <code>imageSmoothingQuality</code> </li></ul><br><p><img src="https://habrastorage.org/files/c45/d2b/ed5/c45d2bed57664ffdb0a8a3ae93787acd.jpg"><img src="https://habrastorage.org/files/9ea/4e7/b3b/9ea4e7b3b10e46eda1fa6dbbbf5c54d3.jpeg"><img src="https://habrastorage.org/files/891/e78/60b/891e7860b80b40079f838ca95d504210.jpg"></p><br><p>  How can you help?  Well, for example, go put an asterisk in the <a href="https://bugs.chromium.org/p/chromium/issues/detail%3Fid%3D618324">bug report</a> created for this.  I'm not sure how effective it is, but I can't think of anything else. </p><br><p>  What will happen if this feature is moved to a stable version of Chrome?  Instead of simply checking for the presence of features, you will either have to fence the check by user agent, or disable this functionality for all users, even in Safari.  The right idea came to mind: you need to go and put an additional check right now on the fact that the user agent does not have the word Chrome.  If Chrome corrects and in a stable version does not have this disgrace, you can turn it on.  But if one of the clients downloads the code now, it will not be harmed upon leaving the main Chrome Manya. </p><br><p>  For obtaining images <a href="https://unsplash.com/photos/8k6tLpo8n0c">once</a> and <a href="http://www.johnloomis.org/ece563/notes/basics/components/mandrill/mandrill.html">twice</a> , a <a href="http://jsbin.com/sofigi/edit%3Foutput">test stand</a> , as well as a <a href="https://uploadcare.com/widget/configure/2.9.0/%3Fshrink%3Dtrue%26shrinkX%3D257%26shrinkY%3D257%26shrinkQuality%3D100">widget</a> for successive reductions were used. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/302744/">https://habr.com/ru/post/302744/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../302730/index.html">Dash cryptocurrency: full DAO</a></li>
<li><a href="../302732/index.html">ShopConf 2016 - June 17 in Skolkovo - the program is formed</a></li>
<li><a href="../302734/index.html">Digest of interesting events from the world of Java, and around it # 3 (05/23/2016 - 06/05/2016)</a></li>
<li><a href="../302736/index.html">How to prevent frequent releases from breaking your API, or writing auto tests for an open API and sending a result to Telegram bot</a></li>
<li><a href="../302738/index.html">Learning is light: the TC MUK program for the training of information security specialists</a></li>
<li><a href="../302746/index.html">Synology DSM, Perl and Mojolicious</a></li>
<li><a href="../302752/index.html">Humane VimScript: Editor Initialization</a></li>
<li><a href="../302754/index.html">SGI, HPE and Fujitsu super servers with 24-core Xeon E7 v4 processors ‚Äî and how do we curb this hardware?</a></li>
<li><a href="../302756/index.html">xfcRS - original laconic, nimble rendering of smoothed tiles, "expansion fast cell - Rounded Squares"</a></li>
<li><a href="../302760/index.html">As we did the centralized data storage for the retail network and optimized it step by step.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>