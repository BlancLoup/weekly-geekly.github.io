<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New file virus with MMX instructions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nguyen Ngoc Dung, a virus analyst at the Vietnamese computer security company Bkis, wrote in his blog about the emergence of a new type of file virus ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New file virus with MMX instructions</h1><div class="post__text post__text-html js-mediator-article"> Nguyen Ngoc Dung, a virus analyst at the Vietnamese computer security company Bkis, <a href="http://blog.bkis.com/en/new-sality-variant-goes-wild-with-new-type-of-instruction/">wrote in his blog</a> about the emergence of a new type of file virus from the Sality family.  At the moment, viruses of this family are among the most technologically advanced and widespread file viruses that infect the computers of Windows users. <br><br>  This time the situation is interesting because in the metamorphic code of the virus there are some MMX instructions ( <b>M</b> ulti <b>M</b> edia e <b>X</b> tension) that were not previously used in any of the malware infectors. <br><a name="habracut"></a><br><br><img src="https://habrastorage.org/storage/c0590a19/8560e79c/b9f85f73/ec4ed732.png"><br>  <b>Sality with MMX</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Usually, all previous versions of Sality used only x86 codes, like other representatives of this type of malware.  Today, x86 is emulated by most antivirus heuristics; accordingly, the introduction of MMX is intended to impede the work of emulators and avoid detection. <br><br><img src="https://habrastorage.org/storage/58e94bfb/20a4ddf7/0f15342f/8cfd0bc0.png"><br>  <b>Generating MOVD instructions mm, r / m32</b> <br><br>  The virus code contains only a few MMX instructions.  However, judging by the dynamics of malware development and the level of innovation, we should expect new versions to appear with a large number of MMX code.  Moreover, in the new version of Sality, the part of the code that was characteristic of this malware and used in signatures has been modified while preserving its functionality, for example: <br> <code>R1 = [R2]</code> <br>  (R1 and R2 - 32-bit registers [] indicates a memory cell whose address is stored in the register) <br><br>  Code changed to :: <br> <code>R1= 0 <br> R1 = R1 xor [R2]</code> <br>  or <br> <code>R1 = 0 <br> R1 = R1 or [R2]</code> <br>  or <br> <code>R1 = 0 <br> R1 = R1 + [R2]</code> <br> <br>  Thus, it becomes even more difficult to determine which code serves to decrypt the virus component, and which one is ordinary garbage, which registers contain important information, and which simply confuse disassembly.  This imposes more serious requirements on anti-virus programs. <br><br>  Currently, the malware is detected by the <a href="http://www.virustotal.com/file-scan/report.html%3Fid%3Dd979de4a9c8e1438bb1b3cbd2f766195a2d493b79733eb673502b0dca5d6747a-1289578321">following programs</a> , in particular, the product of the authors <a href="http://bkis.com/">BKAV</a> detects it as W32.SalityVM.PE, and Kaspersky products - as Virus.Win32.Sality.bh. <br><br>  Guaranteed to cure affected files can be a <a href="">free utility SalityKiller from Kaspersky Lab</a> . <br><br>  <b>UPD: To</b> be fair, the malware was identified by KIS 2011 heuristics as Trojan.Win32.Generic, which fully corresponds to the <a href="">functionality of the Sality family</a> . </div><p>Source: <a href="https://habr.com/ru/post/108034/">https://habr.com/ru/post/108034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../108029/index.html">C Java on Mac OS X is not so sad</a></li>
<li><a href="../108030/index.html">Linux Mint 10 ‚ÄúJulia‚Äù released</a></li>
<li><a href="../108031/index.html">Funny ad Windows 7 with the participation of the Mac and k / f Avatar</a></li>
<li><a href="../108032/index.html">The promotion ‚ÄúNetbook for domain‚Äù - 5 netbooks are played out in 1 day</a></li>
<li><a href="../108033/index.html">Canobuvosti, 65th edition</a></li>
<li><a href="../108035/index.html">You are being watched from school</a></li>
<li><a href="../108036/index.html">[Translation] JVM division into paid / free version: hysteria, which began with a tweet</a></li>
<li><a href="../108037/index.html">Review Logitech Wireless Illuminated Keyboard K800</a></li>
<li><a href="../108038/index.html">Open handheld gaming devices. And what have you / has not yet come but already ordered?</a></li>
<li><a href="../108039/index.html">Accessing the ASP.NET Development Server from a network</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>