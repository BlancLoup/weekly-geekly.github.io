<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ActionResult for all occasions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The farther into the "forest", the thicker the MVC framework. Here recently released a preview of the second version. Quickly acquainted with the poss...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ActionResult for all occasions</h1><div class="post__text post__text-html js-mediator-article">  The farther into the "forest", the thicker the MVC framework.  <a title="News" href="http://habrahabr.ru/blogs/net/66030/">Here</a> recently released a preview of the second version.  Quickly acquainted with the possibilities, I was very happy.  But then I remembered the simple and very interesting <acronym>RoR</acronym> opportunity, which is not yet (even in the plans) in MS MVC. <br>  We are talking about the possibility of specifying an ‚Äúextension‚Äù for the Action method and, thereby, determining the type of View. <br><br><a name="habracut"></a><br>  First, consider an example.  The ht_p: // localhost / Blog / Comments / 0 request returns an html page containing a list of comments to article number 0 on the blog.  In this case, Blog is the name of the controller, Comments is the name of the method, 0 is the record ID. <br>  The controller code will look something like this: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> BlogController : Controller <br> { <br> <font color="#0000ff">public</font> ActionResult Comments( <font color="#0000ff">int</font> id) <br> { <br> <font color="#0000ff">var</font> strings = <font color="#0000ff">new</font> [] { <font color="#A31515">""</font> , <font color="#A31515">""</font> , <font color="#A31515">""</font> }; <font color="#008000">// ,   </font> <br> <font color="#0000ff">return</font> View(strings); <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Everything is simple! <br><br>  And what to do if we need in addition to the html page to get a list of comments serialized in json?  The easiest way is to create another method, call it, say, CommentsJson, and explicitly call the Json () method.  For example: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> ActionResult CommentsJson( <font color="#0000ff">int</font> id) <br> { <br> <font color="#0000ff">var</font> strings = <font color="#0000ff">new</font> [] { <font color="#A31515">""</font> , <font color="#A31515">""</font> , <font color="#A31515">""</font> }; <font color="#008000">// ,   </font> <br> <font color="#0000ff">return</font> Json(strings); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now we can get the json list at ht_p: // localhost / Blog / CommentsJson / 0. <br><br>  Problem solved, disagree?  Frankly, this code does not suit me.  Firstly, duplication, and secondly, I don‚Äôt like the url that I‚Äôll have to use later; thirdly, there‚Äôs no way to use the scheme in other methods. <br><br>  In this case, the opportunity to create your own ActionResult will come to our rescue.  We will try to solve the problem "in the forehead."  Change the Comments method as follows: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> BlogController : Controller <br> { <br> <font color="#0000ff">public</font> ActionResult Comments( <font color="#0000ff">int</font> id) <br> { <br> <font color="#0000ff">var</font> strings = <font color="#0000ff">new</font> [] { <font color="#A31515">""</font> , <font color="#A31515">""</font> , <font color="#A31515">""</font> }; <font color="#008000">// ,   </font> <br> <font color="#0000ff">return</font> <font color="#0000ff">new</font> ComplexResult <br> { <br> Json = () =&gt; Json(strings), <br> View = () =&gt; View(strings) <br> }; <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  As you can see, the ComplexResult class must be inherited from ActionResult. <br>  Let's try to implement it like this: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ComplexResult : ActionResult <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> ExecuteResult(ControllerContext context) <br> { <br> <font color="#0000ff">object</font> <font color="#0000ff">value</font> ; <br> <font color="#0000ff">if</font> (context.RouteData.Values.TryGetValue( <font color="#A31515">"result"</font> , <font color="#0000ff">out</font> <font color="#0000ff">value</font> )) <br> { <br> <font color="#0000ff">var</font> result = <font color="#0000ff">value</font> .ToString(); <br> <font color="#0000ff">if</font> (result.Equals( <font color="#A31515">"json"</font> , StringComparison.InvariantCultureIgnoreCase)) <br> { <br> Json().ExecuteResult(context); <br> <font color="#0000ff">return</font> ; <br> } <br> } <br> <br> View().ExecuteResult(context); <br> } <br> <br> <font color="#0000ff">public</font> Func&lt;JsonResult&gt; Json { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> <font color="#0000ff">public</font> Func&lt;ViewResult&gt; View { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Here it is necessary to explain: when processing the result, we check the presence of the string ‚Äúresult‚Äù in the list of values ‚Äã‚Äãobtained when parsing the query.  Make sure that the user has sent the ‚Äújson‚Äù line and run the user-defined JsonResult.  If the string is not found or it is not equal to ‚Äújson‚Äù, run the ViewResult.  The logic is pretty simple. <br><br>  In parallel, we will add lines to the routes configuration: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> RegisterRoutes(RouteCollection routes) <br> { <br> routes.IgnoreRoute( <font color="#A31515">"{resource}.axd/{*pathInfo}"</font> ); <br> <br> <font color="#008000">//  route    default</font> <br> routes.MapRoute( <font color="#A31515">"Result"</font> , <font color="#A31515">"{controller}/{action}.{result}/{id}"</font> , <br> <font color="#0000ff">new</font> { controller = <font color="#A31515">"Home"</font> , action = <font color="#A31515">"Index"</font> , id = <font color="#A31515">""</font> , result = <font color="#A31515">"view"</font> }); <br> <br> routes.MapRoute( <font color="#A31515">"Default"</font> , <font color="#A31515">"{controller}/{action}/{id}"</font> , <br> <font color="#0000ff">new</font> { controller = <font color="#A31515">"Home"</font> , action = <font color="#A31515">"Index"</font> , id = <font color="#A31515">""</font> }); <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now we have the opportunity to get a json object by explicitly specifying it in the query string ht_p: //localhost/Blog/Comments.json/0.  Or ht_p: // localhost / Blog / Comments / 0 - when we need html.  And most importantly, we can easily use ComplexResult in other methods, without clogging the code with repetitive methods. <br><br>  Fantasy suggests that in this way you can add other standard or non-standard (XmlResult, RssResult, etc.) to ComplexResult ActionResults.  Perhaps we are waiting for this in the next versions of ASP.NET MVC. <br><br>  <strong>The code is written, now excuses: I recommend using the code written in this note only to familiarize yourself with the features of the MVC framework, obviously - it is not safe, for simplicity, some checks and conditions are omitted.</strong> <br><br>  Thanks for attention. <br></div><p>Source: <a href="https://habr.com/ru/post/66355/">https://habr.com/ru/post/66355/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../66347/index.html">Interesting data on the audience of popular sites</a></li>
<li><a href="../66349/index.html">Nemerle and satellite, or OP for the little ones</a></li>
<li><a href="../66350/index.html">Overview of the Falcon engine in mySQL</a></li>
<li><a href="../66351/index.html">Stable IPTV broadcasting via VLC</a></li>
<li><a href="../66352/index.html">Chromium and a strange young man instead of a button to close</a></li>
<li><a href="../66356/index.html">Multidimensional Cubes, OLAP and MDX</a></li>
<li><a href="../66359/index.html">What to do with useful ideas that interfere with work?</a></li>
<li><a href="../66360/index.html">Custom scrolling elements on JS. Help</a></li>
<li><a href="../66361/index.html">Symbian 4 - big changes are coming</a></li>
<li><a href="../66362/index.html">Hitachi Deskstar 7K2000 - the world's first 2 TB hard drive with a rotation speed of 7200 rpm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>