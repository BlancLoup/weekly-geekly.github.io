<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The practice of testing backend for Java + Rest-Assured</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In a previous article, I shared my automation experience on the Robot Framework. Now we will talk about a slightly different approach to testing the A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The practice of testing backend for Java + Rest-Assured</h1><div class="post__text post__text-html js-mediator-article">  In a previous article, I shared my automation experience on the Robot Framework.  Now we will talk about a slightly different approach to testing the API for a project on Kotlin. <br><br>  Taking advantage of the freedom to choose a stack of technologies and relying on the desire to try something ‚Äúin battle‚Äù, I turned to Rest-Assured.  Not without some difficulties, we and our colleagues launched tests, and following the results of mastering the approach, we wrote it down as a list of key tasks for this kind of task. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dp/fb/py/dpfbpyb84ceqlsxp7b0ixsvo9wq.jpeg" alt="image"></div><br>  <i>(image used on parody rights)</i> <br><a name="habracut"></a><br>  It all started with the fact that we received a request to automate API testing on one of the new projects in <a href="https://maxilect.ru/solutions/ad-tech/">the Ad-tech segment</a> .  We did Campaign Manager, DMP and several integrations with third-party systems.  And the testers had an extremely simple task: to automate the snook testing for further integration into CI and constant monitoring of the status of this API, since third-party systems are tied to it and the correctness of the work is critical.  In this case, verification of business logic was not required, since the service being tested is essentially a proxy interface. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Why Rest-Assured? </h2><br>  From the point of view of test automation, we managed to work in various areas - UI, web, mobile, desktop, backend, REST API, SOAP.  <a href="https://habr.com/company/maxilect/blog/424333/">The previous project</a> gave us quite a lot of experience on the Robot Framework, so it would be most logical to use it.  Most of the testing team are familiar with it, and if an urgent replacement of a specialist is required, this will be done quickly and virtually painlessly.  But a different decision was made. <br><br>  First, the project itself was written in Kotlin and was collected using Gradle.  At the same time, at the design stage, it was decided not to single out autotests into a separate project.  As noted in the comments to the previous article, gluing Java (Kotlin) and Robot Framework is a big pain, so there was no point in contacting RF.  Plus, looking back at work with the robot, it was interesting for me to try a different approach.  Moreover, on this project we could independently choose a stack of technologies - the business did not set its own conditions. <br><br>  In search of ideas, I turned to our development team, as well as colleagues from testing, and CTO advised you to look at Rest-Assured ( <a href="http://rest-assured.io/">rest-assured.io</a> ).  After I read the documentation and examples of tests in open sources, the approach offered by Rest-Assured seemed to me very attractive.  It implies receiving a response from the backend as JSON, which we will deserialize into good old Java objects. <br><br>  Further with this structure it is possible to work as with a normal object.  As a result, we have a completely normal object-oriented approach for validating the compliance of an API response with the described object structure.  As a bonus, we get a quick failproof test of the response structure - if the object obtained by deserializing the API response is different in the number of fields or their names, the tests will drop even before the data is checked with an error of deserialization.  So we will understand, we need to repair the backend or update the tests in accordance with the new API requirements.  In our case, this was important because, as I mentioned above, many third-party subsystems are tied to the API. <br><br>  For accuracy, I note that approximately the same failproof test could be obtained on RF, but in a slightly different way.  However, the story today is not about that.  Personally, I was more comfortable and clearer to go by Rest-Assured with an entity that has certain fields and methods. <br><br><h2>  Attempt at writing </h2><br>  Before starting to use the stack on a real project, I decided to try it out on a small CRUD service.  In order not to practice my own mistakes right away, I decided to look for best practices on this stack and quickly found <a href="https://blog.philipphauer.de/testing-restful-services-java-best-practices/">an article by Philip Hauer</a> , where he reflected his automation experience on Rest-Assured.  After studying the article to write a working version of the tests of my service was not difficult.  They turned out simple, easy to read and understandable. <br><br><h2>  To battle! </h2><br>  The project started, and when the first response structures were described, the preparation of test documentation and the writing of autotests began.  To understand the overall picture, I‚Äôll give you a full stack of autotests: <br><br><ul><li>  Java, </li><li>  JUnit4 - execution and parameterization of test scenarios (standard annotation @Parametrize), <br></li><li>  Rest-Assured - building and executing queries, </li><li>  AssertJ - validation of received values, </li><li>  Allure - reporting building </li><li>  Gradle - build </li><li>  Jackson - deserialization. </li></ul><br>  When the first tests were written, the problem of correct parameterization became apparent.  Transmitting simple data values ‚Äã‚Äãand expected results seemed extremely inefficient and ugly.  I did not have time to solve this problem before the holidays, but my colleagues, who were attracted during my absence, dealt with it.  For a beautiful and easy-to-read parameterization, they decided to make a base class with functions to add, get, and delete parameters of an object from which all classes inherited, whose objects were used to call the appropriate API methods. <br><br><img src="https://habrastorage.org/webt/9j/vt/7r/9jvt7rmcd1w3wddoqmomp-_cpz4.png" alt="image"><br><br>  This allowed literally on the fly to create the necessary data and transfer them to the test parameters. <br><br><img src="https://habrastorage.org/webt/ll/rx/5o/llrx5opu0wbwa29_nmbywqxsubq.png" alt="image"><br><br>  Rest-Assured allows you to deserialize the response to the desired class.  The answer is decomposed into a previously known structure using Jackson.  Classes for deserialization look as simple as possible - all the expected fields with their types are described. <br><br><img src="https://habrastorage.org/webt/kw/kh/jr/kwkhjrtsj5zd6kxm0lkhcnaewqy.png" alt="image"><br><br>  Further simple work with objects and assertion of concrete fields and their values ‚Äã‚Äãproceeds. <br>  The most difficult and unobvious thing I encountered in this approach is the impossibility to pass to Rest-Assured as one of the null parameters (the result is a fall in NullPointerException).  Apparently, this is a known problem, but the developer is not going to correct the situation, recommending either to send the field empty or not to send it at all.  We encountered this problem already at that stage when the basis of the project was ready and it was necessary only to add test classes.  Therefore, just a little corrected their code. <br><br>  In general, I liked the approach.  It is curious that after a while it began to be applied on the project of another customer (though not with our filing).  And we put the stack for automation of API testing (JUnit + AssertJ + Rest-Assured) into the category of key projects for Java / Kotlin.  In Python, it will be illogical to pull it, since it is better that the competences of development and testing overlap. <br><br>  It is also worth noting that one of the advantages of this solution lies in its scalability and adaptability for complex logic.  So, it is best suited for serious projects, where it really makes sense in the description of large objects, clean code and block architecture, when there are individual pieces responsible for preparing, transmitting and receiving data in a readable form, as well as the subsequent verification of data for compliance some conditions.  In small projects, all this is meaningless. <br><br><h2>  Results </h2><br>  In about a month we managed to automate about 250 tests and provide the required level of coverage.  Of course, after the completion of the automation process, an internal presentation was held for all comers so that employees had an idea of ‚Äã‚Äãthe work done and could learn from the experience gained on this project. <br><br>  Article author: Dmitry Masterov <br><br>  PS We publish our articles on several sites Runet.  Subscribe to our pages on the <a href="https://vk.com/maxilect">VK</a> , <a href="https://www.facebook.com/maxilectru/">FB</a> or <a href="https://t.me/maxilect">Telegram channel</a> to learn about all of our publications and other news from Maxilect. </div><p>Source: <a href="https://habr.com/ru/post/427307/">https://habr.com/ru/post/427307/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../427297/index.html">Apache Ignite + Apache Spark Data Frames: More Fun Together</a></li>
<li><a href="../427299/index.html">And let's collect something else? The designer 3 in 1 "Lunar fleet"</a></li>
<li><a href="../427301/index.html">DB crash on GitHub</a></li>
<li><a href="../427303/index.html">Slow Windows, Part 2: Creating Processes</a></li>
<li><a href="../427305/index.html">Arkady Volozh refused to sell his stake in Yandex</a></li>
<li><a href="../427309/index.html">How PVS-Studio turned out to be more attentive than three and a half programmers</a></li>
<li><a href="../427311/index.html">How to become datsayntistom if you are over 40 and you are not a programmer</a></li>
<li><a href="../427313/index.html">How SoftBank invests $ 50 billion a year in start-ups, and why it baffles investors</a></li>
<li><a href="../427315/index.html">Hut reading room or a selection of professional literature</a></li>
<li><a href="../427317/index.html">To be successful in IT or what kills IT's?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>