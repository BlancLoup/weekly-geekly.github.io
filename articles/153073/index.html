<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Once again about modal windows and some goodies.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About modal windows it is written, probably, tons of literature, but this article was inspired me to write this topic in Habr√©. There are a lot of thi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Once again about modal windows and some goodies.</h1><div class="post__text post__text-html js-mediator-article">  About modal windows it is written, probably, tons of literature, but <a href="http://habrahabr.ru/post/148515/">this</a> article was inspired me to write this topic in Habr√©.  There are a lot of things left unsaid, including horizontal jumps of both the page and the modal window. <br>  Of course, you could just unsubscribe in the comments, they say, do so-and-so, and everything will be type-top.  But my comment has grown to the size of a new article, with good examples and comments. <br>  To whom it became interesting - welcome under habrakat! <br><a name="habracut"></a><br>  Frankly speaking, I cannot call this type of viewing content on the page a ‚Äúmodal window‚Äù.  Still, these are slightly different things.  Therefore, I will call it "cloud content."  I think this is the most correct definition for this kind of content display. <br><br>  So, our main tasks: <br>  1) to manage to fix the page so that with a hot change in its height, it does not ‚Äújump‚Äù to the right-to-left. <br>  2) open the cloud window and center it so that the content on the page remains in place when the height of the window changes. <br>  3) achieve vertical scrolling of the ‚Äúcloud window‚Äù using the ‚ÄúUp and Down Arrows‚Äù keys on the keyboard. <br>  4) previously opened windows are cached in the DOM, in order not to perform complex operations and calculations or not to make an extra request to the server. <br>  5) connect the hot navigation keys for the most convenient end-user navigation (keyboard arrows Right / Left to move between windows and the Escape key to close the window). <br><br>  Items 4 and 5 and will be buns. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Everything else, we will not use any frameworks, and we will write on native JS.  Looking ahead, I will say that the JS code without comments in uncompressed form takes only 5 kb. <br><br>  Actually, let's start. <br>  Immediately I will show a ready illustrative example, so that when reading this article you have something to compare and see what exactly is being said. <br><br>  <a href="http://www.dimavip.ru/cloudpage/index.html">DEMO EXAMPLE</a> and the <a href="">file</a> connected to the <a href="">JS</a> page (JS can open "beaten", so you can immediately <a href="">download the entire archive</a> ). <br><br>  First, we define the function elemID ();  Since the document.getElementById construction is found in the code quite often, it is easier to shorten this record using a similar function, which allows you to significantly reduce the overall weight of the JS file.  This is especially important with massive files with a large amount of code. <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">elemID</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(e);};</code> </pre> <br><br>  We get an object with which we will work later: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Content = {}</code> </pre><br><br>  The first thing we start with is a page fix.  To do this, we wrap all the content of the page in a block with id = "layer" <br><br><pre> <code class="css hljs">&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">id</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span>"&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">div</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">class</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">layer</span></span>" <span class="hljs-selector-tag"><span class="hljs-selector-tag">id</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">layer</span></span>"&gt; &lt;!<span class="hljs-selector-tag"><span class="hljs-selector-tag">--</span></span>     <span class="hljs-selector-tag"><span class="hljs-selector-tag">--</span></span>&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">div</span></span>&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span>&gt;</code> </pre><br><br>  Is done.  Now for him we write a method that centers this block: <br><pre> <code class="javascript hljs">editSiteLayer:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">content</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/**    ,    - "layer" **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!content) {<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> content = <span class="hljs-string"><span class="hljs-string">'layer'</span></span>;} <span class="hljs-comment"><span class="hljs-comment">/** **     **   18px -     **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inWidth = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth<span class="hljs-number"><span class="hljs-number">-18</span></span>, <span class="hljs-comment"><span class="hljs-comment">/**    **/</span></span> layerWidth = elemID(content).clientWidth; <span class="hljs-comment"><span class="hljs-comment">/**        undefined **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inWidth &amp;&amp; layerWidth) { <span class="hljs-comment"><span class="hljs-comment">/**      CSS  float:left **/</span></span> elemID(content).style.cssFloat = <span class="hljs-string"><span class="hljs-string">'left'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** **           -    **            **/</span></span> elemID(content).style.marginLeft = (inWidth/<span class="hljs-number"><span class="hljs-number">2</span></span>)-(layerWidth/<span class="hljs-number"><span class="hljs-number">2</span></span>)+<span class="hljs-string"><span class="hljs-string">'px'</span></span>; } }</code> </pre><br>  They wrote and temporarily forgot about it (at the end we will definitely connect it). <br><br>  Our second task is to create and open a ‚Äúcloud window‚Äù. <br>  We will open the cloud window like this: <br><pre> <code class="css hljs">&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">id</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span>"&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">div</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">class</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">cloud</span></span>" <span class="hljs-selector-tag"><span class="hljs-selector-tag">id</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">cloud</span></span>"&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">div</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">class</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">cloud-layer</span></span>" <span class="hljs-selector-tag"><span class="hljs-selector-tag">id</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">cloud-layer</span></span>"&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">em</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">class</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">cloud-contaner</span></span>" <span class="hljs-selector-tag"><span class="hljs-selector-tag">id</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">cloudpage_</span></span>_<span class="hljs-selector-tag"><span class="hljs-selector-tag">ID_</span></span>"&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">em</span></span>&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">div</span></span>&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">div</span></span>&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span>&gt;</code> </pre><br>  The ‚Äúcloud‚Äù block acts as a kind of protective mask and separates the site content from the cloud window, while also making it ‚Äúcloudy‚Äù.  Its CSS properties are: <br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.cloud</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>:block; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>:fixed; <span class="hljs-attribute"><span class="hljs-attribute">top</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">left</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">right</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">bottom</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">rgba</span></span>(0, 0, 0, 0.795); <span class="hljs-attribute"><span class="hljs-attribute">z-index</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">overflow</span></span>:auto; }</code> </pre><br>  The ‚Äúcloud-layer‚Äù block is the ‚Äúparent‚Äù for all DOM elements with cloud content.  It is fixed in the center of the page and is given the property position: relative;  (it allows you to scroll the window with the keys of the keyboard). <br>  Its CSS properties are: <br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.cloud</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.cloud-layer</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>:relative; <span class="hljs-attribute"><span class="hljs-attribute">float</span></span>:left; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>:<span class="hljs-number"><span class="hljs-number">720px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">z-index</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>; }</code> </pre><br>  The ‚Äúcloud-contaner‚Äù block is the container for our cloud content.  Why in the EM tag?  Subsequently, we will go over the DOM in search of the current block and in order to hide all the existing ones.  Search on the tag for us is most welcome. <br><br>  To understand the real problem - imagine that we want to view all the personal photos of the user on our website.  Usually done this way: when you first click on a photo, an http-request to the server is made to get an array of all the photos, their unique IDs, descriptions and other information. <br>  For example, I will not do this, but I pre-ordered this array and prepared it for work: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> photoInfo = []; photoInfo[<span class="hljs-number"><span class="hljs-number">0</span></span>] = {<span class="hljs-string"><span class="hljs-string">'id'</span></span>:<span class="hljs-number"><span class="hljs-number">5478</span></span>,<span class="hljs-string"><span class="hljs-string">'name'</span></span>:<span class="hljs-string"><span class="hljs-string">'  ‚Ññ1'</span></span>,<span class="hljs-string"><span class="hljs-string">'desc'</span></span>:<span class="hljs-string"><span class="hljs-string">'  ‚Ññ1'</span></span>,<span class="hljs-string"><span class="hljs-string">'link'</span></span>:<span class="hljs-string"><span class="hljs-string">'1347690631.jpg'</span></span>}; photoInfo[<span class="hljs-number"><span class="hljs-number">1</span></span>] = {<span class="hljs-string"><span class="hljs-string">'id'</span></span>:<span class="hljs-number"><span class="hljs-number">4198</span></span>,<span class="hljs-string"><span class="hljs-string">'name'</span></span>:<span class="hljs-string"><span class="hljs-string">'  ‚Ññ2'</span></span>,<span class="hljs-string"><span class="hljs-string">'desc'</span></span>:<span class="hljs-string"><span class="hljs-string">'  ‚Ññ2'</span></span>,<span class="hljs-string"><span class="hljs-string">'link'</span></span>:<span class="hljs-string"><span class="hljs-string">'1347691505.jpg'</span></span>}; photoInfo[<span class="hljs-number"><span class="hljs-number">2</span></span>] = {<span class="hljs-string"><span class="hljs-string">'id'</span></span>:<span class="hljs-number"><span class="hljs-number">7596</span></span>,<span class="hljs-string"><span class="hljs-string">'name'</span></span>:<span class="hljs-string"><span class="hljs-string">'  ‚Ññ3'</span></span>,<span class="hljs-string"><span class="hljs-string">'desc'</span></span>:<span class="hljs-string"><span class="hljs-string">'  ‚Ññ3'</span></span>,<span class="hljs-string"><span class="hljs-string">'link'</span></span>:<span class="hljs-string"><span class="hljs-string">'1347691550.jpg'</span></span>}; photoInfo[<span class="hljs-number"><span class="hljs-number">3</span></span>] = {<span class="hljs-string"><span class="hljs-string">'id'</span></span>:<span class="hljs-number"><span class="hljs-number">98637</span></span>,<span class="hljs-string"><span class="hljs-string">'name'</span></span>:<span class="hljs-string"><span class="hljs-string">'  ‚Ññ4'</span></span>,<span class="hljs-string"><span class="hljs-string">'desc'</span></span>:<span class="hljs-string"><span class="hljs-string">'  ‚Ññ4'</span></span>,<span class="hljs-string"><span class="hljs-string">'link'</span></span>:<span class="hljs-string"><span class="hljs-string">'1347691521.jpg'</span></span>};</code> </pre><br><br>  Now, when opening the window, we rely on the unique ID of the photo, iterate through the array, select from it the necessary information on the current photo, as well as the ID of the previous and next photo to navigate.  At the same time, we go over the DOM and check if there is actual content in the DOM.  If it exists, we open it; if not, we generate a new block and insert it into the cloud.  But first we check if there is a block with a cloud in the DOM or not yet.  If not yet, and this is the first discovery of a cloud ‚Äî the generation of a cloud, and in it the generation of the parent of cloud content. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  cloudNav()     cloudShow() *         **/</span></span> _cloudNav:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">gid</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (photoInfo) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> num, prev, next, info, len = photoInfo.length; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (len &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;len; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (photoInfo[i].id == gid) { current = i; info = photoInfo[i]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (len &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; (len<span class="hljs-number"><span class="hljs-number">-1</span></span>) &gt; i) {next = photoInfo[i+<span class="hljs-number"><span class="hljs-number">1</span></span>].id;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (len &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {prev = photoInfo[i<span class="hljs-number"><span class="hljs-number">-1</span></span>].id;} num = i+<span class="hljs-number"><span class="hljs-number">1</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-string"><span class="hljs-string">"len"</span></span>:len,<span class="hljs-string"><span class="hljs-string">"num"</span></span>:num,<span class="hljs-string"><span class="hljs-string">"prev"</span></span>:prev,<span class="hljs-string"><span class="hljs-string">"current"</span></span>:gid,<span class="hljs-string"><span class="hljs-string">"next"</span></span>:next,<span class="hljs-string"><span class="hljs-string">"info"</span></span>:info}; } }, <span class="hljs-comment"><span class="hljs-comment">/** *  cloudShow()   ,      * gid -      **/</span></span> cloudShow:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">gid</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/**   ,     **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrNav = Content._cloudNav(gid); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrNav &amp;&amp; arrNav.info) { <span class="hljs-comment"><span class="hljs-comment">/**       **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrNav.prev !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) {ContentPointPrev = arrNav.prev;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {ContentPointPrev = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrNav.next !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) {ContentPointNext = arrNav.next;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {ContentPointNext = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;} <span class="hljs-comment"><span class="hljs-comment">/**   ,          -,    **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elemID(<span class="hljs-string"><span class="hljs-string">'body'</span></span>).style.overflowY != <span class="hljs-string"><span class="hljs-string">'hidden'</span></span>) { elemID(<span class="hljs-string"><span class="hljs-string">'body'</span></span>).style.overflowX = <span class="hljs-string"><span class="hljs-string">'hidden'</span></span>; elemID(<span class="hljs-string"><span class="hljs-string">'body'</span></span>).style.overflowY = <span class="hljs-string"><span class="hljs-string">'hidden'</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/**        -    **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!elemID(<span class="hljs-string"><span class="hljs-string">'cloud'</span></span>)) { <span class="hljs-comment"><span class="hljs-comment">/**      "cloud" **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> box = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'div'</span></span>); box.className = <span class="hljs-string"><span class="hljs-string">'cloud'</span></span>; box.id = <span class="hljs-string"><span class="hljs-string">'cloud'</span></span>; elemID(<span class="hljs-string"><span class="hljs-string">'body'</span></span>).appendChild(box); <span class="hljs-comment"><span class="hljs-comment">/**    "cloud" -    **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cloudbox = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'div'</span></span>); cloudbox.className = <span class="hljs-string"><span class="hljs-string">'cloud-layer'</span></span>; cloudbox.id = <span class="hljs-string"><span class="hljs-string">'cloud-layer'</span></span>; elemID(<span class="hljs-string"><span class="hljs-string">'cloud'</span></span>).appendChild(cloudbox); <span class="hljs-comment"><span class="hljs-comment">/**    "cloud"     // **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> navbox = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'div'</span></span>); navbox.id = <span class="hljs-string"><span class="hljs-string">'cloud-nav'</span></span>; elemID(<span class="hljs-string"><span class="hljs-string">'cloud'</span></span>).appendChild(navbox); <span class="hljs-comment"><span class="hljs-comment">/**       **/</span></span> Content.editSiteLayer(<span class="hljs-string"><span class="hljs-string">'cloud-layer'</span></span>); <span class="hljs-comment"><span class="hljs-comment">/**    -        EM    **/</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ems = elemID(<span class="hljs-string"><span class="hljs-string">'cloud'</span></span>).getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'EM'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ems.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;ems.length; i++) { ems[i].style.display = <span class="hljs-string"><span class="hljs-string">'none'</span></span>; } } } <span class="hljs-comment"><span class="hljs-comment">/**    **/</span></span> elemID(<span class="hljs-string"><span class="hljs-string">'cloud-nav'</span></span>).innerHTML = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-comment"><span class="hljs-comment">/**        -    **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!elemID(<span class="hljs-string"><span class="hljs-string">'cloudpage_'</span></span>+gid)) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> contentbox = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'em'</span></span>); contentbox.className = <span class="hljs-string"><span class="hljs-string">'cloud-contaner'</span></span>; contentbox.id = <span class="hljs-string"><span class="hljs-string">'cloudpage_'</span></span>+gid; elemID(<span class="hljs-string"><span class="hljs-string">'cloud-layer'</span></span>).appendChild(contentbox); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> html = <span class="hljs-string"><span class="hljs-string">'&lt;div class="cloud-title"&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;div class="cloud-name"&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">' '</span></span>+arrNav.num+<span class="hljs-string"><span class="hljs-string">'  '</span></span>+arrNav.len+ <span class="hljs-string"><span class="hljs-string">'&lt;/div&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;div class="cloud-close" onclick="return Content.cloudClose();"&gt; &lt;/div&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;/div&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;div class="cloud-body"&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;&lt;img onclick="'</span></span>+(arrNav.next !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> ? <span class="hljs-string"><span class="hljs-string">'return Content.cloudShow('</span></span>+arrNav.next+<span class="hljs-string"><span class="hljs-string">')'</span></span> : <span class="hljs-string"><span class="hljs-string">'return Content.cloudClose();'</span></span>)+<span class="hljs-string"><span class="hljs-string">'" src="images/'</span></span>+arrNav.info.link+<span class="hljs-string"><span class="hljs-string">'" alt="" /&gt;&lt;/p&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;div class="more-button" onclick="Content.Slide(this, {point:\'next\', hide:\'   \', show:\'   \'})"&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'   '</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;/div&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;span style="display:none;"&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;'</span></span>+arrNav.info.name+<span class="hljs-string"><span class="hljs-string">'&lt;/p&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;'</span></span>+arrNav.info.desc+<span class="hljs-string"><span class="hljs-string">'&lt;/p&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;'</span></span>+lorem[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-string"><span class="hljs-string">'&lt;/p&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;'</span></span>+lorem[<span class="hljs-number"><span class="hljs-number">1</span></span>]+<span class="hljs-string"><span class="hljs-string">'&lt;/p&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;'</span></span>+lorem[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-string"><span class="hljs-string">'&lt;/p&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;'</span></span>+lorem[<span class="hljs-number"><span class="hljs-number">1</span></span>]+<span class="hljs-string"><span class="hljs-string">'&lt;/p&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;'</span></span>+lorem[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-string"><span class="hljs-string">'&lt;/p&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;'</span></span>+lorem[<span class="hljs-number"><span class="hljs-number">1</span></span>]+<span class="hljs-string"><span class="hljs-string">'&lt;/p&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;/span&gt;'</span></span>+ <span class="hljs-string"><span class="hljs-string">'&lt;/div&gt;'</span></span>; elemID(<span class="hljs-string"><span class="hljs-string">'cloudpage_'</span></span>+gid).innerHTML = html; <span class="hljs-comment"><span class="hljs-comment">/**        **/</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { elemID(<span class="hljs-string"><span class="hljs-string">'cloudpage_'</span></span>+gid).style.display = <span class="hljs-string"><span class="hljs-string">'block'</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/**    **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> navi = <span class="hljs-string"><span class="hljs-string">'&lt;div class="cloudnavclose" onclick="return Content.cloudClose();"&gt;&lt;/div&gt;'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrNav.prev !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) {navi+= <span class="hljs-string"><span class="hljs-string">'&lt;div onclick="return Content.cloudShow('</span></span>+arrNav.prev+<span class="hljs-string"><span class="hljs-string">')" class="cloudnavprev"&gt;&lt;/div&gt;'</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrNav.next !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) {navi+= <span class="hljs-string"><span class="hljs-string">'&lt;div onclick="return Content.cloudShow('</span></span>+arrNav.next+<span class="hljs-string"><span class="hljs-string">')" class="cloudnavnext"&gt;&lt;/div&gt;'</span></span>;} elemID(<span class="hljs-string"><span class="hljs-string">'cloud-nav'</span></span>).innerHTML = navi; <span class="hljs-comment"><span class="hljs-comment">/**  ,    **/</span></span> ContentShow = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">/**     **/</span></span> elemID(<span class="hljs-string"><span class="hljs-string">'cloud'</span></span>).style.display = <span class="hljs-string"><span class="hljs-string">'block'</span></span>; } },</code> </pre><br>  Above, I used some values ‚Äã‚Äãof the ‚Äúlorem‚Äù array - in it I prepared in advance a very long text to visually lengthen the page in order to show that the window is fixed. <br><br>  When the window is opened, the Content.editSiteLayer ('cloud-layer') method is closed;  - by the previously described method, we center the cloud window on the center of the page, without letting it jump to right-left when a scroll bar appears. <br><br>  When closing the window, the Content.cloudClose () method is used;  Here he is: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/**  cloudClose()    **/</span></span> cloudClose:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/**      **/</span></span> elemID(<span class="hljs-string"><span class="hljs-string">'cloud'</span></span>).style.display = <span class="hljs-string"><span class="hljs-string">'none'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/**        **/</span></span> elemID(<span class="hljs-string"><span class="hljs-string">'body'</span></span>).style.overflowX = <span class="hljs-string"><span class="hljs-string">'auto'</span></span>; elemID(<span class="hljs-string"><span class="hljs-string">'body'</span></span>).style.overflowY = <span class="hljs-string"><span class="hljs-string">'auto'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/**      **/</span></span> ContentShow = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre><br><br>  And our last task is to connect hotkeys.  To do this, we will create the Content.init () method, which will process the hot keys and, when the page loads, immediately center it in the browser window (this is what I wrote at the very beginning of the article): <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  init()         **/</span></span> init:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/**      **/</span></span> Content.editSiteLayer(<span class="hljs-string"><span class="hljs-string">'layer'</span></span>); <span class="hljs-comment"><span class="hljs-comment">/**      **/</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.onresize = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/**      **/</span></span> Content.editSiteLayer(<span class="hljs-string"><span class="hljs-string">'layer'</span></span>); <span class="hljs-comment"><span class="hljs-comment">/**   ,    **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ContentShow) { Content.editSiteLayer(<span class="hljs-string"><span class="hljs-string">'cloud-layer'</span></span>); } }; <span class="hljs-comment"><span class="hljs-comment">/**      **/</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.onkeydown = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/**     **/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ContentShow) { <span class="hljs-comment"><span class="hljs-comment">/**   **/</span></span> event = event || <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.event; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(event.keyCode) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">27</span></span>: <span class="hljs-comment"><span class="hljs-comment">//  "Escape" Content.cloudClose(); break; case 37: //  " " (    ID   ) if (ContentPointPrev !== null){Content.cloudShow(ContentPointPrev);} break; case 39: //  " " (    ID   ) if (ContentPointNext !== null){Content.cloudShow(ContentPointNext);} break; } } }; }</span></span></code> </pre><br>  This method must be written at the very end of the page before closing the &lt;BODY&gt; tag: <br><pre> <code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> language=<span class="hljs-string"><span class="hljs-string">"javascript"</span></span>&gt;Content.init();<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br><br>  Some will ask why this is the case, and why it cannot be hanged on the body tag in the form <br>  &lt;BODY onload = "Content.init ();"&gt; or use the window.onload () construct. But in this case our object will not start working until the whole page is loaded to the end.  If you have a lot of advertising on the page, this is all the more unpleasant.  Yes, and a sharp jump of the page to the left by 9px when centering it will be a little annoying. <br><br>  In general, we coped with the main tasks.  Once again, <a href="http://www.dimavip.ru/cloudpage/index.html">DEMO EXAMPLE</a> . <br><br>  It was tested in browsers Opera 12.00, Chrome 21 and higher, IE 8 and 9, Safari 5.0 and Yandex.browser 1.0 <br>  Unfortunately, there is no way to test it in Firefox. <br><br>  Thank you for reading the article to the end. <br>  You can download all the CSS, JavaScript files and html from the demo example <a href="">in this archive</a> . <br>  The archive contains 2 JS files: <br>  page.js - file with detailed comments <br>  js.js - the same file, but without comments <br><br>  I am pleased to answer all your questions, as well as listen to any criticism. </div><p>Source: <a href="https://habr.com/ru/post/153073/">https://habr.com/ru/post/153073/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../153061/index.html">Google surpassed Microsoft by capitalization</a></li>
<li><a href="../153065/index.html">Yandex.Store + Mini report from YAC2012</a></li>
<li><a href="../153067/index.html">Google bought Ukrainian startup Viewdle for $ 30 million</a></li>
<li><a href="../153069/index.html">Non-standard WLAN organization approach</a></li>
<li><a href="../153071/index.html">IOI 2012: 4 members from Russia - 4 gold!</a></li>
<li><a href="../153077/index.html">TypeScript: language for developing large JavaScript applications</a></li>
<li><a href="../153079/index.html">FullHD at five inches from Sharp</a></li>
<li><a href="../153083/index.html">The Pirate Bay does not open after a police raid to a provider that does not serve TPB</a></li>
<li><a href="../153085/index.html">Free-lance.ru crazy</a></li>
<li><a href="../153087/index.html">Welcome to the Alawar blog</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>