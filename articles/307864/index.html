<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Go 1.7 release</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, August 16, 2016, the eighth stable release of the Go - Go 1.7 programming language has been released. As usual, the release was released accord...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Go 1.7 release</h1><div class="post__text post__text-html js-mediator-article"><p>  Today, August 16, 2016, the eighth stable release of the Go - <a href="https://golang.org/dl/">Go 1.7</a> programming language has been released.  As usual, the release was released according to the plan, half a year after the previous one, and there are no inversely incompatible changes in it.  At the same time, Go 1.7 has a lot of new and important changes, compilation times and sizes of binaries have been reduced, the speed has been increased, and the context package has finally been added to the standard library.  Under the cat a more detailed overview of the innovations and innovations. </p><a name="habracut"></a><br><h1>  New SSA backend </h1><br><p>  Perhaps one of the most important changes in this release is the use of a new backend compiler that supports <a href="https://en.m.wikipedia.org/wiki/Static_single_assignment_form">SSA-</a> form (Static Single-Assigment).  Switching to SSA-backend gives new opportunities for optimizing and generating more efficient code, and this can already be seen in this release. </p><br><p>  To compare the result of compiling old and new backends, just pass the parameter to the go build command: </p><br><pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">go</span></span> build -gcflags=<span class="hljs-string"><span class="hljs-string">"-ssa=0"</span></span></code> </pre> <br><p>  and for new (SSA is enabled by default in Go 1.7). </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">go</span></span> build</code> </pre> <br><p>  Switching to a new backend now gives an increase in the speed of programs from 5 to 35%. </p><br><p>  You can also delve into the code generated by the backend using the GOSSAFUNC variable: </p><br><pre> <code class="hljs swift"><span class="hljs-type"><span class="hljs-type">GOSSAFUNC</span></span>=main go build &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> ssa.html</code> </pre> <br><img src="https://habrastorage.org/files/efe/b60/fce/efeb60fce73f49b9acf499cd7153a5e5.png"><br><h1>  New metadata format </h1><br><p>  Although this change is completely invisible to ordinary users, it is worth mentioning.  Go 1.7 uses the new metadata export format in binary files, which is more compact and efficient than the previous one.  It fixes some stale bugs and generates smaller binaries.  It can be disabled with the -newexport = 0 option </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">go</span></span> build -newexport=<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><h1>  MacOS X 10.12 'Sierra' support </h1><br><p>  Although we usually expect that binaries compiled with downloadable Go versions will work in all future versions of different OSs - in the case of the not yet released MacOS X 10.12, this is not the case.  In this release of MacOS, the implementation of the gettimeofday () system call was changed, and in Go, a copy of its implementation is actually used, so when it changed in the kernel, I had to change the code in Go.  How can this be reflected in practice? Mac OS X binaries compiled with Go &lt;1.6.3 will not work correctly on MacOS X 10.12 'Sierra'.  If you distribute in binaries, be sure to build them with Go 1.6.3 or 1.7 so that they work correctly on MacOS X 10.12. </p><br><h1>  Optimization and acceleration of the compiler and linker </h1><br><p>  In addition to the above points, many components of the standard library, compiler, and linker have been optimized, with the result that binaries should be 20-30% smaller in size, and the code should work much faster (especially on x86-64 platforms) than Go 1.6.  At the same time, thanks to the new backend, there is still a lot of space for the planned optimizations for the next releases. </p><br><p>  Also in some packages of the standard optimization library added more than 10% acceleration - crypto / sha1, crypto / sha256, encoding / binary, fmt, hash / adler32, hash / crc32, hash / crc64, image / color, math / big, strconv, strings, unicode and unicode / utf16. </p><br><p>  Also in programs with a large number of garutin-launched garbage collector pauses should be much less. </p><br><h1>  Context </h1><br><p>  One of the most anticipated additions to the standard library was the transfer of the golang.org/x/net/context package into <a href="https://golang.org/pkg/context/">context</a> .  The word "net" was removed from the name because, although the context is most often used in code that deals with requests from the network, its functionality is not limited to working with the network.  For example, it can be used for os / exec and other things. </p><br><p>  Why is it important?  In Go, a lot of http frameworks and packages appeared, the task of which was to provide context transfer inside incoming request handlers.  net / context gradually began to occupy this niche, but now, with context in the standard library and with its native support in the net, net / http and os / exec packages, writing code that works with query contexts will be much easier and more unified. </p><br><p>  The <a href="https://golang.org/pkg/net">net</a> package has a new method of type <a href="https://golang.org/pkg/net/">Dialer</a> : </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d *Dialer)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DialContext</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ctx context.Context, network, address </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Conn, error)</span></span></span></span></code> </pre> <br><p>  If the context timeout expires before the connection is established, DialContext returns an error. </p><br><p>  In <a href="http/">net / http</a> , the <a href="http/">Context ()</a> and <a href="http/">WithContext ()</a> methods appeared in the <a href="http/">Request</a> type: </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r *Request)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Context</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">context</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Context</span></span></span></span></code> </pre> <br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r *Request)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithContext</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ctx context.Context)</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Request</span></span></span></span></code> </pre> <br><p>  The Context () method is used to get the request context, to change it, use WithContext ().  In outgoing requests, the context now controls the cancellation of the request. </p><br><h1>  Vendoring </h1><br><p>  In this release, the GO15VENDOREXPERIMENT variable is no longer supported, now the vendoring is the standard Go functionality. </p><br><h1>  Testing </h1><br><p>  The testing package, which is used to write tests, has added support for nested hierarchical tests and benchmarks.  This is very convenient for BDD testing, tabular tests and for a more compact organization of tests in general.  Code example: </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestTeardownParallel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t *testing.T)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// This Run will not return until the parallel tests finish. t.Run("group", func(t *testing.T) { t.Run("Test1", parallelTest1) t.Run("Test2", parallelTest2) t.Run("Test3", parallelTest3) }) // &lt;tear-down code&gt; }</span></span></code> </pre> <br><p>  Details are available in the package documentation: <a href="https://golang.org/pkg/testing/">https://golang.org/pkg/testing/#hdr-Subtests_and_Sub_benchmarks</a> </p><br><h1>  miscellanea </h1><br><ul><li>  go tool trace now does not require a binary to analyze a trace, and the overhead for tracing has decreased from 400% to 20% </li><li>  A simple zipkin-analog tool httptrace - <a href="httptrace/">net / http / httptrace / is</a> included in the standard library </li><li>  os / user.Current no longer requires cgo (so there are 3 places left where cgo is still used in the standard library) </li></ul><br><p>  Full list of changes is available here: <a href="">https://golang.org/doc/go1.7</a> </p><br><h1>  Should I be updated? </h1><br><p>  Usually there are no risks with updating to a new release, and in Go community the latest version is used by the majority.  But it makes sense to wait the first couple of weeks, test builds for 1.7 in test mode.  In the last two releases there were minor releases (1.5.1 and 1.6.1) with fixes for very specific bugs found in the first weeks after the main release. </p><br><h1>  Links </h1><br><p>  <a href="">https://golang.org/doc/go1.7</a> <br>  <a href="https://golang.org/dl/">https://golang.org/dl/</a> </p><br><p>  Ps.  This release was attended by 170 people, of whom 140 are not from Google, but from the Go community. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/307864/">https://habr.com/ru/post/307864/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307854/index.html">‚ÄúThink Financial Models‚Äù: Who are the quanta and how to become them</a></li>
<li><a href="../307856/index.html">Launch Node.js on JVM</a></li>
<li><a href="../307858/index.html">An example of autocomplete implementation using PostgreSQL tsearch2 FTS engine</a></li>
<li><a href="../307860/index.html">Testing under the SCRUM. Thorns, rakes and successes</a></li>
<li><a href="../307862/index.html">Hardware acceleration of corporate computing</a></li>
<li><a href="../307866/index.html">Report on attending a YouTube conference in Kiev or Why video content has become a part of life</a></li>
<li><a href="../307868/index.html">Turn Java / JVM application into a daemon</a></li>
<li><a href="../307870/index.html">Who is to blame and what to do if an IT person is bored at work. Poll results</a></li>
<li><a href="../307874/index.html">Russian and foreign sites for collective financing</a></li>
<li><a href="../307876/index.html">What's new in MS Azure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>