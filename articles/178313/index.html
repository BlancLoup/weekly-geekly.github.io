<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Autostart PPPoE connection without logging in to your account</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I would like to tell you about one trick that can be done using Task Scheduler in Windows. 
 I have Windows 7 installed, and also have a PPPoE connect...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Autostart PPPoE connection without logging in to your account</h1><div class="post__text post__text-html js-mediator-article">  I would like to tell you about one trick that can be done using Task Scheduler in Windows. <br>  I have Windows 7 installed, and also have a PPPoE connection from our city cable provider. <br>  The task is to enable this connection immediately after the connection to the local network rises in Windows, and the user may not even be logged in to his account yet. <br>  Most of the instructions that can be found in runet are reduced to the removal of the shortcut connection in the autorun.  Here is another case.  It is necessary that the connection be made before logging in to the user account. <br>  Looking ahead, I will say that in the same way you can do the execution of any other command, not only when connected to any wired network, but also to Wi-Fi. <br>  I give a complete description, with a bunch of screenshots, as for beginners. <br><a name="habracut"></a><br>  So, what we have is: <br>  ‚Ä¢ Windows, in which there are several accounts (I have created another account for clarity), and you do not want to make an auto login to any of them. <br><img src="https://habrastorage.org/storage2/c4b/17a/bcc/c4b17abccb2d51a812a30b8aa2a7b3e4.png"><br>  ‚Ä¢ Connection using PPPoE, which must be enabled immediately after initialization of the desired network. <br>  ‚Ä¢ There is no router that would solve this problem in the bud, independently connecting and distributing the Internet to computers on the local network.  Well, or the router is not needed in principle. <br><br><h4>  We find out the unique connection identifier (GUID) </h4><br>  We go to the "Start" - "Control Panel" - "System and Security" - below the "Administration" select "View event logs." <br><img src="https://habrastorage.org/storage2/b68/ee6/d3d/b68ee6d3db90629efbd7a179297dd8b0.png"><br>  In the window that opens, on the left, we go along this path: ‚ÄúApplication and service logs‚Äù / ‚ÄúMicrosoft‚Äù / ‚ÄúWindows‚Äù / ‚ÄúNetwork Profile‚Äù / ‚ÄúRunning‚Äù, we find lines with the event code ‚Äú10000‚Äù there. <br><img src="https://habrastorage.org/storage2/782/f17/3bd/782f173bd17df7abf724b15eae4abbb1.png"><br>  Among them we find the one that belongs to the desired network, I have this "Network 2".  Switch to the "Details" tab, and here it is, the GUID we need. <br><img src="https://habrastorage.org/storage2/cb7/f8c/dbf/cb7f8cdbf2da8ebf939ad958ea18d998.png"><br>  You can immediately turn on "XML mode", and view a piece of the XML-representation " <code>...</code> ". <br><img src="https://habrastorage.org/storage2/26a/697/ffa/26a697ffa1e2bde405362a79aa53c090.png"><br>  As another option, you can find the desired GUID in the registry by the following path: <br>  HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ NetworkList \ Profiles <br><img src="https://habrastorage.org/storage2/95c/dc8/854/95cdc88544c48dd167d5a63880b17650.png"><br>  The GUID I need is ‚Äú{80362A4A-DAFB-4B7E-B00C-22AC773E35A3}‚Äù. <br>  Example of an XML representation of the event: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Event</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/win/2004/08/events/event"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Provider</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft-Windows-NetworkProfile"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Guid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{FBCFAC3F-8459-419F-8E48-1F0B49CDB85E}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EventID</span></span></span><span class="hljs-tag">&gt;</span></span>10000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EventID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Level</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Level</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Task</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Task</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Opcode</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Opcode</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Keywords</span></span></span><span class="hljs-tag">&gt;</span></span>0x4000200000000000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Keywords</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TimeCreated</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">SystemTime</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2013-04-28T11:26:41.252839400Z"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EventRecordID</span></span></span><span class="hljs-tag">&gt;</span></span>157<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EventRecordID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Correlation</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Execution</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ProcessID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"572"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ThreadID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1664"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Channel</span></span></span><span class="hljs-tag">&gt;</span></span>Microsoft-Windows-NetworkProfile/Operational<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Channel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Computer</span></span></span><span class="hljs-tag">&gt;</span></span>HWin7VM0-PC<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Computer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Security</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">UserID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"S-1-5-19"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">System</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EventData</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Name"</span></span></span><span class="hljs-tag">&gt;</span></span> 2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Description"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Guid"</span></span></span><span class="hljs-tag">&gt;</span></span>{80362A4A-DAFB-4B7E-B00C-22AC773E35A3}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Type"</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"State"</span></span></span><span class="hljs-tag">&gt;</span></span>17<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Category"</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EventData</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Event</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Here I see that the Network 2 network profile has been connected, and I see its GUID in the string " <code>{80362A4A-DAFB-4B7E-B00C-22AC773E35A3}</code> ". <br><br><h4>  Create a .bat file </h4><br>  You should make sure that you have a PPPoE connection configured so that all users can use it if you want the connection to be made from the System user or from another account.  This is necessary for the case when the account that you usually use does not have a login password.  Later I will remind about it again. <br>  I assume that you have already configured the connection, the only thing that needs to be done is to create a .bat file in which you will need to write <br> <code>rasdial MyDearProvider login password</code> <br>  where rasdial is a console application with which you can establish a connection, ‚ÄúMyDearProvider‚Äù is the name of the PPPoE connection to be connected, and ‚Äúlogin‚Äù and ‚Äúpassword‚Äù, respectively, are the login and password for the connection.  Immediately in the console you can check whether you are connecting to the Internet by running this file, or you can do without the console by setting the ‚Äúpause‚Äù command in the next line and running the file, but do not forget to remove the pause command afterwards, when you achieve launching a .bat file will result in an internet connection. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Create a task in the scheduler </h4><br>  We go to ‚ÄúStart‚Äù - ‚ÄúControl Panel‚Äù - ‚ÄúSystem and Security‚Äù - at the bottom, under ‚ÄúAdministration‚Äù, select ‚ÄúTask Schedule‚Äù. <br><img src="https://habrastorage.org/storage2/63c/e04/709/63ce047093a762538ad7a6f1e0b03cc0.png"><br>  The task scheduler will start, where you have to select ‚ÄúTask Scheduler Library‚Äù on the left, and in the right part of the window click ‚ÄúCreate task ...‚Äù. <br><img src="https://habrastorage.org/storage2/b65/3da/014/b653da014ea23212f6ad4b05cf93ea08.png"><br>  In the window that opens, on the ‚ÄúGeneral‚Äù tab, fill in the ‚ÄúName‚Äù, for example, ‚ÄúAutoconnect_MyDearProvider‚Äù; in the ‚ÄúSecurity Settings‚Äù below, select the desired user from whom the connection will be made, then ‚ÄúPerform regardless of user registration‚Äù, however, if user there is no password to log into the account, the connection will not be made if the user is not logged in.  In case you do not have an account password, select ‚Äúsystem‚Äù as the user.  The highest rights for the task are not needed. <br><img src="https://habrastorage.org/storage2/c87/ceb/88f/c87ceb88f5a3a8132b82139a8709f6a6.png"><img src="https://habrastorage.org/storage2/09f/0e1/098/09f0e1098dd3a71ddb53acc441c7924f.png"><br>  The tab "Triggers" will be the most interesting.  Press the ‚ÄúCreate‚Äù button, in the window that opens, in the ‚ÄúStart task:‚Äù drop-down list, select ‚ÄúAt event‚Äù. <br>  In the ‚ÄúAdvanced Parameters‚Äù you can set up a delayed launch, I set 15 seconds, but then I changed this value for 5 seconds, because I was tired of waiting when I tested all this. <br>  In the "Parameters" select "Custom", just to the right click "Create an event filter". <br><img src="https://habrastorage.org/storage2/e73/138/762/e73138762230313e3bd1786f9af4b9af.png"><br>  A window for creating an event filter appears.  You can fill the frame for the filter with the tools presented on the ‚ÄúFilter‚Äù tab, and then go to the XML representation of the created filter. <br>  Select the following in the event log field: ‚ÄúApplications and Services Logs‚Äù / ‚ÄúMicrosoft‚Äù / ‚ÄúWindows‚Äù / ‚ÄúNetwork Profile‚Äù / ‚ÄúRunning‚Äù.  We put near the "Running" daw. <br><img src="https://habrastorage.org/storage2/8fd/b07/f30/8fdb07f306cfdd41fea1abb414a79771.png"><img src="https://habrastorage.org/storage2/4b5/a73/f32/4b5a73f32172c5c541c6df5fc8c4504f.png"><br>  Then select ‚ÄúNetworkProfile‚Äù as the source of events. <br>  Event code indicate "10000". <br>  It should look like this: <br><img src="https://habrastorage.org/storage2/4b9/a85/ff9/4b9a85ff9af452dcfdabc3aa126fc8bb.png"><br>  Go to the tab "XML", and see the following: <br><img src="https://habrastorage.org/storage2/39c/379/76e/39c37976ee99bb1faba13dd73cbc24f3.png"><br>  It is necessary to edit this, otherwise the trigger will trigger on the connection in general of any network, even on the connection of the PPPoE connection itself. <br>  Click on the checkbox "Edit request manually." <br>  A warning will appear that in the future we will not be able to use the "Filter" tab to configure this filter, agree to continue by clicking "Yes".  We get the following: <br><img src="https://habrastorage.org/storage2/9a6/523/639/9a6523639e456d2c475dd540ae10a624.png"><br>  In the place where I have the cursor (right before the closing tag), I need to add one more condition. <br>  We add there " <code>and *[EventData[Data[@Name='Guid']='{80362A4A-DAFB-4B7E-B00C-22AC773E35A3}']]</code> ", changing my GUID "{80362A4A-DAFB-4B7E-B00C-22AC773E35A3} On some kind of your own. <br><img src="https://habrastorage.org/storage2/b7b/08c/fa2/b7b08cfa22c153809c1398d601d29cc7.png"><br>  Click OK to close the filter settings window, and OK again to close the trigger settings.  You can select a newly created trigger, click ‚ÄúEdit ...‚Äù, and make sure that the ‚ÄúDefer to:‚Äù setting is enabled in the advanced parameters with the right amount of time, for some reason I did not save this option the first time. <br>  On the ‚ÄúActions‚Äù tab, click ‚ÄúCreate‚Äù, in the window that opens, select ‚ÄúRun program‚Äù, then click ‚ÄúBrowse ...‚Äù, and specify where our .bat file is located.  By the way, instead of creating a .bat file, you could just write a rasdial command in the ‚ÄúProgram or Script‚Äù field, and enter ‚ÄúMyDearProvider login password‚Äù in the field with arguments, it would be equivalent to launching the .bat file.  However, it seems to me that it is more convenient to edit a text file than to wander through the settings of the task scheduler in search of the desired field. <br><img src="https://habrastorage.org/storage2/6ad/234/bd8/6ad234bd8c3e2843104dd6c4f1f1a4c7.png"><br>  Click OK, and then go to the "Conditions" tab. <br>  Here we remove the checkbox "Run only when powered from the mains", if it is not necessary.  Set the option "Run only when connected to the following network:" - set the network that you just configured.  This is not necessary, since the filter configured earlier already contains this condition, however, it is not enough that something can go wrong, I decided to leave this setting enabled. <br><img src="https://habrastorage.org/storage2/786/cc7/022/786cc7022e169a976a055928320993a9.png"><br>  And finally, the "Settings" tab.  Here you can leave "Enable task on demand" and "Forced stop of the task if it does not stop on request."  It is necessary to remove the checkbox from "Stop a task that is running longer:". <br>  In order to avoid such a case as ‚Äúit is impossible to connect the first time‚Äù, you can enable the checkbox ‚ÄúOn failure of execution, restart after:‚Äù, and set a waiting period, for example, 1 minute.  I put the number of restart attempts 6. I think it should be connected in 6 minutes. <br><img src="https://habrastorage.org/storage2/432/c27/76e/432c2776e8ee20fa5c719099925ef5e0.png"><br>  Finally, click "OK", and get the necessary. <br><img src="https://habrastorage.org/storage2/c34/9f8/8a8/c349f88a85c9be152c6a23663f7136a7.png"><br>  On the right you need to click on the caption ‚ÄúEnable log of all tasks‚Äù, this will help when debugging the execution of the task.  After setting the log can be disabled. <br>  Go to the "Network and Sharing Center". <br><img src="https://habrastorage.org/storage2/a42/1bc/12b/a421bc12bfd00bdd77e480e9267a4e3f.png"><br>  From the left click "Change adapter settings", and get into the "Network Connections".  Select "Local Area Connection", disable it.  Then re-enable and wait for 15 seconds (or as many as configured in the trigger).  After a while, the status of the connection should change under the name PPPoE-connection, and the event scheduler is more or less described in the task scheduler log. <br>  Then you can check how the computer behaves by restarting it, and waiting for the invitation to select a user to appear.  If you wait some time without choosing a user, the Windows should still connect to PPPoE, even if no user is logged in.  If you have a static IP address, then it is easier to verify that the computer is connected to the Internet.  In my case, the IP address is issued dynamically, so I use the DDNS service. <br>  So, we note how much time is now, so that later we know where to look at the logs in the task log and restart the computer. <br>  Unfortunately, in the case when the task is performed from the system or from another user, it will be possible to disconnect the PPPoE connection only by executing the ‚Äúrasdial MyDearProvider / disconnect‚Äù command from the administrator. <br><br><h4>  Conclusion </h4><br>  For what you need it - decide for yourself.  For example, I needed this in order to access the computer via VNC and be able to reboot it if necessary. <br>  For those who want to experiment with a WiFi connection - the necessary log is here: ‚ÄúApplication and service logs‚Äù / ‚ÄúMicrosoft‚Äù / ‚ÄúWindows‚Äù / ‚ÄúWLAN-AutoConfig‚Äù / ‚ÄúOperational‚Äù.  There you can catch a connection to some WiFi-network by its SSID. <br>  <b>UPD</b> : Here lies one ‚Äúbut‚Äù: the code 10000 is not recorded in the NetworkProfile log if Windows exits from hibernation.  However, <a href="http://www.outsidethebox.ms/12241/">Windows 7 writes event number 300 to the Microsoft-Windows-Diagnostics-Performance log</a> .  You can simply add another trigger to enable the task.  This is quite applicable if the computer is stationary. <br><br><h4>  Materials used in this topic: </h4><br>  <a href="http://superuser.com/questions/262799/how-to-launch-a-command-on-network-connection-disconnection">superuser.com/questions/262799/how-to-launch-a-command-on-network-connection-disconnection</a> - a description of creating a task with its own filter. <br>  <a href="https://social.technet.microsoft.com/Forums/en-US/winservergen/thread/fac16f3c-d088-4d66-83d8-7139261dea83/">social.technet.microsoft.com/Forums/en-US/winservergen/thread/fac16f3c-d088-4d66-83d8-7139261dea83</a> - How to trace a network when an error occurs.  Approximately the same as on the previous link, only descriptions a little more. <br>  <a href="http://superuser.com/questions/92414/how-to-run-a-program-when-connecting-to-a-specific-network-in-windows-7">superuser.com/questions/92414/how-to-run-a-program-when-connecting-to-a-specific-network-in-windows-7</a> - a case with a WiFi connection. </div><p>Source: <a href="https://habr.com/ru/post/178313/">https://habr.com/ru/post/178313/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../178303/index.html">Context-sensitive form in yii</a></li>
<li><a href="../178305/index.html">JQuery Popup Fixed Navigation</a></li>
<li><a href="../178307/index.html">Options in css 3 and a little about the possibilities for rubber sites</a></li>
<li><a href="../178309/index.html">Population algorithm based on fish school behavior</a></li>
<li><a href="../178311/index.html">The implementation of the stack due to ... call stack</a></li>
<li><a href="../178321/index.html">Automated testing of a web application (MS Unit Testing Framework + Selenium WebDriver C #). Part 1: Introduction</a></li>
<li><a href="../178323/index.html">Arduino Artificial Intelligence</a></li>
<li><a href="../178325/index.html">How we made the connection at the Grib diamond deposit</a></li>
<li><a href="../178327/index.html">Re: Find out the white IP-address of the router from the server, which is behind the NAT-ohm</a></li>
<li><a href="../178329/index.html">Getting amateur category</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>