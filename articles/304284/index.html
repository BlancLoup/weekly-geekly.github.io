<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Chat bot algorithms based on recurrent neural network and AIML language extensions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, the creation of programs simulating human communication remains relevant. The simplest model of communication is the database of questions and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Chat bot algorithms based on recurrent neural network and AIML language extensions</h1><div class="post__text post__text-html js-mediator-article">  Today, the creation of programs simulating human communication remains relevant.  The simplest model of communication is the database of questions and answers to them [1].  In this case, there is the problem of describing the knowledge base and the implementation of the interpreter program.  The markup language of the knowledge base can include question patterns and corresponding response patterns, as well as the background history of the dialogues to them and the name of the corresponding communication topic. <br><br>  Chat bot can perform additional functions, such as music search, pictures, facts, calculator, weather forecast, display of exchange rates.  Most of these functions have an implementation on the Internet and are available as an external API. <br><br>  An alternative option for creating a virtual interlocutor program is to use machine learning algorithms based on communication dialogues, namely, artificial neural networks.  A suitable ANN model is a recurrent neural network capable of storing, synthesizing, and predicting various sequences.  In this paper, we propose using the corresponding words in the knowledge and question knowledge base as elements of the sequence. <br><a name="habracut"></a><br><h3>  AIML </h3><br>  One of the knowledge markup formats is the AIML (Artificial Intelligence Markup Language) markup language standard.  The key words in the language are category, pattern and template: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">aiml</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span>!  ?<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">random</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>. .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>. .   ?<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">random</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">aiml</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The category tag is the parent of the pattern and template tags that hold the question and answer templates.  The random tag allows you to specify multiple answers to the question, selected by the interpreter randomly.  The paper proposes to introduce additional tags relevant stories and topics of conversation. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">aiml</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span> ?<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span> ?<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">random</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">random</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">history</span></span></span><span class="hljs-tag">&gt;</span></span>!  ? . .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">history</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">theme</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">theme</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">aiml</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Several pattern tags allow you to describe different versions of questions that correspond to a given category, to which the same answers should follow.  The history tag stores the history of the dialog that precedes this question.  The theme tag stores the name of the conversation topic.  These tags allow the interpreter to select the question pattern corresponding to the pre-history of the dialogue and the topic of communication, which should have an impact on improving the quality of communication imitation by the chat bot. <br><br>  The markup interpreter should allow finding the most relevant questions in the following complementary ways: <br><br><ul><li>  1. Search the entire phrase of a question based on a regular expression. </li><li>  2. Search by the number of matching words in the question and patterns. </li><li>  3. Search by current topic matching and category topics. </li><li>  4. Search by the number of matching words in the current conversation history and category history. </li></ul><br>  The corresponding algorithm for selecting the best match is formed on the basis of the sorting algorithm: <br><br><pre> <code class="javascript hljs">sortMatches = allMatches.sort(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a.pattern == inputText &amp;&amp; b.pattern != inputText) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(b.pattern == inputText &amp;&amp; a.pattern != inputText) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a.matches &lt; b.matches) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a.matches &gt; b.matches) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a.theme == bot.theme &amp;&amp; b.theme != bot.theme) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(b.theme == bot.theme &amp;&amp; a.theme != bot.theme) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a.historyMatches &lt; b.historyMatches) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a.historyMatches &gt; b.historyMatches) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; })</code> </pre><br>  As a result, the first element of the sorted array of matches is selected. <br><br>  To improve the quality of the search for relevant answers, a morphological analyzer module was introduced in the word comparison procedure, which allows finding the basic forms of words.  Thus, the comparison is based on the basic forms of words, which eliminates the inconsistencies of words associated with their inclinations. <br><br><h3>  Theme classification algorithm </h3><br>  It is proposed to use an algorithm for determining the names of categories when only a part of them is defined. <br><br><ul><li>  1. Let the set of categories in which the themes are defined are T. The set of categories in which the themes are not defined are D. The elements of these sets are associated with the union of the strings of all the values ‚Äã‚Äãof patterns and category templates. </li><li>  2. A threshold of determination is introduced, for example, p = 70%. </li><li>  3. The elements of the set D. are sequentially sorted out. A subset V of the elements of the set T is selected, in which p is the percentage of unique words defined. </li><li>  4. If V is empty, then the topic is determined by the string of the element of the set D. </li><li>  5. If V is not empty, then an element is selected from V for which the ratio of the number of matching unique words to the total number of unique words in the string of this element is maximum.  The corresponding topic of this element V is defined as the topic of element D. </li></ul><br><h3>  Recurrent neural network </h3><br>  A recurrent neural network is a type of multilayer perceptron in which signals from neurons of the output layer arrive at additional neurons of the input layer, the so-called.  context neurons. <br><br>  The input signal vector is fed to the INPUT group of neurons, the zero signal on the CONTEXT neuron group.  Then the signal propagates into the group of neurons of the hidden layer HIDDEN, and then is transformed by them and falls on the neurons of the output layer OUTPUT.  At the next iteration, along with the INPUT signal vector, copies of the signals from the output OUTPUT layer of the previous iteration arrive at the context group of neurons (Fig. 1). <br><br><img src="https://habrastorage.org/files/ba9/de4/ac3/ba9de4ac336f435b869bc50adcb4b4c8.png" width="300" alt="image"><br>  <i>Fig.</i>  <i>1. General view of the structure of the recurrent neural network.</i> <br><br>  The structure of the recurrent neural network for memorizing sentences is as follows: <br><br>  The CONTEXT, INPUT and OUTPUT layers each have one neuron, the signal values ‚Äã‚Äãat the output of which correspond to the index of a word in a set of words.  Additionally, the word __end__ is entered corresponding to the end of the sentence [2].  The network is consistently trained in sentences of the form: <br><br>  "Hello.  How are you?  __end__ Hi.  Fine.  __end__ " <br><br>  Receiving answers to questions by a recurrent neural network is as follows (Fig. 2). <br><br><img src="https://habrastorage.org/files/292/9b3/889/2929b38895bd48d88d4bf66332ca9485.png" width="500" alt="image"><br>  <i>Fig.</i>  <i>2. Getting an answer to a question using a recurrent neural network.</i> <br><br>  The volume of HIDDEN layers should allow you to remember the entire set of sentences  The network is trained in the back propagation method. <br><br><h3>  Software implementation </h3><br>  The chat bot program was implemented as an Android application.  The application has several chat bot modes: <br><br><ul><li>  1) based on external API <a href="http://www.pandorabots.com/">www.pandorabots.com</a> ; </li><li>  2) on the basis of the original generalization of the AIML language; </li><li>  3) based on a recurrent neural network. </li></ul><br>  As a morphological analyzer, a free JavaScript-library for processing texts in Russian Az.js was used. <br><br>  To create and train a recurrent neural network, the free JavaScript library RecurrentJS was used. <br><br>  In all modes, automatic translation of answers into the user's question language is available based on the Yandex Translate API and Bing Translate API services.  Also, as the external services, the image search service Custom Search API and Bing Image Search API are used.  Knowledge Search is based on the Google Knowledge Graph Search API.  Music search is based on the SoundCloud API.  Calculator, weather forecast, exchange rate, time implemented on the basis of Wolfram | Alpha API. <br><br>  ChatBot is available on Google Play at <a href="https://play.google.com/store/apps/details%3Fid%3Dsvlab.chatbot">https://play.google.com/store/apps/details?id=svlab.chatbot</a> . <br><br><h3>  Conclusion </h3><br>  Algorithms for building a chat bot based on AIML advanced markup and a recurrent neural network are considered.  The AIML markup extension includes new theme and history tags to more effectively search for relevant questions and answers in the context of the dialogue.  To determine the names of categories, when only their part is defined, it is proposed to use a heuristic algorithm for classifying topics.  Using the module of the morphological analyzer of individual words and bringing them into the basic form allows you to improve the quality of the search for relevant answers.  A recurrent neural network allows you to get answers to questions that were not in the knowledge base, using the network's ability to generalize.  The ChatBot app is available for the Android platform in the Play Store. <br><br><h3>  Literature </h3><br><ul><li>  1. Provar A.I., Klochko K.A.  Features and problems of virtual communication using chat bots // Scientific works of Vinnitsa National Technical University.  2013. ‚Ññ 3. S. 2. </li><li>  2. Oriol Vinyals, Quoc Le A Neural Conversational Model // arXiv preprint arXiv: 1506.05869, 22 Jul 2015. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/304284/">https://habr.com/ru/post/304284/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304274/index.html">GFI Archiver: Mail Storage</a></li>
<li><a href="../304276/index.html">GFI MailEssentials: Mail Protected</a></li>
<li><a href="../304278/index.html">Altaro VM Backup: Backup Hyper-V and VMware Virtual Machines</a></li>
<li><a href="../304280/index.html">Welcome to the IoT hackaton from Mail.Ru Group and Intel July 30‚Äì31</a></li>
<li><a href="../304282/index.html">The robot, which does answer the question about the weather in Tokyo (in fact - no, but close)</a></li>
<li><a href="../304286/index.html">We send encrypted SMS messages from Virgil</a></li>
<li><a href="../304288/index.html">PCI DSS: Trends and Benefits</a></li>
<li><a href="../304290/index.html">IaaS-digest: 30 materials on technology transformation</a></li>
<li><a href="../304292/index.html">Improving service design in IaaS model</a></li>
<li><a href="../304294/index.html">Independent Developer Cup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>