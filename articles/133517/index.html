<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Legal bootkits</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Clever Rusakov, whom many still mistakenly call RusTOKov, wrote another article on www.securelist.ru . And again - about rootkit technology. However, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Legal bootkits</h1><div class="post__text post__text-html js-mediator-article">  Clever Rusakov, whom many still mistakenly call RusTOKov, wrote another article on <a href="http://www.securelist.com/ru/analysis/208050726/Legalnye_butkity">www.securelist.ru</a> .  And again - about rootkit technology.  However, neither TDL 4 nor any other malicious program is mentioned in this article.  Because the article is about the dangers of using sloppy implemented rootkit technologies in legal products, which the author directly informs in the introduction.  By the way, a special thank you for introducing him, because without him an unprepared reader would not understand anything at all - despite the fact that there are quite a few pictures in the text. <br><br>  To begin with, the author with suspicious insight comes up with <a href="http://www.securelist.com/ru/analysis/208050726/Legalnye_butkity">several cases of</a> the very inaccurate implementation that could allow the villains to use legal drivers, protectors, cryptors and classic anti-rootkits for their villainous purposes.  He practically succeeds in convincing the reader that a legitimate signed driver poses a potential security threat if the rootkit technologies are implemented in it with the care of the Russian car industry.  Moreover, with suspicious awareness claiming that there are no fools on the other side of the barricades, the author intimidates readers with the possibility of the villains to dismantle the invented careless implementation of the kernel mode driver for bones and the knowledge obtained in such a barbaric way - to use it for evil purposes. <br><br> <a href=""><img src="http://www.securelist.com/ru/images/vlill/rusakov_legal_butkit_pic04.png" alt="image"></a> <br>  <i>‚ÄúHowever, we discovered an anomaly - the substitution of the MBR during reading.</i>  <i>The substitution is implemented by the disk stack filter driver ‚Äù( <a href="http://www.securelist.com/ru/analysis/208050726/Legalnye_butkity">Comodo Time Machine</a> ).</i> <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Then it turns out that there are still legal programs on users' computers whose behavior seems suspicious not only to the author, but also to the anti-rootkit component of Kaspersky Anti-Virus.  The author considers four programs using rootkit technologies: COMODO Time Machine, Norton GoBack, RestoreIT and PC Back Pro / Rollback Rx (one program with two names).  All products were created with a noble goal - to return the system to a normal state in case of unforeseen disasters.  Although two of the four programs are no longer supported by the manufacturer, the author also finds fault with them.  And it turns out that all programs have the ability to start using the magic button of a special recovery console before loading the operating system.  To realize this possibility, the MBR modification mechanism was used in all cases. <br><br>  Further worse.  In all programs, MBR substitution is detected during reading, which is implemented by the disk stack filter driver.  In addition, in the case of reading the MBR, the MBR content is issued before the modification - that is, the fake content.  And the entry in the MBR is either prohibited, or the filter driver sends you far away, i.e.  redirects the request and writes to another location.  At the same time, the modified MBR remains intact. <br><br>  Even further - even worse, because the author, despite all his insight, the <a href="http://www.securelist.com/ru/analysis/208050726/Legalnye_butkity">fact of concealing the MBR</a> "surprised."  And he decides to check how the products behave, if you modify the boot record to bypass the filter driver.  Having successfully pushed a bunch of garbage around the filter into the MBR, the author discovers terrible things: after MBR is rewritten, all products continue to produce fake content when reading the MBR;  computer after reboot ("of course") does not boot;  and the recovery console cannot be called up by any magic buttons. <br><br>  After thinking about the situation, the author comes to the conclusion that the use of this software can threaten the user a lot of trouble, namely: <br><br>  ‚Ä¢ he will not have the opportunity to learn about the infection of the MBR; <br>  ‚Ä¢ malware on your computer will be hidden with the help of a legal utility; <br>  ‚Ä¢ in case of serious problems, software for system rollback will most likely not work; <br>  ‚Ä¢ The use of partition editing tools can lead to system loss. <br><br>  Being impressed by what he did, Rusakov even gives some recommendations to manufacturers of the products discussed above and their analogues.  We quote: <br><ol><li>  The MBR modification mechanism is quite legal, but it is necessary to completely abandon the rootkit technologies in their products - there are other algorithms.  Do not hide anything from users. </li><li>  Recovery Console can be implemented as a boot disk or removable media. </li><li>  The drivers need the caller's authentication functionality if it is not there (end of quotation). </li></ol><br>  We, for our part, join Vyacheslav's calls: if they hide your products from the user, let them stop immediately!  Because the experts <a href="http://www.securelist.com/ru/analysis%3Fauthor%3D198648163">of the author</a> know that this is not the end.  Clever Rusakov will eventually write another article, and if you do not immediately follow his advice, he will get to your products, to the rootkit technologies implemented in them, and to the root of evil. </div><p>Source: <a href="https://habr.com/ru/post/133517/">https://habr.com/ru/post/133517/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../133511/index.html">FINANCE.UA: a few facts about the leading financial portal of Ukraine</a></li>
<li><a href="../133512/index.html">Work with Doxygen in CMake</a></li>
<li><a href="../133514/index.html">Yandex acquired SPB Software</a></li>
<li><a href="../133515/index.html">The calendar of affairs in the ‚ÄúSimple Business‚Äù system is a convenient and visual representation of your tasks.</a></li>
<li><a href="../133516/index.html">Once upon a time there was a grandfather and Java ...</a></li>
<li><a href="../133518/index.html">Installing Fedora 16 as a full-featured PV-guest system on XenServer</a></li>
<li><a href="../133519/index.html">How are the news or spiritual people against soulless machines</a></li>
<li><a href="../133520/index.html">Copyright in two axioms</a></li>
<li><a href="../133523/index.html">Alawar announcements: HTML5 game engine, support for IE9 pinned site and browser's own build</a></li>
<li><a href="../133524/index.html">The attackers "took away" the data of 13 million Maple Story players</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>