<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What is RQL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagine that you have a data warehouse with a REST interface. Let it contains information about books and you want to display a list of all books. You...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What is RQL</h1><div class="post__text post__text-html js-mediator-article"> Imagine that you have a data warehouse with a REST interface.  Let it contains information about books and you want to display a list of all books.  You can make the method of "books", which will return us a list of books.  But when the list is displayed, there is usually a padjina or lazy loading of data, and still wants to filter and sort the data.  When we add support for mobile devices, we still have a need to somehow limit the amount of data we receive without transferring some of the fields.  All this information should be able to understand almost any method of obtaining a list of objects, since  lists are displayed using a special widget.  And this is where Resource Query Language comes to the rescue. <br><br>  Resource Query Language (RQL) is a query language designed to be used in URIs when working with object-like data structures.  Using RQL, a client can request from the server a list of objects that comply with certain rules, i.e., in essence, this is the syntax that describes how to request data.  For example, a query that selects all books of authorship by Perumov can be written as <code>eq(author,)</code> or in the usual URL format: <code>author=</code> . <br><a name="habracut"></a><br>  RQL can be considered, basically, as a set of nested operators, each of which has a set of arguments.  It is designed for a very simple but extensible grammar that can be used in a valid URL request. <br><br><h2>  How to use RQL </h2><br>  An RQL expression contains query functions or comparison operators connected by logical operators. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Typical scripts </h3><br>  First we analyze typical scenarios.  For better understanding, we will compare with similar commands in MongoDB. <br><br>  Suppose we have a list of books: <br><br><pre> <code class="hljs vbscript">[ { title: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">year</span></span>: <span class="hljs-number"><span class="hljs-number">1993</span></span>, series: <span class="hljs-string"><span class="hljs-string">" "</span></span> }, { title: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">year</span></span>: <span class="hljs-number"><span class="hljs-number">1993</span></span>, series: <span class="hljs-string"><span class="hljs-string">" "</span></span> }, { title: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">year</span></span>: <span class="hljs-number"><span class="hljs-number">1995</span></span>, series: <span class="hljs-string"><span class="hljs-string">" "</span></span> }, { title: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">year</span></span>: <span class="hljs-number"><span class="hljs-number">1995</span></span>, series: <span class="hljs-string"><span class="hljs-string">" "</span></span> } ]</code> </pre> <br>  Let's display all the books from the ‚ÄúRing of Darkness‚Äù series.  In MongoDB, we would do it like this: <br><br><pre> <code class="javascript hljs">db.users.find({<span class="hljs-attr"><span class="hljs-attr">series</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>})</code> </pre> <br>  in RQL it will look like this: <br><br><pre> <code class="javascript hljs">eq(series, <span class="hljs-string"><span class="hljs-string">" "</span></span>)</code> </pre> <br>  or <br><br><pre> <code class="javascript hljs">series=<span class="hljs-string"><span class="hljs-string">" "</span></span></code> </pre> <br>  Such a request will return us three books. <br><br>  Now a more complex query: we need to bring all the books of the Ring of Darkness series published in 1995. <br><br>  In MongoDB: <br><br><pre> <code class="javascript hljs">db.users.find({<span class="hljs-attr"><span class="hljs-attr">series</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">year</span></span>: <span class="hljs-number"><span class="hljs-number">1995</span></span>})</code> </pre> <br>  In RQL: <br><br><pre> <code class="javascript hljs">eq(series, <span class="hljs-string"><span class="hljs-string">" "</span></span>),eq(year, <span class="hljs-number"><span class="hljs-number">1995</span></span>)</code> </pre> <br>  Previous queries applied to simple objects.  But documents can be very complex in structure.  For example, add a new book to our library: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-attr"><span class="hljs-attr">year</span></span>: <span class="hljs-number"><span class="hljs-number">1995</span></span>, <span class="hljs-attr"><span class="hljs-attr">series</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">translations</span></span>: { <span class="hljs-attr"><span class="hljs-attr">language</span></span>: <span class="hljs-string"><span class="hljs-string">"English"</span></span>, <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">"Godsdoom"</span></span> } }</code> </pre> <br>  The nested object with the <code>translations</code> key is defined here.  And to find all the books translated into English, we need to use a dot. <br><br>  In MongoDB: <br><br><pre> <code class="javascript hljs">db.users.find({<span class="hljs-string"><span class="hljs-string">"translations.language"</span></span>: <span class="hljs-string"><span class="hljs-string">"English"</span></span>})</code> </pre> <br>  In RQL: <br><br><pre> <code class="javascript hljs">eq(translations.language, <span class="hljs-string"><span class="hljs-string">"English"</span></span>)</code> </pre> <br>  Over time, our library has grown.  The list of books does not fit on the screen and we decided to show it page by page. <br><br>  In MongoDB we can get the second dozen records as follows: <br><br><pre> <code class="javascript hljs">db.users.find().skip(<span class="hljs-number"><span class="hljs-number">10</span></span>).limit(<span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> <br>  In RQL: <br><br><pre> <code class="javascript hljs">limit(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> <br>  But show little by page.  I also want to sort the data. <br><br>  In MongoDB, this will be: <br><br><pre> <code class="javascript hljs">db.users.find().sort({<span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>})</code> </pre> <br>  In RQL: <br><br><pre> <code class="javascript hljs">sort(+title)</code> </pre> <br><h2>  Functions </h2><br>  Basic functions of the standard: <br><table><tbody><tr><th>  Function </th><th>  Description </th></tr><tr><td>  <b>in (&lt;propyrty&gt;, &lt;array-of-values&gt;)</b> </td><td>  Selects objects whose value is <br>  The specified property is included in the specified array of properties. <br><br>  <b>Example:</b> <br> <code>in(name,(Silver,Gold))</code> <br> </td></tr><tr><td>  <b>out (&lt;propyrty&gt;, &lt;array-of-values&gt;)</b> </td><td>  Selects objects for which the value of the specified property is not included in the specified array of properties. <br><br>  <b>Example:</b> <br> <code>out(name,(Platinum,Gold))</code> </td> </tr><tr><td>  <b>limit (&lt;start&gt;, &lt;number&gt;)</b> </td><td>  Returns the specified <i>number</i> <i><br></i>  <i>(number) of</i> objects starting from a certain ( <i>start</i> ) position. <br><br>  <b>Example:</b> <br> <code>limit(0,2)</code> </td> </tr><tr><td>  <b>sort (&lt;list of properties with + or - prefix&gt;)</b> </td><td>  Sorts the list of objects by specified properties (the number of properties is unlimited).  First, the list is sorted by the first of the specified properties, then by the second, and so on. <br>  The sort order is determined by the prefix: + - ascending, - - descending. <br><br>  <b>Example:</b> <br> <code>sort(+memory,-diskspace)</code> </td> </tr><tr><td>  <b>select (&lt;list offf attributes&gt;)</b> </td><td>  Cuts each object to the set of properties specified in the arguments. <br><br>  <b>Example:</b> <br> <code>select(name,user)</code> </td> </tr><tr><td>  <b>values ‚Äã‚Äã(&lt;property&gt;)</b> </td><td>  Returns a set of values ‚Äã‚Äãfrom the specified field of all objects. <br><br>  <b>Example:</b> <br> <code>values(ve.name)</code> </td> </tr><tr><td>  <b>count ()</b> </td><td>  Returns the number of records. <br><br>  <b>Example:</b> <br> <code>in(name,(Silver,Gold))&amp;count()</code> </td> </tr><tr><td>  <b>max (&lt;property?&gt;)</b> </td><td>  Returns the maximum value from the specified field of all objects. <br><br>  <b>Example:</b> <br> <code>max(ve.memory)</code> </td> </tr><tr><td>  <b>min (&lt;property?&gt;)</b> </td><td>  Returns the minimum value from the specified field of all objects. <br><br>  <b>Example:</b> <br> <code>min(ve.memory)</code> </td> </tr></tbody></table><br>  More existing operators can be found in the <a href="http://www.persvr.org/rql/">official documentation</a> . <br><br>  In APS technology, a new feature has been added to RQL: <br><table><tbody><tr><th>  Function </th><th>  Description </th></tr><tr><td>  <b>like (&lt;property&gt;, &lt;pattern&gt;)</b> </td><td>  Searches for a given pattern (pattern) in a given property (property).  This <br>  the function is similar to the SQL LIKE operator, although it uses the <code>*</code> symbol instead of <code>%</code> .  To determine the character <code>*</code> itself in a pattern, it must be percent-coded, that is, you must write <code>%2A</code> instead of <code>*</code> , see examples.  In addition, in the pattern, you can use the symbol <code>?</code>  denoting that any character in this position is valid. <br><br>  <b>Examples:</b> <br> <code>like(firstName,Jo*) <br> like(firstName,*ohn) <br> like(firstName,*oh*) <br> like(firstName,Joh?)</code> </td> </tr></tbody></table><br>  And three more APS-specific functions: <br><table><tbody><tr><th>  Function </th><th>  Description </th></tr><tr><td>  <b>implementing (&lt;bas-type&gt;)</b> </td><td>  Returns a list of objects (resources and types) that implement the base type and include the base type itself. <br><br>  <b>Example:</b> <br> <code>implementing (http://aps-standard.org/samples/user-mgmt/offer/1.0)</code> </td> </tr><tr><td>  <b>composing (&lt;derived-type&gt;)</b> </td><td>  Returns a list of types that are implemented by the derived type, including the derived type itself. <br><br>  <b>Example:</b> <br> <code>composing(http://aps-standard.org/samples/user-mgmt/offer/1.0)</code> </td> </tr><tr><td>  <b>linkedWith (&lt;resource ID&gt;)</b> </td><td>  Returns a list of resources that are associated with the resource whose ID is specified as an argument.  The APS controller searches for all resource references, including internal system references.  For example, the admin / owner / referrer actor with access to the resource will also be considered a ‚Äúbound‚Äù resource. <br><br>  <b>Examples:</b> <br> <code>linkedWith(220aa29a-4ff4-460b-963d-f4a3ba093a0a) <br> <br> implementing(http://aps-standard.org/types/core/user/service/1.0), linkedWith(220aa29a-4ff4-460b-963d-f4a3ba093a0a)</code> </td> </tr></tbody></table><br><h3>  Logical operators </h3><br>  Logical operators allow, through Boolean logic, to combine two or more query functions.  All standard logical operators have short aliases. <br><table><tbody><tr><th>  Operator </th><th>  Alias </th><th>  Examples </th></tr><tr><td>  <b>and (&lt;query&gt;, &lt;query&gt;, ...)</b> </td><td>  &amp; <br>  , </td><td> <code>and (limit(0,2),like(name,*L*))</code> <br> <br>  <b>Value</b> <br>  Selects the first two sentences whose names match the case insensitive pattern <code>*L*</code> </td></tr><tr><td>  <b>or (&lt;query&gt;, &lt;query&gt;, ...)</b> </td><td>  | <br>  ; </td><td> <code>or(like(description,*free*),in(name,(Silver,Gold)))</code> <br> <br>  <b>Value</b> <br>  Selects all sentences whose descriptions correspond to the pattern <code>*free*</code> , as well as those whose name is <code>Silver</code> or <code>Gold</code> . </td></tr></tbody></table><br>  In APS technology, a new logical negation operator has also been added to RQL: <br><table><tbody><tr><th>  Operator </th><th>  Examples </th></tr><tr><td>  <b>not (&lt;query&gt;)</b> </td><td> <code>not(like(name,*free*))</code> <br> <br>  <b>Value</b> <br>  Selects all offers, except those whose name matches <br>  Habr and HotTimes - RQL pattern <code>*free*</code> . </td></tr></tbody></table><br>  <b>Note</b> <br><br><ol><li>  The <code>and</code> operator is an implicit top-level RQL operator.  For example, the expression <code>http://hosting.com?and(arg1,arg2,arg3)</code> equivalent to <code>http://hosting.com?arg1,arg2,arg3</code> . </li><li>  Operator and priority is higher than or.  Therefore, when using aliases, you need to enclose the combined queries in parentheses, thereby determining the necessary processing order.  For example, <code>implementing(&lt;typ&gt;),(prop1=eq=1|prop2=ge=2)</code> . </li></ol><br><h2>  Comparison operators </h2><br>  The comparison operator is used to filter objects by comparing one of their properties with a given <a href="https://doc.apsstandard.org/2.1/spec/rql/">value</a> . <br><table><tbody><tr><th>  Operator </th><th>  Alias </th><th>  Examples </th></tr><tr><td>  <b>eq (&lt;propyrty&gt;, &lt;valu&gt;)</b> </td><td>  = eq = </td><td> <code>eq(aps.status,aps:ready) <br> aps.status=eq=aps:ready</code> <br> <br>  <b>Value</b> <br>  Selects all objects whose <code>aps.status</code> is set to <code>aps:ready</code> . </td></tr><tr><td>  <b>ne (&lt;propyrty&gt;, &lt;valu&gt;)</b> </td><td>  = ne = </td><td> <code>ne(aps.status,aps:ready) <br> aps.status=ne=aps:ready</code> <br> <br>  <b>Value</b> <br>  Selects all objects whose <code>aps.status</code> is set to <code>aps:ready</code> . </td></tr><tr><td>  <b>gt (&lt;propyrty&gt;, &lt;valu&gt;)</b> </td><td>  = gt = </td><td>  implementing (http://aps-standard.org/samples/user-mgmt/offer), hardware.memory = gt = 1024) <br><br>  <b>Value</b> <br>  Selects all offers (offers) that provide <code>hardware.memory</code> more than 1024. </td></tr><tr><td>  <b>ge (&lt;propyrty&gt;, &lt;valu&gt;&gt;)</b> </td><td>  = ge = </td><td>  implementing (http://aps-standard.org/samples/user-mgmt/offer), hardware.memory = ge = 1024) <br><br>  <b>Value</b> <br>  Selects all offers (offers) providing <code>hardware.memory</code> greater than or equal to 1024. </td></tr><tr><td>  <b>lt (&lt;propyrty&gt;, &lt;valu&gt;)</b> </td><td>  = lt = </td><td>  implementing (http://aps-standard.org/samples/user-mgmt/offer), hardware.CPU.number = lt = 16) <br><br>  <b>Value</b> <br>  Selects all offers (offers) providing <code>hardware.CPU.number</code> less than 16. </td></tr><tr><td>  <b>le (&lt;propyrty&gt;, &lt;valua&gt;)</b> </td><td>  = le = </td><td>  implementing (http://aps-standard.org/samples/user-mgmt/offer), hardware.CPU.number = le = 16) <br><br>  <b>Value</b> <br>  Selects all offers (offers) providing <code>hardware.CPU.number</code> less than or equal to 16. </td></tr></tbody></table><br>  String types are compared in <a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B5%25D0%25BA%25D1%2581%25D0%25B8%25D0%25BA%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25BF%25D0%25BE%25D1%2580%25D1%258F%25D0%25B4%25D0%25BE%25D0%25BA">lexicographical order</a> . <br><br><h2>  Meanings </h2><br>  Query functions and comparison operators may contain the following values: <br><br><ul><li>  Strings (using URL coding) </li><li>  Numbers </li><li>  Dates (ISO UTC without colon) </li><li>  Boolean </li><li>  Value functions (Value functions) </li></ul><br>  Value functions are functions that return special values ‚Äã‚Äãlike <code>null</code> , <code>true</code> , <code>false</code> or an empty string value.  They all apply to certain types of data. <br><table><tbody><tr><th>  Function value </th><th>  Applicable Types </th><th>  Descriptions </th><th>  Examples </th></tr><tr><td>  <b>null ()</b> </td><td>  Any type </td><td>  Set if the value is <code>null</code> </td><td> <code>name=eq=null()</code> </td> </tr><tr><td>  <b>true ()</b> <b><br></b>  <b>false ()</b> </td><td>  Boolean </td><td>  Set if <code>true</code> or <code>false</code> </td><td> <code>disabled=eq=false()</code> </td> </tr><tr><td>  <b>empty ()</b> </td><td>  String </td><td>  Set if the string value is empty (not <code>null</code> , but does not contain any characters) </td><td> <code>addressPostal.extendedAddress=eq=empty()</code> </td> </tr></tbody></table><br><h2>  Using </h2><br>  There are a large number of implementations of RQL parsers in various programming languages. <br><br>  The JavaScript implementation, in addition to the parser, also contains an engine that can apply an RQL query to an array of objects. <br><br>  The original implementation of RQL in JavaScript is in npmjs: <a href="https://www.npmjs.com/package/rql">https://www.npmjs.com/package/rql</a> <br><br>  The implementation with the functionality added by us is also available via npm: <a href="https://www.npmjs.com/package/aps-rql">https://www.npmjs.com/package/aps-rql</a> </div><p>Source: <a href="https://habr.com/ru/post/331774/">https://habr.com/ru/post/331774/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331762/index.html">Ukraine has undergone the largest virus in the history of cyber attack Petya</a></li>
<li><a href="../331766/index.html">Building application management systems in a distributed cluster infrastructure based on MESOS technology</a></li>
<li><a href="../331768/index.html">MIPT launches Russia's first online magistracy in technology entrepreneurship</a></li>
<li><a href="../331770/index.html">JQuery plugin - jdDialog. The principle of "transit calls"</a></li>
<li><a href="../331772/index.html">Cash registers go online: Russia's tax has opened a new market for application developers</a></li>
<li><a href="../331776/index.html">SD-WAN "on the fingers": pros, cons, pitfalls</a></li>
<li><a href="../331778/index.html">As we wrote a strategic clicker on the hackathon ReactRiot</a></li>
<li><a href="../331780/index.html">It's time to throw! Migration Experience from Objective-C to Swift</a></li>
<li><a href="../331784/index.html">Million WebSocket and Go</a></li>
<li><a href="../331786/index.html">The problem of continuous protection of web applications. View from the side of researchers and operators</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>